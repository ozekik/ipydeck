
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SolidPolygonLayer &#8212; ipydeck documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'layers/solid_polygon';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TextLayer" href="text.html" />
    <link rel="prev" title="ScatterplotLayer" href="scatterplot.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">ipydeck documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Core API</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../deck.html">Deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../viewstate.html">ViewState</a></li>
<li class="toctree-l1"><a class="reference internal" href="../layer.html">Layer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Layers</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="arc.html">ArcLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="bitmap.html">BitmapLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="bitmap_tile.html">BitmapTileLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="column.html">ColumnLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="geojson.html">GeoJsonLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="grid_cell.html">GridCellLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="icon.html">IconLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="line.html">LineLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="path.html">PathLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="point_cloud.html">PointCloudLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="polygon.html">PolygonLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="scatterplot.html">ScatterplotLayer</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">SolidPolygonLayer</a></li>
<li class="toctree-l1"><a class="reference internal" href="text.html">TextLayer</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/ozekik/ipydeck" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/layers/solid_polygon.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SolidPolygonLayer</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="solidpolygonlayer">
<h1>SolidPolygonLayer<a class="headerlink" href="#solidpolygonlayer" title="Link to this heading">#</a></h1>
<p>The <a class="reference external" href="https://deck.gl/docs/api-reference/layers/solid-polygon-layer">deck.gl SolidPolygonLayer</a>
generates extruded 3D surfaces from polygons. Unlike <a class="reference internal" href="polygon.html"><span class="doc">PolygonLayer</span></a>, it always
renders as a solid volume and supports complex shapes with holes.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ipydeck</span><span class="w"> </span><span class="kn">import</span> <span class="n">Deck</span><span class="p">,</span> <span class="n">Layer</span><span class="p">,</span> <span class="n">ViewState</span>

<span class="n">hills</span> <span class="o">=</span> <span class="n">Layer</span><span class="p">(</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;SolidPolygonLayer&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Twin Peaks&quot;</span><span class="p">,</span>
            <span class="s2">&quot;polygon&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.4477</span><span class="p">,</span> <span class="mf">37.7543</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.4401</span><span class="p">,</span> <span class="mf">37.7514</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.4436</span><span class="p">,</span> <span class="mf">37.7447</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.4522</span><span class="p">,</span> <span class="mf">37.748</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="s2">&quot;elevation&quot;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="n">get_polygon</span><span class="o">=</span><span class="s2">&quot;@@=polygon&quot;</span><span class="p">,</span>
    <span class="n">get_elevation</span><span class="o">=</span><span class="s2">&quot;@@=elevation&quot;</span><span class="p">,</span>
    <span class="n">get_fill_color</span><span class="o">=</span><span class="p">[</span><span class="mi">102</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">170</span><span class="p">],</span>
    <span class="n">extruded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">pickable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">Deck</span><span class="p">(</span>
    <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">hills</span><span class="p">],</span>
    <span class="n">initial_view_state</span><span class="o">=</span><span class="n">ViewState</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mf">37.75</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=-</span><span class="mf">122.446</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">45</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 1, "model_id": "ee5cb34851cf47648aa4b265f8ac55f0"}
</script></div>
</div>
<p>Add <code class="docutils literal notranslate"><span class="pre">wireframe=True</span></code> to display polygon edges alongside the filled surface.</p>
</section>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"f974a8db08a249e59a3924f5ca07899c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ee5cb34851cf47648aa4b265f8ac55f0": {"model_name": "AnyModel", "model_module": "anywidget", "model_module_version": "~0.9.*", "state": {"_anywidget_id": "ipydeck.deck.Deck", "_css": "", "_dom_classes": [], "_esm": "var dde=Object.create;var RB=Object.defineProperty;var pde=Object.getOwnPropertyDescriptor;var Ade=Object.getOwnPropertyNames;var gde=Object.getPrototypeOf,mde=Object.prototype.hasOwnProperty;var zV=(t=>typeof require<\"u\"?require:typeof Proxy<\"u\"?new Proxy(t,{get:(e,n)=>(typeof require<\"u\"?require:e)[n]}):t)(function(t){if(typeof require<\"u\")return require.apply(this,arguments);throw Error('Dynamic require of \"'+t+'\" is not supported')});var Kt=(t,e)=>()=>(t&&(e=t(t=0)),e);var Fs=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Aa=(t,e)=>{for(var n in e)RB(t,n,{get:e[n],enumerable:!0})},_de=(t,e,n,r)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let i of Ade(e))!mde.call(t,i)&&i!==n&&RB(t,i,{get:()=>e[i],enumerable:!(r=pde(e,i))||r.enumerable});return t};var xr=(t,e,n)=>(n=t!=null?dde(gde(t)):{},_de(e||!t||!t.__esModule?RB(n,\"default\",{value:t,enumerable:!0}):n,t));var QV=Fs(Ar=>{\"use strict\";var LB=Symbol.for(\"react.transitional.element\"),yde=Symbol.for(\"react.portal\"),xde=Symbol.for(\"react.fragment\"),vde=Symbol.for(\"react.strict_mode\"),bde=Symbol.for(\"react.profiler\"),wde=Symbol.for(\"react.consumer\"),Tde=Symbol.for(\"react.context\"),Ede=Symbol.for(\"react.forward_ref\"),Sde=Symbol.for(\"react.suspense\"),Cde=Symbol.for(\"react.memo\"),WV=Symbol.for(\"react.lazy\"),Mde=Symbol.for(\"react.activity\"),UV=Symbol.iterator;function Ide(t){return t===null||typeof t!=\"object\"?null:(t=UV&&t[UV]||t[\"@@iterator\"],typeof t==\"function\"?t:null)}var jV={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},XV=Object.assign,YV={};function A1(t,e,n){this.props=t,this.context=e,this.refs=YV,this.updater=n||jV}A1.prototype.isReactComponent={};A1.prototype.setState=function(t,e){if(typeof t!=\"object\"&&typeof t!=\"function\"&&t!=null)throw Error(\"takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,t,e,\"setState\")};A1.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,\"forceUpdate\")};function ZV(){}ZV.prototype=A1.prototype;function OB(t,e,n){this.props=t,this.context=e,this.refs=YV,this.updater=n||jV}var FB=OB.prototype=new ZV;FB.constructor=OB;XV(FB,A1.prototype);FB.isPureReactComponent=!0;var VV=Array.isArray;function DB(){}var So={H:null,A:null,T:null,S:null},qV=Object.prototype.hasOwnProperty;function kB(t,e,n){var r=n.ref;return{$$typeof:LB,type:t,key:e,ref:r!==void 0?r:null,props:n}}function Pde(t,e){return kB(t.type,e,t.props)}function NB(t){return typeof t==\"object\"&&t!==null&&t.$$typeof===LB}function Rde(t){var e={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+t.replace(/[=:]/g,function(n){return e[n]})}var GV=/\\/+/g;function BB(t,e){return typeof t==\"object\"&&t!==null&&t.key!=null?Rde(\"\"+t.key):e.toString(36)}function Bde(t){switch(t.status){case\"fulfilled\":return t.value;case\"rejected\":throw t.reason;default:switch(typeof t.status==\"string\"?t.then(DB,DB):(t.status=\"pending\",t.then(function(e){t.status===\"pending\"&&(t.status=\"fulfilled\",t.value=e)},function(e){t.status===\"pending\"&&(t.status=\"rejected\",t.reason=e)})),t.status){case\"fulfilled\":return t.value;case\"rejected\":throw t.reason}}throw t}function p1(t,e,n,r,i){var o=typeof t;(o===\"undefined\"||o===\"boolean\")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case\"bigint\":case\"string\":case\"number\":s=!0;break;case\"object\":switch(t.$$typeof){case LB:case yde:s=!0;break;case WV:return s=t._init,p1(s(t._payload),e,n,r,i)}}if(s)return i=i(t),s=r===\"\"?\".\"+BB(t,0):r,VV(i)?(n=\"\",s!=null&&(n=s.replace(GV,\"$&/\")+\"/\"),p1(i,e,n,\"\",function(m){return m})):i!=null&&(NB(i)&&(i=Pde(i,n+(i.key==null||t&&t.key===i.key?\"\":(\"\"+i.key).replace(GV,\"$&/\")+\"/\")+s)),e.push(i)),1;s=0;var c=r===\"\"?\".\":r+\":\";if(VV(t))for(var d=0;d<t.length;d++)r=t[d],o=c+BB(r,d),s+=p1(r,e,n,o,i);else if(d=Ide(t),typeof d==\"function\")for(t=d.call(t),d=0;!(r=t.next()).done;)r=r.value,o=c+BB(r,d++),s+=p1(r,e,n,o,i);else if(o===\"object\"){if(typeof t.then==\"function\")return p1(Bde(t),e,n,r,i);throw e=String(t),Error(\"Objects are not valid as a React child (found: \"+(e===\"[object Object]\"?\"object with keys {\"+Object.keys(t).join(\", \")+\"}\":e)+\"). If you meant to render a collection of children, use an array instead.\")}return s}function PE(t,e,n){if(t==null)return t;var r=[],i=0;return p1(t,r,\"\",\"\",function(o){return e.call(n,o,i++)}),r}function Dde(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var HV=typeof reportError==\"function\"?reportError:function(t){if(typeof window==\"object\"&&typeof window.ErrorEvent==\"function\"){var e=new window.ErrorEvent(\"error\",{bubbles:!0,cancelable:!0,message:typeof t==\"object\"&&t!==null&&typeof t.message==\"string\"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process==\"object\"&&typeof process.emit==\"function\"){process.emit(\"uncaughtException\",t);return}console.error(t)},Lde={map:PE,forEach:function(t,e,n){PE(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return PE(t,function(){e++}),e},toArray:function(t){return PE(t,function(e){return e})||[]},only:function(t){if(!NB(t))throw Error(\"React.Children.only expected to receive a single React element child.\");return t}};Ar.Activity=Mde;Ar.Children=Lde;Ar.Component=A1;Ar.Fragment=xde;Ar.Profiler=bde;Ar.PureComponent=OB;Ar.StrictMode=vde;Ar.Suspense=Sde;Ar.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=So;Ar.__COMPILER_RUNTIME={__proto__:null,c:function(t){return So.H.useMemoCache(t)}};Ar.cache=function(t){return function(){return t.apply(null,arguments)}};Ar.cacheSignal=function(){return null};Ar.cloneElement=function(t,e,n){if(t==null)throw Error(\"The argument must be a React element, but you passed \"+t+\".\");var r=XV({},t.props),i=t.key;if(e!=null)for(o in e.key!==void 0&&(i=\"\"+e.key),e)!qV.call(e,o)||o===\"key\"||o===\"__self\"||o===\"__source\"||o===\"ref\"&&e.ref===void 0||(r[o]=e[o]);var o=arguments.length-2;if(o===1)r.children=n;else if(1<o){for(var s=Array(o),c=0;c<o;c++)s[c]=arguments[c+2];r.children=s}return kB(t.type,i,r)};Ar.createContext=function(t){return t={$$typeof:Tde,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:wde,_context:t},t};Ar.createElement=function(t,e,n){var r,i={},o=null;if(e!=null)for(r in e.key!==void 0&&(o=\"\"+e.key),e)qV.call(e,r)&&r!==\"key\"&&r!==\"__self\"&&r!==\"__source\"&&(i[r]=e[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var c=Array(s),d=0;d<s;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return kB(t,o,i)};Ar.createRef=function(){return{current:null}};Ar.forwardRef=function(t){return{$$typeof:Ede,render:t}};Ar.isValidElement=NB;Ar.lazy=function(t){return{$$typeof:WV,_payload:{_status:-1,_result:t},_init:Dde}};Ar.memo=function(t,e){return{$$typeof:Cde,type:t,compare:e===void 0?null:e}};Ar.startTransition=function(t){var e=So.T,n={};So.T=n;try{var r=t(),i=So.S;i!==null&&i(n,r),typeof r==\"object\"&&r!==null&&typeof r.then==\"function\"&&r.then(DB,HV)}catch(o){HV(o)}finally{e!==null&&n.types!==null&&(e.types=n.types),So.T=e}};Ar.unstable_useCacheRefresh=function(){return So.H.useCacheRefresh()};Ar.use=function(t){return So.H.use(t)};Ar.useActionState=function(t,e,n){return So.H.useActionState(t,e,n)};Ar.useCallback=function(t,e){return So.H.useCallback(t,e)};Ar.useContext=function(t){return So.H.useContext(t)};Ar.useDebugValue=function(){};Ar.useDeferredValue=function(t,e){return So.H.useDeferredValue(t,e)};Ar.useEffect=function(t,e){return So.H.useEffect(t,e)};Ar.useEffectEvent=function(t){return So.H.useEffectEvent(t)};Ar.useId=function(){return So.H.useId()};Ar.useImperativeHandle=function(t,e,n){return So.H.useImperativeHandle(t,e,n)};Ar.useInsertionEffect=function(t,e){return So.H.useInsertionEffect(t,e)};Ar.useLayoutEffect=function(t,e){return So.H.useLayoutEffect(t,e)};Ar.useMemo=function(t,e){return So.H.useMemo(t,e)};Ar.useOptimistic=function(t,e){return So.H.useOptimistic(t,e)};Ar.useReducer=function(t,e,n){return So.H.useReducer(t,e,n)};Ar.useRef=function(t){return So.H.useRef(t)};Ar.useState=function(t){return So.H.useState(t)};Ar.useSyncExternalStore=function(t,e,n){return So.H.useSyncExternalStore(t,e,n)};Ar.useTransition=function(){return So.H.useTransition()};Ar.version=\"19.2.4\"});var Jr=Fs((zLe,KV)=>{\"use strict\";KV.exports=QV()});var aG=Fs(Fo=>{\"use strict\";function GB(t,e){var n=t.length;t.push(e);e:for(;0<n;){var r=n-1>>>1,i=t[r];if(0<RE(i,e))t[r]=e,t[n]=i,n=r;else break e}}function Of(t){return t.length===0?null:t[0]}function DE(t){if(t.length===0)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;e:for(var r=0,i=t.length,o=i>>>1;r<o;){var s=2*(r+1)-1,c=t[s],d=s+1,m=t[d];if(0>RE(c,n))d<i&&0>RE(m,c)?(t[r]=m,t[d]=n,r=d):(t[r]=c,t[s]=n,r=s);else if(d<i&&0>RE(m,n))t[r]=m,t[d]=n,r=d;else break e}}return e}function RE(t,e){var n=t.sortIndex-e.sortIndex;return n!==0?n:t.id-e.id}Fo.unstable_now=void 0;typeof performance==\"object\"&&typeof performance.now==\"function\"?(JV=performance,Fo.unstable_now=function(){return JV.now()}):(zB=Date,$V=zB.now(),Fo.unstable_now=function(){return zB.now()-$V});var JV,zB,$V,np=[],H0=[],Ode=1,Bu=null,cl=3,HB=!1,Yx=!1,Zx=!1,WB=!1,nG=typeof setTimeout==\"function\"?setTimeout:null,rG=typeof clearTimeout==\"function\"?clearTimeout:null,eG=typeof setImmediate<\"u\"?setImmediate:null;function BE(t){for(var e=Of(H0);e!==null;){if(e.callback===null)DE(H0);else if(e.startTime<=t)DE(H0),e.sortIndex=e.expirationTime,GB(np,e);else break;e=Of(H0)}}function jB(t){if(Zx=!1,BE(t),!Yx)if(Of(np)!==null)Yx=!0,m1||(m1=!0,g1());else{var e=Of(H0);e!==null&&XB(jB,e.startTime-t)}}var m1=!1,qx=-1,iG=5,oG=-1;function sG(){return WB?!0:!(Fo.unstable_now()-oG<iG)}function UB(){if(WB=!1,m1){var t=Fo.unstable_now();oG=t;var e=!0;try{e:{Yx=!1,Zx&&(Zx=!1,rG(qx),qx=-1),HB=!0;var n=cl;try{t:{for(BE(t),Bu=Of(np);Bu!==null&&!(Bu.expirationTime>t&&sG());){var r=Bu.callback;if(typeof r==\"function\"){Bu.callback=null,cl=Bu.priorityLevel;var i=r(Bu.expirationTime<=t);if(t=Fo.unstable_now(),typeof i==\"function\"){Bu.callback=i,BE(t),e=!0;break t}Bu===Of(np)&&DE(np),BE(t)}else DE(np);Bu=Of(np)}if(Bu!==null)e=!0;else{var o=Of(H0);o!==null&&XB(jB,o.startTime-t),e=!1}}break e}finally{Bu=null,cl=n,HB=!1}e=void 0}}finally{e?g1():m1=!1}}}var g1;typeof eG==\"function\"?g1=function(){eG(UB)}:typeof MessageChannel<\"u\"?(VB=new MessageChannel,tG=VB.port2,VB.port1.onmessage=UB,g1=function(){tG.postMessage(null)}):g1=function(){nG(UB,0)};var VB,tG;function XB(t,e){qx=nG(function(){t(Fo.unstable_now())},e)}Fo.unstable_IdlePriority=5;Fo.unstable_ImmediatePriority=1;Fo.unstable_LowPriority=4;Fo.unstable_NormalPriority=3;Fo.unstable_Profiling=null;Fo.unstable_UserBlockingPriority=2;Fo.unstable_cancelCallback=function(t){t.callback=null};Fo.unstable_forceFrameRate=function(t){0>t||125<t?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):iG=0<t?Math.floor(1e3/t):5};Fo.unstable_getCurrentPriorityLevel=function(){return cl};Fo.unstable_next=function(t){switch(cl){case 1:case 2:case 3:var e=3;break;default:e=cl}var n=cl;cl=e;try{return t()}finally{cl=n}};Fo.unstable_requestPaint=function(){WB=!0};Fo.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=cl;cl=t;try{return e()}finally{cl=n}};Fo.unstable_scheduleCallback=function(t,e,n){var r=Fo.unstable_now();switch(typeof n==\"object\"&&n!==null?(n=n.delay,n=typeof n==\"number\"&&0<n?r+n:r):n=r,t){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return i=n+i,t={id:Ode++,callback:e,priorityLevel:t,startTime:n,expirationTime:i,sortIndex:-1},n>r?(t.sortIndex=n,GB(H0,t),Of(np)===null&&t===Of(H0)&&(Zx?(rG(qx),qx=-1):Zx=!0,XB(jB,n-r))):(t.sortIndex=i,GB(np,t),Yx||HB||(Yx=!0,m1||(m1=!0,g1()))),t};Fo.unstable_shouldYield=sG;Fo.unstable_wrapCallback=function(t){var e=cl;return function(){var n=cl;cl=e;try{return t.apply(this,arguments)}finally{cl=n}}}});var cG=Fs((VLe,lG)=>{\"use strict\";lG.exports=aG()});var hG=Fs(Hl=>{\"use strict\";var Fde=Jr();function uG(t){var e=\"https://react.dev/errors/\"+t;if(1<arguments.length){e+=\"?args[]=\"+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+=\"&args[]=\"+encodeURIComponent(arguments[n])}return\"Minified React error #\"+t+\"; visit \"+e+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}function W0(){}var Gl={d:{f:W0,r:function(){throw Error(uG(522))},D:W0,C:W0,L:W0,m:W0,X:W0,S:W0,M:W0},p:0,findDOMNode:null},kde=Symbol.for(\"react.portal\");function Nde(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:kde,key:r==null?null:\"\"+r,children:t,containerInfo:e,implementation:n}}var Qx=Fde.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function LE(t,e){if(t===\"font\")return\"\";if(typeof e==\"string\")return e===\"use-credentials\"?e:\"\"}Hl.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Gl;Hl.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(uG(299));return Nde(t,e,null,n)};Hl.flushSync=function(t){var e=Qx.T,n=Gl.p;try{if(Qx.T=null,Gl.p=2,t)return t()}finally{Qx.T=e,Gl.p=n,Gl.d.f()}};Hl.preconnect=function(t,e){typeof t==\"string\"&&(e?(e=e.crossOrigin,e=typeof e==\"string\"?e===\"use-credentials\"?e:\"\":void 0):e=null,Gl.d.C(t,e))};Hl.prefetchDNS=function(t){typeof t==\"string\"&&Gl.d.D(t)};Hl.preinit=function(t,e){if(typeof t==\"string\"&&e&&typeof e.as==\"string\"){var n=e.as,r=LE(n,e.crossOrigin),i=typeof e.integrity==\"string\"?e.integrity:void 0,o=typeof e.fetchPriority==\"string\"?e.fetchPriority:void 0;n===\"style\"?Gl.d.S(t,typeof e.precedence==\"string\"?e.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:o}):n===\"script\"&&Gl.d.X(t,{crossOrigin:r,integrity:i,fetchPriority:o,nonce:typeof e.nonce==\"string\"?e.nonce:void 0})}};Hl.preinitModule=function(t,e){if(typeof t==\"string\")if(typeof e==\"object\"&&e!==null){if(e.as==null||e.as===\"script\"){var n=LE(e.as,e.crossOrigin);Gl.d.M(t,{crossOrigin:n,integrity:typeof e.integrity==\"string\"?e.integrity:void 0,nonce:typeof e.nonce==\"string\"?e.nonce:void 0})}}else e==null&&Gl.d.M(t)};Hl.preload=function(t,e){if(typeof t==\"string\"&&typeof e==\"object\"&&e!==null&&typeof e.as==\"string\"){var n=e.as,r=LE(n,e.crossOrigin);Gl.d.L(t,n,{crossOrigin:r,integrity:typeof e.integrity==\"string\"?e.integrity:void 0,nonce:typeof e.nonce==\"string\"?e.nonce:void 0,type:typeof e.type==\"string\"?e.type:void 0,fetchPriority:typeof e.fetchPriority==\"string\"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy==\"string\"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet==\"string\"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes==\"string\"?e.imageSizes:void 0,media:typeof e.media==\"string\"?e.media:void 0})}};Hl.preloadModule=function(t,e){if(typeof t==\"string\")if(e){var n=LE(e.as,e.crossOrigin);Gl.d.m(t,{as:typeof e.as==\"string\"&&e.as!==\"script\"?e.as:void 0,crossOrigin:n,integrity:typeof e.integrity==\"string\"?e.integrity:void 0})}else Gl.d.m(t)};Hl.requestFormReset=function(t){Gl.d.r(t)};Hl.unstable_batchedUpdates=function(t,e){return t(e)};Hl.useFormState=function(t,e,n){return Qx.H.useFormState(t,e,n)};Hl.useFormStatus=function(){return Qx.H.useHostTransitionStatus()};Hl.version=\"19.2.4\"});var Jg=Fs((HLe,dG)=>{\"use strict\";function fG(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>\"u\"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=\"function\"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fG)}catch(t){console.error(t)}}fG(),dG.exports=hG()});var EX=Fs(oC=>{\"use strict\";var $s=cG(),zH=Jr(),zde=Jg();function Ht(t){var e=\"https://react.dev/errors/\"+t;if(1<arguments.length){e+=\"?args[]=\"+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+=\"&args[]=\"+encodeURIComponent(arguments[n])}return\"Minified React error #\"+t+\"; visit \"+e+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}function UH(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Fv(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.flags&4098)!==0&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function VH(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function GH(t){if(t.tag===31){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function pG(t){if(Fv(t)!==t)throw Error(Ht(188))}function Ude(t){var e=t.alternate;if(!e){if(e=Fv(t),e===null)throw Error(Ht(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return pG(i),t;if(o===r)return pG(i),e;o=o.sibling}throw Error(Ht(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,c=i.child;c;){if(c===n){s=!0,n=i,r=o;break}if(c===r){s=!0,r=i,n=o;break}c=c.sibling}if(!s){for(c=o.child;c;){if(c===n){s=!0,n=o,r=i;break}if(c===r){s=!0,r=o,n=i;break}c=c.sibling}if(!s)throw Error(Ht(189))}}if(n.alternate!==r)throw Error(Ht(190))}if(n.tag!==3)throw Error(Ht(188));return n.stateNode.current===n?t:e}function HH(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=HH(t),e!==null)return e;t=t.sibling}return null}var Io=Object.assign,Vde=Symbol.for(\"react.element\"),OE=Symbol.for(\"react.transitional.element\"),iv=Symbol.for(\"react.portal\"),w1=Symbol.for(\"react.fragment\"),WH=Symbol.for(\"react.strict_mode\"),S6=Symbol.for(\"react.profiler\"),jH=Symbol.for(\"react.consumer\"),up=Symbol.for(\"react.context\"),vD=Symbol.for(\"react.forward_ref\"),C6=Symbol.for(\"react.suspense\"),M6=Symbol.for(\"react.suspense_list\"),bD=Symbol.for(\"react.memo\"),j0=Symbol.for(\"react.lazy\");Symbol.for(\"react.scope\");var I6=Symbol.for(\"react.activity\");Symbol.for(\"react.legacy_hidden\");Symbol.for(\"react.tracing_marker\");var Gde=Symbol.for(\"react.memo_cache_sentinel\");Symbol.for(\"react.view_transition\");var AG=Symbol.iterator;function Kx(t){return t===null||typeof t!=\"object\"?null:(t=AG&&t[AG]||t[\"@@iterator\"],typeof t==\"function\"?t:null)}var Hde=Symbol.for(\"react.client.reference\");function P6(t){if(t==null)return null;if(typeof t==\"function\")return t.$$typeof===Hde?null:t.displayName||t.name||null;if(typeof t==\"string\")return t;switch(t){case w1:return\"Fragment\";case S6:return\"Profiler\";case WH:return\"StrictMode\";case C6:return\"Suspense\";case M6:return\"SuspenseList\";case I6:return\"Activity\"}if(typeof t==\"object\")switch(t.$$typeof){case iv:return\"Portal\";case up:return t.displayName||\"Context\";case jH:return(t._context.displayName||\"Context\")+\".Consumer\";case vD:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||\"\",t=t!==\"\"?\"ForwardRef(\"+t+\")\":\"ForwardRef\"),t;case bD:return e=t.displayName||null,e!==null?e:P6(t.type)||\"Memo\";case j0:e=t._payload,t=t._init;try{return P6(t(e))}catch{}}return null}var ov=Array.isArray,ar=zH.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Si=zde.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,im={pending:!1,data:null,method:null,action:null},R6=[],T1=-1;function Uf(t){return{current:t}}function _a(t){0>T1||(t.current=R6[T1],R6[T1]=null,T1--)}function go(t,e){T1++,R6[T1]=t.current,t.current=e}var zf=Uf(null),bv=Uf(null),nA=Uf(null),pS=Uf(null);function AS(t,e){switch(go(nA,e),go(bv,t),go(zf,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?bH(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=bH(e),t=hX(e,t);else switch(t){case\"svg\":t=1;break;case\"math\":t=2;break;default:t=0}}_a(zf),go(zf,t)}function G1(){_a(zf),_a(bv),_a(nA)}function B6(t){t.memoizedState!==null&&go(pS,t);var e=zf.current,n=hX(e,t.type);e!==n&&(go(bv,t),go(zf,n))}function gS(t){bv.current===t&&(_a(zf),_a(bv)),pS.current===t&&(_a(pS),Dv._currentValue=im)}var YB,gG;function em(t){if(YB===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\\n( *(at )?)/);YB=e&&e[1]||\"\",gG=-1<n.stack.indexOf(`\n    at`)?\" (<anonymous>)\":-1<n.stack.indexOf(\"@\")?\"@unknown:0:0\":\"\"}return`\n`+YB+t+gG}var ZB=!1;function qB(t,e){if(!t||ZB)return\"\";ZB=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(e){var C=function(){throw Error()};if(Object.defineProperty(C.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(C,[])}catch(k){var B=k}Reflect.construct(t,[],C)}else{try{C.call()}catch(k){B=k}t.call(C.prototype)}}else{try{throw Error()}catch(k){B=k}(C=t())&&typeof C.catch==\"function\"&&C.catch(function(){})}}catch(k){if(k&&B&&typeof k.stack==\"string\")return[k.stack,B.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName=\"DetermineComponentFrameRoot\";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,\"name\");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,\"name\",{value:\"DetermineComponentFrameRoot\"});var o=r.DetermineComponentFrameRoot(),s=o[0],c=o[1];if(s&&c){var d=s.split(`\n`),m=c.split(`\n`);for(i=r=0;r<d.length&&!d[r].includes(\"DetermineComponentFrameRoot\");)r++;for(;i<m.length&&!m[i].includes(\"DetermineComponentFrameRoot\");)i++;if(r===d.length||i===m.length)for(r=d.length-1,i=m.length-1;1<=r&&0<=i&&d[r]!==m[i];)i--;for(;1<=r&&0<=i;r--,i--)if(d[r]!==m[i]){if(r!==1||i!==1)do if(r--,i--,0>i||d[r]!==m[i]){var b=`\n`+d[r].replace(\" at new \",\" at \");return t.displayName&&b.includes(\"<anonymous>\")&&(b=b.replace(\"<anonymous>\",t.displayName)),b}while(1<=r&&0<=i);break}}}finally{ZB=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:\"\")?em(n):\"\"}function Wde(t,e){switch(t.tag){case 26:case 27:case 5:return em(t.type);case 16:return em(\"Lazy\");case 13:return t.child!==e&&e!==null?em(\"Suspense Fallback\"):em(\"Suspense\");case 19:return em(\"SuspenseList\");case 0:case 15:return qB(t.type,!1);case 11:return qB(t.type.render,!1);case 1:return qB(t.type,!0);case 31:return em(\"Activity\");default:return\"\"}}function mG(t){try{var e=\"\",n=null;do e+=Wde(t,n),n=t,t=t.return;while(t);return e}catch(r){return`\nError generating stack: `+r.message+`\n`+r.stack}}var D6=Object.prototype.hasOwnProperty,wD=$s.unstable_scheduleCallback,QB=$s.unstable_cancelCallback,jde=$s.unstable_shouldYield,Xde=$s.unstable_requestPaint,Yc=$s.unstable_now,Yde=$s.unstable_getCurrentPriorityLevel,XH=$s.unstable_ImmediatePriority,YH=$s.unstable_UserBlockingPriority,mS=$s.unstable_NormalPriority,Zde=$s.unstable_LowPriority,ZH=$s.unstable_IdlePriority,qde=$s.log,Qde=$s.unstable_setDisableYieldValue,kv=null,Zc=null;function K0(t){if(typeof qde==\"function\"&&Qde(t),Zc&&typeof Zc.setStrictMode==\"function\")try{Zc.setStrictMode(kv,t)}catch{}}var qc=Math.clz32?Math.clz32:$de,Kde=Math.log,Jde=Math.LN2;function $de(t){return t>>>=0,t===0?32:31-(Kde(t)/Jde|0)|0}var FE=256,kE=262144,NE=4194304;function tm(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function HS(t,e,n){var r=t.pendingLanes;if(r===0)return 0;var i=0,o=t.suspendedLanes,s=t.pingedLanes;t=t.warmLanes;var c=r&134217727;return c!==0?(r=c&~o,r!==0?i=tm(r):(s&=c,s!==0?i=tm(s):n||(n=c&~t,n!==0&&(i=tm(n))))):(c=r&~o,c!==0?i=tm(c):s!==0?i=tm(s):n||(n=r&~t,n!==0&&(i=tm(n)))),i===0?0:e!==0&&e!==i&&(e&o)===0&&(o=i&-i,n=e&-e,o>=n||o===32&&(n&4194048)!==0)?e:i}function Nv(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function epe(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qH(){var t=NE;return NE<<=1,(NE&62914560)===0&&(NE=4194304),t}function KB(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function zv(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function tpe(t,e,n,r,i,o){var s=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var c=t.entanglements,d=t.expirationTimes,m=t.hiddenUpdates;for(n=s&~n;0<n;){var b=31-qc(n),C=1<<b;c[b]=0,d[b]=-1;var B=m[b];if(B!==null)for(m[b]=null,b=0;b<B.length;b++){var k=B[b];k!==null&&(k.lane&=-536870913)}n&=~C}r!==0&&QH(t,r,0),o!==0&&i===0&&t.tag!==0&&(t.suspendedLanes|=o&~(s&~e))}function QH(t,e,n){t.pendingLanes|=e,t.suspendedLanes&=~e;var r=31-qc(e);t.entangledLanes|=e,t.entanglements[r]=t.entanglements[r]|1073741824|n&261930}function KH(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-qc(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}function JH(t,e){var n=e&-e;return n=(n&42)!==0?1:TD(n),(n&(t.suspendedLanes|e))!==0?0:n}function TD(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function ED(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function $H(){var t=Si.p;return t!==0?t:(t=window.event,t===void 0?32:bX(t.type))}function _G(t,e){var n=Si.p;try{return Si.p=t,e()}finally{Si.p=n}}var AA=Math.random().toString(36).slice(2),Va=\"__reactFiber$\"+AA,mc=\"__reactProps$\"+AA,$1=\"__reactContainer$\"+AA,L6=\"__reactEvents$\"+AA,npe=\"__reactListeners$\"+AA,rpe=\"__reactHandles$\"+AA,yG=\"__reactResources$\"+AA,Uv=\"__reactMarker$\"+AA;function SD(t){delete t[Va],delete t[mc],delete t[L6],delete t[npe],delete t[rpe]}function E1(t){var e=t[Va];if(e)return e;for(var n=t.parentNode;n;){if(e=n[$1]||n[Va]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=CH(t);t!==null;){if(n=t[Va])return n;t=CH(t)}return e}t=n,n=t.parentNode}return null}function ey(t){if(t=t[Va]||t[$1]){var e=t.tag;if(e===5||e===6||e===13||e===31||e===26||e===27||e===3)return t}return null}function sv(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(Ht(33))}function O1(t){var e=t[yG];return e||(e=t[yG]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function ma(t){t[Uv]=!0}var eW=new Set,tW={};function pm(t,e){H1(t,e),H1(t+\"Capture\",e)}function H1(t,e){for(tW[t]=e,t=0;t<e.length;t++)eW.add(e[t])}var ipe=RegExp(\"^[:A-Z_a-z\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD][:A-Z_a-z\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD\\\\-.0-9\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040]*$\"),xG={},vG={};function ope(t){return D6.call(vG,t)?!0:D6.call(xG,t)?!1:ipe.test(t)?vG[t]=!0:(xG[t]=!0,!1)}function $E(t,e,n){if(ope(e))if(n===null)t.removeAttribute(e);else{switch(typeof n){case\"undefined\":case\"function\":case\"symbol\":t.removeAttribute(e);return;case\"boolean\":var r=e.toLowerCase().slice(0,5);if(r!==\"data-\"&&r!==\"aria-\"){t.removeAttribute(e);return}}t.setAttribute(e,\"\"+n)}}function zE(t,e,n){if(n===null)t.removeAttribute(e);else{switch(typeof n){case\"undefined\":case\"function\":case\"symbol\":case\"boolean\":t.removeAttribute(e);return}t.setAttribute(e,\"\"+n)}}function rp(t,e,n,r){if(r===null)t.removeAttribute(n);else{switch(typeof r){case\"undefined\":case\"function\":case\"symbol\":case\"boolean\":t.removeAttribute(n);return}t.setAttributeNS(e,n,\"\"+r)}}function Lu(t){switch(typeof t){case\"bigint\":case\"boolean\":case\"number\":case\"string\":case\"undefined\":return t;case\"object\":return t;default:return\"\"}}function nW(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()===\"input\"&&(e===\"checkbox\"||e===\"radio\")}function spe(t,e,n){var r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e);if(!t.hasOwnProperty(e)&&typeof r<\"u\"&&typeof r.get==\"function\"&&typeof r.set==\"function\"){var i=r.get,o=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=\"\"+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=\"\"+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function O6(t){if(!t._valueTracker){var e=nW(t)?\"checked\":\"value\";t._valueTracker=spe(t,e,\"\"+t[e])}}function rW(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r=\"\";return t&&(r=nW(t)?t.checked?\"true\":\"false\":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function _S(t){if(t=t||(typeof document<\"u\"?document:void 0),typeof t>\"u\")return null;try{return t.activeElement||t.body}catch{return t.body}}var ape=/[\\n\"\\\\]/g;function ku(t){return t.replace(ape,function(e){return\"\\\\\"+e.charCodeAt(0).toString(16)+\" \"})}function F6(t,e,n,r,i,o,s,c){t.name=\"\",s!=null&&typeof s!=\"function\"&&typeof s!=\"symbol\"&&typeof s!=\"boolean\"?t.type=s:t.removeAttribute(\"type\"),e!=null?s===\"number\"?(e===0&&t.value===\"\"||t.value!=e)&&(t.value=\"\"+Lu(e)):t.value!==\"\"+Lu(e)&&(t.value=\"\"+Lu(e)):s!==\"submit\"&&s!==\"reset\"||t.removeAttribute(\"value\"),e!=null?k6(t,s,Lu(e)):n!=null?k6(t,s,Lu(n)):r!=null&&t.removeAttribute(\"value\"),i==null&&o!=null&&(t.defaultChecked=!!o),i!=null&&(t.checked=i&&typeof i!=\"function\"&&typeof i!=\"symbol\"),c!=null&&typeof c!=\"function\"&&typeof c!=\"symbol\"&&typeof c!=\"boolean\"?t.name=\"\"+Lu(c):t.removeAttribute(\"name\")}function iW(t,e,n,r,i,o,s,c){if(o!=null&&typeof o!=\"function\"&&typeof o!=\"symbol\"&&typeof o!=\"boolean\"&&(t.type=o),e!=null||n!=null){if(!(o!==\"submit\"&&o!==\"reset\"||e!=null)){O6(t);return}n=n!=null?\"\"+Lu(n):\"\",e=e!=null?\"\"+Lu(e):n,c||e===t.value||(t.value=e),t.defaultValue=e}r=r??i,r=typeof r!=\"function\"&&typeof r!=\"symbol\"&&!!r,t.checked=c?t.checked:!!r,t.defaultChecked=!!r,s!=null&&typeof s!=\"function\"&&typeof s!=\"symbol\"&&typeof s!=\"boolean\"&&(t.name=s),O6(t)}function k6(t,e,n){e===\"number\"&&_S(t.ownerDocument)===t||t.defaultValue===\"\"+n||(t.defaultValue=\"\"+n)}function F1(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e[\"$\"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty(\"$\"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=\"\"+Lu(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function oW(t,e,n){if(e!=null&&(e=\"\"+Lu(e),e!==t.value&&(t.value=e),n==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=n!=null?\"\"+Lu(n):\"\"}function sW(t,e,n,r){if(e==null){if(r!=null){if(n!=null)throw Error(Ht(92));if(ov(r)){if(1<r.length)throw Error(Ht(93));r=r[0]}n=r}n==null&&(n=\"\"),e=n}n=Lu(e),t.defaultValue=n,r=t.textContent,r===n&&r!==\"\"&&r!==null&&(t.value=r),O6(t)}function W1(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var lpe=new Set(\"animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp\".split(\" \"));function bG(t,e,n){var r=e.indexOf(\"--\")===0;n==null||typeof n==\"boolean\"||n===\"\"?r?t.setProperty(e,\"\"):e===\"float\"?t.cssFloat=\"\":t[e]=\"\":r?t.setProperty(e,n):typeof n!=\"number\"||n===0||lpe.has(e)?e===\"float\"?t.cssFloat=n:t[e]=(\"\"+n).trim():t[e]=n+\"px\"}function aW(t,e,n){if(e!=null&&typeof e!=\"object\")throw Error(Ht(62));if(t=t.style,n!=null){for(var r in n)!n.hasOwnProperty(r)||e!=null&&e.hasOwnProperty(r)||(r.indexOf(\"--\")===0?t.setProperty(r,\"\"):r===\"float\"?t.cssFloat=\"\":t[r]=\"\");for(var i in e)r=e[i],e.hasOwnProperty(i)&&n[i]!==r&&bG(t,i,r)}else for(var o in e)e.hasOwnProperty(o)&&bG(t,o,e[o])}function CD(t){if(t.indexOf(\"-\")===-1)return!1;switch(t){case\"annotation-xml\":case\"color-profile\":case\"font-face\":case\"font-face-src\":case\"font-face-uri\":case\"font-face-format\":case\"font-face-name\":case\"missing-glyph\":return!1;default:return!0}}var cpe=new Map([[\"acceptCharset\",\"accept-charset\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"],[\"crossOrigin\",\"crossorigin\"],[\"accentHeight\",\"accent-height\"],[\"alignmentBaseline\",\"alignment-baseline\"],[\"arabicForm\",\"arabic-form\"],[\"baselineShift\",\"baseline-shift\"],[\"capHeight\",\"cap-height\"],[\"clipPath\",\"clip-path\"],[\"clipRule\",\"clip-rule\"],[\"colorInterpolation\",\"color-interpolation\"],[\"colorInterpolationFilters\",\"color-interpolation-filters\"],[\"colorProfile\",\"color-profile\"],[\"colorRendering\",\"color-rendering\"],[\"dominantBaseline\",\"dominant-baseline\"],[\"enableBackground\",\"enable-background\"],[\"fillOpacity\",\"fill-opacity\"],[\"fillRule\",\"fill-rule\"],[\"floodColor\",\"flood-color\"],[\"floodOpacity\",\"flood-opacity\"],[\"fontFamily\",\"font-family\"],[\"fontSize\",\"font-size\"],[\"fontSizeAdjust\",\"font-size-adjust\"],[\"fontStretch\",\"font-stretch\"],[\"fontStyle\",\"font-style\"],[\"fontVariant\",\"font-variant\"],[\"fontWeight\",\"font-weight\"],[\"glyphName\",\"glyph-name\"],[\"glyphOrientationHorizontal\",\"glyph-orientation-horizontal\"],[\"glyphOrientationVertical\",\"glyph-orientation-vertical\"],[\"horizAdvX\",\"horiz-adv-x\"],[\"horizOriginX\",\"horiz-origin-x\"],[\"imageRendering\",\"image-rendering\"],[\"letterSpacing\",\"letter-spacing\"],[\"lightingColor\",\"lighting-color\"],[\"markerEnd\",\"marker-end\"],[\"markerMid\",\"marker-mid\"],[\"markerStart\",\"marker-start\"],[\"overlinePosition\",\"overline-position\"],[\"overlineThickness\",\"overline-thickness\"],[\"paintOrder\",\"paint-order\"],[\"panose-1\",\"panose-1\"],[\"pointerEvents\",\"pointer-events\"],[\"renderingIntent\",\"rendering-intent\"],[\"shapeRendering\",\"shape-rendering\"],[\"stopColor\",\"stop-color\"],[\"stopOpacity\",\"stop-opacity\"],[\"strikethroughPosition\",\"strikethrough-position\"],[\"strikethroughThickness\",\"strikethrough-thickness\"],[\"strokeDasharray\",\"stroke-dasharray\"],[\"strokeDashoffset\",\"stroke-dashoffset\"],[\"strokeLinecap\",\"stroke-linecap\"],[\"strokeLinejoin\",\"stroke-linejoin\"],[\"strokeMiterlimit\",\"stroke-miterlimit\"],[\"strokeOpacity\",\"stroke-opacity\"],[\"strokeWidth\",\"stroke-width\"],[\"textAnchor\",\"text-anchor\"],[\"textDecoration\",\"text-decoration\"],[\"textRendering\",\"text-rendering\"],[\"transformOrigin\",\"transform-origin\"],[\"underlinePosition\",\"underline-position\"],[\"underlineThickness\",\"underline-thickness\"],[\"unicodeBidi\",\"unicode-bidi\"],[\"unicodeRange\",\"unicode-range\"],[\"unitsPerEm\",\"units-per-em\"],[\"vAlphabetic\",\"v-alphabetic\"],[\"vHanging\",\"v-hanging\"],[\"vIdeographic\",\"v-ideographic\"],[\"vMathematical\",\"v-mathematical\"],[\"vectorEffect\",\"vector-effect\"],[\"vertAdvY\",\"vert-adv-y\"],[\"vertOriginX\",\"vert-origin-x\"],[\"vertOriginY\",\"vert-origin-y\"],[\"wordSpacing\",\"word-spacing\"],[\"writingMode\",\"writing-mode\"],[\"xmlnsXlink\",\"xmlns:xlink\"],[\"xHeight\",\"x-height\"]]),upe=/^[\\u0000-\\u001F ]*j[\\r\\n\\t]*a[\\r\\n\\t]*v[\\r\\n\\t]*a[\\r\\n\\t]*s[\\r\\n\\t]*c[\\r\\n\\t]*r[\\r\\n\\t]*i[\\r\\n\\t]*p[\\r\\n\\t]*t[\\r\\n\\t]*:/i;function eS(t){return upe.test(\"\"+t)?\"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')\":t}function hp(){}var N6=null;function MD(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var S1=null,k1=null;function wG(t){var e=ey(t);if(e&&(t=e.stateNode)){var n=t[mc]||null;e:switch(t=e.stateNode,e.type){case\"input\":if(F6(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),e=n.name,n.type===\"radio\"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name=\"'+ku(\"\"+e)+'\"][type=\"radio\"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=r[mc]||null;if(!i)throw Error(Ht(90));F6(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(e=0;e<n.length;e++)r=n[e],r.form===t.form&&rW(r)}break e;case\"textarea\":oW(t,n.value,n.defaultValue);break e;case\"select\":e=n.value,e!=null&&F1(t,!!n.multiple,e,!1)}}}var JB=!1;function lW(t,e,n){if(JB)return t(e,n);JB=!0;try{var r=t(e);return r}finally{if(JB=!1,(S1!==null||k1!==null)&&(tC(),S1&&(e=S1,t=k1,k1=S1=null,wG(e),t)))for(e=0;e<t.length;e++)wG(t[e])}}function wv(t,e){var n=t.stateNode;if(n===null)return null;var r=n[mc]||null;if(r===null)return null;n=r[e];e:switch(e){case\"onClick\":case\"onClickCapture\":case\"onDoubleClick\":case\"onDoubleClickCapture\":case\"onMouseDown\":case\"onMouseDownCapture\":case\"onMouseMove\":case\"onMouseMoveCapture\":case\"onMouseUp\":case\"onMouseUpCapture\":case\"onMouseEnter\":(r=!r.disabled)||(t=t.type,r=!(t===\"button\"||t===\"input\"||t===\"select\"||t===\"textarea\")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!=\"function\")throw Error(Ht(231,e,typeof n));return n}var gp=!(typeof window>\"u\"||typeof window.document>\"u\"||typeof window.document.createElement>\"u\"),z6=!1;if(gp)try{_1={},Object.defineProperty(_1,\"passive\",{get:function(){z6=!0}}),window.addEventListener(\"test\",_1,_1),window.removeEventListener(\"test\",_1,_1)}catch{z6=!1}var _1,J0=null,ID=null,tS=null;function cW(){if(tS)return tS;var t,e=ID,n=e.length,r,i=\"value\"in J0?J0.value:J0.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return tS=i.slice(t,1<r?1-r:void 0)}function nS(t){var e=t.keyCode;return\"charCode\"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function UE(){return!0}function TG(){return!1}function _c(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(o):o[c]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?UE:TG,this.isPropagationStopped=TG,this}return Io(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!=\"unknown\"&&(n.returnValue=!1),this.isDefaultPrevented=UE)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!=\"unknown\"&&(n.cancelBubble=!0),this.isPropagationStopped=UE)},persist:function(){},isPersistent:UE}),e}var Am={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},WS=_c(Am),Vv=Io({},Am,{view:0,detail:0}),hpe=_c(Vv),$B,e6,Jx,jS=Io({},Vv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:PD,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return\"movementX\"in t?t.movementX:(t!==Jx&&(Jx&&t.type===\"mousemove\"?($B=t.screenX-Jx.screenX,e6=t.screenY-Jx.screenY):e6=$B=0,Jx=t),$B)},movementY:function(t){return\"movementY\"in t?t.movementY:e6}}),EG=_c(jS),fpe=Io({},jS,{dataTransfer:0}),dpe=_c(fpe),ppe=Io({},Vv,{relatedTarget:0}),t6=_c(ppe),Ape=Io({},Am,{animationName:0,elapsedTime:0,pseudoElement:0}),gpe=_c(Ape),mpe=Io({},Am,{clipboardData:function(t){return\"clipboardData\"in t?t.clipboardData:window.clipboardData}}),_pe=_c(mpe),ype=Io({},Am,{data:0}),SG=_c(ype),xpe={Esc:\"Escape\",Spacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},vpe={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},bpe={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function wpe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=bpe[t])?!!e[t]:!1}function PD(){return wpe}var Tpe=Io({},Vv,{key:function(t){if(t.key){var e=xpe[t.key]||t.key;if(e!==\"Unidentified\")return e}return t.type===\"keypress\"?(t=nS(t),t===13?\"Enter\":String.fromCharCode(t)):t.type===\"keydown\"||t.type===\"keyup\"?vpe[t.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:PD,charCode:function(t){return t.type===\"keypress\"?nS(t):0},keyCode:function(t){return t.type===\"keydown\"||t.type===\"keyup\"?t.keyCode:0},which:function(t){return t.type===\"keypress\"?nS(t):t.type===\"keydown\"||t.type===\"keyup\"?t.keyCode:0}}),Epe=_c(Tpe),Spe=Io({},jS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),CG=_c(Spe),Cpe=Io({},Vv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:PD}),Mpe=_c(Cpe),Ipe=Io({},Am,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ppe=_c(Ipe),Rpe=Io({},jS,{deltaX:function(t){return\"deltaX\"in t?t.deltaX:\"wheelDeltaX\"in t?-t.wheelDeltaX:0},deltaY:function(t){return\"deltaY\"in t?t.deltaY:\"wheelDeltaY\"in t?-t.wheelDeltaY:\"wheelDelta\"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Bpe=_c(Rpe),Dpe=Io({},Am,{newState:0,oldState:0}),Lpe=_c(Dpe),Ope=[9,13,27,32],RD=gp&&\"CompositionEvent\"in window,cv=null;gp&&\"documentMode\"in document&&(cv=document.documentMode);var Fpe=gp&&\"TextEvent\"in window&&!cv,uW=gp&&(!RD||cv&&8<cv&&11>=cv),MG=\" \",IG=!1;function hW(t,e){switch(t){case\"keyup\":return Ope.indexOf(e.keyCode)!==-1;case\"keydown\":return e.keyCode!==229;case\"keypress\":case\"mousedown\":case\"focusout\":return!0;default:return!1}}function fW(t){return t=t.detail,typeof t==\"object\"&&\"data\"in t?t.data:null}var C1=!1;function kpe(t,e){switch(t){case\"compositionend\":return fW(e);case\"keypress\":return e.which!==32?null:(IG=!0,MG);case\"textInput\":return t=e.data,t===MG&&IG?null:t;default:return null}}function Npe(t,e){if(C1)return t===\"compositionend\"||!RD&&hW(t,e)?(t=cW(),tS=ID=J0=null,C1=!1,t):null;switch(t){case\"paste\":return null;case\"keypress\":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case\"compositionend\":return uW&&e.locale!==\"ko\"?null:e.data;default:return null}}var zpe={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function PG(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e===\"input\"?!!zpe[t.type]:e===\"textarea\"}function dW(t,e,n,r){S1?k1?k1.push(r):k1=[r]:S1=r,e=FS(e,\"onChange\"),0<e.length&&(n=new WS(\"onChange\",\"change\",null,n,r),t.push({event:n,listeners:e}))}var uv=null,Tv=null;function Upe(t){lX(t,0)}function XS(t){var e=sv(t);if(rW(e))return t}function RG(t,e){if(t===\"change\")return e}var pW=!1;gp&&(gp?(GE=\"oninput\"in document,GE||(n6=document.createElement(\"div\"),n6.setAttribute(\"oninput\",\"return;\"),GE=typeof n6.oninput==\"function\"),VE=GE):VE=!1,pW=VE&&(!document.documentMode||9<document.documentMode));var VE,GE,n6;function BG(){uv&&(uv.detachEvent(\"onpropertychange\",AW),Tv=uv=null)}function AW(t){if(t.propertyName===\"value\"&&XS(Tv)){var e=[];dW(e,Tv,t,MD(t)),lW(Upe,e)}}function Vpe(t,e,n){t===\"focusin\"?(BG(),uv=e,Tv=n,uv.attachEvent(\"onpropertychange\",AW)):t===\"focusout\"&&BG()}function Gpe(t){if(t===\"selectionchange\"||t===\"keyup\"||t===\"keydown\")return XS(Tv)}function Hpe(t,e){if(t===\"click\")return XS(e)}function Wpe(t,e){if(t===\"input\"||t===\"change\")return XS(e)}function jpe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Kc=typeof Object.is==\"function\"?Object.is:jpe;function Ev(t,e){if(Kc(t,e))return!0;if(typeof t!=\"object\"||t===null||typeof e!=\"object\"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!D6.call(e,i)||!Kc(t[i],e[i]))return!1}return!0}function DG(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function LG(t,e){var n=DG(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=DG(n)}}function gW(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?gW(t,e.parentNode):\"contains\"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mW(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=_S(t.document);e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href==\"string\"}catch{n=!1}if(n)t=e.contentWindow;else break;e=_S(t.document)}return e}function BD(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e===\"input\"&&(t.type===\"text\"||t.type===\"search\"||t.type===\"tel\"||t.type===\"url\"||t.type===\"password\")||e===\"textarea\"||t.contentEditable===\"true\")}var Xpe=gp&&\"documentMode\"in document&&11>=document.documentMode,M1=null,U6=null,hv=null,V6=!1;function OG(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;V6||M1==null||M1!==_S(r)||(r=M1,\"selectionStart\"in r&&BD(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),hv&&Ev(hv,r)||(hv=r,r=FS(U6,\"onSelect\"),0<r.length&&(e=new WS(\"onSelect\",\"select\",null,e,n),t.push({event:e,listeners:r}),e.target=M1)))}function $g(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n[\"Webkit\"+t]=\"webkit\"+e,n[\"Moz\"+t]=\"moz\"+e,n}var I1={animationend:$g(\"Animation\",\"AnimationEnd\"),animationiteration:$g(\"Animation\",\"AnimationIteration\"),animationstart:$g(\"Animation\",\"AnimationStart\"),transitionrun:$g(\"Transition\",\"TransitionRun\"),transitionstart:$g(\"Transition\",\"TransitionStart\"),transitioncancel:$g(\"Transition\",\"TransitionCancel\"),transitionend:$g(\"Transition\",\"TransitionEnd\")},r6={},_W={};gp&&(_W=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete I1.animationend.animation,delete I1.animationiteration.animation,delete I1.animationstart.animation),\"TransitionEvent\"in window||delete I1.transitionend.transition);function gm(t){if(r6[t])return r6[t];if(!I1[t])return t;var e=I1[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in _W)return r6[t]=e[n];return t}var yW=gm(\"animationend\"),xW=gm(\"animationiteration\"),vW=gm(\"animationstart\"),Ype=gm(\"transitionrun\"),Zpe=gm(\"transitionstart\"),qpe=gm(\"transitioncancel\"),bW=gm(\"transitionend\"),wW=new Map,G6=\"abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel\".split(\" \");G6.push(\"scrollEnd\");function Hh(t,e){wW.set(t,e),pm(e,[t])}var yS=typeof reportError==\"function\"?reportError:function(t){if(typeof window==\"object\"&&typeof window.ErrorEvent==\"function\"){var e=new window.ErrorEvent(\"error\",{bubbles:!0,cancelable:!0,message:typeof t==\"object\"&&t!==null&&typeof t.message==\"string\"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process==\"object\"&&typeof process.emit==\"function\"){process.emit(\"uncaughtException\",t);return}console.error(t)},Du=[],P1=0,DD=0;function YS(){for(var t=P1,e=DD=P1=0;e<t;){var n=Du[e];Du[e++]=null;var r=Du[e];Du[e++]=null;var i=Du[e];Du[e++]=null;var o=Du[e];if(Du[e++]=null,r!==null&&i!==null){var s=r.pending;s===null?i.next=i:(i.next=s.next,s.next=i),r.pending=i}o!==0&&TW(n,i,o)}}function ZS(t,e,n,r){Du[P1++]=t,Du[P1++]=e,Du[P1++]=n,Du[P1++]=r,DD|=r,t.lanes|=r,t=t.alternate,t!==null&&(t.lanes|=r)}function LD(t,e,n,r){return ZS(t,e,n,r),xS(t)}function mm(t,e){return ZS(t,null,null,e),xS(t)}function TW(t,e,n){t.lanes|=n;var r=t.alternate;r!==null&&(r.lanes|=n);for(var i=!1,o=t.return;o!==null;)o.childLanes|=n,r=o.alternate,r!==null&&(r.childLanes|=n),o.tag===22&&(t=o.stateNode,t===null||t._visibility&1||(i=!0)),t=o,o=o.return;return t.tag===3?(o=t.stateNode,i&&e!==null&&(i=31-qc(n),t=o.hiddenUpdates,r=t[i],r===null?t[i]=[e]:r.push(e),e.lane=n|536870912),o):null}function xS(t){if(50<xv)throw xv=0,cD=null,Error(Ht(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var R1={};function Qpe(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jc(t,e,n,r){return new Qpe(t,e,n,r)}function OD(t){return t=t.prototype,!(!t||!t.isReactComponent)}function dp(t,e){var n=t.alternate;return n===null?(n=jc(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&65011712,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function EW(t,e){t.flags&=65011714;var n=t.alternate;return n===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function rS(t,e,n,r,i,o){var s=0;if(r=t,typeof t==\"function\")OD(t)&&(s=1);else if(typeof t==\"string\")s=$0e(t,n,zf.current)?26:t===\"html\"||t===\"head\"||t===\"body\"?27:5;else e:switch(t){case I6:return t=jc(31,n,e,i),t.elementType=I6,t.lanes=o,t;case w1:return om(n.children,i,o,e);case WH:s=8,i|=24;break;case S6:return t=jc(12,n,e,i|2),t.elementType=S6,t.lanes=o,t;case C6:return t=jc(13,n,e,i),t.elementType=C6,t.lanes=o,t;case M6:return t=jc(19,n,e,i),t.elementType=M6,t.lanes=o,t;default:if(typeof t==\"object\"&&t!==null)switch(t.$$typeof){case up:s=10;break e;case jH:s=9;break e;case vD:s=11;break e;case bD:s=14;break e;case j0:s=16,r=null;break e}s=29,n=Error(Ht(130,t===null?\"null\":typeof t,\"\")),r=null}return e=jc(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function om(t,e,n,r){return t=jc(7,t,r,e),t.lanes=n,t}function i6(t,e,n){return t=jc(6,t,null,e),t.lanes=n,t}function SW(t){var e=jc(18,null,null,0);return e.stateNode=t,e}function o6(t,e,n){return e=jc(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var FG=new WeakMap;function Nu(t,e){if(typeof t==\"object\"&&t!==null){var n=FG.get(t);return n!==void 0?n:(e={value:t,source:e,stack:mG(e)},FG.set(t,e),e)}return{value:t,source:e,stack:mG(e)}}var B1=[],D1=0,vS=null,Sv=0,Ou=[],Fu=0,hA=null,Ff=1,kf=\"\";function lp(t,e){B1[D1++]=Sv,B1[D1++]=vS,vS=t,Sv=e}function CW(t,e,n){Ou[Fu++]=Ff,Ou[Fu++]=kf,Ou[Fu++]=hA,hA=t;var r=Ff;t=kf;var i=32-qc(r)-1;r&=~(1<<i),n+=1;var o=32-qc(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Ff=1<<32-qc(e)+i|n<<i|r,kf=o+t}else Ff=1<<o|n<<i|r,kf=t}function FD(t){t.return!==null&&(lp(t,1),CW(t,1,0))}function kD(t){for(;t===vS;)vS=B1[--D1],B1[D1]=null,Sv=B1[--D1],B1[D1]=null;for(;t===hA;)hA=Ou[--Fu],Ou[Fu]=null,kf=Ou[--Fu],Ou[Fu]=null,Ff=Ou[--Fu],Ou[Fu]=null}function MW(t,e){Ou[Fu++]=Ff,Ou[Fu++]=kf,Ou[Fu++]=hA,Ff=e.id,kf=e.overflow,hA=t}var Ga=null,Mo=null,$r=!1,rA=null,zu=!1,H6=Error(Ht(519));function fA(t){var e=Error(Ht(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?\"text\":\"HTML\",\"\"));throw Cv(Nu(e,t)),H6}function kG(t){var e=t.stateNode,n=t.type,r=t.memoizedProps;switch(e[Va]=t,e[mc]=r,n){case\"dialog\":Ur(\"cancel\",e),Ur(\"close\",e);break;case\"iframe\":case\"object\":case\"embed\":Ur(\"load\",e);break;case\"video\":case\"audio\":for(n=0;n<Rv.length;n++)Ur(Rv[n],e);break;case\"source\":Ur(\"error\",e);break;case\"img\":case\"image\":case\"link\":Ur(\"error\",e),Ur(\"load\",e);break;case\"details\":Ur(\"toggle\",e);break;case\"input\":Ur(\"invalid\",e),iW(e,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case\"select\":Ur(\"invalid\",e);break;case\"textarea\":Ur(\"invalid\",e),sW(e,r.value,r.defaultValue,r.children)}n=r.children,typeof n!=\"string\"&&typeof n!=\"number\"&&typeof n!=\"bigint\"||e.textContent===\"\"+n||r.suppressHydrationWarning===!0||uX(e.textContent,n)?(r.popover!=null&&(Ur(\"beforetoggle\",e),Ur(\"toggle\",e)),r.onScroll!=null&&Ur(\"scroll\",e),r.onScrollEnd!=null&&Ur(\"scrollend\",e),r.onClick!=null&&(e.onclick=hp),e=!0):e=!1,e||fA(t,!0)}function NG(t){for(Ga=t.return;Ga;)switch(Ga.tag){case 5:case 31:case 13:zu=!1;return;case 27:case 3:zu=!0;return;default:Ga=Ga.return}}function y1(t){if(t!==Ga)return!1;if(!$r)return NG(t),$r=!0,!1;var e=t.tag,n;if((n=e!==3&&e!==27)&&((n=e===5)&&(n=t.type,n=!(n!==\"form\"&&n!==\"button\")||pD(t.type,t.memoizedProps)),n=!n),n&&Mo&&fA(t),NG(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ht(317));Mo=SH(t)}else if(e===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ht(317));Mo=SH(t)}else e===27?(e=Mo,gA(t.type)?(t=_D,_D=null,Mo=t):Mo=e):Mo=Ga?Vu(t.stateNode.nextSibling):null;return!0}function cm(){Mo=Ga=null,$r=!1}function s6(){var t=rA;return t!==null&&(Ac===null?Ac=t:Ac.push.apply(Ac,t),rA=null),t}function Cv(t){rA===null?rA=[t]:rA.push(t)}var W6=Uf(null),_m=null,fp=null;function Y0(t,e,n){go(W6,e._currentValue),e._currentValue=n}function pp(t){t._currentValue=W6.current,_a(W6)}function j6(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function X6(t,e,n,r){var i=t.child;for(i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){var s=i.child;o=o.firstContext;e:for(;o!==null;){var c=o;o=i;for(var d=0;d<e.length;d++)if(c.context===e[d]){o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),j6(o.return,n,t),r||(s=null);break e}o=c.next}}else if(i.tag===18){if(s=i.return,s===null)throw Error(Ht(341));s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),j6(s,n,t),s=null}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}}function ty(t,e,n,r){t=null;for(var i=e,o=!1;i!==null;){if(!o){if((i.flags&524288)!==0)o=!0;else if((i.flags&262144)!==0)break}if(i.tag===10){var s=i.alternate;if(s===null)throw Error(Ht(387));if(s=s.memoizedProps,s!==null){var c=i.type;Kc(i.pendingProps.value,s.value)||(t!==null?t.push(c):t=[c])}}else if(i===pS.current){if(s=i.alternate,s===null)throw Error(Ht(387));s.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(t!==null?t.push(Dv):t=[Dv])}i=i.return}t!==null&&X6(e,t,n,r),e.flags|=262144}function bS(t){for(t=t.firstContext;t!==null;){if(!Kc(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function um(t){_m=t,fp=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Ha(t){return IW(_m,t)}function HE(t,e){return _m===null&&um(t),IW(t,e)}function IW(t,e){var n=e._currentValue;if(e={context:e,memoizedValue:n,next:null},fp===null){if(t===null)throw Error(Ht(308));fp=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else fp=fp.next=e;return n}var Kpe=typeof AbortController<\"u\"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(n,r){t.push(r)}};this.abort=function(){e.aborted=!0,t.forEach(function(n){return n()})}},Jpe=$s.unstable_scheduleCallback,$pe=$s.unstable_NormalPriority,zs={$$typeof:up,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ND(){return{controller:new Kpe,data:new Map,refCount:0}}function Gv(t){t.refCount--,t.refCount===0&&Jpe($pe,function(){t.controller.abort()})}var fv=null,Y6=0,j1=0,N1=null;function e0e(t,e){if(fv===null){var n=fv=[];Y6=0,j1=cL(),N1={status:\"pending\",value:void 0,then:function(r){n.push(r)}}}return Y6++,e.then(zG,zG),e}function zG(){if(--Y6===0&&fv!==null){N1!==null&&(N1.status=\"fulfilled\");var t=fv;fv=null,j1=0,N1=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function t0e(t,e){var n=[],r={status:\"pending\",value:null,reason:null,then:function(i){n.push(i)}};return t.then(function(){r.status=\"fulfilled\",r.value=e;for(var i=0;i<n.length;i++)(0,n[i])(e)},function(i){for(r.status=\"rejected\",r.reason=i,i=0;i<n.length;i++)(0,n[i])(void 0)}),r}var UG=ar.S;ar.S=function(t,e){Hj=Yc(),typeof e==\"object\"&&e!==null&&typeof e.then==\"function\"&&e0e(t,e),UG!==null&&UG(t,e)};var sm=Uf(null);function zD(){var t=sm.current;return t!==null?t:io.pooledCache}function iS(t,e){e===null?go(sm,sm.current):go(sm,e.pool)}function PW(){var t=zD();return t===null?null:{parent:zs._currentValue,pool:t}}var ny=Error(Ht(460)),UD=Error(Ht(474)),qS=Error(Ht(542)),wS={then:function(){}};function VG(t){return t=t.status,t===\"fulfilled\"||t===\"rejected\"}function RW(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then(hp,hp),e=n),e.status){case\"fulfilled\":return e.value;case\"rejected\":throw t=e.reason,HG(t),t;default:if(typeof e.status==\"string\")e.then(hp,hp);else{if(t=io,t!==null&&100<t.shellSuspendCounter)throw Error(Ht(482));t=e,t.status=\"pending\",t.then(function(r){if(e.status===\"pending\"){var i=e;i.status=\"fulfilled\",i.value=r}},function(r){if(e.status===\"pending\"){var i=e;i.status=\"rejected\",i.reason=r}})}switch(e.status){case\"fulfilled\":return e.value;case\"rejected\":throw t=e.reason,HG(t),t}throw am=e,ny}}function nm(t){try{var e=t._init;return e(t._payload)}catch(n){throw n!==null&&typeof n==\"object\"&&typeof n.then==\"function\"?(am=n,ny):n}}var am=null;function GG(){if(am===null)throw Error(Ht(459));var t=am;return am=null,t}function HG(t){if(t===ny||t===qS)throw Error(Ht(483))}var z1=null,Mv=0;function WE(t){var e=Mv;return Mv+=1,z1===null&&(z1=[]),RW(z1,t,e)}function $x(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function jE(t,e){throw e.$$typeof===Vde?Error(Ht(525)):(t=Object.prototype.toString.call(e),Error(Ht(31,t===\"[object Object]\"?\"object with keys {\"+Object.keys(e).join(\", \")+\"}\":t)))}function BW(t){function e(Y,ee){if(t){var J=Y.deletions;J===null?(Y.deletions=[ee],Y.flags|=16):J.push(ee)}}function n(Y,ee){if(!t)return null;for(;ee!==null;)e(Y,ee),ee=ee.sibling;return null}function r(Y){for(var ee=new Map;Y!==null;)Y.key!==null?ee.set(Y.key,Y):ee.set(Y.index,Y),Y=Y.sibling;return ee}function i(Y,ee){return Y=dp(Y,ee),Y.index=0,Y.sibling=null,Y}function o(Y,ee,J){return Y.index=J,t?(J=Y.alternate,J!==null?(J=J.index,J<ee?(Y.flags|=67108866,ee):J):(Y.flags|=67108866,ee)):(Y.flags|=1048576,ee)}function s(Y){return t&&Y.alternate===null&&(Y.flags|=67108866),Y}function c(Y,ee,J,se){return ee===null||ee.tag!==6?(ee=i6(J,Y.mode,se),ee.return=Y,ee):(ee=i(ee,J),ee.return=Y,ee)}function d(Y,ee,J,se){var xe=J.type;return xe===w1?b(Y,ee,J.props.children,se,J.key):ee!==null&&(ee.elementType===xe||typeof xe==\"object\"&&xe!==null&&xe.$$typeof===j0&&nm(xe)===ee.type)?(ee=i(ee,J.props),$x(ee,J),ee.return=Y,ee):(ee=rS(J.type,J.key,J.props,null,Y.mode,se),$x(ee,J),ee.return=Y,ee)}function m(Y,ee,J,se){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==J.containerInfo||ee.stateNode.implementation!==J.implementation?(ee=o6(J,Y.mode,se),ee.return=Y,ee):(ee=i(ee,J.children||[]),ee.return=Y,ee)}function b(Y,ee,J,se,xe){return ee===null||ee.tag!==7?(ee=om(J,Y.mode,se,xe),ee.return=Y,ee):(ee=i(ee,J),ee.return=Y,ee)}function C(Y,ee,J){if(typeof ee==\"string\"&&ee!==\"\"||typeof ee==\"number\"||typeof ee==\"bigint\")return ee=i6(\"\"+ee,Y.mode,J),ee.return=Y,ee;if(typeof ee==\"object\"&&ee!==null){switch(ee.$$typeof){case OE:return J=rS(ee.type,ee.key,ee.props,null,Y.mode,J),$x(J,ee),J.return=Y,J;case iv:return ee=o6(ee,Y.mode,J),ee.return=Y,ee;case j0:return ee=nm(ee),C(Y,ee,J)}if(ov(ee)||Kx(ee))return ee=om(ee,Y.mode,J,null),ee.return=Y,ee;if(typeof ee.then==\"function\")return C(Y,WE(ee),J);if(ee.$$typeof===up)return C(Y,HE(Y,ee),J);jE(Y,ee)}return null}function B(Y,ee,J,se){var xe=ee!==null?ee.key:null;if(typeof J==\"string\"&&J!==\"\"||typeof J==\"number\"||typeof J==\"bigint\")return xe!==null?null:c(Y,ee,\"\"+J,se);if(typeof J==\"object\"&&J!==null){switch(J.$$typeof){case OE:return J.key===xe?d(Y,ee,J,se):null;case iv:return J.key===xe?m(Y,ee,J,se):null;case j0:return J=nm(J),B(Y,ee,J,se)}if(ov(J)||Kx(J))return xe!==null?null:b(Y,ee,J,se,null);if(typeof J.then==\"function\")return B(Y,ee,WE(J),se);if(J.$$typeof===up)return B(Y,ee,HE(Y,J),se);jE(Y,J)}return null}function k(Y,ee,J,se,xe){if(typeof se==\"string\"&&se!==\"\"||typeof se==\"number\"||typeof se==\"bigint\")return Y=Y.get(J)||null,c(ee,Y,\"\"+se,xe);if(typeof se==\"object\"&&se!==null){switch(se.$$typeof){case OE:return Y=Y.get(se.key===null?J:se.key)||null,d(ee,Y,se,xe);case iv:return Y=Y.get(se.key===null?J:se.key)||null,m(ee,Y,se,xe);case j0:return se=nm(se),k(Y,ee,J,se,xe)}if(ov(se)||Kx(se))return Y=Y.get(J)||null,b(ee,Y,se,xe,null);if(typeof se.then==\"function\")return k(Y,ee,J,WE(se),xe);if(se.$$typeof===up)return k(Y,ee,J,HE(ee,se),xe);jE(ee,se)}return null}function V(Y,ee,J,se){for(var xe=null,Ee=null,Xe=ee,Ne=ee=0,be=null;Xe!==null&&Ne<J.length;Ne++){Xe.index>Ne?(be=Xe,Xe=null):be=Xe.sibling;var ge=B(Y,Xe,J[Ne],se);if(ge===null){Xe===null&&(Xe=be);break}t&&Xe&&ge.alternate===null&&e(Y,Xe),ee=o(ge,ee,Ne),Ee===null?xe=ge:Ee.sibling=ge,Ee=ge,Xe=be}if(Ne===J.length)return n(Y,Xe),$r&&lp(Y,Ne),xe;if(Xe===null){for(;Ne<J.length;Ne++)Xe=C(Y,J[Ne],se),Xe!==null&&(ee=o(Xe,ee,Ne),Ee===null?xe=Xe:Ee.sibling=Xe,Ee=Xe);return $r&&lp(Y,Ne),xe}for(Xe=r(Xe);Ne<J.length;Ne++)be=k(Xe,Y,Ne,J[Ne],se),be!==null&&(t&&be.alternate!==null&&Xe.delete(be.key===null?Ne:be.key),ee=o(be,ee,Ne),Ee===null?xe=be:Ee.sibling=be,Ee=be);return t&&Xe.forEach(function(Qe){return e(Y,Qe)}),$r&&lp(Y,Ne),xe}function q(Y,ee,J,se){if(J==null)throw Error(Ht(151));for(var xe=null,Ee=null,Xe=ee,Ne=ee=0,be=null,ge=J.next();Xe!==null&&!ge.done;Ne++,ge=J.next()){Xe.index>Ne?(be=Xe,Xe=null):be=Xe.sibling;var Qe=B(Y,Xe,ge.value,se);if(Qe===null){Xe===null&&(Xe=be);break}t&&Xe&&Qe.alternate===null&&e(Y,Xe),ee=o(Qe,ee,Ne),Ee===null?xe=Qe:Ee.sibling=Qe,Ee=Qe,Xe=be}if(ge.done)return n(Y,Xe),$r&&lp(Y,Ne),xe;if(Xe===null){for(;!ge.done;Ne++,ge=J.next())ge=C(Y,ge.value,se),ge!==null&&(ee=o(ge,ee,Ne),Ee===null?xe=ge:Ee.sibling=ge,Ee=ge);return $r&&lp(Y,Ne),xe}for(Xe=r(Xe);!ge.done;Ne++,ge=J.next())ge=k(Xe,Y,Ne,ge.value,se),ge!==null&&(t&&ge.alternate!==null&&Xe.delete(ge.key===null?Ne:ge.key),ee=o(ge,ee,Ne),Ee===null?xe=ge:Ee.sibling=ge,Ee=ge);return t&&Xe.forEach(function(Ct){return e(Y,Ct)}),$r&&lp(Y,Ne),xe}function K(Y,ee,J,se){if(typeof J==\"object\"&&J!==null&&J.type===w1&&J.key===null&&(J=J.props.children),typeof J==\"object\"&&J!==null){switch(J.$$typeof){case OE:e:{for(var xe=J.key;ee!==null;){if(ee.key===xe){if(xe=J.type,xe===w1){if(ee.tag===7){n(Y,ee.sibling),se=i(ee,J.props.children),se.return=Y,Y=se;break e}}else if(ee.elementType===xe||typeof xe==\"object\"&&xe!==null&&xe.$$typeof===j0&&nm(xe)===ee.type){n(Y,ee.sibling),se=i(ee,J.props),$x(se,J),se.return=Y,Y=se;break e}n(Y,ee);break}else e(Y,ee);ee=ee.sibling}J.type===w1?(se=om(J.props.children,Y.mode,se,J.key),se.return=Y,Y=se):(se=rS(J.type,J.key,J.props,null,Y.mode,se),$x(se,J),se.return=Y,Y=se)}return s(Y);case iv:e:{for(xe=J.key;ee!==null;){if(ee.key===xe)if(ee.tag===4&&ee.stateNode.containerInfo===J.containerInfo&&ee.stateNode.implementation===J.implementation){n(Y,ee.sibling),se=i(ee,J.children||[]),se.return=Y,Y=se;break e}else{n(Y,ee);break}else e(Y,ee);ee=ee.sibling}se=o6(J,Y.mode,se),se.return=Y,Y=se}return s(Y);case j0:return J=nm(J),K(Y,ee,J,se)}if(ov(J))return V(Y,ee,J,se);if(Kx(J)){if(xe=Kx(J),typeof xe!=\"function\")throw Error(Ht(150));return J=xe.call(J),q(Y,ee,J,se)}if(typeof J.then==\"function\")return K(Y,ee,WE(J),se);if(J.$$typeof===up)return K(Y,ee,HE(Y,J),se);jE(Y,J)}return typeof J==\"string\"&&J!==\"\"||typeof J==\"number\"||typeof J==\"bigint\"?(J=\"\"+J,ee!==null&&ee.tag===6?(n(Y,ee.sibling),se=i(ee,J),se.return=Y,Y=se):(n(Y,ee),se=i6(J,Y.mode,se),se.return=Y,Y=se),s(Y)):n(Y,ee)}return function(Y,ee,J,se){try{Mv=0;var xe=K(Y,ee,J,se);return z1=null,xe}catch(Xe){if(Xe===ny||Xe===qS)throw Xe;var Ee=jc(29,Xe,null,Y.mode);return Ee.lanes=se,Ee.return=Y,Ee}finally{}}}var hm=BW(!0),DW=BW(!1),X0=!1;function VD(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Z6(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function iA(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function oA(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,(Ei&2)!==0){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,e=xS(t),TW(t,null,n),e}return ZS(t,r,e,n),xS(t)}function dv(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194048)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,KH(t,n)}}function a6(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,callbacks:r.callbacks},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}var q6=!1;function pv(){if(q6){var t=N1;if(t!==null)throw t}}function Av(t,e,n,r){q6=!1;var i=t.updateQueue;X0=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var d=c,m=d.next;d.next=null,s===null?o=m:s.next=m,s=d;var b=t.alternate;b!==null&&(b=b.updateQueue,c=b.lastBaseUpdate,c!==s&&(c===null?b.firstBaseUpdate=m:c.next=m,b.lastBaseUpdate=d))}if(o!==null){var C=i.baseState;s=0,b=m=d=null,c=o;do{var B=c.lane&-536870913,k=B!==c.lane;if(k?(jr&B)===B:(r&B)===B){B!==0&&B===j1&&(q6=!0),b!==null&&(b=b.next={lane:0,tag:c.tag,payload:c.payload,callback:null,next:null});e:{var V=t,q=c;B=e;var K=n;switch(q.tag){case 1:if(V=q.payload,typeof V==\"function\"){C=V.call(K,C,B);break e}C=V;break e;case 3:V.flags=V.flags&-65537|128;case 0:if(V=q.payload,B=typeof V==\"function\"?V.call(K,C,B):V,B==null)break e;C=Io({},C,B);break e;case 2:X0=!0}}B=c.callback,B!==null&&(t.flags|=64,k&&(t.flags|=8192),k=i.callbacks,k===null?i.callbacks=[B]:k.push(B))}else k={lane:B,tag:c.tag,payload:c.payload,callback:c.callback,next:null},b===null?(m=b=k,d=C):b=b.next=k,s|=B;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;k=c,c=k.next,k.next=null,i.lastBaseUpdate=k,i.shared.pending=null}}while(!0);b===null&&(d=C),i.baseState=d,i.firstBaseUpdate=m,i.lastBaseUpdate=b,o===null&&(i.shared.lanes=0),pA|=s,t.lanes=s,t.memoizedState=C}}function LW(t,e){if(typeof t!=\"function\")throw Error(Ht(191,t));t.call(e)}function OW(t,e){var n=t.callbacks;if(n!==null)for(t.callbacks=null,t=0;t<n.length;t++)LW(n[t],e)}var X1=Uf(null),TS=Uf(0);function WG(t,e){t=xp,go(TS,t),go(X1,e),xp=t|e.baseLanes}function Q6(){go(TS,xp),go(X1,X1.current)}function GD(){xp=TS.current,_a(X1),_a(TS)}var Jc=Uf(null),Uu=null;function Z0(t){var e=t.alternate;go(As,As.current&1),go(Jc,t),Uu===null&&(e===null||X1.current!==null||e.memoizedState!==null)&&(Uu=t)}function K6(t){go(As,As.current),go(Jc,t),Uu===null&&(Uu=t)}function FW(t){t.tag===22?(go(As,As.current),go(Jc,t),Uu===null&&(Uu=t)):q0(t)}function q0(){go(As,As.current),go(Jc,Jc.current)}function Wc(t){_a(Jc),Uu===t&&(Uu=null),_a(As)}var As=Uf(0);function ES(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||gD(n)||mD(n)))return e}else if(e.tag===19&&(e.memoizedProps.revealOrder===\"forwards\"||e.memoizedProps.revealOrder===\"backwards\"||e.memoizedProps.revealOrder===\"unstable_legacy-backwards\"||e.memoizedProps.revealOrder===\"together\")){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mp=0,vr=null,Qi=null,ks=null,SS=!1,U1=!1,fm=!1,CS=0,Iv=0,V1=null,n0e=0;function is(){throw Error(Ht(321))}function HD(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Kc(t[n],e[n]))return!1;return!0}function WD(t,e,n,r,i,o){return mp=o,vr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ar.H=t===null||t.memoizedState===null?dj:tL,fm=!1,o=n(r,i),fm=!1,U1&&(o=NW(e,n,r,i)),kW(t),o}function kW(t){ar.H=Pv;var e=Qi!==null&&Qi.next!==null;if(mp=0,ks=Qi=vr=null,SS=!1,Iv=0,V1=null,e)throw Error(Ht(300));t===null||Us||(t=t.dependencies,t!==null&&bS(t)&&(Us=!0))}function NW(t,e,n,r){vr=t;var i=0;do{if(U1&&(V1=null),Iv=0,U1=!1,25<=i)throw Error(Ht(301));if(i+=1,ks=Qi=null,t.updateQueue!=null){var o=t.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,o.memoCache!=null&&(o.memoCache.index=0)}ar.H=pj,o=e(n,r)}while(U1);return o}function r0e(){var t=ar.H,e=t.useState()[0];return e=typeof e.then==\"function\"?Hv(e):e,t=t.useState()[0],(Qi!==null?Qi.memoizedState:null)!==t&&(vr.flags|=1024),e}function jD(){var t=CS!==0;return CS=0,t}function XD(t,e,n){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n}function YD(t){if(SS){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}SS=!1}mp=0,ks=Qi=vr=null,U1=!1,Iv=CS=0,V1=null}function Wl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ks===null?vr.memoizedState=ks=t:ks=ks.next=t,ks}function gs(){if(Qi===null){var t=vr.alternate;t=t!==null?t.memoizedState:null}else t=Qi.next;var e=ks===null?vr.memoizedState:ks.next;if(e!==null)ks=e,Qi=t;else{if(t===null)throw vr.alternate===null?Error(Ht(467)):Error(Ht(310));Qi=t,t={memoizedState:Qi.memoizedState,baseState:Qi.baseState,baseQueue:Qi.baseQueue,queue:Qi.queue,next:null},ks===null?vr.memoizedState=ks=t:ks=ks.next=t}return ks}function QS(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Hv(t){var e=Iv;return Iv+=1,V1===null&&(V1=[]),t=RW(V1,t,e),e=vr,(ks===null?e.memoizedState:ks.next)===null&&(e=e.alternate,ar.H=e===null||e.memoizedState===null?dj:tL),t}function KS(t){if(t!==null&&typeof t==\"object\"){if(typeof t.then==\"function\")return Hv(t);if(t.$$typeof===up)return Ha(t)}throw Error(Ht(438,String(t)))}function ZD(t){var e=null,n=vr.updateQueue;if(n!==null&&(e=n.memoCache),e==null){var r=vr.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(e={data:r.data.map(function(i){return i.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),n===null&&(n=QS(),vr.updateQueue=n),n.memoCache=e,n=e.data[e.index],n===void 0)for(n=e.data[e.index]=Array(t),r=0;r<t;r++)n[r]=Gde;return e.index++,n}function _p(t,e){return typeof e==\"function\"?e(t):e}function oS(t){var e=gs();return qD(e,Qi,t)}function qD(t,e,n){var r=t.queue;if(r===null)throw Error(Ht(311));r.lastRenderedReducer=n;var i=t.baseQueue,o=r.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}e.baseQueue=i=o,r.pending=null}if(o=t.baseState,i===null)t.memoizedState=o;else{e=i.next;var c=s=null,d=null,m=e,b=!1;do{var C=m.lane&-536870913;if(C!==m.lane?(jr&C)===C:(mp&C)===C){var B=m.revertLane;if(B===0)d!==null&&(d=d.next={lane:0,revertLane:0,gesture:null,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),C===j1&&(b=!0);else if((mp&B)===B){m=m.next,B===j1&&(b=!0);continue}else C={lane:0,revertLane:m.revertLane,gesture:null,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null},d===null?(c=d=C,s=o):d=d.next=C,vr.lanes|=B,pA|=B;C=m.action,fm&&n(o,C),o=m.hasEagerState?m.eagerState:n(o,C)}else B={lane:C,revertLane:m.revertLane,gesture:m.gesture,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null},d===null?(c=d=B,s=o):d=d.next=B,vr.lanes|=C,pA|=C;m=m.next}while(m!==null&&m!==e);if(d===null?s=o:d.next=c,!Kc(o,t.memoizedState)&&(Us=!0,b&&(n=N1,n!==null)))throw n;t.memoizedState=o,t.baseState=s,t.baseQueue=d,r.lastRenderedState=o}return i===null&&(r.lanes=0),[t.memoizedState,r.dispatch]}function l6(t){var e=gs(),n=e.queue;if(n===null)throw Error(Ht(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);Kc(o,e.memoizedState)||(Us=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function zW(t,e,n){var r=vr,i=gs(),o=$r;if(o){if(n===void 0)throw Error(Ht(407));n=n()}else n=e();var s=!Kc((Qi||i).memoizedState,n);if(s&&(i.memoizedState=n,Us=!0),i=i.queue,QD(GW.bind(null,r,i,t),[t]),i.getSnapshot!==e||s||ks!==null&&ks.memoizedState.tag&1){if(r.flags|=2048,Y1(9,{destroy:void 0},VW.bind(null,r,i,n,e),null),io===null)throw Error(Ht(349));o||(mp&127)!==0||UW(r,e,n)}return n}function UW(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=vr.updateQueue,e===null?(e=QS(),vr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function VW(t,e,n,r){e.value=n,e.getSnapshot=r,HW(e)&&WW(t)}function GW(t,e,n){return n(function(){HW(e)&&WW(t)})}function HW(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Kc(t,n)}catch{return!0}}function WW(t){var e=mm(t,2);e!==null&&gc(e,t,2)}function J6(t){var e=Wl();if(typeof t==\"function\"){var n=t;if(t=n(),fm){K0(!0);try{n()}finally{K0(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_p,lastRenderedState:t},e}function jW(t,e,n,r){return t.baseState=n,qD(t,Qi,typeof r==\"function\"?r:_p)}function i0e(t,e,n,r,i){if($S(t))throw Error(Ht(485));if(t=e.action,t!==null){var o={payload:i,action:t,next:null,isTransition:!0,status:\"pending\",value:null,reason:null,listeners:[],then:function(s){o.listeners.push(s)}};ar.T!==null?n(!0):o.isTransition=!1,r(o),n=e.pending,n===null?(o.next=e.pending=o,XW(e,o)):(o.next=n.next,e.pending=n.next=o)}}function XW(t,e){var n=e.action,r=e.payload,i=t.state;if(e.isTransition){var o=ar.T,s={};ar.T=s;try{var c=n(i,r),d=ar.S;d!==null&&d(s,c),jG(t,e,c)}catch(m){$6(t,e,m)}finally{o!==null&&s.types!==null&&(o.types=s.types),ar.T=o}}else try{o=n(i,r),jG(t,e,o)}catch(m){$6(t,e,m)}}function jG(t,e,n){n!==null&&typeof n==\"object\"&&typeof n.then==\"function\"?n.then(function(r){XG(t,e,r)},function(r){return $6(t,e,r)}):XG(t,e,n)}function XG(t,e,n){e.status=\"fulfilled\",e.value=n,YW(e),t.state=n,e=t.pending,e!==null&&(n=e.next,n===e?t.pending=null:(n=n.next,e.next=n,XW(t,n)))}function $6(t,e,n){var r=t.pending;if(t.pending=null,r!==null){r=r.next;do e.status=\"rejected\",e.reason=n,YW(e),e=e.next;while(e!==r)}t.action=null}function YW(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function ZW(t,e){return e}function YG(t,e){if($r){var n=io.formState;if(n!==null){e:{var r=vr;if($r){if(Mo){t:{for(var i=Mo,o=zu;i.nodeType!==8;){if(!o){i=null;break t}if(i=Vu(i.nextSibling),i===null){i=null;break t}}o=i.data,i=o===\"F!\"||o===\"F\"?i:null}if(i){Mo=Vu(i.nextSibling),r=i.data===\"F!\";break e}}fA(r)}r=!1}r&&(e=n[0])}}return n=Wl(),n.memoizedState=n.baseState=e,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ZW,lastRenderedState:e},n.queue=r,n=uj.bind(null,vr,r),r.dispatch=n,r=J6(!1),o=eL.bind(null,vr,!1,r.queue),r=Wl(),i={state:e,dispatch:null,action:t,pending:null},r.queue=i,n=i0e.bind(null,vr,i,o,n),i.dispatch=n,r.memoizedState=t,[e,n,!1]}function ZG(t){var e=gs();return qW(e,Qi,t)}function qW(t,e,n){if(e=qD(t,e,ZW)[0],t=oS(_p)[0],typeof e==\"object\"&&e!==null&&typeof e.then==\"function\")try{var r=Hv(e)}catch(s){throw s===ny?qS:s}else r=e;e=gs();var i=e.queue,o=i.dispatch;return n!==e.memoizedState&&(vr.flags|=2048,Y1(9,{destroy:void 0},o0e.bind(null,i,n),null)),[r,o,t]}function o0e(t,e){t.action=e}function qG(t){var e=gs(),n=Qi;if(n!==null)return qW(e,n,t);gs(),e=e.memoizedState,n=gs();var r=n.queue.dispatch;return n.memoizedState=t,[e,r,!1]}function Y1(t,e,n,r){return t={tag:t,create:n,deps:r,inst:e,next:null},e=vr.updateQueue,e===null&&(e=QS(),vr.updateQueue=e),n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function QW(){return gs().memoizedState}function sS(t,e,n,r){var i=Wl();vr.flags|=t,i.memoizedState=Y1(1|e,{destroy:void 0},n,r===void 0?null:r)}function JS(t,e,n,r){var i=gs();r=r===void 0?null:r;var o=i.memoizedState.inst;Qi!==null&&r!==null&&HD(r,Qi.memoizedState.deps)?i.memoizedState=Y1(e,o,n,r):(vr.flags|=t,i.memoizedState=Y1(1|e,o,n,r))}function QG(t,e){sS(8390656,8,t,e)}function QD(t,e){JS(2048,8,t,e)}function s0e(t){vr.flags|=4;var e=vr.updateQueue;if(e===null)e=QS(),vr.updateQueue=e,e.events=[t];else{var n=e.events;n===null?e.events=[t]:n.push(t)}}function KW(t){var e=gs().memoizedState;return s0e({ref:e,nextImpl:t}),function(){if((Ei&2)!==0)throw Error(Ht(440));return e.impl.apply(void 0,arguments)}}function JW(t,e){return JS(4,2,t,e)}function $W(t,e){return JS(4,4,t,e)}function ej(t,e){if(typeof e==\"function\"){t=t();var n=e(t);return function(){typeof n==\"function\"?n():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function tj(t,e,n){n=n!=null?n.concat([t]):null,JS(4,4,ej.bind(null,e,t),n)}function KD(){}function nj(t,e){var n=gs();e=e===void 0?null:e;var r=n.memoizedState;return e!==null&&HD(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function rj(t,e){var n=gs();e=e===void 0?null:e;var r=n.memoizedState;if(e!==null&&HD(e,r[1]))return r[0];if(r=t(),fm){K0(!0);try{t()}finally{K0(!1)}}return n.memoizedState=[r,e],r}function JD(t,e,n){return n===void 0||(mp&1073741824)!==0&&(jr&261930)===0?t.memoizedState=e:(t.memoizedState=n,t=jj(),vr.lanes|=t,pA|=t,n)}function ij(t,e,n,r){return Kc(n,e)?n:X1.current!==null?(t=JD(t,n,r),Kc(t,e)||(Us=!0),t):(mp&42)===0||(mp&1073741824)!==0&&(jr&261930)===0?(Us=!0,t.memoizedState=n):(t=jj(),vr.lanes|=t,pA|=t,e)}function oj(t,e,n,r,i){var o=Si.p;Si.p=o!==0&&8>o?o:8;var s=ar.T,c={};ar.T=c,eL(t,!1,e,n);try{var d=i(),m=ar.S;if(m!==null&&m(c,d),d!==null&&typeof d==\"object\"&&typeof d.then==\"function\"){var b=t0e(d,r);gv(t,e,b,Qc(t))}else gv(t,e,r,Qc(t))}catch(C){gv(t,e,{then:function(){},status:\"rejected\",reason:C},Qc())}finally{Si.p=o,s!==null&&c.types!==null&&(s.types=c.types),ar.T=s}}function a0e(){}function eD(t,e,n,r){if(t.tag!==5)throw Error(Ht(476));var i=sj(t).queue;oj(t,i,e,im,n===null?a0e:function(){return aj(t),n(r)})}function sj(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:im,baseState:im,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_p,lastRenderedState:im},next:null};var n={};return e.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_p,lastRenderedState:n},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function aj(t){var e=sj(t);e.next===null&&(e=t.alternate.memoizedState),gv(t,e.next.queue,{},Qc())}function $D(){return Ha(Dv)}function lj(){return gs().memoizedState}function cj(){return gs().memoizedState}function l0e(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var n=Qc();t=iA(n);var r=oA(e,t,n);r!==null&&(gc(r,e,n),dv(r,e,n)),e={cache:ND()},t.payload=e;return}e=e.return}}function c0e(t,e,n){var r=Qc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},$S(t)?hj(e,n):(n=LD(t,e,n,r),n!==null&&(gc(n,t,r),fj(n,e,r)))}function uj(t,e,n){var r=Qc();gv(t,e,n,r)}function gv(t,e,n,r){var i={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if($S(t))hj(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,c=o(s,n);if(i.hasEagerState=!0,i.eagerState=c,Kc(c,s))return ZS(t,e,i,0),io===null&&YS(),!1}catch{}finally{}if(n=LD(t,e,i,r),n!==null)return gc(n,t,r),fj(n,e,r),!0}return!1}function eL(t,e,n,r){if(r={lane:2,revertLane:cL(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},$S(t)){if(e)throw Error(Ht(479))}else e=LD(t,n,r,2),e!==null&&gc(e,t,2)}function $S(t){var e=t.alternate;return t===vr||e!==null&&e===vr}function hj(t,e){U1=SS=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function fj(t,e,n){if((n&4194048)!==0){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,KH(t,n)}}var Pv={readContext:Ha,use:KS,useCallback:is,useContext:is,useEffect:is,useImperativeHandle:is,useLayoutEffect:is,useInsertionEffect:is,useMemo:is,useReducer:is,useRef:is,useState:is,useDebugValue:is,useDeferredValue:is,useTransition:is,useSyncExternalStore:is,useId:is,useHostTransitionStatus:is,useFormState:is,useActionState:is,useOptimistic:is,useMemoCache:is,useCacheRefresh:is};Pv.useEffectEvent=is;var dj={readContext:Ha,use:KS,useCallback:function(t,e){return Wl().memoizedState=[t,e===void 0?null:e],t},useContext:Ha,useEffect:QG,useImperativeHandle:function(t,e,n){n=n!=null?n.concat([t]):null,sS(4194308,4,ej.bind(null,e,t),n)},useLayoutEffect:function(t,e){return sS(4194308,4,t,e)},useInsertionEffect:function(t,e){sS(4,2,t,e)},useMemo:function(t,e){var n=Wl();e=e===void 0?null:e;var r=t();if(fm){K0(!0);try{t()}finally{K0(!1)}}return n.memoizedState=[r,e],r},useReducer:function(t,e,n){var r=Wl();if(n!==void 0){var i=n(e);if(fm){K0(!0);try{n(e)}finally{K0(!1)}}}else i=e;return r.memoizedState=r.baseState=i,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},r.queue=t,t=t.dispatch=c0e.bind(null,vr,t),[r.memoizedState,t]},useRef:function(t){var e=Wl();return t={current:t},e.memoizedState=t},useState:function(t){t=J6(t);var e=t.queue,n=uj.bind(null,vr,e);return e.dispatch=n,[t.memoizedState,n]},useDebugValue:KD,useDeferredValue:function(t,e){var n=Wl();return JD(n,t,e)},useTransition:function(){var t=J6(!1);return t=oj.bind(null,vr,t.queue,!0,!1),Wl().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,n){var r=vr,i=Wl();if($r){if(n===void 0)throw Error(Ht(407));n=n()}else{if(n=e(),io===null)throw Error(Ht(349));(jr&127)!==0||UW(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,QG(GW.bind(null,r,o,t),[t]),r.flags|=2048,Y1(9,{destroy:void 0},VW.bind(null,r,o,n,e),null),n},useId:function(){var t=Wl(),e=io.identifierPrefix;if($r){var n=kf,r=Ff;n=(r&~(1<<32-qc(r)-1)).toString(32)+n,e=\"_\"+e+\"R_\"+n,n=CS++,0<n&&(e+=\"H\"+n.toString(32)),e+=\"_\"}else n=n0e++,e=\"_\"+e+\"r_\"+n.toString(32)+\"_\";return t.memoizedState=e},useHostTransitionStatus:$D,useFormState:YG,useActionState:YG,useOptimistic:function(t){var e=Wl();e.memoizedState=e.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=n,e=eL.bind(null,vr,!0,n),n.dispatch=e,[t,e]},useMemoCache:ZD,useCacheRefresh:function(){return Wl().memoizedState=l0e.bind(null,vr)},useEffectEvent:function(t){var e=Wl(),n={impl:t};return e.memoizedState=n,function(){if((Ei&2)!==0)throw Error(Ht(440));return n.impl.apply(void 0,arguments)}}},tL={readContext:Ha,use:KS,useCallback:nj,useContext:Ha,useEffect:QD,useImperativeHandle:tj,useInsertionEffect:JW,useLayoutEffect:$W,useMemo:rj,useReducer:oS,useRef:QW,useState:function(){return oS(_p)},useDebugValue:KD,useDeferredValue:function(t,e){var n=gs();return ij(n,Qi.memoizedState,t,e)},useTransition:function(){var t=oS(_p)[0],e=gs().memoizedState;return[typeof t==\"boolean\"?t:Hv(t),e]},useSyncExternalStore:zW,useId:lj,useHostTransitionStatus:$D,useFormState:ZG,useActionState:ZG,useOptimistic:function(t,e){var n=gs();return jW(n,Qi,t,e)},useMemoCache:ZD,useCacheRefresh:cj};tL.useEffectEvent=KW;var pj={readContext:Ha,use:KS,useCallback:nj,useContext:Ha,useEffect:QD,useImperativeHandle:tj,useInsertionEffect:JW,useLayoutEffect:$W,useMemo:rj,useReducer:l6,useRef:QW,useState:function(){return l6(_p)},useDebugValue:KD,useDeferredValue:function(t,e){var n=gs();return Qi===null?JD(n,t,e):ij(n,Qi.memoizedState,t,e)},useTransition:function(){var t=l6(_p)[0],e=gs().memoizedState;return[typeof t==\"boolean\"?t:Hv(t),e]},useSyncExternalStore:zW,useId:lj,useHostTransitionStatus:$D,useFormState:qG,useActionState:qG,useOptimistic:function(t,e){var n=gs();return Qi!==null?jW(n,Qi,t,e):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:ZD,useCacheRefresh:cj};pj.useEffectEvent=KW;function c6(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Io({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var tD={enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Qc(),i=iA(r);i.payload=e,n!=null&&(i.callback=n),e=oA(t,i,r),e!==null&&(gc(e,t,r),dv(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Qc(),i=iA(r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=oA(t,i,r),e!==null&&(gc(e,t,r),dv(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Qc(),r=iA(n);r.tag=2,e!=null&&(r.callback=e),e=oA(t,r,n),e!==null&&(gc(e,t,n),dv(e,t,n))}};function KG(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate==\"function\"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Ev(n,r)||!Ev(i,o):!0}function JG(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps==\"function\"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps==\"function\"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&tD.enqueueReplaceState(e,e.state,null)}function dm(t,e){var n=e;if(\"ref\"in e){n={};for(var r in e)r!==\"ref\"&&(n[r]=e[r])}if(t=t.defaultProps){n===e&&(n=Io({},n));for(var i in t)n[i]===void 0&&(n[i]=t[i])}return n}function Aj(t){yS(t)}function gj(t){console.error(t)}function mj(t){yS(t)}function MS(t,e){try{var n=t.onUncaughtError;n(e.value,{componentStack:e.stack})}catch(r){setTimeout(function(){throw r})}}function $G(t,e,n){try{var r=t.onCaughtError;r(n.value,{componentStack:n.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function nD(t,e,n){return n=iA(n),n.tag=3,n.payload={element:null},n.callback=function(){MS(t,e)},n}function _j(t){return t=iA(t),t.tag=3,t}function yj(t,e,n,r){var i=n.type.getDerivedStateFromError;if(typeof i==\"function\"){var o=r.value;t.payload=function(){return i(o)},t.callback=function(){$G(e,n,r)}}var s=n.stateNode;s!==null&&typeof s.componentDidCatch==\"function\"&&(t.callback=function(){$G(e,n,r),typeof i!=\"function\"&&(sA===null?sA=new Set([this]):sA.add(this));var c=r.stack;this.componentDidCatch(r.value,{componentStack:c!==null?c:\"\"})})}function u0e(t,e,n,r,i){if(n.flags|=32768,r!==null&&typeof r==\"object\"&&typeof r.then==\"function\"){if(e=n.alternate,e!==null&&ty(e,n,i,!0),n=Jc.current,n!==null){switch(n.tag){case 31:case 13:return Uu===null?DS():n.alternate===null&&os===0&&(os=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===wS?n.flags|=16384:(e=n.updateQueue,e===null?n.updateQueue=new Set([r]):e.add(r),x6(t,r,i)),!1;case 22:return n.flags|=65536,r===wS?n.flags|=16384:(e=n.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=e):(n=e.retryQueue,n===null?e.retryQueue=new Set([r]):n.add(r)),x6(t,r,i)),!1}throw Error(Ht(435,n.tag))}return x6(t,r,i),DS(),!1}if($r)return e=Jc.current,e!==null?((e.flags&65536)===0&&(e.flags|=256),e.flags|=65536,e.lanes=i,r!==H6&&(t=Error(Ht(422),{cause:r}),Cv(Nu(t,n)))):(r!==H6&&(e=Error(Ht(423),{cause:r}),Cv(Nu(e,n))),t=t.current.alternate,t.flags|=65536,i&=-i,t.lanes|=i,r=Nu(r,n),i=nD(t.stateNode,r,i),a6(t,i),os!==4&&(os=2)),!1;var o=Error(Ht(520),{cause:r});if(o=Nu(o,n),yv===null?yv=[o]:yv.push(o),os!==4&&(os=2),e===null)return!0;r=Nu(r,n),n=e;do{switch(n.tag){case 3:return n.flags|=65536,t=i&-i,n.lanes|=t,t=nD(n.stateNode,r,t),a6(n,t),!1;case 1:if(e=n.type,o=n.stateNode,(n.flags&128)===0&&(typeof e.getDerivedStateFromError==\"function\"||o!==null&&typeof o.componentDidCatch==\"function\"&&(sA===null||!sA.has(o))))return n.flags|=65536,i&=-i,n.lanes|=i,i=_j(i),yj(i,t,n,r),a6(n,i),!1}n=n.return}while(n!==null);return!1}var nL=Error(Ht(461)),Us=!1;function Ua(t,e,n,r){e.child=t===null?DW(e,null,n,r):hm(e,t.child,n,r)}function eH(t,e,n,r,i){n=n.render;var o=e.ref;if(\"ref\"in r){var s={};for(var c in r)c!==\"ref\"&&(s[c]=r[c])}else s=r;return um(e),r=WD(t,e,n,s,o,i),c=jD(),t!==null&&!Us?(XD(t,e,i),yp(t,e,i)):($r&&c&&FD(e),e.flags|=1,Ua(t,e,r,i),e.child)}function tH(t,e,n,r,i){if(t===null){var o=n.type;return typeof o==\"function\"&&!OD(o)&&o.defaultProps===void 0&&n.compare===null?(e.tag=15,e.type=o,xj(t,e,o,r,i)):(t=rS(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!rL(t,i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Ev,n(s,r)&&t.ref===e.ref)return yp(t,e,i)}return e.flags|=1,t=dp(o,r),t.ref=e.ref,t.return=e,e.child=t}function xj(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Ev(o,r)&&t.ref===e.ref)if(Us=!1,e.pendingProps=r=o,rL(t,i))(t.flags&131072)!==0&&(Us=!0);else return e.lanes=t.lanes,yp(t,e,i)}return rD(t,e,n,r,i)}function vj(t,e,n,r){var i=r.children,o=t!==null?t.memoizedState:null;if(t===null&&e.stateNode===null&&(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode===\"hidden\"){if((e.flags&128)!==0){if(o=o!==null?o.baseLanes|n:n,t!==null){for(r=e.child=t.child,i=0;r!==null;)i=i|r.lanes|r.childLanes,r=r.sibling;r=i&~o}else r=0,e.child=null;return nH(t,e,o,n,r)}if((n&536870912)!==0)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&iS(e,o!==null?o.cachePool:null),o!==null?WG(e,o):Q6(),FW(e);else return r=e.lanes=536870912,nH(t,e,o!==null?o.baseLanes|n:n,n,r)}else o!==null?(iS(e,o.cachePool),WG(e,o),q0(e),e.memoizedState=null):(t!==null&&iS(e,null),Q6(),q0(e));return Ua(t,e,i,n),e.child}function av(t,e){return t!==null&&t.tag===22||e.stateNode!==null||(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),e.sibling}function nH(t,e,n,r,i){var o=zD();return o=o===null?null:{parent:zs._currentValue,pool:o},e.memoizedState={baseLanes:n,cachePool:o},t!==null&&iS(e,null),Q6(),FW(e),t!==null&&ty(t,e,r,!0),e.childLanes=i,null}function aS(t,e){return e=IS({mode:e.mode,children:e.children},t.mode),e.ref=t.ref,t.child=e,e.return=t,e}function rH(t,e,n){return hm(e,t.child,null,n),t=aS(e,e.pendingProps),t.flags|=2,Wc(e),e.memoizedState=null,t}function h0e(t,e,n){var r=e.pendingProps,i=(e.flags&128)!==0;if(e.flags&=-129,t===null){if($r){if(r.mode===\"hidden\")return t=aS(e,r),e.lanes=536870912,av(null,t);if(K6(e),(t=Mo)?(t=dX(t,zu),t=t!==null&&t.data===\"&\"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:hA!==null?{id:Ff,overflow:kf}:null,retryLane:536870912,hydrationErrors:null},n=SW(t),n.return=e,e.child=n,Ga=e,Mo=null)):t=null,t===null)throw fA(e);return e.lanes=536870912,null}return aS(e,r)}var o=t.memoizedState;if(o!==null){var s=o.dehydrated;if(K6(e),i)if(e.flags&256)e.flags&=-257,e=rH(t,e,n);else if(e.memoizedState!==null)e.child=t.child,e.flags|=128,e=null;else throw Error(Ht(558));else if(Us||ty(t,e,n,!1),i=(n&t.childLanes)!==0,Us||i){if(r=io,r!==null&&(s=JH(r,n),s!==0&&s!==o.retryLane))throw o.retryLane=s,mm(t,s),gc(r,t,s),nL;DS(),e=rH(t,e,n)}else t=o.treeContext,Mo=Vu(s.nextSibling),Ga=e,$r=!0,rA=null,zu=!1,t!==null&&MW(e,t),e=aS(e,r),e.flags|=4096;return e}return t=dp(t.child,{mode:r.mode,children:r.children}),t.ref=e.ref,e.child=t,t.return=e,t}function lS(t,e){var n=e.ref;if(n===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof n!=\"function\"&&typeof n!=\"object\")throw Error(Ht(284));(t===null||t.ref!==n)&&(e.flags|=4194816)}}function rD(t,e,n,r,i){return um(e),n=WD(t,e,n,r,void 0,i),r=jD(),t!==null&&!Us?(XD(t,e,i),yp(t,e,i)):($r&&r&&FD(e),e.flags|=1,Ua(t,e,n,i),e.child)}function iH(t,e,n,r,i,o){return um(e),e.updateQueue=null,n=NW(e,r,n,i),kW(t),r=jD(),t!==null&&!Us?(XD(t,e,o),yp(t,e,o)):($r&&r&&FD(e),e.flags|=1,Ua(t,e,n,o),e.child)}function oH(t,e,n,r,i){if(um(e),e.stateNode===null){var o=R1,s=n.contextType;typeof s==\"object\"&&s!==null&&(o=Ha(s)),o=new n(r,o),e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=tD,e.stateNode=o,o._reactInternals=e,o=e.stateNode,o.props=r,o.state=e.memoizedState,o.refs={},VD(e),s=n.contextType,o.context=typeof s==\"object\"&&s!==null?Ha(s):R1,o.state=e.memoizedState,s=n.getDerivedStateFromProps,typeof s==\"function\"&&(c6(e,n,s,r),o.state=e.memoizedState),typeof n.getDerivedStateFromProps==\"function\"||typeof o.getSnapshotBeforeUpdate==\"function\"||typeof o.UNSAFE_componentWillMount!=\"function\"&&typeof o.componentWillMount!=\"function\"||(s=o.state,typeof o.componentWillMount==\"function\"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount==\"function\"&&o.UNSAFE_componentWillMount(),s!==o.state&&tD.enqueueReplaceState(o,o.state,null),Av(e,r,o,i),pv(),o.state=e.memoizedState),typeof o.componentDidMount==\"function\"&&(e.flags|=4194308),r=!0}else if(t===null){o=e.stateNode;var c=e.memoizedProps,d=dm(n,c);o.props=d;var m=o.context,b=n.contextType;s=R1,typeof b==\"object\"&&b!==null&&(s=Ha(b));var C=n.getDerivedStateFromProps;b=typeof C==\"function\"||typeof o.getSnapshotBeforeUpdate==\"function\",c=e.pendingProps!==c,b||typeof o.UNSAFE_componentWillReceiveProps!=\"function\"&&typeof o.componentWillReceiveProps!=\"function\"||(c||m!==s)&&JG(e,o,r,s),X0=!1;var B=e.memoizedState;o.state=B,Av(e,r,o,i),pv(),m=e.memoizedState,c||B!==m||X0?(typeof C==\"function\"&&(c6(e,n,C,r),m=e.memoizedState),(d=X0||KG(e,n,d,r,B,m,s))?(b||typeof o.UNSAFE_componentWillMount!=\"function\"&&typeof o.componentWillMount!=\"function\"||(typeof o.componentWillMount==\"function\"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount==\"function\"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount==\"function\"&&(e.flags|=4194308)):(typeof o.componentDidMount==\"function\"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=s,r=d):(typeof o.componentDidMount==\"function\"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Z6(t,e),s=e.memoizedProps,b=dm(n,s),o.props=b,C=e.pendingProps,B=o.context,m=n.contextType,d=R1,typeof m==\"object\"&&m!==null&&(d=Ha(m)),c=n.getDerivedStateFromProps,(m=typeof c==\"function\"||typeof o.getSnapshotBeforeUpdate==\"function\")||typeof o.UNSAFE_componentWillReceiveProps!=\"function\"&&typeof o.componentWillReceiveProps!=\"function\"||(s!==C||B!==d)&&JG(e,o,r,d),X0=!1,B=e.memoizedState,o.state=B,Av(e,r,o,i),pv();var k=e.memoizedState;s!==C||B!==k||X0||t!==null&&t.dependencies!==null&&bS(t.dependencies)?(typeof c==\"function\"&&(c6(e,n,c,r),k=e.memoizedState),(b=X0||KG(e,n,b,r,B,k,d)||t!==null&&t.dependencies!==null&&bS(t.dependencies))?(m||typeof o.UNSAFE_componentWillUpdate!=\"function\"&&typeof o.componentWillUpdate!=\"function\"||(typeof o.componentWillUpdate==\"function\"&&o.componentWillUpdate(r,k,d),typeof o.UNSAFE_componentWillUpdate==\"function\"&&o.UNSAFE_componentWillUpdate(r,k,d)),typeof o.componentDidUpdate==\"function\"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate==\"function\"&&(e.flags|=1024)):(typeof o.componentDidUpdate!=\"function\"||s===t.memoizedProps&&B===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!=\"function\"||s===t.memoizedProps&&B===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=k),o.props=r,o.state=k,o.context=d,r=b):(typeof o.componentDidUpdate!=\"function\"||s===t.memoizedProps&&B===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!=\"function\"||s===t.memoizedProps&&B===t.memoizedState||(e.flags|=1024),r=!1)}return o=r,lS(t,e),r=(e.flags&128)!==0,o||r?(o=e.stateNode,n=r&&typeof n.getDerivedStateFromError!=\"function\"?null:o.render(),e.flags|=1,t!==null&&r?(e.child=hm(e,t.child,null,i),e.child=hm(e,null,n,i)):Ua(t,e,n,i),e.memoizedState=o.state,t=e.child):t=yp(t,e,i),t}function sH(t,e,n,r){return cm(),e.flags|=256,Ua(t,e,n,r),e.child}var u6={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function h6(t){return{baseLanes:t,cachePool:PW()}}function f6(t,e,n){return t=t!==null?t.childLanes&~n:0,e&&(t|=Xc),t}function bj(t,e,n){var r=e.pendingProps,i=!1,o=(e.flags&128)!==0,s;if((s=o)||(s=t!==null&&t.memoizedState===null?!1:(As.current&2)!==0),s&&(i=!0,e.flags&=-129),s=(e.flags&32)!==0,e.flags&=-33,t===null){if($r){if(i?Z0(e):q0(e),(t=Mo)?(t=dX(t,zu),t=t!==null&&t.data!==\"&\"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:hA!==null?{id:Ff,overflow:kf}:null,retryLane:536870912,hydrationErrors:null},n=SW(t),n.return=e,e.child=n,Ga=e,Mo=null)):t=null,t===null)throw fA(e);return mD(t)?e.lanes=32:e.lanes=536870912,null}var c=r.children;return r=r.fallback,i?(q0(e),i=e.mode,c=IS({mode:\"hidden\",children:c},i),r=om(r,i,n,null),c.return=e,r.return=e,c.sibling=r,e.child=c,r=e.child,r.memoizedState=h6(n),r.childLanes=f6(t,s,n),e.memoizedState=u6,av(null,r)):(Z0(e),iD(e,c))}var d=t.memoizedState;if(d!==null&&(c=d.dehydrated,c!==null)){if(o)e.flags&256?(Z0(e),e.flags&=-257,e=d6(t,e,n)):e.memoizedState!==null?(q0(e),e.child=t.child,e.flags|=128,e=null):(q0(e),c=r.fallback,i=e.mode,r=IS({mode:\"visible\",children:r.children},i),c=om(c,i,n,null),c.flags|=2,r.return=e,c.return=e,r.sibling=c,e.child=r,hm(e,t.child,null,n),r=e.child,r.memoizedState=h6(n),r.childLanes=f6(t,s,n),e.memoizedState=u6,e=av(null,r));else if(Z0(e),mD(c)){if(s=c.nextSibling&&c.nextSibling.dataset,s)var m=s.dgst;s=m,r=Error(Ht(419)),r.stack=\"\",r.digest=s,Cv({value:r,source:null,stack:null}),e=d6(t,e,n)}else if(Us||ty(t,e,n,!1),s=(n&t.childLanes)!==0,Us||s){if(s=io,s!==null&&(r=JH(s,n),r!==0&&r!==d.retryLane))throw d.retryLane=r,mm(t,r),gc(s,t,r),nL;gD(c)||DS(),e=d6(t,e,n)}else gD(c)?(e.flags|=192,e.child=t.child,e=null):(t=d.treeContext,Mo=Vu(c.nextSibling),Ga=e,$r=!0,rA=null,zu=!1,t!==null&&MW(e,t),e=iD(e,r.children),e.flags|=4096);return e}return i?(q0(e),c=r.fallback,i=e.mode,d=t.child,m=d.sibling,r=dp(d,{mode:\"hidden\",children:r.children}),r.subtreeFlags=d.subtreeFlags&65011712,m!==null?c=dp(m,c):(c=om(c,i,n,null),c.flags|=2),c.return=e,r.return=e,r.sibling=c,e.child=r,av(null,r),r=e.child,c=t.child.memoizedState,c===null?c=h6(n):(i=c.cachePool,i!==null?(d=zs._currentValue,i=i.parent!==d?{parent:d,pool:d}:i):i=PW(),c={baseLanes:c.baseLanes|n,cachePool:i}),r.memoizedState=c,r.childLanes=f6(t,s,n),e.memoizedState=u6,av(t.child,r)):(Z0(e),n=t.child,t=n.sibling,n=dp(n,{mode:\"visible\",children:r.children}),n.return=e,n.sibling=null,t!==null&&(s=e.deletions,s===null?(e.deletions=[t],e.flags|=16):s.push(t)),e.child=n,e.memoizedState=null,n)}function iD(t,e){return e=IS({mode:\"visible\",children:e},t.mode),e.return=t,t.child=e}function IS(t,e){return t=jc(22,t,null,e),t.lanes=0,t}function d6(t,e,n){return hm(e,t.child,null,n),t=iD(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function aH(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),j6(t.return,e,n)}function p6(t,e,n,r,i,o){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,treeForkCount:o}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i,s.treeForkCount=o)}function wj(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;r=r.children;var s=As.current,c=(s&2)!==0;if(c?(s=s&1|2,e.flags|=128):s&=1,go(As,s),Ua(t,e,r,n),r=$r?Sv:0,!c&&t!==null&&(t.flags&128)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&aH(t,n,e);else if(t.tag===19)aH(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(i){case\"forwards\":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&ES(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),p6(e,!1,i,n,o,r);break;case\"backwards\":case\"unstable_legacy-backwards\":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ES(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}p6(e,!0,n,null,o,r);break;case\"together\":p6(e,!1,null,null,void 0,r);break;default:e.memoizedState=null}return e.child}function yp(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),pA|=e.lanes,(n&e.childLanes)===0)if(t!==null){if(ty(t,e,n,!1),(n&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(Ht(153));if(e.child!==null){for(t=e.child,n=dp(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=dp(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function rL(t,e){return(t.lanes&e)!==0?!0:(t=t.dependencies,!!(t!==null&&bS(t)))}function f0e(t,e,n){switch(e.tag){case 3:AS(e,e.stateNode.containerInfo),Y0(e,zs,t.memoizedState.cache),cm();break;case 27:case 5:B6(e);break;case 4:AS(e,e.stateNode.containerInfo);break;case 10:Y0(e,e.type,e.memoizedProps.value);break;case 31:if(e.memoizedState!==null)return e.flags|=128,K6(e),null;break;case 13:var r=e.memoizedState;if(r!==null)return r.dehydrated!==null?(Z0(e),e.flags|=128,null):(n&e.child.childLanes)!==0?bj(t,e,n):(Z0(e),t=yp(t,e,n),t!==null?t.sibling:null);Z0(e);break;case 19:var i=(t.flags&128)!==0;if(r=(n&e.childLanes)!==0,r||(ty(t,e,n,!1),r=(n&e.childLanes)!==0),i){if(r)return wj(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),go(As,As.current),r)break;return null;case 22:return e.lanes=0,vj(t,e,n,e.pendingProps);case 24:Y0(e,zs,t.memoizedState.cache)}return yp(t,e,n)}function Tj(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps)Us=!0;else{if(!rL(t,n)&&(e.flags&128)===0)return Us=!1,f0e(t,e,n);Us=(t.flags&131072)!==0}else Us=!1,$r&&(e.flags&1048576)!==0&&CW(e,Sv,e.index);switch(e.lanes=0,e.tag){case 16:e:{var r=e.pendingProps;if(t=nm(e.elementType),e.type=t,typeof t==\"function\")OD(t)?(r=dm(t,r),e.tag=1,e=oH(null,e,t,r,n)):(e.tag=0,e=rD(null,e,t,r,n));else{if(t!=null){var i=t.$$typeof;if(i===vD){e.tag=11,e=eH(null,e,t,r,n);break e}else if(i===bD){e.tag=14,e=tH(null,e,t,r,n);break e}}throw e=P6(t)||t,Error(Ht(306,e,\"\"))}}return e;case 0:return rD(t,e,e.type,e.pendingProps,n);case 1:return r=e.type,i=dm(r,e.pendingProps),oH(t,e,r,i,n);case 3:e:{if(AS(e,e.stateNode.containerInfo),t===null)throw Error(Ht(387));r=e.pendingProps;var o=e.memoizedState;i=o.element,Z6(t,e),Av(e,r,null,n);var s=e.memoizedState;if(r=s.cache,Y0(e,zs,r),r!==o.cache&&X6(e,[zs],n,!0),pv(),r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){e=sH(t,e,r,n);break e}else if(r!==i){i=Nu(Error(Ht(424)),e),Cv(i),e=sH(t,e,r,n);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName===\"HTML\"?t.ownerDocument.body:t}for(Mo=Vu(t.firstChild),Ga=e,$r=!0,rA=null,zu=!0,n=DW(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(cm(),r===i){e=yp(t,e,n);break e}Ua(t,e,r,n)}e=e.child}return e;case 26:return lS(t,e),t===null?(n=IH(e.type,null,e.pendingProps,null))?e.memoizedState=n:$r||(n=e.type,t=e.pendingProps,r=kS(nA.current).createElement(n),r[Va]=e,r[mc]=t,Wa(r,n,t),ma(r),e.stateNode=r):e.memoizedState=IH(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return B6(e),t===null&&$r&&(r=e.stateNode=pX(e.type,e.pendingProps,nA.current),Ga=e,zu=!0,i=Mo,gA(e.type)?(_D=i,Mo=Vu(r.firstChild)):Mo=i),Ua(t,e,e.pendingProps.children,n),lS(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&$r&&((i=r=Mo)&&(r=U0e(r,e.type,e.pendingProps,zu),r!==null?(e.stateNode=r,Ga=e,Mo=Vu(r.firstChild),zu=!1,i=!0):i=!1),i||fA(e)),B6(e),i=e.type,o=e.pendingProps,s=t!==null?t.memoizedProps:null,r=o.children,pD(i,o)?r=null:s!==null&&pD(i,s)&&(e.flags|=32),e.memoizedState!==null&&(i=WD(t,e,r0e,null,null,n),Dv._currentValue=i),lS(t,e),Ua(t,e,r,n),e.child;case 6:return t===null&&$r&&((t=n=Mo)&&(n=V0e(n,e.pendingProps,zu),n!==null?(e.stateNode=n,Ga=e,Mo=null,t=!0):t=!1),t||fA(e)),null;case 13:return bj(t,e,n);case 4:return AS(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=hm(e,null,r,n):Ua(t,e,r,n),e.child;case 11:return eH(t,e,e.type,e.pendingProps,n);case 7:return Ua(t,e,e.pendingProps,n),e.child;case 8:return Ua(t,e,e.pendingProps.children,n),e.child;case 12:return Ua(t,e,e.pendingProps.children,n),e.child;case 10:return r=e.pendingProps,Y0(e,e.type,r.value),Ua(t,e,r.children,n),e.child;case 9:return i=e.type._context,r=e.pendingProps.children,um(e),i=Ha(i),r=r(i),e.flags|=1,Ua(t,e,r,n),e.child;case 14:return tH(t,e,e.type,e.pendingProps,n);case 15:return xj(t,e,e.type,e.pendingProps,n);case 19:return wj(t,e,n);case 31:return h0e(t,e,n);case 22:return vj(t,e,n,e.pendingProps);case 24:return um(e),r=Ha(zs),t===null?(i=zD(),i===null&&(i=io,o=ND(),i.pooledCache=o,o.refCount++,o!==null&&(i.pooledCacheLanes|=n),i=o),e.memoizedState={parent:r,cache:i},VD(e),Y0(e,zs,i)):((t.lanes&n)!==0&&(Z6(t,e),Av(e,null,null,n),pv()),i=t.memoizedState,o=e.memoizedState,i.parent!==r?(i={parent:r,cache:r},e.memoizedState=i,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=i),Y0(e,zs,r)):(r=o.cache,Y0(e,zs,r),r!==i.cache&&X6(e,[zs],n,!0))),Ua(t,e,e.pendingProps.children,n),e.child;case 29:throw e.pendingProps}throw Error(Ht(156,e.tag))}function ip(t){t.flags|=4}function A6(t,e,n,r,i){if((e=(t.mode&32)!==0)&&(e=!1),e){if(t.flags|=16777216,(i&335544128)===i)if(t.stateNode.complete)t.flags|=8192;else if(Zj())t.flags|=8192;else throw am=wS,UD}else t.flags&=-16777217}function lH(t,e){if(e.type!==\"stylesheet\"||(e.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!mX(e))if(Zj())t.flags|=8192;else throw am=wS,UD}function XE(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?qH():536870912,t.lanes|=e,Z1|=e)}function ev(t,e){if(!$r)switch(t.tailMode){case\"hidden\":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case\"collapsed\":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Co(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&65011712,r|=i.flags&65011712,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function d0e(t,e,n){var r=e.pendingProps;switch(kD(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Co(e),null;case 1:return Co(e),null;case 3:return n=e.stateNode,r=null,t!==null&&(r=t.memoizedState.cache),e.memoizedState.cache!==r&&(e.flags|=2048),pp(zs),G1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(y1(e)?ip(e):t===null||t.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,s6())),Co(e),null;case 26:var i=e.type,o=e.memoizedState;return t===null?(ip(e),o!==null?(Co(e),lH(e,o)):(Co(e),A6(e,i,null,r,n))):o?o!==t.memoizedState?(ip(e),Co(e),lH(e,o)):(Co(e),e.flags&=-16777217):(t=t.memoizedProps,t!==r&&ip(e),Co(e),A6(e,i,t,r,n)),null;case 27:if(gS(e),n=nA.current,i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==r&&ip(e);else{if(!r){if(e.stateNode===null)throw Error(Ht(166));return Co(e),null}t=zf.current,y1(e)?kG(e,t):(t=pX(i,r,n),e.stateNode=t,ip(e))}return Co(e),null;case 5:if(gS(e),i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==r&&ip(e);else{if(!r){if(e.stateNode===null)throw Error(Ht(166));return Co(e),null}if(o=zf.current,y1(e))kG(e,o);else{var s=kS(nA.current);switch(o){case 1:o=s.createElementNS(\"http://www.w3.org/2000/svg\",i);break;case 2:o=s.createElementNS(\"http://www.w3.org/1998/Math/MathML\",i);break;default:switch(i){case\"svg\":o=s.createElementNS(\"http://www.w3.org/2000/svg\",i);break;case\"math\":o=s.createElementNS(\"http://www.w3.org/1998/Math/MathML\",i);break;case\"script\":o=s.createElement(\"div\"),o.innerHTML=\"<script><\\/script>\",o=o.removeChild(o.firstChild);break;case\"select\":o=typeof r.is==\"string\"?s.createElement(\"select\",{is:r.is}):s.createElement(\"select\"),r.multiple?o.multiple=!0:r.size&&(o.size=r.size);break;default:o=typeof r.is==\"string\"?s.createElement(i,{is:r.is}):s.createElement(i)}}o[Va]=e,o[mc]=r;e:for(s=e.child;s!==null;){if(s.tag===5||s.tag===6)o.appendChild(s.stateNode);else if(s.tag!==4&&s.tag!==27&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}e.stateNode=o;e:switch(Wa(o,i,r),i){case\"button\":case\"input\":case\"select\":case\"textarea\":r=!!r.autoFocus;break e;case\"img\":r=!0;break e;default:r=!1}r&&ip(e)}}return Co(e),A6(e,e.type,t===null?null:t.memoizedProps,e.pendingProps,n),null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==r&&ip(e);else{if(typeof r!=\"string\"&&e.stateNode===null)throw Error(Ht(166));if(t=nA.current,y1(e)){if(t=e.stateNode,n=e.memoizedProps,r=null,i=Ga,i!==null)switch(i.tag){case 27:case 5:r=i.memoizedProps}t[Va]=e,t=!!(t.nodeValue===n||r!==null&&r.suppressHydrationWarning===!0||uX(t.nodeValue,n)),t||fA(e,!0)}else t=kS(t).createTextNode(r),t[Va]=e,e.stateNode=t}return Co(e),null;case 31:if(n=e.memoizedState,t===null||t.memoizedState!==null){if(r=y1(e),n!==null){if(t===null){if(!r)throw Error(Ht(318));if(t=e.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ht(557));t[Va]=e}else cm(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;Co(e),t=!1}else n=s6(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=n),t=!0;if(!t)return e.flags&256?(Wc(e),e):(Wc(e),null);if((e.flags&128)!==0)throw Error(Ht(558))}return Co(e),null;case 13:if(r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(i=y1(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Ht(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ht(317));i[Va]=e}else cm(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;Co(e),i=!1}else i=s6(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),i=!0;if(!i)return e.flags&256?(Wc(e),e):(Wc(e),null)}return Wc(e),(e.flags&128)!==0?(e.lanes=n,e):(n=r!==null,t=t!==null&&t.memoizedState!==null,n&&(r=e.child,i=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(i=r.alternate.memoizedState.cachePool.pool),o=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),o!==i&&(r.flags|=2048)),n!==t&&n&&(e.child.flags|=8192),XE(e,e.updateQueue),Co(e),null);case 4:return G1(),t===null&&uL(e.stateNode.containerInfo),Co(e),null;case 10:return pp(e.type),Co(e),null;case 19:if(_a(As),r=e.memoizedState,r===null)return Co(e),null;if(i=(e.flags&128)!==0,o=r.rendering,o===null)if(i)ev(r,!1);else{if(os!==0||t!==null&&(t.flags&128)!==0)for(t=e.child;t!==null;){if(o=ES(t),o!==null){for(e.flags|=128,ev(r,!1),t=o.updateQueue,e.updateQueue=t,XE(e,t),e.subtreeFlags=0,t=n,n=e.child;n!==null;)EW(n,t),n=n.sibling;return go(As,As.current&1|2),$r&&lp(e,r.treeForkCount),e.child}t=t.sibling}r.tail!==null&&Yc()>RS&&(e.flags|=128,i=!0,ev(r,!1),e.lanes=4194304)}else{if(!i)if(t=ES(o),t!==null){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,XE(e,t),ev(r,!0),r.tail===null&&r.tailMode===\"hidden\"&&!o.alternate&&!$r)return Co(e),null}else 2*Yc()-r.renderingStartTime>RS&&n!==536870912&&(e.flags|=128,i=!0,ev(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(t=r.last,t!==null?t.sibling=o:e.child=o,r.last=o)}return r.tail!==null?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Yc(),t.sibling=null,n=As.current,go(As,i?n&1|2:n&1),$r&&lp(e,r.treeForkCount),t):(Co(e),null);case 22:case 23:return Wc(e),GD(),r=e.memoizedState!==null,t!==null?t.memoizedState!==null!==r&&(e.flags|=8192):r&&(e.flags|=8192),r?(n&536870912)!==0&&(e.flags&128)===0&&(Co(e),e.subtreeFlags&6&&(e.flags|=8192)):Co(e),n=e.updateQueue,n!==null&&XE(e,n.retryQueue),n=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),r=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),r!==n&&(e.flags|=2048),t!==null&&_a(sm),null;case 24:return n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),pp(zs),Co(e),null;case 25:return null;case 30:return null}throw Error(Ht(156,e.tag))}function p0e(t,e){switch(kD(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pp(zs),G1(),t=e.flags,(t&65536)!==0&&(t&128)===0?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return gS(e),null;case 31:if(e.memoizedState!==null){if(Wc(e),e.alternate===null)throw Error(Ht(340));cm()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 13:if(Wc(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ht(340));cm()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return _a(As),null;case 4:return G1(),null;case 10:return pp(e.type),null;case 22:case 23:return Wc(e),GD(),t!==null&&_a(sm),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return pp(zs),null;case 25:return null;default:return null}}function Ej(t,e){switch(kD(e),e.tag){case 3:pp(zs),G1();break;case 26:case 27:case 5:gS(e);break;case 4:G1();break;case 31:e.memoizedState!==null&&Wc(e);break;case 13:Wc(e);break;case 19:_a(As);break;case 10:pp(e.type);break;case 22:case 23:Wc(e),GD(),t!==null&&_a(sm);break;case 24:pp(zs)}}function Wv(t,e){try{var n=e.updateQueue,r=n!==null?n.lastEffect:null;if(r!==null){var i=r.next;n=i;do{if((n.tag&t)===t){r=void 0;var o=n.create,s=n.inst;r=o(),s.destroy=r}n=n.next}while(n!==i)}}catch(c){zi(e,e.return,c)}}function dA(t,e,n){try{var r=e.updateQueue,i=r!==null?r.lastEffect:null;if(i!==null){var o=i.next;r=o;do{if((r.tag&t)===t){var s=r.inst,c=s.destroy;if(c!==void 0){s.destroy=void 0,i=e;var d=n,m=c;try{m()}catch(b){zi(i,d,b)}}}r=r.next}while(r!==o)}}catch(b){zi(e,e.return,b)}}function Sj(t){var e=t.updateQueue;if(e!==null){var n=t.stateNode;try{OW(e,n)}catch(r){zi(t,t.return,r)}}}function Cj(t,e,n){n.props=dm(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(r){zi(t,e,r)}}function mv(t,e){try{var n=t.ref;if(n!==null){switch(t.tag){case 26:case 27:case 5:var r=t.stateNode;break;case 30:r=t.stateNode;break;default:r=t.stateNode}typeof n==\"function\"?t.refCleanup=n(r):n.current=r}}catch(i){zi(t,e,i)}}function Nf(t,e){var n=t.ref,r=t.refCleanup;if(n!==null)if(typeof r==\"function\")try{r()}catch(i){zi(t,e,i)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof n==\"function\")try{n(null)}catch(i){zi(t,e,i)}else n.current=null}function Mj(t){var e=t.type,n=t.memoizedProps,r=t.stateNode;try{e:switch(e){case\"button\":case\"input\":case\"select\":case\"textarea\":n.autoFocus&&r.focus();break e;case\"img\":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){zi(t,t.return,i)}}function g6(t,e,n){try{var r=t.stateNode;L0e(r,t.type,n,e),r[mc]=e}catch(i){zi(t,t.return,i)}}function Ij(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&gA(t.type)||t.tag===4}function m6(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Ij(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&gA(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function oD(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?(n.nodeType===9?n.body:n.nodeName===\"HTML\"?n.ownerDocument.body:n).insertBefore(t,e):(e=n.nodeType===9?n.body:n.nodeName===\"HTML\"?n.ownerDocument.body:n,e.appendChild(t),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hp));else if(r!==4&&(r===27&&gA(t.type)&&(n=t.stateNode,e=null),t=t.child,t!==null))for(oD(t,e,n),t=t.sibling;t!==null;)oD(t,e,n),t=t.sibling}function PS(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(r===27&&gA(t.type)&&(n=t.stateNode),t=t.child,t!==null))for(PS(t,e,n),t=t.sibling;t!==null;)PS(t,e,n),t=t.sibling}function Pj(t){var e=t.stateNode,n=t.memoizedProps;try{for(var r=t.type,i=e.attributes;i.length;)e.removeAttributeNode(i[0]);Wa(e,r,n),e[Va]=t,e[mc]=n}catch(o){zi(t,t.return,o)}}var cp=!1,Ns=!1,_6=!1,cH=typeof WeakSet==\"function\"?WeakSet:Set,ga=null;function A0e(t,e){if(t=t.containerInfo,fD=VS,t=mW(t),BD(t)){if(\"selectionStart\"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,c=-1,d=-1,m=0,b=0,C=t,B=null;t:for(;;){for(var k;C!==n||i!==0&&C.nodeType!==3||(c=s+i),C!==o||r!==0&&C.nodeType!==3||(d=s+r),C.nodeType===3&&(s+=C.nodeValue.length),(k=C.firstChild)!==null;)B=C,C=k;for(;;){if(C===t)break t;if(B===n&&++m===i&&(c=s),B===o&&++b===r&&(d=s),(k=C.nextSibling)!==null)break;C=B,B=C.parentNode}C=k}n=c===-1||d===-1?null:{start:c,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(dD={focusedElem:t,selectionRange:n},VS=!1,ga=e;ga!==null;)if(e=ga,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ga=t;else for(;ga!==null;){switch(e=ga,o=e.alternate,t=e.flags,e.tag){case 0:if((t&4)!==0&&(t=e.updateQueue,t=t!==null?t.events:null,t!==null))for(n=0;n<t.length;n++)i=t[n],i.ref.impl=i.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&o!==null){t=void 0,n=e,i=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var V=dm(n.type,i);t=r.getSnapshotBeforeUpdate(V,o),r.__reactInternalSnapshotBeforeUpdate=t}catch(q){zi(n,n.return,q)}}break;case 3:if((t&1024)!==0){if(t=e.stateNode.containerInfo,n=t.nodeType,n===9)AD(t);else if(n===1)switch(t.nodeName){case\"HEAD\":case\"HTML\":case\"BODY\":AD(t);break;default:t.textContent=\"\"}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(Ht(163))}if(t=e.sibling,t!==null){t.return=e.return,ga=t;break}ga=e.return}}function Rj(t,e,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:sp(t,n),r&4&&Wv(5,n);break;case 1:if(sp(t,n),r&4)if(t=n.stateNode,e===null)try{t.componentDidMount()}catch(s){zi(n,n.return,s)}else{var i=dm(n.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(i,e,t.__reactInternalSnapshotBeforeUpdate)}catch(s){zi(n,n.return,s)}}r&64&&Sj(n),r&512&&mv(n,n.return);break;case 3:if(sp(t,n),r&64&&(t=n.updateQueue,t!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{OW(t,e)}catch(s){zi(n,n.return,s)}}break;case 27:e===null&&r&4&&Pj(n);case 26:case 5:sp(t,n),e===null&&r&4&&Mj(n),r&512&&mv(n,n.return);break;case 12:sp(t,n);break;case 31:sp(t,n),r&4&&Lj(t,n);break;case 13:sp(t,n),r&4&&Oj(t,n),r&64&&(t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(n=T0e.bind(null,n),G0e(t,n))));break;case 22:if(r=n.memoizedState!==null||cp,!r){e=e!==null&&e.memoizedState!==null||Ns,i=cp;var o=Ns;cp=r,(Ns=e)&&!o?ap(t,n,(n.subtreeFlags&8772)!==0):sp(t,n),cp=i,Ns=o}break;case 30:break;default:sp(t,n)}}function Bj(t){var e=t.alternate;e!==null&&(t.alternate=null,Bj(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&SD(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var ko=null,pc=!1;function op(t,e,n){for(n=n.child;n!==null;)Dj(t,e,n),n=n.sibling}function Dj(t,e,n){if(Zc&&typeof Zc.onCommitFiberUnmount==\"function\")try{Zc.onCommitFiberUnmount(kv,n)}catch{}switch(n.tag){case 26:Ns||Nf(n,e),op(t,e,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Ns||Nf(n,e);var r=ko,i=pc;gA(n.type)&&(ko=n.stateNode,pc=!1),op(t,e,n),vv(n.stateNode),ko=r,pc=i;break;case 5:Ns||Nf(n,e);case 6:if(r=ko,i=pc,ko=null,op(t,e,n),ko=r,pc=i,ko!==null)if(pc)try{(ko.nodeType===9?ko.body:ko.nodeName===\"HTML\"?ko.ownerDocument.body:ko).removeChild(n.stateNode)}catch(o){zi(n,e,o)}else try{ko.removeChild(n.stateNode)}catch(o){zi(n,e,o)}break;case 18:ko!==null&&(pc?(t=ko,TH(t.nodeType===9?t.body:t.nodeName===\"HTML\"?t.ownerDocument.body:t,n.stateNode),J1(t)):TH(ko,n.stateNode));break;case 4:r=ko,i=pc,ko=n.stateNode.containerInfo,pc=!0,op(t,e,n),ko=r,pc=i;break;case 0:case 11:case 14:case 15:dA(2,n,e),Ns||dA(4,n,e),op(t,e,n);break;case 1:Ns||(Nf(n,e),r=n.stateNode,typeof r.componentWillUnmount==\"function\"&&Cj(n,e,r)),op(t,e,n);break;case 21:op(t,e,n);break;case 22:Ns=(r=Ns)||n.memoizedState!==null,op(t,e,n),Ns=r;break;default:op(t,e,n)}}function Lj(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{J1(t)}catch(n){zi(e,e.return,n)}}}function Oj(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{J1(t)}catch(n){zi(e,e.return,n)}}function g0e(t){switch(t.tag){case 31:case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new cH),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new cH),e;default:throw Error(Ht(435,t.tag))}}function YE(t,e){var n=g0e(t);e.forEach(function(r){if(!n.has(r)){n.add(r);var i=E0e.bind(null,t,r);r.then(i,i)}})}function fc(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r],o=t,s=e,c=s;e:for(;c!==null;){switch(c.tag){case 27:if(gA(c.type)){ko=c.stateNode,pc=!1;break e}break;case 5:ko=c.stateNode,pc=!1;break e;case 3:case 4:ko=c.stateNode.containerInfo,pc=!0;break e}c=c.return}if(ko===null)throw Error(Ht(160));Dj(o,s,i),ko=null,pc=!1,o=i.alternate,o!==null&&(o.return=null),i.return=null}if(e.subtreeFlags&13886)for(e=e.child;e!==null;)Fj(e,t),e=e.sibling}var Gh=null;function Fj(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:fc(e,t),dc(t),r&4&&(dA(3,t,t.return),Wv(3,t),dA(5,t,t.return));break;case 1:fc(e,t),dc(t),r&512&&(Ns||n===null||Nf(n,n.return)),r&64&&cp&&(t=t.updateQueue,t!==null&&(r=t.callbacks,r!==null&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=n===null?r:n.concat(r))));break;case 26:var i=Gh;if(fc(e,t),dc(t),r&512&&(Ns||n===null||Nf(n,n.return)),r&4){var o=n!==null?n.memoizedState:null;if(r=t.memoizedState,n===null)if(r===null)if(t.stateNode===null){e:{r=t.type,n=t.memoizedProps,i=i.ownerDocument||i;t:switch(r){case\"title\":o=i.getElementsByTagName(\"title\")[0],(!o||o[Uv]||o[Va]||o.namespaceURI===\"http://www.w3.org/2000/svg\"||o.hasAttribute(\"itemprop\"))&&(o=i.createElement(r),i.head.insertBefore(o,i.querySelector(\"head > title\"))),Wa(o,r,n),o[Va]=t,ma(o),r=o;break e;case\"link\":var s=RH(\"link\",\"href\",i).get(r+(n.href||\"\"));if(s){for(var c=0;c<s.length;c++)if(o=s[c],o.getAttribute(\"href\")===(n.href==null||n.href===\"\"?null:n.href)&&o.getAttribute(\"rel\")===(n.rel==null?null:n.rel)&&o.getAttribute(\"title\")===(n.title==null?null:n.title)&&o.getAttribute(\"crossorigin\")===(n.crossOrigin==null?null:n.crossOrigin)){s.splice(c,1);break t}}o=i.createElement(r),Wa(o,r,n),i.head.appendChild(o);break;case\"meta\":if(s=RH(\"meta\",\"content\",i).get(r+(n.content||\"\"))){for(c=0;c<s.length;c++)if(o=s[c],o.getAttribute(\"content\")===(n.content==null?null:\"\"+n.content)&&o.getAttribute(\"name\")===(n.name==null?null:n.name)&&o.getAttribute(\"property\")===(n.property==null?null:n.property)&&o.getAttribute(\"http-equiv\")===(n.httpEquiv==null?null:n.httpEquiv)&&o.getAttribute(\"charset\")===(n.charSet==null?null:n.charSet)){s.splice(c,1);break t}}o=i.createElement(r),Wa(o,r,n),i.head.appendChild(o);break;default:throw Error(Ht(468,r))}o[Va]=t,ma(o),r=o}t.stateNode=r}else BH(i,t.type,t.stateNode);else t.stateNode=PH(i,r,t.memoizedProps);else o!==r?(o===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):o.count--,r===null?BH(i,t.type,t.stateNode):PH(i,r,t.memoizedProps)):r===null&&t.stateNode!==null&&g6(t,t.memoizedProps,n.memoizedProps)}break;case 27:fc(e,t),dc(t),r&512&&(Ns||n===null||Nf(n,n.return)),n!==null&&r&4&&g6(t,t.memoizedProps,n.memoizedProps);break;case 5:if(fc(e,t),dc(t),r&512&&(Ns||n===null||Nf(n,n.return)),t.flags&32){i=t.stateNode;try{W1(i,\"\")}catch(V){zi(t,t.return,V)}}r&4&&t.stateNode!=null&&(i=t.memoizedProps,g6(t,i,n!==null?n.memoizedProps:i)),r&1024&&(_6=!0);break;case 6:if(fc(e,t),dc(t),r&4){if(t.stateNode===null)throw Error(Ht(162));r=t.memoizedProps,n=t.stateNode;try{n.nodeValue=r}catch(V){zi(t,t.return,V)}}break;case 3:if(hS=null,i=Gh,Gh=NS(e.containerInfo),fc(e,t),Gh=i,dc(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{J1(e.containerInfo)}catch(V){zi(t,t.return,V)}_6&&(_6=!1,kj(t));break;case 4:r=Gh,Gh=NS(t.stateNode.containerInfo),fc(e,t),dc(t),Gh=r;break;case 12:fc(e,t),dc(t);break;case 31:fc(e,t),dc(t),r&4&&(r=t.updateQueue,r!==null&&(t.updateQueue=null,YE(t,r)));break;case 13:fc(e,t),dc(t),t.child.flags&8192&&t.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(eC=Yc()),r&4&&(r=t.updateQueue,r!==null&&(t.updateQueue=null,YE(t,r)));break;case 22:i=t.memoizedState!==null;var d=n!==null&&n.memoizedState!==null,m=cp,b=Ns;if(cp=m||i,Ns=b||d,fc(e,t),Ns=b,cp=m,dc(t),r&8192)e:for(e=t.stateNode,e._visibility=i?e._visibility&-2:e._visibility|1,i&&(n===null||d||cp||Ns||rm(t)),n=null,e=t;;){if(e.tag===5||e.tag===26){if(n===null){d=n=e;try{if(o=d.stateNode,i)s=o.style,typeof s.setProperty==\"function\"?s.setProperty(\"display\",\"none\",\"important\"):s.display=\"none\";else{c=d.stateNode;var C=d.memoizedProps.style,B=C!=null&&C.hasOwnProperty(\"display\")?C.display:null;c.style.display=B==null||typeof B==\"boolean\"?\"\":(\"\"+B).trim()}}catch(V){zi(d,d.return,V)}}}else if(e.tag===6){if(n===null){d=e;try{d.stateNode.nodeValue=i?\"\":d.memoizedProps}catch(V){zi(d,d.return,V)}}}else if(e.tag===18){if(n===null){d=e;try{var k=d.stateNode;i?EH(k,!0):EH(d.stateNode,!1)}catch(V){zi(d,d.return,V)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;n===e&&(n=null),e=e.return}n===e&&(n=null),e.sibling.return=e.return,e=e.sibling}r&4&&(r=t.updateQueue,r!==null&&(n=r.retryQueue,n!==null&&(r.retryQueue=null,YE(t,n))));break;case 19:fc(e,t),dc(t),r&4&&(r=t.updateQueue,r!==null&&(t.updateQueue=null,YE(t,r)));break;case 30:break;case 21:break;default:fc(e,t),dc(t)}}function dc(t){var e=t.flags;if(e&2){try{for(var n,r=t.return;r!==null;){if(Ij(r)){n=r;break}r=r.return}if(n==null)throw Error(Ht(160));switch(n.tag){case 27:var i=n.stateNode,o=m6(t);PS(t,o,i);break;case 5:var s=n.stateNode;n.flags&32&&(W1(s,\"\"),n.flags&=-33);var c=m6(t);PS(t,c,s);break;case 3:case 4:var d=n.stateNode.containerInfo,m=m6(t);oD(t,m,d);break;default:throw Error(Ht(161))}}catch(b){zi(t,t.return,b)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function kj(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;kj(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function sp(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)Rj(t,e.alternate,e),e=e.sibling}function rm(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:dA(4,e,e.return),rm(e);break;case 1:Nf(e,e.return);var n=e.stateNode;typeof n.componentWillUnmount==\"function\"&&Cj(e,e.return,n),rm(e);break;case 27:vv(e.stateNode);case 26:case 5:Nf(e,e.return),rm(e);break;case 22:e.memoizedState===null&&rm(e);break;case 30:rm(e);break;default:rm(e)}t=t.sibling}}function ap(t,e,n){for(n=n&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var r=e.alternate,i=t,o=e,s=o.flags;switch(o.tag){case 0:case 11:case 15:ap(i,o,n),Wv(4,o);break;case 1:if(ap(i,o,n),r=o,i=r.stateNode,typeof i.componentDidMount==\"function\")try{i.componentDidMount()}catch(m){zi(r,r.return,m)}if(r=o,i=r.updateQueue,i!==null){var c=r.stateNode;try{var d=i.shared.hiddenCallbacks;if(d!==null)for(i.shared.hiddenCallbacks=null,i=0;i<d.length;i++)LW(d[i],c)}catch(m){zi(r,r.return,m)}}n&&s&64&&Sj(o),mv(o,o.return);break;case 27:Pj(o);case 26:case 5:ap(i,o,n),n&&r===null&&s&4&&Mj(o),mv(o,o.return);break;case 12:ap(i,o,n);break;case 31:ap(i,o,n),n&&s&4&&Lj(i,o);break;case 13:ap(i,o,n),n&&s&4&&Oj(i,o);break;case 22:o.memoizedState===null&&ap(i,o,n),mv(o,o.return);break;case 30:break;default:ap(i,o,n)}e=e.sibling}}function iL(t,e){var n=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==n&&(t!=null&&t.refCount++,n!=null&&Gv(n))}function oL(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&Gv(t))}function Vh(t,e,n,r){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Nj(t,e,n,r),e=e.sibling}function Nj(t,e,n,r){var i=e.flags;switch(e.tag){case 0:case 11:case 15:Vh(t,e,n,r),i&2048&&Wv(9,e);break;case 1:Vh(t,e,n,r);break;case 3:Vh(t,e,n,r),i&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&Gv(t)));break;case 12:if(i&2048){Vh(t,e,n,r),t=e.stateNode;try{var o=e.memoizedProps,s=o.id,c=o.onPostCommit;typeof c==\"function\"&&c(s,e.alternate===null?\"mount\":\"update\",t.passiveEffectDuration,-0)}catch(d){zi(e,e.return,d)}}else Vh(t,e,n,r);break;case 31:Vh(t,e,n,r);break;case 13:Vh(t,e,n,r);break;case 23:break;case 22:o=e.stateNode,s=e.alternate,e.memoizedState!==null?o._visibility&2?Vh(t,e,n,r):_v(t,e):o._visibility&2?Vh(t,e,n,r):(o._visibility|=2,v1(t,e,n,r,(e.subtreeFlags&10256)!==0||!1)),i&2048&&iL(s,e);break;case 24:Vh(t,e,n,r),i&2048&&oL(e.alternate,e);break;default:Vh(t,e,n,r)}}function v1(t,e,n,r,i){for(i=i&&((e.subtreeFlags&10256)!==0||!1),e=e.child;e!==null;){var o=t,s=e,c=n,d=r,m=s.flags;switch(s.tag){case 0:case 11:case 15:v1(o,s,c,d,i),Wv(8,s);break;case 23:break;case 22:var b=s.stateNode;s.memoizedState!==null?b._visibility&2?v1(o,s,c,d,i):_v(o,s):(b._visibility|=2,v1(o,s,c,d,i)),i&&m&2048&&iL(s.alternate,s);break;case 24:v1(o,s,c,d,i),i&&m&2048&&oL(s.alternate,s);break;default:v1(o,s,c,d,i)}e=e.sibling}}function _v(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var n=t,r=e,i=r.flags;switch(r.tag){case 22:_v(n,r),i&2048&&iL(r.alternate,r);break;case 24:_v(n,r),i&2048&&oL(r.alternate,r);break;default:_v(n,r)}e=e.sibling}}var lv=8192;function x1(t,e,n){if(t.subtreeFlags&lv)for(t=t.child;t!==null;)zj(t,e,n),t=t.sibling}function zj(t,e,n){switch(t.tag){case 26:x1(t,e,n),t.flags&lv&&t.memoizedState!==null&&eAe(n,Gh,t.memoizedState,t.memoizedProps);break;case 5:x1(t,e,n);break;case 3:case 4:var r=Gh;Gh=NS(t.stateNode.containerInfo),x1(t,e,n),Gh=r;break;case 22:t.memoizedState===null&&(r=t.alternate,r!==null&&r.memoizedState!==null?(r=lv,lv=16777216,x1(t,e,n),lv=r):x1(t,e,n));break;default:x1(t,e,n)}}function Uj(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function tv(t){var e=t.deletions;if((t.flags&16)!==0){if(e!==null)for(var n=0;n<e.length;n++){var r=e[n];ga=r,Gj(r,t)}Uj(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Vj(t),t=t.sibling}function Vj(t){switch(t.tag){case 0:case 11:case 15:tv(t),t.flags&2048&&dA(9,t,t.return);break;case 3:tv(t);break;case 12:tv(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,cS(t)):tv(t);break;default:tv(t)}}function cS(t){var e=t.deletions;if((t.flags&16)!==0){if(e!==null)for(var n=0;n<e.length;n++){var r=e[n];ga=r,Gj(r,t)}Uj(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:dA(8,e,e.return),cS(e);break;case 22:n=e.stateNode,n._visibility&2&&(n._visibility&=-3,cS(e));break;default:cS(e)}t=t.sibling}}function Gj(t,e){for(;ga!==null;){var n=ga;switch(n.tag){case 0:case 11:case 15:dA(8,n,e);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var r=n.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:Gv(n.memoizedState.cache)}if(r=n.child,r!==null)r.return=n,ga=r;else e:for(n=t;ga!==null;){r=ga;var i=r.sibling,o=r.return;if(Bj(r),r===n){ga=null;break e}if(i!==null){i.return=o,ga=i;break e}ga=o}}}var m0e={getCacheForType:function(t){var e=Ha(zs),n=e.data.get(t);return n===void 0&&(n=t(),e.data.set(t,n)),n},cacheSignal:function(){return Ha(zs).controller.signal}},_0e=typeof WeakMap==\"function\"?WeakMap:Map,Ei=0,io=null,Vr=null,jr=0,Ni=0,Hc=null,$0=!1,ry=!1,sL=!1,xp=0,os=0,pA=0,lm=0,aL=0,Xc=0,Z1=0,yv=null,Ac=null,sD=!1,eC=0,Hj=0,RS=1/0,BS=null,sA=null,Js=0,aA=null,q1=null,Ap=0,aD=0,lD=null,Wj=null,xv=0,cD=null;function Qc(){return(Ei&2)!==0&&jr!==0?jr&-jr:ar.T!==null?cL():$H()}function jj(){if(Xc===0)if((jr&536870912)===0||$r){var t=kE;kE<<=1,(kE&3932160)===0&&(kE=262144),Xc=t}else Xc=536870912;return t=Jc.current,t!==null&&(t.flags|=32),Xc}function gc(t,e,n){(t===io&&(Ni===2||Ni===9)||t.cancelPendingCommit!==null)&&(Q1(t,0),eA(t,jr,Xc,!1)),zv(t,n),((Ei&2)===0||t!==io)&&(t===io&&((Ei&2)===0&&(lm|=n),os===4&&eA(t,jr,Xc,!1)),Vf(t))}function Xj(t,e,n){if((Ei&6)!==0)throw Error(Ht(327));var r=!n&&(e&127)===0&&(e&t.expiredLanes)===0||Nv(t,e),i=r?v0e(t,e):y6(t,e,!0),o=r;do{if(i===0){ry&&!r&&eA(t,e,0,!1);break}else{if(n=t.current.alternate,o&&!y0e(n)){i=y6(t,e,!1),o=!1;continue}if(i===2){if(o=e,t.errorRecoveryDisabledLanes&o)var s=0;else s=t.pendingLanes&-536870913,s=s!==0?s:s&536870912?536870912:0;if(s!==0){e=s;e:{var c=t;i=yv;var d=c.current.memoizedState.isDehydrated;if(d&&(Q1(c,s).flags|=256),s=y6(c,s,!1),s!==2){if(sL&&!d){c.errorRecoveryDisabledLanes|=o,lm|=o,i=4;break e}o=Ac,Ac=i,o!==null&&(Ac===null?Ac=o:Ac.push.apply(Ac,o))}i=s}if(o=!1,i!==2)continue}}if(i===1){Q1(t,0),eA(t,e,0,!0);break}e:{switch(r=t,o=i,o){case 0:case 1:throw Error(Ht(345));case 4:if((e&4194048)!==e)break;case 6:eA(r,e,Xc,!$0);break e;case 2:Ac=null;break;case 3:case 5:break;default:throw Error(Ht(329))}if((e&62914560)===e&&(i=eC+300-Yc(),10<i)){if(eA(r,e,Xc,!$0),HS(r,0,!0)!==0)break e;Ap=e,r.timeoutHandle=fX(uH.bind(null,r,n,Ac,BS,sD,e,Xc,lm,Z1,$0,o,\"Throttled\",-0,0),i);break e}uH(r,n,Ac,BS,sD,e,Xc,lm,Z1,$0,o,null,-0,0)}}break}while(!0);Vf(t)}function uH(t,e,n,r,i,o,s,c,d,m,b,C,B,k){if(t.timeoutHandle=-1,C=e.subtreeFlags,C&8192||(C&16785408)===16785408){C={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:hp},zj(e,o,C);var V=(o&62914560)===o?eC-Yc():(o&4194048)===o?Hj-Yc():0;if(V=tAe(C,V),V!==null){Ap=o,t.cancelPendingCommit=V(fH.bind(null,t,e,o,n,r,i,s,c,d,b,C,null,B,k)),eA(t,o,s,!m);return}}fH(t,e,o,n,r,i,s,c,d)}function y0e(t){for(var e=t;;){var n=e.tag;if((n===0||n===11||n===15)&&e.flags&16384&&(n=e.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Kc(o(),i))return!1}catch{return!1}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function eA(t,e,n,r){e&=~aL,e&=~lm,t.suspendedLanes|=e,t.pingedLanes&=~e,r&&(t.warmLanes|=e),r=t.expirationTimes;for(var i=e;0<i;){var o=31-qc(i),s=1<<o;r[o]=-1,i&=~s}n!==0&&QH(t,n,e)}function tC(){return(Ei&6)===0?(jv(0,!1),!1):!0}function lL(){if(Vr!==null){if(Ni===0)var t=Vr.return;else t=Vr,fp=_m=null,YD(t),z1=null,Mv=0,t=Vr;for(;t!==null;)Ej(t.alternate,t),t=t.return;Vr=null}}function Q1(t,e){var n=t.timeoutHandle;n!==-1&&(t.timeoutHandle=-1,k0e(n)),n=t.cancelPendingCommit,n!==null&&(t.cancelPendingCommit=null,n()),Ap=0,lL(),io=t,Vr=n=dp(t.current,null),jr=e,Ni=0,Hc=null,$0=!1,ry=Nv(t,e),sL=!1,Z1=Xc=aL=lm=pA=os=0,Ac=yv=null,sD=!1,(e&8)!==0&&(e|=e&32);var r=t.entangledLanes;if(r!==0)for(t=t.entanglements,r&=e;0<r;){var i=31-qc(r),o=1<<i;e|=t[i],r&=~o}return xp=e,YS(),n}function Yj(t,e){vr=null,ar.H=Pv,e===ny||e===qS?(e=GG(),Ni=3):e===UD?(e=GG(),Ni=4):Ni=e===nL?8:e!==null&&typeof e==\"object\"&&typeof e.then==\"function\"?6:1,Hc=e,Vr===null&&(os=1,MS(t,Nu(e,t.current)))}function Zj(){var t=Jc.current;return t===null?!0:(jr&4194048)===jr?Uu===null:(jr&62914560)===jr||(jr&536870912)!==0?t===Uu:!1}function qj(){var t=ar.H;return ar.H=Pv,t===null?Pv:t}function Qj(){var t=ar.A;return ar.A=m0e,t}function DS(){os=4,$0||(jr&4194048)!==jr&&Jc.current!==null||(ry=!0),(pA&134217727)===0&&(lm&134217727)===0||io===null||eA(io,jr,Xc,!1)}function y6(t,e,n){var r=Ei;Ei|=2;var i=qj(),o=Qj();(io!==t||jr!==e)&&(BS=null,Q1(t,e)),e=!1;var s=os;e:do try{if(Ni!==0&&Vr!==null){var c=Vr,d=Hc;switch(Ni){case 8:lL(),s=6;break e;case 3:case 2:case 9:case 6:Jc.current===null&&(e=!0);var m=Ni;if(Ni=0,Hc=null,L1(t,c,d,m),n&&ry){s=0;break e}break;default:m=Ni,Ni=0,Hc=null,L1(t,c,d,m)}}x0e(),s=os;break}catch(b){Yj(t,b)}while(!0);return e&&t.shellSuspendCounter++,fp=_m=null,Ei=r,ar.H=i,ar.A=o,Vr===null&&(io=null,jr=0,YS()),s}function x0e(){for(;Vr!==null;)Kj(Vr)}function v0e(t,e){var n=Ei;Ei|=2;var r=qj(),i=Qj();io!==t||jr!==e?(BS=null,RS=Yc()+500,Q1(t,e)):ry=Nv(t,e);e:do try{if(Ni!==0&&Vr!==null){e=Vr;var o=Hc;t:switch(Ni){case 1:Ni=0,Hc=null,L1(t,e,o,1);break;case 2:case 9:if(VG(o)){Ni=0,Hc=null,hH(e);break}e=function(){Ni!==2&&Ni!==9||io!==t||(Ni=7),Vf(t)},o.then(e,e);break e;case 3:Ni=7;break e;case 4:Ni=5;break e;case 7:VG(o)?(Ni=0,Hc=null,hH(e)):(Ni=0,Hc=null,L1(t,e,o,7));break;case 5:var s=null;switch(Vr.tag){case 26:s=Vr.memoizedState;case 5:case 27:var c=Vr;if(s?mX(s):c.stateNode.complete){Ni=0,Hc=null;var d=c.sibling;if(d!==null)Vr=d;else{var m=c.return;m!==null?(Vr=m,nC(m)):Vr=null}break t}}Ni=0,Hc=null,L1(t,e,o,5);break;case 6:Ni=0,Hc=null,L1(t,e,o,6);break;case 8:lL(),os=6;break e;default:throw Error(Ht(462))}}b0e();break}catch(b){Yj(t,b)}while(!0);return fp=_m=null,ar.H=r,ar.A=i,Ei=n,Vr!==null?0:(io=null,jr=0,YS(),os)}function b0e(){for(;Vr!==null&&!jde();)Kj(Vr)}function Kj(t){var e=Tj(t.alternate,t,xp);t.memoizedProps=t.pendingProps,e===null?nC(t):Vr=e}function hH(t){var e=t,n=e.alternate;switch(e.tag){case 15:case 0:e=iH(n,e,e.pendingProps,e.type,void 0,jr);break;case 11:e=iH(n,e,e.pendingProps,e.type.render,e.ref,jr);break;case 5:YD(e);default:Ej(n,e),e=Vr=EW(e,xp),e=Tj(n,e,xp)}t.memoizedProps=t.pendingProps,e===null?nC(t):Vr=e}function L1(t,e,n,r){fp=_m=null,YD(e),z1=null,Mv=0;var i=e.return;try{if(u0e(t,i,e,n,jr)){os=1,MS(t,Nu(n,t.current)),Vr=null;return}}catch(o){if(i!==null)throw Vr=i,o;os=1,MS(t,Nu(n,t.current)),Vr=null;return}e.flags&32768?($r||r===1?t=!0:ry||(jr&536870912)!==0?t=!1:($0=t=!0,(r===2||r===9||r===3||r===6)&&(r=Jc.current,r!==null&&r.tag===13&&(r.flags|=16384))),Jj(e,t)):nC(e)}function nC(t){var e=t;do{if((e.flags&32768)!==0){Jj(e,$0);return}t=e.return;var n=d0e(e.alternate,e,xp);if(n!==null){Vr=n;return}if(e=e.sibling,e!==null){Vr=e;return}Vr=e=t}while(e!==null);os===0&&(os=5)}function Jj(t,e){do{var n=p0e(t.alternate,t);if(n!==null){n.flags&=32767,Vr=n;return}if(n=t.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!e&&(t=t.sibling,t!==null)){Vr=t;return}Vr=t=n}while(t!==null);os=6,Vr=null}function fH(t,e,n,r,i,o,s,c,d){t.cancelPendingCommit=null;do rC();while(Js!==0);if((Ei&6)!==0)throw Error(Ht(327));if(e!==null){if(e===t.current)throw Error(Ht(177));if(o=e.lanes|e.childLanes,o|=DD,tpe(t,n,o,s,c,d),t===io&&(Vr=io=null,jr=0),q1=e,aA=t,Ap=n,aD=o,lD=i,Wj=r,(e.subtreeFlags&10256)!==0||(e.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,S0e(mS,function(){return rX(),null})):(t.callbackNode=null,t.callbackPriority=0),r=(e.flags&13878)!==0,(e.subtreeFlags&13878)!==0||r){r=ar.T,ar.T=null,i=Si.p,Si.p=2,s=Ei,Ei|=4;try{A0e(t,e,n)}finally{Ei=s,Si.p=i,ar.T=r}}Js=1,$j(),eX(),tX()}}function $j(){if(Js===1){Js=0;var t=aA,e=q1,n=(e.flags&13878)!==0;if((e.subtreeFlags&13878)!==0||n){n=ar.T,ar.T=null;var r=Si.p;Si.p=2;var i=Ei;Ei|=4;try{Fj(e,t);var o=dD,s=mW(t.containerInfo),c=o.focusedElem,d=o.selectionRange;if(s!==c&&c&&c.ownerDocument&&gW(c.ownerDocument.documentElement,c)){if(d!==null&&BD(c)){var m=d.start,b=d.end;if(b===void 0&&(b=m),\"selectionStart\"in c)c.selectionStart=m,c.selectionEnd=Math.min(b,c.value.length);else{var C=c.ownerDocument||document,B=C&&C.defaultView||window;if(B.getSelection){var k=B.getSelection(),V=c.textContent.length,q=Math.min(d.start,V),K=d.end===void 0?q:Math.min(d.end,V);!k.extend&&q>K&&(s=K,K=q,q=s);var Y=LG(c,q),ee=LG(c,K);if(Y&&ee&&(k.rangeCount!==1||k.anchorNode!==Y.node||k.anchorOffset!==Y.offset||k.focusNode!==ee.node||k.focusOffset!==ee.offset)){var J=C.createRange();J.setStart(Y.node,Y.offset),k.removeAllRanges(),q>K?(k.addRange(J),k.extend(ee.node,ee.offset)):(J.setEnd(ee.node,ee.offset),k.addRange(J))}}}}for(C=[],k=c;k=k.parentNode;)k.nodeType===1&&C.push({element:k,left:k.scrollLeft,top:k.scrollTop});for(typeof c.focus==\"function\"&&c.focus(),c=0;c<C.length;c++){var se=C[c];se.element.scrollLeft=se.left,se.element.scrollTop=se.top}}VS=!!fD,dD=fD=null}finally{Ei=i,Si.p=r,ar.T=n}}t.current=e,Js=2}}function eX(){if(Js===2){Js=0;var t=aA,e=q1,n=(e.flags&8772)!==0;if((e.subtreeFlags&8772)!==0||n){n=ar.T,ar.T=null;var r=Si.p;Si.p=2;var i=Ei;Ei|=4;try{Rj(t,e.alternate,e)}finally{Ei=i,Si.p=r,ar.T=n}}Js=3}}function tX(){if(Js===4||Js===3){Js=0,Xde();var t=aA,e=q1,n=Ap,r=Wj;(e.subtreeFlags&10256)!==0||(e.flags&10256)!==0?Js=5:(Js=0,q1=aA=null,nX(t,t.pendingLanes));var i=t.pendingLanes;if(i===0&&(sA=null),ED(n),e=e.stateNode,Zc&&typeof Zc.onCommitFiberRoot==\"function\")try{Zc.onCommitFiberRoot(kv,e,void 0,(e.current.flags&128)===128)}catch{}if(r!==null){e=ar.T,i=Si.p,Si.p=2,ar.T=null;try{for(var o=t.onRecoverableError,s=0;s<r.length;s++){var c=r[s];o(c.value,{componentStack:c.stack})}}finally{ar.T=e,Si.p=i}}(Ap&3)!==0&&rC(),Vf(t),i=t.pendingLanes,(n&261930)!==0&&(i&42)!==0?t===cD?xv++:(xv=0,cD=t):xv=0,jv(0,!1)}}function nX(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,Gv(e)))}function rC(){return $j(),eX(),tX(),rX()}function rX(){if(Js!==5)return!1;var t=aA,e=aD;aD=0;var n=ED(Ap),r=ar.T,i=Si.p;try{Si.p=32>n?32:n,ar.T=null,n=lD,lD=null;var o=aA,s=Ap;if(Js=0,q1=aA=null,Ap=0,(Ei&6)!==0)throw Error(Ht(331));var c=Ei;if(Ei|=4,Vj(o.current),Nj(o,o.current,s,n),Ei=c,jv(0,!1),Zc&&typeof Zc.onPostCommitFiberRoot==\"function\")try{Zc.onPostCommitFiberRoot(kv,o)}catch{}return!0}finally{Si.p=i,ar.T=r,nX(t,e)}}function dH(t,e,n){e=Nu(n,e),e=nD(t.stateNode,e,2),t=oA(t,e,2),t!==null&&(zv(t,2),Vf(t))}function zi(t,e,n){if(t.tag===3)dH(t,t,n);else for(;e!==null;){if(e.tag===3){dH(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError==\"function\"||typeof r.componentDidCatch==\"function\"&&(sA===null||!sA.has(r))){t=Nu(n,t),n=_j(2),r=oA(e,n,2),r!==null&&(yj(n,r,e,t),zv(r,2),Vf(r));break}}e=e.return}}function x6(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new _0e;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(sL=!0,i.add(n),t=w0e.bind(null,t,e,n),e.then(t,t))}function w0e(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,io===t&&(jr&n)===n&&(os===4||os===3&&(jr&62914560)===jr&&300>Yc()-eC?(Ei&2)===0&&Q1(t,0):aL|=n,Z1===jr&&(Z1=0)),Vf(t)}function iX(t,e){e===0&&(e=qH()),t=mm(t,e),t!==null&&(zv(t,e),Vf(t))}function T0e(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),iX(t,n)}function E0e(t,e){var n=0;switch(t.tag){case 31:case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;case 22:r=t.stateNode._retryCache;break;default:throw Error(Ht(314))}r!==null&&r.delete(e),iX(t,n)}function S0e(t,e){return wD(t,e)}var LS=null,b1=null,uD=!1,OS=!1,v6=!1,tA=0;function Vf(t){t!==b1&&t.next===null&&(b1===null?LS=b1=t:b1=b1.next=t),OS=!0,uD||(uD=!0,M0e())}function jv(t,e){if(!v6&&OS){v6=!0;do for(var n=!1,r=LS;r!==null;){if(!e)if(t!==0){var i=r.pendingLanes;if(i===0)var o=0;else{var s=r.suspendedLanes,c=r.pingedLanes;o=(1<<31-qc(42|t)+1)-1,o&=i&~(s&~c),o=o&201326741?o&201326741|1:o?o|2:0}o!==0&&(n=!0,pH(r,o))}else o=jr,o=HS(r,r===io?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),(o&3)===0||Nv(r,o)||(n=!0,pH(r,o));r=r.next}while(n);v6=!1}}function C0e(){oX()}function oX(){OS=uD=!1;var t=0;tA!==0&&F0e()&&(t=tA);for(var e=Yc(),n=null,r=LS;r!==null;){var i=r.next,o=sX(r,e);o===0?(r.next=null,n===null?LS=i:n.next=i,i===null&&(b1=n)):(n=r,(t!==0||(o&3)!==0)&&(OS=!0)),r=i}Js!==0&&Js!==5||jv(t,!1),tA!==0&&(tA=0)}function sX(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes&-62914561;0<o;){var s=31-qc(o),c=1<<s,d=i[s];d===-1?((c&n)===0||(c&r)!==0)&&(i[s]=epe(c,e)):d<=e&&(t.expiredLanes|=c),o&=~c}if(e=io,n=jr,n=HS(t,t===e?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),r=t.callbackNode,n===0||t===e&&(Ni===2||Ni===9)||t.cancelPendingCommit!==null)return r!==null&&r!==null&&QB(r),t.callbackNode=null,t.callbackPriority=0;if((n&3)===0||Nv(t,n)){if(e=n&-n,e===t.callbackPriority)return e;switch(r!==null&&QB(r),ED(n)){case 2:case 8:n=YH;break;case 32:n=mS;break;case 268435456:n=ZH;break;default:n=mS}return r=aX.bind(null,t),n=wD(n,r),t.callbackPriority=e,t.callbackNode=n,e}return r!==null&&r!==null&&QB(r),t.callbackPriority=2,t.callbackNode=null,2}function aX(t,e){if(Js!==0&&Js!==5)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if(rC()&&t.callbackNode!==n)return null;var r=jr;return r=HS(t,t===io?r:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),r===0?null:(Xj(t,r,e),sX(t,Yc()),t.callbackNode!=null&&t.callbackNode===n?aX.bind(null,t):null)}function pH(t,e){if(rC())return null;Xj(t,e,!0)}function M0e(){N0e(function(){(Ei&6)!==0?wD(XH,C0e):oX()})}function cL(){if(tA===0){var t=j1;t===0&&(t=FE,FE<<=1,(FE&261888)===0&&(FE=256)),tA=t}return tA}function AH(t){return t==null||typeof t==\"symbol\"||typeof t==\"boolean\"?null:typeof t==\"function\"?t:eS(\"\"+t)}function gH(t,e){var n=e.ownerDocument.createElement(\"input\");return n.name=e.name,n.value=e.value,t.id&&n.setAttribute(\"form\",t.id),e.parentNode.insertBefore(n,e),t=new FormData(t),n.parentNode.removeChild(n),t}function I0e(t,e,n,r,i){if(e===\"submit\"&&n&&n.stateNode===i){var o=AH((i[mc]||null).action),s=r.submitter;s&&(e=(e=s[mc]||null)?AH(e.formAction):s.getAttribute(\"formAction\"),e!==null&&(o=e,s=null));var c=new WS(\"action\",\"action\",null,r,i);t.push({event:c,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(tA!==0){var d=s?gH(i,s):new FormData(i);eD(n,{pending:!0,data:d,method:i.method,action:o},null,d)}}else typeof o==\"function\"&&(c.preventDefault(),d=s?gH(i,s):new FormData(i),eD(n,{pending:!0,data:d,method:i.method,action:o},o,d))},currentTarget:i}]})}}for(ZE=0;ZE<G6.length;ZE++)qE=G6[ZE],mH=qE.toLowerCase(),_H=qE[0].toUpperCase()+qE.slice(1),Hh(mH,\"on\"+_H);var qE,mH,_H,ZE;Hh(yW,\"onAnimationEnd\");Hh(xW,\"onAnimationIteration\");Hh(vW,\"onAnimationStart\");Hh(\"dblclick\",\"onDoubleClick\");Hh(\"focusin\",\"onFocus\");Hh(\"focusout\",\"onBlur\");Hh(Ype,\"onTransitionRun\");Hh(Zpe,\"onTransitionStart\");Hh(qpe,\"onTransitionCancel\");Hh(bW,\"onTransitionEnd\");H1(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]);H1(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]);H1(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]);H1(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]);pm(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \"));pm(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \"));pm(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]);pm(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \"));pm(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \"));pm(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var Rv=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),P0e=new Set(\"beforetoggle cancel close invalid load scroll scrollend toggle\".split(\" \").concat(Rv));function lX(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var c=r[s],d=c.instance,m=c.currentTarget;if(c=c.listener,d!==o&&i.isPropagationStopped())break e;o=c,i.currentTarget=m;try{o(i)}catch(b){yS(b)}i.currentTarget=null,o=d}else for(s=0;s<r.length;s++){if(c=r[s],d=c.instance,m=c.currentTarget,c=c.listener,d!==o&&i.isPropagationStopped())break e;o=c,i.currentTarget=m;try{o(i)}catch(b){yS(b)}i.currentTarget=null,o=d}}}}function Ur(t,e){var n=e[L6];n===void 0&&(n=e[L6]=new Set);var r=t+\"__bubble\";n.has(r)||(cX(e,t,2,!1),n.add(r))}function b6(t,e,n){var r=0;e&&(r|=4),cX(n,t,r,e)}var QE=\"_reactListening\"+Math.random().toString(36).slice(2);function uL(t){if(!t[QE]){t[QE]=!0,eW.forEach(function(n){n!==\"selectionchange\"&&(P0e.has(n)||b6(n,!1,t),b6(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[QE]||(e[QE]=!0,b6(\"selectionchange\",!1,e))}}function cX(t,e,n,r){switch(bX(e)){case 2:var i=iAe;break;case 8:i=oAe;break;default:i=pL}n=i.bind(null,e,n,t),i=void 0,!z6||e!==\"touchstart\"&&e!==\"touchmove\"&&e!==\"wheel\"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function w6(t,e,n,r,i){var o=r;if((e&1)===0&&(e&2)===0&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var c=r.stateNode.containerInfo;if(c===i)break;if(s===4)for(s=r.return;s!==null;){var d=s.tag;if((d===3||d===4)&&s.stateNode.containerInfo===i)return;s=s.return}for(;c!==null;){if(s=E1(c),s===null)return;if(d=s.tag,d===5||d===6||d===26||d===27){r=o=s;continue e}c=c.parentNode}}r=r.return}lW(function(){var m=o,b=MD(n),C=[];e:{var B=wW.get(t);if(B!==void 0){var k=WS,V=t;switch(t){case\"keypress\":if(nS(n)===0)break e;case\"keydown\":case\"keyup\":k=Epe;break;case\"focusin\":V=\"focus\",k=t6;break;case\"focusout\":V=\"blur\",k=t6;break;case\"beforeblur\":case\"afterblur\":k=t6;break;case\"click\":if(n.button===2)break e;case\"auxclick\":case\"dblclick\":case\"mousedown\":case\"mousemove\":case\"mouseup\":case\"mouseout\":case\"mouseover\":case\"contextmenu\":k=EG;break;case\"drag\":case\"dragend\":case\"dragenter\":case\"dragexit\":case\"dragleave\":case\"dragover\":case\"dragstart\":case\"drop\":k=dpe;break;case\"touchcancel\":case\"touchend\":case\"touchmove\":case\"touchstart\":k=Mpe;break;case yW:case xW:case vW:k=gpe;break;case bW:k=Ppe;break;case\"scroll\":case\"scrollend\":k=hpe;break;case\"wheel\":k=Bpe;break;case\"copy\":case\"cut\":case\"paste\":k=_pe;break;case\"gotpointercapture\":case\"lostpointercapture\":case\"pointercancel\":case\"pointerdown\":case\"pointermove\":case\"pointerout\":case\"pointerover\":case\"pointerup\":k=CG;break;case\"toggle\":case\"beforetoggle\":k=Lpe}var q=(e&4)!==0,K=!q&&(t===\"scroll\"||t===\"scrollend\"),Y=q?B!==null?B+\"Capture\":null:B;q=[];for(var ee=m,J;ee!==null;){var se=ee;if(J=se.stateNode,se=se.tag,se!==5&&se!==26&&se!==27||J===null||Y===null||(se=wv(ee,Y),se!=null&&q.push(Bv(ee,se,J))),K)break;ee=ee.return}0<q.length&&(B=new k(B,V,null,n,b),C.push({event:B,listeners:q}))}}if((e&7)===0){e:{if(B=t===\"mouseover\"||t===\"pointerover\",k=t===\"mouseout\"||t===\"pointerout\",B&&n!==N6&&(V=n.relatedTarget||n.fromElement)&&(E1(V)||V[$1]))break e;if((k||B)&&(B=b.window===b?b:(B=b.ownerDocument)?B.defaultView||B.parentWindow:window,k?(V=n.relatedTarget||n.toElement,k=m,V=V?E1(V):null,V!==null&&(K=Fv(V),q=V.tag,V!==K||q!==5&&q!==27&&q!==6)&&(V=null)):(k=null,V=m),k!==V)){if(q=EG,se=\"onMouseLeave\",Y=\"onMouseEnter\",ee=\"mouse\",(t===\"pointerout\"||t===\"pointerover\")&&(q=CG,se=\"onPointerLeave\",Y=\"onPointerEnter\",ee=\"pointer\"),K=k==null?B:sv(k),J=V==null?B:sv(V),B=new q(se,ee+\"leave\",k,n,b),B.target=K,B.relatedTarget=J,se=null,E1(b)===m&&(q=new q(Y,ee+\"enter\",V,n,b),q.target=J,q.relatedTarget=K,se=q),K=se,k&&V)t:{for(q=R0e,Y=k,ee=V,J=0,se=Y;se;se=q(se))J++;se=0;for(var xe=ee;xe;xe=q(xe))se++;for(;0<J-se;)Y=q(Y),J--;for(;0<se-J;)ee=q(ee),se--;for(;J--;){if(Y===ee||ee!==null&&Y===ee.alternate){q=Y;break t}Y=q(Y),ee=q(ee)}q=null}else q=null;k!==null&&yH(C,B,k,q,!1),V!==null&&K!==null&&yH(C,K,V,q,!0)}}e:{if(B=m?sv(m):window,k=B.nodeName&&B.nodeName.toLowerCase(),k===\"select\"||k===\"input\"&&B.type===\"file\")var Ee=RG;else if(PG(B))if(pW)Ee=Wpe;else{Ee=Gpe;var Xe=Vpe}else k=B.nodeName,!k||k.toLowerCase()!==\"input\"||B.type!==\"checkbox\"&&B.type!==\"radio\"?m&&CD(m.elementType)&&(Ee=RG):Ee=Hpe;if(Ee&&(Ee=Ee(t,m))){dW(C,Ee,n,b);break e}Xe&&Xe(t,B,m),t===\"focusout\"&&m&&B.type===\"number\"&&m.memoizedProps.value!=null&&k6(B,\"number\",B.value)}switch(Xe=m?sv(m):window,t){case\"focusin\":(PG(Xe)||Xe.contentEditable===\"true\")&&(M1=Xe,U6=m,hv=null);break;case\"focusout\":hv=U6=M1=null;break;case\"mousedown\":V6=!0;break;case\"contextmenu\":case\"mouseup\":case\"dragend\":V6=!1,OG(C,n,b);break;case\"selectionchange\":if(Xpe)break;case\"keydown\":case\"keyup\":OG(C,n,b)}var Ne;if(RD)e:{switch(t){case\"compositionstart\":var be=\"onCompositionStart\";break e;case\"compositionend\":be=\"onCompositionEnd\";break e;case\"compositionupdate\":be=\"onCompositionUpdate\";break e}be=void 0}else C1?hW(t,n)&&(be=\"onCompositionEnd\"):t===\"keydown\"&&n.keyCode===229&&(be=\"onCompositionStart\");be&&(uW&&n.locale!==\"ko\"&&(C1||be!==\"onCompositionStart\"?be===\"onCompositionEnd\"&&C1&&(Ne=cW()):(J0=b,ID=\"value\"in J0?J0.value:J0.textContent,C1=!0)),Xe=FS(m,be),0<Xe.length&&(be=new SG(be,t,null,n,b),C.push({event:be,listeners:Xe}),Ne?be.data=Ne:(Ne=fW(n),Ne!==null&&(be.data=Ne)))),(Ne=Fpe?kpe(t,n):Npe(t,n))&&(be=FS(m,\"onBeforeInput\"),0<be.length&&(Xe=new SG(\"onBeforeInput\",\"beforeinput\",null,n,b),C.push({event:Xe,listeners:be}),Xe.data=Ne)),I0e(C,t,m,n,b)}lX(C,e)})}function Bv(t,e,n){return{instance:t,listener:e,currentTarget:n}}function FS(t,e){for(var n=e+\"Capture\",r=[];t!==null;){var i=t,o=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||o===null||(i=wv(t,n),i!=null&&r.unshift(Bv(t,i,o)),i=wv(t,e),i!=null&&r.push(Bv(t,i,o))),t.tag===3)return r;t=t.return}return[]}function R0e(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function yH(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var c=n,d=c.alternate,m=c.stateNode;if(c=c.tag,d!==null&&d===r)break;c!==5&&c!==26&&c!==27||m===null||(d=m,i?(m=wv(n,o),m!=null&&s.unshift(Bv(n,m,d))):i||(m=wv(n,o),m!=null&&s.push(Bv(n,m,d)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var B0e=/\\r\\n?/g,D0e=/\\u0000|\\uFFFD/g;function xH(t){return(typeof t==\"string\"?t:\"\"+t).replace(B0e,`\n`).replace(D0e,\"\")}function uX(t,e){return e=xH(e),xH(t)===e}function qi(t,e,n,r,i,o){switch(n){case\"children\":typeof r==\"string\"?e===\"body\"||e===\"textarea\"&&r===\"\"||W1(t,r):(typeof r==\"number\"||typeof r==\"bigint\")&&e!==\"body\"&&W1(t,\"\"+r);break;case\"className\":zE(t,\"class\",r);break;case\"tabIndex\":zE(t,\"tabindex\",r);break;case\"dir\":case\"role\":case\"viewBox\":case\"width\":case\"height\":zE(t,n,r);break;case\"style\":aW(t,r,o);break;case\"data\":if(e!==\"object\"){zE(t,\"data\",r);break}case\"src\":case\"href\":if(r===\"\"&&(e!==\"a\"||n!==\"href\")){t.removeAttribute(n);break}if(r==null||typeof r==\"function\"||typeof r==\"symbol\"||typeof r==\"boolean\"){t.removeAttribute(n);break}r=eS(\"\"+r),t.setAttribute(n,r);break;case\"action\":case\"formAction\":if(typeof r==\"function\"){t.setAttribute(n,\"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')\");break}else typeof o==\"function\"&&(n===\"formAction\"?(e!==\"input\"&&qi(t,e,\"name\",i.name,i,null),qi(t,e,\"formEncType\",i.formEncType,i,null),qi(t,e,\"formMethod\",i.formMethod,i,null),qi(t,e,\"formTarget\",i.formTarget,i,null)):(qi(t,e,\"encType\",i.encType,i,null),qi(t,e,\"method\",i.method,i,null),qi(t,e,\"target\",i.target,i,null)));if(r==null||typeof r==\"symbol\"||typeof r==\"boolean\"){t.removeAttribute(n);break}r=eS(\"\"+r),t.setAttribute(n,r);break;case\"onClick\":r!=null&&(t.onclick=hp);break;case\"onScroll\":r!=null&&Ur(\"scroll\",t);break;case\"onScrollEnd\":r!=null&&Ur(\"scrollend\",t);break;case\"dangerouslySetInnerHTML\":if(r!=null){if(typeof r!=\"object\"||!(\"__html\"in r))throw Error(Ht(61));if(n=r.__html,n!=null){if(i.children!=null)throw Error(Ht(60));t.innerHTML=n}}break;case\"multiple\":t.multiple=r&&typeof r!=\"function\"&&typeof r!=\"symbol\";break;case\"muted\":t.muted=r&&typeof r!=\"function\"&&typeof r!=\"symbol\";break;case\"suppressContentEditableWarning\":case\"suppressHydrationWarning\":case\"defaultValue\":case\"defaultChecked\":case\"innerHTML\":case\"ref\":break;case\"autoFocus\":break;case\"xlinkHref\":if(r==null||typeof r==\"function\"||typeof r==\"boolean\"||typeof r==\"symbol\"){t.removeAttribute(\"xlink:href\");break}n=eS(\"\"+r),t.setAttributeNS(\"http://www.w3.org/1999/xlink\",\"xlink:href\",n);break;case\"contentEditable\":case\"spellCheck\":case\"draggable\":case\"value\":case\"autoReverse\":case\"externalResourcesRequired\":case\"focusable\":case\"preserveAlpha\":r!=null&&typeof r!=\"function\"&&typeof r!=\"symbol\"?t.setAttribute(n,\"\"+r):t.removeAttribute(n);break;case\"inert\":case\"allowFullScreen\":case\"async\":case\"autoPlay\":case\"controls\":case\"default\":case\"defer\":case\"disabled\":case\"disablePictureInPicture\":case\"disableRemotePlayback\":case\"formNoValidate\":case\"hidden\":case\"loop\":case\"noModule\":case\"noValidate\":case\"open\":case\"playsInline\":case\"readOnly\":case\"required\":case\"reversed\":case\"scoped\":case\"seamless\":case\"itemScope\":r&&typeof r!=\"function\"&&typeof r!=\"symbol\"?t.setAttribute(n,\"\"):t.removeAttribute(n);break;case\"capture\":case\"download\":r===!0?t.setAttribute(n,\"\"):r!==!1&&r!=null&&typeof r!=\"function\"&&typeof r!=\"symbol\"?t.setAttribute(n,r):t.removeAttribute(n);break;case\"cols\":case\"rows\":case\"size\":case\"span\":r!=null&&typeof r!=\"function\"&&typeof r!=\"symbol\"&&!isNaN(r)&&1<=r?t.setAttribute(n,r):t.removeAttribute(n);break;case\"rowSpan\":case\"start\":r==null||typeof r==\"function\"||typeof r==\"symbol\"||isNaN(r)?t.removeAttribute(n):t.setAttribute(n,r);break;case\"popover\":Ur(\"beforetoggle\",t),Ur(\"toggle\",t),$E(t,\"popover\",r);break;case\"xlinkActuate\":rp(t,\"http://www.w3.org/1999/xlink\",\"xlink:actuate\",r);break;case\"xlinkArcrole\":rp(t,\"http://www.w3.org/1999/xlink\",\"xlink:arcrole\",r);break;case\"xlinkRole\":rp(t,\"http://www.w3.org/1999/xlink\",\"xlink:role\",r);break;case\"xlinkShow\":rp(t,\"http://www.w3.org/1999/xlink\",\"xlink:show\",r);break;case\"xlinkTitle\":rp(t,\"http://www.w3.org/1999/xlink\",\"xlink:title\",r);break;case\"xlinkType\":rp(t,\"http://www.w3.org/1999/xlink\",\"xlink:type\",r);break;case\"xmlBase\":rp(t,\"http://www.w3.org/XML/1998/namespace\",\"xml:base\",r);break;case\"xmlLang\":rp(t,\"http://www.w3.org/XML/1998/namespace\",\"xml:lang\",r);break;case\"xmlSpace\":rp(t,\"http://www.w3.org/XML/1998/namespace\",\"xml:space\",r);break;case\"is\":$E(t,\"is\",r);break;case\"innerText\":case\"textContent\":break;default:(!(2<n.length)||n[0]!==\"o\"&&n[0]!==\"O\"||n[1]!==\"n\"&&n[1]!==\"N\")&&(n=cpe.get(n)||n,$E(t,n,r))}}function hD(t,e,n,r,i,o){switch(n){case\"style\":aW(t,r,o);break;case\"dangerouslySetInnerHTML\":if(r!=null){if(typeof r!=\"object\"||!(\"__html\"in r))throw Error(Ht(61));if(n=r.__html,n!=null){if(i.children!=null)throw Error(Ht(60));t.innerHTML=n}}break;case\"children\":typeof r==\"string\"?W1(t,r):(typeof r==\"number\"||typeof r==\"bigint\")&&W1(t,\"\"+r);break;case\"onScroll\":r!=null&&Ur(\"scroll\",t);break;case\"onScrollEnd\":r!=null&&Ur(\"scrollend\",t);break;case\"onClick\":r!=null&&(t.onclick=hp);break;case\"suppressContentEditableWarning\":case\"suppressHydrationWarning\":case\"innerHTML\":case\"ref\":break;case\"innerText\":case\"textContent\":break;default:if(!tW.hasOwnProperty(n))e:{if(n[0]===\"o\"&&n[1]===\"n\"&&(i=n.endsWith(\"Capture\"),e=n.slice(2,i?n.length-7:void 0),o=t[mc]||null,o=o!=null?o[n]:null,typeof o==\"function\"&&t.removeEventListener(e,o,i),typeof r==\"function\")){typeof o!=\"function\"&&o!==null&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(e,r,i);break e}n in t?t[n]=r:r===!0?t.setAttribute(n,\"\"):$E(t,n,r)}}}function Wa(t,e,n){switch(e){case\"div\":case\"span\":case\"svg\":case\"path\":case\"a\":case\"g\":case\"p\":case\"li\":break;case\"img\":Ur(\"error\",t),Ur(\"load\",t);var r=!1,i=!1,o;for(o in n)if(n.hasOwnProperty(o)){var s=n[o];if(s!=null)switch(o){case\"src\":r=!0;break;case\"srcSet\":i=!0;break;case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Ht(137,e));default:qi(t,e,o,s,n,null)}}i&&qi(t,e,\"srcSet\",n.srcSet,n,null),r&&qi(t,e,\"src\",n.src,n,null);return;case\"input\":Ur(\"invalid\",t);var c=o=s=i=null,d=null,m=null;for(r in n)if(n.hasOwnProperty(r)){var b=n[r];if(b!=null)switch(r){case\"name\":i=b;break;case\"type\":s=b;break;case\"checked\":d=b;break;case\"defaultChecked\":m=b;break;case\"value\":o=b;break;case\"defaultValue\":c=b;break;case\"children\":case\"dangerouslySetInnerHTML\":if(b!=null)throw Error(Ht(137,e));break;default:qi(t,e,r,b,n,null)}}iW(t,o,c,d,m,s,i,!1);return;case\"select\":Ur(\"invalid\",t),r=s=o=null;for(i in n)if(n.hasOwnProperty(i)&&(c=n[i],c!=null))switch(i){case\"value\":o=c;break;case\"defaultValue\":s=c;break;case\"multiple\":r=c;default:qi(t,e,i,c,n,null)}e=o,n=s,t.multiple=!!r,e!=null?F1(t,!!r,e,!1):n!=null&&F1(t,!!r,n,!0);return;case\"textarea\":Ur(\"invalid\",t),o=i=r=null;for(s in n)if(n.hasOwnProperty(s)&&(c=n[s],c!=null))switch(s){case\"value\":r=c;break;case\"defaultValue\":i=c;break;case\"children\":o=c;break;case\"dangerouslySetInnerHTML\":if(c!=null)throw Error(Ht(91));break;default:qi(t,e,s,c,n,null)}sW(t,r,i,o);return;case\"option\":for(d in n)if(n.hasOwnProperty(d)&&(r=n[d],r!=null))switch(d){case\"selected\":t.selected=r&&typeof r!=\"function\"&&typeof r!=\"symbol\";break;default:qi(t,e,d,r,n,null)}return;case\"dialog\":Ur(\"beforetoggle\",t),Ur(\"toggle\",t),Ur(\"cancel\",t),Ur(\"close\",t);break;case\"iframe\":case\"object\":Ur(\"load\",t);break;case\"video\":case\"audio\":for(r=0;r<Rv.length;r++)Ur(Rv[r],t);break;case\"image\":Ur(\"error\",t),Ur(\"load\",t);break;case\"details\":Ur(\"toggle\",t);break;case\"embed\":case\"source\":case\"link\":Ur(\"error\",t),Ur(\"load\",t);case\"area\":case\"base\":case\"br\":case\"col\":case\"hr\":case\"keygen\":case\"meta\":case\"param\":case\"track\":case\"wbr\":case\"menuitem\":for(m in n)if(n.hasOwnProperty(m)&&(r=n[m],r!=null))switch(m){case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Ht(137,e));default:qi(t,e,m,r,n,null)}return;default:if(CD(e)){for(b in n)n.hasOwnProperty(b)&&(r=n[b],r!==void 0&&hD(t,e,b,r,n,void 0));return}}for(c in n)n.hasOwnProperty(c)&&(r=n[c],r!=null&&qi(t,e,c,r,n,null))}function L0e(t,e,n,r){switch(e){case\"div\":case\"span\":case\"svg\":case\"path\":case\"a\":case\"g\":case\"p\":case\"li\":break;case\"input\":var i=null,o=null,s=null,c=null,d=null,m=null,b=null;for(k in n){var C=n[k];if(n.hasOwnProperty(k)&&C!=null)switch(k){case\"checked\":break;case\"value\":break;case\"defaultValue\":d=C;default:r.hasOwnProperty(k)||qi(t,e,k,null,r,C)}}for(var B in r){var k=r[B];if(C=n[B],r.hasOwnProperty(B)&&(k!=null||C!=null))switch(B){case\"type\":o=k;break;case\"name\":i=k;break;case\"checked\":m=k;break;case\"defaultChecked\":b=k;break;case\"value\":s=k;break;case\"defaultValue\":c=k;break;case\"children\":case\"dangerouslySetInnerHTML\":if(k!=null)throw Error(Ht(137,e));break;default:k!==C&&qi(t,e,B,k,r,C)}}F6(t,s,c,d,m,b,o,i);return;case\"select\":k=s=c=B=null;for(o in n)if(d=n[o],n.hasOwnProperty(o)&&d!=null)switch(o){case\"value\":break;case\"multiple\":k=d;default:r.hasOwnProperty(o)||qi(t,e,o,null,r,d)}for(i in r)if(o=r[i],d=n[i],r.hasOwnProperty(i)&&(o!=null||d!=null))switch(i){case\"value\":B=o;break;case\"defaultValue\":c=o;break;case\"multiple\":s=o;default:o!==d&&qi(t,e,i,o,r,d)}e=c,n=s,r=k,B!=null?F1(t,!!n,B,!1):!!r!=!!n&&(e!=null?F1(t,!!n,e,!0):F1(t,!!n,n?[]:\"\",!1));return;case\"textarea\":k=B=null;for(c in n)if(i=n[c],n.hasOwnProperty(c)&&i!=null&&!r.hasOwnProperty(c))switch(c){case\"value\":break;case\"children\":break;default:qi(t,e,c,null,r,i)}for(s in r)if(i=r[s],o=n[s],r.hasOwnProperty(s)&&(i!=null||o!=null))switch(s){case\"value\":B=i;break;case\"defaultValue\":k=i;break;case\"children\":break;case\"dangerouslySetInnerHTML\":if(i!=null)throw Error(Ht(91));break;default:i!==o&&qi(t,e,s,i,r,o)}oW(t,B,k);return;case\"option\":for(var V in n)if(B=n[V],n.hasOwnProperty(V)&&B!=null&&!r.hasOwnProperty(V))switch(V){case\"selected\":t.selected=!1;break;default:qi(t,e,V,null,r,B)}for(d in r)if(B=r[d],k=n[d],r.hasOwnProperty(d)&&B!==k&&(B!=null||k!=null))switch(d){case\"selected\":t.selected=B&&typeof B!=\"function\"&&typeof B!=\"symbol\";break;default:qi(t,e,d,B,r,k)}return;case\"img\":case\"link\":case\"area\":case\"base\":case\"br\":case\"col\":case\"embed\":case\"hr\":case\"keygen\":case\"meta\":case\"param\":case\"source\":case\"track\":case\"wbr\":case\"menuitem\":for(var q in n)B=n[q],n.hasOwnProperty(q)&&B!=null&&!r.hasOwnProperty(q)&&qi(t,e,q,null,r,B);for(m in r)if(B=r[m],k=n[m],r.hasOwnProperty(m)&&B!==k&&(B!=null||k!=null))switch(m){case\"children\":case\"dangerouslySetInnerHTML\":if(B!=null)throw Error(Ht(137,e));break;default:qi(t,e,m,B,r,k)}return;default:if(CD(e)){for(var K in n)B=n[K],n.hasOwnProperty(K)&&B!==void 0&&!r.hasOwnProperty(K)&&hD(t,e,K,void 0,r,B);for(b in r)B=r[b],k=n[b],!r.hasOwnProperty(b)||B===k||B===void 0&&k===void 0||hD(t,e,b,B,r,k);return}}for(var Y in n)B=n[Y],n.hasOwnProperty(Y)&&B!=null&&!r.hasOwnProperty(Y)&&qi(t,e,Y,null,r,B);for(C in r)B=r[C],k=n[C],!r.hasOwnProperty(C)||B===k||B==null&&k==null||qi(t,e,C,B,r,k)}function vH(t){switch(t){case\"css\":case\"script\":case\"font\":case\"img\":case\"image\":case\"input\":case\"link\":return!0;default:return!1}}function O0e(){if(typeof performance.getEntriesByType==\"function\"){for(var t=0,e=0,n=performance.getEntriesByType(\"resource\"),r=0;r<n.length;r++){var i=n[r],o=i.transferSize,s=i.initiatorType,c=i.duration;if(o&&c&&vH(s)){for(s=0,c=i.responseEnd,r+=1;r<n.length;r++){var d=n[r],m=d.startTime;if(m>c)break;var b=d.transferSize,C=d.initiatorType;b&&vH(C)&&(d=d.responseEnd,s+=b*(d<c?1:(c-m)/(d-m)))}if(--r,e+=8*(o+s)/(i.duration/1e3),t++,10<t)break}}if(0<t)return e/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t==\"number\")?t:5}var fD=null,dD=null;function kS(t){return t.nodeType===9?t:t.ownerDocument}function bH(t){switch(t){case\"http://www.w3.org/2000/svg\":return 1;case\"http://www.w3.org/1998/Math/MathML\":return 2;default:return 0}}function hX(t,e){if(t===0)switch(e){case\"svg\":return 1;case\"math\":return 2;default:return 0}return t===1&&e===\"foreignObject\"?0:t}function pD(t,e){return t===\"textarea\"||t===\"noscript\"||typeof e.children==\"string\"||typeof e.children==\"number\"||typeof e.children==\"bigint\"||typeof e.dangerouslySetInnerHTML==\"object\"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var T6=null;function F0e(){var t=window.event;return t&&t.type===\"popstate\"?t===T6?!1:(T6=t,!0):(T6=null,!1)}var fX=typeof setTimeout==\"function\"?setTimeout:void 0,k0e=typeof clearTimeout==\"function\"?clearTimeout:void 0,wH=typeof Promise==\"function\"?Promise:void 0,N0e=typeof queueMicrotask==\"function\"?queueMicrotask:typeof wH<\"u\"?function(t){return wH.resolve(null).then(t).catch(z0e)}:fX;function z0e(t){setTimeout(function(){throw t})}function gA(t){return t===\"head\"}function TH(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n===\"/$\"||n===\"/&\"){if(r===0){t.removeChild(i),J1(e);return}r--}else if(n===\"$\"||n===\"$?\"||n===\"$~\"||n===\"$!\"||n===\"&\")r++;else if(n===\"html\")vv(t.ownerDocument.documentElement);else if(n===\"head\"){n=t.ownerDocument.head,vv(n);for(var o=n.firstChild;o;){var s=o.nextSibling,c=o.nodeName;o[Uv]||c===\"SCRIPT\"||c===\"STYLE\"||c===\"LINK\"&&o.rel.toLowerCase()===\"stylesheet\"||n.removeChild(o),o=s}}else n===\"body\"&&vv(t.ownerDocument.body);n=i}while(n);J1(e)}function EH(t,e){var n=t;t=0;do{var r=n.nextSibling;if(n.nodeType===1?e?(n._stashedDisplay=n.style.display,n.style.display=\"none\"):(n.style.display=n._stashedDisplay||\"\",n.getAttribute(\"style\")===\"\"&&n.removeAttribute(\"style\")):n.nodeType===3&&(e?(n._stashedText=n.nodeValue,n.nodeValue=\"\"):n.nodeValue=n._stashedText||\"\"),r&&r.nodeType===8)if(n=r.data,n===\"/$\"){if(t===0)break;t--}else n!==\"$\"&&n!==\"$?\"&&n!==\"$~\"&&n!==\"$!\"||t++;n=r}while(n)}function AD(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var n=e;switch(e=e.nextSibling,n.nodeName){case\"HTML\":case\"HEAD\":case\"BODY\":AD(n),SD(n);continue;case\"SCRIPT\":case\"STYLE\":continue;case\"LINK\":if(n.rel.toLowerCase()===\"stylesheet\")continue}t.removeChild(n)}}function U0e(t,e,n,r){for(;t.nodeType===1;){var i=n;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!r&&(t.nodeName!==\"INPUT\"||t.type!==\"hidden\"))break}else if(r){if(!t[Uv])switch(e){case\"meta\":if(!t.hasAttribute(\"itemprop\"))break;return t;case\"link\":if(o=t.getAttribute(\"rel\"),o===\"stylesheet\"&&t.hasAttribute(\"data-precedence\"))break;if(o!==i.rel||t.getAttribute(\"href\")!==(i.href==null||i.href===\"\"?null:i.href)||t.getAttribute(\"crossorigin\")!==(i.crossOrigin==null?null:i.crossOrigin)||t.getAttribute(\"title\")!==(i.title==null?null:i.title))break;return t;case\"style\":if(t.hasAttribute(\"data-precedence\"))break;return t;case\"script\":if(o=t.getAttribute(\"src\"),(o!==(i.src==null?null:i.src)||t.getAttribute(\"type\")!==(i.type==null?null:i.type)||t.getAttribute(\"crossorigin\")!==(i.crossOrigin==null?null:i.crossOrigin))&&o&&t.hasAttribute(\"async\")&&!t.hasAttribute(\"itemprop\"))break;return t;default:return t}}else if(e===\"input\"&&t.type===\"hidden\"){var o=i.name==null?null:\"\"+i.name;if(i.type===\"hidden\"&&t.getAttribute(\"name\")===o)return t}else return t;if(t=Vu(t.nextSibling),t===null)break}return null}function V0e(t,e,n){if(e===\"\")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!==\"INPUT\"||t.type!==\"hidden\")&&!n||(t=Vu(t.nextSibling),t===null))return null;return t}function dX(t,e){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!==\"INPUT\"||t.type!==\"hidden\")&&!e||(t=Vu(t.nextSibling),t===null))return null;return t}function gD(t){return t.data===\"$?\"||t.data===\"$~\"}function mD(t){return t.data===\"$!\"||t.data===\"$?\"&&t.ownerDocument.readyState!==\"loading\"}function G0e(t,e){var n=t.ownerDocument;if(t.data===\"$~\")t._reactRetry=e;else if(t.data!==\"$?\"||n.readyState!==\"loading\")e();else{var r=function(){e(),n.removeEventListener(\"DOMContentLoaded\",r)};n.addEventListener(\"DOMContentLoaded\",r),t._reactRetry=r}}function Vu(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e===\"$\"||e===\"$!\"||e===\"$?\"||e===\"$~\"||e===\"&\"||e===\"F!\"||e===\"F\")break;if(e===\"/$\"||e===\"/&\")return null}}return t}var _D=null;function SH(t){t=t.nextSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n===\"/$\"||n===\"/&\"){if(e===0)return Vu(t.nextSibling);e--}else n!==\"$\"&&n!==\"$!\"&&n!==\"$?\"&&n!==\"$~\"&&n!==\"&\"||e++}t=t.nextSibling}return null}function CH(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n===\"$\"||n===\"$!\"||n===\"$?\"||n===\"$~\"||n===\"&\"){if(e===0)return t;e--}else n!==\"/$\"&&n!==\"/&\"||e++}t=t.previousSibling}return null}function pX(t,e,n){switch(e=kS(n),t){case\"html\":if(t=e.documentElement,!t)throw Error(Ht(452));return t;case\"head\":if(t=e.head,!t)throw Error(Ht(453));return t;case\"body\":if(t=e.body,!t)throw Error(Ht(454));return t;default:throw Error(Ht(451))}}function vv(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);SD(t)}var Gu=new Map,MH=new Set;function NS(t){return typeof t.getRootNode==\"function\"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var vp=Si.d;Si.d={f:H0e,r:W0e,D:j0e,C:X0e,L:Y0e,m:Z0e,X:Q0e,S:q0e,M:K0e};function H0e(){var t=vp.f(),e=tC();return t||e}function W0e(t){var e=ey(t);e!==null&&e.tag===5&&e.type===\"form\"?aj(e):vp.r(t)}var iy=typeof document>\"u\"?null:document;function AX(t,e,n){var r=iy;if(r&&typeof e==\"string\"&&e){var i=ku(e);i='link[rel=\"'+t+'\"][href=\"'+i+'\"]',typeof n==\"string\"&&(i+='[crossorigin=\"'+n+'\"]'),MH.has(i)||(MH.add(i),t={rel:t,crossOrigin:n,href:e},r.querySelector(i)===null&&(e=r.createElement(\"link\"),Wa(e,\"link\",t),ma(e),r.head.appendChild(e)))}}function j0e(t){vp.D(t),AX(\"dns-prefetch\",t,null)}function X0e(t,e){vp.C(t,e),AX(\"preconnect\",t,e)}function Y0e(t,e,n){vp.L(t,e,n);var r=iy;if(r&&t&&e){var i='link[rel=\"preload\"][as=\"'+ku(e)+'\"]';e===\"image\"&&n&&n.imageSrcSet?(i+='[imagesrcset=\"'+ku(n.imageSrcSet)+'\"]',typeof n.imageSizes==\"string\"&&(i+='[imagesizes=\"'+ku(n.imageSizes)+'\"]')):i+='[href=\"'+ku(t)+'\"]';var o=i;switch(e){case\"style\":o=K1(t);break;case\"script\":o=oy(t)}Gu.has(o)||(t=Io({rel:\"preload\",href:e===\"image\"&&n&&n.imageSrcSet?void 0:t,as:e},n),Gu.set(o,t),r.querySelector(i)!==null||e===\"style\"&&r.querySelector(Xv(o))||e===\"script\"&&r.querySelector(Yv(o))||(e=r.createElement(\"link\"),Wa(e,\"link\",t),ma(e),r.head.appendChild(e)))}}function Z0e(t,e){vp.m(t,e);var n=iy;if(n&&t){var r=e&&typeof e.as==\"string\"?e.as:\"script\",i='link[rel=\"modulepreload\"][as=\"'+ku(r)+'\"][href=\"'+ku(t)+'\"]',o=i;switch(r){case\"audioworklet\":case\"paintworklet\":case\"serviceworker\":case\"sharedworker\":case\"worker\":case\"script\":o=oy(t)}if(!Gu.has(o)&&(t=Io({rel:\"modulepreload\",href:t},e),Gu.set(o,t),n.querySelector(i)===null)){switch(r){case\"audioworklet\":case\"paintworklet\":case\"serviceworker\":case\"sharedworker\":case\"worker\":case\"script\":if(n.querySelector(Yv(o)))return}r=n.createElement(\"link\"),Wa(r,\"link\",t),ma(r),n.head.appendChild(r)}}}function q0e(t,e,n){vp.S(t,e,n);var r=iy;if(r&&t){var i=O1(r).hoistableStyles,o=K1(t);e=e||\"default\";var s=i.get(o);if(!s){var c={loading:0,preload:null};if(s=r.querySelector(Xv(o)))c.loading=5;else{t=Io({rel:\"stylesheet\",href:t,\"data-precedence\":e},n),(n=Gu.get(o))&&hL(t,n);var d=s=r.createElement(\"link\");ma(d),Wa(d,\"link\",t),d._p=new Promise(function(m,b){d.onload=m,d.onerror=b}),d.addEventListener(\"load\",function(){c.loading|=1}),d.addEventListener(\"error\",function(){c.loading|=2}),c.loading|=4,uS(s,e,r)}s={type:\"stylesheet\",instance:s,count:1,state:c},i.set(o,s)}}}function Q0e(t,e){vp.X(t,e);var n=iy;if(n&&t){var r=O1(n).hoistableScripts,i=oy(t),o=r.get(i);o||(o=n.querySelector(Yv(i)),o||(t=Io({src:t,async:!0},e),(e=Gu.get(i))&&fL(t,e),o=n.createElement(\"script\"),ma(o),Wa(o,\"link\",t),n.head.appendChild(o)),o={type:\"script\",instance:o,count:1,state:null},r.set(i,o))}}function K0e(t,e){vp.M(t,e);var n=iy;if(n&&t){var r=O1(n).hoistableScripts,i=oy(t),o=r.get(i);o||(o=n.querySelector(Yv(i)),o||(t=Io({src:t,async:!0,type:\"module\"},e),(e=Gu.get(i))&&fL(t,e),o=n.createElement(\"script\"),ma(o),Wa(o,\"link\",t),n.head.appendChild(o)),o={type:\"script\",instance:o,count:1,state:null},r.set(i,o))}}function IH(t,e,n,r){var i=(i=nA.current)?NS(i):null;if(!i)throw Error(Ht(446));switch(t){case\"meta\":case\"title\":return null;case\"style\":return typeof n.precedence==\"string\"&&typeof n.href==\"string\"?(e=K1(n.href),n=O1(i).hoistableStyles,r=n.get(e),r||(r={type:\"style\",instance:null,count:0,state:null},n.set(e,r)),r):{type:\"void\",instance:null,count:0,state:null};case\"link\":if(n.rel===\"stylesheet\"&&typeof n.href==\"string\"&&typeof n.precedence==\"string\"){t=K1(n.href);var o=O1(i).hoistableStyles,s=o.get(t);if(s||(i=i.ownerDocument||i,s={type:\"stylesheet\",instance:null,count:0,state:{loading:0,preload:null}},o.set(t,s),(o=i.querySelector(Xv(t)))&&!o._p&&(s.instance=o,s.state.loading=5),Gu.has(t)||(n={rel:\"preload\",as:\"style\",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Gu.set(t,n),o||J0e(i,t,n,s.state))),e&&r===null)throw Error(Ht(528,\"\"));return s}if(e&&r!==null)throw Error(Ht(529,\"\"));return null;case\"script\":return e=n.async,n=n.src,typeof n==\"string\"&&e&&typeof e!=\"function\"&&typeof e!=\"symbol\"?(e=oy(n),n=O1(i).hoistableScripts,r=n.get(e),r||(r={type:\"script\",instance:null,count:0,state:null},n.set(e,r)),r):{type:\"void\",instance:null,count:0,state:null};default:throw Error(Ht(444,t))}}function K1(t){return'href=\"'+ku(t)+'\"'}function Xv(t){return'link[rel=\"stylesheet\"]['+t+\"]\"}function gX(t){return Io({},t,{\"data-precedence\":t.precedence,precedence:null})}function J0e(t,e,n,r){t.querySelector('link[rel=\"preload\"][as=\"style\"]['+e+\"]\")?r.loading=1:(e=t.createElement(\"link\"),r.preload=e,e.addEventListener(\"load\",function(){return r.loading|=1}),e.addEventListener(\"error\",function(){return r.loading|=2}),Wa(e,\"link\",n),ma(e),t.head.appendChild(e))}function oy(t){return'[src=\"'+ku(t)+'\"]'}function Yv(t){return\"script[async]\"+t}function PH(t,e,n){if(e.count++,e.instance===null)switch(e.type){case\"style\":var r=t.querySelector('style[data-href~=\"'+ku(n.href)+'\"]');if(r)return e.instance=r,ma(r),r;var i=Io({},n,{\"data-href\":n.href,\"data-precedence\":n.precedence,href:null,precedence:null});return r=(t.ownerDocument||t).createElement(\"style\"),ma(r),Wa(r,\"style\",i),uS(r,n.precedence,t),e.instance=r;case\"stylesheet\":i=K1(n.href);var o=t.querySelector(Xv(i));if(o)return e.state.loading|=4,e.instance=o,ma(o),o;r=gX(n),(i=Gu.get(i))&&hL(r,i),o=(t.ownerDocument||t).createElement(\"link\"),ma(o);var s=o;return s._p=new Promise(function(c,d){s.onload=c,s.onerror=d}),Wa(o,\"link\",r),e.state.loading|=4,uS(o,n.precedence,t),e.instance=o;case\"script\":return o=oy(n.src),(i=t.querySelector(Yv(o)))?(e.instance=i,ma(i),i):(r=n,(i=Gu.get(o))&&(r=Io({},n),fL(r,i)),t=t.ownerDocument||t,i=t.createElement(\"script\"),ma(i),Wa(i,\"link\",r),t.head.appendChild(i),e.instance=i);case\"void\":return null;default:throw Error(Ht(443,e.type))}else e.type===\"stylesheet\"&&(e.state.loading&4)===0&&(r=e.instance,e.state.loading|=4,uS(r,n.precedence,t));return e.instance}function uS(t,e,n){for(var r=n.querySelectorAll('link[rel=\"stylesheet\"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,o=i,s=0;s<r.length;s++){var c=r[s];if(c.dataset.precedence===e)o=c;else if(o!==i)break}o?o.parentNode.insertBefore(t,o.nextSibling):(e=n.nodeType===9?n.head:n,e.insertBefore(t,e.firstChild))}function hL(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function fL(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var hS=null;function RH(t,e,n){if(hS===null){var r=new Map,i=hS=new Map;i.set(n,r)}else i=hS,r=i.get(n),r||(r=new Map,i.set(n,r));if(r.has(t))return r;for(r.set(t,null),n=n.getElementsByTagName(t),i=0;i<n.length;i++){var o=n[i];if(!(o[Uv]||o[Va]||t===\"link\"&&o.getAttribute(\"rel\")===\"stylesheet\")&&o.namespaceURI!==\"http://www.w3.org/2000/svg\"){var s=o.getAttribute(e)||\"\";s=t+s;var c=r.get(s);c?c.push(o):r.set(s,[o])}}return r}function BH(t,e,n){t=t.ownerDocument||t,t.head.insertBefore(n,e===\"title\"?t.querySelector(\"head > title\"):null)}function $0e(t,e,n){if(n===1||e.itemProp!=null)return!1;switch(t){case\"meta\":case\"title\":return!0;case\"style\":if(typeof e.precedence!=\"string\"||typeof e.href!=\"string\"||e.href===\"\")break;return!0;case\"link\":if(typeof e.rel!=\"string\"||typeof e.href!=\"string\"||e.href===\"\"||e.onLoad||e.onError)break;switch(e.rel){case\"stylesheet\":return t=e.disabled,typeof e.precedence==\"string\"&&t==null;default:return!0}case\"script\":if(e.async&&typeof e.async!=\"function\"&&typeof e.async!=\"symbol\"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src==\"string\")return!0}return!1}function mX(t){return!(t.type===\"stylesheet\"&&(t.state.loading&3)===0)}function eAe(t,e,n,r){if(n.type===\"stylesheet\"&&(typeof r.media!=\"string\"||matchMedia(r.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var i=K1(r.href),o=e.querySelector(Xv(i));if(o){e=o._p,e!==null&&typeof e==\"object\"&&typeof e.then==\"function\"&&(t.count++,t=zS.bind(t),e.then(t,t)),n.state.loading|=4,n.instance=o,ma(o);return}o=e.ownerDocument||e,r=gX(r),(i=Gu.get(i))&&hL(r,i),o=o.createElement(\"link\"),ma(o);var s=o;s._p=new Promise(function(c,d){s.onload=c,s.onerror=d}),Wa(o,\"link\",r),n.instance=o}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(n,e),(e=n.state.preload)&&(n.state.loading&3)===0&&(t.count++,n=zS.bind(t),e.addEventListener(\"load\",n),e.addEventListener(\"error\",n))}}var E6=0;function tAe(t,e){return t.stylesheets&&t.count===0&&fS(t,t.stylesheets),0<t.count||0<t.imgCount?function(n){var r=setTimeout(function(){if(t.stylesheets&&fS(t,t.stylesheets),t.unsuspend){var o=t.unsuspend;t.unsuspend=null,o()}},6e4+e);0<t.imgBytes&&E6===0&&(E6=62500*O0e());var i=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&fS(t,t.stylesheets),t.unsuspend)){var o=t.unsuspend;t.unsuspend=null,o()}},(t.imgBytes>E6?50:800)+e);return t.unsuspend=n,function(){t.unsuspend=null,clearTimeout(r),clearTimeout(i)}}:null}function zS(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fS(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var US=null;function fS(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,US=new Map,e.forEach(nAe,t),US=null,zS.call(t))}function nAe(t,e){if(!(e.state.loading&4)){var n=US.get(t);if(n)var r=n.get(null);else{n=new Map,US.set(t,n);for(var i=t.querySelectorAll(\"link[data-precedence],style[data-precedence]\"),o=0;o<i.length;o++){var s=i[o];(s.nodeName===\"LINK\"||s.getAttribute(\"media\")!==\"not all\")&&(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}i=e.instance,s=i.getAttribute(\"data-precedence\"),o=n.get(s)||r,o===r&&n.set(null,i),n.set(s,i),this.count++,r=zS.bind(this),i.addEventListener(\"load\",r),i.addEventListener(\"error\",r),o?o.parentNode.insertBefore(i,o.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(i,t.firstChild)),e.state.loading|=4}}var Dv={$$typeof:up,Provider:null,Consumer:null,_currentValue:im,_currentValue2:im,_threadCount:0};function rAe(t,e,n,r,i,o,s,c,d){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=KB(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=KB(0),this.hiddenUpdates=KB(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=d,this.incompleteTransitions=new Map}function _X(t,e,n,r,i,o,s,c,d,m,b,C){return t=new rAe(t,e,n,s,d,m,b,C,c),e=1,o===!0&&(e|=24),o=jc(3,null,null,e),t.current=o,o.stateNode=t,e=ND(),e.refCount++,t.pooledCache=e,e.refCount++,o.memoizedState={element:r,isDehydrated:n,cache:e},VD(o),t}function yX(t){return t?(t=R1,t):R1}function xX(t,e,n,r,i,o){i=yX(i),r.context===null?r.context=i:r.pendingContext=i,r=iA(e),r.payload={element:n},o=o===void 0?null:o,o!==null&&(r.callback=o),n=oA(t,r,e),n!==null&&(gc(n,t,e),dv(n,t,e))}function DH(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function dL(t,e){DH(t,e),(t=t.alternate)&&DH(t,e)}function vX(t){if(t.tag===13||t.tag===31){var e=mm(t,67108864);e!==null&&gc(e,t,67108864),dL(t,67108864)}}function LH(t){if(t.tag===13||t.tag===31){var e=Qc();e=TD(e);var n=mm(t,e);n!==null&&gc(n,t,e),dL(t,e)}}var VS=!0;function iAe(t,e,n,r){var i=ar.T;ar.T=null;var o=Si.p;try{Si.p=2,pL(t,e,n,r)}finally{Si.p=o,ar.T=i}}function oAe(t,e,n,r){var i=ar.T;ar.T=null;var o=Si.p;try{Si.p=8,pL(t,e,n,r)}finally{Si.p=o,ar.T=i}}function pL(t,e,n,r){if(VS){var i=yD(r);if(i===null)w6(t,e,r,GS,n),OH(t,r);else if(aAe(i,t,e,n,r))r.stopPropagation();else if(OH(t,r),e&4&&-1<sAe.indexOf(t)){for(;i!==null;){var o=ey(i);if(o!==null)switch(o.tag){case 3:if(o=o.stateNode,o.current.memoizedState.isDehydrated){var s=tm(o.pendingLanes);if(s!==0){var c=o;for(c.pendingLanes|=2,c.entangledLanes|=2;s;){var d=1<<31-qc(s);c.entanglements[1]|=d,s&=~d}Vf(o),(Ei&6)===0&&(RS=Yc()+500,jv(0,!1))}}break;case 31:case 13:c=mm(o,2),c!==null&&gc(c,o,2),tC(),dL(o,2)}if(o=yD(r),o===null&&w6(t,e,r,GS,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else w6(t,e,r,null,n)}}function yD(t){return t=MD(t),AL(t)}var GS=null;function AL(t){if(GS=null,t=E1(t),t!==null){var e=Fv(t);if(e===null)t=null;else{var n=e.tag;if(n===13){if(t=VH(e),t!==null)return t;t=null}else if(n===31){if(t=GH(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return GS=t,null}function bX(t){switch(t){case\"beforetoggle\":case\"cancel\":case\"click\":case\"close\":case\"contextmenu\":case\"copy\":case\"cut\":case\"auxclick\":case\"dblclick\":case\"dragend\":case\"dragstart\":case\"drop\":case\"focusin\":case\"focusout\":case\"input\":case\"invalid\":case\"keydown\":case\"keypress\":case\"keyup\":case\"mousedown\":case\"mouseup\":case\"paste\":case\"pause\":case\"play\":case\"pointercancel\":case\"pointerdown\":case\"pointerup\":case\"ratechange\":case\"reset\":case\"resize\":case\"seeked\":case\"submit\":case\"toggle\":case\"touchcancel\":case\"touchend\":case\"touchstart\":case\"volumechange\":case\"change\":case\"selectionchange\":case\"textInput\":case\"compositionstart\":case\"compositionend\":case\"compositionupdate\":case\"beforeblur\":case\"afterblur\":case\"beforeinput\":case\"blur\":case\"fullscreenchange\":case\"focus\":case\"hashchange\":case\"popstate\":case\"select\":case\"selectstart\":return 2;case\"drag\":case\"dragenter\":case\"dragexit\":case\"dragleave\":case\"dragover\":case\"mousemove\":case\"mouseout\":case\"mouseover\":case\"pointermove\":case\"pointerout\":case\"pointerover\":case\"scroll\":case\"touchmove\":case\"wheel\":case\"mouseenter\":case\"mouseleave\":case\"pointerenter\":case\"pointerleave\":return 8;case\"message\":switch(Yde()){case XH:return 2;case YH:return 8;case mS:case Zde:return 32;case ZH:return 268435456;default:return 32}default:return 32}}var xD=!1,lA=null,cA=null,uA=null,Lv=new Map,Ov=new Map,Q0=[],sAe=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset\".split(\" \");function OH(t,e){switch(t){case\"focusin\":case\"focusout\":lA=null;break;case\"dragenter\":case\"dragleave\":cA=null;break;case\"mouseover\":case\"mouseout\":uA=null;break;case\"pointerover\":case\"pointerout\":Lv.delete(e.pointerId);break;case\"gotpointercapture\":case\"lostpointercapture\":Ov.delete(e.pointerId)}}function nv(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=ey(e),e!==null&&vX(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function aAe(t,e,n,r,i){switch(e){case\"focusin\":return lA=nv(lA,t,e,n,r,i),!0;case\"dragenter\":return cA=nv(cA,t,e,n,r,i),!0;case\"mouseover\":return uA=nv(uA,t,e,n,r,i),!0;case\"pointerover\":var o=i.pointerId;return Lv.set(o,nv(Lv.get(o)||null,t,e,n,r,i)),!0;case\"gotpointercapture\":return o=i.pointerId,Ov.set(o,nv(Ov.get(o)||null,t,e,n,r,i)),!0}return!1}function wX(t){var e=E1(t.target);if(e!==null){var n=Fv(e);if(n!==null){if(e=n.tag,e===13){if(e=VH(n),e!==null){t.blockedOn=e,_G(t.priority,function(){LH(n)});return}}else if(e===31){if(e=GH(n),e!==null){t.blockedOn=e,_G(t.priority,function(){LH(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function dS(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=yD(t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);N6=r,n.target.dispatchEvent(r),N6=null}else return e=ey(n),e!==null&&vX(e),t.blockedOn=n,!1;e.shift()}return!0}function FH(t,e,n){dS(t)&&n.delete(e)}function lAe(){xD=!1,lA!==null&&dS(lA)&&(lA=null),cA!==null&&dS(cA)&&(cA=null),uA!==null&&dS(uA)&&(uA=null),Lv.forEach(FH),Ov.forEach(FH)}function KE(t,e){t.blockedOn===e&&(t.blockedOn=null,xD||(xD=!0,$s.unstable_scheduleCallback($s.unstable_NormalPriority,lAe)))}var JE=null;function kH(t){JE!==t&&(JE=t,$s.unstable_scheduleCallback($s.unstable_NormalPriority,function(){JE===t&&(JE=null);for(var e=0;e<t.length;e+=3){var n=t[e],r=t[e+1],i=t[e+2];if(typeof r!=\"function\"){if(AL(r||n)===null)continue;break}var o=ey(n);o!==null&&(t.splice(e,3),e-=3,eD(o,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function J1(t){function e(d){return KE(d,t)}lA!==null&&KE(lA,t),cA!==null&&KE(cA,t),uA!==null&&KE(uA,t),Lv.forEach(e),Ov.forEach(e);for(var n=0;n<Q0.length;n++){var r=Q0[n];r.blockedOn===t&&(r.blockedOn=null)}for(;0<Q0.length&&(n=Q0[0],n.blockedOn===null);)wX(n),n.blockedOn===null&&Q0.shift();if(n=(t.ownerDocument||t).$$reactFormReplay,n!=null)for(r=0;r<n.length;r+=3){var i=n[r],o=n[r+1],s=i[mc]||null;if(typeof o==\"function\")s||kH(n);else if(s){var c=null;if(o&&o.hasAttribute(\"formAction\")){if(i=o,s=o[mc]||null)c=s.formAction;else if(AL(i)!==null)continue}else c=s.action;typeof c==\"function\"?n[r+1]=c:(n.splice(r,3),r-=3),kH(n)}}}function TX(){function t(o){o.canIntercept&&o.info===\"react-transition\"&&o.intercept({handler:function(){return new Promise(function(s){return i=s})},focusReset:\"manual\",scroll:\"manual\"})}function e(){i!==null&&(i(),i=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var o=navigation.currentEntry;o&&o.url!=null&&navigation.navigate(o.url,{state:o.getState(),info:\"react-transition\",history:\"replace\"})}}if(typeof navigation==\"object\"){var r=!1,i=null;return navigation.addEventListener(\"navigate\",t),navigation.addEventListener(\"navigatesuccess\",e),navigation.addEventListener(\"navigateerror\",e),setTimeout(n,100),function(){r=!0,navigation.removeEventListener(\"navigate\",t),navigation.removeEventListener(\"navigatesuccess\",e),navigation.removeEventListener(\"navigateerror\",e),i!==null&&(i(),i=null)}}}function gL(t){this._internalRoot=t}iC.prototype.render=gL.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ht(409));var n=e.current,r=Qc();xX(n,r,t,e,null,null)};iC.prototype.unmount=gL.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;xX(t.current,2,null,t,null,null),tC(),e[$1]=null}};function iC(t){this._internalRoot=t}iC.prototype.unstable_scheduleHydration=function(t){if(t){var e=$H();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Q0.length&&e!==0&&e<Q0[n].priority;n++);Q0.splice(n,0,t),n===0&&wX(t)}};var NH=zH.version;if(NH!==\"19.2.4\")throw Error(Ht(527,NH,\"19.2.4\"));Si.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render==\"function\"?Error(Ht(188)):(t=Object.keys(t).join(\",\"),Error(Ht(268,t)));return t=Ude(e),t=t!==null?HH(t):null,t=t===null?null:t.stateNode,t};var cAe={bundleType:0,version:\"19.2.4\",rendererPackageName:\"react-dom\",currentDispatcherRef:ar,reconcilerVersion:\"19.2.4\"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<\"u\"&&(rv=__REACT_DEVTOOLS_GLOBAL_HOOK__,!rv.isDisabled&&rv.supportsFiber))try{kv=rv.inject(cAe),Zc=rv}catch{}var rv;oC.createRoot=function(t,e){if(!UH(t))throw Error(Ht(299));var n=!1,r=\"\",i=Aj,o=gj,s=mj;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onUncaughtError!==void 0&&(i=e.onUncaughtError),e.onCaughtError!==void 0&&(o=e.onCaughtError),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=_X(t,1,!1,null,null,n,r,null,i,o,s,TX),t[$1]=e.current,uL(t),new gL(e)};oC.hydrateRoot=function(t,e,n){if(!UH(t))throw Error(Ht(299));var r=!1,i=\"\",o=Aj,s=gj,c=mj,d=null;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onUncaughtError!==void 0&&(o=n.onUncaughtError),n.onCaughtError!==void 0&&(s=n.onCaughtError),n.onRecoverableError!==void 0&&(c=n.onRecoverableError),n.formState!==void 0&&(d=n.formState)),e=_X(t,1,!0,e,n??null,r,i,d,o,s,c,TX),e.context=yX(null),n=e.current,r=Qc(),r=TD(r),i=iA(r),i.callback=null,oA(n,i,r),n=r,e.current.lanes=n,zv(e,n),Vf(e),t[$1]=e.current,uL(t),new iC(e)};oC.version=\"19.2.4\"});var MX=Fs((jLe,CX)=>{\"use strict\";function SX(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>\"u\"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=\"function\"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(SX)}catch(t){console.error(t)}}SX(),CX.exports=EX()});var UX=Fs((TL,EL)=>{(function(t,e){typeof TL==\"object\"&&typeof EL<\"u\"?EL.exports=e():(t=typeof globalThis<\"u\"?globalThis:t||self,t.maplibregl=e())})(TL,(function(){\"use strict\";var t={},e={};function n(i,o,s){if(e[i]=s,i===\"index\"){var c=\"var sharedModule = {}; (\"+e.shared+\")(sharedModule); (\"+e.worker+\")(sharedModule);\",d={};return e.shared(d),e.index(t,d),typeof window<\"u\"&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([c],{type:\"text/javascript\"}))),t}}n(\"shared\",[\"exports\"],(function(i){\"use strict\";function o(h,a,u,p){return new(u||(u=Promise))((function(v,E){function S(U){try{F(p.next(U))}catch(H){E(H)}}function R(U){try{F(p.throw(U))}catch(H){E(H)}}function F(U){var H;U.done?v(U.value):(H=U.value,H instanceof u?H:new u((function(X){X(H)}))).then(S,R)}F((p=p.apply(h,a||[])).next())}))}function s(h,a){this.x=h,this.y=a}function c(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,\"default\")?h.default:h}var d,m;typeof SuppressedError==\"function\"&&SuppressedError,s.prototype={clone(){return new s(this.x,this.y)},add(h){return this.clone()._add(h)},sub(h){return this.clone()._sub(h)},multByPoint(h){return this.clone()._multByPoint(h)},divByPoint(h){return this.clone()._divByPoint(h)},mult(h){return this.clone()._mult(h)},div(h){return this.clone()._div(h)},rotate(h){return this.clone()._rotate(h)},rotateAround(h,a){return this.clone()._rotateAround(h,a)},matMult(h){return this.clone()._matMult(h)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(h){return this.x===h.x&&this.y===h.y},dist(h){return Math.sqrt(this.distSqr(h))},distSqr(h){let a=h.x-this.x,u=h.y-this.y;return a*a+u*u},angle(){return Math.atan2(this.y,this.x)},angleTo(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith(h){return this.angleWithSep(h.x,h.y)},angleWithSep(h,a){return Math.atan2(this.x*a-this.y*h,this.x*h+this.y*a)},_matMult(h){let a=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=a,this},_add(h){return this.x+=h.x,this.y+=h.y,this},_sub(h){return this.x-=h.x,this.y-=h.y,this},_mult(h){return this.x*=h,this.y*=h,this},_div(h){return this.x/=h,this.y/=h,this},_multByPoint(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint(h){return this.x/=h.x,this.y/=h.y,this},_unit(){return this._div(this.mag()),this},_perp(){let h=this.y;return this.y=this.x,this.x=-h,this},_rotate(h){let a=Math.cos(h),u=Math.sin(h),p=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=p,this},_rotateAround(h,a){let u=Math.cos(h),p=Math.sin(h),v=a.y+p*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-p*(this.y-a.y),this.y=v,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:s},s.convert=function(h){if(h instanceof s)return h;if(Array.isArray(h))return new s(+h[0],+h[1]);if(h.x!==void 0&&h.y!==void 0)return new s(+h.x,+h.y);throw new Error(\"Expected [x, y] or {x, y} point format\")};var b=(function(){if(m)return d;function h(a,u,p,v){this.cx=3*a,this.bx=3*(p-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(v-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=u,this.p2x=p,this.p2y=v}return m=1,d=h,h.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,u){if(u===void 0&&(u=1e-6),a<0)return 0;if(a>1)return 1;for(var p=a,v=0;v<8;v++){var E=this.sampleCurveX(p)-a;if(Math.abs(E)<u)return p;var S=this.sampleCurveDerivativeX(p);if(Math.abs(S)<1e-6)break;p-=E/S}var R=0,F=1;for(p=a,v=0;v<20&&(E=this.sampleCurveX(p),!(Math.abs(E-a)<u));v++)a>E?R=p:F=p,p=.5*(F-R)+R;return p},solve:function(a,u){return this.sampleCurveY(this.solveCurveX(a,u))}},d})(),C=c(b);let B,k;function V(){return B==null&&(B=typeof OffscreenCanvas<\"u\"&&new OffscreenCanvas(1,1).getContext(\"2d\")&&typeof createImageBitmap==\"function\"),B}function q(){if(k==null&&(k=!1,V())){let a=new OffscreenCanvas(5,5).getContext(\"2d\",{willReadFrequently:!0});if(a){for(let p=0;p<25;p++){let v=4*p;a.fillStyle=`rgb(${v},${v+1},${v+2})`,a.fillRect(p%5,Math.floor(p/5),1,1)}let u=a.getImageData(0,0,5,5).data;for(let p=0;p<100;p++)if(p%4!=3&&u[p]!==p){k=!0;break}}}return k||!1}var K=1e-6,Y=typeof Float32Array<\"u\"?Float32Array:Array;function ee(){var h=new Y(9);return Y!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h}function J(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function se(){var h=new Y(3);return Y!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h}function xe(h){var a=h[0],u=h[1],p=h[2];return Math.sqrt(a*a+u*u+p*p)}function Ee(h,a,u){var p=new Y(3);return p[0]=h,p[1]=a,p[2]=u,p}function Xe(h,a,u){return h[0]=a[0]+u[0],h[1]=a[1]+u[1],h[2]=a[2]+u[2],h}function Ne(h,a,u){return h[0]=a[0]*u,h[1]=a[1]*u,h[2]=a[2]*u,h}function be(h,a,u){var p=a[0],v=a[1],E=a[2],S=u[0],R=u[1],F=u[2];return h[0]=v*F-E*R,h[1]=E*S-p*F,h[2]=p*R-v*S,h}var ge,Qe=xe;function Ct(h,a,u){var p=a[0],v=a[1],E=a[2],S=a[3];return h[0]=u[0]*p+u[4]*v+u[8]*E+u[12]*S,h[1]=u[1]*p+u[5]*v+u[9]*E+u[13]*S,h[2]=u[2]*p+u[6]*v+u[10]*E+u[14]*S,h[3]=u[3]*p+u[7]*v+u[11]*E+u[15]*S,h}function Mt(){var h=new Y(4);return Y!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h[3]=1,h}function mt(h,a,u,p){var v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:\"zyx\",E=Math.PI/360;a*=E,p*=E,u*=E;var S=Math.sin(a),R=Math.cos(a),F=Math.sin(u),U=Math.cos(u),H=Math.sin(p),X=Math.cos(p);switch(v){case\"xyz\":h[0]=S*U*X+R*F*H,h[1]=R*F*X-S*U*H,h[2]=R*U*H+S*F*X,h[3]=R*U*X-S*F*H;break;case\"xzy\":h[0]=S*U*X-R*F*H,h[1]=R*F*X-S*U*H,h[2]=R*U*H+S*F*X,h[3]=R*U*X+S*F*H;break;case\"yxz\":h[0]=S*U*X+R*F*H,h[1]=R*F*X-S*U*H,h[2]=R*U*H-S*F*X,h[3]=R*U*X+S*F*H;break;case\"yzx\":h[0]=S*U*X+R*F*H,h[1]=R*F*X+S*U*H,h[2]=R*U*H-S*F*X,h[3]=R*U*X-S*F*H;break;case\"zxy\":h[0]=S*U*X-R*F*H,h[1]=R*F*X+S*U*H,h[2]=R*U*H+S*F*X,h[3]=R*U*X-S*F*H;break;case\"zyx\":h[0]=S*U*X-R*F*H,h[1]=R*F*X+S*U*H,h[2]=R*U*H-S*F*X,h[3]=R*U*X+S*F*H;break;default:throw new Error(\"Unknown angle order \"+v)}return h}function jt(){var h=new Y(2);return Y!=Float32Array&&(h[0]=0,h[1]=0),h}function Mn(h,a){var u=new Y(2);return u[0]=h,u[1]=a,u}se(),ge=new Y(4),Y!=Float32Array&&(ge[0]=0,ge[1]=0,ge[2]=0,ge[3]=0),se(),Ee(1,0,0),Ee(0,1,0),Mt(),Mt(),ee(),jt();let rn=8192;function In(h,a,u){return a*(rn/(h.tileSize*Math.pow(2,u-h.tileID.overscaledZ)))}function On(h,a){return(h%a+a)%a}function Pn(h,a,u){return h*(1-u)+a*u}function _n(h){if(h<=0)return 0;if(h>=1)return 1;let a=h*h,u=a*h;return 4*(h<.5?u:3*(h-a)+u-.75)}function tr(h,a,u,p){let v=new C(h,a,u,p);return E=>v.solve(E)}let on=tr(.25,.1,.25,1);function Pt(h,a,u){return Math.min(u,Math.max(a,h))}function Mr(h,a,u){let p=u-a,v=((h-a)%p+p)%p+a;return v===a?u:v}function Fn(h,...a){for(let u of a)for(let p in u)h[p]=u[p];return h}let Br=1;function nr(h,a,u){let p={};for(let v in h)p[v]=a.call(this,h[v],v,h);return p}function lo(h,a,u){let p={};for(let v in h)a.call(this,h[v],v,h)&&(p[v]=h[v]);return p}function oi(h){return Array.isArray(h)?h.map(oi):typeof h==\"object\"&&h?nr(h,oi):h}let cs={};function yi(h){cs[h]||(typeof console<\"u\"&&console.warn(h),cs[h]=!0)}function Ro(h,a,u){return(u.y-h.y)*(a.x-h.x)>(a.y-h.y)*(u.x-h.x)}function co(h){return typeof WorkerGlobalScope<\"u\"&&h!==void 0&&h instanceof WorkerGlobalScope}let mr=null;function Yr(h){return typeof ImageBitmap<\"u\"&&h instanceof ImageBitmap}let Xs=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=\";function Ys(h,a,u,p,v){return o(this,void 0,void 0,(function*(){if(typeof VideoFrame>\"u\")throw new Error(\"VideoFrame not supported\");let E=new VideoFrame(h,{timestamp:0});try{let S=E?.format;if(!S||!S.startsWith(\"BGR\")&&!S.startsWith(\"RGB\"))throw new Error(`Unrecognized format ${S}`);let R=S.startsWith(\"BGR\"),F=new Uint8ClampedArray(p*v*4);if(yield E.copyTo(F,(function(U,H,X,$,te){let oe=4*Math.max(-H,0),le=(Math.max(0,X)-X)*$*4+oe,ue=4*$,me=Math.max(0,H),Le=Math.max(0,X);return{rect:{x:me,y:Le,width:Math.min(U.width,H+$)-me,height:Math.min(U.height,X+te)-Le},layout:[{offset:le,stride:ue}]}})(h,a,u,p,v)),R)for(let U=0;U<F.length;U+=4){let H=F[U];F[U]=F[U+2],F[U+2]=H}return F}finally{E.close()}}))}let Hi,us;function Zr(h,a,u,p){return h.addEventListener(a,u,p),{unsubscribe:()=>{h.removeEventListener(a,u,p)}}}function Oi(h){return h*Math.PI/180}function Fr(h){return h/Math.PI*180}let eo={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},$t={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},en=\"AbortError\";class Sn extends Error{constructor(a=en){super(a instanceof Error?a.message:a),this.name=en,a instanceof Error&&a.stack&&(this.stack=a.stack)}}function Ze(h){return h.name===en}let ae={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:\"\"};function he(h){return ae.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf(\"://\"))]}let pe=\"global-dispatcher\";class ze extends Error{constructor(a,u,p,v){super(`AJAXError: ${u} (${a}): ${p}`),this.status=a,this.statusText=u,this.url=p,this.body=v}}let He=()=>co(self)?self.worker&&self.worker.referrer:(window.location.protocol===\"blob:\"?window.parent:window).location.href,ot=function(h,a){if(/:\\/\\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){let p=he(h.url);if(p)return p(h,a);if(co(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:\"GR\",data:h,targetMapId:pe},a)}if(!(/^file:/.test(u=h.url)||/^file:/.test(He())&&!/^\\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,\"signal\"))return(function(p,v){return o(this,void 0,void 0,(function*(){let E=new Request(p.url,{method:p.method||\"GET\",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:He(),signal:v.signal}),S,R;p.type!==\"json\"||E.headers.has(\"Accept\")||E.headers.set(\"Accept\",\"application/json\");try{S=yield fetch(E)}catch(U){throw Ze(U)?U:new ze(0,U.message,p.url,new Blob)}if(!S.ok){let U=yield S.blob();throw new ze(S.status,S.statusText,p.url,U)}R=p.type===\"arrayBuffer\"||p.type===\"image\"?S.arrayBuffer():p.type===\"json\"?S.json():S.text();let F=yield R;return v.signal.throwIfAborted(),{data:F,cacheControl:S.headers.get(\"Cache-Control\"),expires:S.headers.get(\"Expires\")}}))})(h,a);if(co(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:\"GR\",data:h,mustQueue:!0,targetMapId:pe},a)}var u;return(function(p,v){return new Promise(((E,S)=>{var R;let F=new XMLHttpRequest;F.open(p.method||\"GET\",p.url,!0),p.type!==\"arrayBuffer\"&&p.type!==\"image\"||(F.responseType=\"arraybuffer\");for(let U in p.headers)F.setRequestHeader(U,p.headers[U]);p.type===\"json\"&&(F.responseType=\"text\",!((R=p.headers)===null||R===void 0)&&R.Accept||F.setRequestHeader(\"Accept\",\"application/json\")),F.withCredentials=p.credentials===\"include\",F.onerror=()=>{S(new Error(F.statusText))},F.onload=()=>{if(!v.signal.aborted)if((F.status>=200&&F.status<300||F.status===0)&&F.response!==null){let U=F.response;if(p.type===\"json\")try{U=JSON.parse(F.response)}catch(H){return void S(H)}E({data:U,cacheControl:F.getResponseHeader(\"Cache-Control\"),expires:F.getResponseHeader(\"Expires\")})}else{let U=new Blob([F.response],{type:F.getResponseHeader(\"Content-Type\")});S(new ze(F.status,F.statusText,p.url,U))}},v.signal.addEventListener(\"abort\",(()=>{F.abort(),S(new Sn(v.signal.reason))})),F.send(p.body)}))})(h,a)};function tt(h){if(!h||h.indexOf(\"://\")<=0||h.indexOf(\"data:image/\")===0||h.indexOf(\"blob:\")===0)return!0;let a=new URL(h),u=window.location;return a.protocol===u.protocol&&a.host===u.host}function Je(h,a,u){u[h]&&u[h].indexOf(a)!==-1||(u[h]=u[h]||[],u[h].push(a))}function nt(h,a,u){if(u&&u[h]){let p=u[h].indexOf(a);p!==-1&&u[h].splice(p,1)}}class Dt{constructor(a,u={}){Fn(this,u),this.type=a}}class vt extends Dt{constructor(a,u={}){super(\"error\",Fn({error:a},u))}}class Vt{on(a,u){return this._listeners=this._listeners||{},Je(a,u,this._listeners),{unsubscribe:()=>{this.off(a,u)}}}off(a,u){return nt(a,u,this._listeners),nt(a,u,this._oneTimeListeners),this}once(a,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},Je(a,u,this._oneTimeListeners),this):new Promise((p=>this.once(a,p)))}fire(a,u){typeof a==\"string\"&&(a=new Dt(a,u||{}));let p=a.type;if(this.listens(p)){a.target=this;let v=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(let R of v)R.call(this,a);let E=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(let R of E)nt(p,R,this._oneTimeListeners),R.call(this,a);let S=this._eventedParent;S&&(Fn(a,typeof this._eventedParentData==\"function\"?this._eventedParentData():this._eventedParentData),S.fire(a))}else a instanceof vt&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,u){return this._eventedParent=a,this._eventedParentData=u,this}}var Ke={$version:8,$root:{version:{required:!0,type:\"enum\",values:[8]},name:{type:\"string\"},metadata:{type:\"*\"},center:{type:\"array\",value:\"number\",length:2},centerAltitude:{type:\"number\"},zoom:{type:\"number\"},bearing:{type:\"number\",default:0,period:360,units:\"degrees\"},pitch:{type:\"number\",default:0,units:\"degrees\"},roll:{type:\"number\",default:0,units:\"degrees\"},state:{type:\"state\",default:{}},light:{type:\"light\"},sky:{type:\"sky\"},projection:{type:\"projection\"},terrain:{type:\"terrain\"},sources:{required:!0,type:\"sources\"},sprite:{type:\"sprite\"},glyphs:{type:\"string\"},\"font-faces\":{type:\"fontFaces\"},transition:{type:\"transition\"},layers:{required:!0,type:\"array\",value:\"layer\"}},sources:{\"*\":{type:\"source\"}},source:[\"source_vector\",\"source_raster\",\"source_raster_dem\",\"source_geojson\",\"source_video\",\"source_image\"],source_vector:{type:{required:!0,type:\"enum\",values:{vector:{}}},url:{type:\"string\"},tiles:{type:\"array\",value:\"string\"},bounds:{type:\"array\",value:\"number\",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:\"enum\",values:{xyz:{},tms:{}},default:\"xyz\"},minzoom:{type:\"number\",default:0},maxzoom:{type:\"number\",default:22},attribution:{type:\"string\"},promoteId:{type:\"promoteId\"},volatile:{type:\"boolean\",default:!1},encoding:{type:\"enum\",values:{mvt:{},mlt:{}},default:\"mvt\"},\"*\":{type:\"*\"}},source_raster:{type:{required:!0,type:\"enum\",values:{raster:{}}},url:{type:\"string\"},tiles:{type:\"array\",value:\"string\"},bounds:{type:\"array\",value:\"number\",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:\"number\",default:0},maxzoom:{type:\"number\",default:22},tileSize:{type:\"number\",default:512,units:\"pixels\"},scheme:{type:\"enum\",values:{xyz:{},tms:{}},default:\"xyz\"},attribution:{type:\"string\"},volatile:{type:\"boolean\",default:!1},\"*\":{type:\"*\"}},source_raster_dem:{type:{required:!0,type:\"enum\",values:{\"raster-dem\":{}}},url:{type:\"string\"},tiles:{type:\"array\",value:\"string\"},bounds:{type:\"array\",value:\"number\",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:\"number\",default:0},maxzoom:{type:\"number\",default:22},tileSize:{type:\"number\",default:512,units:\"pixels\"},attribution:{type:\"string\"},encoding:{type:\"enum\",values:{terrarium:{},mapbox:{},custom:{}},default:\"mapbox\"},redFactor:{type:\"number\",default:1},blueFactor:{type:\"number\",default:1},greenFactor:{type:\"number\",default:1},baseShift:{type:\"number\",default:0},volatile:{type:\"boolean\",default:!1},\"*\":{type:\"*\"}},source_geojson:{type:{required:!0,type:\"enum\",values:{geojson:{}}},data:{required:!0,type:\"*\"},maxzoom:{type:\"number\",default:18},attribution:{type:\"string\"},buffer:{type:\"number\",default:128,maximum:512,minimum:0},filter:{type:\"filter\"},tolerance:{type:\"number\",default:.375},cluster:{type:\"boolean\",default:!1},clusterRadius:{type:\"number\",default:50,minimum:0},clusterMaxZoom:{type:\"number\"},clusterMinPoints:{type:\"number\"},clusterProperties:{type:\"*\"},lineMetrics:{type:\"boolean\",default:!1},generateId:{type:\"boolean\",default:!1},promoteId:{type:\"promoteId\"}},source_video:{type:{required:!0,type:\"enum\",values:{video:{}}},urls:{required:!0,type:\"array\",value:\"string\"},coordinates:{required:!0,type:\"array\",length:4,value:{type:\"array\",length:2,value:\"number\"}}},source_image:{type:{required:!0,type:\"enum\",values:{image:{}}},url:{required:!0,type:\"string\"},coordinates:{required:!0,type:\"array\",length:4,value:{type:\"array\",length:2,value:\"number\"}}},layer:{id:{type:\"string\",required:!0},type:{type:\"enum\",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},\"fill-extrusion\":{},raster:{},hillshade:{},\"color-relief\":{},background:{}},required:!0},metadata:{type:\"*\"},source:{type:\"string\"},\"source-layer\":{type:\"string\"},minzoom:{type:\"number\",minimum:0,maximum:24},maxzoom:{type:\"number\",minimum:0,maximum:24},filter:{type:\"filter\"},layout:{type:\"layout\"},paint:{type:\"paint\"}},layout:[\"layout_fill\",\"layout_line\",\"layout_circle\",\"layout_heatmap\",\"layout_fill-extrusion\",\"layout_symbol\",\"layout_raster\",\"layout_hillshade\",\"layout_color-relief\",\"layout_background\"],layout_background:{visibility:{type:\"enum\",values:{visible:{},none:{}},default:\"visible\",expression:{interpolated:!1,parameters:[\"global-state\"]},\"property-type\":\"data-constant\"}},layout_fill:{\"fill-sort-key\":{type:\"number\",expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},visibility:{type:\"enum\",values:{visible:{},none:{}},default:\"visible\",expression:{interpolated:!1,parameters:[\"global-state\"]},\"property-type\":\"data-constant\"}},layout_circle:{\"circle-sort-key\":{type:\"number\",expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},visibility:{type:\"enum\",values:{visible:{},none:{}},default:\"visible\",expression:{interpolated:!1,parameters:[\"global-state\"]},\"property-type\":\"data-constant\"}},layout_heatmap:{visibility:{type:\"enum\",values:{visible:{},none:{}},default:\"visible\",expression:{interpolated:!1,parameters:[\"global-state\"]},\"property-type\":\"data-constant\"}},\"layout_fill-extrusion\":{visibility:{type:\"enum\",values:{visible:{},none:{}},default:\"visible\",expression:{interpolated:!1,parameters:[\"global-state\"]},\"property-type\":\"data-constant\"}},layout_line:{\"line-cap\":{type:\"enum\",values:{butt:{},round:{},square:{}},default:\"butt\",expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"line-join\":{type:\"enum\",values:{bevel:{},round:{},miter:{}},default:\"miter\",expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"line-miter-limit\":{type:\"number\",default:2,requires:[{\"line-join\":\"miter\"}],expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"line-round-limit\":{type:\"number\",default:1.05,requires:[{\"line-join\":\"round\"}],expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"line-sort-key\":{type:\"number\",expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},visibility:{type:\"enum\",values:{visible:{},none:{}},default:\"visible\",expression:{interpolated:!1,parameters:[\"global-state\"]},\"property-type\":\"data-constant\"}},layout_symbol:{\"symbol-placement\":{type:\"enum\",values:{point:{},line:{},\"line-center\":{}},default:\"point\",expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"symbol-spacing\":{type:\"number\",default:250,minimum:1,units:\"pixels\",requires:[{\"symbol-placement\":\"line\"}],expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"symbol-avoid-edges\":{type:\"boolean\",default:!1,expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"symbol-sort-key\":{type:\"number\",expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"symbol-z-order\":{type:\"enum\",values:{auto:{},\"viewport-y\":{},source:{}},default:\"auto\",expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-allow-overlap\":{type:\"boolean\",default:!1,requires:[\"icon-image\",{\"!\":\"icon-overlap\"}],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-overlap\":{type:\"enum\",values:{never:{},always:{},cooperative:{}},requires:[\"icon-image\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-ignore-placement\":{type:\"boolean\",default:!1,requires:[\"icon-image\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-optional\":{type:\"boolean\",default:!1,requires:[\"icon-image\",\"text-field\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-rotation-alignment\":{type:\"enum\",values:{map:{},viewport:{},auto:{}},default:\"auto\",requires:[\"icon-image\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-size\":{type:\"number\",default:1,minimum:0,units:\"factor of the original icon size\",requires:[\"icon-image\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-text-fit\":{type:\"enum\",values:{none:{},width:{},height:{},both:{}},default:\"none\",requires:[\"icon-image\",\"text-field\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-text-fit-padding\":{type:\"array\",value:\"number\",length:4,default:[0,0,0,0],units:\"pixels\",requires:[\"icon-image\",\"text-field\",{\"icon-text-fit\":[\"both\",\"width\",\"height\"]}],expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-image\":{type:\"resolvedImage\",tokens:!0,expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-rotate\":{type:\"number\",default:0,period:360,units:\"degrees\",requires:[\"icon-image\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-padding\":{type:\"padding\",default:[2],units:\"pixels\",requires:[\"icon-image\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-keep-upright\":{type:\"boolean\",default:!1,requires:[\"icon-image\",{\"icon-rotation-alignment\":\"map\"},{\"symbol-placement\":[\"line\",\"line-center\"]}],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-offset\":{type:\"array\",value:\"number\",length:2,default:[0,0],requires:[\"icon-image\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-anchor\":{type:\"enum\",values:{center:{},left:{},right:{},top:{},bottom:{},\"top-left\":{},\"top-right\":{},\"bottom-left\":{},\"bottom-right\":{}},default:\"center\",requires:[\"icon-image\"],expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-pitch-alignment\":{type:\"enum\",values:{map:{},viewport:{},auto:{}},default:\"auto\",requires:[\"icon-image\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-pitch-alignment\":{type:\"enum\",values:{map:{},viewport:{},auto:{}},default:\"auto\",requires:[\"text-field\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-rotation-alignment\":{type:\"enum\",values:{map:{},viewport:{},\"viewport-glyph\":{},auto:{}},default:\"auto\",requires:[\"text-field\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-field\":{type:\"formatted\",default:\"\",tokens:!0,expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-font\":{type:\"array\",value:\"string\",default:[\"Open Sans Regular\",\"Arial Unicode MS Regular\"],requires:[\"text-field\"],expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-size\":{type:\"number\",default:16,minimum:0,units:\"pixels\",requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-max-width\":{type:\"number\",default:10,minimum:0,units:\"ems\",requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-line-height\":{type:\"number\",default:1.2,units:\"ems\",requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-letter-spacing\":{type:\"number\",default:0,units:\"ems\",requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-justify\":{type:\"enum\",values:{auto:{},left:{},center:{},right:{}},default:\"center\",requires:[\"text-field\"],expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-radial-offset\":{type:\"number\",units:\"ems\",default:0,requires:[\"text-field\"],\"property-type\":\"data-driven\",expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]}},\"text-variable-anchor\":{type:\"array\",value:\"enum\",values:{center:{},left:{},right:{},top:{},bottom:{},\"top-left\":{},\"top-right\":{},\"bottom-left\":{},\"bottom-right\":{}},requires:[\"text-field\",{\"symbol-placement\":[\"point\"]}],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-variable-anchor-offset\":{type:\"variableAnchorOffsetCollection\",requires:[\"text-field\",{\"symbol-placement\":[\"point\"]}],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-anchor\":{type:\"enum\",values:{center:{},left:{},right:{},top:{},bottom:{},\"top-left\":{},\"top-right\":{},\"bottom-left\":{},\"bottom-right\":{}},default:\"center\",requires:[\"text-field\",{\"!\":\"text-variable-anchor\"}],expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-max-angle\":{type:\"number\",default:45,units:\"degrees\",requires:[\"text-field\",{\"symbol-placement\":[\"line\",\"line-center\"]}],expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-writing-mode\":{type:\"array\",value:\"enum\",values:{horizontal:{},vertical:{}},requires:[\"text-field\",{\"symbol-placement\":[\"point\"]}],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-rotate\":{type:\"number\",default:0,period:360,units:\"degrees\",requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-padding\":{type:\"number\",default:2,minimum:0,units:\"pixels\",requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-keep-upright\":{type:\"boolean\",default:!0,requires:[\"text-field\",{\"text-rotation-alignment\":\"map\"},{\"symbol-placement\":[\"line\",\"line-center\"]}],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-transform\":{type:\"enum\",values:{none:{},uppercase:{},lowercase:{}},default:\"none\",requires:[\"text-field\"],expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-offset\":{type:\"array\",value:\"number\",units:\"ems\",length:2,default:[0,0],requires:[\"text-field\",{\"!\":\"text-radial-offset\"}],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-allow-overlap\":{type:\"boolean\",default:!1,requires:[\"text-field\",{\"!\":\"text-overlap\"}],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-overlap\":{type:\"enum\",values:{never:{},always:{},cooperative:{}},requires:[\"text-field\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-ignore-placement\":{type:\"boolean\",default:!1,requires:[\"text-field\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-optional\":{type:\"boolean\",default:!1,requires:[\"text-field\",\"icon-image\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},visibility:{type:\"enum\",values:{visible:{},none:{}},default:\"visible\",expression:{interpolated:!1,parameters:[\"global-state\"]},\"property-type\":\"data-constant\"}},layout_raster:{visibility:{type:\"enum\",values:{visible:{},none:{}},default:\"visible\",expression:{interpolated:!1,parameters:[\"global-state\"]},\"property-type\":\"data-constant\"}},layout_hillshade:{visibility:{type:\"enum\",values:{visible:{},none:{}},default:\"visible\",expression:{interpolated:!1,parameters:[\"global-state\"]},\"property-type\":\"data-constant\"}},\"layout_color-relief\":{visibility:{type:\"enum\",values:{visible:{},none:{}},default:\"visible\",expression:{interpolated:!1,parameters:[\"global-state\"]},\"property-type\":\"data-constant\"}},filter:{type:\"boolean\",expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},filter_operator:{type:\"enum\",values:{\"==\":{},\"!=\":{},\">\":{},\">=\":{},\"<\":{},\"<=\":{},in:{},\"!in\":{},all:{},any:{},none:{},has:{},\"!has\":{}}},geometry_type:{type:\"enum\",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:\"expression\"},stops:{type:\"array\",value:\"function_stop\"},base:{type:\"number\",default:1,minimum:0},property:{type:\"string\",default:\"$zoom\"},type:{type:\"enum\",values:{identity:{},exponential:{},interval:{},categorical:{}},default:\"exponential\"},colorSpace:{type:\"enum\",values:{rgb:{},lab:{},hcl:{}},default:\"rgb\"},default:{type:\"*\",required:!1}},function_stop:{type:\"array\",minimum:0,maximum:24,value:[\"number\",\"color\"],length:2},expression:{type:\"array\",value:\"expression_name\",minimum:1},light:{anchor:{type:\"enum\",default:\"viewport\",values:{map:{},viewport:{}},\"property-type\":\"data-constant\",transition:!1,expression:{interpolated:!1,parameters:[\"zoom\"]}},position:{type:\"array\",default:[1.15,210,30],length:3,value:\"number\",\"property-type\":\"data-constant\",transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]}},color:{type:\"color\",\"property-type\":\"data-constant\",default:\"#ffffff\",expression:{interpolated:!0,parameters:[\"zoom\"]},transition:!0},intensity:{type:\"number\",\"property-type\":\"data-constant\",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:[\"zoom\"]},transition:!0}},sky:{\"sky-color\":{type:\"color\",\"property-type\":\"data-constant\",default:\"#88C6FC\",expression:{interpolated:!0,parameters:[\"zoom\"]},transition:!0},\"horizon-color\":{type:\"color\",\"property-type\":\"data-constant\",default:\"#ffffff\",expression:{interpolated:!0,parameters:[\"zoom\"]},transition:!0},\"fog-color\":{type:\"color\",\"property-type\":\"data-constant\",default:\"#ffffff\",expression:{interpolated:!0,parameters:[\"zoom\"]},transition:!0},\"fog-ground-blend\":{type:\"number\",\"property-type\":\"data-constant\",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:[\"zoom\"]},transition:!0},\"horizon-fog-blend\":{type:\"number\",\"property-type\":\"data-constant\",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:[\"zoom\"]},transition:!0},\"sky-horizon-blend\":{type:\"number\",\"property-type\":\"data-constant\",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:[\"zoom\"]},transition:!0},\"atmosphere-blend\":{type:\"number\",\"property-type\":\"data-constant\",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:[\"zoom\"]},transition:!0}},terrain:{source:{type:\"string\",required:!0},exaggeration:{type:\"number\",minimum:0,default:1}},projection:{type:{type:\"projectionDefinition\",default:\"mercator\",\"property-type\":\"data-constant\",transition:!1,expression:{interpolated:!0,parameters:[\"zoom\"]}}},paint:[\"paint_fill\",\"paint_line\",\"paint_circle\",\"paint_heatmap\",\"paint_fill-extrusion\",\"paint_symbol\",\"paint_raster\",\"paint_hillshade\",\"paint_color-relief\",\"paint_background\"],paint_fill:{\"fill-antialias\":{type:\"boolean\",default:!0,expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-color\":{type:\"color\",default:\"#000000\",transition:!0,requires:[{\"!\":\"fill-pattern\"}],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-outline-color\":{type:\"color\",transition:!0,requires:[{\"!\":\"fill-pattern\"},{\"fill-antialias\":!0}],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-translate\":{type:\"array\",value:\"number\",length:2,default:[0,0],transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-translate-anchor\":{type:\"enum\",values:{map:{},viewport:{}},default:\"map\",requires:[\"fill-translate\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-pattern\":{type:\"resolvedImage\",transition:!0,expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"cross-faded-data-driven\"}},\"paint_fill-extrusion\":{\"fill-extrusion-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-extrusion-color\":{type:\"color\",default:\"#000000\",transition:!0,requires:[{\"!\":\"fill-extrusion-pattern\"}],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-extrusion-translate\":{type:\"array\",value:\"number\",length:2,default:[0,0],transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-extrusion-translate-anchor\":{type:\"enum\",values:{map:{},viewport:{}},default:\"map\",requires:[\"fill-extrusion-translate\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-extrusion-pattern\":{type:\"resolvedImage\",transition:!0,expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"cross-faded-data-driven\"},\"fill-extrusion-height\":{type:\"number\",default:0,minimum:0,units:\"meters\",transition:!0,expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-extrusion-base\":{type:\"number\",default:0,minimum:0,units:\"meters\",transition:!0,requires:[\"fill-extrusion-height\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-extrusion-vertical-gradient\":{type:\"boolean\",default:!0,transition:!1,expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"}},paint_line:{\"line-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-color\":{type:\"color\",default:\"#000000\",transition:!0,requires:[{\"!\":\"line-pattern\"}],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-translate\":{type:\"array\",value:\"number\",length:2,default:[0,0],transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"line-translate-anchor\":{type:\"enum\",values:{map:{},viewport:{}},default:\"map\",requires:[\"line-translate\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"line-width\":{type:\"number\",default:1,minimum:0,transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-gap-width\":{type:\"number\",default:0,minimum:0,transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-offset\":{type:\"number\",default:0,transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-blur\":{type:\"number\",default:0,minimum:0,transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-dasharray\":{type:\"array\",value:\"number\",minimum:0,transition:!0,units:\"line widths\",requires:[{\"!\":\"line-pattern\"}],expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"cross-faded-data-driven\"},\"line-pattern\":{type:\"resolvedImage\",transition:!0,expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]},\"property-type\":\"cross-faded-data-driven\"},\"line-gradient\":{type:\"color\",transition:!1,requires:[{\"!\":\"line-dasharray\"},{\"!\":\"line-pattern\"},{source:\"geojson\",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:[\"line-progress\"]},\"property-type\":\"color-ramp\"}},paint_circle:{\"circle-radius\":{type:\"number\",default:5,minimum:0,transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-color\":{type:\"color\",default:\"#000000\",transition:!0,expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-blur\":{type:\"number\",default:0,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-translate\":{type:\"array\",value:\"number\",length:2,default:[0,0],transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"circle-translate-anchor\":{type:\"enum\",values:{map:{},viewport:{}},default:\"map\",requires:[\"circle-translate\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"circle-pitch-scale\":{type:\"enum\",values:{map:{},viewport:{}},default:\"map\",expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"circle-pitch-alignment\":{type:\"enum\",values:{map:{},viewport:{}},default:\"viewport\",expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"circle-stroke-width\":{type:\"number\",default:0,minimum:0,transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-stroke-color\":{type:\"color\",default:\"#000000\",transition:!0,expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-stroke-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"}},paint_heatmap:{\"heatmap-radius\":{type:\"number\",default:30,minimum:1,transition:!0,units:\"pixels\",expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"heatmap-weight\":{type:\"number\",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"heatmap-intensity\":{type:\"number\",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"heatmap-color\":{type:\"color\",default:[\"interpolate\",[\"linear\"],[\"heatmap-density\"],0,\"rgba(0, 0, 255, 0)\",.1,\"royalblue\",.3,\"cyan\",.5,\"lime\",.7,\"yellow\",1,\"red\"],transition:!1,expression:{interpolated:!0,parameters:[\"heatmap-density\"]},\"property-type\":\"color-ramp\"},\"heatmap-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"}},paint_symbol:{\"icon-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,requires:[\"icon-image\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"icon-color\":{type:\"color\",default:\"#000000\",transition:!0,requires:[\"icon-image\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"icon-halo-color\":{type:\"color\",default:\"rgba(0, 0, 0, 0)\",transition:!0,requires:[\"icon-image\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"icon-halo-width\":{type:\"number\",default:0,minimum:0,transition:!0,units:\"pixels\",requires:[\"icon-image\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"icon-halo-blur\":{type:\"number\",default:0,minimum:0,transition:!0,units:\"pixels\",requires:[\"icon-image\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"icon-translate\":{type:\"array\",value:\"number\",length:2,default:[0,0],transition:!0,units:\"pixels\",requires:[\"icon-image\"],expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-translate-anchor\":{type:\"enum\",values:{map:{},viewport:{}},default:\"map\",requires:[\"icon-image\",\"icon-translate\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"text-color\":{type:\"color\",default:\"#000000\",transition:!0,overridable:!0,requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"text-halo-color\":{type:\"color\",default:\"rgba(0, 0, 0, 0)\",transition:!0,requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"text-halo-width\":{type:\"number\",default:0,minimum:0,transition:!0,units:\"pixels\",requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"text-halo-blur\":{type:\"number\",default:0,minimum:0,transition:!0,units:\"pixels\",requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"text-translate\":{type:\"array\",value:\"number\",length:2,default:[0,0],transition:!0,units:\"pixels\",requires:[\"text-field\"],expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-translate-anchor\":{type:\"enum\",values:{map:{},viewport:{}},default:\"map\",requires:[\"text-field\",\"text-translate\"],expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"}},paint_raster:{\"raster-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-hue-rotate\":{type:\"number\",default:0,period:360,transition:!0,units:\"degrees\",expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-brightness-min\":{type:\"number\",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-brightness-max\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-saturation\":{type:\"number\",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-contrast\":{type:\"number\",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-resampling\":{type:\"enum\",values:{linear:{},nearest:{}},default:\"linear\",expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-fade-duration\":{type:\"number\",default:300,minimum:0,transition:!1,units:\"milliseconds\",expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"}},paint_hillshade:{\"hillshade-illumination-direction\":{type:\"numberArray\",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-illumination-altitude\":{type:\"numberArray\",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-illumination-anchor\":{type:\"enum\",values:{map:{},viewport:{}},default:\"viewport\",expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-exaggeration\":{type:\"number\",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-shadow-color\":{type:\"colorArray\",default:\"#000000\",transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-highlight-color\":{type:\"colorArray\",default:\"#FFFFFF\",transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-accent-color\":{type:\"color\",default:\"#000000\",transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-method\":{type:\"enum\",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:\"standard\",expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"}},\"paint_color-relief\":{\"color-relief-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"color-relief-color\":{type:\"color\",transition:!1,expression:{interpolated:!0,parameters:[\"elevation\"]},\"property-type\":\"color-ramp\"}},paint_background:{\"background-color\":{type:\"color\",default:\"#000000\",transition:!0,requires:[{\"!\":\"background-pattern\"}],expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"},\"background-pattern\":{type:\"resolvedImage\",transition:!0,expression:{interpolated:!1,parameters:[\"zoom\"]},\"property-type\":\"cross-faded\"},\"background-opacity\":{type:\"number\",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:[\"zoom\"]},\"property-type\":\"data-constant\"}},transition:{duration:{type:\"number\",default:300,minimum:0,units:\"milliseconds\"},delay:{type:\"number\",default:0,minimum:0,units:\"milliseconds\"}},\"property-type\":{\"data-driven\":{type:\"property-type\"},\"cross-faded\":{type:\"property-type\"},\"cross-faded-data-driven\":{type:\"property-type\"},\"color-ramp\":{type:\"property-type\"},\"data-constant\":{type:\"property-type\"},constant:{type:\"property-type\"}},promoteId:{\"*\":{type:\"string\"}},interpolation:{type:\"array\",value:\"interpolation_name\",minimum:1},interpolation_name:{type:\"enum\",values:{linear:{syntax:{overloads:[{parameters:[],\"output-type\":\"interpolation\"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:[\"base\"],\"output-type\":\"interpolation\"}],parameters:[{name:\"base\",type:\"number literal\"}]}},\"cubic-bezier\":{syntax:{overloads:[{parameters:[\"x1\",\"y1\",\"x2\",\"y2\"],\"output-type\":\"interpolation\"}],parameters:[{name:\"x1\",type:\"number literal\"},{name:\"y1\",type:\"number literal\"},{name:\"x2\",type:\"number literal\"},{name:\"y2\",type:\"number literal\"}]}}}}};let zn=[\"type\",\"source\",\"source-layer\",\"minzoom\",\"maxzoom\",\"filter\",\"layout\"];function Wr(h,a){let u={};for(let p in h)p!==\"ref\"&&(u[p]=h[p]);return zn.forEach((p=>{p in a&&(u[p]=a[p])})),u}function fn(h,a){if(Array.isArray(h)){if(!Array.isArray(a)||h.length!==a.length)return!1;for(let u=0;u<h.length;u++)if(!fn(h[u],a[u]))return!1;return!0}if(typeof h==\"object\"&&h!==null&&a!==null){if(typeof a!=\"object\"||Object.keys(h).length!==Object.keys(a).length)return!1;for(let u in h)if(!fn(h[u],a[u]))return!1;return!0}return h===a}function ln(h,a){h.push(a)}function Nn(h,a,u){ln(u,{command:\"addSource\",args:[h,a[h]]})}function Ir(h,a,u){ln(a,{command:\"removeSource\",args:[h]}),u[h]=!0}function Et(h,a,u,p){Ir(h,u,p),Nn(h,a,u)}function di(h,a,u){let p;for(p in h[u])if(Object.prototype.hasOwnProperty.call(h[u],p)&&p!==\"data\"&&!fn(h[u][p],a[u][p]))return!1;for(p in a[u])if(Object.prototype.hasOwnProperty.call(a[u],p)&&p!==\"data\"&&!fn(h[u][p],a[u][p]))return!1;return!0}function pi(h,a,u,p,v,E){h=h||{},a=a||{};for(let S in h)Object.prototype.hasOwnProperty.call(h,S)&&(fn(h[S],a[S])||u.push({command:E,args:[p,S,a[S],v]}));for(let S in a)Object.prototype.hasOwnProperty.call(a,S)&&!Object.prototype.hasOwnProperty.call(h,S)&&(fn(h[S],a[S])||u.push({command:E,args:[p,S,a[S],v]}))}function ti(h){return h.id}function Wi(h,a){return h[a.id]=a,h}class Lt{constructor(a,u,p,v){this.message=(a?`${a}: `:\"\")+p,v&&(this.identifier=v),u!=null&&u.__line__&&(this.line=u.__line__)}}function Ai(h,...a){for(let u of a)for(let p in u)h[p]=u[p];return h}class Vo extends Error{constructor(a,u){super(u),this.message=u,this.key=a}}class Es{constructor(a,u=[]){this.parent=a,this.bindings={};for(let[p,v]of u)this.bindings[p]=v}concat(a){return new Es(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}let qr={kind:\"null\"},Yt={kind:\"number\"},kn={kind:\"string\"},Hn={kind:\"boolean\"},Qo={kind:\"color\"},Pc={kind:\"projectionDefinition\"},$a={kind:\"object\"},Un={kind:\"value\"},Ko={kind:\"collator\"},mu={kind:\"formatted\"},hs={kind:\"padding\"},Ml={kind:\"colorArray\"},Ss={kind:\"numberArray\"},Zs={kind:\"resolvedImage\"},Cs={kind:\"variableAnchorOffsetCollection\"};function Bo(h,a){return{kind:\"array\",itemType:h,N:a}}function rr(h){if(h.kind===\"array\"){let a=rr(h.itemType);return typeof h.N==\"number\"?`array<${a}, ${h.N}>`:h.itemType.kind===\"value\"?\"array\":`array<${a}>`}return h.kind}let Rc=[qr,Yt,kn,Hn,Qo,Pc,mu,$a,Bo(Un),hs,Ss,Ml,Zs,Cs];function Il(h,a){if(a.kind===\"error\")return null;if(h.kind===\"array\"){if(a.kind===\"array\"&&(a.N===0&&a.itemType.kind===\"value\"||!Il(h.itemType,a.itemType))&&(typeof h.N!=\"number\"||h.N===a.N))return null}else{if(h.kind===a.kind)return null;if(h.kind===\"value\"){for(let u of Rc)if(!Il(u,a))return null}}return`Expected ${rr(h)} but found ${rr(a)} instead.`}function Jo(h,a){return a.some((u=>u.kind===h.kind))}function el(h,a){return a.some((u=>u===\"null\"?h===null:u===\"array\"?Array.isArray(h):u===\"object\"?h&&!Array.isArray(h)&&typeof h==\"object\":u===typeof h))}function Do(h,a){return h.kind===\"array\"&&a.kind===\"array\"?h.itemType.kind===a.itemType.kind&&typeof h.N==\"number\":h.kind===a.kind}let Bc=.96422,$o=.82521,ph=4/29,xi=6/29,Ah=3*xi*xi,Ia=xi*xi*xi,Ms=Math.PI/180,Pa=180/Math.PI;function Pl(h){return(h%=360)<0&&(h+=360),h}function fs([h,a,u,p]){let v,E,S=wr((.2225045*(h=gh(h))+.7168786*(a=gh(a))+.0606169*(u=gh(u)))/1);h===a&&a===u?v=E=S:(v=wr((.4360747*h+.3850649*a+.1430804*u)/Bc),E=wr((.0139322*h+.0971045*a+.7141733*u)/$o));let R=116*S-16;return[R<0?0:R,500*(v-S),200*(S-E),p]}function gh(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function wr(h){return h>Ia?Math.pow(h,1/3):h/Ah+ph}function _r([h,a,u,p]){let v=(h+16)/116,E=isNaN(a)?v:v+a/500,S=isNaN(u)?v:v-u/200;return v=1*Is(v),E=Bc*Is(E),S=$o*Is(S),[_u(3.1338561*E-1.6168667*v-.4906146*S),_u(-.9787684*E+1.9161415*v+.033454*S),_u(.0719453*E-.2289914*v+1.4052427*S),p]}function _u(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function Is(h){return h>xi?h*h*h:Ah*(h-ph)}let yu=Object.hasOwn||function(h,a){return Object.prototype.hasOwnProperty.call(h,a)};function Lo(h,a){return yu(h,a)?h[a]:void 0}function Rl(h){return parseInt(h.padEnd(2,h),16)/255}function mh(h,a){return xo(a?h/100:h,0,1)}function xo(h,a,u){return Math.min(Math.max(a,h),u)}function oc(h){return!h.some(Number.isNaN)}let tl={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Ra(h,a,u){return h+u*(a-h)}function Ba(h,a,u){return h.map(((p,v)=>Ra(p,a[v],u)))}class Zn{constructor(a,u,p,v=1,E=!0){this.r=a,this.g=u,this.b=p,this.a=v,E||(this.r*=v,this.g*=v,this.b*=v,v||this.overwriteGetter(\"rgb\",[a,u,p,v]))}static parse(a){if(a instanceof Zn)return a;if(typeof a!=\"string\")return;let u=(function(p){if((p=p.toLowerCase().trim())===\"transparent\")return[0,0,0,0];let v=Lo(tl,p);if(v){let[S,R,F]=v;return[S/255,R/255,F/255,1]}if(p.startsWith(\"#\")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){let S=p.length<6?1:2,R=1;return[Rl(p.slice(R,R+=S)),Rl(p.slice(R,R+=S)),Rl(p.slice(R,R+=S)),Rl(p.slice(R,R+S)||\"ff\")]}if(p.startsWith(\"rgb\")){let S=p.match(/^rgba?\\(\\s*([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/);if(S){let[R,F,U,H,X,$,te,oe,le,ue,me,Le]=S,ye=[H||\" \",te||\" \",ue].join(\"\");if(ye===\"  \"||ye===\"  /\"||ye===\",,\"||ye===\",,,\"){let we=[U,$,le].join(\"\"),ke=we===\"%%%\"?100:we===\"\"?255:0;if(ke){let je=[xo(+F/ke,0,1),xo(+X/ke,0,1),xo(+oe/ke,0,1),me?mh(+me,Le):1];if(oc(je))return je}}return}}let E=p.match(/^hsla?\\(\\s*([\\de.+-]+)(?:deg)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/);if(E){let[S,R,F,U,H,X,$,te,oe]=E,le=[F||\" \",H||\" \",$].join(\"\");if(le===\"  \"||le===\"  /\"||le===\",,\"||le===\",,,\"){let ue=[+R,xo(+U,0,100),xo(+X,0,100),te?mh(+te,oe):1];if(oc(ue))return(function([me,Le,ye,we]){function ke(je){let ht=(je+me/30)%12,It=Le*Math.min(ye,1-ye);return ye-It*Math.max(-1,Math.min(ht-3,9-ht,1))}return me=Pl(me),Le/=100,ye/=100,[ke(0),ke(8),ke(4),we]})(ue)}}})(a);return u?new Zn(...u,!1):void 0}get rgb(){let{r:a,g:u,b:p,a:v}=this,E=v||1/0;return this.overwriteGetter(\"rgb\",[a/E,u/E,p/E,v])}get hcl(){return this.overwriteGetter(\"hcl\",(function(a){let[u,p,v,E]=fs(a),S=Math.sqrt(p*p+v*v);return[Math.round(1e4*S)?Pl(Math.atan2(v,p)*Pa):NaN,S,u,E]})(this.rgb))}get lab(){return this.overwriteGetter(\"lab\",fs(this.rgb))}overwriteGetter(a,u){return Object.defineProperty(this,a,{value:u}),u}toString(){let[a,u,p,v]=this.rgb;return`rgba(${[a,u,p].map((E=>Math.round(255*E))).join(\",\")},${v})`}static interpolate(a,u,p,v=\"rgb\"){switch(v){case\"rgb\":{let[E,S,R,F]=Ba(a.rgb,u.rgb,p);return new Zn(E,S,R,F,!1)}case\"hcl\":{let[E,S,R,F]=a.hcl,[U,H,X,$]=u.hcl,te,oe;if(isNaN(E)||isNaN(U))isNaN(E)?isNaN(U)?te=NaN:(te=U,R!==1&&R!==0||(oe=H)):(te=E,X!==1&&X!==0||(oe=S));else{let ye=U-E;U>E&&ye>180?ye-=360:U<E&&E-U>180&&(ye+=360),te=E+p*ye}let[le,ue,me,Le]=(function([ye,we,ke,je]){return ye=isNaN(ye)?0:ye*Ms,_r([ke,Math.cos(ye)*we,Math.sin(ye)*we,je])})([te,oe??Ra(S,H,p),Ra(R,X,p),Ra(F,$,p)]);return new Zn(le,ue,me,Le,!1)}case\"lab\":{let[E,S,R,F]=_r(Ba(a.lab,u.lab,p));return new Zn(E,S,R,F,!1)}}}}Zn.black=new Zn(0,0,0,1),Zn.white=new Zn(1,1,1,1),Zn.transparent=new Zn(0,0,0,0),Zn.red=new Zn(1,0,0,1);class sc{constructor(a,u,p){this.sensitivity=a?u?\"variant\":\"case\":u?\"accent\":\"base\",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:\"search\"})}compare(a,u){return this.collator.compare(a,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}let df=[\"bottom\",\"center\",\"top\"];class ac{constructor(a,u,p,v,E,S){this.text=a,this.image=u,this.scale=p,this.fontStack=v,this.textColor=E,this.verticalAlign=S}}class Go{constructor(a){this.sections=a}static fromString(a){return new Go([new ac(a,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((a=>a.text.length!==0||a.image&&a.image.name.length!==0))}static factory(a){return a instanceof Go?a:Go.fromString(a)}toString(){return this.sections.length===0?\"\":this.sections.map((a=>a.text)).join(\"\")}}class si{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof si)return a;if(typeof a==\"number\")return new si([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(let u of a)if(typeof u!=\"number\")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new si(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,u,p){return new si(Ba(a.values,u.values,p))}}class Kn{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Kn)return a;if(typeof a==\"number\")return new Kn([a]);if(Array.isArray(a)){for(let u of a)if(typeof u!=\"number\")return;return new Kn(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,u,p){return new Kn(Ba(a.values,u.values,p))}}class Bn{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Bn)return a;if(typeof a==\"string\"){let p=Zn.parse(a);return p?new Bn([p]):void 0}if(!Array.isArray(a))return;let u=[];for(let p of a){if(typeof p!=\"string\")return;let v=Zn.parse(p);if(!v)return;u.push(v)}return new Bn(u)}toString(){return JSON.stringify(this.values)}static interpolate(a,u,p,v=\"rgb\"){let E=[];if(a.values.length!=u.values.length)throw new Error(`colorArray: Arrays have mismatched length (${a.values.length} vs. ${u.values.length}), cannot interpolate.`);for(let S=0;S<a.values.length;S++)E.push(Zn.interpolate(a.values[S],u.values[S],p,v));return new Bn(E)}}class vi extends Error{constructor(a){super(a),this.name=\"RuntimeError\"}toJSON(){return this.message}}let _h=new Set([\"center\",\"left\",\"right\",\"top\",\"bottom\",\"top-left\",\"top-right\",\"bottom-left\",\"bottom-right\"]);class ia{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof ia)return a;if(Array.isArray(a)&&!(a.length<1)&&a.length%2==0){for(let u=0;u<a.length;u+=2){let p=a[u],v=a[u+1];if(typeof p!=\"string\"||!_h.has(p)||!Array.isArray(v)||v.length!==2||typeof v[0]!=\"number\"||typeof v[1]!=\"number\")return}return new ia(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,u,p){let v=a.values,E=u.values;if(v.length!==E.length)throw new vi(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${u.toString()}`);let S=[];for(let R=0;R<v.length;R+=2){if(v[R]!==E[R])throw new vi(`Cannot interpolate values containing mismatched anchors. from[${R}]: ${v[R]}, to[${R}]: ${E[R]}`);S.push(v[R]);let[F,U]=v[R+1],[H,X]=E[R+1];S.push([Ra(F,H,p),Ra(U,X,p)])}return new ia(S)}}class nl{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new nl({name:a,available:!1}):null}}class oa{constructor(a,u,p){this.from=a,this.to=u,this.transition=p}static interpolate(a,u,p){return new oa(a,u,p)}static parse(a){return a instanceof oa?a:Array.isArray(a)&&a.length===3&&typeof a[0]==\"string\"&&typeof a[1]==\"string\"&&typeof a[2]==\"number\"?new oa(a[0],a[1],a[2]):typeof a==\"object\"&&typeof a.from==\"string\"&&typeof a.to==\"string\"&&typeof a.transition==\"number\"?new oa(a.from,a.to,a.transition):typeof a==\"string\"?new oa(a,a,1):void 0}}function gd(h,a,u,p){return typeof h==\"number\"&&h>=0&&h<=255&&typeof a==\"number\"&&a>=0&&a<=255&&typeof u==\"number\"&&u>=0&&u<=255?p===void 0||typeof p==\"number\"&&p>=0&&p<=1?null:`Invalid rgba value [${[h,a,u,p].join(\", \")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p==\"number\"?[h,a,u,p]:[h,a,u]).join(\", \")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function yh(h){if(h===null||typeof h==\"string\"||typeof h==\"boolean\"||typeof h==\"number\"||h instanceof oa||h instanceof Zn||h instanceof sc||h instanceof Go||h instanceof si||h instanceof Kn||h instanceof Bn||h instanceof ia||h instanceof nl)return!0;if(Array.isArray(h)){for(let a of h)if(!yh(a))return!1;return!0}if(typeof h==\"object\"){for(let a in h)if(!yh(h[a]))return!1;return!0}return!1}function vo(h){if(h===null)return qr;if(typeof h==\"string\")return kn;if(typeof h==\"boolean\")return Hn;if(typeof h==\"number\")return Yt;if(h instanceof Zn)return Qo;if(h instanceof oa)return Pc;if(h instanceof sc)return Ko;if(h instanceof Go)return mu;if(h instanceof si)return hs;if(h instanceof Kn)return Ss;if(h instanceof Bn)return Ml;if(h instanceof ia)return Cs;if(h instanceof nl)return Zs;if(Array.isArray(h)){let a=h.length,u;for(let p of h){let v=vo(p);if(u){if(u===v)continue;u=Un;break}u=v}return Bo(u||Un,a)}return $a}function pf(h){let a=typeof h;return h===null?\"\":a===\"string\"||a===\"number\"||a===\"boolean\"?String(h):h instanceof Zn||h instanceof oa||h instanceof Go||h instanceof si||h instanceof Kn||h instanceof Bn||h instanceof ia||h instanceof nl?h.toString():JSON.stringify(h)}class Dc{constructor(a,u){this.type=a,this.value=u}static parse(a,u){if(a.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!yh(a[1]))return u.error(\"invalid value\");let p=a[1],v=vo(p),E=u.expectedType;return v.kind!==\"array\"||v.N!==0||!E||E.kind!==\"array\"||typeof E.N==\"number\"&&E.N!==0||(v=E),new Dc(v,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}let Ag={string:kn,number:Yt,boolean:Hn,object:$a};class Da{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error(\"Expected at least one argument.\");let p,v=1,E=a[0];if(E===\"array\"){let R,F;if(a.length>2){let U=a[1];if(typeof U!=\"string\"||!(U in Ag)||U===\"object\")return u.error('The item type argument of \"array\" must be one of string, number, boolean',1);R=Ag[U],v++}else R=Un;if(a.length>3){if(a[2]!==null&&(typeof a[2]!=\"number\"||a[2]<0||a[2]!==Math.floor(a[2])))return u.error('The length argument to \"array\" must be a positive integer literal',2);F=a[2],v++}p=Bo(R,F)}else{if(!Ag[E])throw new Error(`Types doesn't contain name = ${E}`);p=Ag[E]}let S=[];for(;v<a.length;v++){let R=u.parse(a[v],v,Un);if(!R)return null;S.push(R)}return new Da(p,S)}evaluate(a){for(let u=0;u<this.args.length;u++){let p=this.args[u].evaluate(a);if(!Il(this.type,vo(p)))return p;if(u===this.args.length-1)throw new vi(`Expected value to be of type ${rr(this.type)}, but found ${rr(vo(p))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every((a=>a.outputDefined()))}}let Af={\"to-boolean\":Hn,\"to-color\":Qo,\"to-number\":Yt,\"to-string\":kn};class xu{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error(\"Expected at least one argument.\");let p=a[0];if(!Af[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p===\"to-boolean\"||p===\"to-string\")&&a.length!==2)return u.error(\"Expected one argument.\");let v=Af[p],E=[];for(let S=1;S<a.length;S++){let R=u.parse(a[S],S,Un);if(!R)return null;E.push(R)}return new xu(v,E)}evaluate(a){switch(this.type.kind){case\"boolean\":return!!this.args[0].evaluate(a);case\"color\":{let u,p;for(let v of this.args){if(u=v.evaluate(a),p=null,u instanceof Zn)return u;if(typeof u==\"string\"){let E=a.parseColor(u);if(E)return E}else if(Array.isArray(u)&&(p=u.length<3||u.length>4?`Invalid rgba value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:gd(u[0],u[1],u[2],u[3]),!p))return new Zn(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new vi(p||`Could not parse color from value '${typeof u==\"string\"?u:JSON.stringify(u)}'`)}case\"padding\":{let u;for(let p of this.args){u=p.evaluate(a);let v=si.parse(u);if(v)return v}throw new vi(`Could not parse padding from value '${typeof u==\"string\"?u:JSON.stringify(u)}'`)}case\"numberArray\":{let u;for(let p of this.args){u=p.evaluate(a);let v=Kn.parse(u);if(v)return v}throw new vi(`Could not parse numberArray from value '${typeof u==\"string\"?u:JSON.stringify(u)}'`)}case\"colorArray\":{let u;for(let p of this.args){u=p.evaluate(a);let v=Bn.parse(u);if(v)return v}throw new vi(`Could not parse colorArray from value '${typeof u==\"string\"?u:JSON.stringify(u)}'`)}case\"variableAnchorOffsetCollection\":{let u;for(let p of this.args){u=p.evaluate(a);let v=ia.parse(u);if(v)return v}throw new vi(`Could not parse variableAnchorOffsetCollection from value '${typeof u==\"string\"?u:JSON.stringify(u)}'`)}case\"number\":{let u=null;for(let p of this.args){if(u=p.evaluate(a),u===null)return 0;let v=Number(u);if(!isNaN(v))return v}throw new vi(`Could not convert ${JSON.stringify(u)} to number.`)}case\"formatted\":return Go.fromString(pf(this.args[0].evaluate(a)));case\"resolvedImage\":return nl.fromString(pf(this.args[0].evaluate(a)));case\"projectionDefinition\":return this.args[0].evaluate(a);default:return pf(this.args[0].evaluate(a))}}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every((a=>a.outputDefined()))}}let _x=[\"Unknown\",\"Point\",\"LineString\",\"Polygon\"];class P_{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&\"id\"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type==\"number\"?_x[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&\"geometry\"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let u=this._parseColorCache.get(a);return u||(u=Zn.parse(a),this._parseColorCache.set(a,u)),u}}class gf{constructor(a,u,p=[],v,E=new Es,S=[]){this.registry=a,this.path=p,this.key=p.map((R=>`[${R}]`)).join(\"\"),this.scope=E,this.errors=S,this.expectedType=v,this._isConstant=u}parse(a,u,p,v,E={}){return u?this.concat(u,p,v)._parse(a,E):this._parse(a,E)}_parse(a,u){function p(v,E,S){return S===\"assert\"?new Da(E,[v]):S===\"coerce\"?new xu(E,[v]):v}if(a!==null&&typeof a!=\"string\"&&typeof a!=\"boolean\"&&typeof a!=\"number\"||(a=[\"literal\",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use [\"literal\", []].');let v=a[0];if(typeof v!=\"string\")return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use [\"literal\", [...]].`,0),null;let E=this.registry[v];if(E){let S=E.parse(a,this);if(!S)return null;if(this.expectedType){let R=this.expectedType,F=S.type;if(R.kind!==\"string\"&&R.kind!==\"number\"&&R.kind!==\"boolean\"&&R.kind!==\"object\"&&R.kind!==\"array\"||F.kind!==\"value\"){if(R.kind===\"projectionDefinition\"&&[\"string\",\"array\"].includes(F.kind)||[\"color\",\"formatted\",\"resolvedImage\"].includes(R.kind)&&[\"value\",\"string\"].includes(F.kind)||[\"padding\",\"numberArray\"].includes(R.kind)&&[\"value\",\"number\",\"array\"].includes(F.kind)||R.kind===\"colorArray\"&&[\"value\",\"string\",\"array\"].includes(F.kind)||R.kind===\"variableAnchorOffsetCollection\"&&[\"value\",\"array\"].includes(F.kind))S=p(S,R,u.typeAnnotation||\"coerce\");else if(this.checkSubtype(R,F))return null}else S=p(S,R,u.typeAnnotation||\"assert\")}if(!(S instanceof Dc)&&S.type.kind!==\"resolvedImage\"&&this._isConstant(S)){let R=new P_;try{S=new Dc(S.type,S.evaluate(R))}catch(F){return this.error(F.message),null}}return S}return this.error(`Unknown expression \"${v}\". If you wanted a literal array, use [\"literal\", [...]].`,0)}return this.error(a===void 0?\"'undefined' value invalid. Use null instead.\":typeof a==\"object\"?'Bare objects invalid. Use [\"literal\", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,u,p){let v=typeof a==\"number\"?this.path.concat(a):this.path,E=p?this.scope.concat(p):this.scope;return new gf(this.registry,this._isConstant,v,u||null,E,this.errors)}error(a,...u){let p=`${this.key}${u.map((v=>`[${v}]`)).join(\"\")}`;this.errors.push(new Vo(p,a))}checkSubtype(a,u){let p=Il(a,u);return p&&this.error(p),p}}class bi{constructor(a,u){this.type=u.type,this.bindings=[].concat(a),this.result=u}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(let u of this.bindings)a(u[1]);a(this.result)}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);let p=[];for(let E=1;E<a.length-1;E+=2){let S=a[E];if(typeof S!=\"string\")return u.error(`Expected string, but found ${typeof S} instead.`,E);if(/[^a-zA-Z0-9_]/.test(S))return u.error(\"Variable names must contain only alphanumeric characters or '_'.\",E);let R=u.parse(a[E+1],E+1);if(!R)return null;p.push([S,R])}let v=u.parse(a[a.length-1],a.length-1,u.expectedType,p);return v?new bi(p,v):null}outputDefined(){return this.result.outputDefined()}}class md{constructor(a,u){this.type=u.type,this.name=a,this.boundExpression=u}static parse(a,u){if(a.length!==2||typeof a[1]!=\"string\")return u.error(\"'var' expression requires exactly one string literal argument.\");let p=a[1];return u.scope.has(p)?new md(p,u.scope.get(p)):u.error(`Unknown variable \"${p}\". Make sure \"${p}\" has been bound in an enclosing \"let\" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class Tr{constructor(a,u,p){this.type=a,this.index=u,this.input=p}static parse(a,u){if(a.length!==3)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);let p=u.parse(a[1],1,Yt),v=u.parse(a[2],2,Bo(u.expectedType||Un));return p&&v?new Tr(v.type.itemType,p,v):null}evaluate(a){let u=this.index.evaluate(a),p=this.input.evaluate(a);if(u<0)throw new vi(`Array index out of bounds: ${u} < 0.`);if(u>=p.length)throw new vi(`Array index out of bounds: ${u} > ${p.length-1}.`);if(u!==Math.floor(u))throw new vi(`Array index must be an integer, but found ${u} instead.`);return p[u]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class sr{constructor(a,u){this.type=Hn,this.needle=a,this.haystack=u}static parse(a,u){if(a.length!==3)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);let p=u.parse(a[1],1,Un),v=u.parse(a[2],2,Un);return p&&v?Jo(p.type,[Hn,kn,Yt,qr,Un])?new sr(p,v):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${rr(p.type)} instead`):null}evaluate(a){let u=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(!p)return!1;if(!el(u,[\"boolean\",\"string\",\"number\",\"null\"]))throw new vi(`Expected first argument to be of type boolean, string, number or null, but found ${rr(vo(u))} instead.`);if(!el(p,[\"string\",\"array\"]))throw new vi(`Expected second argument to be of type array or string, but found ${rr(vo(p))} instead.`);return p.indexOf(u)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class _d{constructor(a,u,p){this.type=Yt,this.needle=a,this.haystack=u,this.fromIndex=p}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 2 or 3 arguments, but found ${a.length-1} instead.`);let p=u.parse(a[1],1,Un),v=u.parse(a[2],2,Un);if(!p||!v)return null;if(!Jo(p.type,[Hn,kn,Yt,qr,Un]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${rr(p.type)} instead`);if(a.length===4){let E=u.parse(a[3],3,Yt);return E?new _d(p,v,E):null}return new _d(p,v)}evaluate(a){let u=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(!el(u,[\"boolean\",\"string\",\"number\",\"null\"]))throw new vi(`Expected first argument to be of type boolean, string, number or null, but found ${rr(vo(u))} instead.`);let v;if(this.fromIndex&&(v=this.fromIndex.evaluate(a)),el(p,[\"string\"])){let E=p.indexOf(u,v);return E===-1?-1:[...p.slice(0,E)].length}if(el(p,[\"array\"]))return p.indexOf(u,v);throw new vi(`Expected second argument to be of type array or string, but found ${rr(vo(p))} instead.`)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class Pr{constructor(a,u,p,v,E,S){this.inputType=a,this.type=u,this.input=p,this.cases=v,this.outputs=E,this.otherwise=S}static parse(a,u){if(a.length<5)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return u.error(\"Expected an even number of arguments.\");let p,v;u.expectedType&&u.expectedType.kind!==\"value\"&&(v=u.expectedType);let E={},S=[];for(let U=2;U<a.length-1;U+=2){let H=a[U],X=a[U+1];Array.isArray(H)||(H=[H]);let $=u.concat(U);if(H.length===0)return $.error(\"Expected at least one branch label.\");for(let oe of H){if(typeof oe!=\"number\"&&typeof oe!=\"string\")return $.error(\"Branch labels must be numbers or strings.\");if(typeof oe==\"number\"&&Math.abs(oe)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof oe==\"number\"&&Math.floor(oe)!==oe)return $.error(\"Numeric branch labels must be integer values.\");if(p){if($.checkSubtype(p,vo(oe)))return null}else p=vo(oe);if(E[String(oe)]!==void 0)return $.error(\"Branch labels must be unique.\");E[String(oe)]=S.length}let te=u.parse(X,U,v);if(!te)return null;v=v||te.type,S.push(te)}let R=u.parse(a[1],1,Un);if(!R)return null;let F=u.parse(a[a.length-1],a.length-1,v);return F?R.type.kind!==\"value\"&&u.concat(1).checkSubtype(p,R.type)?null:new Pr(p,v,R,E,S,F):null}evaluate(a){let u=this.input.evaluate(a);return(vo(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every((a=>a.outputDefined()))&&this.otherwise.outputDefined()}}class i0{constructor(a,u,p){this.type=a,this.branches=u,this.otherwise=p}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return u.error(\"Expected an odd number of arguments.\");let p;u.expectedType&&u.expectedType.kind!==\"value\"&&(p=u.expectedType);let v=[];for(let S=1;S<a.length-1;S+=2){let R=u.parse(a[S],S,Hn);if(!R)return null;let F=u.parse(a[S+1],S+1,p);if(!F)return null;v.push([R,F]),p=p||F.type}let E=u.parse(a[a.length-1],a.length-1,p);if(!E)return null;if(!p)throw new Error(\"Can't infer output type\");return new i0(p,v,E)}evaluate(a){for(let[u,p]of this.branches)if(u.evaluate(a))return p.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(let[u,p]of this.branches)a(u),a(p);a(this.otherwise)}outputDefined(){return this.branches.every((([a,u])=>u.outputDefined()))&&this.otherwise.outputDefined()}}class Bl{constructor(a,u,p,v){this.type=a,this.input=u,this.beginIndex=p,this.endIndex=v}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 2 or 3 arguments, but found ${a.length-1} instead.`);let p=u.parse(a[1],1,Un),v=u.parse(a[2],2,Yt);if(!p||!v)return null;if(!Jo(p.type,[Bo(Un),kn,Un]))return u.error(`Expected first argument to be of type array or string, but found ${rr(p.type)} instead`);if(a.length===4){let E=u.parse(a[3],3,Yt);return E?new Bl(p.type,p,v,E):null}return new Bl(p.type,p,v)}evaluate(a){let u=this.input.evaluate(a),p=this.beginIndex.evaluate(a),v;if(this.endIndex&&(v=this.endIndex.evaluate(a)),el(u,[\"string\"]))return[...u].slice(p,v).join(\"\");if(el(u,[\"array\"]))return u.slice(p,v);throw new vi(`Expected first argument to be of type array or string, but found ${rr(vo(u))} instead.`)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function yd(h,a){let u=h.length-1,p,v,E=0,S=u,R=0;for(;E<=S;)if(R=Math.floor((E+S)/2),p=h[R],v=h[R+1],p<=a){if(R===u||a<v)return R;E=R+1}else{if(!(p>a))throw new vi(\"Input is not a number.\");S=R-1}return 0}class xh{constructor(a,u,p){this.type=a,this.input=u,this.labels=[],this.outputs=[];for(let[v,E]of p)this.labels.push(v),this.outputs.push(E)}static parse(a,u){if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error(\"Expected an even number of arguments.\");let p=u.parse(a[1],1,Yt);if(!p)return null;let v=[],E=null;u.expectedType&&u.expectedType.kind!==\"value\"&&(E=u.expectedType);for(let S=1;S<a.length;S+=2){let R=S===1?-1/0:a[S],F=a[S+1],U=S,H=S+1;if(typeof R!=\"number\")return u.error('Input/output pairs for \"step\" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(v.length&&v[v.length-1][0]>=R)return u.error('Input/output pairs for \"step\" expressions must be arranged with input values in strictly ascending order.',U);let X=u.parse(F,H,E);if(!X)return null;E=E||X.type,v.push([R,X])}return new xh(E,p,v)}evaluate(a){let u=this.labels,p=this.outputs;if(u.length===1)return p[0].evaluate(a);let v=this.input.evaluate(a);if(v<=u[0])return p[0].evaluate(a);let E=u.length;return v>=u[E-1]?p[E-1].evaluate(a):p[yd(u,v)].evaluate(a)}eachChild(a){a(this.input);for(let u of this.outputs)a(u)}outputDefined(){return this.outputs.every((a=>a.outputDefined()))}}function yx(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,\"default\")?h.default:h}var o0,R_,iE=(function(){if(R_)return o0;function h(a,u,p,v){this.cx=3*a,this.bx=3*(p-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(v-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=u,this.p2x=p,this.p2y=v}return R_=1,o0=h,h.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,u){if(u===void 0&&(u=1e-6),a<0)return 0;if(a>1)return 1;for(var p=a,v=0;v<8;v++){var E=this.sampleCurveX(p)-a;if(Math.abs(E)<u)return p;var S=this.sampleCurveDerivativeX(p);if(Math.abs(S)<1e-6)break;p-=E/S}var R=0,F=1;for(p=a,v=0;v<20&&(E=this.sampleCurveX(p),!(Math.abs(E-a)<u));v++)a>E?R=p:F=p,p=.5*(F-R)+R;return p},solve:function(a,u){return this.sampleCurveY(this.solveCurveX(a,u))}},o0})(),xx=yx(iE);class sa{constructor(a,u,p,v,E){this.type=a,this.operator=u,this.interpolation=p,this.input=v,this.labels=[],this.outputs=[];for(let[S,R]of E)this.labels.push(S),this.outputs.push(R)}static interpolationFactor(a,u,p,v){let E=0;if(a.name===\"exponential\")E=Lc(u,a.base,p,v);else if(a.name===\"linear\")E=Lc(u,1,p,v);else if(a.name===\"cubic-bezier\"){let S=a.controlPoints;E=new xx(S[0],S[1],S[2],S[3]).solve(Lc(u,1,p,v))}return E}static parse(a,u){let[p,v,E,...S]=a;if(!Array.isArray(v)||v.length===0)return u.error(\"Expected an interpolation type expression.\",1);if(v[0]===\"linear\")v={name:\"linear\"};else if(v[0]===\"exponential\"){let U=v[1];if(typeof U!=\"number\")return u.error(\"Exponential interpolation requires a numeric base.\",1,1);v={name:\"exponential\",base:U}}else{if(v[0]!==\"cubic-bezier\")return u.error(`Unknown interpolation type ${String(v[0])}`,1,0);{let U=v.slice(1);if(U.length!==4||U.some((H=>typeof H!=\"number\"||H<0||H>1)))return u.error(\"Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.\",1);v={name:\"cubic-bezier\",controlPoints:U}}}if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error(\"Expected an even number of arguments.\");if(E=u.parse(E,2,Yt),!E)return null;let R=[],F=null;p!==\"interpolate-hcl\"&&p!==\"interpolate-lab\"||u.expectedType==Ml?u.expectedType&&u.expectedType.kind!==\"value\"&&(F=u.expectedType):F=Qo;for(let U=0;U<S.length;U+=2){let H=S[U],X=S[U+1],$=U+3,te=U+4;if(typeof H!=\"number\")return u.error('Input/output pairs for \"interpolate\" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(R.length&&R[R.length-1][0]>=H)return u.error('Input/output pairs for \"interpolate\" expressions must be arranged with input values in strictly ascending order.',$);let oe=u.parse(X,te,F);if(!oe)return null;F=F||oe.type,R.push([H,oe])}return Do(F,Yt)||Do(F,Pc)||Do(F,Qo)||Do(F,hs)||Do(F,Ss)||Do(F,Ml)||Do(F,Cs)||Do(F,Bo(Yt))?new sa(F,p,v,E,R):u.error(`Type ${rr(F)} is not interpolatable.`)}evaluate(a){let u=this.labels,p=this.outputs;if(u.length===1)return p[0].evaluate(a);let v=this.input.evaluate(a);if(v<=u[0])return p[0].evaluate(a);let E=u.length;if(v>=u[E-1])return p[E-1].evaluate(a);let S=yd(u,v),R=sa.interpolationFactor(this.interpolation,v,u[S],u[S+1]),F=p[S].evaluate(a),U=p[S+1].evaluate(a);switch(this.operator){case\"interpolate\":switch(this.type.kind){case\"number\":return Ra(F,U,R);case\"color\":return Zn.interpolate(F,U,R);case\"padding\":return si.interpolate(F,U,R);case\"colorArray\":return Bn.interpolate(F,U,R);case\"numberArray\":return Kn.interpolate(F,U,R);case\"variableAnchorOffsetCollection\":return ia.interpolate(F,U,R);case\"array\":return Ba(F,U,R);case\"projectionDefinition\":return oa.interpolate(F,U,R)}case\"interpolate-hcl\":switch(this.type.kind){case\"color\":return Zn.interpolate(F,U,R,\"hcl\");case\"colorArray\":return Bn.interpolate(F,U,R,\"hcl\")}case\"interpolate-lab\":switch(this.type.kind){case\"color\":return Zn.interpolate(F,U,R,\"lab\");case\"colorArray\":return Bn.interpolate(F,U,R,\"lab\")}}}eachChild(a){a(this.input);for(let u of this.outputs)a(u)}outputDefined(){return this.outputs.every((a=>a.outputDefined()))}}function Lc(h,a,u,p){let v=p-u,E=h-u;return v===0?0:a===1?E/v:(Math.pow(a,E)-1)/(Math.pow(a,v)-1)}let ji={color:Zn.interpolate,number:Ra,padding:si.interpolate,numberArray:Kn.interpolate,colorArray:Bn.interpolate,variableAnchorOffsetCollection:ia.interpolate,array:Ba};class mf{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error(\"Expected at least one argument.\");let p=null,v=u.expectedType;v&&v.kind!==\"value\"&&(p=v);let E=[];for(let R of a.slice(1)){let F=u.parse(R,1+E.length,p,void 0,{typeAnnotation:\"omit\"});if(!F)return null;p=p||F.type,E.push(F)}if(!p)throw new Error(\"No output type\");let S=v&&E.some((R=>Il(v,R.type)));return new mf(S?Un:p,E)}evaluate(a){let u,p=null,v=0;for(let E of this.args)if(v++,p=E.evaluate(a),p&&p instanceof nl&&!p.available&&(u||(u=p.name),p=null,v===this.args.length&&(p=u)),p!==null)break;return p}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every((a=>a.outputDefined()))}}function s0(h,a){return h===\"==\"||h===\"!=\"?a.kind===\"boolean\"||a.kind===\"string\"||a.kind===\"number\"||a.kind===\"null\"||a.kind===\"value\":a.kind===\"string\"||a.kind===\"number\"||a.kind===\"value\"}function xd(h,a,u,p){return p.compare(a,u)===0}function to(h,a,u){let p=h!==\"==\"&&h!==\"!=\";return class zX{constructor(E,S,R){this.type=Hn,this.lhs=E,this.rhs=S,this.collator=R,this.hasUntypedArgument=E.type.kind===\"value\"||S.type.kind===\"value\"}static parse(E,S){if(E.length!==3&&E.length!==4)return S.error(\"Expected two or three arguments.\");let R=E[0],F=S.parse(E[1],1,Un);if(!F)return null;if(!s0(R,F.type))return S.concat(1).error(`\"${R}\" comparisons are not supported for type '${rr(F.type)}'.`);let U=S.parse(E[2],2,Un);if(!U)return null;if(!s0(R,U.type))return S.concat(2).error(`\"${R}\" comparisons are not supported for type '${rr(U.type)}'.`);if(F.type.kind!==U.type.kind&&F.type.kind!==\"value\"&&U.type.kind!==\"value\")return S.error(`Cannot compare types '${rr(F.type)}' and '${rr(U.type)}'.`);p&&(F.type.kind===\"value\"&&U.type.kind!==\"value\"?F=new Da(U.type,[F]):F.type.kind!==\"value\"&&U.type.kind===\"value\"&&(U=new Da(F.type,[U])));let H=null;if(E.length===4){if(F.type.kind!==\"string\"&&U.type.kind!==\"string\"&&F.type.kind!==\"value\"&&U.type.kind!==\"value\")return S.error(\"Cannot use collator to compare non-string types.\");if(H=S.parse(E[3],3,Ko),!H)return null}return new zX(F,U,H)}evaluate(E){let S=this.lhs.evaluate(E),R=this.rhs.evaluate(E);if(p&&this.hasUntypedArgument){let F=vo(S),U=vo(R);if(F.kind!==U.kind||F.kind!==\"string\"&&F.kind!==\"number\")throw new vi(`Expected arguments for \"${h}\" to be (string, string) or (number, number), but found (${F.kind}, ${U.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){let F=vo(S),U=vo(R);if(F.kind!==\"string\"||U.kind!==\"string\")return a(E,S,R)}return this.collator?u(E,S,R,this.collator.evaluate(E)):a(E,S,R)}eachChild(E){E(this.lhs),E(this.rhs),this.collator&&E(this.collator)}outputDefined(){return!0}}}let a0=to(\"==\",(function(h,a,u){return a===u}),xd),l0=to(\"!=\",(function(h,a,u){return a!==u}),(function(h,a,u,p){return!xd(0,a,u,p)})),gg=to(\"<\",(function(h,a,u){return a<u}),(function(h,a,u,p){return p.compare(a,u)<0})),B_=to(\">\",(function(h,a,u){return a>u}),(function(h,a,u,p){return p.compare(a,u)>0})),Oc=to(\"<=\",(function(h,a,u){return a<=u}),(function(h,a,u,p){return p.compare(a,u)<=0})),_f=to(\">=\",(function(h,a,u){return a>=u}),(function(h,a,u,p){return p.compare(a,u)>=0}));class rl{constructor(a,u,p){this.type=Ko,this.locale=p,this.caseSensitive=a,this.diacriticSensitive=u}static parse(a,u){if(a.length!==2)return u.error(\"Expected one argument.\");let p=a[1];if(typeof p!=\"object\"||Array.isArray(p))return u.error(\"Collator options argument must be an object.\");let v=u.parse(p[\"case-sensitive\"]!==void 0&&p[\"case-sensitive\"],1,Hn);if(!v)return null;let E=u.parse(p[\"diacritic-sensitive\"]!==void 0&&p[\"diacritic-sensitive\"],1,Hn);if(!E)return null;let S=null;return p.locale&&(S=u.parse(p.locale,1,kn),!S)?null:new rl(v,E,S)}evaluate(a){return new sc(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}class At{constructor(a,u,p,v,E){this.type=kn,this.number=a,this.locale=u,this.currency=p,this.minFractionDigits=v,this.maxFractionDigits=E}static parse(a,u){if(a.length!==3)return u.error(\"Expected two arguments.\");let p=u.parse(a[1],1,Yt);if(!p)return null;let v=a[2];if(typeof v!=\"object\"||Array.isArray(v))return u.error(\"NumberFormat options argument must be an object.\");let E=null;if(v.locale&&(E=u.parse(v.locale,1,kn),!E))return null;let S=null;if(v.currency&&(S=u.parse(v.currency,1,kn),!S))return null;let R=null;if(v[\"min-fraction-digits\"]&&(R=u.parse(v[\"min-fraction-digits\"],1,Yt),!R))return null;let F=null;return v[\"max-fraction-digits\"]&&(F=u.parse(v[\"max-fraction-digits\"],1,Yt),!F)?null:new At(p,E,S,R,F)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?\"currency\":\"decimal\",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class Nt{constructor(a){this.type=mu,this.sections=a}static parse(a,u){if(a.length<2)return u.error(\"Expected at least one argument.\");let p=a[1];if(!Array.isArray(p)&&typeof p==\"object\")return u.error(\"First argument must be an image or text section.\");let v=[],E=!1;for(let S=1;S<=a.length-1;++S){let R=a[S];if(E&&typeof R==\"object\"&&!Array.isArray(R)){E=!1;let F=null;if(R[\"font-scale\"]&&(F=u.parse(R[\"font-scale\"],1,Yt),!F))return null;let U=null;if(R[\"text-font\"]&&(U=u.parse(R[\"text-font\"],1,Bo(kn)),!U))return null;let H=null;if(R[\"text-color\"]&&(H=u.parse(R[\"text-color\"],1,Qo),!H))return null;let X=null;if(R[\"vertical-align\"]){if(typeof R[\"vertical-align\"]==\"string\"&&!df.includes(R[\"vertical-align\"]))return u.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${R[\"vertical-align\"]}' instead.`);if(X=u.parse(R[\"vertical-align\"],1,kn),!X)return null}let $=v[v.length-1];$.scale=F,$.font=U,$.textColor=H,$.verticalAlign=X}else{let F=u.parse(a[S],1,Un);if(!F)return null;let U=F.type.kind;if(U!==\"string\"&&U!==\"value\"&&U!==\"null\"&&U!==\"resolvedImage\")return u.error(\"Formatted text type must be 'string', 'value', 'image' or 'null'.\");E=!0,v.push({content:F,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Nt(v)}evaluate(a){return new Go(this.sections.map((u=>{let p=u.content.evaluate(a);return vo(p)===Zs?new ac(\"\",p,null,null,null,u.verticalAlign?u.verticalAlign.evaluate(a):null):new ac(pf(p),null,u.scale?u.scale.evaluate(a):null,u.font?u.font.evaluate(a).join(\",\"):null,u.textColor?u.textColor.evaluate(a):null,u.verticalAlign?u.verticalAlign.evaluate(a):null)})))}eachChild(a){for(let u of this.sections)a(u.content),u.scale&&a(u.scale),u.font&&a(u.font),u.textColor&&a(u.textColor),u.verticalAlign&&a(u.verticalAlign)}outputDefined(){return!1}}class sn{constructor(a){this.type=Zs,this.input=a}static parse(a,u){if(a.length!==2)return u.error(\"Expected two arguments.\");let p=u.parse(a[1],1,kn);return p?new sn(p):u.error(\"No image name provided.\")}evaluate(a){let u=this.input.evaluate(a),p=nl.fromString(u);return p&&a.availableImages&&(p.available=a.availableImages.indexOf(u)>-1),p}eachChild(a){a(this.input)}outputDefined(){return!1}}class zt{constructor(a){this.type=Yt,this.input=a}static parse(a,u){if(a.length!==2)return u.error(`Expected 1 argument, but found ${a.length-1} instead.`);let p=u.parse(a[1],1);return p?p.type.kind!==\"array\"&&p.type.kind!==\"string\"&&p.type.kind!==\"value\"?u.error(`Expected argument of type string or array, but found ${rr(p.type)} instead.`):new zt(p):null}evaluate(a){let u=this.input.evaluate(a);if(typeof u==\"string\")return[...u].length;if(Array.isArray(u))return u.length;throw new vi(`Expected value to be of type string or array, but found ${rr(vo(u))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}let _=8192;function ai(h,a){let u=(180+h[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,v=Math.pow(2,a.z);return[Math.round(u*v*_),Math.round(p*v*_)]}function Er(h,a){let u=Math.pow(2,a.z);return[(v=(h[0]/_+a.x)/u,360*v-180),(p=(h[1]/_+a.y)/u,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,v}function fe(h,a){h[0]=Math.min(h[0],a[0]),h[1]=Math.min(h[1],a[1]),h[2]=Math.max(h[2],a[0]),h[3]=Math.max(h[3],a[1])}function Xi(h,a){return!(h[0]<=a[0]||h[2]>=a[2]||h[1]<=a[1]||h[3]>=a[3])}function aa(h,a,u){let p=h[0]-a[0],v=h[1]-a[1],E=h[0]-u[0],S=h[1]-u[1];return p*S-E*v==0&&p*E<=0&&v*S<=0}function bo(h,a,u,p){return(v=[p[0]-u[0],p[1]-u[1]])[0]*(E=[a[0]-h[0],a[1]-h[1]])[1]-v[1]*E[0]!=0&&!(!vh(h,a,u,p)||!vh(u,p,h,a));var v,E}function kr(h,a,u){for(let p of u)for(let v=0;v<p.length-1;++v)if(bo(h,a,p[v],p[v+1]))return!0;return!1}function li(h,a,u=!1){let p=!1;for(let R of a)for(let F=0;F<R.length-1;F++){if(aa(h,R[F],R[F+1]))return u;(E=R[F])[1]>(v=h)[1]!=(S=R[F+1])[1]>v[1]&&v[0]<(S[0]-E[0])*(v[1]-E[1])/(S[1]-E[1])+E[0]&&(p=!p)}var v,E,S;return p}function wo(h,a){for(let u of a)if(li(h,u))return!0;return!1}function Sr(h,a){for(let u of h)if(!li(u,a))return!1;for(let u=0;u<h.length-1;++u)if(kr(h[u],h[u+1],a))return!1;return!0}function Nr(h,a){for(let u of a)if(Sr(h,u))return!0;return!1}function vh(h,a,u,p){let v=p[0]-u[0],E=p[1]-u[1],S=(h[0]-u[0])*E-v*(h[1]-u[1]),R=(a[0]-u[0])*E-v*(a[1]-u[1]);return S>0&&R<0||S<0&&R>0}function mg(h,a,u){let p=[];for(let v=0;v<h.length;v++){let E=[];for(let S=0;S<h[v].length;S++){let R=ai(h[v][S],u);fe(a,R),E.push(R)}p.push(E)}return p}function _g(h,a,u){let p=[];for(let v=0;v<h.length;v++){let E=mg(h[v],a,u);p.push(E)}return p}function c0(h,a,u,p){if(h[0]<u[0]||h[0]>u[2]){let v=.5*p,E=h[0]-u[0]>v?-p:u[0]-h[0]>v?p:0;E===0&&(E=h[0]-u[2]>v?-p:u[2]-h[0]>v?p:0),h[0]+=E}fe(a,h)}function La(h,a,u,p){let v=Math.pow(2,p.z)*_,E=[p.x*_,p.y*_],S=[];for(let R of h)for(let F of R){let U=[F.x+E[0],F.y+E[1]];c0(U,a,u,v),S.push(U)}return S}function bh(h,a,u,p){let v=Math.pow(2,p.z)*_,E=[p.x*_,p.y*_],S=[];for(let F of h){let U=[];for(let H of F){let X=[H.x+E[0],H.y+E[1]];fe(a,X),U.push(X)}S.push(U)}if(a[2]-a[0]<=v/2){(R=a)[0]=R[1]=1/0,R[2]=R[3]=-1/0;for(let F of S)for(let U of F)c0(U,a,u,v)}var R;return S}class Ps{constructor(a,u){this.type=Hn,this.geojson=a,this.geometries=u}static parse(a,u){if(a.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(yh(a[1])){let p=a[1];if(p.type===\"FeatureCollection\"){let v=[];for(let E of p.features){let{type:S,coordinates:R}=E.geometry;S===\"Polygon\"&&v.push(R),S===\"MultiPolygon\"&&v.push(...R)}if(v.length)return new Ps(p,{type:\"MultiPolygon\",coordinates:v})}else if(p.type===\"Feature\"){let v=p.geometry.type;if(v===\"Polygon\"||v===\"MultiPolygon\")return new Ps(p,p.geometry)}else if(p.type===\"Polygon\"||p.type===\"MultiPolygon\")return new Ps(p,p)}return u.error(\"'within' expression requires valid geojson object that contains polygon geometry type.\")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()===\"Point\")return(function(u,p){let v=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],S=u.canonicalID();if(p.type===\"Polygon\"){let R=mg(p.coordinates,E,S),F=La(u.geometry(),v,E,S);if(!Xi(v,E))return!1;for(let U of F)if(!li(U,R))return!1}if(p.type===\"MultiPolygon\"){let R=_g(p.coordinates,E,S),F=La(u.geometry(),v,E,S);if(!Xi(v,E))return!1;for(let U of F)if(!wo(U,R))return!1}return!0})(a,this.geometries);if(a.geometryType()===\"LineString\")return(function(u,p){let v=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],S=u.canonicalID();if(p.type===\"Polygon\"){let R=mg(p.coordinates,E,S),F=bh(u.geometry(),v,E,S);if(!Xi(v,E))return!1;for(let U of F)if(!Sr(U,R))return!1}if(p.type===\"MultiPolygon\"){let R=_g(p.coordinates,E,S),F=bh(u.geometry(),v,E,S);if(!Xi(v,E))return!1;for(let U of F)if(!Nr(U,R))return!1}return!0})(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let u0=class{constructor(h=[],a=(u,p)=>u<p?-1:u>p?1:0){if(this.data=h,this.length=this.data.length,this.compare=a,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;let h=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),h}peek(){return this.data[0]}_up(h){let{data:a,compare:u}=this,p=a[h];for(;h>0;){let v=h-1>>1,E=a[v];if(u(p,E)>=0)break;a[h]=E,h=v}a[h]=p}_down(h){let{data:a,compare:u}=this,p=this.length>>1,v=a[h];for(;h<p;){let E=1+(h<<1),S=E+1;if(S<this.length&&u(a[S],a[E])<0&&(E=S),u(a[E],v)>=0)break;a[h]=a[E],h=E}a[h]=v}};function yg(h,a,u=0,p=h.length-1,v=Jn){for(;p>u;){if(p-u>600){let F=p-u+1,U=a-u+1,H=Math.log(F),X=.5*Math.exp(2*H/3),$=.5*Math.sqrt(H*X*(F-X)/F)*(U-F/2<0?-1:1);yg(h,a,Math.max(u,Math.floor(a-U*X/F+$)),Math.min(p,Math.floor(a+(F-U)*X/F+$)),v)}let E=h[a],S=u,R=p;for(la(h,u,a),v(h[p],E)>0&&la(h,u,p);S<R;){for(la(h,S,R),S++,R--;v(h[S],E)<0;)S++;for(;v(h[R],E)>0;)R--}v(h[u],E)===0?la(h,u,R):(R++,la(h,R,p)),R<=a&&(u=R+1),a<=R&&(p=R-1)}}function la(h,a,u){let p=h[a];h[a]=h[u],h[u]=p}function Jn(h,a){return h<a?-1:h>a?1:0}function ve(h,a){if(h.length<=1)return[h];let u=[],p,v;for(let E of h){let S=D_(E);S!==0&&(E.area=Math.abs(S),v===void 0&&(v=S<0),v===S<0?(p&&u.push(p),p=[E]):p.push(E))}if(p&&u.push(p),a>1)for(let E=0;E<u.length;E++)u[E].length<=a||(yg(u[E],a,1,u[E].length-1,Wn),u[E]=u[E].slice(0,a));return u}function Wn(h,a){return a.area-h.area}function D_(h){let a=0;for(let u,p,v=0,E=h.length,S=E-1;v<E;S=v++)u=h[v],p=h[S],a+=(p.x-u.x)*(u.y+p.y);return a}let L_=1/298.257223563,vd=L_*(2-L_),O_=Math.PI/180;class xg{constructor(a){let u=6378.137*O_*1e3,p=Math.cos(a*O_),v=1/(1-vd*(1-p*p)),E=Math.sqrt(v);this.kx=u*E*p,this.ky=u*E*v*(1-vd)}distance(a,u){let p=this.wrap(a[0]-u[0])*this.kx,v=(a[1]-u[1])*this.ky;return Math.sqrt(p*p+v*v)}pointOnLine(a,u){let p,v,E,S,R=1/0;for(let F=0;F<a.length-1;F++){let U=a[F][0],H=a[F][1],X=this.wrap(a[F+1][0]-U)*this.kx,$=(a[F+1][1]-H)*this.ky,te=0;X===0&&$===0||(te=(this.wrap(u[0]-U)*this.kx*X+(u[1]-H)*this.ky*$)/(X*X+$*$),te>1?(U=a[F+1][0],H=a[F+1][1]):te>0&&(U+=X/this.kx*te,H+=$/this.ky*te)),X=this.wrap(u[0]-U)*this.kx,$=(u[1]-H)*this.ky;let oe=X*X+$*$;oe<R&&(R=oe,p=U,v=H,E=F,S=te)}return{point:[p,v],index:E,t:Math.max(0,Math.min(1,S))}}wrap(a){for(;a<-180;)a+=360;for(;a>180;)a-=360;return a}}function Ae(h,a){return a[0]-h[0]}function h0(h){return h[1]-h[0]+1}function Dl(h,a){return h[1]>=h[0]&&h[1]<a}function f0(h,a){if(h[0]>h[1])return[null,null];let u=h0(h);if(a){if(u===2)return[h,null];let v=Math.floor(u/2);return[[h[0],h[0]+v],[h[0]+v,h[1]]]}if(u===1)return[h,null];let p=Math.floor(u/2)-1;return[[h[0],h[0]+p],[h[0]+p+1,h[1]]]}function vg(h,a){if(!Dl(a,h.length))return[1/0,1/0,-1/0,-1/0];let u=[1/0,1/0,-1/0,-1/0];for(let p=a[0];p<=a[1];++p)fe(u,h[p]);return u}function bg(h){let a=[1/0,1/0,-1/0,-1/0];for(let u of h)for(let p of u)fe(a,p);return a}function wg(h){return h[0]!==-1/0&&h[1]!==-1/0&&h[2]!==1/0&&h[3]!==1/0}function bd(h,a,u){if(!wg(h)||!wg(a))return NaN;let p=0,v=0;return h[2]<a[0]&&(p=a[0]-h[2]),h[0]>a[2]&&(p=h[0]-a[2]),h[1]>a[3]&&(v=h[1]-a[3]),h[3]<a[1]&&(v=a[1]-h[3]),u.distance([0,0],[p,v])}function vu(h,a,u){let p=u.pointOnLine(a,h);return u.distance(h,p.point)}function d0(h,a,u,p,v){let E=Math.min(vu(h,[u,p],v),vu(a,[u,p],v)),S=Math.min(vu(u,[h,a],v),vu(p,[h,a],v));return Math.min(E,S)}function lc(h,a,u,p,v){if(!Dl(a,h.length)||!Dl(p,u.length))return 1/0;let E=1/0;for(let S=a[0];S<a[1];++S){let R=h[S],F=h[S+1];for(let U=p[0];U<p[1];++U){let H=u[U],X=u[U+1];if(bo(R,F,H,X))return 0;E=Math.min(E,d0(R,F,H,X,v))}}return E}function Ho(h,a,u,p,v){if(!Dl(a,h.length)||!Dl(p,u.length))return NaN;let E=1/0;for(let S=a[0];S<=a[1];++S)for(let R=p[0];R<=p[1];++R)if(E=Math.min(E,v.distance(h[S],u[R])),E===0)return E;return E}function vx(h,a,u){if(li(h,a,!0))return 0;let p=1/0;for(let v of a){let E=v[0],S=v[v.length-1];if(E!==S&&(p=Math.min(p,vu(h,[S,E],u)),p===0))return p;let R=u.pointOnLine(v,h);if(p=Math.min(p,u.distance(h,R.point)),p===0)return p}return p}function F_(h,a,u,p){if(!Dl(a,h.length))return NaN;for(let E=a[0];E<=a[1];++E)if(li(h[E],u,!0))return 0;let v=1/0;for(let E=a[0];E<a[1];++E){let S=h[E],R=h[E+1];for(let F of u)for(let U=0,H=F.length,X=H-1;U<H;X=U++){let $=F[X],te=F[U];if(bo(S,R,$,te))return 0;v=Math.min(v,d0(S,R,$,te,p))}}return v}function k_(h,a){for(let u of h)for(let p of u)if(li(p,a,!0))return!0;return!1}function Tg(h,a,u,p=1/0){let v=bg(h),E=bg(a);if(p!==1/0&&bd(v,E,u)>=p)return p;if(Xi(v,E)){if(k_(h,a))return 0}else if(k_(a,h))return 0;let S=1/0;for(let R of h)for(let F=0,U=R.length,H=U-1;F<U;H=F++){let X=R[H],$=R[F];for(let te of a)for(let oe=0,le=te.length,ue=le-1;oe<le;ue=oe++){let me=te[ue],Le=te[oe];if(bo(X,$,me,Le))return 0;S=Math.min(S,d0(X,$,me,Le,u))}}return S}function zr(h,a,u,p,v,E){if(!E)return;let S=bd(vg(p,E),v,u);S<a&&h.push([S,E,[0,0]])}function wd(h,a,u,p,v,E,S){if(!E||!S)return;let R=bd(vg(p,E),vg(v,S),u);R<a&&h.push([R,E,S])}function p0(h,a,u,p,v=1/0){let E=Math.min(p.distance(h[0],u[0][0]),v);if(E===0)return E;let S=new u0([[0,[0,h.length-1],[0,0]]],Ae),R=bg(u);for(;S.length>0;){let F=S.pop();if(F[0]>=E)continue;let U=F[1],H=a?50:100;if(h0(U)<=H){if(!Dl(U,h.length))return NaN;if(a){let X=F_(h,U,u,p);if(isNaN(X)||X===0)return X;E=Math.min(E,X)}else for(let X=U[0];X<=U[1];++X){let $=vx(h[X],u,p);if(E=Math.min(E,$),E===0)return 0}}else{let X=f0(U,a);zr(S,E,p,h,R,X[0]),zr(S,E,p,h,R,X[1])}}return E}function A0(h,a,u,p,v,E=1/0){let S=Math.min(E,v.distance(h[0],u[0]));if(S===0)return S;let R=new u0([[0,[0,h.length-1],[0,u.length-1]]],Ae);for(;R.length>0;){let F=R.pop();if(F[0]>=S)continue;let U=F[1],H=F[2],X=a?50:100,$=p?50:100;if(h0(U)<=X&&h0(H)<=$){if(!Dl(U,h.length)&&Dl(H,u.length))return NaN;let te;if(a&&p)te=lc(h,U,u,H,v),S=Math.min(S,te);else if(a&&!p){let oe=h.slice(U[0],U[1]+1);for(let le=H[0];le<=H[1];++le)if(te=vu(u[le],oe,v),S=Math.min(S,te),S===0)return S}else if(!a&&p){let oe=u.slice(H[0],H[1]+1);for(let le=U[0];le<=U[1];++le)if(te=vu(h[le],oe,v),S=Math.min(S,te),S===0)return S}else te=Ho(h,U,u,H,v),S=Math.min(S,te)}else{let te=f0(U,a),oe=f0(H,p);wd(R,S,v,h,u,te[0],oe[0]),wd(R,S,v,h,u,te[0],oe[1]),wd(R,S,v,h,u,te[1],oe[0]),wd(R,S,v,h,u,te[1],oe[1])}}return S}function Eg(h){return h.type===\"MultiPolygon\"?h.coordinates.map((a=>({type:\"Polygon\",coordinates:a}))):h.type===\"MultiLineString\"?h.coordinates.map((a=>({type:\"LineString\",coordinates:a}))):h.type===\"MultiPoint\"?h.coordinates.map((a=>({type:\"Point\",coordinates:a}))):[h]}class Qr{constructor(a,u){this.type=Yt,this.geojson=a,this.geometries=u}static parse(a,u){if(a.length!==2)return u.error(`'distance' expression requires exactly one argument, but found ${a.length-1} instead.`);if(yh(a[1])){let p=a[1];if(p.type===\"FeatureCollection\")return new Qr(p,p.features.map((v=>Eg(v.geometry))).flat());if(p.type===\"Feature\")return new Qr(p,Eg(p.geometry));if(\"type\"in p&&\"coordinates\"in p)return new Qr(p,Eg(p))}return u.error(\"'distance' expression requires valid geojson object that contains polygon geometry type.\")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()===\"Point\")return(function(u,p){let v=u.geometry(),E=v.flat().map((F=>Er([F.x,F.y],u.canonical)));if(v.length===0)return NaN;let S=new xg(E[0][1]),R=1/0;for(let F of p){switch(F.type){case\"Point\":R=Math.min(R,A0(E,!1,[F.coordinates],!1,S,R));break;case\"LineString\":R=Math.min(R,A0(E,!1,F.coordinates,!0,S,R));break;case\"Polygon\":R=Math.min(R,p0(E,!1,F.coordinates,S,R))}if(R===0)return R}return R})(a,this.geometries);if(a.geometryType()===\"LineString\")return(function(u,p){let v=u.geometry(),E=v.flat().map((F=>Er([F.x,F.y],u.canonical)));if(v.length===0)return NaN;let S=new xg(E[0][1]),R=1/0;for(let F of p){switch(F.type){case\"Point\":R=Math.min(R,A0(E,!0,[F.coordinates],!1,S,R));break;case\"LineString\":R=Math.min(R,A0(E,!0,F.coordinates,!0,S,R));break;case\"Polygon\":R=Math.min(R,p0(E,!0,F.coordinates,S,R))}if(R===0)return R}return R})(a,this.geometries);if(a.geometryType()===\"Polygon\")return(function(u,p){let v=u.geometry();if(v.length===0||v[0].length===0)return NaN;let E=ve(v,0).map((F=>F.map((U=>U.map((H=>Er([H.x,H.y],u.canonical))))))),S=new xg(E[0][0][0][1]),R=1/0;for(let F of p)for(let U of E){switch(F.type){case\"Point\":R=Math.min(R,p0([F.coordinates],!1,U,S,R));break;case\"LineString\":R=Math.min(R,p0(F.coordinates,!0,U,S,R));break;case\"Polygon\":R=Math.min(R,Tg(U,F.coordinates,S,R))}if(R===0)return R}return R})(a,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class wh{constructor(a){this.type=Un,this.key=a}static parse(a,u){if(a.length!==2)return u.error(`Expected 1 argument, but found ${a.length-1} instead.`);let p=a[1];return p==null?u.error(\"Global state property must be defined.\"):typeof p!=\"string\"?u.error(`Global state property must be string, but found ${typeof a[1]} instead.`):new wh(p)}evaluate(a){var u;let p=(u=a.globals)===null||u===void 0?void 0:u.globalState;return p&&Object.keys(p).length!==0?Lo(p,this.key):null}eachChild(){}outputDefined(){return!1}}let Th={\"==\":a0,\"!=\":l0,\">\":B_,\"<\":gg,\">=\":_f,\"<=\":Oc,array:Da,at:Tr,boolean:Da,case:i0,coalesce:mf,collator:rl,format:Nt,image:sn,in:sr,\"index-of\":_d,interpolate:sa,\"interpolate-hcl\":sa,\"interpolate-lab\":sa,length:zt,let:bi,literal:Dc,match:Pr,number:Da,\"number-format\":At,object:Da,slice:Bl,step:xh,string:Da,\"to-boolean\":xu,\"to-color\":xu,\"to-number\":xu,\"to-string\":xu,var:md,within:Ps,distance:Qr,\"global-state\":wh};class il{constructor(a,u,p,v){this.name=a,this.type=u,this._evaluate=p,this.args=v}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,u){let p=a[0],v=il.definitions[p];if(!v)return u.error(`Unknown expression \"${p}\". If you wanted a literal array, use [\"literal\", [...]].`,0);let E=Array.isArray(v)?v[0]:v.type,S=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,R=S.filter((([U])=>!Array.isArray(U)||U.length===a.length-1)),F=null;for(let[U,H]of R){F=new gf(u.registry,yf,u.path,null,u.scope);let X=[],$=!1;for(let te=1;te<a.length;te++){let oe=a[te],le=Array.isArray(U)?U[te-1]:U.type,ue=F.parse(oe,1+X.length,le);if(!ue){$=!0;break}X.push(ue)}if(!$)if(Array.isArray(U)&&U.length!==X.length)F.error(`Expected ${U.length} arguments, but found ${X.length} instead.`);else{for(let te=0;te<X.length;te++){let oe=Array.isArray(U)?U[te]:U.type,le=X[te];F.concat(te+1).checkSubtype(oe,le.type)}if(F.errors.length===0)return new il(p,E,H,X)}}if(R.length===1)u.errors.push(...F.errors);else{let U=(R.length?R:S).map((([X])=>{return $=X,Array.isArray($)?`(${$.map(rr).join(\", \")})`:`(${rr($.type)}...)`;var $})).join(\" | \"),H=[];for(let X=1;X<a.length;X++){let $=u.parse(a[X],1+H.length);if(!$)return null;H.push(rr($.type))}u.error(`Expected arguments of type ${U}, but found (${H.join(\", \")}) instead.`)}return null}static register(a,u){il.definitions=u;for(let p in u)a[p]=il}}function N_(h,[a,u,p,v]){a=a.evaluate(h),u=u.evaluate(h),p=p.evaluate(h);let E=v?v.evaluate(h):1,S=gd(a,u,p,E);if(S)throw new vi(S);return new Zn(a/255,u/255,p/255,E,!1)}function z_(h,a){return h in a}function g0(h,a){let u=a[h];return u===void 0?null:u}function Fc(h){return{type:h}}function yf(h){if(h instanceof md)return yf(h.boundExpression);if(h instanceof il&&h.name===\"error\"||h instanceof rl||h instanceof Ps||h instanceof Qr||h instanceof wh)return!1;let a=h instanceof xu||h instanceof Da,u=!0;return h.eachChild((p=>{u=a?u&&yf(p):u&&p instanceof Dc})),!!u&&m0(h)&&_0(h,[\"zoom\",\"heatmap-density\",\"elevation\",\"line-progress\",\"accumulated\",\"is-supported-script\"])}function m0(h){if(h instanceof il&&(h.name===\"get\"&&h.args.length===1||h.name===\"feature-state\"||h.name===\"has\"&&h.args.length===1||h.name===\"properties\"||h.name===\"geometry-type\"||h.name===\"id\"||/^filter-/.test(h.name))||h instanceof Ps||h instanceof Qr)return!1;let a=!0;return h.eachChild((u=>{a&&!m0(u)&&(a=!1)})),a}function Td(h){if(h instanceof il&&h.name===\"feature-state\")return!1;let a=!0;return h.eachChild((u=>{a&&!Td(u)&&(a=!1)})),a}function _0(h,a){if(h instanceof il&&a.indexOf(h.name)>=0)return!1;let u=!0;return h.eachChild((p=>{u&&!_0(p,a)&&(u=!1)})),u}function Sg(h){return{result:\"success\",value:h}}function xf(h){return{result:\"error\",value:h}}function bu(h){return h[\"property-type\"]===\"data-driven\"||h[\"property-type\"]===\"cross-faded-data-driven\"}function y0(h){return!!h.expression&&h.expression.parameters.indexOf(\"zoom\")>-1}function Cg(h){return!!h.expression&&h.expression.interpolated}function cr(h){return h instanceof Number?\"number\":h instanceof String?\"string\":h instanceof Boolean?\"boolean\":Array.isArray(h)?\"array\":h===null?\"null\":typeof h}function Ed(h){return typeof h==\"object\"&&h!==null&&!Array.isArray(h)&&vo(h)===$a}function U_(h){return h}function V_(h,a){let u=h.stops&&typeof h.stops[0][0]==\"object\",p=u||!(u||h.property!==void 0),v=h.type||(Cg(a)?\"exponential\":\"interval\"),E=(function(H){switch(H.type){case\"color\":return Zn.parse;case\"padding\":return si.parse;case\"numberArray\":return Kn.parse;case\"colorArray\":return Bn.parse;default:return null}})(a);if(E&&((h=Ai({},h)).stops&&(h.stops=h.stops.map((H=>[H[0],E(H[1])]))),h.default=E(h.default?h.default:a.default)),h.colorSpace&&(S=h.colorSpace)!==\"rgb\"&&S!==\"hcl\"&&S!==\"lab\")throw new Error(`Unknown color space: \"${h.colorSpace}\"`);var S;let R=(function(H){switch(H){case\"exponential\":return ds;case\"interval\":return wx;case\"categorical\":return bx;case\"identity\":return Eh;default:throw new Error(`Unknown function type \"${H}\"`)}})(v),F,U;if(v===\"categorical\"){F=Object.create(null);for(let H of h.stops)F[H[0]]=H[1];U=typeof h.stops[0][0]}if(u){let H={},X=[];for(let oe=0;oe<h.stops.length;oe++){let le=h.stops[oe],ue=le[0].zoom;H[ue]===void 0&&(H[ue]={zoom:ue,type:h.type,property:h.property,default:h.default,stops:[]},X.push(ue)),H[ue].stops.push([le[0].value,le[1]])}let $=[];for(let oe of X)$.push([H[oe].zoom,V_(H[oe],a)]);let te={name:\"linear\"};return{kind:\"composite\",interpolationType:te,interpolationFactor:sa.interpolationFactor.bind(void 0,te),zoomStops:$.map((oe=>oe[0])),evaluate:({zoom:oe},le)=>ds({stops:$,base:h.base},a,oe).evaluate(oe,le)}}if(p){let H=v===\"exponential\"?{name:\"exponential\",base:h.base!==void 0?h.base:1}:null;return{kind:\"camera\",interpolationType:H,interpolationFactor:sa.interpolationFactor.bind(void 0,H),zoomStops:h.stops.map((X=>X[0])),evaluate:({zoom:X})=>R(h,a,X,F,U)}}return{kind:\"source\",evaluate(H,X){let $=X&&X.properties?X.properties[h.property]:void 0;return $===void 0?Sd(h.default,a.default):R(h,a,$,F,U)}}}function Sd(h,a,u){return h!==void 0?h:a!==void 0?a:u!==void 0?u:void 0}function bx(h,a,u,p,v){return Sd(typeof u===v?p[u]:void 0,h.default,a.default)}function wx(h,a,u){if(cr(u)!==\"number\")return Sd(h.default,a.default);let p=h.stops.length;if(p===1||u<=h.stops[0][0])return h.stops[0][1];if(u>=h.stops[p-1][0])return h.stops[p-1][1];let v=yd(h.stops.map((E=>E[0])),u);return h.stops[v][1]}function ds(h,a,u){let p=h.base!==void 0?h.base:1;if(cr(u)!==\"number\")return Sd(h.default,a.default);let v=h.stops.length;if(v===1||u<=h.stops[0][0])return h.stops[0][1];if(u>=h.stops[v-1][0])return h.stops[v-1][1];let E=yd(h.stops.map((H=>H[0])),u),S=(function(H,X,$,te){let oe=te-$,le=H-$;return oe===0?0:X===1?le/oe:(Math.pow(X,le)-1)/(Math.pow(X,oe)-1)})(u,p,h.stops[E][0],h.stops[E+1][0]),R=h.stops[E][1],F=h.stops[E+1][1],U=ji[a.type]||U_;return typeof R.evaluate==\"function\"?{evaluate(...H){let X=R.evaluate.apply(void 0,H),$=F.evaluate.apply(void 0,H);if(X!==void 0&&$!==void 0)return U(X,$,S,h.colorSpace)}}:U(R,F,S,h.colorSpace)}function Eh(h,a,u){switch(a.type){case\"color\":u=Zn.parse(u);break;case\"formatted\":u=Go.fromString(u.toString());break;case\"resolvedImage\":u=nl.fromString(u.toString());break;case\"padding\":u=si.parse(u);break;case\"colorArray\":u=Bn.parse(u);break;case\"numberArray\":u=Kn.parse(u);break;default:cr(u)===a.type||a.type===\"enum\"&&a.values[u]||(u=void 0)}return Sd(u,h.default,a.default)}il.register(Th,{error:[{kind:\"error\"},[kn],(h,[a])=>{throw new vi(a.evaluate(h))}],typeof:[kn,[Un],(h,[a])=>rr(vo(a.evaluate(h)))],\"to-rgba\":[Bo(Yt,4),[Qo],(h,[a])=>{let[u,p,v,E]=a.evaluate(h).rgb;return[255*u,255*p,255*v,E]}],rgb:[Qo,[Yt,Yt,Yt],N_],rgba:[Qo,[Yt,Yt,Yt,Yt],N_],has:{type:Hn,overloads:[[[kn],(h,[a])=>z_(a.evaluate(h),h.properties())],[[kn,$a],(h,[a,u])=>z_(a.evaluate(h),u.evaluate(h))]]},get:{type:Un,overloads:[[[kn],(h,[a])=>g0(a.evaluate(h),h.properties())],[[kn,$a],(h,[a,u])=>g0(a.evaluate(h),u.evaluate(h))]]},\"feature-state\":[Un,[kn],(h,[a])=>g0(a.evaluate(h),h.featureState||{})],properties:[$a,[],h=>h.properties()],\"geometry-type\":[kn,[],h=>h.geometryType()],id:[Un,[],h=>h.id()],zoom:[Yt,[],h=>h.globals.zoom],\"heatmap-density\":[Yt,[],h=>h.globals.heatmapDensity||0],elevation:[Yt,[],h=>h.globals.elevation||0],\"line-progress\":[Yt,[],h=>h.globals.lineProgress||0],accumulated:[Un,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],\"+\":[Yt,Fc(Yt),(h,a)=>{let u=0;for(let p of a)u+=p.evaluate(h);return u}],\"*\":[Yt,Fc(Yt),(h,a)=>{let u=1;for(let p of a)u*=p.evaluate(h);return u}],\"-\":{type:Yt,overloads:[[[Yt,Yt],(h,[a,u])=>a.evaluate(h)-u.evaluate(h)],[[Yt],(h,[a])=>-a.evaluate(h)]]},\"/\":[Yt,[Yt,Yt],(h,[a,u])=>a.evaluate(h)/u.evaluate(h)],\"%\":[Yt,[Yt,Yt],(h,[a,u])=>a.evaluate(h)%u.evaluate(h)],ln2:[Yt,[],()=>Math.LN2],pi:[Yt,[],()=>Math.PI],e:[Yt,[],()=>Math.E],\"^\":[Yt,[Yt,Yt],(h,[a,u])=>Math.pow(a.evaluate(h),u.evaluate(h))],sqrt:[Yt,[Yt],(h,[a])=>Math.sqrt(a.evaluate(h))],log10:[Yt,[Yt],(h,[a])=>Math.log(a.evaluate(h))/Math.LN10],ln:[Yt,[Yt],(h,[a])=>Math.log(a.evaluate(h))],log2:[Yt,[Yt],(h,[a])=>Math.log(a.evaluate(h))/Math.LN2],sin:[Yt,[Yt],(h,[a])=>Math.sin(a.evaluate(h))],cos:[Yt,[Yt],(h,[a])=>Math.cos(a.evaluate(h))],tan:[Yt,[Yt],(h,[a])=>Math.tan(a.evaluate(h))],asin:[Yt,[Yt],(h,[a])=>Math.asin(a.evaluate(h))],acos:[Yt,[Yt],(h,[a])=>Math.acos(a.evaluate(h))],atan:[Yt,[Yt],(h,[a])=>Math.atan(a.evaluate(h))],min:[Yt,Fc(Yt),(h,a)=>Math.min(...a.map((u=>u.evaluate(h))))],max:[Yt,Fc(Yt),(h,a)=>Math.max(...a.map((u=>u.evaluate(h))))],abs:[Yt,[Yt],(h,[a])=>Math.abs(a.evaluate(h))],round:[Yt,[Yt],(h,[a])=>{let u=a.evaluate(h);return u<0?-Math.round(-u):Math.round(u)}],floor:[Yt,[Yt],(h,[a])=>Math.floor(a.evaluate(h))],ceil:[Yt,[Yt],(h,[a])=>Math.ceil(a.evaluate(h))],\"filter-==\":[Hn,[kn,Un],(h,[a,u])=>h.properties()[a.value]===u.value],\"filter-id-==\":[Hn,[Un],(h,[a])=>h.id()===a.value],\"filter-type-==\":[Hn,[kn],(h,[a])=>h.geometryType()===a.value],\"filter-<\":[Hn,[kn,Un],(h,[a,u])=>{let p=h.properties()[a.value],v=u.value;return typeof p==typeof v&&p<v}],\"filter-id-<\":[Hn,[Un],(h,[a])=>{let u=h.id(),p=a.value;return typeof u==typeof p&&u<p}],\"filter->\":[Hn,[kn,Un],(h,[a,u])=>{let p=h.properties()[a.value],v=u.value;return typeof p==typeof v&&p>v}],\"filter-id->\":[Hn,[Un],(h,[a])=>{let u=h.id(),p=a.value;return typeof u==typeof p&&u>p}],\"filter-<=\":[Hn,[kn,Un],(h,[a,u])=>{let p=h.properties()[a.value],v=u.value;return typeof p==typeof v&&p<=v}],\"filter-id-<=\":[Hn,[Un],(h,[a])=>{let u=h.id(),p=a.value;return typeof u==typeof p&&u<=p}],\"filter->=\":[Hn,[kn,Un],(h,[a,u])=>{let p=h.properties()[a.value],v=u.value;return typeof p==typeof v&&p>=v}],\"filter-id->=\":[Hn,[Un],(h,[a])=>{let u=h.id(),p=a.value;return typeof u==typeof p&&u>=p}],\"filter-has\":[Hn,[Un],(h,[a])=>a.value in h.properties()],\"filter-has-id\":[Hn,[],h=>h.id()!==null&&h.id()!==void 0],\"filter-type-in\":[Hn,[Bo(kn)],(h,[a])=>a.value.indexOf(h.geometryType())>=0],\"filter-id-in\":[Hn,[Bo(Un)],(h,[a])=>a.value.indexOf(h.id())>=0],\"filter-in-small\":[Hn,[kn,Bo(Un)],(h,[a,u])=>u.value.indexOf(h.properties()[a.value])>=0],\"filter-in-large\":[Hn,[kn,Bo(Un)],(h,[a,u])=>(function(p,v,E,S){for(;E<=S;){let R=E+S>>1;if(v[R]===p)return!0;v[R]>p?S=R-1:E=R+1}return!1})(h.properties()[a.value],u.value,0,u.value.length-1)],all:{type:Hn,overloads:[[[Hn,Hn],(h,[a,u])=>a.evaluate(h)&&u.evaluate(h)],[Fc(Hn),(h,a)=>{for(let u of a)if(!u.evaluate(h))return!1;return!0}]]},any:{type:Hn,overloads:[[[Hn,Hn],(h,[a,u])=>a.evaluate(h)||u.evaluate(h)],[Fc(Hn),(h,a)=>{for(let u of a)if(u.evaluate(h))return!0;return!1}]]},\"!\":[Hn,[Hn],(h,[a])=>!a.evaluate(h)],\"is-supported-script\":[Hn,[kn],(h,[a])=>{let u=h.globals&&h.globals.isSupportedScript;return!u||u(a.evaluate(h))}],upcase:[kn,[kn],(h,[a])=>a.evaluate(h).toUpperCase()],downcase:[kn,[kn],(h,[a])=>a.evaluate(h).toLowerCase()],concat:[kn,Fc(Un),(h,a)=>a.map((u=>pf(u.evaluate(h)))).join(\"\")],\"resolved-locale\":[kn,[Ko],(h,[a])=>a.evaluate(h).resolvedLocale()]});class ps{constructor(a,u,p){this.expression=a,this._warningHistory={},this._evaluator=new P_,this._defaultValue=u?(function(v){if(v.type===\"color\"&&Ed(v.default))return new Zn(0,0,0,0);switch(v.type){case\"color\":return Zn.parse(v.default)||null;case\"padding\":return si.parse(v.default)||null;case\"numberArray\":return Kn.parse(v.default)||null;case\"colorArray\":return Bn.parse(v.default)||null;case\"variableAnchorOffsetCollection\":return ia.parse(v.default)||null;case\"projectionDefinition\":return oa.parse(v.default)||null;default:return v.default===void 0?null:v.default}})(u):null,this._enumValues=u&&u.type===\"enum\"?u.values:null,this._globalState=p}evaluateWithoutErrorHandling(a,u,p,v,E,S){return this._globalState&&(a=Oa(a,this._globalState)),this._evaluator.globals=a,this._evaluator.feature=u,this._evaluator.featureState=p,this._evaluator.canonical=v,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(a,u,p,v,E,S){this._globalState&&(a=Oa(a,this._globalState)),this._evaluator.globals=a,this._evaluator.feature=u||null,this._evaluator.featureState=p||null,this._evaluator.canonical=v,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=S||null;try{let R=this.expression.evaluate(this._evaluator);if(R==null||typeof R==\"number\"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new vi(`Expected value to be one of ${Object.keys(this._enumValues).map((F=>JSON.stringify(F))).join(\", \")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<\"u\"&&console.warn(R.message)),this._defaultValue}}}function wu(h){return Array.isArray(h)&&h.length>0&&typeof h[0]==\"string\"&&h[0]in Th}function vf(h,a,u){let p=new gf(Th,yf,[],a?(function(E){let S={color:Qo,string:kn,number:Yt,enum:kn,boolean:Hn,formatted:mu,padding:hs,numberArray:Ss,colorArray:Ml,projectionDefinition:Pc,resolvedImage:Zs,variableAnchorOffsetCollection:Cs};return E.type===\"array\"?Bo(S[E.value]||Un,E.length):S[E.type]})(a):void 0),v=p.parse(h,void 0,void 0,void 0,a&&a.type===\"string\"?{typeAnnotation:\"coerce\"}:void 0);return v?Sg(new ps(v,a,u)):xf(p.errors)}class Sh{constructor(a,u,p){this.kind=a,this._styleExpression=u,this.isStateDependent=a!==\"constant\"&&!Td(u.expression),this.globalStateRefs=Ll(u.expression),this._globalState=p}evaluateWithoutErrorHandling(a,u,p,v,E,S){return this._globalState&&(a=Oa(a,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(a,u,p,v,E,S)}evaluate(a,u,p,v,E,S){return this._globalState&&(a=Oa(a,this._globalState)),this._styleExpression.evaluate(a,u,p,v,E,S)}}class Mg{constructor(a,u,p,v,E){this.kind=a,this.zoomStops=p,this._styleExpression=u,this.isStateDependent=a!==\"camera\"&&!Td(u.expression),this.globalStateRefs=Ll(u.expression),this.interpolationType=v,this._globalState=E}evaluateWithoutErrorHandling(a,u,p,v,E,S){return this._globalState&&(a=Oa(a,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(a,u,p,v,E,S)}evaluate(a,u,p,v,E,S){return this._globalState&&(a=Oa(a,this._globalState)),this._styleExpression.evaluate(a,u,p,v,E,S)}interpolationFactor(a,u,p){return this.interpolationType?sa.interpolationFactor(this.interpolationType,a,u,p):0}}function Ig(h,a,u){let p=vf(h,a,u);if(p.result===\"error\")return p;let v=p.value.expression,E=m0(v);if(!E&&!bu(a))return xf([new Vo(\"\",\"data expressions not supported\")]);let S=_0(v,[\"zoom\"]);if(!S&&!y0(a))return xf([new Vo(\"\",\"zoom expressions not supported\")]);let R=Cd(v);return R||S?R instanceof Vo?xf([R]):R instanceof sa&&!Cg(a)?xf([new Vo(\"\",'\"interpolate\" expressions cannot be used with this property')]):Sg(R?new Mg(E?\"camera\":\"composite\",p.value,R.labels,R instanceof sa?R.interpolation:void 0,u):new Sh(E?\"constant\":\"source\",p.value,u)):xf([new Vo(\"\",'\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.')])}class x0{constructor(a,u){this._parameters=a,this._specification=u,Ai(this,V_(this._parameters,this._specification))}static deserialize(a){return new x0(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Cd(h){let a=null;if(h instanceof bi)a=Cd(h.result);else if(h instanceof mf){for(let u of h.args)if(a=Cd(u),a)break}else(h instanceof xh||h instanceof sa)&&h.input instanceof il&&h.input.name===\"zoom\"&&(a=h);return a instanceof Vo||h.eachChild((u=>{let p=Cd(u);p instanceof Vo?a=p:!a&&p?a=new Vo(\"\",'\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.'):a&&p&&a!==p&&(a=new Vo(\"\",'Only one zoom-based \"step\" or \"interpolate\" subexpression may be used in an expression.'))})),a}function Ll(h,a=new Set){return h instanceof wh&&a.add(h.key),h.eachChild((u=>{Ll(u,a)})),a}function Oa(h,a){let{zoom:u,heatmapDensity:p,elevation:v,lineProgress:E,isSupportedScript:S,accumulated:R}=h??{};return{zoom:u,heatmapDensity:p,elevation:v,lineProgress:E,isSupportedScript:S,accumulated:R,globalState:a}}function v0(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case\"has\":return h.length>=2&&h[1]!==\"$id\"&&h[1]!==\"$type\";case\"in\":return h.length>=3&&(typeof h[1]!=\"string\"||Array.isArray(h[2]));case\"!in\":case\"!has\":case\"none\":return!1;case\"==\":case\"!=\":case\">\":case\">=\":case\"<\":case\"<=\":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case\"any\":case\"all\":for(let a of h.slice(1))if(!v0(a)&&typeof a!=\"boolean\")return!1;return!0;default:return!0}}let G_={type:\"boolean\",default:!1,transition:!1,\"property-type\":\"data-driven\",expression:{interpolated:!1,parameters:[\"zoom\",\"feature\"]}};function Tu(h,a){if(h==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};v0(h)||(h=bf(h));let u=vf(h,G_,a);if(u.result===\"error\")throw new Error(u.value.map((p=>`${p.key}: ${p.message}`)).join(\", \"));return{filter:(p,v,E)=>u.value.evaluate(p,v,{},E),needGeometry:kc(h),getGlobalStateRefs:()=>Ll(u.value.expression)}}function Ch(h,a){return h<a?-1:h>a?1:0}function kc(h){if(!Array.isArray(h))return!1;if(h[0]===\"within\"||h[0]===\"distance\")return!0;for(let a=1;a<h.length;a++)if(kc(h[a]))return!0;return!1}function bf(h){if(!h)return!0;let a=h[0];return h.length<=1?a!==\"any\":a===\"==\"?Md(h[1],h[2],\"==\"):a===\"!=\"?Id(Md(h[1],h[2],\"==\")):a===\"<\"||a===\">\"||a===\"<=\"||a===\">=\"?Md(h[1],h[2],a):a===\"any\"?(u=h.slice(1),[\"any\"].concat(u.map(bf))):a===\"all\"?[\"all\"].concat(h.slice(1).map(bf)):a===\"none\"?[\"all\"].concat(h.slice(1).map(bf).map(Id)):a===\"in\"?b0(h[1],h.slice(2)):a===\"!in\"?Id(b0(h[1],h.slice(2))):a===\"has\"?H_(h[1]):a!==\"!has\"||Id(H_(h[1]));var u}function Md(h,a,u){switch(h){case\"$type\":return[`filter-type-${u}`,a];case\"$id\":return[`filter-id-${u}`,a];default:return[`filter-${u}`,h,a]}}function b0(h,a){if(a.length===0)return!1;switch(h){case\"$type\":return[\"filter-type-in\",[\"literal\",a]];case\"$id\":return[\"filter-id-in\",[\"literal\",a]];default:return a.length>200&&!a.some((u=>typeof u!=typeof a[0]))?[\"filter-in-large\",h,[\"literal\",a.sort(Ch)]]:[\"filter-in-small\",h,[\"literal\",a]]}}function H_(h){switch(h){case\"$type\":return!0;case\"$id\":return[\"filter-has-id\"];default:return[\"filter-has\",h]}}function Id(h){return[\"!\",h]}function Pd(h){let a=typeof h;if(a===\"number\"||a===\"boolean\"||a===\"string\"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let v=\"[\";for(let E of h)v+=`${Pd(E)},`;return`${v}]`}let u=Object.keys(h).sort(),p=\"{\";for(let v=0;v<u.length;v++)p+=`${JSON.stringify(u[v])}:${Pd(h[u[v]])},`;return`${p}}`}function W_(h){let a=\"\";for(let u of zn)a+=`/${Pd(h[u])}`;return a}function j_(h){let a=h.value;return a?[new Lt(h.key,a,\"constants have been deprecated as of v8\")]:[]}function uo(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function Mh(h){if(Array.isArray(h))return h.map(Mh);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){let a={};for(let u in h)a[u]=Mh(h[u]);return a}return uo(h)}function Fa(h){let a=h.key,u=h.value,p=h.valueSpec||{},v=h.objectElementValidators||{},E=h.style,S=h.styleSpec,R=h.validateSpec,F=[],U=cr(u);if(U!==\"object\")return[new Lt(a,u,`object expected, ${U} found`)];for(let H in u){let X=H.split(\".\")[0],$=Lo(p,X)||p[\"*\"],te;if(Lo(v,X))te=v[X];else if(Lo(p,X)){if(u[H]===void 0)continue;te=R}else if(v[\"*\"])te=v[\"*\"];else{if(!p[\"*\"]){F.push(new Lt(a,u[H],`unknown property \"${H}\"`));continue}te=R}F=F.concat(te({key:(a&&`${a}.`)+H,value:u[H],valueSpec:$,style:E,styleSpec:S,object:u,objectKey:H,validateSpec:R},u))}for(let H in p)v[H]||p[H].required&&p[H].default===void 0&&u[H]===void 0&&F.push(new Lt(a,u,`missing required property \"${H}\"`));return F}function Rd(h){let a=h.value,u=h.valueSpec,p=h.style,v=h.styleSpec,E=h.key,S=h.arrayElementValidator||h.validateSpec;if(cr(a)!==\"array\")return[new Lt(E,a,`array expected, ${cr(a)} found`)];if(u.length&&a.length!==u.length)return[new Lt(E,a,`array length ${u.length} expected, length ${a.length} found`)];let R={type:u.value,values:u.values};v.$version<7&&(R.function=u.function),cr(u.value)===\"object\"&&(R=u.value);let F=[];for(let U=0;U<a.length;U++)F=F.concat(S({array:a,arrayIndex:U,value:a[U],valueSpec:R,validateSpec:h.validateSpec,style:p,styleSpec:v,key:`${E}[${U}]`}));return F}function Bd(h){let a=h.key,u=h.value,p=h.valueSpec,v=cr(u);return v===\"number\"&&u!=u&&(v=\"NaN\"),v!==\"number\"?[new Lt(a,u,`number expected, ${v} found`)]:\"minimum\"in p&&u<p.minimum?[new Lt(a,u,`${u} is less than the minimum value ${p.minimum}`)]:\"maximum\"in p&&u>p.maximum?[new Lt(a,u,`${u} is greater than the maximum value ${p.maximum}`)]:[]}function w0(h){let a=h.valueSpec,u=uo(h.value.type),p,v,E,S={},R=u!==\"categorical\"&&h.value.property===void 0,F=!R,U=cr(h.value.stops)===\"array\"&&cr(h.value.stops[0])===\"array\"&&cr(h.value.stops[0][0])===\"object\",H=Fa({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(te){if(u===\"identity\")return[new Lt(te.key,te.value,'identity function may not have a \"stops\" property')];let oe=[],le=te.value;return oe=oe.concat(Rd({key:te.key,value:le,valueSpec:te.valueSpec,validateSpec:te.validateSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:X})),cr(le)===\"array\"&&le.length===0&&oe.push(new Lt(te.key,le,\"array must have at least one stop\")),oe},default:function(te){return te.validateSpec({key:te.key,value:te.value,valueSpec:a,validateSpec:te.validateSpec,style:te.style,styleSpec:te.styleSpec})}}});return u===\"identity\"&&R&&H.push(new Lt(h.key,h.value,'missing required property \"property\"')),u===\"identity\"||h.value.stops||H.push(new Lt(h.key,h.value,'missing required property \"stops\"')),u===\"exponential\"&&h.valueSpec.expression&&!Cg(h.valueSpec)&&H.push(new Lt(h.key,h.value,\"exponential functions not supported\")),h.styleSpec.$version>=8&&(F&&!bu(h.valueSpec)?H.push(new Lt(h.key,h.value,\"property functions not supported\")):R&&!y0(h.valueSpec)&&H.push(new Lt(h.key,h.value,\"zoom functions not supported\"))),u!==\"categorical\"&&!U||h.value.property!==void 0||H.push(new Lt(h.key,h.value,'\"property\" property is required')),H;function X(te){let oe=[],le=te.value,ue=te.key;if(cr(le)!==\"array\")return[new Lt(ue,le,`array expected, ${cr(le)} found`)];if(le.length!==2)return[new Lt(ue,le,`array length 2 expected, length ${le.length} found`)];if(U){if(cr(le[0])!==\"object\")return[new Lt(ue,le,`object expected, ${cr(le[0])} found`)];if(le[0].zoom===void 0)return[new Lt(ue,le,\"object stop key must have zoom\")];if(le[0].value===void 0)return[new Lt(ue,le,\"object stop key must have value\")];if(E&&E>uo(le[0].zoom))return[new Lt(ue,le[0].zoom,\"stop zoom values must appear in ascending order\")];uo(le[0].zoom)!==E&&(E=uo(le[0].zoom),v=void 0,S={}),oe=oe.concat(Fa({key:`${ue}[0]`,value:le[0],valueSpec:{zoom:{}},validateSpec:te.validateSpec,style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:Bd,value:$}}))}else oe=oe.concat($({key:`${ue}[0]`,value:le[0],validateSpec:te.validateSpec,style:te.style,styleSpec:te.styleSpec},le));return wu(Mh(le[1]))?oe.concat([new Lt(`${ue}[1]`,le[1],\"expressions are not allowed in function stops.\")]):oe.concat(te.validateSpec({key:`${ue}[1]`,value:le[1],valueSpec:a,validateSpec:te.validateSpec,style:te.style,styleSpec:te.styleSpec}))}function $(te,oe){let le=cr(te.value),ue=uo(te.value),me=te.value!==null?te.value:oe;if(p){if(le!==p)return[new Lt(te.key,me,`${le} stop domain type must match previous stop domain type ${p}`)]}else p=le;if(le!==\"number\"&&le!==\"string\"&&le!==\"boolean\")return[new Lt(te.key,me,\"stop domain value must be a number, string, or boolean\")];if(le!==\"number\"&&u!==\"categorical\"){let Le=`number expected, ${le} found`;return bu(a)&&u===void 0&&(Le+='\\nIf you intended to use a categorical function, specify `\"type\": \"categorical\"`.'),[new Lt(te.key,me,Le)]}return u!==\"categorical\"||le!==\"number\"||isFinite(ue)&&Math.floor(ue)===ue?u!==\"categorical\"&&le===\"number\"&&v!==void 0&&ue<v?[new Lt(te.key,me,\"stop domain values must appear in ascending order\")]:(v=ue,u===\"categorical\"&&ue in S?[new Lt(te.key,me,\"stop domain values must be unique\")]:(S[ue]=!0,[])):[new Lt(te.key,me,`integer expected, found ${ue}`)]}}function Ol(h){let a=(h.expressionContext===\"property\"?Ig:vf)(Mh(h.value),h.valueSpec);if(a.result===\"error\")return a.value.map((p=>new Lt(`${h.key}${p.key}`,h.value,p.message)));let u=a.value.expression||a.value._styleExpression.expression;if(h.expressionContext===\"property\"&&h.propertyKey===\"text-font\"&&!u.outputDefined())return[new Lt(h.key,h.value,`Invalid data expression for \"${h.propertyKey}\". Output values must be contained as literals within the expression.`)];if(h.expressionContext===\"property\"&&h.propertyType===\"layout\"&&!Td(u))return[new Lt(h.key,h.value,'\"feature-state\" data expressions are not supported with layout properties.')];if(h.expressionContext===\"filter\"&&!Td(u))return[new Lt(h.key,h.value,'\"feature-state\" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf(\"cluster\")===0){if(!_0(u,[\"zoom\",\"feature-state\"]))return[new Lt(h.key,h.value,'\"zoom\" and \"feature-state\" expressions are not supported with cluster properties.')];if(h.expressionContext===\"cluster-initial\"&&!m0(u))return[new Lt(h.key,h.value,\"Feature data expressions are not supported with initial expression part of cluster properties.\")]}return[]}function Dd(h){let a=h.key,u=h.value,p=cr(u);return p!==\"string\"?[new Lt(a,u,`color expected, ${p} found`)]:Zn.parse(String(u))?[]:[new Lt(a,u,`color expected, \"${u}\" found`)]}function Ih(h){let a=h.key,u=h.value,p=h.valueSpec,v=[];return Array.isArray(p.values)?p.values.indexOf(uo(u))===-1&&v.push(new Lt(a,u,`expected one of [${p.values.join(\", \")}], ${JSON.stringify(u)} found`)):Object.keys(p.values).indexOf(uo(u))===-1&&v.push(new Lt(a,u,`expected one of [${Object.keys(p.values).join(\", \")}], ${JSON.stringify(u)} found`)),v}function wf(h){return v0(Mh(h.value))?Ol(Ai({},h,{expressionContext:\"filter\",valueSpec:{value:\"boolean\"}})):Tf(h)}function Tf(h){let a=h.value,u=h.key;if(cr(a)!==\"array\")return[new Lt(u,a,`array expected, ${cr(a)} found`)];let p=h.styleSpec,v,E=[];if(a.length<1)return[new Lt(u,a,\"filter array must have at least 1 element\")];switch(E=E.concat(Ih({key:`${u}[0]`,value:a[0],valueSpec:p.filter_operator,style:h.style,styleSpec:h.styleSpec})),uo(a[0])){case\"<\":case\"<=\":case\">\":case\">=\":a.length>=2&&uo(a[1])===\"$type\"&&E.push(new Lt(u,a,`\"$type\" cannot be use with operator \"${a[0]}\"`));case\"==\":case\"!=\":a.length!==3&&E.push(new Lt(u,a,`filter array for operator \"${a[0]}\" must have 3 elements`));case\"in\":case\"!in\":a.length>=2&&(v=cr(a[1]),v!==\"string\"&&E.push(new Lt(`${u}[1]`,a[1],`string expected, ${v} found`)));for(let S=2;S<a.length;S++)v=cr(a[S]),uo(a[1])===\"$type\"?E=E.concat(Ih({key:`${u}[${S}]`,value:a[S],valueSpec:p.geometry_type,style:h.style,styleSpec:h.styleSpec})):v!==\"string\"&&v!==\"number\"&&v!==\"boolean\"&&E.push(new Lt(`${u}[${S}]`,a[S],`string, number, or boolean expected, ${v} found`));break;case\"any\":case\"all\":case\"none\":for(let S=1;S<a.length;S++)E=E.concat(Tf({key:`${u}[${S}]`,value:a[S],style:h.style,styleSpec:h.styleSpec}));break;case\"has\":case\"!has\":v=cr(a[1]),a.length!==2?E.push(new Lt(u,a,`filter array for \"${a[0]}\" operator must have 2 elements`)):v!==\"string\"&&E.push(new Lt(`${u}[1]`,a[1],`string expected, ${v} found`))}return E}function X_(h,a){let u=h.key,p=h.validateSpec,v=h.style,E=h.styleSpec,S=h.value,R=h.objectKey,F=E[`${a}_${h.layerType}`];if(!F)return[];let U=R.match(/^(.*)-transition$/);if(a===\"paint\"&&U&&F[U[1]]&&F[U[1]].transition)return p({key:u,value:S,valueSpec:E.transition,style:v,styleSpec:E});let H=h.valueSpec||F[R];if(!H)return[new Lt(u,S,`unknown property \"${R}\"`)];let X;if(cr(S)===\"string\"&&bu(H)&&!H.tokens&&(X=/^{([^}]+)}$/.exec(S)))return[new Lt(u,S,`\"${R}\" does not support interpolation syntax\nUse an identity property function instead: \\`{ \"type\": \"identity\", \"property\": ${JSON.stringify(X[1])} }\\`.`)];let $=[];return h.layerType===\"symbol\"&&R===\"text-font\"&&Ed(Mh(S))&&uo(S.type)===\"identity\"&&$.push(new Lt(u,S,'\"text-font\" does not support identity functions')),$.concat(p({key:h.key,value:S,valueSpec:H,style:v,styleSpec:E,expressionContext:\"property\",propertyType:a,propertyKey:R}))}function T0(h){return X_(h,\"paint\")}function Pg(h){return X_(h,\"layout\")}function Ph(h){let a=[],u=h.value,p=h.key,v=h.style,E=h.styleSpec;if(cr(u)!==\"object\")return[new Lt(p,u,`object expected, ${cr(u)} found`)];u.type||u.ref||a.push(new Lt(p,u,'either \"type\" or \"ref\" is required'));let S=uo(u.type),R=uo(u.ref);if(u.id){let F=uo(u.id);for(let U=0;U<h.arrayIndex;U++){let H=v.layers[U];uo(H.id)===F&&a.push(new Lt(p,u.id,`duplicate layer id \"${u.id}\", previously used at line ${H.id.__line__}`))}}if(\"ref\"in u){let F;[\"type\",\"source\",\"source-layer\",\"filter\",\"layout\"].forEach((U=>{U in u&&a.push(new Lt(p,u[U],`\"${U}\" is prohibited for ref layers`))})),v.layers.forEach((U=>{uo(U.id)===R&&(F=U)})),F?F.ref?a.push(new Lt(p,u.ref,\"ref cannot reference another ref layer\")):S=uo(F.type):a.push(new Lt(p,u.ref,`ref layer \"${R}\" not found`))}else if(S!==\"background\")if(u.source){let F=v.sources&&v.sources[u.source],U=F&&uo(F.type);F?U===\"vector\"&&S===\"raster\"?a.push(new Lt(p,u.source,`layer \"${u.id}\" requires a raster source`)):U!==\"raster-dem\"&&S===\"hillshade\"||U!==\"raster-dem\"&&S===\"color-relief\"?a.push(new Lt(p,u.source,`layer \"${u.id}\" requires a raster-dem source`)):U===\"raster\"&&S!==\"raster\"?a.push(new Lt(p,u.source,`layer \"${u.id}\" requires a vector source`)):U!==\"vector\"||u[\"source-layer\"]?U===\"raster-dem\"&&S!==\"hillshade\"&&S!==\"color-relief\"?a.push(new Lt(p,u.source,\"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.\")):S!==\"line\"||!u.paint||!u.paint[\"line-gradient\"]||U===\"geojson\"&&F.lineMetrics||a.push(new Lt(p,u,`layer \"${u.id}\" specifies a line-gradient, which requires a GeoJSON source with \\`lineMetrics\\` enabled.`)):a.push(new Lt(p,u,`layer \"${u.id}\" must specify a \"source-layer\"`)):a.push(new Lt(p,u.source,`source \"${u.source}\" not found`))}else a.push(new Lt(p,u,'missing required property \"source\"'));return a=a.concat(Fa({key:p,value:u,valueSpec:E.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{\"*\":()=>[],type:()=>h.validateSpec({key:`${p}.type`,value:u.type,valueSpec:E.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:u,objectKey:\"type\"}),filter:wf,layout:F=>Fa({layer:u,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,validateSpec:F.validateSpec,objectElementValidators:{\"*\":U=>Pg(Ai({layerType:S},U))}}),paint:F=>Fa({layer:u,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,validateSpec:F.validateSpec,objectElementValidators:{\"*\":U=>T0(Ai({layerType:S},U))}})}})),a}function Eu(h){let a=h.value,u=h.key,p=cr(a);return p!==\"string\"?[new Lt(u,a,`string expected, ${p} found`)]:[]}let Ld={promoteId:function({key:h,value:a}){if(cr(a)===\"string\")return Eu({key:h,value:a});{let u=[];for(let p in a)u.push(...Eu({key:`${h}.${p}`,value:a[p]}));return u}}};function E0(h){let a=h.value,u=h.key,p=h.styleSpec,v=h.style,E=h.validateSpec;if(!a.type)return[new Lt(u,a,'\"type\" is required')];let S=uo(a.type),R;switch(S){case\"vector\":case\"raster\":return R=Fa({key:u,value:a,valueSpec:p[`source_${S.replace(\"-\",\"_\")}`],style:h.style,styleSpec:p,objectElementValidators:Ld,validateSpec:E}),R;case\"raster-dem\":return R=(function(F){var U;let H=(U=F.sourceName)!==null&&U!==void 0?U:\"\",X=F.value,$=F.styleSpec,te=$.source_raster_dem,oe=F.style,le=[],ue=cr(X);if(X===void 0)return le;if(ue!==\"object\")return le.push(new Lt(\"source_raster_dem\",X,`object expected, ${ue} found`)),le;let me=uo(X.encoding)===\"custom\",Le=[\"redFactor\",\"greenFactor\",\"blueFactor\",\"baseShift\"],ye=F.value.encoding?`\"${F.value.encoding}\"`:\"Default\";for(let we in X)!me&&Le.includes(we)?le.push(new Lt(we,X[we],`In \"${H}\": \"${we}\" is only valid when \"encoding\" is set to \"custom\". ${ye} encoding found`)):te[we]?le=le.concat(F.validateSpec({key:we,value:X[we],valueSpec:te[we],validateSpec:F.validateSpec,style:oe,styleSpec:$})):le.push(new Lt(we,X[we],`unknown property \"${we}\"`));return le})({sourceName:u,value:a,style:h.style,styleSpec:p,validateSpec:E}),R;case\"geojson\":if(R=Fa({key:u,value:a,valueSpec:p.source_geojson,style:v,styleSpec:p,validateSpec:E,objectElementValidators:Ld}),a.cluster)for(let F in a.clusterProperties){let[U,H]=a.clusterProperties[F],X=typeof U==\"string\"?[U,[\"accumulated\"],[\"get\",F]]:U;R.push(...Ol({key:`${u}.${F}.map`,value:H,expressionContext:\"cluster-map\"})),R.push(...Ol({key:`${u}.${F}.reduce`,value:X,expressionContext:\"cluster-reduce\"}))}return R;case\"video\":return Fa({key:u,value:a,valueSpec:p.source_video,style:v,validateSpec:E,styleSpec:p});case\"image\":return Fa({key:u,value:a,valueSpec:p.source_image,style:v,validateSpec:E,styleSpec:p});case\"canvas\":return[new Lt(u,null,\"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.\",\"source.canvas\")];default:return Ih({key:`${u}.type`,value:a.type,valueSpec:{values:[\"vector\",\"raster\",\"raster-dem\",\"geojson\",\"video\",\"image\"]}})}}function Od(h){let a=h.value,u=h.styleSpec,p=u.light,v=h.style,E=[],S=cr(a);if(a===void 0)return E;if(S!==\"object\")return E=E.concat([new Lt(\"light\",a,`object expected, ${S} found`)]),E;for(let R in a){let F=R.match(/^(.*)-transition$/);E=E.concat(F&&p[F[1]]&&p[F[1]].transition?h.validateSpec({key:R,value:a[R],valueSpec:u.transition,validateSpec:h.validateSpec,style:v,styleSpec:u}):p[R]?h.validateSpec({key:R,value:a[R],valueSpec:p[R],validateSpec:h.validateSpec,style:v,styleSpec:u}):[new Lt(R,a[R],`unknown property \"${R}\"`)])}return E}function Rg(h){let a=h.value,u=h.styleSpec,p=u.sky,v=h.style,E=cr(a);if(a===void 0)return[];if(E!==\"object\")return[new Lt(\"sky\",a,`object expected, ${E} found`)];let S=[];for(let R in a)S=S.concat(p[R]?h.validateSpec({key:R,value:a[R],valueSpec:p[R],style:v,styleSpec:u}):[new Lt(R,a[R],`unknown property \"${R}\"`)]);return S}function Bg(h){let a=h.value,u=h.styleSpec,p=u.terrain,v=h.style,E=[],S=cr(a);if(a===void 0)return E;if(S!==\"object\")return E=E.concat([new Lt(\"terrain\",a,`object expected, ${S} found`)]),E;for(let R in a)E=E.concat(p[R]?h.validateSpec({key:R,value:a[R],valueSpec:p[R],validateSpec:h.validateSpec,style:v,styleSpec:u}):[new Lt(R,a[R],`unknown property \"${R}\"`)]);return E}function Dg(h){let a=[],u=h.value,p=h.key;if(Array.isArray(u)){let v=[],E=[];for(let S in u)u[S].id&&v.includes(u[S].id)&&a.push(new Lt(p,u,`all the sprites' ids must be unique, but ${u[S].id} is duplicated`)),v.push(u[S].id),u[S].url&&E.includes(u[S].url)&&a.push(new Lt(p,u,`all the sprites' URLs must be unique, but ${u[S].url} is duplicated`)),E.push(u[S].url),a=a.concat(Fa({key:`${p}[${S}]`,value:u[S],valueSpec:{id:{type:\"string\",required:!0},url:{type:\"string\",required:!0}},validateSpec:h.validateSpec}));return a}return Eu({key:p,value:u})}function S0(h){return!!h&&h.constructor===Object}function Lg(h){return S0(h.value)?[]:[new Lt(h.key,h.value,`object expected, ${cr(h.value)} found`)]}let Fd={\"*\":()=>[],array:Rd,boolean:function(h){let a=h.value,u=h.key,p=cr(a);return p!==\"boolean\"?[new Lt(u,a,`boolean expected, ${p} found`)]:[]},number:Bd,color:Dd,constants:j_,enum:Ih,filter:wf,function:w0,layer:Ph,object:Fa,source:E0,light:Od,sky:Rg,terrain:Bg,projection:function(h){let a=h.value,u=h.styleSpec,p=u.projection,v=h.style,E=cr(a);if(a===void 0)return[];if(E!==\"object\")return[new Lt(\"projection\",a,`object expected, ${E} found`)];let S=[];for(let R in a)S=S.concat(p[R]?h.validateSpec({key:R,value:a[R],valueSpec:p[R],style:v,styleSpec:u}):[new Lt(R,a[R],`unknown property \"${R}\"`)]);return S},projectionDefinition:function(h){let a=h.key,u=h.value;u=u instanceof String?u.valueOf():u;let p=cr(u);return p!==\"array\"||(function(v){return Array.isArray(v)&&v.length===3&&typeof v[0]==\"string\"&&typeof v[1]==\"string\"&&typeof v[2]==\"number\"})(u)||(function(v){return!![\"interpolate\",\"step\",\"literal\"].includes(v[0])})(u)?[\"array\",\"string\"].includes(p)?[]:[new Lt(a,u,`projection expected, invalid type \"${p}\" found`)]:[new Lt(a,u,`projection expected, invalid array ${JSON.stringify(u)} found`)]},string:Eu,formatted:function(h){return Eu(h).length===0?[]:Ol(h)},resolvedImage:function(h){return Eu(h).length===0?[]:Ol(h)},padding:function(h){let a=h.key,u=h.value;if(cr(u)===\"array\"){if(u.length<1||u.length>4)return[new Lt(a,u,`padding requires 1 to 4 values; ${u.length} values found`)];let p={type:\"number\"},v=[];for(let E=0;E<u.length;E++)v=v.concat(h.validateSpec({key:`${a}[${E}]`,value:u[E],validateSpec:h.validateSpec,valueSpec:p}));return v}return Bd({key:a,value:u,valueSpec:{}})},numberArray:function(h){let a=h.key,u=h.value;if(cr(u)===\"array\"){let p={type:\"number\"};if(u.length<1)return[new Lt(a,u,\"array length at least 1 expected, length 0 found\")];let v=[];for(let E=0;E<u.length;E++)v=v.concat(h.validateSpec({key:`${a}[${E}]`,value:u[E],validateSpec:h.validateSpec,valueSpec:p}));return v}return Bd({key:a,value:u,valueSpec:{}})},colorArray:function(h){let a=h.key,u=h.value;if(cr(u)===\"array\"){if(u.length<1)return[new Lt(a,u,\"array length at least 1 expected, length 0 found\")];let p=[];for(let v=0;v<u.length;v++)p=p.concat(Dd({key:`${a}[${v}]`,value:u[v]}));return p}return Dd({key:a,value:u})},variableAnchorOffsetCollection:function(h){let a=h.key,u=h.value,p=cr(u),v=h.styleSpec;if(p!==\"array\"||u.length<1||u.length%2!=0)return[new Lt(a,u,\"variableAnchorOffsetCollection requires a non-empty array of even length\")];let E=[];for(let S=0;S<u.length;S+=2)E=E.concat(Ih({key:`${a}[${S}]`,value:u[S],valueSpec:v.layout_symbol[\"text-anchor\"]})),E=E.concat(Rd({key:`${a}[${S+1}]`,value:u[S+1],valueSpec:{length:2,value:\"number\"},validateSpec:h.validateSpec,style:h.style,styleSpec:v}));return E},sprite:Dg,state:Lg,fontFaces:function(h){let a=h.key,u=h.value,p=h.validateSpec,v=h.styleSpec,E=h.style;if(!S0(u))return[new Lt(a,u,`object expected, ${cr(u)} found`)];let S=[];for(let R in u){let F=u[R],U=cr(F);if(U===\"string\")S.push(...Eu({key:`${a}.${R}`,value:F}));else if(U===\"array\"){let H={url:{type:\"string\",required:!0},\"unicode-range\":{type:\"array\",value:\"string\"}};for(let[X,$]of F.entries())S.push(...Fa({key:`${a}.${R}[${X}]`,value:$,valueSpec:H,styleSpec:v,style:E,validateSpec:p}))}else S.push(new Lt(`${a}.${R}`,F,`string or array expected, ${U} found`))}return S}};function cc(h){let a=h.value,u=h.valueSpec,p=h.styleSpec;return h.validateSpec=cc,u.expression&&Ed(uo(a))?w0(h):u.expression&&wu(Mh(a))?Ol(h):u.type&&Fd[u.type]?Fd[u.type](h):Fa(Ai({},h,{valueSpec:u.type?p[u.type]:u}))}function Ef(h){let a=h.value,u=h.key,p=Eu(h);return p.length||(a.indexOf(\"{fontstack}\")===-1&&p.push(new Lt(u,a,'\"glyphs\" url must include a \"{fontstack}\" token')),a.indexOf(\"{range}\")===-1&&p.push(new Lt(u,a,'\"glyphs\" url must include a \"{range}\" token'))),p}function dr(h,a=Ke){let u=[];return u=u.concat(cc({key:\"\",value:h,valueSpec:a.$root,styleSpec:a,style:h,validateSpec:cc,objectElementValidators:{glyphs:Ef,\"*\":()=>[]}})),h.constants&&(u=u.concat(j_({key:\"constants\",value:h.constants}))),Og(u)}function Fl(h){return function(a){return h(Object.assign({},a,{validateSpec:cc}))}}function Og(h){return[].concat(h).sort(((a,u)=>a.line-u.line))}function ol(h){return function(...a){return Og(h.apply(this,a))}}dr.source=ol(Fl(E0)),dr.sprite=ol(Fl(Dg)),dr.glyphs=ol(Fl(Ef)),dr.light=ol(Fl(Od)),dr.sky=ol(Fl(Rg)),dr.terrain=ol(Fl(Bg)),dr.state=ol(Fl(Lg)),dr.layer=ol(Fl(Ph)),dr.filter=ol(Fl(wf)),dr.paintProperty=ol(Fl(T0)),dr.layoutProperty=ol(Fl(Pg));let Tx={type:\"enum\",\"property-type\":\"data-constant\",expression:{interpolated:!1,parameters:[\"global-state\"]},values:{visible:{},none:{}},transition:!1,default:\"visible\"};class kd{constructor(a,u){this._globalState=u,this.setValue(a)}evaluate(){var a;return(a=this._literalValue)!==null&&a!==void 0?a:this._compiledValue.evaluate({})}setValue(a){if(a==null||a===\"visible\"||a===\"none\")return this._literalValue=a===\"none\"?\"none\":\"visible\",this._compiledValue=void 0,void(this._globalStateRefs=new Set);let u=vf(a,Tx,this._globalState);if(u.result===\"error\")throw this._literalValue=\"visible\",this._compiledValue=void 0,new Error(u.value.map((p=>`${p.key}: ${p.message}`)).join(\", \"));this._literalValue=void 0,this._compiledValue=u.value,this._globalStateRefs=Ll(u.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}let Nd=Ke,es=dr,ts=es.light,C0=es.sky,Rh=es.paintProperty,Ex=es.layoutProperty;function Su(h,a){let u=!1;if(a&&a.length)for(let p of a)h.fire(new vt(new Error(p.message))),u=!0;return u}class Sf{constructor(a,u,p){let v=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;let S=new Int32Array(this.arrayBuffer);a=S[0],this.d=(u=S[1])+2*(p=S[2]);for(let F=0;F<this.d*this.d;F++){let U=S[3+F],H=S[3+F+1];v.push(U===H?null:S.subarray(U,H))}let R=S[3+v.length+1];this.keys=S.subarray(S[3+v.length],R),this.bboxes=S.subarray(R),this.insert=this._insertReadonly}else{this.d=u+2*p;for(let S=0;S<this.d*this.d;S++)v.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=a,this.padding=p,this.scale=u/a,this.uid=0;let E=p/u*a;this.min=-E,this.max=a+E}insert(a,u,p,v,E){this._forEachCell(u,p,v,E,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(E)}_insertReadonly(){throw new Error(\"Cannot insert into a GridIndex created from an ArrayBuffer.\")}_insertCell(a,u,p,v,E,S){this.cells[E].push(S)}query(a,u,p,v,E){let S=this.min,R=this.max;if(a<=S&&u<=S&&R<=p&&R<=v&&!E)return Array.prototype.slice.call(this.keys);{let F=[];return this._forEachCell(a,u,p,v,this._queryCell,F,{},E),F}}_queryCell(a,u,p,v,E,S,R,F){let U=this.cells[E];if(U!==null){let H=this.keys,X=this.bboxes;for(let $=0;$<U.length;$++){let te=U[$];if(R[te]===void 0){let oe=4*te;(F?F(X[oe+0],X[oe+1],X[oe+2],X[oe+3]):a<=X[oe+2]&&u<=X[oe+3]&&p>=X[oe+0]&&v>=X[oe+1])?(R[te]=!0,S.push(H[te])):R[te]=!1}}}}_forEachCell(a,u,p,v,E,S,R,F){let U=this._convertToCellCoord(a),H=this._convertToCellCoord(u),X=this._convertToCellCoord(p),$=this._convertToCellCoord(v);for(let te=U;te<=X;te++)for(let oe=H;oe<=$;oe++){let le=this.d*oe+te;if((!F||F(this._convertFromCellCoord(te),this._convertFromCellCoord(oe),this._convertFromCellCoord(te+1),this._convertFromCellCoord(oe+1)))&&E.call(this,a,u,p,v,le,S,R,F))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let a=this.cells,u=3+this.cells.length+1+1,p=0;for(let S=0;S<this.cells.length;S++)p+=this.cells[S].length;let v=new Int32Array(u+p+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;let E=u;for(let S=0;S<a.length;S++){let R=a[S];v[3+S]=E,v.set(R,E),E+=R.length}return v[3+a.length]=E,v.set(this.keys,E),E+=this.keys.length,v[3+a.length+1]=E,v.set(this.bboxes,E),E+=this.bboxes.length,v.buffer}static serialize(a,u){let p=a.toArrayBuffer();return u&&u.push(p),{buffer:p}}static deserialize(a){return new Sf(a.buffer)}}let ho={};function un(h,a,u={}){if(ho[h])throw new Error(`${h} is already registered.`);Object.defineProperty(a,\"_classRegistryKey\",{value:h,writeable:!1}),ho[h]={klass:a,omit:u.omit||[],shallow:u.shallow||[]}}un(\"Object\",Object),un(\"Set\",Set),un(\"TransferableGridIndex\",Sf),un(\"Color\",Zn),un(\"Error\",Error),un(\"AJAXError\",ze),un(\"ResolvedImage\",nl),un(\"StylePropertyFunction\",x0),un(\"StyleExpression\",ps,{omit:[\"_evaluator\"]}),un(\"ZoomDependentExpression\",Mg),un(\"ZoomConstantExpression\",Sh),un(\"CompoundExpression\",il,{omit:[\"_evaluate\"]});for(let h in Th)Th[h]._classRegistryKey||un(`Expression_${h}`,Th[h]);function Cf(h){return h&&typeof ArrayBuffer<\"u\"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name===\"ArrayBuffer\")}function Cu(h){return h.$name||h.constructor._classRegistryKey}function sl(h){return!(function(a){if(a===null||typeof a!=\"object\")return!1;let u=Cu(a);return!(!u||u===\"Object\")})(h)&&(h==null||typeof h==\"boolean\"||typeof h==\"number\"||typeof h==\"string\"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||h instanceof Error||Cf(h)||Yr(h)||ArrayBuffer.isView(h)||h instanceof ImageData)}function uc(h,a){if(sl(h))return(Cf(h)||Yr(h))&&a&&a.push(h),ArrayBuffer.isView(h)&&a&&a.push(h.buffer),h instanceof ImageData&&a&&a.push(h.data.buffer),h;if(Array.isArray(h)){let E=[];for(let S of h)E.push(uc(S,a));return E}if(typeof h!=\"object\")throw new Error(\"can't serialize object of type \"+typeof h);let u=Cu(h);if(!u)throw new Error(`can't serialize object of unregistered class ${h.constructor.name}`);if(!ho[u])throw new Error(`${u} is not registered.`);let{klass:p}=ho[u],v=p.serialize?p.serialize(h,a):{};if(p.serialize){if(a&&v===a[a.length-1])throw new Error(\"statically serialized object won't survive transfer of $name property\")}else{for(let E in h){if(!h.hasOwnProperty(E)||ho[u].omit.indexOf(E)>=0)continue;let S=h[E];v[E]=ho[u].shallow.indexOf(E)>=0?S:uc(S,a)}h instanceof Error&&(v.message=h.message)}if(v.$name)throw new Error(\"$name property is reserved for worker serialization logic.\");return u!==\"Object\"&&(v.$name=u),v}function zd(h){if(sl(h))return h;if(Array.isArray(h))return h.map(zd);if(typeof h!=\"object\")throw new Error(\"can't deserialize object of type \"+typeof h);let a=Cu(h)||\"Object\";if(!ho[a])throw new Error(`can't deserialize unregistered class ${a}`);let{klass:u}=ho[a];if(!u)throw new Error(`can't deserialize unregistered class ${a}`);if(u.deserialize)return u.deserialize(h);let p=Object.create(u.prototype);for(let v of Object.keys(h)){if(v===\"$name\")continue;let E=h[v];p[v]=ho[a].shallow.indexOf(v)>=0?E:zd(E)}return p}class M0{constructor(){this.first=!0}update(a,u){let p=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=u),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=p,!0))}}function Ud(h){return/[\\u02EA\\u02EB\\u2E80-\\u2FDF\\u2FF0-\\u303F\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FD-\\u30FF\\u3105-\\u312F\\u31A0-\\u4DBF\\u4E00-\\uA48C\\uA490-\\uA4C6\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFE10-\\uFE1F\\uFE30-\\uFE4F\\uFF00-\\uFFEF]|\\uD81B[\\uDFE0-\\uDFFF]|[\\uD81C-\\uD822\\uD840-\\uD868\\uD86A-\\uD86D\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883\\uD885-\\uD88C][\\uDC00-\\uDFFF]|\\uD823[\\uDC00-\\uDCD5\\uDCFF-\\uDD1E\\uDD80-\\uDDF2]|\\uD82B[\\uDFF0-\\uDFFF]|\\uD82C[\\uDC00-\\uDEFB]|\\uD83C[\\uDE00-\\uDEFF]|\\uD869[\\uDC00-\\uDEDF\\uDF00-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEAD\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0\\uDFF0-\\uDFFF]|\\uD87B[\\uDC00-\\uDE5D]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A\\uDF50-\\uDFFF]|\\uD88D[\\uDC00-\\uDC79]/gim.test(String.fromCodePoint(h))}function Vd(h){return/[\\u02EA\\u02EB\\u1100-\\u11FF\\u1400-\\u167F\\u18B0-\\u18F5\\u2E80-\\u2E99\\u2E9B-\\u2EF3\\u2F00-\\u2FD5\\u2FF0-\\u3007\\u3012\\u3013\\u3020-\\u302F\\u3031-\\u303F\\u3041-\\u3096\\u309D-\\u30FB\\u30FD-\\u30FF\\u3105-\\u312F\\u3131-\\u318E\\u3190-\\uA48C\\uA490-\\uA4C6\\uA960-\\uA97C\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFE10-\\uFE1F\\uFE30-\\uFE48\\uFE50-\\uFE57\\uFE5F-\\uFE62\\uFE67-\\uFE6F\\uFF00-\\uFF07\\uFF0A-\\uFF0C\\uFF0E-\\uFF19\\uFF1F-\\uFF3A\\uFF3C\\uFF3E\\uFF40-\\uFF5A\\uFFE0-\\uFFE2\\uFFE4-\\uFFE7]|\\uD802[\\uDD80-\\uDD9F]|\\uD805[\\uDD80-\\uDDFF]|\\uD806[\\uDE00-\\uDEBF]|\\uD811[\\uDC00-\\uDE7F]|\\uD81B[\\uDFE0-\\uDFE4\\uDFF0-\\uDFF6]|[\\uD81C-\\uD822\\uD83D\\uD840-\\uD868\\uD86A-\\uD86D\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883\\uD885-\\uD88C][\\uDC00-\\uDFFF]|\\uD823[\\uDC00-\\uDCD5\\uDCFF-\\uDD1E\\uDD80-\\uDDF2]|\\uD82B[\\uDFF0-\\uDFF3\\uDFF5-\\uDFFB\\uDFFD\\uDFFE]|\\uD82C[\\uDC00-\\uDD22\\uDD30-\\uDEFB]|\\uD833[\\uDEC0-\\uDFCF]|\\uD834[\\uDC00-\\uDDFF\\uDEE0-\\uDF7F]|\\uD836[\\uDC00-\\uDEAF]|\\uD83C[\\uDC00-\\uDE00\\uDF00-\\uDFFF]|\\uD83E[\\uDD00-\\uDEFF]|\\uD869[\\uDC00-\\uDEDF\\uDF00-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEAD\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0\\uDFF0-\\uDFFF]|\\uD87B[\\uDC00-\\uDE5D]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A\\uDF50-\\uDFFF]|\\uD88D[\\uDC00-\\uDC79]/gim.test(String.fromCodePoint(h))}function Y_(h){return/\\s/u.test(String.fromCodePoint(h))}function Mf(h){for(let a of h)if(Vd(a.codePointAt(0)))return!0;return!1}function Fg(h){for(let a of h)if(!Pf(a.codePointAt(0)))return!1;return!0}function Gd(h){let a=h.map((u=>{try{return new RegExp(`\\\\p{sc=${u}}`,\"u\").source}catch{return null}})).filter((u=>u));return new RegExp(a.join(\"|\"),\"u\")}let If=Gd([\"Arab\",\"Dupl\",\"Mong\",\"Ougr\",\"Syrc\"]);function Pf(h){return!If.test(String.fromCodePoint(h))}function Mu(h){return!(Vd(h)||(a=h,/[\\xA7\\xA9\\xAE\\xB1\\xBC-\\xBE\\xD7\\xF7\\u2016\\u2020\\u2021\\u2030\\u2031\\u203B\\u203C\\u2042\\u2047-\\u2049\\u2051\\u2100-\\u218F\\u221E\\u2234\\u2235\\u2300-\\u2307\\u230C-\\u231F\\u2324-\\u2328\\u232B\\u237D-\\u239A\\u23BE-\\u23CD\\u23CF\\u23D1-\\u23DB\\u23E2-\\u2422\\u2424-\\u24FF\\u25A0-\\u2619\\u2620-\\u2767\\u2776-\\u2793\\u2B12-\\u2B2F\\u2B50-\\u2B59\\u2BB8-\\u2BEB\\u3000-\\u303F\\u30A0-\\u30FF\\uE000-\\uF8FF\\uFE30-\\uFE6F\\uFF00-\\uFFEF\\uFFFC\\uFFFD]|[\\uDB80-\\uDBFF][\\uDC00-\\uDFFF]/gim.test(String.fromCodePoint(a))));var a}let ca=Gd([\"Adlm\",\"Arab\",\"Armi\",\"Avst\",\"Chrs\",\"Cprt\",\"Egyp\",\"Elym\",\"Gara\",\"Hatr\",\"Hebr\",\"Hung\",\"Khar\",\"Lydi\",\"Mand\",\"Mani\",\"Mend\",\"Merc\",\"Mero\",\"Narb\",\"Nbat\",\"Nkoo\",\"Orkh\",\"Palm\",\"Phli\",\"Phlp\",\"Phnx\",\"Prti\",\"Rohg\",\"Samr\",\"Sarb\",\"Sogo\",\"Syrc\",\"Thaa\",\"Todr\",\"Yezi\"]);function kg(h){return ca.test(String.fromCodePoint(h))}function Bh(h,a){return!(!a&&kg(h)||/[\\u0900-\\u0DFF\\u0F00-\\u109F\\u1780-\\u17FF]/gim.test(String.fromCodePoint(h)))}function Z_(h){for(let a of h)if(kg(a.codePointAt(0)))return!0;return!1}let Iu=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus=\"unavailable\",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(h){this.pluginStatus=h.pluginStatus,this.pluginURL=h.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(h){if(Iu.isParsed())throw new Error(\"RTL text plugin already registered.\");this.applyArabicShaping=h.applyArabicShaping,this.processBidirectionalText=h.processBidirectionalText,this.processStyledBidirectionalText=h.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(h,a){return o(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(h.pluginStatus!==\"loading\")return this.setState(h),h;let u=h.pluginURL,p=new Promise((E=>{this.loadScriptResolve=E}));a(u);let v=new Promise((E=>setTimeout((()=>E()),this.TIMEOUT)));if(yield Promise.race([p,v]),this.isParsed()){let E={pluginStatus:\"loaded\",pluginURL:u};return this.setState(E),E}throw this.setState({pluginStatus:\"error\",pluginURL:\"\"}),new Error(`RTL Text Plugin failed to import scripts from ${u}`)}))}};class ci{constructor(a,u){this.isSupportedScript=q_,this.zoom=a,u?(this.now=u.now||0,this.fadeDuration=u.fadeDuration||0,this.zoomHistory=u.zoomHistory||new M0,this.transition=u.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new M0,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let a=this.zoom,u=a-Math.floor(a),p=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*u}}}function q_(h){return(function(a,u){for(let p of a)if(!Bh(p.codePointAt(0),u))return!1;return!0})(h,Iu.getRTLTextPluginStatus()===\"loaded\")}let Hd=\"-transition\";class I0{constructor(a,u,p){this.property=a,this.value=u,this.expression=(function(v,E,S){if(Ed(v))return new x0(v,E);if(wu(v)){let R=Ig(v,E,S);if(R.result===\"error\")throw new Error(R.value.map((F=>`${F.key}: ${F.message}`)).join(\", \"));return R.value}{let R=v;return E.type===\"color\"&&typeof v==\"string\"?R=Zn.parse(v):E.type!==\"padding\"||typeof v!=\"number\"&&!Array.isArray(v)?E.type!==\"numberArray\"||typeof v!=\"number\"&&!Array.isArray(v)?E.type!==\"colorArray\"||typeof v!=\"string\"&&!Array.isArray(v)?E.type===\"variableAnchorOffsetCollection\"&&Array.isArray(v)?R=ia.parse(v):E.type===\"projectionDefinition\"&&typeof v==\"string\"&&(R=oa.parse(v)):R=Bn.parse(v):R=Kn.parse(v):R=si.parse(v),{globalStateRefs:new Set,_globalState:null,kind:\"constant\",evaluate:()=>R}}})(u===void 0?a.specification.default:u,a.specification,p)}isDataDriven(){return this.expression.kind===\"source\"||this.expression.kind===\"composite\"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(a,u,p){return this.property.possiblyEvaluate(this,a,u,p)}}class P0{constructor(a,u){this.property=a,this.value=new I0(a,void 0,u)}transitioned(a,u){return new Ng(this.property,this.value,u,Fn({},a.transition,this.transition),a.now)}untransitioned(){return new Ng(this.property,this.value,null,{},0)}}class Rf{constructor(a,u){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues),this._globalState=u}getValue(a){return oi(this._values[a].value.value)}setValue(a,u){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new P0(this._values[a].property,this._globalState)),this._values[a].value=new I0(this._values[a].property,u===null?void 0:oi(u),this._globalState)}getTransition(a){return oi(this._values[a].transition)}setTransition(a,u){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new P0(this._values[a].property,this._globalState)),this._values[a].transition=oi(u)||void 0}serialize(){let a={};for(let u of Object.keys(this._values)){let p=this.getValue(u);p!==void 0&&(a[u]=p);let v=this.getTransition(u);v!==void 0&&(a[`${u}${Hd}`]=v)}return a}transitioned(a,u){let p=new R0(this._properties);for(let v of Object.keys(this._values))p._values[v]=this._values[v].transitioned(a,u._values[v]);return p}untransitioned(){let a=new R0(this._properties);for(let u of Object.keys(this._values))a._values[u]=this._values[u].untransitioned();return a}}class Ng{constructor(a,u,p,v,E){this.property=a,this.value=u,this.begin=E+v.delay||0,this.end=this.begin+v.duration||0,a.specification.transition&&(v.delay||v.duration)&&(this.prior=p)}possiblyEvaluate(a,u,p){let v=a.now||0,E=this.value.possiblyEvaluate(a,u,p),S=this.prior;if(S){if(v>this.end)return this.prior=null,E;if(this.value.isDataDriven())return this.prior=null,E;if(v<this.begin)return S.possiblyEvaluate(a,u,p);{let R=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(a,u,p),E,_n(R))}}return E}}class R0{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,u,p){let v=new Wd(this._properties);for(let E of Object.keys(this._values))v._values[E]=this._values[E].possiblyEvaluate(a,u,p);return v}hasTransition(){for(let a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class Q_{constructor(a,u){this._properties=a,this._values=Object.create(a.defaultPropertyValues),this._globalState=u}hasValue(a){return this._values[a].value!==void 0}getValue(a){return oi(this._values[a].value)}setValue(a,u){this._values[a]=new I0(this._values[a].property,u===null?void 0:oi(u),this._globalState)}serialize(){let a={};for(let u of Object.keys(this._values)){let p=this.getValue(u);p!==void 0&&(a[u]=p)}return a}possiblyEvaluate(a,u,p){let v=new Wd(this._properties);for(let E of Object.keys(this._values))v._values[E]=this._values[E].possiblyEvaluate(a,u,p);return v}}class kl{constructor(a,u,p){this.property=a,this.value=u,this.parameters=p}isConstant(){return this.value.kind===\"constant\"}constantOr(a){return this.value.kind===\"constant\"?this.value.value:a}evaluate(a,u,p,v){return this.property.evaluate(this.value,this.parameters,a,u,p,v)}}class Wd{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class yn{constructor(a){this.specification=a}possiblyEvaluate(a,u){if(a.isDataDriven())throw new Error(\"Value should not be data driven\");return a.expression.evaluate(u)}interpolate(a,u,p){let v=ji[this.specification.type];return v?v(a,u,p):a}}class Rn{constructor(a,u){this.specification=a,this.overrides=u}possiblyEvaluate(a,u,p,v){return new kl(this,a.expression.kind===\"constant\"||a.expression.kind===\"camera\"?{kind:\"constant\",value:a.expression.evaluate(u,null,{},p,v)}:a.expression,u)}interpolate(a,u,p){if(a.value.kind!==\"constant\"||u.value.kind!==\"constant\")return a;if(a.value.value===void 0||u.value.value===void 0)return new kl(this,{kind:\"constant\",value:void 0},a.parameters);let v=ji[this.specification.type];if(v){let E=v(a.value.value,u.value.value,p);return new kl(this,{kind:\"constant\",value:E},a.parameters)}return a}evaluate(a,u,p,v,E,S){return a.kind===\"constant\"?a.value:a.evaluate(u,p,v,E,S)}}class jd extends Rn{possiblyEvaluate(a,u,p,v){if(a.value===void 0)return new kl(this,{kind:\"constant\",value:void 0},u);if(a.expression.kind===\"constant\"){let E=a.expression.evaluate(u,null,{},p,v),S=a.property.specification.type===\"resolvedImage\"&&typeof E!=\"string\"?E.name:E,R=this._calculate(S,S,S,u);return new kl(this,{kind:\"constant\",value:R},u)}if(a.expression.kind===\"camera\"){let E=this._calculate(a.expression.evaluate({zoom:u.zoom-1}),a.expression.evaluate({zoom:u.zoom}),a.expression.evaluate({zoom:u.zoom+1}),u);return new kl(this,{kind:\"constant\",value:E},u)}return new kl(this,a.expression,u)}evaluate(a,u,p,v,E,S){if(a.kind===\"source\"){let R=a.evaluate(u,p,v,E,S);return this._calculate(R,R,R,u)}return a.kind===\"composite\"?this._calculate(a.evaluate({zoom:Math.floor(u.zoom)-1},p,v),a.evaluate({zoom:Math.floor(u.zoom)},p,v),a.evaluate({zoom:Math.floor(u.zoom)+1},p,v),u):a.value}_calculate(a,u,p,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:a,to:u}:{from:p,to:u}}interpolate(a){return a}}class B0{constructor(a){this.specification=a}possiblyEvaluate(a,u,p,v){if(a.value!==void 0){if(a.expression.kind===\"constant\"){let E=a.expression.evaluate(u,null,{},p,v);return this._calculate(E,E,E,u)}return this._calculate(a.expression.evaluate(new ci(Math.floor(u.zoom-1),u)),a.expression.evaluate(new ci(Math.floor(u.zoom),u)),a.expression.evaluate(new ci(Math.floor(u.zoom+1),u)),u)}}_calculate(a,u,p,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:a,to:u}:{from:p,to:u}}interpolate(a){return a}}class Xd{constructor(a){this.specification=a}possiblyEvaluate(a,u,p,v){return!!a.expression.evaluate(u,null,{},p,v)}interpolate(){return!1}}class qs{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let u in a){let p=a[u];p.specification.overridable&&this.overridableProperties.push(u);let v=this.defaultPropertyValues[u]=new I0(p,void 0,void 0),E=this.defaultTransitionablePropertyValues[u]=new P0(p,void 0);this.defaultTransitioningPropertyValues[u]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=v.possiblyEvaluate({})}}}un(\"DataDrivenProperty\",Rn),un(\"DataConstantProperty\",yn),un(\"CrossFadedDataDrivenProperty\",jd),un(\"CrossFadedProperty\",B0),un(\"ColorRampProperty\",Xd);class ka extends Vt{constructor(a,u,p){if(super(),this.id=a.id,this.type=a.type,this._globalState=p,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=(function(v,E){return new kd(v,E)})(this.visibility,p),a.type!==\"custom\"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!==\"background\"&&(this.source=a.source,this.sourceLayer=a[\"source-layer\"],this.filter=a.filter,this._featureFilter=Tu(a.filter,p)),u.layout&&(this._unevaluatedLayout=new Q_(u.layout,p)),u.paint)){this._transitionablePaint=new Rf(u.paint,p);for(let v in a.paint)this.setPaintProperty(v,a.paint[v],{validate:!1});for(let v in a.layout)this.setLayoutProperty(v,a.layout[v],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wd(u.paint)}}setFilter(a){this.filter=a,this._featureFilter=Tu(a,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a===\"visibility\"?this.visibility:this._unevaluatedLayout.getValue(a)}getLayoutAffectingGlobalStateRefs(){let a=new Set;for(let u of this._visibilityExpression.getGlobalStateRefs())a.add(u);if(this._unevaluatedLayout)for(let u in this._unevaluatedLayout._values){let p=this._unevaluatedLayout._values[u];for(let v of p.getGlobalStateRefs())a.add(v)}for(let u of this._featureFilter.getGlobalStateRefs())a.add(u);return a}getPaintAffectingGlobalStateRefs(){var a;let u=new globalThis.Map;if(this._transitionablePaint)for(let p in this._transitionablePaint._values){let v=this._transitionablePaint._values[p].value;for(let E of v.getGlobalStateRefs()){let S=(a=u.get(E))!==null&&a!==void 0?a:[];S.push({name:p,value:v.value}),u.set(E,S)}}return u}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(a,u,p={}){if(u==null||!this._validate(Ex,`layers.${this.id}.layout.${a}`,a,u,p))return a===\"visibility\"?(this.visibility=u,this._visibilityExpression.setValue(u),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(a,u)}getPaintProperty(a){return a.endsWith(Hd)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,u,p={}){if(u!=null&&this._validate(Rh,`layers.${this.id}.paint.${a}`,a,u,p))return!1;if(a.endsWith(Hd))return this._transitionablePaint.setTransition(a.slice(0,-11),u||void 0),!1;{let v=this._transitionablePaint._values[a],E=v.property.specification[\"property-type\"]===\"cross-faded-data-driven\",S=v.value.isDataDriven(),R=v.value;this._transitionablePaint.setValue(a,u),this._handleSpecialPaintPropertyUpdate(a);let F=this._transitionablePaint._values[a].value;return F.isDataDriven()||S||E||this._handleOverridablePaintPropertyUpdate(a,R,F)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,u,p){return!1}isHidden(a=this.minzoom,u=!1){return!!(this.minzoom&&a<(u?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&a>=this.maxzoom)||this._evaluatedVisibility===\"none\"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(a,u){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,u)}serialize(){let a={id:this.id,type:this.type,source:this.source,\"source-layer\":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),lo(a,((u,p)=>!(u===void 0||p===\"layout\"&&!Object.keys(u).length||p===\"paint\"&&!Object.keys(u).length)))}_validate(a,u,p,v,E={}){return(!E||E.validate!==!1)&&Su(this,a.call(es,{key:u,layerType:this.type,objectKey:p,value:v,styleSpec:Ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let a in this.paint._values){let u=this.paint.get(a);if(u instanceof kl&&bu(u.property.specification)&&(u.value.kind===\"source\"||u.value.kind===\"composite\")&&u.value.isStateDependent)return!0}return!1}}let Nl;var zg={get paint(){return Nl=Nl||new qs({\"raster-opacity\":new yn(Ke.paint_raster[\"raster-opacity\"]),\"raster-hue-rotate\":new yn(Ke.paint_raster[\"raster-hue-rotate\"]),\"raster-brightness-min\":new yn(Ke.paint_raster[\"raster-brightness-min\"]),\"raster-brightness-max\":new yn(Ke.paint_raster[\"raster-brightness-max\"]),\"raster-saturation\":new yn(Ke.paint_raster[\"raster-saturation\"]),\"raster-contrast\":new yn(Ke.paint_raster[\"raster-contrast\"]),\"raster-resampling\":new yn(Ke.paint_raster[\"raster-resampling\"]),\"raster-fade-duration\":new yn(Ke.paint_raster[\"raster-fade-duration\"])})}};class Sx extends ka{constructor(a,u){super(a,zg,u)}}let Cx={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Yd{constructor(a,u){this._structArray=a,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,u){return a._trim(),u&&(a.isTransferred=!0,u.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){let u=Object.create(this.prototype);return u.arrayBuffer=a.arrayBuffer,u.length=a.length,u.capacity=a.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error(\"_refreshViews() must be implemented by each concrete StructArray layout\")}}function fo(h,a=1){let u=0,p=0;return{members:h.map((v=>{let E=Cx[v.type].BYTES_PER_ELEMENT,S=u=ua(u,Math.max(a,E)),R=v.components||1;return p=Math.max(p,E),u+=E*R,{name:v.name,type:v.type,components:R,offset:S}})),size:ua(u,Math.max(p,a)),alignment:a}}function ua(h,a){return Math.ceil(h/a)*a}class Dh extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u){let p=this.length;return this.resize(p+1),this.emplace(p,a,u)}emplace(a,u,p){let v=2*a;return this.int16[v+0]=u,this.int16[v+1]=p,a}}Dh.prototype.bytesPerElement=4,un(\"StructArrayLayout2i4\",Dh);class D0 extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p){let v=this.length;return this.resize(v+1),this.emplace(v,a,u,p)}emplace(a,u,p,v){let E=3*a;return this.int16[E+0]=u,this.int16[E+1]=p,this.int16[E+2]=v,a}}D0.prototype.bytesPerElement=6,un(\"StructArrayLayout3i6\",D0);class Bf extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,v){let E=this.length;return this.resize(E+1),this.emplace(E,a,u,p,v)}emplace(a,u,p,v,E){let S=4*a;return this.int16[S+0]=u,this.int16[S+1]=p,this.int16[S+2]=v,this.int16[S+3]=E,a}}Bf.prototype.bytesPerElement=8,un(\"StructArrayLayout4i8\",Bf);class Zd extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E,S){let R=this.length;return this.resize(R+1),this.emplace(R,a,u,p,v,E,S)}emplace(a,u,p,v,E,S,R){let F=6*a;return this.int16[F+0]=u,this.int16[F+1]=p,this.int16[F+2]=v,this.int16[F+3]=E,this.int16[F+4]=S,this.int16[F+5]=R,a}}Zd.prototype.bytesPerElement=12,un(\"StructArrayLayout2i4i12\",Zd);class Ug extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E,S){let R=this.length;return this.resize(R+1),this.emplace(R,a,u,p,v,E,S)}emplace(a,u,p,v,E,S,R){let F=4*a,U=8*a;return this.int16[F+0]=u,this.int16[F+1]=p,this.uint8[U+4]=v,this.uint8[U+5]=E,this.uint8[U+6]=S,this.uint8[U+7]=R,a}}Ug.prototype.bytesPerElement=8,un(\"StructArrayLayout2i4ub8\",Ug);class qd extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u){let p=this.length;return this.resize(p+1),this.emplace(p,a,u)}emplace(a,u,p){let v=2*a;return this.float32[v+0]=u,this.float32[v+1]=p,a}}qd.prototype.bytesPerElement=8,un(\"StructArrayLayout2f8\",qd);class Na extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E,S,R,F,U,H){let X=this.length;return this.resize(X+1),this.emplace(X,a,u,p,v,E,S,R,F,U,H)}emplace(a,u,p,v,E,S,R,F,U,H,X){let $=10*a;return this.uint16[$+0]=u,this.uint16[$+1]=p,this.uint16[$+2]=v,this.uint16[$+3]=E,this.uint16[$+4]=S,this.uint16[$+5]=R,this.uint16[$+6]=F,this.uint16[$+7]=U,this.uint16[$+8]=H,this.uint16[$+9]=X,a}}Na.prototype.bytesPerElement=20,un(\"StructArrayLayout10ui20\",Na);class Qd extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E,S,R,F){let U=this.length;return this.resize(U+1),this.emplace(U,a,u,p,v,E,S,R,F)}emplace(a,u,p,v,E,S,R,F,U){let H=8*a;return this.uint16[H+0]=u,this.uint16[H+1]=p,this.uint16[H+2]=v,this.uint16[H+3]=E,this.uint16[H+4]=S,this.uint16[H+5]=R,this.uint16[H+6]=F,this.uint16[H+7]=U,a}}Qd.prototype.bytesPerElement=16,un(\"StructArrayLayout8ui16\",Qd);class Nc extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E,S,R,F,U,H,X,$){let te=this.length;return this.resize(te+1),this.emplace(te,a,u,p,v,E,S,R,F,U,H,X,$)}emplace(a,u,p,v,E,S,R,F,U,H,X,$,te){let oe=12*a;return this.int16[oe+0]=u,this.int16[oe+1]=p,this.int16[oe+2]=v,this.int16[oe+3]=E,this.uint16[oe+4]=S,this.uint16[oe+5]=R,this.uint16[oe+6]=F,this.uint16[oe+7]=U,this.int16[oe+8]=H,this.int16[oe+9]=X,this.int16[oe+10]=$,this.int16[oe+11]=te,a}}Nc.prototype.bytesPerElement=24,un(\"StructArrayLayout4i4ui4i24\",Nc);class Df extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p){let v=this.length;return this.resize(v+1),this.emplace(v,a,u,p)}emplace(a,u,p,v){let E=3*a;return this.float32[E+0]=u,this.float32[E+1]=p,this.float32[E+2]=v,a}}Df.prototype.bytesPerElement=12,un(\"StructArrayLayout3f12\",Df);class Lh extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){let u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint32[1*a+0]=u,a}}Lh.prototype.bytesPerElement=4,un(\"StructArrayLayout1ul4\",Lh);class L0 extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E,S,R,F,U){let H=this.length;return this.resize(H+1),this.emplace(H,a,u,p,v,E,S,R,F,U)}emplace(a,u,p,v,E,S,R,F,U,H){let X=10*a,$=5*a;return this.int16[X+0]=u,this.int16[X+1]=p,this.int16[X+2]=v,this.int16[X+3]=E,this.int16[X+4]=S,this.int16[X+5]=R,this.uint32[$+3]=F,this.uint16[X+8]=U,this.uint16[X+9]=H,a}}L0.prototype.bytesPerElement=20,un(\"StructArrayLayout6i1ul2ui20\",L0);class zc extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E,S){let R=this.length;return this.resize(R+1),this.emplace(R,a,u,p,v,E,S)}emplace(a,u,p,v,E,S,R){let F=6*a;return this.int16[F+0]=u,this.int16[F+1]=p,this.int16[F+2]=v,this.int16[F+3]=E,this.int16[F+4]=S,this.int16[F+5]=R,a}}zc.prototype.bytesPerElement=12,un(\"StructArrayLayout2i2i2i12\",zc);class Pu extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E){let S=this.length;return this.resize(S+1),this.emplace(S,a,u,p,v,E)}emplace(a,u,p,v,E,S){let R=4*a,F=8*a;return this.float32[R+0]=u,this.float32[R+1]=p,this.float32[R+2]=v,this.int16[F+6]=E,this.int16[F+7]=S,a}}Pu.prototype.bytesPerElement=16,un(\"StructArrayLayout2f1f2i16\",Pu);class Vg extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E,S){let R=this.length;return this.resize(R+1),this.emplace(R,a,u,p,v,E,S)}emplace(a,u,p,v,E,S,R){let F=16*a,U=4*a,H=8*a;return this.uint8[F+0]=u,this.uint8[F+1]=p,this.float32[U+1]=v,this.float32[U+2]=E,this.int16[H+6]=S,this.int16[H+7]=R,a}}Vg.prototype.bytesPerElement=16,un(\"StructArrayLayout2ub2f2i16\",Vg);class Kd extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p){let v=this.length;return this.resize(v+1),this.emplace(v,a,u,p)}emplace(a,u,p,v){let E=3*a;return this.uint16[E+0]=u,this.uint16[E+1]=p,this.uint16[E+2]=v,a}}Kd.prototype.bytesPerElement=6,un(\"StructArrayLayout3ui6\",Kd);class Oh extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E,S,R,F,U,H,X,$,te,oe,le,ue,me){let Le=this.length;return this.resize(Le+1),this.emplace(Le,a,u,p,v,E,S,R,F,U,H,X,$,te,oe,le,ue,me)}emplace(a,u,p,v,E,S,R,F,U,H,X,$,te,oe,le,ue,me,Le){let ye=24*a,we=12*a,ke=48*a;return this.int16[ye+0]=u,this.int16[ye+1]=p,this.uint16[ye+2]=v,this.uint16[ye+3]=E,this.uint32[we+2]=S,this.uint32[we+3]=R,this.uint32[we+4]=F,this.uint16[ye+10]=U,this.uint16[ye+11]=H,this.uint16[ye+12]=X,this.float32[we+7]=$,this.float32[we+8]=te,this.uint8[ke+36]=oe,this.uint8[ke+37]=le,this.uint8[ke+38]=ue,this.uint32[we+10]=me,this.int16[ye+22]=Le,a}}Oh.prototype.bytesPerElement=48,un(\"StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48\",Oh);class Gg extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,v,E,S,R,F,U,H,X,$,te,oe,le,ue,me,Le,ye,we,ke,je,ht,It,wt,Rt,Qt,Gt){let bt=this.length;return this.resize(bt+1),this.emplace(bt,a,u,p,v,E,S,R,F,U,H,X,$,te,oe,le,ue,me,Le,ye,we,ke,je,ht,It,wt,Rt,Qt,Gt)}emplace(a,u,p,v,E,S,R,F,U,H,X,$,te,oe,le,ue,me,Le,ye,we,ke,je,ht,It,wt,Rt,Qt,Gt,bt){let _t=32*a,cn=16*a;return this.int16[_t+0]=u,this.int16[_t+1]=p,this.int16[_t+2]=v,this.int16[_t+3]=E,this.int16[_t+4]=S,this.int16[_t+5]=R,this.int16[_t+6]=F,this.int16[_t+7]=U,this.uint16[_t+8]=H,this.uint16[_t+9]=X,this.uint16[_t+10]=$,this.uint16[_t+11]=te,this.uint16[_t+12]=oe,this.uint16[_t+13]=le,this.uint16[_t+14]=ue,this.uint16[_t+15]=me,this.uint16[_t+16]=Le,this.uint16[_t+17]=ye,this.uint16[_t+18]=we,this.uint16[_t+19]=ke,this.uint16[_t+20]=je,this.uint16[_t+21]=ht,this.uint16[_t+22]=It,this.uint32[cn+12]=wt,this.float32[cn+13]=Rt,this.float32[cn+14]=Qt,this.uint16[_t+30]=Gt,this.uint16[_t+31]=bt,a}}Gg.prototype.bytesPerElement=64,un(\"StructArrayLayout8i15ui1ul2f2ui64\",Gg);class O0 extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){let u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.float32[1*a+0]=u,a}}O0.prototype.bytesPerElement=4,un(\"StructArrayLayout1f4\",O0);class F0 extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p){let v=this.length;return this.resize(v+1),this.emplace(v,a,u,p)}emplace(a,u,p,v){let E=3*a;return this.uint16[6*a+0]=u,this.float32[E+1]=p,this.float32[E+2]=v,a}}F0.prototype.bytesPerElement=12,un(\"StructArrayLayout1ui2f12\",F0);class Hg extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p){let v=this.length;return this.resize(v+1),this.emplace(v,a,u,p)}emplace(a,u,p,v){let E=4*a;return this.uint32[2*a+0]=u,this.uint16[E+2]=p,this.uint16[E+3]=v,a}}Hg.prototype.bytesPerElement=8,un(\"StructArrayLayout1ul2ui8\",Hg);class I extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u){let p=this.length;return this.resize(p+1),this.emplace(p,a,u)}emplace(a,u,p){let v=2*a;return this.uint16[v+0]=u,this.uint16[v+1]=p,a}}I.prototype.bytesPerElement=4,un(\"StructArrayLayout2ui4\",I);class l extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){let u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint16[1*a+0]=u,a}}l.prototype.bytesPerElement=2,un(\"StructArrayLayout1ui2\",l);class f extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,v){let E=this.length;return this.resize(E+1),this.emplace(E,a,u,p,v)}emplace(a,u,p,v,E){let S=4*a;return this.float32[S+0]=u,this.float32[S+1]=p,this.float32[S+2]=v,this.float32[S+3]=E,a}}f.prototype.bytesPerElement=16,un(\"StructArrayLayout4f16\",f);class y extends Yd{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new s(this.anchorPointX,this.anchorPointY)}}y.prototype.size=20;class w extends L0{get(a){return new y(this,a)}}un(\"CollisionBoxArray\",w);class P extends Yd{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}P.prototype.size=48;class L extends Oh{get(a){return new P(this,a)}}un(\"PlacedSymbolArray\",L);class z extends Yd{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}z.prototype.size=64;class G extends Gg{get(a){return new z(this,a)}}un(\"SymbolInstanceArray\",G);class j extends O0{getoffsetX(a){return this.float32[1*a+0]}}un(\"GlyphOffsetArray\",j);class Q extends D0{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}un(\"SymbolLineVertexArray\",Q);class ie extends Yd{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ie.prototype.size=12;class re extends F0{get(a){return new ie(this,a)}}un(\"TextAnchorOffsetArray\",re);class ce extends Yd{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ce.prototype.size=8;class de extends Hg{get(a){return new ce(this,a)}}un(\"FeatureIndexArray\",de);class Te extends Dh{}class Ie extends Dh{}class Me extends Dh{}class Oe extends Zd{}class We extends Ug{}class De extends qd{}class Ge extends Na{}class Be extends Qd{}class Fe extends Nc{}class Ve extends Df{}class ct extends Lh{}class dt extends zc{}class pt extends Vg{}class ft extends Kd{}class Xt extends I{}let Ut=fo([{name:\"a_pos\",components:2,type:\"Int16\"}],4),{members:Bt}=Ut;class Jt{constructor(a=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=a}prepareSegment(a,u,p,v){let E=this.segments[this.segments.length-1];return a>Jt.MAX_VERTEX_ARRAY_LENGTH&&yi(`Max vertices per segment is ${Jt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}. Consider using the \\`fillLargeMeshArrays\\` function if you require meshes with more than ${Jt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!E||E.vertexLength+a>Jt.MAX_VERTEX_ARRAY_LENGTH||E.sortKey!==v?this.createNewSegment(u,p,v):E}createNewSegment(a,u,p){let v={vertexOffset:a.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0,vaos:{}};return p!==void 0&&(v.sortKey=p),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(v),v}getOrCreateLatestSegment(a,u,p){return this.prepareSegment(0,a,u,p)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(let a of this.segments)for(let u in a.vaos)a.vaos[u].destroy()}static simpleSegment(a,u,p,v){return new Jt([{vertexOffset:a,primitiveOffset:u,vertexLength:p,primitiveLength:v,vaos:{},sortKey:0}])}}function jn(h,a){return 256*(h=Pt(Math.floor(h),0,255))+Pt(Math.floor(a),0,255)}Jt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,un(\"SegmentVector\",Jt);let Tt=fo([{name:\"a_pattern_from\",components:4,type:\"Uint16\"},{name:\"a_pattern_to\",components:4,type:\"Uint16\"},{name:\"a_pixel_ratio_from\",components:1,type:\"Uint16\"},{name:\"a_pixel_ratio_to\",components:1,type:\"Uint16\"}]),Ot=fo([{name:\"a_dasharray_from\",components:4,type:\"Uint16\"},{name:\"a_dasharray_to\",components:4,type:\"Uint16\"}]);var ni,Pi,Kr,Ri={exports:{}},ri={exports:{}},Fi={exports:{}},po=(function(){if(Kr)return Ri.exports;Kr=1;var h=(ni||(ni=1,ri.exports=function(u,p){var v,E,S,R,F,U,H,X;for(E=u.length-(v=3&u.length),S=p,F=3432918353,U=461845907,X=0;X<E;)H=255&u.charCodeAt(X)|(255&u.charCodeAt(++X))<<8|(255&u.charCodeAt(++X))<<16|(255&u.charCodeAt(++X))<<24,++X,S=27492+(65535&(R=5*(65535&(S=(S^=H=(65535&(H=(H=(65535&H)*F+(((H>>>16)*F&65535)<<16)&4294967295)<<15|H>>>17))*U+(((H>>>16)*U&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(R>>>16)&65535)<<16);switch(H=0,v){case 3:H^=(255&u.charCodeAt(X+2))<<16;case 2:H^=(255&u.charCodeAt(X+1))<<8;case 1:S^=H=(65535&(H=(H=(65535&(H^=255&u.charCodeAt(X)))*F+(((H>>>16)*F&65535)<<16)&4294967295)<<15|H>>>17))*U+(((H>>>16)*U&65535)<<16)&4294967295}return S^=u.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}),ri.exports),a=(Pi||(Pi=1,Fi.exports=function(u,p){for(var v,E=u.length,S=p^E,R=0;E>=4;)v=1540483477*(65535&(v=255&u.charCodeAt(R)|(255&u.charCodeAt(++R))<<8|(255&u.charCodeAt(++R))<<16|(255&u.charCodeAt(++R))<<24))+((1540483477*(v>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),E-=4,++R;switch(E){case 3:S^=(255&u.charCodeAt(R+2))<<16;case 2:S^=(255&u.charCodeAt(R+1))<<8;case 1:S=1540483477*(65535&(S^=255&u.charCodeAt(R)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}),Fi.exports);return Ri.exports=h,Ri.exports.murmur3=h,Ri.exports.murmur2=a,Ri.exports})(),ui=c(po);class A{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,u,p,v){this.ids.push(g(a)),this.positions.push(u,p,v)}getPositions(a){if(!this.indexed)throw new Error(\"Trying to get index, but feature positions are not indexed\");let u=g(a),p=0,v=this.ids.length-1;for(;p<v;){let S=p+v>>1;this.ids[S]>=u?v=S:p=S+1}let E=[];for(;this.ids[p]===u;)E.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return E}static serialize(a,u){let p=new Float64Array(a.ids),v=new Uint32Array(a.positions);return x(p,v,0,p.length-1),u&&u.push(p.buffer,v.buffer),{ids:p,positions:v}}static deserialize(a){let u=new A;return u.ids=a.ids,u.positions=a.positions,u.indexed=!0,u}}function g(h){let a=+h;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:ui(String(h))}function x(h,a,u,p){for(;u<p;){let v=h[u+p>>1],E=u-1,S=p+1;for(;;){do E++;while(h[E]<v);do S--;while(h[S]>v);if(E>=S)break;T(h,E,S),T(a,3*E,3*S),T(a,3*E+1,3*S+1),T(a,3*E+2,3*S+2)}S-u<p-S?(x(h,a,u,S),u=S+1):(x(h,a,S+1,p),p=S)}}function T(h,a,u){let p=h[a];h[a]=h[u],h[u]=p}un(\"FeaturePositionMap\",A);class M{constructor(a,u){this.gl=a.gl,this.location=u}}class D extends M{constructor(a,u){super(a,u),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class O extends M{constructor(a,u){super(a,u),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class N extends M{constructor(a,u){super(a,u),this.current=Zn.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}let W=new Float32Array(16);function Z(h){return[jn(255*h.r,255*h.g),jn(255*h.b,255*h.a)]}class ne{constructor(a,u,p){this.value=a,this.uniformNames=u.map((v=>`u_${v}`)),this.type=p}setUniform(a,u,p){a.set(p.constantOr(this.value))}getBinding(a,u,p){return this.type===\"color\"?new N(a,u):new D(a,u)}}class _e{constructor(a,u){this.uniformNames=u.map((p=>`u_${p}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=a.tlbr}setConstantDashPositions(a,u){this.dashTo=[0,a.y,a.height,a.width],this.dashFrom=[0,u.y,u.height,u.width]}setUniform(a,u,p,v){let E=null;v===\"u_pattern_to\"?E=this.patternTo:v===\"u_pattern_from\"?E=this.patternFrom:v===\"u_dasharray_to\"?E=this.dashTo:v===\"u_dasharray_from\"?E=this.dashFrom:v===\"u_pixel_ratio_to\"?E=this.pixelRatioTo:v===\"u_pixel_ratio_from\"&&(E=this.pixelRatioFrom),E!==null&&a.set(E)}getBinding(a,u,p){return p.substr(0,9)===\"u_pattern\"||p.substr(0,12)===\"u_dasharray_\"?new O(a,u):new D(a,u)}}class Ce{constructor(a,u,p,v){this.expression=a,this.type=p,this.maxValue=0,this.paintVertexAttributes=u.map((E=>({name:`a_${E}`,type:\"Float32\",components:p===\"color\"?2:1,offset:0}))),this.paintVertexArray=new v}populatePaintArray(a,u,p){let v=this.paintVertexArray.length,E=this.expression.evaluate(new ci(0,p),u,{},p.canonical,[],p.formattedSection);this.paintVertexArray.resize(a),this._setPaintValue(v,a,E)}updatePaintArray(a,u,p,v,E){let S=this.expression.evaluate(new ci(0,E),p,v);this._setPaintValue(a,u,S)}_setPaintValue(a,u,p){if(this.type===\"color\"){let v=Z(p);for(let E=a;E<u;E++)this.paintVertexArray.emplace(E,v[0],v[1])}else{for(let v=a;v<u;v++)this.paintVertexArray.emplace(v,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Se{constructor(a,u,p,v,E,S){this.expression=a,this.uniformNames=u.map((R=>`u_${R}_t`)),this.type=p,this.useIntegerZoom=v,this.zoom=E,this.maxValue=0,this.paintVertexAttributes=u.map((R=>({name:`a_${R}`,type:\"Float32\",components:p===\"color\"?4:2,offset:0}))),this.paintVertexArray=new S}populatePaintArray(a,u,p){let v=this.expression.evaluate(new ci(this.zoom,p),u,{},p.canonical,[],p.formattedSection),E=this.expression.evaluate(new ci(this.zoom+1,p),u,{},p.canonical,[],p.formattedSection),S=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(S,a,v,E)}updatePaintArray(a,u,p,v,E){let S=this.expression.evaluate(new ci(this.zoom,E),p,v),R=this.expression.evaluate(new ci(this.zoom+1,E),p,v);this._setPaintValue(a,u,S,R)}_setPaintValue(a,u,p,v){if(this.type===\"color\"){let E=Z(p),S=Z(v);for(let R=a;R<u;R++)this.paintVertexArray.emplace(R,E[0],E[1],S[0],S[1])}else{for(let E=a;E<u;E++)this.paintVertexArray.emplace(E,p,v);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(v))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,u){let p=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,v=Pt(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);a.set(v)}getBinding(a,u,p){return new D(a,u)}}class Pe{constructor(a,u,p,v,E,S){this.expression=a,this.type=u,this.useIntegerZoom=p,this.zoom=v,this.layerId=S,this.zoomInPaintVertexArray=new E,this.zoomOutPaintVertexArray=new E}populatePaintArray(a,u,p){let v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(v,a,this.getPositionIds(u),p)}updatePaintArray(a,u,p,v,E){this._setPaintValues(a,u,this.getPositionIds(p),E)}_setPaintValues(a,u,p,v){let E=this.getPositions(v);if(!E||!p)return;let S=E[p.min],R=E[p.mid],F=E[p.max];if(S&&R&&F)for(let U=a;U<u;U++)this.emplace(this.zoomInPaintVertexArray,U,R,S),this.emplace(this.zoomOutPaintVertexArray,U,R,F)}upload(a){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){let u=this.getVertexAttributes();this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,u,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,u,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ye extends Pe{getPositions(a){return a.imagePositions}getPositionIds(a){return a.patterns&&a.patterns[this.layerId]}getVertexAttributes(){return Tt.members}emplace(a,u,p,v){a.emplace(u,p.tlbr[0],p.tlbr[1],p.tlbr[2],p.tlbr[3],v.tlbr[0],v.tlbr[1],v.tlbr[2],v.tlbr[3],p.pixelRatio,v.pixelRatio)}}class et extends Pe{getPositions(a){return a.dashPositions}getPositionIds(a){return a.dashes&&a.dashes[this.layerId]}getVertexAttributes(){return Ot.members}emplace(a,u,p,v){a.emplace(u,0,p.y,p.height,p.width,0,v.y,v.height,v.width)}}class yt{constructor(a,u,p){this.binders={},this._buffers=[];let v=[];for(let E in a.paint._values){if(!p(E))continue;let S=a.paint.get(E);if(!(S instanceof kl&&bu(S.property.specification)))continue;let R=lt(E,a.type),F=S.value,U=S.property.specification.type,H=S.property.useIntegerZoom,X=S.property.specification[\"property-type\"],$=X===\"cross-faded\"||X===\"cross-faded-data-driven\";if(F.kind===\"constant\")this.binders[E]=$?new _e(F.value,R):new ne(F.value,R,U),v.push(`/u_${E}`);else if(F.kind===\"source\"||$){let te=qe(E,U,\"source\");this.binders[E]=$?E===\"line-dasharray\"?new et(F,U,H,u,te,a.id):new Ye(F,U,H,u,te,a.id):new Ce(F,R,U,te),v.push(`/a_${E}`)}else{let te=qe(E,U,\"composite\");this.binders[E]=new Se(F,R,U,H,u,te),v.push(`/z_${E}`)}}this.cacheKey=v.sort().join(\"\")}getMaxValue(a){let u=this.binders[a];return u instanceof Ce||u instanceof Se?u.maxValue:0}populatePaintArrays(a,u,p){for(let v in this.binders){let E=this.binders[v];(E instanceof Ce||E instanceof Se||E instanceof Pe)&&E.populatePaintArray(a,u,p)}}setConstantPatternPositions(a,u){for(let p in this.binders){let v=this.binders[p];v instanceof _e&&v.setConstantPatternPositions(a,u)}}setConstantDashPositions(a,u){for(let p in this.binders){let v=this.binders[p];v instanceof _e&&v.setConstantDashPositions(a,u)}}updatePaintArrays(a,u,p,v,E){let S=!1;for(let R in a){let F=u.getPositions(R);for(let U of F){let H=p.feature(U.index);for(let X in this.binders){let $=this.binders[X];if(($ instanceof Ce||$ instanceof Se||$ instanceof Pe)&&$.expression.isStateDependent===!0){let te=v.paint.get(X);$.expression=te.value,$.updatePaintArray(U.start,U.end,H,a[R],E),S=!0}}}}return S}defines(){let a=[];for(let u in this.binders){let p=this.binders[u];(p instanceof ne||p instanceof _e)&&a.push(...p.uniformNames.map((v=>`#define HAS_UNIFORM_${v}`)))}return a}getBinderAttributes(){let a=[];for(let u in this.binders){let p=this.binders[u];if(p instanceof Ce||p instanceof Se)for(let v=0;v<p.paintVertexAttributes.length;v++)a.push(p.paintVertexAttributes[v].name);else if(p instanceof Pe){let v=p.getVertexAttributes();for(let E of v)a.push(E.name)}}return a}getBinderUniforms(){let a=[];for(let u in this.binders){let p=this.binders[u];if(p instanceof ne||p instanceof _e||p instanceof Se)for(let v of p.uniformNames)a.push(v)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,u){let p=[];for(let v in this.binders){let E=this.binders[v];if(E instanceof ne||E instanceof _e||E instanceof Se){for(let S of E.uniformNames)if(u[S]){let R=E.getBinding(a,u[S],S);p.push({name:S,property:v,binding:R})}}}return p}setUniforms(a,u,p,v){for(let{name:E,property:S,binding:R}of u)this.binders[S].setUniform(R,v,p.get(S),E)}updatePaintBuffers(a){this._buffers=[];for(let u in this.binders){let p=this.binders[u];if(a&&p instanceof Pe){let v=a.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(p instanceof Ce||p instanceof Se)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(a){for(let u in this.binders){let p=this.binders[u];(p instanceof Ce||p instanceof Se||p instanceof Pe)&&p.upload(a)}this.updatePaintBuffers()}destroy(){for(let a in this.binders){let u=this.binders[a];(u instanceof Ce||u instanceof Se||u instanceof Pe)&&u.destroy()}}}class at{constructor(a,u,p=()=>!0){this.programConfigurations={};for(let v of a)this.programConfigurations[v.id]=new yt(v,u,p);this.needsUpload=!1,this._featureMap=new A,this._bufferOffset=0}populatePaintArrays(a,u,p,v){for(let E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(a,u,v);u.id!==void 0&&this._featureMap.add(u.id,p,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,u,p,v){for(let E of p)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(a,this._featureMap,u,E,v)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(let u in this.programConfigurations)this.programConfigurations[u].upload(a);this.needsUpload=!1}}destroy(){for(let a in this.programConfigurations)this.programConfigurations[a].destroy()}}function lt(h,a){return{\"text-opacity\":[\"opacity\"],\"icon-opacity\":[\"opacity\"],\"text-color\":[\"fill_color\"],\"icon-color\":[\"fill_color\"],\"text-halo-color\":[\"halo_color\"],\"icon-halo-color\":[\"halo_color\"],\"text-halo-blur\":[\"halo_blur\"],\"icon-halo-blur\":[\"halo_blur\"],\"text-halo-width\":[\"halo_width\"],\"icon-halo-width\":[\"halo_width\"],\"line-gap-width\":[\"gapwidth\"],\"line-dasharray\":[\"dasharray_to\",\"dasharray_from\"],\"line-pattern\":[\"pattern_to\",\"pattern_from\",\"pixel_ratio_to\",\"pixel_ratio_from\"],\"fill-pattern\":[\"pattern_to\",\"pattern_from\",\"pixel_ratio_to\",\"pixel_ratio_from\"],\"fill-extrusion-pattern\":[\"pattern_to\",\"pattern_from\",\"pixel_ratio_to\",\"pixel_ratio_from\"]}[h]||[h.replace(`${a}-`,\"\").replace(/-/g,\"_\")]}function qe(h,a,u){let p={color:{source:qd,composite:f},number:{source:O0,composite:qd}},v=(function(E){return{\"line-pattern\":{source:Ge,composite:Ge},\"fill-pattern\":{source:Ge,composite:Ge},\"fill-extrusion-pattern\":{source:Ge,composite:Ge},\"line-dasharray\":{source:Be,composite:Be}}[E]})(h);return v&&v[u]||p[a][u]}un(\"ConstantBinder\",ne),un(\"CrossFadedConstantBinder\",_e),un(\"SourceExpressionBinder\",Ce),un(\"CrossFadedPatternBinder\",Ye),un(\"CrossFadedDasharrayBinder\",et),un(\"CompositeExpressionBinder\",Se),un(\"ProgramConfiguration\",yt,{omit:[\"_buffers\"]}),un(\"ProgramConfigurationSet\",at);let qt=Math.pow(2,14)-1,xn=-qt-1;function dn(h){let a=rn/h.extent,u=h.loadGeometry();for(let p=0;p<u.length;p++){let v=u[p];for(let E=0;E<v.length;E++){let S=v[E],R=Math.round(S.x*a),F=Math.round(S.y*a);S.x=Pt(R,xn,qt),S.y=Pt(F,xn,qt),(R<S.x||R>S.x+1||F<S.y||F>S.y+1)&&yi(\"Geometry exceeds allowed extent, reduce your vector tile buffer size\")}}return u}function Vn(h,a){return{type:h.type,id:h.id,properties:h.properties,geometry:a?dn(h):[]}}let qn=-32768;function ur(h,a,u,p,v){h.emplaceBack(qn+8*a+p,qn+8*u+v)}class Gn{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map((u=>u.id)),this.index=a.index,this.hasDependencies=!1,this.layoutVertexArray=new Ie,this.indexArray=new ft,this.segments=new Jt,this.programConfigurations=new at(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter((u=>u.isStateDependent())).map((u=>u.id))}populate(a,u,p){let v=this.layers[0],E=[],S=null,R=!1,F=v.type===\"heatmap\";if(v.type===\"circle\"){let H=v;S=H.layout.get(\"circle-sort-key\"),R=!S.isConstant(),F=F||H.paint.get(\"circle-pitch-alignment\")===\"map\"}let U=F?u.subdivisionGranularity.circle:1;for(let{feature:H,id:X,index:$,sourceLayerIndex:te}of a){let oe=this.layers[0]._featureFilter.needGeometry,le=Vn(H,oe);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),le,p))continue;let ue=R?S.evaluate(le,{},p):void 0,me={id:X,properties:H.properties,type:H.type,sourceLayerIndex:te,index:$,geometry:oe?le.geometry:dn(H),patterns:{},sortKey:ue};E.push(me)}R&&E.sort(((H,X)=>H.sortKey-X.sortKey));for(let H of E){let{geometry:X,index:$,sourceLayerIndex:te}=H,oe=a[$].feature;this.addFeature(H,X,$,p,U),u.featureIndex.insert(oe,X,$,te,this.index)}}update(a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,{imagePositions:p})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Bt),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,u,p,v,E=1){let S;switch(E){case 1:S=[0,7];break;case 3:S=[0,2,5,7];break;case 5:S=[0,1,3,4,6,7];break;case 7:S=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${E}; valid values are 1, 3, 5, 7.`)}let R=S.length;for(let F of u)for(let U of F){let H=U.x,X=U.y;if(H<0||H>=rn||X<0||X>=rn)continue;let $=this.segments.prepareSegment(R*R,this.layoutVertexArray,this.indexArray,a.sortKey),te=$.vertexLength;for(let oe=0;oe<R;oe++)for(let le=0;le<R;le++)ur(this.layoutVertexArray,H,X,S[le],S[oe]);for(let oe=0;oe<R-1;oe++)for(let le=0;le<R-1;le++){let ue=te+oe*R+le,me=te+(oe+1)*R+le;this.indexArray.emplaceBack(ue,me+1,ue+1),this.indexArray.emplaceBack(ue,me,me+1)}$.vertexLength+=R*R,$.primitiveLength+=(R-1)*(R-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,{imagePositions:{},canonical:v})}}function Tn(h,a){for(let u=0;u<h.length;u++)if(K_(a,h[u]))return!0;for(let u=0;u<a.length;u++)if(K_(h,a[u]))return!0;return!!ir(h,a)}function Zt(h,a,u){return!!K_(h,a)||!!Qs(a,h,u)}function hr(h,a){if(h.length===1)return P7(a,h[0]);for(let u=0;u<a.length;u++){let p=a[u];for(let v=0;v<p.length;v++)if(K_(h,p[v]))return!0}for(let u=0;u<h.length;u++)if(P7(a,h[u]))return!0;for(let u=0;u<a.length;u++)if(ir(h,a[u]))return!0;return!1}function wi(h,a,u){if(h.length>1){if(ir(h,a))return!0;for(let p=0;p<a.length;p++)if(Qs(a[p],h,u))return!0}for(let p=0;p<h.length;p++)if(Qs(h[p],a,u))return!0;return!1}function ir(h,a){if(h.length===0||a.length===0)return!1;for(let u=0;u<h.length-1;u++){let p=h[u],v=h[u+1];for(let E=0;E<a.length-1;E++)if(Ti(p,v,a[E],a[E+1]))return!0}return!1}function Ti(h,a,u,p){return Ro(h,u,p)!==Ro(a,u,p)&&Ro(h,a,u)!==Ro(h,a,p)}function Qs(h,a,u){let p=u*u;if(a.length===1)return h.distSqr(a[0])<p;for(let v=1;v<a.length;v++)if(Mx(h,a[v-1],a[v])<p)return!0;return!1}function Mx(h,a,u){let p=a.distSqr(u);if(p===0)return h.distSqr(a);let v=((h.x-a.x)*(u.x-a.x)+(h.y-a.y)*(u.y-a.y))/p;return h.distSqr(v<0?a:v>1?u:u.sub(a)._mult(v)._add(a))}function P7(h,a){let u,p,v,E=!1;for(let S=0;S<h.length;S++){u=h[S];for(let R=0,F=u.length-1;R<u.length;F=R++)p=u[R],v=u[F],p.y>a.y!=v.y>a.y&&a.x<(v.x-p.x)*(a.y-p.y)/(v.y-p.y)+p.x&&(E=!E)}return E}function K_(h,a){let u=!1;for(let p=0,v=h.length-1;p<h.length;v=p++){let E=h[p],S=h[v];E.y>a.y!=S.y>a.y&&a.x<(S.x-E.x)*(a.y-E.y)/(S.y-E.y)+E.x&&(u=!u)}return u}function jue(h,a,u){let p=u[0],v=u[2];if(h.x<p.x&&a.x<p.x||h.x>v.x&&a.x>v.x||h.y<p.y&&a.y<p.y||h.y>v.y&&a.y>v.y)return!1;let E=Ro(h,a,u[0]);return E!==Ro(h,a,u[1])||E!==Ro(h,a,u[2])||E!==Ro(h,a,u[3])}function J_(h,a,u){let p=a.paint.get(h).value;return p.kind===\"constant\"?p.value:u.programConfigurations.get(a.id).getMaxValue(h)}function oE(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function sE(h,a,u,p,v){if(!a[0]&&!a[1])return h;let E=s.convert(a)._mult(v);u===\"viewport\"&&E._rotate(-p);let S=[];for(let R=0;R<h.length;R++)S.push(h[R].sub(E));return S}function Xue(h){let a=[];for(let u=0;u<h.length;u++){let p=h[u],v=a.at(-1);(u===0||v&&!p.equals(v))&&a.push(p)}return a}function Yue({queryGeometry:h,size:a},u){return Zt(h,u,a)}function Zue({queryGeometry:h,size:a,transform:u,unwrappedTileID:p,getElevation:v},E){return Zt(h,E,a*(u.projectTileCoordinates(E.x,E.y,p,v).signedDistanceFromCamera/u.cameraToCenterDistance))}function que({queryGeometry:h,size:a,transform:u,unwrappedTileID:p,getElevation:v},E){let S=u.projectTileCoordinates(E.x,E.y,p,v).signedDistanceFromCamera,R=a*(u.cameraToCenterDistance/S);return Zt(h,O5(E,u,p,v),R)}function Que({queryGeometry:h,size:a,transform:u,unwrappedTileID:p,getElevation:v},E){return Zt(h,O5(E,u,p,v),a)}function R7({queryGeometry:h,size:a,transform:u,unwrappedTileID:p,getElevation:v,pitchAlignment:E=\"map\",pitchScale:S=\"map\"},R){let F=E===\"map\"?S===\"map\"?Yue:Zue:S===\"map\"?que:Que,U={queryGeometry:h,size:a,transform:u,unwrappedTileID:p,getElevation:v};for(let H of R)for(let X of H)if(F(U,X))return!0;return!1}function O5(h,a,u,p){let v=a.projectTileCoordinates(h.x,h.y,u,p).point;return new s((.5*v.x+.5)*a.width,(.5*-v.y+.5)*a.height)}let B7,D7;un(\"CircleBucket\",Gn,{omit:[\"layers\"]});var Kue={get paint(){return D7=D7||new qs({\"circle-radius\":new Rn(Ke.paint_circle[\"circle-radius\"]),\"circle-color\":new Rn(Ke.paint_circle[\"circle-color\"]),\"circle-blur\":new Rn(Ke.paint_circle[\"circle-blur\"]),\"circle-opacity\":new Rn(Ke.paint_circle[\"circle-opacity\"]),\"circle-translate\":new yn(Ke.paint_circle[\"circle-translate\"]),\"circle-translate-anchor\":new yn(Ke.paint_circle[\"circle-translate-anchor\"]),\"circle-pitch-scale\":new yn(Ke.paint_circle[\"circle-pitch-scale\"]),\"circle-pitch-alignment\":new yn(Ke.paint_circle[\"circle-pitch-alignment\"]),\"circle-stroke-width\":new Rn(Ke.paint_circle[\"circle-stroke-width\"]),\"circle-stroke-color\":new Rn(Ke.paint_circle[\"circle-stroke-color\"]),\"circle-stroke-opacity\":new Rn(Ke.paint_circle[\"circle-stroke-opacity\"])})},get layout(){return B7=B7||new qs({\"circle-sort-key\":new Rn(Ke.layout_circle[\"circle-sort-key\"])})}};class Jue extends ka{constructor(a,u){super(a,Kue,u)}createBucket(a){return new Gn(a)}queryRadius(a){let u=a;return J_(\"circle-radius\",this,u)+J_(\"circle-stroke-width\",this,u)+oE(this.paint.get(\"circle-translate\"))}queryIntersectsFeature({queryGeometry:a,feature:u,featureState:p,geometry:v,transform:E,pixelsToTileUnits:S,unwrappedTileID:R,getElevation:F}){let U=sE(a,this.paint.get(\"circle-translate\"),this.paint.get(\"circle-translate-anchor\"),-E.bearingInRadians,S),H=this.paint.get(\"circle-radius\").evaluate(u,p)+this.paint.get(\"circle-stroke-width\").evaluate(u,p),X=this.paint.get(\"circle-pitch-scale\"),$=this.paint.get(\"circle-pitch-alignment\"),te,oe;return $===\"map\"?(te=U,oe=H*S):(te=(function(le,ue,me,Le){return le.map((ye=>O5(ye,ue,me,Le)))})(U,E,R,F),oe=H),R7({queryGeometry:te,size:oe,transform:E,unwrappedTileID:R,getElevation:F,pitchAlignment:$,pitchScale:X},v)}}class L7 extends Gn{}let O7;un(\"HeatmapBucket\",L7,{omit:[\"layers\"]});var $ue={get paint(){return O7=O7||new qs({\"heatmap-radius\":new Rn(Ke.paint_heatmap[\"heatmap-radius\"]),\"heatmap-weight\":new Rn(Ke.paint_heatmap[\"heatmap-weight\"]),\"heatmap-intensity\":new yn(Ke.paint_heatmap[\"heatmap-intensity\"]),\"heatmap-color\":new Xd(Ke.paint_heatmap[\"heatmap-color\"]),\"heatmap-opacity\":new yn(Ke.paint_heatmap[\"heatmap-opacity\"])})}};function F5(h,{width:a,height:u},p,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==a*u*p)throw new RangeError(`mismatched image size. expected: ${v.length} but got: ${a*u*p}`)}else v=new Uint8Array(a*u*p);return h.width=a,h.height=u,h.data=v,h}function F7(h,{width:a,height:u},p){if(a===h.width&&u===h.height)return;let v=F5({},{width:a,height:u},p);k5(h,v,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,a),height:Math.min(h.height,u)},p),h.width=a,h.height=u,h.data=v.data}function k5(h,a,u,p,v,E){if(v.width===0||v.height===0)return a;if(v.width>h.width||v.height>h.height||u.x>h.width-v.width||u.y>h.height-v.height)throw new RangeError(\"out of range source coordinates for image copy\");if(v.width>a.width||v.height>a.height||p.x>a.width-v.width||p.y>a.height-v.height)throw new RangeError(\"out of range destination coordinates for image copy\");let S=h.data,R=a.data;if(S===R)throw new Error(\"srcData equals dstData, so image is already copied\");for(let F=0;F<v.height;F++){let U=((u.y+F)*h.width+u.x)*E,H=((p.y+F)*a.width+p.x)*E;for(let X=0;X<v.width*E;X++)R[H+X]=S[U+X]}return a}class Ix{constructor(a,u){F5(this,a,1,u)}resize(a){F7(this,a,1)}clone(){return new Ix({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,p,v,E){k5(a,u,p,v,E,1)}}class zl{constructor(a,u){F5(this,a,4,u)}resize(a){F7(this,a,4)}replace(a,u){u?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new zl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,p,v,E){k5(a,u,p,v,E,4)}setPixel(a,u,p){let v=4*(a*this.width+u);this.data[v+0]=Math.round(255*p.r/p.a),this.data[v+1]=Math.round(255*p.g/p.a),this.data[v+2]=Math.round(255*p.b/p.a),this.data[v+3]=Math.round(255*p.a)}}function k7(h){let a={},u=h.resolution||256,p=h.clips?h.clips.length:1,v=h.image||new zl({width:u,height:p});if(Math.log(u)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${u}`);let E=(S,R,F)=>{a[h.evaluationKey]=F;let U=h.expression.evaluate(a);v.setPixel(S/4/u,R/4,U)};if(h.clips)for(let S=0,R=0;S<p;++S,R+=4*u)for(let F=0,U=0;F<u;F++,U+=4){let H=F/(u-1),{start:X,end:$}=h.clips[S];E(R,U,X*(1-H)+$*H)}else for(let S=0,R=0;S<u;S++,R+=4)E(0,R,S/(u-1));return v}un(\"AlphaImage\",Ix),un(\"RGBAImage\",zl);let N5=\"big-fb\";class ehe extends ka{createBucket(a){return new L7(a)}constructor(a,u){super(a,$ue,u),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a===\"heatmap-color\"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=k7({expression:this._transitionablePaint._values[\"heatmap-color\"].value.expression,evaluationKey:\"heatmapDensity\",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(N5)&&this.heatmapFbos.delete(N5)}queryRadius(a){return J_(\"heatmap-radius\",this,a)}queryIntersectsFeature({queryGeometry:a,feature:u,featureState:p,geometry:v,transform:E,pixelsToTileUnits:S,unwrappedTileID:R,getElevation:F}){return R7({queryGeometry:a,size:this.paint.get(\"heatmap-radius\").evaluate(u,p)*S,transform:E,unwrappedTileID:R,getElevation:F},v)}hasOffscreenPass(){return this.paint.get(\"heatmap-opacity\")!==0&&!this.isHidden()}}let N7;var the={get paint(){return N7=N7||new qs({\"hillshade-illumination-direction\":new yn(Ke.paint_hillshade[\"hillshade-illumination-direction\"]),\"hillshade-illumination-altitude\":new yn(Ke.paint_hillshade[\"hillshade-illumination-altitude\"]),\"hillshade-illumination-anchor\":new yn(Ke.paint_hillshade[\"hillshade-illumination-anchor\"]),\"hillshade-exaggeration\":new yn(Ke.paint_hillshade[\"hillshade-exaggeration\"]),\"hillshade-shadow-color\":new yn(Ke.paint_hillshade[\"hillshade-shadow-color\"]),\"hillshade-highlight-color\":new yn(Ke.paint_hillshade[\"hillshade-highlight-color\"]),\"hillshade-accent-color\":new yn(Ke.paint_hillshade[\"hillshade-accent-color\"]),\"hillshade-method\":new yn(Ke.paint_hillshade[\"hillshade-method\"])})}};class nhe extends ka{constructor(a,u){super(a,the,u),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let a=this.paint.get(\"hillshade-illumination-direction\").values,u=this.paint.get(\"hillshade-illumination-altitude\").values,p=this.paint.get(\"hillshade-highlight-color\").values,v=this.paint.get(\"hillshade-shadow-color\").values,E=Math.max(a.length,u.length,p.length,v.length);a=a.concat(Array(E-a.length).fill(a.at(-1))),u=u.concat(Array(E-u.length).fill(u.at(-1))),p=p.concat(Array(E-p.length).fill(p.at(-1))),v=v.concat(Array(E-v.length).fill(v.at(-1)));let S=u.map(Oi);return{directionRadians:a.map(Oi),altitudeRadians:S,shadowColor:v,highlightColor:p}}hasOffscreenPass(){return this.paint.get(\"hillshade-exaggeration\")!==0&&!this.isHidden()}}let z7;var rhe={get paint(){return z7=z7||new qs({\"color-relief-opacity\":new yn(Ke[\"paint_color-relief\"][\"color-relief-opacity\"]),\"color-relief-color\":new Xd(Ke[\"paint_color-relief\"][\"color-relief-color\"])})}};class z5{constructor(a,u,p,v){this.context=a,this.format=p,this.texture=a.gl.createTexture(),this.update(u,v)}update(a,u,p){let{width:v,height:E}=a,S=!(this.size&&this.size[0]===v&&this.size[1]===E||p),{context:R}=this,{gl:F}=R;if(this.useMipmap=!!(u&&u.useMipmap),F.bindTexture(F.TEXTURE_2D,this.texture),R.pixelStoreUnpackFlipY.set(!1),R.pixelStoreUnpack.set(1),R.pixelStoreUnpackPremultiplyAlpha.set(this.format===F.RGBA&&(!u||u.premultiply!==!1)),S)this.size=[v,E],a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||Yr(a)?F.texImage2D(F.TEXTURE_2D,0,this.format,this.format,F.UNSIGNED_BYTE,a):F.texImage2D(F.TEXTURE_2D,0,this.format,v,E,0,this.format,F.UNSIGNED_BYTE,a.data);else{let{x:U,y:H}=p||{x:0,y:0};a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||Yr(a)?F.texSubImage2D(F.TEXTURE_2D,0,U,H,F.RGBA,F.UNSIGNED_BYTE,a):F.texSubImage2D(F.TEXTURE_2D,0,U,H,v,E,F.RGBA,F.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&F.generateMipmap(F.TEXTURE_2D),R.pixelStoreUnpackFlipY.setDefault(),R.pixelStoreUnpack.setDefault(),R.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(a,u,p){let{context:v}=this,{gl:E}=v;E.bindTexture(E.TEXTURE_2D,this.texture),p!==E.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=E.LINEAR),a!==this.filter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,a),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,p||a),this.filter=a),u!==this.wrap&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,u),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class U7{constructor(a,u,p,v=1,E=1,S=1,R=0){if(this.uid=a,u.height!==u.width)throw new RangeError(\"DEM tiles must be square\");if(p&&![\"mapbox\",\"terrarium\",\"custom\"].includes(p))return void yi(`\"${p}\" is not a valid encoding type. Valid types include \"mapbox\", \"terrarium\" and \"custom\".`);this.stride=u.height;let F=this.dim=u.height-2;switch(this.data=new Uint32Array(u.data.buffer),p){case\"terrarium\":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case\"custom\":this.redFactor=v,this.greenFactor=E,this.blueFactor=S,this.baseShift=R;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let U=0;U<F;U++)this.data[this._idx(-1,U)]=this.data[this._idx(0,U)],this.data[this._idx(F,U)]=this.data[this._idx(F-1,U)],this.data[this._idx(U,-1)]=this.data[this._idx(U,0)],this.data[this._idx(U,F)]=this.data[this._idx(U,F-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(F,-1)]=this.data[this._idx(F-1,0)],this.data[this._idx(-1,F)]=this.data[this._idx(0,F-1)],this.data[this._idx(F,F)]=this.data[this._idx(F-1,F-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let U=0;U<F;U++)for(let H=0;H<F;H++){let X=this.get(U,H);X>this.max&&(this.max=X),X<this.min&&(this.min=X)}}get(a,u){let p=new Uint8Array(this.data.buffer),v=4*this._idx(a,u);return this.unpack(p[v],p[v+1],p[v+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(a,u){if(a<-1||a>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${a}, y: ${u}, dim: ${this.dim}`);return(u+1)*this.stride+(a+1)}unpack(a,u,p){return a*this.redFactor+u*this.greenFactor+p*this.blueFactor-this.baseShift}pack(a){return V7(a,this.getUnpackVector())}getPixels(){return new zl({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,u,p){if(this.dim!==a.dim)throw new Error(\"dem dimension mismatch\");let v=u*this.dim,E=u*this.dim+this.dim,S=p*this.dim,R=p*this.dim+this.dim;switch(u){case-1:v=E-1;break;case 1:E=v+1}switch(p){case-1:S=R-1;break;case 1:R=S+1}let F=-u*this.dim,U=-p*this.dim;for(let H=S;H<R;H++)for(let X=v;X<E;X++)this.data[this._idx(X,H)]=a.data[this._idx(X+F,H+U)]}}function V7(h,a){let u=a[0],p=a[1],v=a[2],E=a[3],S=Math.min(u,p,v),R=Math.round((h+E)/S);return{r:Math.floor(R*S/u)%256,g:Math.floor(R*S/p)%256,b:Math.floor(R*S/v)%256}}un(\"DEMData\",U7);class ihe extends ka{constructor(a,u){super(a,rhe,u)}_createColorRamp(a){let u={elevationStops:[],colorStops:[]},p=this._transitionablePaint._values[\"color-relief-color\"].value.expression;if(p instanceof Sh&&p._styleExpression.expression instanceof sa){this.colorRampExpression=p;let S=p._styleExpression.expression;u.elevationStops=S.labels,u.colorStops=[];for(let R of u.elevationStops)u.colorStops.push(S.evaluate({globals:{elevation:R}}))}if(u.elevationStops.length<1&&(u.elevationStops=[0],u.colorStops=[Zn.transparent]),u.elevationStops.length<2&&(u.elevationStops.push(u.elevationStops[0]+1),u.colorStops.push(u.colorStops[0])),u.elevationStops.length<=a)return u;let v={elevationStops:[],colorStops:[]},E=(u.elevationStops.length-1)/(a-1);for(let S=0;S<u.elevationStops.length-.5;S+=E)v.elevationStops.push(u.elevationStops[Math.round(S)]),v.colorStops.push(u.colorStops[Math.round(S)]);return yi(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${a}, provided: ${u.elevationStops.length}`),v}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values[\"color-relief-color\"].value.expression}getColorRampTextures(a,u,p){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;let v=this._createColorRamp(u),E=new zl({width:v.colorStops.length,height:1}),S=new zl({width:v.colorStops.length,height:1});for(let R=0;R<v.elevationStops.length;R++){let F=V7(v.elevationStops[R],p);S.setPixel(0,R,new Zn(F.r/255,F.g/255,F.b/255,1)),E.setPixel(0,R,v.colorStops[R])}return this.colorRampTextures={elevationTexture:new z5(a,S,a.gl.RGBA),colorTexture:new z5(a,E,a.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}let ohe=fo([{name:\"a_pos\",components:2,type:\"Int16\"}],4),{members:she}=ohe;function aE(h,a,u){let p=u.patternDependencies,v=!1;for(let E of a){let S=E.paint.get(`${h}-pattern`);S.isConstant()||(v=!0);let R=S.constantOr(null);R&&(v=!0,p[R.to]=!0,p[R.from]=!0)}return v}function U5(h,a,u,p,v){let{zoom:E}=p,S=v.patternDependencies;for(let R of a){let F=R.paint.get(`${h}-pattern`).value;if(F.kind!==\"constant\"){let U=F.evaluate({zoom:E-1},u,{},v.availableImages),H=F.evaluate({zoom:E},u,{},v.availableImages),X=F.evaluate({zoom:E+1},u,{},v.availableImages);U=U&&U.name?U.name:U,H=H&&H.name?H.name:H,X=X&&X.name?X.name:X,S[U]=!0,S[H]=!0,S[X]=!0,u.patterns[R.id]={min:U,mid:H,max:X}}}return u}function G7(h,a,u,p,v){let E;if(v===(function(S,R,F,U){let H=0;for(let X=R,$=F-U;X<F;X+=U)H+=(S[$]-S[X])*(S[X+1]+S[$+1]),$=X;return H})(h,a,u,p)>0)for(let S=a;S<u;S+=p)E=X7(S/p|0,h[S],h[S+1],E);else for(let S=u-p;S>=a;S-=p)E=X7(S/p|0,h[S],h[S+1],E);return E&&$_(E,E.next)&&(Dx(E),E=E.next),E}function Wg(h,a){if(!h)return h;a||(a=h);let u,p=h;do if(u=!1,p.steiner||!$_(p,p.next)&&Wo(p.prev,p,p.next)!==0)p=p.next;else{if(Dx(p),p=a=p.prev,p===p.next)break;u=!0}while(u||p!==a);return a}function Px(h,a,u,p,v,E,S){if(!h)return;!S&&E&&(function(F,U,H,X){let $=F;do $.z===0&&($.z=V5($.x,$.y,U,H,X)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==F);$.prevZ.nextZ=null,$.prevZ=null,(function(te){let oe,le=1;do{let ue,me=te;te=null;let Le=null;for(oe=0;me;){oe++;let ye=me,we=0;for(let je=0;je<le&&(we++,ye=ye.nextZ,ye);je++);let ke=le;for(;we>0||ke>0&&ye;)we!==0&&(ke===0||!ye||me.z<=ye.z)?(ue=me,me=me.nextZ,we--):(ue=ye,ye=ye.nextZ,ke--),Le?Le.nextZ=ue:te=ue,ue.prevZ=Le,Le=ue;me=ye}Le.nextZ=null,le*=2}while(oe>1)})($)})(h,p,v,E);let R=h;for(;h.prev!==h.next;){let F=h.prev,U=h.next;if(E?lhe(h,p,v,E):ahe(h))a.push(F.i,h.i,U.i),Dx(h),h=U.next,R=U.next;else if((h=U)===R){S?S===1?Px(h=che(Wg(h),a),a,u,p,v,E,2):S===2&&uhe(h,a,u,p,v,E):Px(Wg(h),a,u,p,v,E,1);break}}}function ahe(h){let a=h.prev,u=h,p=h.next;if(Wo(a,u,p)>=0)return!1;let v=a.x,E=u.x,S=p.x,R=a.y,F=u.y,U=p.y,H=Math.min(v,E,S),X=Math.min(R,F,U),$=Math.max(v,E,S),te=Math.max(R,F,U),oe=p.next;for(;oe!==a;){if(oe.x>=H&&oe.x<=$&&oe.y>=X&&oe.y<=te&&Rx(v,R,E,F,S,U,oe.x,oe.y)&&Wo(oe.prev,oe,oe.next)>=0)return!1;oe=oe.next}return!0}function lhe(h,a,u,p){let v=h.prev,E=h,S=h.next;if(Wo(v,E,S)>=0)return!1;let R=v.x,F=E.x,U=S.x,H=v.y,X=E.y,$=S.y,te=Math.min(R,F,U),oe=Math.min(H,X,$),le=Math.max(R,F,U),ue=Math.max(H,X,$),me=V5(te,oe,a,u,p),Le=V5(le,ue,a,u,p),ye=h.prevZ,we=h.nextZ;for(;ye&&ye.z>=me&&we&&we.z<=Le;){if(ye.x>=te&&ye.x<=le&&ye.y>=oe&&ye.y<=ue&&ye!==v&&ye!==S&&Rx(R,H,F,X,U,$,ye.x,ye.y)&&Wo(ye.prev,ye,ye.next)>=0||(ye=ye.prevZ,we.x>=te&&we.x<=le&&we.y>=oe&&we.y<=ue&&we!==v&&we!==S&&Rx(R,H,F,X,U,$,we.x,we.y)&&Wo(we.prev,we,we.next)>=0))return!1;we=we.nextZ}for(;ye&&ye.z>=me;){if(ye.x>=te&&ye.x<=le&&ye.y>=oe&&ye.y<=ue&&ye!==v&&ye!==S&&Rx(R,H,F,X,U,$,ye.x,ye.y)&&Wo(ye.prev,ye,ye.next)>=0)return!1;ye=ye.prevZ}for(;we&&we.z<=Le;){if(we.x>=te&&we.x<=le&&we.y>=oe&&we.y<=ue&&we!==v&&we!==S&&Rx(R,H,F,X,U,$,we.x,we.y)&&Wo(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function che(h,a){let u=h;do{let p=u.prev,v=u.next.next;!$_(p,v)&&W7(p,u,u.next,v)&&Bx(p,v)&&Bx(v,p)&&(a.push(p.i,u.i,v.i),Dx(u),Dx(u.next),u=h=v),u=u.next}while(u!==h);return Wg(u)}function uhe(h,a,u,p,v,E){let S=h;do{let R=S.next.next;for(;R!==S.prev;){if(S.i!==R.i&&Ahe(S,R)){let F=j7(S,R);return S=Wg(S,S.next),F=Wg(F,F.next),Px(S,a,u,p,v,E,0),void Px(F,a,u,p,v,E,0)}R=R.next}S=S.next}while(S!==h)}function hhe(h,a){let u=h.x-a.x;return u===0&&(u=h.y-a.y,u===0)&&(u=(h.next.y-h.y)/(h.next.x-h.x)-(a.next.y-a.y)/(a.next.x-a.x)),u}function fhe(h,a){let u=(function(v,E){let S=E,R=v.x,F=v.y,U,H=-1/0;if($_(v,S))return S;do{if($_(v,S.next))return S.next;if(F<=S.y&&F>=S.next.y&&S.next.y!==S.y){let le=S.x+(F-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(le<=R&&le>H&&(H=le,U=S.x<S.next.x?S:S.next,le===R))return U}S=S.next}while(S!==E);if(!U)return null;let X=U,$=U.x,te=U.y,oe=1/0;S=U;do{if(R>=S.x&&S.x>=$&&R!==S.x&&H7(F<te?R:H,F,$,te,F<te?H:R,F,S.x,S.y)){let le=Math.abs(F-S.y)/(R-S.x);Bx(S,v)&&(le<oe||le===oe&&(S.x>U.x||S.x===U.x&&dhe(U,S)))&&(U=S,oe=le)}S=S.next}while(S!==X);return U})(h,a);if(!u)return a;let p=j7(u,h);return Wg(p,p.next),Wg(u,u.next)}function dhe(h,a){return Wo(h.prev,h,a.prev)<0&&Wo(a.next,h,h.next)<0}function V5(h,a,u,p,v){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-u)*v|0)|h<<8))|h<<4))|h<<2))|h<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-p)*v|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function phe(h){let a=h,u=h;do(a.x<u.x||a.x===u.x&&a.y<u.y)&&(u=a),a=a.next;while(a!==h);return u}function H7(h,a,u,p,v,E,S,R){return(v-S)*(a-R)>=(h-S)*(E-R)&&(h-S)*(p-R)>=(u-S)*(a-R)&&(u-S)*(E-R)>=(v-S)*(p-R)}function Rx(h,a,u,p,v,E,S,R){return!(h===S&&a===R)&&H7(h,a,u,p,v,E,S,R)}function Ahe(h,a){return h.next.i!==a.i&&h.prev.i!==a.i&&!(function(u,p){let v=u;do{if(v.i!==u.i&&v.next.i!==u.i&&v.i!==p.i&&v.next.i!==p.i&&W7(v,v.next,u,p))return!0;v=v.next}while(v!==u);return!1})(h,a)&&(Bx(h,a)&&Bx(a,h)&&(function(u,p){let v=u,E=!1,S=(u.x+p.x)/2,R=(u.y+p.y)/2;do v.y>R!=v.next.y>R&&v.next.y!==v.y&&S<(v.next.x-v.x)*(R-v.y)/(v.next.y-v.y)+v.x&&(E=!E),v=v.next;while(v!==u);return E})(h,a)&&(Wo(h.prev,h,a.prev)||Wo(h,a.prev,a))||$_(h,a)&&Wo(h.prev,h,h.next)>0&&Wo(a.prev,a,a.next)>0)}function Wo(h,a,u){return(a.y-h.y)*(u.x-a.x)-(a.x-h.x)*(u.y-a.y)}function $_(h,a){return h.x===a.x&&h.y===a.y}function W7(h,a,u,p){let v=cE(Wo(h,a,u)),E=cE(Wo(h,a,p)),S=cE(Wo(u,p,h)),R=cE(Wo(u,p,a));return v!==E&&S!==R||!(v!==0||!lE(h,u,a))||!(E!==0||!lE(h,p,a))||!(S!==0||!lE(u,h,p))||!(R!==0||!lE(u,a,p))}function lE(h,a,u){return a.x<=Math.max(h.x,u.x)&&a.x>=Math.min(h.x,u.x)&&a.y<=Math.max(h.y,u.y)&&a.y>=Math.min(h.y,u.y)}function cE(h){return h>0?1:h<0?-1:0}function Bx(h,a){return Wo(h.prev,h,h.next)<0?Wo(h,a,h.next)>=0&&Wo(h,h.prev,a)>=0:Wo(h,a,h.prev)<0||Wo(h,h.next,a)<0}function j7(h,a){let u=G5(h.i,h.x,h.y),p=G5(a.i,a.x,a.y),v=h.next,E=a.prev;return h.next=a,a.prev=h,u.next=v,v.prev=u,p.next=u,u.prev=p,E.next=p,p.prev=E,p}function X7(h,a,u,p){let v=G5(h,a,u);return p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v),v}function Dx(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function G5(h,a,u){return{i:h,x:a,y:u,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class e1{constructor(a,u){if(u>a)throw new Error(\"Min granularity must not be greater than base granularity.\");this._baseZoomGranularity=a,this._minGranularity=u}getGranularityForZoomLevel(a){return Math.max(Math.floor(this._baseZoomGranularity/(1<<a)),this._minGranularity,1)}}class uE{constructor(a){this.fill=a.fill,this.line=a.line,this.tile=a.tile,this.stencil=a.stencil,this.circle=a.circle}}uE.noSubdivision=new uE({fill:new e1(0,0),line:new e1(0,0),tile:new e1(0,0),stencil:new e1(0,0),circle:1}),un(\"SubdivisionGranularityExpression\",e1),un(\"SubdivisionGranularitySetting\",uE);let t1=-32768,Lx=32767;class ghe{constructor(a,u){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=a,this._granularityCellSize=rn/a,this._canonical=u}_getKey(a,u){return(a+=32768)<<16|u+32768}_vertexToIndex(a,u){if(a<-32768||u<-32768||a>32767||u>32767)throw new Error(\"Vertex coordinates are out of signed 16 bit integer range.\");let p=0|Math.round(a),v=0|Math.round(u),E=this._getKey(p,v);if(this._vertexDictionary.has(E))return this._vertexDictionary.get(E);let S=this._vertexBuffer.length/2;return this._vertexDictionary.set(E,S),this._vertexBuffer.push(p,v),S}_subdivideTrianglesScanline(a){if(this._granularity<2)return(function(v,E){let S=[];for(let R=0;R<E.length;R+=3){let F=E[R],U=E[R+1],H=E[R+2],X=v[2*F],$=v[2*F+1];(v[2*U]-X)*(v[2*H+1]-$)-(v[2*U+1]-$)*(v[2*H]-X)>0?(S.push(F),S.push(H),S.push(U)):(S.push(F),S.push(U),S.push(H))}return S})(this._vertexBuffer,a);let u=[],p=a.length;for(let v=0;v<p;v+=3){let E=[a[v+0],a[v+1],a[v+2]],S=[this._vertexBuffer[2*a[v+0]+0],this._vertexBuffer[2*a[v+0]+1],this._vertexBuffer[2*a[v+1]+0],this._vertexBuffer[2*a[v+1]+1],this._vertexBuffer[2*a[v+2]+0],this._vertexBuffer[2*a[v+2]+1]],R=1/0,F=1/0,U=-1/0,H=-1/0;for(let le=0;le<3;le++){let ue=S[2*le],me=S[2*le+1];R=Math.min(R,ue),U=Math.max(U,ue),F=Math.min(F,me),H=Math.max(H,me)}if(R===U||F===H)continue;let X=Math.floor(R/this._granularityCellSize),$=Math.ceil(U/this._granularityCellSize),te=Math.floor(F/this._granularityCellSize),oe=Math.ceil(H/this._granularityCellSize);if(X!==$||te!==oe)for(let le=te;le<oe;le++){let ue=this._scanlineGenerateVertexRingForCellRow(le,S,E);mhe(this._vertexBuffer,ue,u)}else u.push(...E)}return u}_scanlineGenerateVertexRingForCellRow(a,u,p){let v=a*this._granularityCellSize,E=v+this._granularityCellSize,S=[];for(let R=0;R<3;R++){let F=u[2*R],U=u[2*R+1],H=u[2*(R+1)%6],X=u[(2*(R+1)+1)%6],$=u[2*(R+2)%6],te=u[(2*(R+2)+1)%6],oe=H-F,le=X-U,ue=oe===0,me=le===0,Le=(v-U)/le,ye=(E-U)/le,we=Math.min(Le,ye),ke=Math.max(Le,ye);if(!me&&(we>=1||ke<=0)||me&&(U<v||U>E)){X>=v&&X<=E&&S.push(p[(R+1)%3]);continue}!me&&we>0&&S.push(this._vertexToIndex(F+oe*we,U+le*we));let je=F+oe*Math.max(we,0),ht=F+oe*Math.min(ke,1);ue||this._generateIntraEdgeVertices(S,F,U,H,X,je,ht),!me&&ke<1&&S.push(this._vertexToIndex(F+oe*ke,U+le*ke)),(me||X>=v&&X<=E)&&S.push(p[(R+1)%3]),!me&&(X<=v||X>=E)&&this._generateInterEdgeVertices(S,F,U,H,X,$,te,ht,v,E)}return S}_generateIntraEdgeVertices(a,u,p,v,E,S,R){let F=v-u,U=E-p,H=U===0,X=H?Math.min(u,v):Math.min(S,R),$=H?Math.max(u,v):Math.max(S,R),te=Math.floor(X/this._granularityCellSize)+1,oe=Math.ceil($/this._granularityCellSize)-1;if(H?u<v:S<R)for(let le=te;le<=oe;le++){let ue=le*this._granularityCellSize;a.push(this._vertexToIndex(ue,p+U*(ue-u)/F))}else for(let le=oe;le>=te;le--){let ue=le*this._granularityCellSize;a.push(this._vertexToIndex(ue,p+U*(ue-u)/F))}}_generateInterEdgeVertices(a,u,p,v,E,S,R,F,U,H){let X=E-p,$=S-v,te=R-E,oe=(U-E)/te,le=(H-E)/te,ue=Math.min(oe,le),me=Math.max(oe,le),Le=v+$*ue,ye=Math.floor(Math.min(Le,F)/this._granularityCellSize)+1,we=Math.ceil(Math.max(Le,F)/this._granularityCellSize)-1,ke=F<Le,je=te===0;if(je&&(R===U||R===H))return;if(je||ue>=1||me<=0){let It=p-R,wt=S+(u-S)*Math.min((U-R)/It,(H-R)/It);ye=Math.floor(Math.min(wt,F)/this._granularityCellSize)+1,we=Math.ceil(Math.max(wt,F)/this._granularityCellSize)-1,ke=F<wt}let ht=X>0?H:U;if(ke)for(let It=ye;It<=we;It++)a.push(this._vertexToIndex(It*this._granularityCellSize,ht));else for(let It=we;It>=ye;It--)a.push(this._vertexToIndex(It*this._granularityCellSize,ht))}_generateOutline(a){let u=[];for(let p of a){let v=jg(p,this._granularity,!0),E=this._pointArrayToIndices(v),S=[];for(let R=1;R<E.length;R++)S.push(E[R-1]),S.push(E[R]);u.push(S)}return u}_handlePoles(a){let u=!1,p=!1;this._canonical&&(this._canonical.y===0&&(u=!0),this._canonical.y===(1<<this._canonical.z)-1&&(p=!0)),(u||p)&&this._fillPoles(a,u,p)}_ensureNoPoleVertices(){let a=this._vertexBuffer;for(let u=0;u<a.length;u+=2){let p=a[u+1];p===t1&&(a[u+1]=-32767),p===Lx&&(a[u+1]=32766)}}_generatePoleQuad(a,u,p,v,E,S){v>E!=(S===t1)?(a.push(u),a.push(p),a.push(this._vertexToIndex(v,S)),a.push(p),a.push(this._vertexToIndex(E,S)),a.push(this._vertexToIndex(v,S))):(a.push(p),a.push(u),a.push(this._vertexToIndex(v,S)),a.push(this._vertexToIndex(E,S)),a.push(p),a.push(this._vertexToIndex(v,S)))}_fillPoles(a,u,p){let v=this._vertexBuffer,E=rn,S=a.length;for(let R=2;R<S;R+=3){let F=a[R-2],U=a[R-1],H=a[R],X=v[2*F],$=v[2*F+1],te=v[2*U],oe=v[2*U+1],le=v[2*H],ue=v[2*H+1];u&&($===0&&oe===0&&this._generatePoleQuad(a,F,U,X,te,t1),oe===0&&ue===0&&this._generatePoleQuad(a,U,H,te,le,t1),ue===0&&$===0&&this._generatePoleQuad(a,H,F,le,X,t1)),p&&($===E&&oe===E&&this._generatePoleQuad(a,F,U,X,te,Lx),oe===E&&ue===E&&this._generatePoleQuad(a,U,H,te,le,Lx),ue===E&&$===E&&this._generatePoleQuad(a,H,F,le,X,Lx))}}_initializeVertices(a){for(let u=0;u<a.length;u+=2)this._vertexToIndex(a[u],a[u+1])}subdividePolygonInternal(a,u){if(this._used)throw new Error(\"Subdivision: multiple use not allowed.\");this._used=!0;let{flattened:p,holeIndices:v}=(function(R){let F=[],U=[];for(let H of R)if(H.length!==0){H!==R[0]&&F.push(U.length/2);for(let X=0;X<H.length;X++)U.push(H[X].x),U.push(H[X].y)}return{flattened:U,holeIndices:F}})(a),E;this._initializeVertices(p);try{let R=(function(U,H,X=2){let $=H&&H.length,te=$?H[0]*X:U.length,oe=G7(U,0,te,X,!0),le=[];if(!oe||oe.next===oe.prev)return le;let ue,me,Le;if($&&(oe=(function(ye,we,ke,je){let ht=[];for(let It=0,wt=we.length;It<wt;It++){let Rt=G7(ye,we[It]*je,It<wt-1?we[It+1]*je:ye.length,je,!1);Rt===Rt.next&&(Rt.steiner=!0),ht.push(phe(Rt))}ht.sort(hhe);for(let It=0;It<ht.length;It++)ke=fhe(ht[It],ke);return ke})(U,H,oe,X)),U.length>80*X){ue=U[0],me=U[1];let ye=ue,we=me;for(let ke=X;ke<te;ke+=X){let je=U[ke],ht=U[ke+1];je<ue&&(ue=je),ht<me&&(me=ht),je>ye&&(ye=je),ht>we&&(we=ht)}Le=Math.max(ye-ue,we-me),Le=Le!==0?32767/Le:0}return Px(oe,le,X,ue,me,Le,0),le})(p,v),F=this._convertIndices(p,R);E=this._subdivideTrianglesScanline(F)}catch(R){console.error(R)}let S=[];return u&&(S=this._generateOutline(a)),this._ensureNoPoleVertices(),this._handlePoles(E),{verticesFlattened:this._vertexBuffer,indicesTriangles:E,indicesLineList:S}}_convertIndices(a,u){let p=[];for(let v=0;v<u.length;v++)p.push(this._vertexToIndex(a[2*u[v]],a[2*u[v]+1]));return p}_pointArrayToIndices(a){let u=[];for(let p=0;p<a.length;p++){let v=a[p];u.push(this._vertexToIndex(v.x,v.y))}return u}}function Y7(h,a,u,p=!0){return new ghe(u,a).subdividePolygonInternal(h,p)}function jg(h,a,u=!1){if(!h||h.length<1)return[];if(h.length<2)return[];let p=h[0],v=h[h.length-1],E=u&&(p.x!==v.x||p.y!==v.y);if(a<2)return E?[...h,h[0]]:[...h];let S=Math.floor(rn/a),R=[];R.push(new s(h[0].x,h[0].y));let F=h.length,U=E?F:F-1;for(let H=0;H<U;H++){let X=h[H],$=H<F-1?h[H+1]:h[0],te=X.x,oe=X.y,le=$.x,ue=$.y,me=te!==le,Le=oe!==ue;if(!me&&!Le)continue;let ye=le-te,we=ue-oe,ke=Math.abs(ye),je=Math.abs(we),ht=te,It=oe;for(;;){let Rt=ye>0?(Math.floor(ht/S)+1)*S:(Math.ceil(ht/S)-1)*S,Qt=we>0?(Math.floor(It/S)+1)*S:(Math.ceil(It/S)-1)*S,Gt=Math.abs(ht-Rt),bt=Math.abs(It-Qt),_t=Math.abs(ht-le),cn=Math.abs(It-ue),nn=me?Gt/ke:Number.POSITIVE_INFINITY,An=Le?bt/je:Number.POSITIVE_INFINITY;if((_t<=Gt||!me)&&(cn<=bt||!Le))break;if(nn<An&&me||!Le){ht=Rt,It+=we*nn;let an=new s(ht,Math.round(It));R[R.length-1].x===an.x&&R[R.length-1].y===an.y||R.push(an)}else{ht+=ye*An,It=Qt;let an=new s(Math.round(ht),It);R[R.length-1].x===an.x&&R[R.length-1].y===an.y||R.push(an)}}let wt=new s(le,ue);R[R.length-1].x===wt.x&&R[R.length-1].y===wt.y||R.push(wt)}return R}function mhe(h,a,u){if(a.length===0)throw new Error(\"Subdivision vertex ring is empty.\");let p=0,v=h[2*a[0]];for(let F=1;F<a.length;F++){let U=h[2*a[F]];U<v&&(v=U,p=F)}let E=a.length,S=p,R=(S+1)%E;for(;;){let F=S-1>=0?S-1:E-1,U=(R+1)%E,H=h[2*a[F]],X=h[2*a[U]],$=h[2*a[S]],te=h[2*a[S]+1],oe=h[2*a[R]+1],le=!1;if(H<X)le=!0;else if(H>X)le=!1;else{let ue=oe-te,me=-(h[2*a[R]]-$),Le=te<oe?1:-1;((H-$)*ue+(h[2*a[F]+1]-te)*me)*Le>((X-$)*ue+(h[2*a[U]+1]-te)*me)*Le&&(le=!0)}if(le){let ue=a[F],me=a[S],Le=a[R];ue!==me&&ue!==Le&&me!==Le&&u.push(Le,me,ue),S--,S<0&&(S=E-1)}else{let ue=a[U],me=a[S],Le=a[R];ue!==me&&ue!==Le&&me!==Le&&u.push(Le,me,ue),R++,R>=E&&(R=0)}if(F===U)break}}function Z7(h,a,u,p,v,E,S,R,F){let U=v.length/2,H=S&&R&&F;if(U<Jt.MAX_VERTEX_ARRAY_LENGTH){let X=a.prepareSegment(U,u,p),$=X.vertexLength;for(let le=0;le<E.length;le+=3)p.emplaceBack($+E[le],$+E[le+1],$+E[le+2]);let te,oe;X.vertexLength+=U,X.primitiveLength+=E.length/3,H&&(oe=S.prepareSegment(U,u,R),te=oe.vertexLength,oe.vertexLength+=U);for(let le=0;le<v.length;le+=2)h(v[le],v[le+1]);if(H)for(let le=0;le<F.length;le++){let ue=F[le];for(let me=1;me<ue.length;me+=2)R.emplaceBack(te+ue[me-1],te+ue[me]);oe.primitiveLength+=ue.length/2}}else(function(X,$,te,oe,le,ue){let me=[];for(let je=0;je<oe.length/2;je++)me.push(-1);let Le={count:0},ye=0,we=X.getOrCreateLatestSegment($,te),ke=we.vertexLength;for(let je=2;je<le.length;je+=3){let ht=le[je-2],It=le[je-1],wt=le[je],Rt=me[ht]<ye,Qt=me[It]<ye,Gt=me[wt]<ye;we.vertexLength+((Rt?1:0)+(Qt?1:0)+(Gt?1:0))>Jt.MAX_VERTEX_ARRAY_LENGTH&&(we=X.createNewSegment($,te),ye=Le.count,Rt=!0,Qt=!0,Gt=!0,ke=0);let bt=Ox(me,oe,ue,Le,ht,Rt,we),_t=Ox(me,oe,ue,Le,It,Qt,we),cn=Ox(me,oe,ue,Le,wt,Gt,we);te.emplaceBack(ke+bt-ye,ke+_t-ye,ke+cn-ye),we.primitiveLength++}})(a,u,p,v,E,h),H&&(function(X,$,te,oe,le,ue){let me=[];for(let je=0;je<oe.length/2;je++)me.push(-1);let Le={count:0},ye=0,we=X.getOrCreateLatestSegment($,te),ke=we.vertexLength;for(let je=0;je<le.length;je++){let ht=le[je];for(let It=1;It<le[je].length;It+=2){let wt=ht[It-1],Rt=ht[It],Qt=me[wt]<ye,Gt=me[Rt]<ye;we.vertexLength+((Qt?1:0)+(Gt?1:0))>Jt.MAX_VERTEX_ARRAY_LENGTH&&(we=X.createNewSegment($,te),ye=Le.count,Qt=!0,Gt=!0,ke=0);let bt=Ox(me,oe,ue,Le,wt,Qt,we),_t=Ox(me,oe,ue,Le,Rt,Gt,we);te.emplaceBack(ke+bt-ye,ke+_t-ye),we.primitiveLength++}}})(S,u,R,v,F,h),a.forceNewSegmentOnNextPrepare(),S?.forceNewSegmentOnNextPrepare()}function Ox(h,a,u,p,v,E,S){if(E){let R=p.count;return u(a[2*v],a[2*v+1]),h[v]=p.count,p.count++,S.vertexLength++,R}return h[v]}class H5{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map((u=>u.id)),this.index=a.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Me,this.indexArray=new ft,this.indexArray2=new Xt,this.programConfigurations=new at(a.layers,a.zoom),this.segments=new Jt,this.segments2=new Jt,this.stateDependentLayerIds=this.layers.filter((u=>u.isStateDependent())).map((u=>u.id))}populate(a,u,p){this.hasDependencies=aE(\"fill\",this.layers,u);let v=this.layers[0].layout.get(\"fill-sort-key\"),E=!v.isConstant(),S=[];for(let{feature:R,id:F,index:U,sourceLayerIndex:H}of a){let X=this.layers[0]._featureFilter.needGeometry,$=Vn(R,X);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),$,p))continue;let te=E?v.evaluate($,{},p,u.availableImages):void 0,oe={id:F,properties:R.properties,type:R.type,sourceLayerIndex:H,index:U,geometry:X?$.geometry:dn(R),patterns:{},sortKey:te};S.push(oe)}E&&S.sort(((R,F)=>R.sortKey-F.sortKey));for(let R of S){let{geometry:F,index:U,sourceLayerIndex:H}=R;if(this.hasDependencies){let X=U5(\"fill\",this.layers,R,{zoom:this.zoom},u);this.patternFeatures.push(X)}else this.addFeature(R,F,U,p,{},u.subdivisionGranularity);u.featureIndex.insert(a[U].feature,F,U,H,this.index)}}update(a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,{imagePositions:p})}addFeatures(a,u,p){for(let v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,u,p,a.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,she),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,u,p,v,E,S){for(let R of ve(u,500)){let F=Y7(R,v,S.fill.getGranularityForZoomLevel(v.z)),U=this.layoutVertexArray;Z7(((H,X)=>{U.emplaceBack(H,X)}),this.segments,this.layoutVertexArray,this.indexArray,F.verticesFlattened,F.indicesTriangles,this.segments2,this.indexArray2,F.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,{imagePositions:E,canonical:v})}}let q7,Q7;un(\"FillBucket\",H5,{omit:[\"layers\",\"patternFeatures\"]});var _he={get paint(){return Q7=Q7||new qs({\"fill-antialias\":new yn(Ke.paint_fill[\"fill-antialias\"]),\"fill-opacity\":new Rn(Ke.paint_fill[\"fill-opacity\"]),\"fill-color\":new Rn(Ke.paint_fill[\"fill-color\"]),\"fill-outline-color\":new Rn(Ke.paint_fill[\"fill-outline-color\"]),\"fill-translate\":new yn(Ke.paint_fill[\"fill-translate\"]),\"fill-translate-anchor\":new yn(Ke.paint_fill[\"fill-translate-anchor\"]),\"fill-pattern\":new jd(Ke.paint_fill[\"fill-pattern\"])})},get layout(){return q7=q7||new qs({\"fill-sort-key\":new Rn(Ke.layout_fill[\"fill-sort-key\"])})}};class yhe extends ka{constructor(a,u){super(a,_he,u)}recalculate(a,u){super.recalculate(a,u);let p=this.paint._values[\"fill-outline-color\"];p.value.kind===\"constant\"&&p.value.value===void 0&&(this.paint._values[\"fill-outline-color\"]=this.paint._values[\"fill-color\"])}createBucket(a){return new H5(a)}queryRadius(){return oE(this.paint.get(\"fill-translate\"))}queryIntersectsFeature({queryGeometry:a,geometry:u,transform:p,pixelsToTileUnits:v}){return hr(sE(a,this.paint.get(\"fill-translate\"),this.paint.get(\"fill-translate-anchor\"),-p.bearingInRadians,v),u)}isTileClipped(){return!0}}let xhe=fo([{name:\"a_pos\",components:2,type:\"Int16\"},{name:\"a_normal_ed\",components:4,type:\"Int16\"}],4),vhe=fo([{name:\"a_centroid\",components:2,type:\"Int16\"}],4),{members:bhe}=xhe;class Fx{constructor(a,u,p,v,E){this.properties={},this.extent=p,this.type=0,this.id=void 0,this._pbf=a,this._geometry=-1,this._keys=v,this._values=E,a.readFields(whe,this,u)}loadGeometry(){let a=this._pbf;a.pos=this._geometry;let u=a.readVarint()+a.pos,p=[],v,E=1,S=0,R=0,F=0;for(;a.pos<u;){if(S<=0){let U=a.readVarint();E=7&U,S=U>>3}if(S--,E===1||E===2)R+=a.readSVarint(),F+=a.readSVarint(),E===1&&(v&&p.push(v),v=[]),v&&v.push(new s(R,F));else{if(E!==7)throw new Error(`unknown command ${E}`);v&&v.push(v[0].clone())}}return v&&p.push(v),p}bbox(){let a=this._pbf;a.pos=this._geometry;let u=a.readVarint()+a.pos,p=1,v=0,E=0,S=0,R=1/0,F=-1/0,U=1/0,H=-1/0;for(;a.pos<u;){if(v<=0){let X=a.readVarint();p=7&X,v=X>>3}if(v--,p===1||p===2)E+=a.readSVarint(),S+=a.readSVarint(),E<R&&(R=E),E>F&&(F=E),S<U&&(U=S),S>H&&(H=S);else if(p!==7)throw new Error(`unknown command ${p}`)}return[R,U,F,H]}toGeoJSON(a,u,p){let v=this.extent*Math.pow(2,p),E=this.extent*a,S=this.extent*u,R=this.loadGeometry();function F($){return[360*($.x+E)/v-180,360/Math.PI*Math.atan(Math.exp((1-2*($.y+S)/v)*Math.PI))-90]}function U($){return $.map(F)}let H;if(this.type===1){let $=[];for(let oe of R)$.push(oe[0]);let te=U($);H=$.length===1?{type:\"Point\",coordinates:te[0]}:{type:\"MultiPoint\",coordinates:te}}else if(this.type===2){let $=R.map(U);H=$.length===1?{type:\"LineString\",coordinates:$[0]}:{type:\"MultiLineString\",coordinates:$}}else{if(this.type!==3)throw new Error(\"unknown feature type\");{let $=K7(R),te=[];for(let oe of $)te.push(oe.map(U));H=te.length===1?{type:\"Polygon\",coordinates:te[0]}:{type:\"MultiPolygon\",coordinates:te}}}let X={type:\"Feature\",geometry:H,properties:this.properties};return this.id!=null&&(X.id=this.id),X}}function whe(h,a,u){h===1?a.id=u.readVarint():h===2?(function(p,v){let E=p.readVarint()+p.pos;for(;p.pos<E;){let S=v._keys[p.readVarint()],R=v._values[p.readVarint()];v.properties[S]=R}})(u,a):h===3?a.type=u.readVarint():h===4&&(a._geometry=u.pos)}function K7(h){let a=h.length;if(a<=1)return[h];let u=[],p,v;for(let E=0;E<a;E++){let S=The(h[E]);S!==0&&(v===void 0&&(v=S<0),v===S<0?(p&&u.push(p),p=[h[E]]):p&&p.push(h[E]))}return p&&u.push(p),u}function The(h){let a=0;for(let u,p,v=0,E=h.length,S=E-1;v<E;S=v++)u=h[v],p=h[S],a+=(p.x-u.x)*(u.y+p.y);return a}Fx.types=[\"Unknown\",\"Point\",\"LineString\",\"Polygon\"];class Ehe{constructor(a,u){this.version=1,this.name=\"\",this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(She,this,u),this.length=this._features.length}feature(a){if(a<0||a>=this._features.length)throw new Error(\"feature index out of bounds\");this._pbf.pos=this._features[a];let u=this._pbf.readVarint()+this._pbf.pos;return new Fx(this._pbf,u,this.extent,this._keys,this._values)}}function She(h,a,u){h===15?a.version=u.readVarint():h===1?a.name=u.readString():h===5?a.extent=u.readVarint():h===2?a._features.push(u.pos):h===3?a._keys.push(u.readString()):h===4&&a._values.push((function(p){let v=null,E=p.readVarint()+p.pos;for(;p.pos<E;){let S=p.readVarint()>>3;v=S===1?p.readString():S===2?p.readFloat():S===3?p.readDouble():S===4?p.readVarint64():S===5?p.readVarint():S===6?p.readSVarint():S===7?p.readBoolean():null}if(v==null)throw new Error(\"unknown feature value\");return v})(u))}class J7{constructor(a,u){this.layers=a.readFields(Che,{},u)}}function Che(h,a,u){if(h===3){let p=new Ehe(u,u.readVarint()+u.pos);p.length&&(a[p.name]=p)}}let W5=Math.pow(2,13);function kx(h,a,u,p,v,E,S,R){h.emplaceBack(a,u,2*Math.floor(p*W5)+S,v*W5*2,E*W5*2,Math.round(R))}class j5{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map((u=>u.id)),this.index=a.index,this.hasDependencies=!1,this.layoutVertexArray=new Oe,this.centroidVertexArray=new Te,this.indexArray=new ft,this.programConfigurations=new at(a.layers,a.zoom),this.segments=new Jt,this.stateDependentLayerIds=this.layers.filter((u=>u.isStateDependent())).map((u=>u.id))}populate(a,u,p){this.features=[],this.hasDependencies=aE(\"fill-extrusion\",this.layers,u);for(let{feature:v,id:E,index:S,sourceLayerIndex:R}of a){let F=this.layers[0]._featureFilter.needGeometry,U=Vn(v,F);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),U,p))continue;let H={id:E,sourceLayerIndex:R,index:S,geometry:F?U.geometry:dn(v),properties:v.properties,type:v.type,patterns:{}};this.hasDependencies?this.features.push(U5(\"fill-extrusion\",this.layers,H,{zoom:this.zoom},u)):this.addFeature(H,H.geometry,S,p,{},u.subdivisionGranularity),u.featureIndex.insert(v,H.geometry,S,R,this.index,!0)}}addFeatures(a,u,p){for(let v of this.features){let{geometry:E}=v;this.addFeature(v,E,v.index,u,p,a.subdivisionGranularity)}}update(a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,{imagePositions:p})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,bhe),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,vhe.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,u,p,v,E,S){for(let R of ve(u,500)){let F={x:0,y:0,sampleCount:0},U=this.layoutVertexArray.length;this.processPolygon(F,v,a,R,S);let H=this.layoutVertexArray.length-U,X=Math.floor(F.x/F.sampleCount),$=Math.floor(F.y/F.sampleCount);for(let te=0;te<H;te++)this.centroidVertexArray.emplaceBack(X,$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,{imagePositions:E,canonical:v})}processPolygon(a,u,p,v,E){if(v.length<1||$7(v[0]))return;for(let X of v)X.length!==0&&Mhe(a,X);let S={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},R=E.fill.getGranularityForZoomLevel(u.z),F=Fx.types[p.type]===\"Polygon\";for(let X of v){if(X.length===0||$7(X))continue;let $=jg(X,R,F);this._generateSideFaces($,S)}if(!F)return;let U=Y7(v,u,R,!1),H=this.layoutVertexArray;Z7(((X,$)=>{kx(H,X,$,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,U.verticesFlattened,U.indicesTriangles)}_generateSideFaces(a,u){let p=0;for(let v=1;v<a.length;v++){let E=a[v],S=a[v-1];if(Ihe(E,S))continue;u.segment.vertexLength+4>Jt.MAX_VERTEX_ARRAY_LENGTH&&(u.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let R=E.sub(S)._perp()._unit(),F=S.dist(E);p+F>32768&&(p=0),kx(this.layoutVertexArray,E.x,E.y,R.x,R.y,0,0,p),kx(this.layoutVertexArray,E.x,E.y,R.x,R.y,0,1,p),p+=F,kx(this.layoutVertexArray,S.x,S.y,R.x,R.y,0,0,p),kx(this.layoutVertexArray,S.x,S.y,R.x,R.y,0,1,p);let U=u.segment.vertexLength;this.indexArray.emplaceBack(U,U+2,U+1),this.indexArray.emplaceBack(U+1,U+2,U+3),u.segment.vertexLength+=4,u.segment.primitiveLength+=2}}}function Mhe(h,a){for(let u=0;u<a.length;u++){let p=a[u];u===a.length-1&&a[0].x===p.x&&a[0].y===p.y||(h.x+=p.x,h.y+=p.y,h.sampleCount++)}}function Ihe(h,a){return h.x===a.x&&(h.x<0||h.x>rn)||h.y===a.y&&(h.y<0||h.y>rn)}function $7(h){return h.every((a=>a.x<0))||h.every((a=>a.x>rn))||h.every((a=>a.y<0))||h.every((a=>a.y>rn))}let eU;un(\"FillExtrusionBucket\",j5,{omit:[\"layers\",\"features\"]});var Phe={get paint(){return eU=eU||new qs({\"fill-extrusion-opacity\":new yn(Ke[\"paint_fill-extrusion\"][\"fill-extrusion-opacity\"]),\"fill-extrusion-color\":new Rn(Ke[\"paint_fill-extrusion\"][\"fill-extrusion-color\"]),\"fill-extrusion-translate\":new yn(Ke[\"paint_fill-extrusion\"][\"fill-extrusion-translate\"]),\"fill-extrusion-translate-anchor\":new yn(Ke[\"paint_fill-extrusion\"][\"fill-extrusion-translate-anchor\"]),\"fill-extrusion-pattern\":new jd(Ke[\"paint_fill-extrusion\"][\"fill-extrusion-pattern\"]),\"fill-extrusion-height\":new Rn(Ke[\"paint_fill-extrusion\"][\"fill-extrusion-height\"]),\"fill-extrusion-base\":new Rn(Ke[\"paint_fill-extrusion\"][\"fill-extrusion-base\"]),\"fill-extrusion-vertical-gradient\":new yn(Ke[\"paint_fill-extrusion\"][\"fill-extrusion-vertical-gradient\"])})}};class Rhe extends ka{constructor(a,u){super(a,Phe,u)}createBucket(a){return new j5(a)}queryRadius(){return oE(this.paint.get(\"fill-extrusion-translate\"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:a,feature:u,featureState:p,geometry:v,transform:E,pixelsToTileUnits:S,pixelPosMatrix:R}){let F=sE(a,this.paint.get(\"fill-extrusion-translate\"),this.paint.get(\"fill-extrusion-translate-anchor\"),-E.bearingInRadians,S),U=this.paint.get(\"fill-extrusion-height\").evaluate(u,p),H=this.paint.get(\"fill-extrusion-base\").evaluate(u,p),X=(function(te,oe){let le=[];for(let ue of te){let me=[ue.x,ue.y,0,1];Ct(me,me,oe),le.push(new s(me[0]/me[3],me[1]/me[3]))}return le})(F,R),$=(function(te,oe,le,ue){let me=[],Le=[],ye=ue[8]*oe,we=ue[9]*oe,ke=ue[10]*oe,je=ue[11]*oe,ht=ue[8]*le,It=ue[9]*le,wt=ue[10]*le,Rt=ue[11]*le;for(let Qt of te){let Gt=[],bt=[];for(let _t of Qt){let cn=_t.x,nn=_t.y,An=ue[0]*cn+ue[4]*nn+ue[12],an=ue[1]*cn+ue[5]*nn+ue[13],En=ue[2]*cn+ue[6]*nn+ue[14],Dr=ue[3]*cn+ue[7]*nn+ue[15],pr=En+ke,no=Dr+je,da=An+ht,ns=an+It,ro=En+wt,Zi=Dr+Rt,ii=new s((An+ye)/no,(an+we)/no);ii.z=pr/no,Gt.push(ii);let To=new s(da/Zi,ns/Zi);To.z=ro/Zi,bt.push(To)}me.push(Gt),Le.push(bt)}return[me,Le]})(v,H,U,R);return(function(te,oe,le){let ue=1/0;hr(le,oe)&&(ue=tU(le,oe[0]));for(let me=0;me<oe.length;me++){let Le=oe[me],ye=te[me];for(let we=0;we<Le.length-1;we++){let ke=Le[we],je=[ke,Le[we+1],ye[we+1],ye[we],ke];Tn(le,je)&&(ue=Math.min(ue,tU(le,je)))}}return ue!==1/0&&ue})($[0],$[1],X)}}function Nx(h,a){return h.x*a.x+h.y*a.y}function tU(h,a){if(h.length===1){let u=0,p=a[u++],v;for(;!v||p.equals(v);)if(v=a[u++],!v)return 1/0;for(;u<a.length;u++){let E=a[u],S=h[0],R=v.sub(p),F=E.sub(p),U=S.sub(p),H=Nx(R,R),X=Nx(R,F),$=Nx(F,F),te=Nx(U,R),oe=Nx(U,F),le=H*$-X*X,ue=($*te-X*oe)/le,me=(H*oe-X*te)/le,Le=p.z*(1-ue-me)+v.z*ue+E.z*me;if(isFinite(Le))return Le}return 1/0}{let u=1/0;for(let p of a)u=Math.min(u,p.z);return u}}let Bhe=fo([{name:\"a_pos_normal\",components:2,type:\"Int16\"},{name:\"a_data\",components:4,type:\"Uint8\"}],4),{members:Dhe}=Bhe,Lhe=fo([{name:\"a_uv_x\",components:1,type:\"Float32\"},{name:\"a_split_index\",components:1,type:\"Float32\"}]),{members:Ohe}=Lhe,Fhe=Math.cos(Math.PI/180*37.5),nU=Math.pow(2,14)/.5;class X5{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map((u=>u.id)),this.index=a.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((u=>{this.gradients[u.id]={}})),this.layoutVertexArray=new We,this.layoutVertexArray2=new De,this.indexArray=new ft,this.programConfigurations=new at(a.layers,a.zoom),this.segments=new Jt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((u=>u.isStateDependent())).map((u=>u.id))}populate(a,u,p){this.hasDependencies=aE(\"line\",this.layers,u)||this.hasLineDasharray(this.layers);let v=this.layers[0].layout.get(\"line-sort-key\"),E=!v.isConstant(),S=[];for(let{feature:R,id:F,index:U,sourceLayerIndex:H}of a){let X=this.layers[0]._featureFilter.needGeometry,$=Vn(R,X);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),$,p))continue;let te=E?v.evaluate($,{},p):void 0,oe={id:F,properties:R.properties,type:R.type,sourceLayerIndex:H,index:U,geometry:X?$.geometry:dn(R),patterns:{},dashes:{},sortKey:te};S.push(oe)}E&&S.sort(((R,F)=>R.sortKey-F.sortKey));for(let R of S){let{geometry:F,index:U,sourceLayerIndex:H}=R;this.hasDependencies?(aE(\"line\",this.layers,u)?U5(\"line\",this.layers,R,{zoom:this.zoom},u):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,R,this.zoom,u),this.patternFeatures.push(R)):this.addFeature(R,F,U,p,{},{},u.subdivisionGranularity),u.featureIndex.insert(a[U].feature,F,U,H,this.index)}}update(a,u,p,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,{imagePositions:p,dashPositions:v})}addFeatures(a,u,p,v){for(let E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,u,p,v,a.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,Ohe)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Dhe),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,\"mapbox_clip_start\")&&Object.prototype.hasOwnProperty.call(a.properties,\"mapbox_clip_end\"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,u,p,v,E,S,R){let F=this.layers[0].layout,U=F.get(\"line-join\").evaluate(a,{}),H=F.get(\"line-cap\"),X=F.get(\"line-miter-limit\"),$=F.get(\"line-round-limit\");this.lineClips=this.lineFeatureClips(a);for(let te of u)this.addLine(te,a,U,H,X,$,v,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,{imagePositions:E,dashPositions:S,canonical:v})}addLine(a,u,p,v,E,S,R,F){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,a=jg(a,R?F.line.getGranularityForZoomLevel(R.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ye=0;ye<a.length-1;ye++)this.totalDistance+=a[ye].dist(a[ye+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let U=Fx.types[u.type]===\"Polygon\",H=a.length;for(;H>=2&&a[H-1].equals(a[H-2]);)H--;let X=0;for(;X<H-1&&a[X].equals(a[X+1]);)X++;if(H<(U?3:2))return;p===\"bevel\"&&(E=1.05);let $=this.overscaling<=16?122880/(512*this.overscaling):0,te=this.segments.prepareSegment(10*H,this.layoutVertexArray,this.indexArray),oe,le,ue,me,Le;this.e1=this.e2=-1,U&&(oe=a[H-2],Le=a[X].sub(oe)._unit()._perp());for(let ye=X;ye<H;ye++){if(ue=ye===H-1?U?a[X+1]:void 0:a[ye+1],ue&&a[ye].equals(ue))continue;Le&&(me=Le),oe&&(le=oe),oe=a[ye],Le=ue?ue.sub(oe)._unit()._perp():me,me=me||Le;let we=me.add(Le);we.x===0&&we.y===0||we._unit();let ke=me.x*Le.x+me.y*Le.y,je=we.x*Le.x+we.y*Le.y,ht=je!==0?1/je:1/0,It=2*Math.sqrt(2-2*je),wt=je<Fhe&&le&&ue,Rt=me.x*Le.y-me.y*Le.x>0;if(wt&&ye>X){let bt=oe.dist(le);if(bt>2*$){let _t=oe.sub(oe.sub(le)._mult($/bt)._round());this.updateDistance(le,_t),this.addCurrentVertex(_t,me,0,0,te),le=_t}}let Qt=le&&ue,Gt=Qt?p:U?\"butt\":v;if(Qt&&Gt===\"round\"&&(ht<S?Gt=\"miter\":ht<=2&&(Gt=\"fakeround\")),Gt===\"miter\"&&ht>E&&(Gt=\"bevel\"),Gt===\"bevel\"&&(ht>2&&(Gt=\"flipbevel\"),ht<E&&(Gt=\"miter\")),le&&this.updateDistance(le,oe),Gt===\"miter\")we._mult(ht),this.addCurrentVertex(oe,we,0,0,te);else if(Gt===\"flipbevel\"){if(ht>100)we=Le.mult(-1);else{let bt=ht*me.add(Le).mag()/me.sub(Le).mag();we._perp()._mult(bt*(Rt?-1:1))}this.addCurrentVertex(oe,we,0,0,te),this.addCurrentVertex(oe,we.mult(-1),0,0,te)}else if(Gt===\"bevel\"||Gt===\"fakeround\"){let bt=-Math.sqrt(ht*ht-1),_t=Rt?bt:0,cn=Rt?0:bt;if(le&&this.addCurrentVertex(oe,me,_t,cn,te),Gt===\"fakeround\"){let nn=Math.round(180*It/Math.PI/20);for(let An=1;An<nn;An++){let an=An/nn;if(an!==.5){let Dr=an-.5;an+=an*Dr*(an-1)*((1.0904+ke*(ke*(3.55645-1.43519*ke)-3.2452))*Dr*Dr+(.848013+ke*(.215638*ke-1.06021)))}let En=Le.sub(me)._mult(an)._add(me)._unit()._mult(Rt?-1:1);this.addHalfVertex(oe,En.x,En.y,!1,Rt,0,te)}}ue&&this.addCurrentVertex(oe,Le,-_t,-cn,te)}else if(Gt===\"butt\")this.addCurrentVertex(oe,we,0,0,te);else if(Gt===\"square\"){let bt=le?1:-1;this.addCurrentVertex(oe,we,bt,bt,te)}else Gt===\"round\"&&(le&&(this.addCurrentVertex(oe,me,0,0,te),this.addCurrentVertex(oe,me,1,1,te,!0)),ue&&(this.addCurrentVertex(oe,Le,-1,-1,te,!0),this.addCurrentVertex(oe,Le,0,0,te)));if(wt&&ye<H-1){let bt=oe.dist(ue);if(bt>2*$){let _t=oe.add(ue.sub(oe)._mult($/bt)._round());this.updateDistance(oe,_t),this.addCurrentVertex(_t,Le,0,0,te),oe=_t}}}}addCurrentVertex(a,u,p,v,E,S=!1){let R=u.y*v-u.x,F=-u.y-u.x*v;this.addHalfVertex(a,u.x+u.y*p,u.y-u.x*p,S,!1,p,E),this.addHalfVertex(a,R,F,S,!0,-v,E),this.distance>nU/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(a,u,p,v,E,S))}addHalfVertex({x:a,y:u},p,v,E,S,R,F){let U=.5*(this.lineClips?this.scaledDistance*(nU-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(E?1:0),(u<<1)+(S?1:0),Math.round(63*p)+128,Math.round(63*v)+128,1+(R===0?0:R<0?-1:1)|(63&U)<<2,U>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let H=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,H,this.e2),F.primitiveLength++),S?this.e2=H:this.e1=H}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,u){this.distance+=a.dist(u),this.updateScaledDistance()}hasLineDasharray(a){for(let u of a){let p=u.paint.get(\"line-dasharray\");if(p&&!p.isConstant())return!0}return!1}addLineDashDependencies(a,u,p,v){for(let E of a){let S=E.paint.get(\"line-dasharray\");if(!S||S.value.kind===\"constant\")continue;let R=E.layout.get(\"line-cap\")===\"round\",F={dasharray:S.value.evaluate({zoom:p-1},u,{}),round:R},U={dasharray:S.value.evaluate({zoom:p},u,{}),round:R},H={dasharray:S.value.evaluate({zoom:p+1},u,{}),round:R},X=`${F.dasharray.join(\",\")},${F.round}`,$=`${U.dasharray.join(\",\")},${U.round}`,te=`${H.dasharray.join(\",\")},${H.round}`;v.dashDependencies[X]=F,v.dashDependencies[$]=U,v.dashDependencies[te]=H,u.dashes[E.id]={min:X,mid:$,max:te}}}}let rU,iU;un(\"LineBucket\",X5,{omit:[\"layers\",\"patternFeatures\"]});var oU={get paint(){return iU=iU||new qs({\"line-opacity\":new Rn(Ke.paint_line[\"line-opacity\"]),\"line-color\":new Rn(Ke.paint_line[\"line-color\"]),\"line-translate\":new yn(Ke.paint_line[\"line-translate\"]),\"line-translate-anchor\":new yn(Ke.paint_line[\"line-translate-anchor\"]),\"line-width\":new Rn(Ke.paint_line[\"line-width\"]),\"line-gap-width\":new Rn(Ke.paint_line[\"line-gap-width\"]),\"line-offset\":new Rn(Ke.paint_line[\"line-offset\"]),\"line-blur\":new Rn(Ke.paint_line[\"line-blur\"]),\"line-dasharray\":new jd(Ke.paint_line[\"line-dasharray\"]),\"line-pattern\":new jd(Ke.paint_line[\"line-pattern\"]),\"line-gradient\":new Xd(Ke.paint_line[\"line-gradient\"])})},get layout(){return rU=rU||new qs({\"line-cap\":new yn(Ke.layout_line[\"line-cap\"]),\"line-join\":new Rn(Ke.layout_line[\"line-join\"]),\"line-miter-limit\":new yn(Ke.layout_line[\"line-miter-limit\"]),\"line-round-limit\":new yn(Ke.layout_line[\"line-round-limit\"]),\"line-sort-key\":new Rn(Ke.layout_line[\"line-sort-key\"])})}};class khe extends Rn{possiblyEvaluate(a,u){return u=new ci(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(a,u)}evaluate(a,u,p,v){return u=Fn({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(a,u,p,v)}}let hE;class Nhe extends ka{constructor(a,u){super(a,oU,u),this.gradientVersion=0,hE||(hE=new khe(oU.paint.properties[\"line-width\"].specification),hE.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(a){if(a===\"line-gradient\"){let u=this.gradientExpression();this.stepInterpolant=!!(function(p){return p._styleExpression!==void 0})(u)&&u._styleExpression.expression instanceof xh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values[\"line-gradient\"].value.expression}recalculate(a,u){super.recalculate(a,u),this.paint._values[\"line-floorwidth\"]=hE.possiblyEvaluate(this._transitioningPaint._values[\"line-width\"].value,a)}createBucket(a){return new X5(a)}queryRadius(a){let u=a,p=sU(J_(\"line-width\",this,u),J_(\"line-gap-width\",this,u)),v=J_(\"line-offset\",this,u);return p/2+Math.abs(v)+oE(this.paint.get(\"line-translate\"))}queryIntersectsFeature({queryGeometry:a,feature:u,featureState:p,geometry:v,transform:E,pixelsToTileUnits:S}){let R=sE(a,this.paint.get(\"line-translate\"),this.paint.get(\"line-translate-anchor\"),-E.bearingInRadians,S),F=S/2*sU(this.paint.get(\"line-width\").evaluate(u,p),this.paint.get(\"line-gap-width\").evaluate(u,p)),U=this.paint.get(\"line-offset\").evaluate(u,p);return U&&(v=(function(H,X){let $=[];for(let te=0;te<H.length;te++){let oe=Xue(H[te]),le=[];for(let ue=0;ue<oe.length;ue++){let me=oe[ue],Le=oe[ue-1],ye=oe[ue+1],we=ue===0?new s(0,0):me.sub(Le)._unit()._perp(),ke=ue===oe.length-1?new s(0,0):ye.sub(me)._unit()._perp(),je=we._add(ke)._unit(),ht=je.x*ke.x+je.y*ke.y;ht!==0&&je._mult(1/ht),le.push(je._mult(X)._add(me))}$.push(le)}return $})(v,U*S)),(function(H,X,$){for(let te=0;te<X.length;te++){let oe=X[te];if(H.length>=3){for(let le=0;le<oe.length;le++)if(K_(H,oe[le]))return!0}if(wi(H,oe,$))return!0}return!1})(R,v,F)}isTileClipped(){return!0}}function sU(h,a){return a>0?a+2*h:h}let zhe=fo([{name:\"a_pos_offset\",components:4,type:\"Int16\"},{name:\"a_data\",components:4,type:\"Uint16\"},{name:\"a_pixeloffset\",components:4,type:\"Int16\"}],4),Uhe=fo([{name:\"a_projected_pos\",components:3,type:\"Float32\"}],4);fo([{name:\"a_fade_opacity\",components:1,type:\"Uint32\"}],4);let Vhe=fo([{name:\"a_placed\",components:2,type:\"Uint8\"},{name:\"a_shift\",components:2,type:\"Float32\"},{name:\"a_box_real\",components:2,type:\"Int16\"}]);fo([{type:\"Int16\",name:\"anchorPointX\"},{type:\"Int16\",name:\"anchorPointY\"},{type:\"Int16\",name:\"x1\"},{type:\"Int16\",name:\"y1\"},{type:\"Int16\",name:\"x2\"},{type:\"Int16\",name:\"y2\"},{type:\"Uint32\",name:\"featureIndex\"},{type:\"Uint16\",name:\"sourceLayerIndex\"},{type:\"Uint16\",name:\"bucketIndex\"}]);let aU=fo([{name:\"a_pos\",components:2,type:\"Int16\"},{name:\"a_anchor_pos\",components:2,type:\"Int16\"},{name:\"a_extrude\",components:2,type:\"Int16\"}],4),Ghe=fo([{name:\"a_pos\",components:2,type:\"Float32\"},{name:\"a_radius\",components:1,type:\"Float32\"},{name:\"a_flags\",components:2,type:\"Int16\"}],4);function Hhe(h,a,u){return h.sections.forEach((p=>{p.text=(function(v,E,S){let R=E.layout.get(\"text-transform\").evaluate(S,{});return R===\"uppercase\"?v=v.toLocaleUpperCase():R===\"lowercase\"&&(v=v.toLocaleLowerCase()),Iu.applyArabicShaping&&(v=Iu.applyArabicShaping(v)),v})(p.text,a,u)})),h}fo([{name:\"triangle\",components:3,type:\"Uint16\"}]),fo([{type:\"Int16\",name:\"anchorX\"},{type:\"Int16\",name:\"anchorY\"},{type:\"Uint16\",name:\"glyphStartIndex\"},{type:\"Uint16\",name:\"numGlyphs\"},{type:\"Uint32\",name:\"vertexStartIndex\"},{type:\"Uint32\",name:\"lineStartIndex\"},{type:\"Uint32\",name:\"lineLength\"},{type:\"Uint16\",name:\"segment\"},{type:\"Uint16\",name:\"lowerSize\"},{type:\"Uint16\",name:\"upperSize\"},{type:\"Float32\",name:\"lineOffsetX\"},{type:\"Float32\",name:\"lineOffsetY\"},{type:\"Uint8\",name:\"writingMode\"},{type:\"Uint8\",name:\"placedOrientation\"},{type:\"Uint8\",name:\"hidden\"},{type:\"Uint32\",name:\"crossTileID\"},{type:\"Int16\",name:\"associatedIconIndex\"}]),fo([{type:\"Int16\",name:\"anchorX\"},{type:\"Int16\",name:\"anchorY\"},{type:\"Int16\",name:\"rightJustifiedTextSymbolIndex\"},{type:\"Int16\",name:\"centerJustifiedTextSymbolIndex\"},{type:\"Int16\",name:\"leftJustifiedTextSymbolIndex\"},{type:\"Int16\",name:\"verticalPlacedTextSymbolIndex\"},{type:\"Int16\",name:\"placedIconSymbolIndex\"},{type:\"Int16\",name:\"verticalPlacedIconSymbolIndex\"},{type:\"Uint16\",name:\"key\"},{type:\"Uint16\",name:\"textBoxStartIndex\"},{type:\"Uint16\",name:\"textBoxEndIndex\"},{type:\"Uint16\",name:\"verticalTextBoxStartIndex\"},{type:\"Uint16\",name:\"verticalTextBoxEndIndex\"},{type:\"Uint16\",name:\"iconBoxStartIndex\"},{type:\"Uint16\",name:\"iconBoxEndIndex\"},{type:\"Uint16\",name:\"verticalIconBoxStartIndex\"},{type:\"Uint16\",name:\"verticalIconBoxEndIndex\"},{type:\"Uint16\",name:\"featureIndex\"},{type:\"Uint16\",name:\"numHorizontalGlyphVertices\"},{type:\"Uint16\",name:\"numVerticalGlyphVertices\"},{type:\"Uint16\",name:\"numIconVertices\"},{type:\"Uint16\",name:\"numVerticalIconVertices\"},{type:\"Uint16\",name:\"useRuntimeCollisionCircles\"},{type:\"Uint32\",name:\"crossTileID\"},{type:\"Float32\",name:\"textBoxScale\"},{type:\"Float32\",name:\"collisionCircleDiameter\"},{type:\"Uint16\",name:\"textAnchorOffsetStartIndex\"},{type:\"Uint16\",name:\"textAnchorOffsetEndIndex\"}]),fo([{type:\"Float32\",name:\"offsetX\"}]),fo([{type:\"Int16\",name:\"x\"},{type:\"Int16\",name:\"y\"},{type:\"Int16\",name:\"tileUnitDistanceFromAnchor\"}]),fo([{type:\"Uint16\",name:\"textAnchor\"},{type:\"Float32\",components:2,name:\"textOffset\"}]);var Rs=24;let zx={\"!\":\"\\uFE15\",\"#\":\"\\uFF03\",$:\"\\uFF04\",\"%\":\"\\uFF05\",\"&\":\"\\uFF06\",\"(\":\"\\uFE35\",\")\":\"\\uFE36\",\"*\":\"\\uFF0A\",\"+\":\"\\uFF0B\",\",\":\"\\uFE10\",\"-\":\"\\uFE32\",\".\":\"\\u30FB\",\"/\":\"\\uFF0F\",\":\":\"\\uFE13\",\";\":\"\\uFE14\",\"<\":\"\\uFE3F\",\"=\":\"\\uFF1D\",\">\":\"\\uFE40\",\"?\":\"\\uFE16\",\"@\":\"\\uFF20\",\"[\":\"\\uFE47\",\"\\\\\":\"\\uFF3C\",\"]\":\"\\uFE48\",\"^\":\"\\uFF3E\",_:\"\\uFE33\",\"`\":\"\\uFF40\",\"{\":\"\\uFE37\",\"|\":\"\\u2015\",\"}\":\"\\uFE38\",\"~\":\"\\uFF5E\",\"\\xA2\":\"\\uFFE0\",\"\\xA3\":\"\\uFFE1\",\"\\xA5\":\"\\uFFE5\",\"\\xA6\":\"\\uFFE4\",\"\\xAC\":\"\\uFFE2\",\"\\xAF\":\"\\uFFE3\",\"\\u2013\":\"\\uFE32\",\"\\u2014\":\"\\uFE31\",\"\\u2018\":\"\\uFE43\",\"\\u2019\":\"\\uFE44\",\"\\u201C\":\"\\uFE41\",\"\\u201D\":\"\\uFE42\",\"\\u2026\":\"\\uFE19\",\"\\u22EF\":\"\\uFE19\",\"\\u2027\":\"\\u30FB\",\"\\u20A9\":\"\\uFFE6\",\"\\u3001\":\"\\uFE11\",\"\\u3002\":\"\\uFE12\",\"\\u3008\":\"\\uFE3F\",\"\\u3009\":\"\\uFE40\",\"\\u300A\":\"\\uFE3D\",\"\\u300B\":\"\\uFE3E\",\"\\u300C\":\"\\uFE41\",\"\\u300D\":\"\\uFE42\",\"\\u300E\":\"\\uFE43\",\"\\u300F\":\"\\uFE44\",\"\\u3010\":\"\\uFE3B\",\"\\u3011\":\"\\uFE3C\",\"\\u3014\":\"\\uFE39\",\"\\u3015\":\"\\uFE3A\",\"\\u3016\":\"\\uFE17\",\"\\u3017\":\"\\uFE18\",\"\\uFF01\":\"\\uFE15\",\"\\uFF08\":\"\\uFE35\",\"\\uFF09\":\"\\uFE36\",\"\\uFF0C\":\"\\uFE10\",\"\\uFF0D\":\"\\uFE32\",\"\\uFF0E\":\"\\u30FB\",\"\\uFF1A\":\"\\uFE13\",\"\\uFF1B\":\"\\uFE14\",\"\\uFF1C\":\"\\uFE3F\",\"\\uFF1E\":\"\\uFE40\",\"\\uFF1F\":\"\\uFE16\",\"\\uFF3B\":\"\\uFE47\",\"\\uFF3D\":\"\\uFE48\",\"\\uFF3F\":\"\\uFE33\",\"\\uFF5B\":\"\\uFE37\",\"\\uFF5C\":\"\\u2015\",\"\\uFF5D\":\"\\uFE38\",\"\\uFF5F\":\"\\uFE35\",\"\\uFF60\":\"\\uFE36\",\"\\uFF61\":\"\\uFE12\",\"\\uFF62\":\"\\uFE41\",\"\\uFF63\":\"\\uFE42\"},Whe={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},jhe={40:!0};function lU(h,a,u,p,v,E){if(\"fontStack\"in a){let S=u[a.fontStack],R=S&&S[h];return R?R.metrics.advance*a.scale+v:0}{let S=p[a.imageName];return S?S.displaySize[0]*a.scale*Rs/E+v:0}}function cU(h,a,u,p){let v=Math.pow(h-a,2);return p?h<a?v/2:2*v:v+Math.abs(u)*u}function Xhe(h,a,u){let p=0;return h===10&&(p-=1e4),u&&(p+=150),h!==40&&h!==65288||(p+=50),a!==41&&a!==65289||(p+=50),p}function uU(h,a,u,p,v,E){let S=null,R=cU(a,u,v,E);for(let F of p){let U=cU(a-F.x,u,v,E)+F.badness;U<=R&&(S=F,R=U)}return{index:h,x:a,priorBreak:S,badness:R}}function hU(h){return h?hU(h.priorBreak).concat(h.index):[]}class n1{constructor(a=\"\",u=[],p=[]){this.text=a,this.sections=u,this.sectionIndex=p,this.imageSectionID=null}static fromFeature(a,u){let p=new n1;for(let v=0;v<a.sections.length;v++){let E=a.sections[v];E.image?p.addImageSection(E):p.addTextSection(E,u)}return p}length(){return[...this.text].length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}verticalizePunctuation(){this.text=(function(a){let u=\"\",p={premature:!0,value:void 0},v=a[Symbol.iterator](),E=v.next(),S=a[Symbol.iterator]();S.next();let R=S.next();for(;!E.done;)u+=!R.done&&Mu(R.value.codePointAt(0))&&!zx[R.value]||!p.premature&&Mu(p.value.codePointAt(0))&&!zx[p.value]||!zx[E.value]?E.value:zx[E.value],p={value:E.value,premature:!1},E=v.next(),R=S.next();return u})(this.text)}hasZeroWidthSpaces(){return this.text.includes(\"\\u200B\")}trim(){let a=this.text.match(/^\\s*/),u=a?a[0].length:0,p=this.text.match(/\\S\\s*$/),v=p?p[0].length-1:0;this.text=this.text.substring(u,this.text.length-v),this.sectionIndex=this.sectionIndex.slice(u,this.sectionIndex.length-v)}substring(a,u){let p=[...this.text].slice(a,u).join(\"\"),v=this.sectionIndex.slice(a,u);return new n1(p,this.sections,v)}toCodeUnitIndex(a){return[...this.text].slice(0,a).join(\"\").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((a,u)=>Math.max(a,this.sections[u].scale)),0)}getMaxImageSize(a){let u=0,p=0;for(let v=0;v<this.length();v++){let E=this.getSection(v);if(\"imageName\"in E){let S=a[E.imageName];if(!S)continue;let R=S.displaySize;u=Math.max(u,R[0]),p=Math.max(p,R[1])}}return{maxImageWidth:u,maxImageHeight:p}}addTextSection(a,u){this.text+=a.text,this.sections.push({scale:a.scale||1,verticalAlign:a.verticalAlign||\"bottom\",fontStack:a.fontStack||u});let p=this.sections.length-1;this.sectionIndex.push(...[...a.text].map((()=>p)))}addImageSection(a){let u=a.image?a.image.name:\"\";if(u.length===0)return void yi(\"Can't add FormattedSection with an empty image.\");let p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push({scale:1,verticalAlign:a.verticalAlign||\"bottom\",imageName:u}),this.sectionIndex.push(this.sections.length-1)):yi(\"Reached maximum number of images 6401\")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(a,u,p,v,E){let S=[],R=this.determineAverageLineWidth(a,u,p,v,E),F=this.hasZeroWidthSpaces(),U=0,H=0,X=this.text[Symbol.iterator](),$=X.next(),te=this.text[Symbol.iterator]();te.next();let oe=te.next(),le=this.text[Symbol.iterator]();le.next(),le.next();let ue=le.next();for(;!$.done;){let me=this.getSection(H),Le=$.value.codePointAt(0);if(Y_(Le)||(U+=lU(Le,me,p,v,a,E)),!oe.done){let ye=Ud(Le),we=oe.value.codePointAt(0);(Whe[Le]||ye||\"imageName\"in me||!ue.done&&jhe[we])&&S.push(uU(H+1,U,R,S,Xhe(Le,we,ye&&F),!1))}H++,$=X.next(),oe=te.next(),ue=le.next()}return hU(uU(this.length(),U,R,S,0,!0))}determineAverageLineWidth(a,u,p,v,E){let S=0,R=0;for(let F of this.text){let U=this.getSection(R);S+=lU(F.codePointAt(0),U,p,v,a,E),R++}return S/Math.max(1,Math.ceil(S/u))}}let Y5=4294967296,fU=1/Y5,dU=typeof TextDecoder>\"u\"?null:new TextDecoder(\"utf-8\");class fE{constructor(a=new Uint8Array(16)){this.buf=ArrayBuffer.isView(a)?a:new Uint8Array(a),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(a,u,p=this.length){for(;this.pos<p;){let v=this.readVarint(),E=v>>3,S=this.pos;this.type=7&v,a(E,u,this),this.pos===S&&this.skip(v)}return u}readMessage(a,u){return this.readFields(a,u,this.readVarint()+this.pos)}readFixed32(){let a=this.dataView.getUint32(this.pos,!0);return this.pos+=4,a}readSFixed32(){let a=this.dataView.getInt32(this.pos,!0);return this.pos+=4,a}readFixed64(){let a=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Y5;return this.pos+=8,a}readSFixed64(){let a=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Y5;return this.pos+=8,a}readFloat(){let a=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,a}readDouble(){let a=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,a}readVarint(a){let u=this.buf,p,v;return v=u[this.pos++],p=127&v,v<128?p:(v=u[this.pos++],p|=(127&v)<<7,v<128?p:(v=u[this.pos++],p|=(127&v)<<14,v<128?p:(v=u[this.pos++],p|=(127&v)<<21,v<128?p:(v=u[this.pos],p|=(15&v)<<28,(function(E,S,R){let F=R.buf,U,H;if(H=F[R.pos++],U=(112&H)>>4,H<128||(H=F[R.pos++],U|=(127&H)<<3,H<128)||(H=F[R.pos++],U|=(127&H)<<10,H<128)||(H=F[R.pos++],U|=(127&H)<<17,H<128)||(H=F[R.pos++],U|=(127&H)<<24,H<128)||(H=F[R.pos++],U|=(1&H)<<31,H<128))return r1(E,U,S);throw new Error(\"Expected varint not more than 10 bytes\")})(p,a,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){let a=this.readVarint();return a%2==1?(a+1)/-2:a/2}readBoolean(){return!!this.readVarint()}readString(){let a=this.readVarint()+this.pos,u=this.pos;return this.pos=a,a-u>=12&&dU?dU.decode(this.buf.subarray(u,a)):(function(p,v,E){let S=\"\",R=v;for(;R<E;){let F=p[R],U,H,X,$=null,te=F>239?4:F>223?3:F>191?2:1;if(R+te>E)break;te===1?F<128&&($=F):te===2?(U=p[R+1],(192&U)==128&&($=(31&F)<<6|63&U,$<=127&&($=null))):te===3?(U=p[R+1],H=p[R+2],(192&U)==128&&(192&H)==128&&($=(15&F)<<12|(63&U)<<6|63&H,($<=2047||$>=55296&&$<=57343)&&($=null))):te===4&&(U=p[R+1],H=p[R+2],X=p[R+3],(192&U)==128&&(192&H)==128&&(192&X)==128&&($=(15&F)<<18|(63&U)<<12|(63&H)<<6|63&X,($<=65535||$>=1114112)&&($=null))),$===null?($=65533,te=1):$>65535&&($-=65536,S+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),S+=String.fromCharCode($),R+=te}return S})(this.buf,u,a)}readBytes(){let a=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,a);return this.pos=a,u}readPackedVarint(a=[],u){let p=this.readPackedEnd();for(;this.pos<p;)a.push(this.readVarint(u));return a}readPackedSVarint(a=[]){let u=this.readPackedEnd();for(;this.pos<u;)a.push(this.readSVarint());return a}readPackedBoolean(a=[]){let u=this.readPackedEnd();for(;this.pos<u;)a.push(this.readBoolean());return a}readPackedFloat(a=[]){let u=this.readPackedEnd();for(;this.pos<u;)a.push(this.readFloat());return a}readPackedDouble(a=[]){let u=this.readPackedEnd();for(;this.pos<u;)a.push(this.readDouble());return a}readPackedFixed32(a=[]){let u=this.readPackedEnd();for(;this.pos<u;)a.push(this.readFixed32());return a}readPackedSFixed32(a=[]){let u=this.readPackedEnd();for(;this.pos<u;)a.push(this.readSFixed32());return a}readPackedFixed64(a=[]){let u=this.readPackedEnd();for(;this.pos<u;)a.push(this.readFixed64());return a}readPackedSFixed64(a=[]){let u=this.readPackedEnd();for(;this.pos<u;)a.push(this.readSFixed64());return a}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(a){let u=7&a;if(u===0)for(;this.buf[this.pos++]>127;);else if(u===2)this.pos=this.readVarint()+this.pos;else if(u===5)this.pos+=4;else{if(u!==1)throw new Error(`Unimplemented type: ${u}`);this.pos+=8}}writeTag(a,u){this.writeVarint(a<<3|u)}realloc(a){let u=this.length||16;for(;u<this.pos+a;)u*=2;if(u!==this.length){let p=new Uint8Array(u);p.set(this.buf),this.buf=p,this.dataView=new DataView(p.buffer),this.length=u}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(a){this.realloc(4),this.dataView.setInt32(this.pos,a,!0),this.pos+=4}writeSFixed32(a){this.realloc(4),this.dataView.setInt32(this.pos,a,!0),this.pos+=4}writeFixed64(a){this.realloc(8),this.dataView.setInt32(this.pos,-1&a,!0),this.dataView.setInt32(this.pos+4,Math.floor(a*fU),!0),this.pos+=8}writeSFixed64(a){this.realloc(8),this.dataView.setInt32(this.pos,-1&a,!0),this.dataView.setInt32(this.pos+4,Math.floor(a*fU),!0),this.pos+=8}writeVarint(a){(a=+a||0)>268435455||a<0?(function(u,p){let v,E;if(u>=0?(v=u%4294967296|0,E=u/4294967296|0):(v=~(-u%4294967296),E=~(-u/4294967296),4294967295^v?v=v+1|0:(v=0,E=E+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error(\"Given varint doesn't fit into 10 bytes\");p.realloc(10),(function(S,R,F){F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,F.buf[F.pos]=127&(S>>>=7)})(v,0,p),(function(S,R){let F=(7&S)<<4;R.buf[R.pos++]|=F|((S>>>=3)?128:0),S&&(R.buf[R.pos++]=127&S|((S>>>=7)?128:0),S&&(R.buf[R.pos++]=127&S|((S>>>=7)?128:0),S&&(R.buf[R.pos++]=127&S|((S>>>=7)?128:0),S&&(R.buf[R.pos++]=127&S|((S>>>=7)?128:0),S&&(R.buf[R.pos++]=127&S)))))})(E,p)})(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))}writeSVarint(a){this.writeVarint(a<0?2*-a-1:2*a)}writeBoolean(a){this.writeVarint(+a)}writeString(a){a=String(a),this.realloc(4*a.length),this.pos++;let u=this.pos;this.pos=(function(v,E,S){for(let R,F,U=0;U<E.length;U++){if(R=E.charCodeAt(U),R>55295&&R<57344){if(!F){R>56319||U+1===E.length?(v[S++]=239,v[S++]=191,v[S++]=189):F=R;continue}if(R<56320){v[S++]=239,v[S++]=191,v[S++]=189,F=R;continue}R=F-55296<<10|R-56320|65536,F=null}else F&&(v[S++]=239,v[S++]=191,v[S++]=189,F=null);R<128?v[S++]=R:(R<2048?v[S++]=R>>6|192:(R<65536?v[S++]=R>>12|224:(v[S++]=R>>18|240,v[S++]=R>>12&63|128),v[S++]=R>>6&63|128),v[S++]=63&R|128)}return S})(this.buf,a,this.pos);let p=this.pos-u;p>=128&&pU(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p}writeFloat(a){this.realloc(4),this.dataView.setFloat32(this.pos,a,!0),this.pos+=4}writeDouble(a){this.realloc(8),this.dataView.setFloat64(this.pos,a,!0),this.pos+=8}writeBytes(a){let u=a.length;this.writeVarint(u),this.realloc(u);for(let p=0;p<u;p++)this.buf[this.pos++]=a[p]}writeRawMessage(a,u){this.pos++;let p=this.pos;a(u,this);let v=this.pos-p;v>=128&&pU(p,v,this),this.pos=p-1,this.writeVarint(v),this.pos+=v}writeMessage(a,u,p){this.writeTag(a,2),this.writeRawMessage(u,p)}writePackedVarint(a,u){u.length&&this.writeMessage(a,Yhe,u)}writePackedSVarint(a,u){u.length&&this.writeMessage(a,Zhe,u)}writePackedBoolean(a,u){u.length&&this.writeMessage(a,Khe,u)}writePackedFloat(a,u){u.length&&this.writeMessage(a,qhe,u)}writePackedDouble(a,u){u.length&&this.writeMessage(a,Qhe,u)}writePackedFixed32(a,u){u.length&&this.writeMessage(a,Jhe,u)}writePackedSFixed32(a,u){u.length&&this.writeMessage(a,$he,u)}writePackedFixed64(a,u){u.length&&this.writeMessage(a,efe,u)}writePackedSFixed64(a,u){u.length&&this.writeMessage(a,tfe,u)}writeBytesField(a,u){this.writeTag(a,2),this.writeBytes(u)}writeFixed32Field(a,u){this.writeTag(a,5),this.writeFixed32(u)}writeSFixed32Field(a,u){this.writeTag(a,5),this.writeSFixed32(u)}writeFixed64Field(a,u){this.writeTag(a,1),this.writeFixed64(u)}writeSFixed64Field(a,u){this.writeTag(a,1),this.writeSFixed64(u)}writeVarintField(a,u){this.writeTag(a,0),this.writeVarint(u)}writeSVarintField(a,u){this.writeTag(a,0),this.writeSVarint(u)}writeStringField(a,u){this.writeTag(a,2),this.writeString(u)}writeFloatField(a,u){this.writeTag(a,5),this.writeFloat(u)}writeDoubleField(a,u){this.writeTag(a,1),this.writeDouble(u)}writeBooleanField(a,u){this.writeVarintField(a,+u)}}function r1(h,a,u){return u?4294967296*a+(h>>>0):4294967296*(a>>>0)+(h>>>0)}function pU(h,a,u){let p=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));u.realloc(p);for(let v=u.pos-1;v>=h;v--)u.buf[v+p]=u.buf[v]}function Yhe(h,a){for(let u=0;u<h.length;u++)a.writeVarint(h[u])}function Zhe(h,a){for(let u=0;u<h.length;u++)a.writeSVarint(h[u])}function qhe(h,a){for(let u=0;u<h.length;u++)a.writeFloat(h[u])}function Qhe(h,a){for(let u=0;u<h.length;u++)a.writeDouble(h[u])}function Khe(h,a){for(let u=0;u<h.length;u++)a.writeBoolean(h[u])}function Jhe(h,a){for(let u=0;u<h.length;u++)a.writeFixed32(h[u])}function $he(h,a){for(let u=0;u<h.length;u++)a.writeSFixed32(h[u])}function efe(h,a){for(let u=0;u<h.length;u++)a.writeFixed64(h[u])}function tfe(h,a){for(let u=0;u<h.length;u++)a.writeSFixed64(h[u])}function nfe(h,a,u){h===1&&u.readMessage(rfe,a)}function rfe(h,a,u){if(h===3){let{id:p,bitmap:v,width:E,height:S,left:R,top:F,advance:U}=u.readMessage(ife,{});a.push({id:p,bitmap:new Ix({width:E+6,height:S+6},v),metrics:{width:E,height:S,left:R,top:F,advance:U}})}}function ife(h,a,u){h===1?a.id=u.readVarint():h===2?a.bitmap=u.readBytes():h===3?a.width=u.readVarint():h===4?a.height=u.readVarint():h===5?a.left=u.readSVarint():h===6?a.top=u.readSVarint():h===7&&(a.advance=u.readVarint())}function AU(h){let a=0,u=0;for(let S of h)a+=S.w*S.h,u=Math.max(u,S.w);h.sort(((S,R)=>R.h-S.h));let p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),u),h:1/0}],v=0,E=0;for(let S of h)for(let R=p.length-1;R>=0;R--){let F=p[R];if(!(S.w>F.w||S.h>F.h)){if(S.x=F.x,S.y=F.y,E=Math.max(E,S.y+S.h),v=Math.max(v,S.x+S.w),S.w===F.w&&S.h===F.h){let U=p.pop();U&&R<p.length&&(p[R]=U)}else S.h===F.h?(F.x+=S.w,F.w-=S.w):S.w===F.w?(F.y+=S.h,F.h-=S.h):(p.push({x:F.x+S.w,y:F.y,w:F.w-S.w,h:S.h}),F.y+=S.h,F.h-=S.h);break}}return{w:v,h:E,fill:a/(v*E)||0}}class Z5{constructor(a,{pixelRatio:u,version:p,stretchX:v,stretchY:E,content:S,textFitWidth:R,textFitHeight:F}){this.paddedRect=a,this.pixelRatio=u,this.stretchX=v,this.stretchY=E,this.content=S,this.version=p,this.textFitWidth=R,this.textFitHeight=F}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class gU{constructor(a,u){let p={},v={};this.haveRenderCallbacks=[];let E=[];this.addImages(a,p,E),this.addImages(u,v,E);let{w:S,h:R}=AU(E),F=new zl({width:S||1,height:R||1});for(let U in a){let H=a[U],X=p[U].paddedRect;zl.copy(H.data,F,{x:0,y:0},{x:X.x+1,y:X.y+1},H.data)}for(let U in u){let H=u[U],X=v[U].paddedRect,$=X.x+1,te=X.y+1,oe=H.data.width,le=H.data.height;zl.copy(H.data,F,{x:0,y:0},{x:$,y:te},H.data),zl.copy(H.data,F,{x:0,y:le-1},{x:$,y:te-1},{width:oe,height:1}),zl.copy(H.data,F,{x:0,y:0},{x:$,y:te+le},{width:oe,height:1}),zl.copy(H.data,F,{x:oe-1,y:0},{x:$-1,y:te},{width:1,height:le}),zl.copy(H.data,F,{x:0,y:0},{x:$+oe,y:te},{width:1,height:le})}this.image=F,this.iconPositions=p,this.patternPositions=v}addImages(a,u,p){for(let v in a){let E=a[v],S={x:0,y:0,w:E.data.width+2,h:E.data.height+2};p.push(S),u[v]=new Z5(S,E),E.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(a,u){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let p in a.updatedImages)this.patchUpdatedImage(this.iconPositions[p],a.getImage(p),u),this.patchUpdatedImage(this.patternPositions[p],a.getImage(p),u)}patchUpdatedImage(a,u,p){if(!a||!u||a.version===u.version)return;a.version=u.version;let[v,E]=a.tl;p.update(u.data,void 0,{x:v,y:E})}}var k0;function dE(h,a,u,p,v,E,S,R,F,U,H,X,$,te,oe){let le=n1.fromFeature(h,v),ue;X===i.az.vertical&&le.verticalizePunctuation();let me=le.determineLineBreaks(U,E,a,p,te),{processBidirectionalText:Le,processStyledBidirectionalText:ye}=Iu;if(Le&&le.sections.length===1){ue=[],me=me.map((ht=>le.toCodeUnitIndex(ht)));let je=Le(le.toString(),me);for(let ht of je){let It=[...ht].map((()=>0));ue.push(new n1(ht,le.sections,It))}}else if(ye){ue=[],me=me.map((wt=>le.toCodeUnitIndex(wt)));let je=0,ht=[];for(let wt of le.text)ht.push(...Array(wt.length).fill(le.sectionIndex[je])),je++;let It=ye(le.text,ht,me);for(let wt of It){let Rt=[],Qt=\"\";for(let Gt of wt[0])Rt.push(wt[1][Qt.length]),Qt+=Gt;ue.push(new n1(wt[0],le.sections,Rt))}}else ue=(function(je,ht){let It=[],wt=0;for(let Rt of ht)It.push(je.substring(wt,Rt)),wt=Rt;return wt<je.length()&&It.push(je.substring(wt,je.length())),It})(le,me);let we=[],ke={positionedLines:we,text:le.toString(),top:H[1],bottom:H[1],left:H[0],right:H[0],writingMode:X,iconsInText:!1,verticalizable:!1};return(function(je,ht,It,wt,Rt,Qt,Gt,bt,_t,cn,nn,An){let an=0,En=0,Dr=0,pr=0,no=bt===\"right\"?1:bt===\"left\"?0:.5,da=Rs/An,ns=0;for(let ii of Rt){ii.trim();let To=ii.getMaxScale(),Oo={positionedGlyphs:[],lineOffset:0};je.positionedLines[ns]=Oo;let ki=Oo.positionedGlyphs,Ul=0;if(!ii.length()){En+=Qt,++ns;continue}let pa=ofe(wt,ii,da),Vl=0;for(let Ls of ii.text){let Ao=ii.getSection(Vl),rs=Ls.codePointAt(0),Eo=sfe(_t,nn,rs),Os={glyph:rs,imageName:null,x:an,y:En+-17,vertical:Eo,scale:1,fontStack:\"\",sectionIndex:ii.getSectionIndex(Vl),metrics:null,rect:null},ep;if(\"fontStack\"in Ao){if(ep=afe(Ao,rs,Eo,pa,ht,It),!ep)continue;Os.fontStack=Ao.fontStack}else{if(je.iconsInText=!0,Ao.scale*=da,ep=lfe(Ao,Eo,To,pa,wt),!ep)continue;Ul=Math.max(Ul,ep.imageOffset),Os.imageName=Ao.imageName}let{rect:Nh,metrics:Xx,baselineOffset:G0}=ep;Os.y+=G0,Os.scale=Ao.scale,Os.metrics=Xx,Os.rect=Nh,ki.push(Os),Eo?(je.verticalizable=!0,an+=(\"imageName\"in Ao?Xx.advance:Rs)*Ao.scale+cn):an+=Xx.advance*Ao.scale+cn,Vl++}ki.length!==0&&(Dr=Math.max(an-cn,Dr),cfe(ki,0,ki.length-1,no)),an=0,Oo.lineOffset=Math.max(Ul,(To-1)*Rs);let Ru=Qt*To+Ul;En+=Ru,pr=Math.max(Ru,pr),++ns}let{horizontalAlign:ro,verticalAlign:Zi}=q5(Gt);(function(ii,To,Oo,ki,Ul,pa,Vl,Ru,Ls){let Ao=(To-Oo)*Ul,rs=0;rs=pa!==Vl?-Ru*ki- -17:-ki*Ls*Vl+.5*Vl;for(let Eo of ii)for(let Os of Eo.positionedGlyphs)Os.x+=Ao,Os.y+=rs})(je.positionedLines,no,ro,Zi,Dr,pr,Qt,En,Rt.length),je.top+=-Zi*En,je.bottom=je.top+En,je.left+=-ro*Dr,je.right=je.left+Dr})(ke,a,u,p,ue,S,R,F,X,U,$,oe),!(function(je){for(let ht of je)if(ht.positionedGlyphs.length!==0)return!1;return!0})(we)&&ke}function q5(h){let a=.5,u=.5;switch(h){case\"right\":case\"top-right\":case\"bottom-right\":a=1;break;case\"left\":case\"top-left\":case\"bottom-left\":a=0}switch(h){case\"bottom\":case\"bottom-right\":case\"bottom-left\":u=1;break;case\"top\":case\"top-right\":case\"top-left\":u=0}return{horizontalAlign:a,verticalAlign:u}}function ofe(h,a,u){let p=a.getMaxScale()*Rs,{maxImageWidth:v,maxImageHeight:E}=a.getMaxImageSize(h),S=Math.max(p,E*u);return{verticalLineContentWidth:Math.max(p,v*u),horizontalLineContentHeight:S}}function mU(h){switch(h){case\"top\":return 0;case\"center\":return .5;default:return 1}}function sfe(h,a,u){return!(h===i.az.horizontal||!a&&!Vd(u)||a&&(Y_(u)||(p=u,/\\p{sc=Arab}/u.test(String.fromCodePoint(p)))));var p}function afe(h,a,u,p,v,E){let S=E[h.fontStack],R=(function(U,H,X,$){if(U&&U.rect)return U;let te=H[X.fontStack],oe=te&&te[$];return oe?{rect:null,metrics:oe.metrics}:null})(S&&S[a],v,h,a);if(R===null)return null;let F;if(u)F=p.verticalLineContentWidth-h.scale*Rs;else{let U=mU(h.verticalAlign);F=(p.horizontalLineContentHeight-h.scale*Rs)*U}return{rect:R.rect,metrics:R.metrics,baselineOffset:F}}function lfe(h,a,u,p,v){let E=v[h.imageName];if(!E)return null;let S=E.paddedRect,R=E.displaySize,F={width:R[0],height:R[1],left:1,top:-3,advance:a?R[1]:R[0]},U;if(a)U=p.verticalLineContentWidth-R[1]*h.scale;else{let H=mU(h.verticalAlign);U=(p.horizontalLineContentHeight-R[1]*h.scale)*H}return{rect:S,metrics:F,baselineOffset:U,imageOffset:(a?R[0]:R[1])*h.scale-Rs*u}}function cfe(h,a,u,p){if(p===0)return;let v=h[u],E=(h[u].x+v.metrics.advance*v.scale)*p;for(let S=a;S<=u;S++)h[S].x-=E}function ufe(h,a,u){let{horizontalAlign:p,verticalAlign:v}=q5(u),E=a[0]-h.displaySize[0]*p,S=a[1]-h.displaySize[1]*v;return{image:h,top:S,bottom:S+h.displaySize[1],left:E,right:E+h.displaySize[0]}}function _U(h){var a,u;let p=h.left,v=h.top,E=h.right-p,S=h.bottom-v,R=(a=h.image.textFitWidth)!==null&&a!==void 0?a:\"stretchOrShrink\",F=(u=h.image.textFitHeight)!==null&&u!==void 0?u:\"stretchOrShrink\",U=(h.image.content[2]-h.image.content[0])/(h.image.content[3]-h.image.content[1]);if(F===\"proportional\"){if(R===\"stretchOnly\"&&E/S<U||R===\"proportional\"){let H=Math.ceil(S*U);p*=H/E,E=H}}else if(R===\"proportional\"&&F===\"stretchOnly\"&&U!==0&&E/S>U){let H=Math.ceil(E/U);v*=H/S,S=H}return{x1:p,y1:v,x2:p+E,y2:v+S}}function yU(h,a,u,p,v,E){let S=h.image,R;if(S.content){let ue=S.content,me=S.pixelRatio||1;R=[ue[0]/me,ue[1]/me,S.displaySize[0]-ue[2]/me,S.displaySize[1]-ue[3]/me]}let F=a.left*E,U=a.right*E,H,X,$,te;u===\"width\"||u===\"both\"?(te=v[0]+F-p[3],X=v[0]+U+p[1]):(te=v[0]+(F+U-S.displaySize[0])/2,X=te+S.displaySize[0]);let oe=a.top*E,le=a.bottom*E;return u===\"height\"||u===\"both\"?(H=v[1]+oe-p[0],$=v[1]+le+p[2]):(H=v[1]+(oe+le-S.displaySize[1])/2,$=H+S.displaySize[1]),{image:S,top:H,right:X,bottom:$,left:te,collisionPadding:R}}un(\"ImagePosition\",Z5),un(\"ImageAtlas\",gU),i.az=void 0,(k0=i.az||(i.az={}))[k0.none=0]=\"none\",k0[k0.horizontal=1]=\"horizontal\",k0[k0.vertical=2]=\"vertical\",k0[k0.horizontalOnly=3]=\"horizontalOnly\";let Jd=128,N0=32640;function xU(h,a){let{expression:u}=a;if(u.kind===\"constant\")return{kind:\"constant\",layoutSize:u.evaluate(new ci(h+1))};if(u.kind===\"source\")return{kind:\"source\"};{let{zoomStops:p,interpolationType:v}=u,E=0;for(;E<p.length&&p[E]<=h;)E++;E=Math.max(0,E-1);let S=E;for(;S<p.length&&p[S]<h+1;)S++;S=Math.min(p.length-1,S);let R=p[E],F=p[S];return u.kind===\"composite\"?{kind:\"composite\",minZoom:R,maxZoom:F,interpolationType:v}:{kind:\"camera\",minZoom:R,maxZoom:F,minSize:u.evaluate(new ci(R)),maxSize:u.evaluate(new ci(F)),interpolationType:v}}}function Q5(h,a,u){let p=\"never\",v=h.get(a);return v?p=v:h.get(u)&&(p=\"always\"),p}let hfe=[{name:\"a_fade_opacity\",components:1,type:\"Uint8\",offset:0}];function pE(h,a,u,p,v,E,S,R,F,U,H,X,$){let te=R?Math.min(N0,Math.round(R[0])):0,oe=R?Math.min(N0,Math.round(R[1])):0;h.emplaceBack(a,u,Math.round(32*p),Math.round(32*v),E,S,(te<<1)+(F?1:0),oe,16*U,16*H,256*X,256*$)}function K5(h,a,u){h.emplaceBack(a.x,a.y,u),h.emplaceBack(a.x,a.y,u),h.emplaceBack(a.x,a.y,u),h.emplaceBack(a.x,a.y,u)}function ffe(h){for(let a of h.sections)if(Z_(a.text))return!0;return!1}class J5{constructor(a){this.layoutVertexArray=new Fe,this.indexArray=new ft,this.programConfigurations=a,this.segments=new Jt,this.dynamicLayoutVertexArray=new Ve,this.opacityVertexArray=new ct,this.hasVisibleVertices=!1,this.placedSymbolArray=new L}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,u,p,v){this.isEmpty()||(p&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,zhe.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Uhe.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,hfe,!0),this.opacityVertexBuffer.itemSize=1),(p||v)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}un(\"SymbolBuffers\",J5);class $5{constructor(a,u,p){this.layoutVertexArray=new a,this.layoutAttributes=u,this.indexArray=new p,this.segments=new Jt,this.collisionVertexArray=new pt}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,Vhe.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}un(\"CollisionBuffers\",$5);class i1{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map((S=>S.id)),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];let u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=xU(this.zoom,u[\"text-size\"]),this.iconSizeData=xU(this.zoom,u[\"icon-size\"]);let p=this.layers[0].layout,v=p.get(\"symbol-sort-key\"),E=p.get(\"symbol-z-order\");this.canOverlap=Q5(p,\"text-overlap\",\"text-allow-overlap\")!==\"never\"||Q5(p,\"icon-overlap\",\"icon-allow-overlap\")!==\"never\"||p.get(\"text-ignore-placement\")||p.get(\"icon-ignore-placement\"),this.sortFeaturesByKey=E!==\"viewport-y\"&&!v.isConstant(),this.sortFeaturesByY=(E===\"viewport-y\"||E===\"auto\"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get(\"symbol-placement\")===\"point\"&&(this.writingModes=p.get(\"text-writing-mode\").map((S=>i.az[S]))),this.stateDependentLayerIds=this.layers.filter((S=>S.isStateDependent())).map((S=>S.id)),this.sourceID=a.sourceID}createArrays(){this.text=new J5(new at(this.layers,this.zoom,(a=>/^text/.test(a)))),this.icon=new J5(new at(this.layers,this.zoom,(a=>/^icon/.test(a)))),this.glyphOffsetArray=new j,this.lineVertexArray=new Q,this.symbolInstances=new G,this.textAnchorOffsets=new re}calculateGlyphDependencies(a,u,p,v,E){for(let S of a)if(u[S.codePointAt(0)]=!0,(p||v)&&E){let R=zx[S];R&&(u[R.codePointAt(0)]=!0)}}populate(a,u,p){let v=this.layers[0],E=v.layout,S=E.get(\"text-font\"),R=E.get(\"text-field\"),F=E.get(\"icon-image\"),U=(R.value.kind!==\"constant\"||R.value.value instanceof Go&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(S.value.kind!==\"constant\"||S.value.value.length>0),H=F.value.kind!==\"constant\"||!!F.value.value||Object.keys(F.parameters).length>0,X=E.get(\"symbol-sort-key\");if(this.features=[],!U&&!H)return;let $=u.iconDependencies,te=u.glyphDependencies,oe=u.availableImages,le=new ci(this.zoom);for(let{feature:ue,id:me,index:Le,sourceLayerIndex:ye}of a){let we=v._featureFilter.needGeometry,ke=Vn(ue,we);if(!v._featureFilter.filter(le,ke,p))continue;let je,ht;if(we||(ke.geometry=dn(ue)),U){let wt=v.getValueAndResolveTokens(\"text-field\",ke,p,oe),Rt=Go.factory(wt),Qt=this.hasRTLText=this.hasRTLText||ffe(Rt);(!Qt||Iu.getRTLTextPluginStatus()===\"unavailable\"||Qt&&Iu.isParsed())&&(je=Hhe(Rt,v,ke))}if(H){let wt=v.getValueAndResolveTokens(\"icon-image\",ke,p,oe);ht=wt instanceof nl?wt:nl.fromString(wt)}if(!je&&!ht)continue;let It=this.sortFeaturesByKey?X.evaluate(ke,{},p):void 0;if(this.features.push({id:me,text:je,icon:ht,index:Le,sourceLayerIndex:ye,geometry:ke.geometry,properties:ue.properties,type:Fx.types[ue.type],sortKey:It}),ht&&($[ht.name]=!0),je){let wt=S.evaluate(ke,{},p).join(\",\"),Rt=E.get(\"text-rotation-alignment\")!==\"viewport\"&&E.get(\"symbol-placement\")!==\"point\";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(i.az.vertical)>=0;for(let Qt of je.sections)if(Qt.image)$[Qt.image.name]=!0;else{let Gt=Mf(je.toString()),bt=Qt.fontStack||wt,_t=te[bt]=te[bt]||{};this.calculateGlyphDependencies(Qt.text,_t,Rt,this.allowVerticalPlacement,Gt)}}}E.get(\"symbol-placement\")===\"line\"&&(this.features=(function(ue){let me={},Le={},ye=[],we=0;function ke(wt){ye.push(ue[wt]),we++}function je(wt,Rt,Qt){let Gt=Le[wt];return delete Le[wt],Le[Rt]=Gt,ye[Gt].geometry[0].pop(),ye[Gt].geometry[0]=ye[Gt].geometry[0].concat(Qt[0]),Gt}function ht(wt,Rt,Qt){let Gt=me[Rt];return delete me[Rt],me[wt]=Gt,ye[Gt].geometry[0].shift(),ye[Gt].geometry[0]=Qt[0].concat(ye[Gt].geometry[0]),Gt}function It(wt,Rt,Qt){let Gt=Qt?Rt[0][Rt[0].length-1]:Rt[0][0];return`${wt}:${Gt.x}:${Gt.y}`}for(let wt=0;wt<ue.length;wt++){let Rt=ue[wt],Qt=Rt.geometry,Gt=Rt.text?Rt.text.toString():null;if(!Gt){ke(wt);continue}let bt=It(Gt,Qt),_t=It(Gt,Qt,!0);if(bt in Le&&_t in me&&Le[bt]!==me[_t]){let cn=ht(bt,_t,Qt),nn=je(bt,_t,ye[cn].geometry);delete me[bt],delete Le[_t],Le[It(Gt,ye[nn].geometry,!0)]=nn,ye[cn].geometry=null}else bt in Le?je(bt,_t,Qt):_t in me?ht(bt,_t,Qt):(ke(wt),me[bt]=we-1,Le[_t]=we-1)}return ye.filter((wt=>wt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((ue,me)=>ue.sortKey-me.sortKey))}update(a,u,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,u,this.layers,{imagePositions:p}),this.icon.programConfigurations.updatePaintArrays(a,u,this.layers,{imagePositions:p}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,u){let p=this.lineVertexArray.length;if(a.segment!==void 0){let v=a.dist(u[a.segment+1]),E=a.dist(u[a.segment]),S={};for(let R=a.segment+1;R<u.length;R++)S[R]={x:u[R].x,y:u[R].y,tileUnitDistanceFromAnchor:v},R<u.length-1&&(v+=u[R+1].dist(u[R]));for(let R=a.segment||0;R>=0;R--)S[R]={x:u[R].x,y:u[R].y,tileUnitDistanceFromAnchor:E},R>0&&(E+=u[R-1].dist(u[R]));for(let R=0;R<u.length;R++){let F=S[R];this.lineVertexArray.emplaceBack(F.x,F.y,F.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(a,u,p,v,E,S,R,F,U,H,X,$){let te=a.indexArray,oe=a.layoutVertexArray,le=a.segments.prepareSegment(4*u.length,oe,te,this.canOverlap?S.sortKey:void 0),ue=this.glyphOffsetArray.length,me=le.vertexLength,Le=this.allowVerticalPlacement&&R===i.az.vertical?Math.PI/2:0,ye=S.text&&S.text.sections;for(let we=0;we<u.length;we++){let{tl:ke,tr:je,bl:ht,br:It,tex:wt,pixelOffsetTL:Rt,pixelOffsetBR:Qt,minFontScaleX:Gt,minFontScaleY:bt,glyphOffset:_t,isSDF:cn,sectionIndex:nn}=u[we],An=le.vertexLength,an=_t[1];pE(oe,F.x,F.y,ke.x,an+ke.y,wt.x,wt.y,p,cn,Rt.x,Rt.y,Gt,bt),pE(oe,F.x,F.y,je.x,an+je.y,wt.x+wt.w,wt.y,p,cn,Qt.x,Rt.y,Gt,bt),pE(oe,F.x,F.y,ht.x,an+ht.y,wt.x,wt.y+wt.h,p,cn,Rt.x,Qt.y,Gt,bt),pE(oe,F.x,F.y,It.x,an+It.y,wt.x+wt.w,wt.y+wt.h,p,cn,Qt.x,Qt.y,Gt,bt),K5(a.dynamicLayoutVertexArray,F,Le),te.emplaceBack(An,An+2,An+1),te.emplaceBack(An+1,An+2,An+3),le.vertexLength+=4,le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_t[0]),we!==u.length-1&&nn===u[we+1].sectionIndex||a.programConfigurations.populatePaintArrays(oe.length,S,S.index,{imagePositions:{},canonical:$,formattedSection:ye&&ye[nn]})}a.placedSymbolArray.emplaceBack(F.x,F.y,ue,this.glyphOffsetArray.length-ue,me,U,H,F.segment,p?p[0]:0,p?p[1]:0,v[0],v[1],R,0,!1,0,X)}_addCollisionDebugVertex(a,u,p,v,E,S){return u.emplaceBack(0,0),a.emplaceBack(p.x,p.y,v,E,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(a,u,p,v,E,S,R){let F=E.segments.prepareSegment(4,E.layoutVertexArray,E.indexArray),U=F.vertexLength,H=E.layoutVertexArray,X=E.collisionVertexArray,$=R.anchorX,te=R.anchorY;this._addCollisionDebugVertex(H,X,S,$,te,new s(a,u)),this._addCollisionDebugVertex(H,X,S,$,te,new s(p,u)),this._addCollisionDebugVertex(H,X,S,$,te,new s(p,v)),this._addCollisionDebugVertex(H,X,S,$,te,new s(a,v)),F.vertexLength+=4;let oe=E.indexArray;oe.emplaceBack(U,U+1),oe.emplaceBack(U+1,U+2),oe.emplaceBack(U+2,U+3),oe.emplaceBack(U+3,U),F.primitiveLength+=4}addDebugCollisionBoxes(a,u,p,v){for(let E=a;E<u;E++){let S=this.collisionBoxArray.get(E);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,v?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new $5(dt,aU.members,Xt),this.iconCollisionBox=new $5(dt,aU.members,Xt);for(let a=0;a<this.symbolInstances.length;a++){let u=this.symbolInstances.get(a);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(a,u,p,v,E,S,R,F,U){let H={};for(let X=u;X<p;X++){let $=a.get(X);H.textBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},H.textFeatureIndex=$.featureIndex;break}for(let X=v;X<E;X++){let $=a.get(X);H.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},H.verticalTextFeatureIndex=$.featureIndex;break}for(let X=S;X<R;X++){let $=a.get(X);H.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},H.iconFeatureIndex=$.featureIndex;break}for(let X=F;X<U;X++){let $=a.get(X);H.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},H.verticalIconFeatureIndex=$.featureIndex;break}return H}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){let p=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,u){let p=a.placedSymbolArray.get(u),v=p.vertexStartIndex+4*p.numGlyphs;for(let E=p.vertexStartIndex;E<v;E+=4)a.indexArray.emplaceBack(E,E+2,E+1),a.indexArray.emplaceBack(E+1,E+2,E+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let u=Math.sin(a),p=Math.cos(a),v=[],E=[],S=[];for(let R=0;R<this.symbolInstances.length;++R){S.push(R);let F=this.symbolInstances.get(R);v.push(0|Math.round(u*F.anchorX+p*F.anchorY)),E.push(F.featureIndex)}return S.sort(((R,F)=>v[R]-v[F]||E[F]-E[R])),S}addToSortKeyRanges(a,u){let p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===u?p.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let u of this.symbolInstanceIndexes){let p=this.symbolInstances.get(u);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(((v,E,S)=>{v>=0&&S.indexOf(v)===E&&this.addIndicesForPlacedSymbol(this.text,v)})),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let vU,bU;un(\"SymbolBucket\",i1,{omit:[\"layers\",\"collisionBoxArray\",\"features\",\"compareText\"]}),i1.MAX_GLYPHS=65535,i1.addDynamicAttributes=K5;var eB={get paint(){return bU=bU||new qs({\"icon-opacity\":new Rn(Ke.paint_symbol[\"icon-opacity\"]),\"icon-color\":new Rn(Ke.paint_symbol[\"icon-color\"]),\"icon-halo-color\":new Rn(Ke.paint_symbol[\"icon-halo-color\"]),\"icon-halo-width\":new Rn(Ke.paint_symbol[\"icon-halo-width\"]),\"icon-halo-blur\":new Rn(Ke.paint_symbol[\"icon-halo-blur\"]),\"icon-translate\":new yn(Ke.paint_symbol[\"icon-translate\"]),\"icon-translate-anchor\":new yn(Ke.paint_symbol[\"icon-translate-anchor\"]),\"text-opacity\":new Rn(Ke.paint_symbol[\"text-opacity\"]),\"text-color\":new Rn(Ke.paint_symbol[\"text-color\"],{runtimeType:Qo,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),\"text-halo-color\":new Rn(Ke.paint_symbol[\"text-halo-color\"]),\"text-halo-width\":new Rn(Ke.paint_symbol[\"text-halo-width\"]),\"text-halo-blur\":new Rn(Ke.paint_symbol[\"text-halo-blur\"]),\"text-translate\":new yn(Ke.paint_symbol[\"text-translate\"]),\"text-translate-anchor\":new yn(Ke.paint_symbol[\"text-translate-anchor\"])})},get layout(){return vU=vU||new qs({\"symbol-placement\":new yn(Ke.layout_symbol[\"symbol-placement\"]),\"symbol-spacing\":new yn(Ke.layout_symbol[\"symbol-spacing\"]),\"symbol-avoid-edges\":new yn(Ke.layout_symbol[\"symbol-avoid-edges\"]),\"symbol-sort-key\":new Rn(Ke.layout_symbol[\"symbol-sort-key\"]),\"symbol-z-order\":new yn(Ke.layout_symbol[\"symbol-z-order\"]),\"icon-allow-overlap\":new yn(Ke.layout_symbol[\"icon-allow-overlap\"]),\"icon-overlap\":new yn(Ke.layout_symbol[\"icon-overlap\"]),\"icon-ignore-placement\":new yn(Ke.layout_symbol[\"icon-ignore-placement\"]),\"icon-optional\":new yn(Ke.layout_symbol[\"icon-optional\"]),\"icon-rotation-alignment\":new yn(Ke.layout_symbol[\"icon-rotation-alignment\"]),\"icon-size\":new Rn(Ke.layout_symbol[\"icon-size\"]),\"icon-text-fit\":new yn(Ke.layout_symbol[\"icon-text-fit\"]),\"icon-text-fit-padding\":new yn(Ke.layout_symbol[\"icon-text-fit-padding\"]),\"icon-image\":new Rn(Ke.layout_symbol[\"icon-image\"]),\"icon-rotate\":new Rn(Ke.layout_symbol[\"icon-rotate\"]),\"icon-padding\":new Rn(Ke.layout_symbol[\"icon-padding\"]),\"icon-keep-upright\":new yn(Ke.layout_symbol[\"icon-keep-upright\"]),\"icon-offset\":new Rn(Ke.layout_symbol[\"icon-offset\"]),\"icon-anchor\":new Rn(Ke.layout_symbol[\"icon-anchor\"]),\"icon-pitch-alignment\":new yn(Ke.layout_symbol[\"icon-pitch-alignment\"]),\"text-pitch-alignment\":new yn(Ke.layout_symbol[\"text-pitch-alignment\"]),\"text-rotation-alignment\":new yn(Ke.layout_symbol[\"text-rotation-alignment\"]),\"text-field\":new Rn(Ke.layout_symbol[\"text-field\"]),\"text-font\":new Rn(Ke.layout_symbol[\"text-font\"]),\"text-size\":new Rn(Ke.layout_symbol[\"text-size\"]),\"text-max-width\":new Rn(Ke.layout_symbol[\"text-max-width\"]),\"text-line-height\":new yn(Ke.layout_symbol[\"text-line-height\"]),\"text-letter-spacing\":new Rn(Ke.layout_symbol[\"text-letter-spacing\"]),\"text-justify\":new Rn(Ke.layout_symbol[\"text-justify\"]),\"text-radial-offset\":new Rn(Ke.layout_symbol[\"text-radial-offset\"]),\"text-variable-anchor\":new yn(Ke.layout_symbol[\"text-variable-anchor\"]),\"text-variable-anchor-offset\":new Rn(Ke.layout_symbol[\"text-variable-anchor-offset\"]),\"text-anchor\":new Rn(Ke.layout_symbol[\"text-anchor\"]),\"text-max-angle\":new yn(Ke.layout_symbol[\"text-max-angle\"]),\"text-writing-mode\":new yn(Ke.layout_symbol[\"text-writing-mode\"]),\"text-rotate\":new Rn(Ke.layout_symbol[\"text-rotate\"]),\"text-padding\":new yn(Ke.layout_symbol[\"text-padding\"]),\"text-keep-upright\":new yn(Ke.layout_symbol[\"text-keep-upright\"]),\"text-transform\":new Rn(Ke.layout_symbol[\"text-transform\"]),\"text-offset\":new Rn(Ke.layout_symbol[\"text-offset\"]),\"text-allow-overlap\":new yn(Ke.layout_symbol[\"text-allow-overlap\"]),\"text-overlap\":new yn(Ke.layout_symbol[\"text-overlap\"]),\"text-ignore-placement\":new yn(Ke.layout_symbol[\"text-ignore-placement\"]),\"text-optional\":new yn(Ke.layout_symbol[\"text-optional\"])})}};class wU{constructor(a){if(a.property.overrides===void 0)throw new Error(\"overrides must be provided to instantiate FormatSectionOverride class\");this.type=a.property.overrides?a.property.overrides.runtimeType:qr,this.defaultValue=a}evaluate(a){if(a.formattedSection){let u=this.defaultValue.property.overrides;if(u&&u.hasOverride(a.formattedSection))return u.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}un(\"FormatSectionOverride\",wU,{omit:[\"defaultValue\"]});class AE extends ka{constructor(a,u){super(a,eB,u)}recalculate(a,u){if(super.recalculate(a,u),this.layout.get(\"icon-rotation-alignment\")===\"auto\"&&(this.layout._values[\"icon-rotation-alignment\"]=this.layout.get(\"symbol-placement\")!==\"point\"?\"map\":\"viewport\"),this.layout.get(\"text-rotation-alignment\")===\"auto\"&&(this.layout._values[\"text-rotation-alignment\"]=this.layout.get(\"symbol-placement\")!==\"point\"?\"map\":\"viewport\"),this.layout.get(\"text-pitch-alignment\")===\"auto\"&&(this.layout._values[\"text-pitch-alignment\"]=this.layout.get(\"text-rotation-alignment\")===\"map\"?\"map\":\"viewport\"),this.layout.get(\"icon-pitch-alignment\")===\"auto\"&&(this.layout._values[\"icon-pitch-alignment\"]=this.layout.get(\"icon-rotation-alignment\")),this.layout.get(\"symbol-placement\")===\"point\"){let p=this.layout.get(\"text-writing-mode\");if(p){let v=[];for(let E of p)v.indexOf(E)<0&&v.push(E);this.layout._values[\"text-writing-mode\"]=v}else this.layout._values[\"text-writing-mode\"]=[\"horizontal\"]}this._setPaintOverrides()}getValueAndResolveTokens(a,u,p,v){let E=this.layout.get(a).evaluate(u,{},p,v),S=this._unevaluatedLayout._values[a];return S.isDataDriven()||wu(S.value)||!E?E:(function(R,F){return F.replace(/{([^{}]+)}/g,((U,H)=>R&&H in R?String(R[H]):\"\"))})(u.properties,E)}createBucket(a){return new i1(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error(\"Should take a different path in FeatureIndex\")}_setPaintOverrides(){for(let a of eB.paint.overridableProperties){if(!AE.hasPaintOverride(this.layout,a))continue;let u=this.paint.get(a),p=new wU(u),v=new ps(p,u.property.specification),E=null;E=u.value.kind===\"constant\"||u.value.kind===\"source\"?new Sh(\"source\",v):new Mg(\"composite\",v,u.value.zoomStops),this.paint._values[a]=new kl(u.property,E,u.parameters)}}_handleOverridablePaintPropertyUpdate(a,u,p){return!(!this.layout||u.isDataDriven()||p.isDataDriven())&&AE.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,u){let p=a.get(\"text-field\"),v=eB.paint.properties[u],E=!1,S=R=>{for(let F of R)if(v.overrides&&v.overrides.hasOverride(F))return void(E=!0)};if(p.value.kind===\"constant\"&&p.value.value instanceof Go)S(p.value.value.sections);else if(p.value.kind===\"source\"||p.value.kind===\"composite\"){let R=U=>{E||(U instanceof Dc&&vo(U.value)===mu?S(U.value.sections):U instanceof Nt?S(U.sections):U.eachChild(R))},F=p.value;F._styleExpression&&R(F._styleExpression.expression)}return E}}let TU;var dfe={get paint(){return TU=TU||new qs({\"background-color\":new yn(Ke.paint_background[\"background-color\"]),\"background-pattern\":new B0(Ke.paint_background[\"background-pattern\"]),\"background-opacity\":new yn(Ke.paint_background[\"background-opacity\"])})}};class pfe extends ka{constructor(a,u){super(a,dfe,u)}}class Afe extends ka{constructor(a,u){super(a,{},u),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode===\"3d\"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error(\"Custom layers cannot be serialized\")}}class gfe{constructor(a){this._methodToThrottle=a,this._triggered=!1,typeof MessageChannel<\"u\"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}let mfe={once:!0},tB=63710088e-1;class z0{constructor(a,u){if(isNaN(a)||isNaN(u))throw new Error(`Invalid LngLat object: (${a}, ${u})`);if(this.lng=+a,this.lat=+u,this.lat>90||this.lat<-90)throw new Error(\"Invalid LngLat latitude value: must be between -90 and 90\")}wrap(){return new z0(Mr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){let u=Math.PI/180,p=this.lat*u,v=a.lat*u,E=Math.sin(p)*Math.sin(v)+Math.cos(p)*Math.cos(v)*Math.cos((a.lng-this.lng)*u);return tB*Math.acos(Math.min(E,1))}static convert(a){if(a instanceof z0)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new z0(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a==\"object\"&&a!==null)return new z0(Number(\"lng\"in a?a.lng:a.lon),Number(a.lat));throw new Error(\"`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]\")}}let EU=2*Math.PI*tB;function SU(h){return EU*Math.cos(h*Math.PI/180)}function CU(h){return(180+h)/360}function MU(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function IU(h,a){return h/SU(a)}function PU(h){return 360*h-180}function gE(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function RU(h,a){return h*SU(gE(a))}class Ux{constructor(a,u,p=0){this.x=+a,this.y=+u,this.z=+p}static fromLngLat(a,u=0){let p=z0.convert(a);return new Ux(CU(p.lng),MU(p.lat),IU(u,p.lat))}toLngLat(){return new z0(PU(this.x),gE(this.y))}toAltitude(){return RU(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/EU*(a=gE(this.y),1/Math.cos(a*Math.PI/180));var a}}function BU(h,a,u){var p=2*Math.PI*6378137/256/Math.pow(2,u);return[h*p-2*Math.PI*6378137/2,a*p-2*Math.PI*6378137/2]}class nB{constructor(a,u,p){if(!(function(v,E,S){return!(v<0||v>25||S<0||S>=Math.pow(2,v)||E<0||E>=Math.pow(2,v))})(a,u,p))throw new Error(`x=${u}, y=${p}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=u,this.y=p,this.key=o1(0,a,a,u,p)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,u,p){let v=(S=this.y,R=this.z,F=BU(256*(E=this.x),256*(S=Math.pow(2,R)-S-1),R),U=BU(256*(E+1),256*(S+1),R),F[0]+\",\"+F[1]+\",\"+U[0]+\",\"+U[1]);var E,S,R,F,U;let H=(function(X,$,te){let oe,le=\"\";for(let ue=X;ue>0;ue--)oe=1<<ue-1,le+=($&oe?1:0)+(te&oe?2:0);return le})(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p===\"tms\"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?\"@2x\":\"\").replace(/{quadkey}/g,H).replace(/{bbox-epsg-3857}/g,v)}isChildOf(a){let u=this.z-a.z;return u>0&&a.x===this.x>>u&&a.y===this.y>>u}getTilePoint(a){let u=Math.pow(2,this.z);return new s((a.x*u-this.x)*rn,(a.y*u-this.y)*rn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class DU{constructor(a,u){this.wrap=a,this.canonical=u,this.key=o1(a,u.z,u.z,u.x,u.y)}}class Uc{constructor(a,u,p,v,E){if(this.terrainRttPosMatrix32f=null,a<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${p}`);this.overscaledZ=a,this.wrap=u,this.canonical=new nB(p,+v,+E),this.key=o1(u,a,p,v,E)}clone(){return new Uc(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);let u=this.canonical.z-a;return a>this.canonical.z?new Uc(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Uc(a,this.wrap,a,this.canonical.x>>u,this.canonical.y>>u)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(a,u){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);let p=this.canonical.z-a;return a>this.canonical.z?o1(this.wrap*+u,a,this.canonical.z,this.canonical.x,this.canonical.y):o1(this.wrap*+u,a,a,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(a){if(a.wrap!==this.wrap||this.overscaledZ-a.overscaledZ<=0)return!1;if(a.overscaledZ===0)return this.overscaledZ>0;let u=this.canonical.z-a.canonical.z;return!(u<0)&&a.canonical.x===this.canonical.x>>u&&a.canonical.y===this.canonical.y>>u}children(a){if(this.overscaledZ>=a)return[new Uc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let u=this.canonical.z+1,p=2*this.canonical.x,v=2*this.canonical.y;return[new Uc(u,this.wrap,u,p,v),new Uc(u,this.wrap,u,p+1,v),new Uc(u,this.wrap,u,p,v+1),new Uc(u,this.wrap,u,p+1,v+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new Uc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new Uc(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new DU(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new Ux(a.x-this.wrap,a.y))}}function o1(h,a,u,p,v){(h*=2)<0&&(h=-1*h-1);let E=1<<u;return(E*E*h+E*v+p).toString(36)+u.toString(36)+a.toString(36)}function rB(h,a){return a?h.properties[a]:h.id}function _fe(h,a){let u={id:h.id};if(a.removeAllProperties&&(delete h.removeProperties,delete h.addOrUpdateProperties,delete a.removeProperties),a.removeProperties)for(let p of a.removeProperties){let v=h.addOrUpdateProperties.findIndex((E=>E.key===p));v>-1&&h.addOrUpdateProperties.splice(v,1)}return(h.removeAllProperties||a.removeAllProperties)&&(u.removeAllProperties=!0),(h.removeProperties||a.removeProperties)&&(u.removeProperties=[...h.removeProperties||[],...a.removeProperties||[]]),(h.addOrUpdateProperties||a.addOrUpdateProperties)&&(u.addOrUpdateProperties=[...h.addOrUpdateProperties||[],...a.addOrUpdateProperties||[]]),(h.newGeometry||a.newGeometry)&&(u.newGeometry=a.newGeometry||h.newGeometry),u}function LU(h){var a,u;if(!h)return{};let p={};return p.removeAll=h.removeAll,p.remove=new Set(h.remove||[]),p.add=new Map((a=h.add)===null||a===void 0?void 0:a.map((v=>[v.id,v]))),p.update=new Map((u=h.update)===null||u===void 0?void 0:u.map((v=>[v.id,v]))),p}un(\"CanonicalTileID\",nB),un(\"OverscaledTileID\",Uc,{omit:[\"terrainRttPosMatrix32f\"]});class Xg{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(a){return this.minX=Math.min(this.minX,a.x),this.minY=Math.min(this.minY,a.y),this.maxX=Math.max(this.maxX,a.x),this.maxY=Math.max(this.maxY,a.y),this}expandBy(a){return this.minX-=a,this.minY-=a,this.maxX+=a,this.maxY+=a,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(a){return this.expandBy(-a)}map(a){let u=new Xg;return u.extend(a(new s(this.minX,this.minY))),u.extend(a(new s(this.maxX,this.minY))),u.extend(a(new s(this.minX,this.maxY))),u.extend(a(new s(this.maxX,this.maxY))),u}static fromPoints(a){let u=new Xg;for(let p of a)u.extend(p);return u}contains(a){return a.x>=this.minX&&a.x<=this.maxX&&a.y>=this.minY&&a.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(a){return!this.empty()&&!a.empty()&&a.minX>=this.minX&&a.maxX<=this.maxX&&a.minY>=this.minY&&a.maxY<=this.maxY}intersects(a){return!this.empty()&&!a.empty()&&a.minX<=this.maxX&&a.maxX>=this.minX&&a.minY<=this.maxY&&a.maxY>=this.minY}}class OU{constructor(a){this._stringToNumber={},this._numberToString=[];for(let u=0;u<a.length;u++){let p=a[u];this._stringToNumber[p]=u,this._numberToString[u]=p}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class FU{constructor(a,u,p,v,E){this.type=\"Feature\",this._vectorTileFeature=a,this._x=p,this._y=v,this._z=u,this.properties=a.properties,this.id=E}projectPoint(a,u,p,v){return[360*(a.x+u)/v-180,360/Math.PI*Math.atan(Math.exp((1-2*(a.y+p)/v)*Math.PI))-90]}projectLine(a,u,p,v){return a.map((E=>this.projectPoint(E,u,p,v)))}get geometry(){if(this._geometry)return this._geometry;let a=this._vectorTileFeature,u=a.extent*Math.pow(2,this._z),p=a.extent*this._x,v=a.extent*this._y,E=a.loadGeometry();switch(a.type){case 1:{let S=[];for(let F of E)S.push(F[0]);let R=this.projectLine(S,p,v,u);this._geometry=S.length===1?{type:\"Point\",coordinates:R[0]}:{type:\"MultiPoint\",coordinates:R};break}case 2:{let S=E.map((R=>this.projectLine(R,p,v,u)));this._geometry=S.length===1?{type:\"LineString\",coordinates:S[0]}:{type:\"MultiLineString\",coordinates:S};break}case 3:{let S=K7(E),R=[];for(let F of S)R.push(F.map((U=>this.projectLine(U,p,v,u))));this._geometry=R.length===1?{type:\"Polygon\",coordinates:R[0]}:{type:\"MultiPolygon\",coordinates:R};break}default:throw new Error(`unknown feature type: ${a.type}`)}return this._geometry}set geometry(a){this._geometry=a}toJSON(){let a={geometry:this.geometry};for(let u in this)u!==\"_geometry\"&&u!==\"_vectorTileFeature\"&&u!==\"_x\"&&u!==\"_y\"&&u!==\"_z\"&&(a[u]=this[u]);return a}}class s1{_name;dataBuffer;nullabilityBuffer;_size;constructor(a,u,p){this._name=a,this.dataBuffer=u,typeof p==\"number\"?this._size=p:(this.nullabilityBuffer=p,this._size=p.size())}getValue(a){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(a)?null:this.getValueFromBuffer(a)}has(a){return this.nullabilityBuffer&&this.nullabilityBuffer.get(a)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class mE extends s1{}class iB extends mE{getValueFromBuffer(a){return this.dataBuffer[a]}}class oB extends mE{getValueFromBuffer(a){return this.dataBuffer[a]}}class kU extends s1{delta;constructor(a,u,p,v){super(a,u,v),this.delta=p}}class sB extends kU{constructor(a,u,p,v){super(a,Int32Array.of(u),p,v)}getValueFromBuffer(a){return this.dataBuffer[0]+a*this.delta}}class aB extends s1{constructor(a,u,p){super(a,Int32Array.of(u),p)}getValueFromBuffer(a){return this.dataBuffer[0]}}class yfe{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(a,u,p,v,E=4096){this._name=a,this._geometryVector=u,this._idVector=p,this._propertyVectors=v,this._extent=E}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(a){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((u=>[u.name,u])))),this.propertyVectorsMap.get(a)}*[Symbol.iterator](){let a=this.geometryVector[Symbol.iterator](),u=0;for(;u<this.numFeatures;){let p;this.idVector&&(p=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(u)):this.idVector.getValue(u));let v=a?.next().value,E={};for(let S of this.propertyVectors){if(!S)continue;let R=S.name,F=S.getValue(u);F!==null&&(E[R]=F)}u++,yield{id:p,geometry:v,properties:E}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){let a=[],u=this.geometryVector.getGeometries();for(let p=0;p<this.numFeatures;p++){let v;this.idVector&&(v=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(p)):this.idVector.getValue(p));let E={coordinates:u[p],type:this.geometryVector.geometryType(p)},S={};for(let R of this.propertyVectors){if(!R)continue;let F=R.name,U=R.getValue(p);U!==null&&(S[F]=U)}a.push({id:v,geometry:E,properties:S})}return a}containsMaxSaveIntegerValues(a){return a instanceof iB||a instanceof aB&&a instanceof sB||a instanceof oB}}class xfe{value;constructor(a){this.value=a}get(){return this.value}set(a){this.value=a}increment(){return this.value++}add(a){this.value+=a}}var yr,$d,ha,Fh,Yg,hc,Bs,Ds,NU,Vc;function Ks(h,a,u){let p=new Int32Array(u),v=0,E=a.get();for(let S=0;S<p.length;S++){let R=h[E++],F=127&R;R<128||(R=h[E++],F|=(127&R)<<7,R<128||(R=h[E++],F|=(127&R)<<14,R<128||(R=h[E++],F|=(127&R)<<21,R<128||(R=h[E++],F|=(15&R)<<28)))),p[v++]=F}return a.set(E),p}function _E(h,a,u){let p=new BigInt64Array(u);for(let v=0;v<p.length;v++)p[v]=bfe(h,a);return p}function vfe(h,a){let u,p;return p=h[a.get()],a.increment(),u=127&p,p<128?u:(p=h[a.get()],a.increment(),u|=(127&p)<<7,p<128?u:(p=h[a.get()],a.increment(),u|=(127&p)<<14,p<128?u:(p=h[a.get()],a.increment(),u|=(127&p)<<21,p<128?u:(p=h[a.get()],u|=(15&p)<<28,(function(v,E,S){let R,F;if(F=E[S.get()],S.increment(),R=(112&F)>>4,F<128||(F=E[S.get()],S.increment(),R|=(127&F)<<3,F<128)||(F=E[S.get()],S.increment(),R|=(127&F)<<10,F<128)||(F=E[S.get()],S.increment(),R|=(127&F)<<17,F<128)||(F=E[S.get()],S.increment(),R|=(127&F)<<24,F<128)||(F=E[S.get()],S.increment(),R|=(1&F)<<31,F<128))return 4294967296*R+(v>>>0);throw new Error(\"Expected varint not more than 10 bytes\")})(u,h,a)))))}function zU(h,a,u,p){throw new Error(\"FastPFor is not implemented yet.\")}function Zg(h){return h>>>1^-(1&h)}function a1(h){return h>>1n^-(1n&h)}function bfe(h,a){let u=0n,p=0,v=a.get();for(;v<h.length;){let E=h[v++];if(u|=BigInt(127&E)<<BigInt(p),!(128&E))break;if(p+=7,p>=64)throw new Error(\"Varint too long\")}return a.set(v),u}function UU(h,a,u){let p=new Int32Array(u),v=0;for(let E=0;E<a;E++){let S=h[E];p.fill(h[E+a],v,v+S),v+=S}return p}function VU(h,a,u){let p=new BigInt64Array(u),v=0;for(let E=0;E<a;E++){let S=Number(h[E]);p.fill(h[E+a],v,v+S),v+=S}return p}function GU(h,a,u){let p=new Float64Array(u),v=0;for(let E=0;E<a;E++){let S=h[E];p.fill(h[E+a],v,v+S),v+=S}return p}function lB(h){let a=h.length/4*4,u=1;if(a>=4)for(let p=h[0];u<a-4;u+=4)p=h[u]+=p,p=h[u+1]+=p,p=h[u+2]+=p,p=h[u+3]+=p;for(;u!=h.length;)h[u]+=h[u-1],++u}function HU(h){h[0]=h[0]>>>1^-(1&h[0]),h[1]=h[1]>>>1^-(1&h[1]);let a=h.length/4*4,u=2;if(a>=4)for(;u<a-4;u+=4){let p=h[u],v=h[u+1],E=h[u+2],S=h[u+3];h[u]=(p>>>1^-(1&p))+h[u-2],h[u+1]=(v>>>1^-(1&v))+h[u-1],h[u+2]=(E>>>1^-(1&E))+h[u],h[u+3]=(S>>>1^-(1&S))+h[u+1]}for(;u!=h.length;u+=2)h[u]=(h[u]>>>1^-(1&h[u]))+h[u-2],h[u+1]=(h[u+1]>>>1^-(1&h[u+1]))+h[u-1]}(function(h){h.NONE=\"NONE\",h.DELTA=\"DELTA\",h.COMPONENTWISE_DELTA=\"COMPONENTWISE_DELTA\",h.RLE=\"RLE\",h.MORTON=\"MORTON\",h.PDE=\"PDE\"})(yr||(yr={})),(function(h){h.NONE=\"NONE\",h.FAST_PFOR=\"FAST_PFOR\",h.VARINT=\"VARINT\",h.ALP=\"ALP\"})($d||($d={})),(function(h){h.PRESENT=\"PRESENT\",h.DATA=\"DATA\",h.OFFSET=\"OFFSET\",h.LENGTH=\"LENGTH\"})(ha||(ha={}));class cB{_dictionaryType;_offsetType;_lengthType;constructor(a,u,p){this._dictionaryType=a,this._offsetType=u,this._lengthType=p}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function al(h,a){let u=(function(p,v){let E=p[v.get()],S=Object.values(ha)[E>>4],R=null;switch(S){case ha.DATA:R=new cB(Object.values(Fh)[15&E]);break;case ha.OFFSET:R=new cB(null,Object.values(Yg)[15&E]);break;case ha.LENGTH:R=new cB(null,null,Object.values(hc)[15&E])}v.increment();let F=p[v.get()],U=Object.values(yr)[F>>5],H=Object.values(yr)[F>>2&7],X=Object.values($d)[3&F];v.increment();let $=Ks(p,v,2),te=$[0];return{physicalStreamType:S,logicalStreamType:R,logicalLevelTechnique1:U,logicalLevelTechnique2:H,physicalLevelTechnique:X,numValues:te,byteLength:$[1],decompressedCount:te}})(h,a);return u.logicalLevelTechnique1===yr.MORTON?(function(p,v,E){let S=Ks(v,E,2);return{physicalStreamType:p.physicalStreamType,logicalStreamType:p.logicalStreamType,logicalLevelTechnique1:p.logicalLevelTechnique1,logicalLevelTechnique2:p.logicalLevelTechnique2,physicalLevelTechnique:p.physicalLevelTechnique,numValues:p.numValues,byteLength:p.byteLength,decompressedCount:p.decompressedCount,numBits:S[0],coordinateShift:S[1]}})(u,h,a):yr.RLE!==u.logicalLevelTechnique1&&yr.RLE!==u.logicalLevelTechnique2||$d.NONE===u.physicalLevelTechnique?u:(function(p,v,E){let S=Ks(v,E,2);return{physicalStreamType:p.physicalStreamType,logicalStreamType:p.logicalStreamType,logicalLevelTechnique1:p.logicalLevelTechnique1,logicalLevelTechnique2:p.logicalLevelTechnique2,physicalLevelTechnique:p.physicalLevelTechnique,numValues:p.numValues,byteLength:p.byteLength,decompressedCount:S[1],runs:S[0],numRleValues:S[1]}})(u,h,a)}(function(h){h.NONE=\"NONE\",h.SINGLE=\"SINGLE\",h.SHARED=\"SHARED\",h.VERTEX=\"VERTEX\",h.MORTON=\"MORTON\",h.FSST=\"FSST\"})(Fh||(Fh={})),(function(h){h.VERTEX=\"VERTEX\",h.INDEX=\"INDEX\",h.STRING=\"STRING\",h.KEY=\"KEY\"})(Yg||(Yg={})),(function(h){h.VAR_BINARY=\"VAR_BINARY\",h.GEOMETRIES=\"GEOMETRIES\",h.PARTS=\"PARTS\",h.RINGS=\"RINGS\",h.TRIANGLES=\"TRIANGLES\",h.SYMBOL=\"SYMBOL\",h.DICTIONARY=\"DICTIONARY\"})(hc||(hc={})),(function(h){h[h.FLAT=0]=\"FLAT\",h[h.CONST=1]=\"CONST\",h[h.SEQUENCE=2]=\"SEQUENCE\",h[h.DICTIONARY=3]=\"DICTIONARY\",h[h.FSST_DICTIONARY=4]=\"FSST_DICTIONARY\"})(Bs||(Bs={}));class kh{values;_size;constructor(a,u){this.values=a,this._size=u}get(a){let u=Math.floor(a/8);return(this.values[u]>>a%8&1)==1}set(a,u){let p=Math.floor(a/8);this.values[p]=this.values[p]|(u?1:0)<<a%8}getInt(a){let u=Math.floor(a/8);return this.values[u]>>a%8&1}size(){return this._size}getBuffer(){return this.values}}function ll(h,a,u,p,v){return(function(E,S,R){switch(S.logicalLevelTechnique1){case yr.DELTA:return S.logicalLevelTechnique2===yr.RLE?(function(F,U,H){let X=new Int32Array(H),$=0,te=0;for(let oe=0;oe<U;oe++){let le=F[oe],ue=Zg(F[oe+U]);for(let me=0;me<le;me++)te+=ue,X[$++]=te}return X})(E,S.runs,S.numRleValues):((function(F){F[0]=F[0]>>>1^-(1&F[0]);let U=F.length/4*4,H=1;if(U>=4)for(;H<U-4;H+=4){let X=F[H],$=F[H+1],te=F[H+2],oe=F[H+3];F[H]=(X>>>1^-(1&X))+F[H-1],F[H+1]=($>>>1^-(1&$))+F[H],F[H+2]=(te>>>1^-(1&te))+F[H+1],F[H+3]=(oe>>>1^-(1&oe))+F[H+2]}for(;H!=F.length;++H)F[H]=(F[H]>>>1^-(1&F[H]))+F[H-1]})(E),E);case yr.RLE:return(function(F,U,H){return H?(function(X,$,te){let oe=new Int32Array(te),le=0;for(let ue=0;ue<$;ue++){let me=X[ue],Le=X[ue+$];Le=Le>>>1^-(1&Le),oe.fill(Le,le,le+me),le+=me}return oe})(F,U.runs,U.numRleValues):UU(F,U.runs,U.numRleValues)})(E,S,R);case yr.MORTON:return lB(E),E;case yr.COMPONENTWISE_DELTA:return HU(E),E;case yr.NONE:return R&&(function(F){for(let U=0;U<F.length;U++){let H=F[U];F[U]=H>>>1^-(1&H)}})(E),E;default:throw new Error(`The specified Logical level technique is not supported: ${S.logicalLevelTechnique1}`)}})(yE(h,a,u),u,p)}function U0(h,a,u){return(function(p,v){if(v.logicalLevelTechnique1===yr.DELTA&&v.logicalLevelTechnique2===yr.NONE)return(function(S){let R=new Int32Array(S.length+1);R[0]=0,R[1]=Zg(S[0]);let F=R[1],U=2;for(;U!=R.length;++U){let H=S[U-1];F+=H>>>1^-(1&H),R[U]=R[U-1]+F}return R})(p);if(v.logicalLevelTechnique1===yr.RLE&&v.logicalLevelTechnique2===yr.NONE)return(function(S,R,F){let U=new Int32Array(F+1);U[0]=0;let H=1,X=U[0];for(let $=0;$<R;$++){let te=S[$],oe=S[$+R];for(let le=H;le<H+te;le++)U[le]=oe+X,X=U[le];H+=te}return U})(p,v.runs,v.numRleValues);if(v.logicalLevelTechnique1===yr.NONE&&v.logicalLevelTechnique2===yr.NONE){(function(S){let R=0;for(let F=0;F<S.length;F++)S[F]+=R,R=S[F]})(p);let E=new Int32Array(v.numValues+1);return E[0]=0,E.set(p,1),E}if(v.logicalLevelTechnique1===yr.DELTA&&v.logicalLevelTechnique2===yr.RLE){let E=(function(S,R,F){let U=new Int32Array(F+1);U[0]=0;let H=1,X=U[0];for(let $=0;$<R;$++){let te=S[$],oe=S[$+R];oe=oe>>>1^-(1&oe);for(let le=H;le<H+te;le++)U[le]=oe+X,X=U[le];H+=te}return U})(p,v.runs,v.numRleValues);return lB(E),E}throw new Error(\"Only delta encoding is supported for transforming length to offset streams yet.\")})(yE(h,a,u),u)}function yE(h,a,u){let p=u.physicalLevelTechnique;if(p===$d.FAST_PFOR)return zU();if(p===$d.VARINT)return Ks(h,a,u.numValues);if(p===$d.NONE){let v=a.get();a.add(u.byteLength);let E=h.subarray(v,a.get());return new Int32Array(E)}throw new Error(\"Specified physicalLevelTechnique is not supported (yet).\")}function uB(h,a,u,p){let v=yE(h,a,u);if(v.length===1){let E=v[0];return p?Zg(E):E}return p?(function(E){return Zg(E[1])})(v):(function(E){return E[1]})(v)}function WU(h,a,u){return(function(p){if(p.length==2){let v=Zg(p[1]);return[v,v]}return[Zg(p[2]),Zg(p[3])]})(yE(h,a,u))}function jU(h,a,u){return(function(p){if(p.length==2){let v=a1(p[1]);return[v,v]}return[a1(p[2]),a1(p[3])]})(_E(h,a,u.numValues))}function XU(h,a,u,p){return(function(v,E,S){switch(E.logicalLevelTechnique1){case yr.DELTA:return E.logicalLevelTechnique2===yr.RLE?(function(R,F,U){let H=new BigInt64Array(U),X=0,$=0n;for(let te=0;te<F;te++){let oe=Number(R[te]),le=a1(R[te+F]);for(let ue=0;ue<oe;ue++)$+=le,H[X++]=$}return H})(v,E.runs,E.numRleValues):((function(R){R[0]=R[0]>>1n^-(1n&R[0]);let F=R.length/4*4,U=1;if(F>=4)for(;U<F-4;U+=4){let H=R[U],X=R[U+1],$=R[U+2],te=R[U+3];R[U]=(H>>1n^-(1n&H))+R[U-1],R[U+1]=(X>>1n^-(1n&X))+R[U],R[U+2]=($>>1n^-(1n&$))+R[U+1],R[U+3]=(te>>1n^-(1n&te))+R[U+2]}for(;U!=R.length;++U)R[U]=(R[U]>>1n^-(1n&R[U]))+R[U-1]})(v),v);case yr.RLE:return(function(R,F,U){return U?(function(H,X,$){let te=new BigInt64Array($),oe=0;for(let le=0;le<X;le++){let ue=Number(H[le]),me=H[le+X];me=me>>1n^-(1n&me),te.fill(me,oe,oe+ue),oe+=ue}return te})(R,F.runs,F.numRleValues):VU(R,F.runs,F.numRleValues)})(v,E,S);case yr.NONE:return S&&(function(R){for(let F=0;F<R.length;F++){let U=R[F];R[F]=U>>1n^-(1n&U)}})(v),v;default:throw new Error(`The specified Logical level technique is not supported: ${E.logicalLevelTechnique1}`)}})(_E(h,a,u.numValues),u,p)}function YU(h,a,u,p){let v=_E(h,a,u.numValues);if(v.length===1){let E=v[0];return p?a1(E):E}return p?(function(E){return a1(E[1])})(v):(function(E){return E[1]})(v)}function hB(h,a,u,p,v){return(function(E,S,R,F){switch(S.logicalLevelTechnique1){case yr.DELTA:return S.logicalLevelTechnique2===yr.RLE&&(E=UU(E,S.runs,S.numRleValues)),(function(U,H){let X=new Int32Array(U.size()),$=0;U.get(0)?(X[0]=U.get(0)?H[0]>>>1^-(1&H[0]):0,$=1):X[0]=0;let te=1;for(;te!=X.length;++te)X[te]=U.get(te)?X[te-1]+(H[$]>>>1^-(1&H[$++])):X[te-1];return X})(F,E);case yr.RLE:return(function(U,H,X,$){let te=H;return X?(function(oe,le,ue){let me=new Int32Array(oe.size()),Le=0;for(let ye=0;ye<ue;ye++){let we=le[ye],ke=le[ye+ue];ke=ke>>>1^-(1&ke);for(let je=Le;je<Le+we;je++)oe.get(je)?me[je]=ke:(me[je]=0,Le++);Le+=we}return me})($,U,te.runs):(function(oe,le,ue){let me=new Int32Array(oe.size()),Le=0;for(let ye=0;ye<ue;ye++){let we=le[ye],ke=le[ye+ue];for(let je=Le;je<Le+we;je++)oe.get(je)?me[je]=ke:(me[je]=0,Le++);Le+=we}return me})($,U,te.runs)})(E,S,R,F);case yr.MORTON:return lB(E),E;case yr.COMPONENTWISE_DELTA:return HU(E),E;case yr.NONE:return E=R?(function(U,H){let X=new Int32Array(U.size()),$=0,te=0;for(;te!=X.length;++te)if(U.get(te)){let oe=H[$++];X[te]=oe>>>1^-(1&oe)}else X[te]=0;return X})(F,E):(function(U,H){let X=new Int32Array(U.size()),$=0,te=0;for(;te!=X.length;++te)X[te]=U.get(te)?H[$++]:0;return X})(F,E),E;default:throw new Error(\"The specified Logical level technique is not supported\")}})(u.physicalLevelTechnique===$d.FAST_PFOR?zU():Ks(h,a,u.numValues),u,p,v)}function xE(h,a,u,p){let v=h.logicalLevelTechnique1;if(v===yr.RLE)return h.runs===1?Bs.CONST:Bs.FLAT;let E=a instanceof kh?a.size():a;if(v===yr.DELTA&&h.logicalLevelTechnique2===yr.RLE){let S=h.runs,R=2;if(h.numRleValues!==E)return Bs.FLAT;if(S===1)return Bs.SEQUENCE;if(S===2){let F=p.get(),U;if(h.physicalLevelTechnique===$d.VARINT)U=Ks(u,p,4);else{let H=p.get();U=new Int32Array(u.buffer,u.byteOffset+H,4)}if(p.set(F),U[2]===R&&U[3]===R)return Bs.SEQUENCE}}return h.numValues===1?Bs.CONST:Bs.FLAT}class ZU extends mE{getValueFromBuffer(a){return this.dataBuffer[a]}}class qU extends kU{constructor(a,u,p,v){super(a,BigInt64Array.of(u),p,v)}getValueFromBuffer(a){return this.dataBuffer[0]+BigInt(a)*this.delta}}class l1{_geometryOffsets;_partOffsets;_ringOffsets;constructor(a,u,p){this._geometryOffsets=a,this._partOffsets=u,this._ringOffsets=p}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function fB(h,a,u){return{x:QU(h,a)-u,y:QU(h>>1,a)-u}}function QU(h,a){let u=0;for(let p=0;p<a;p++)u|=(h&1<<2*p)>>p;return u}(function(h){h[h.POINT=0]=\"POINT\",h[h.LINESTRING=1]=\"LINESTRING\",h[h.POLYGON=2]=\"POLYGON\",h[h.MULTIPOINT=3]=\"MULTIPOINT\",h[h.MULTILINESTRING=4]=\"MULTILINESTRING\",h[h.MULTIPOLYGON=5]=\"MULTIPOLYGON\"})(Ds||(Ds={})),(function(h){h[h.POINT=0]=\"POINT\",h[h.LINESTRING=1]=\"LINESTRING\",h[h.POLYGON=2]=\"POLYGON\"})(NU||(NU={})),(function(h){h[h.MORTON=0]=\"MORTON\",h[h.VEC_2=1]=\"VEC_2\",h[h.VEC_3=2]=\"VEC_3\"})(Vc||(Vc={}));class wfe{createPoint(a){return[[a]]}createMultiPoint(a){return a.map((u=>[u]))}createLineString(a){return[a]}createMultiLineString(a){return a}createPolygon(a,u){return[a].concat(u)}createMultiPolygon(a){return a.flat()}}function KU(h){let a=new Array(h.numGeometries),u=1,p=1,v=1,E=0,S=new wfe,R=0,F=0,U=h.mortonSettings,H=h.topologyVector,X=H.geometryOffsets,$=H.partOffsets,te=H.ringOffsets,oe=h.vertexOffsets,le=h.containsPolygonGeometry(),ue=h.vertexBuffer;for(let me=0;me<h.numGeometries;me++){let Le=h.geometryType(me);if(Le===Ds.POINT){if(oe&&oe.length!==0)if(h.vertexBufferType===Vc.VEC_2){let ye=2*oe[F++],we=new s(ue[ye],ue[ye+1]);a[E++]=S.createPoint(we)}else{let ye=fB(ue[oe[F++]],U.numBits,U.coordinateShift),we=new s(ye.x,ye.y);a[E++]=S.createPoint(we)}else{let ye=new s(ue[R++],ue[R++]);a[E++]=S.createPoint(ye)}X&&v++,$&&u++,te&&p++}else if(Le===Ds.MULTIPOINT){let ye=X[v]-X[v-1];v++;let we=new Array(ye);if(oe&&oe.length!==0){for(let ke=0;ke<ye;ke++){let je=2*oe[F++];we[ke]=new s(ue[je],ue[je+1])}a[E++]=S.createMultiPoint(we)}else{for(let ke=0;ke<ye;ke++){let je=ue[R++],ht=ue[R++];we[ke]=new s(je,ht)}a[E++]=S.createMultiPoint(we)}}else if(Le===Ds.LINESTRING){let ye,we=0;le?(we=te[p]-te[p-1],p++):we=$[u]-$[u-1],u++,oe&&oe.length!==0?(ye=h.vertexBufferType===Vc.VEC_2?pB(ue,oe,F,we,!1):AB(ue,oe,F,we,!1,U),F+=we):(ye=dB(ue,R,we,!1),R+=2*we),a[E++]=S.createLineString(ye),X&&v++}else if(Le===Ds.POLYGON){let ye=$[u]-$[u-1];u++;let we=new Array(ye-1),ke=te[p]-te[p-1];if(p++,oe&&oe.length!==0){let je=h.vertexBufferType===Vc.VEC_2?bE(ue,oe,F,ke):wE(ue,oe,F,ke,0,U);F+=ke;for(let ht=0;ht<we.length;ht++)ke=te[p]-te[p-1],p++,we[ht]=h.vertexBufferType===Vc.VEC_2?bE(ue,oe,F,ke):wE(ue,oe,F,ke,0,U),F+=ke;a[E++]=S.createPolygon(je,we)}else{let je=vE(ue,R,ke);R+=2*ke;for(let ht=0;ht<we.length;ht++)ke=te[p]-te[p-1],p++,we[ht]=vE(ue,R,ke),R+=2*ke;a[E++]=S.createPolygon(je,we)}X&&v++}else if(Le===Ds.MULTILINESTRING){let ye=X[v]-X[v-1];v++;let we=new Array(ye);if(oe&&oe.length!==0){for(let ke=0;ke<ye;ke++){let je=0;le?(je=te[p]-te[p-1],p++):je=$[u]-$[u-1],u++;let ht=h.vertexBufferType===Vc.VEC_2?pB(ue,oe,F,je,!1):AB(ue,oe,F,je,!1,U);we[ke]=ht,F+=je}a[E++]=S.createMultiLineString(we)}else{for(let ke=0;ke<ye;ke++){let je=0;le?(je=te[p]-te[p-1],p++):je=$[u]-$[u-1],u++,we[ke]=dB(ue,R,je,!1),R+=2*je}a[E++]=S.createMultiLineString(we)}}else{if(Le!==Ds.MULTIPOLYGON)throw new Error(\"The specified geometry type is currently not supported.\");{let ye=X[v]-X[v-1];v++;let we=new Array(ye),ke=0;if(oe&&oe.length!==0){for(let je=0;je<ye;je++){let ht=$[u]-$[u-1];u++;let It=new Array(ht-1);ke=te[p]-te[p-1],p++;let wt=h.vertexBufferType===Vc.VEC_2?bE(ue,oe,F,ke):wE(ue,oe,F,ke,0,U);F+=ke;for(let Rt=0;Rt<It.length;Rt++)ke=te[p]-te[p-1],p++,It[Rt]=h.vertexBufferType===Vc.VEC_2?bE(ue,oe,F,ke):wE(ue,oe,F,ke,0,U),F+=ke;we[je]=S.createPolygon(wt,It)}a[E++]=S.createMultiPolygon(we)}else{for(let je=0;je<ye;je++){let ht=$[u]-$[u-1];u++;let It=new Array(ht-1);ke=te[p]-te[p-1],p++;let wt=vE(ue,R,ke);R+=2*ke;for(let Rt=0;Rt<It.length;Rt++){let Qt=te[p]-te[p-1];p++,It[Rt]=vE(ue,R,Qt),R+=2*Qt}we[je]=S.createPolygon(wt,It)}a[E++]=S.createMultiPolygon(we)}}}}return a}function vE(h,a,u){return dB(h,a,u,!0)}function bE(h,a,u,p){return pB(h,a,u,p,!0)}function wE(h,a,u,p,v,E){return AB(h,a,u,p,!0,E)}function dB(h,a,u,p){let v=new Array(p?u+1:u);for(let E=0;E<2*u;E+=2)v[E/2]=new s(h[a+E],h[a+E+1]);return p&&(v[v.length-1]=v[0]),v}function pB(h,a,u,p,v){let E=new Array(v?p+1:p);for(let S=0;S<2*p;S+=2){let R=2*a[u+S/2];E[S/2]=new s(h[R],h[R+1])}return v&&(E[E.length-1]=E[0]),E}function AB(h,a,u,p,v,E){let S=new Array(v?p+1:p);for(let R=0;R<p;R++){let F=fB(h[a[u+R]],E.numBits,E.coordinateShift);S[R]=new s(F.x,F.y)}return v&&(S[S.length-1]=S[0]),S}class JU{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(a,u,p,v,E){this._vertexBufferType=a,this._topologyVector=u,this._vertexOffsets=p,this._vertexBuffer=v,this._mortonSettings=E}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){let a=KU(this),u=0;for(;u<this.numGeometries;)yield{coordinates:a[u],type:this.geometryType(u)},u++}getSimpleEncodedVertex(a){let u=this.vertexOffsets?2*this.vertexOffsets[a]:2*a;return[this.vertexBuffer[u],this.vertexBuffer[u+1]]}getVertex(a){if(this.vertexOffsets&&this.mortonSettings){let p=fB(this.vertexBuffer[this.vertexOffsets[a]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[p.x,p.y]}let u=this.vertexOffsets?2*this.vertexOffsets[a]:2*a;return[this.vertexBuffer[u],this.vertexBuffer[u+1]]}getGeometries(){return KU(this)}get mortonSettings(){return this._mortonSettings}}class $U extends JU{_numGeometries;_geometryType;constructor(a,u,p,v,E,S,R){super(p,v,E,S,R),this._numGeometries=a,this._geometryType=u}geometryType(a){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===Ds.POLYGON||this._geometryType===Ds.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class eV extends JU{_geometryTypes;constructor(a,u,p,v,E,S){super(a,p,v,E,S),this._geometryTypes=u}geometryType(a){return this._geometryTypes[a]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let a=0;a<this.numGeometries;a++)if(this.geometryType(a)===Ds.POLYGON||this.geometryType(a)===Ds.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class tV{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(a,u,p,v){this._triangleOffsets=a,this._indexBuffer=u,this._vertexBuffer=p,this._topologyVector=v}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error(\"Cannot convert GpuVector to coordinates without topology information\");let a=new Array(this.numGeometries),u=this._topologyVector,p=u.partOffsets,v=u.ringOffsets,E=u.geometryOffsets,S=0,R=1,F=1,U=1;for(let H=0;H<this.numGeometries;H++)switch(this.geometryType(H)){case Ds.POLYGON:{let X=p[R]-p[R-1];R++;let $=[];for(let te=0;te<X;te++){let oe=v[F]-v[F-1];F++;let le=[];for(let ue=0;ue<oe;ue++){let me=this._vertexBuffer[S++],Le=this._vertexBuffer[S++];le.push(new s(me,Le))}le.length>0&&le.push(le[0]),$.push(le)}a[H]=$,E&&U++}break;case Ds.MULTIPOLYGON:{let X=E[U]-E[U-1];U++;let $=[];for(let te=0;te<X;te++){let oe=p[R]-p[R-1];R++;for(let le=0;le<oe;le++){let ue=v[F]-v[F-1];F++;let me=[];for(let Le=0;Le<ue;Le++){let ye=this._vertexBuffer[S++],we=this._vertexBuffer[S++];me.push(new s(ye,we))}me.length>0&&me.push(me[0]),$.push(me)}}a[H]=$}}return a}[Symbol.iterator](){return null}}function nV(h,a,u,p,v,E){return new Tfe(h,a,u,p,v,E)}class Tfe extends tV{_numGeometries;_geometryType;constructor(a,u,p,v,E,S){super(p,v,E,S),this._numGeometries=a,this._geometryType=u}geometryType(a){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function rV(h,a,u,p,v){return new Efe(h,a,u,p,v)}class Efe extends tV{_geometryTypes;constructor(a,u,p,v,E){super(u,p,v,E),this._geometryTypes=a}geometryType(a){return this._geometryTypes[a]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function Sfe(h,a,u,p,v){let E=al(h,u),S=null,R=null,F=null,U=null,H=null,X=null,$=null,te=null;if(xE(E,p,h,u)===Bs.CONST){let le=uB(h,u,E,!1);for(let ue=0;ue<a-1;ue++){let me=al(h,u);switch(me.physicalStreamType){case ha.LENGTH:switch(me.logicalStreamType.lengthType){case hc.GEOMETRIES:S=U0(h,u,me);break;case hc.PARTS:R=U0(h,u,me);break;case hc.RINGS:F=U0(h,u,me);break;case hc.TRIANGLES:$=U0(h,u,me)}break;case ha.OFFSET:switch(me.logicalStreamType.offsetType){case Yg.VERTEX:U=ll(h,u,me,!1);break;case Yg.INDEX:te=ll(h,u,me,!1)}break;case ha.DATA:Fh.VERTEX===me.logicalStreamType.dictionaryType?H=ll(h,u,me,!0):(X={numBits:me.numBits,coordinateShift:me.coordinateShift},H=ll(h,u,me,!1))}}return te!==null?S!=null||R!=null?nV(p,le,$,te,H,new l1(S,R,F)):nV(p,le,$,te,H):X===null?(function(ue,me,Le,ye,we){return new $U(ue,me,Vc.VEC_2,Le,ye,we)})(p,le,new l1(S,R,F),U,H):(function(ue,me,Le,ye,we,ke){return new $U(ue,me,Vc.MORTON,Le,ye,we,ke)})(p,le,new l1(S,R,F),U,H,X)}let oe=ll(h,u,E,!1);for(let le=0;le<a-1;le++){let ue=al(h,u);switch(ue.physicalStreamType){case ha.LENGTH:switch(ue.logicalStreamType.lengthType){case hc.GEOMETRIES:S=ll(h,u,ue,!1);break;case hc.PARTS:R=ll(h,u,ue,!1);break;case hc.RINGS:F=ll(h,u,ue,!1);break;case hc.TRIANGLES:$=U0(h,u,ue)}break;case ha.OFFSET:switch(ue.logicalStreamType.offsetType){case Yg.VERTEX:U=ll(h,u,ue,!1);break;case Yg.INDEX:te=ll(h,u,ue,!1)}break;case ha.DATA:Fh.VERTEX===ue.logicalStreamType.dictionaryType?H=ll(h,u,ue,!0):(X={numBits:ue.numBits,coordinateShift:ue.coordinateShift},H=ll(h,u,ue,!1))}}return te!==null&&R===null?rV(oe,$,te,H):(S!==null?(S=gB(oe,S,2),R!==null&&F!==null?(R=iV(oe,S,R,!1),F=(function(le,ue,me,Le){let ye=new Int32Array(me[me.length-1]+1),we=0;ye[0]=we;let ke=1,je=1,ht=0;for(let It=0;It<le.length;It++){let wt=le[It],Rt=ue[It+1]-ue[It];if(wt!==0&&wt!==3)for(let Qt=0;Qt<Rt;Qt++){let Gt=me[ke]-me[ke-1];ke++;for(let bt=0;bt<Gt;bt++)we=ye[je++]=we+Le[ht++]}else for(let Qt=0;Qt<Rt;Qt++)ye[je++]=++we,ke++}return ye})(oe,S,R,F)):R!==null&&(R=(function(le,ue,me){let Le=new Int32Array(ue[ue.length-1]+1),ye=0;Le[0]=ye;let we=1,ke=0;for(let je=0;je<le.length;je++){let ht=le[je],It=ue[je+1]-ue[je];if(ht===4||ht===1)for(let wt=0;wt<It;wt++)ye=Le[we++]=ye+me[ke++];else for(let wt=0;wt<It;wt++)Le[we++]=++ye}return Le})(oe,S,R))):R!==null&&F!==null?(R=gB(oe,R,1),F=iV(oe,R,F,!0)):R!==null&&(R=gB(oe,R,0)),te!==null?rV(oe,$,te,H,new l1(S,R,F)):X===null?(function(le,ue,me,Le){return new eV(Vc.VEC_2,le,ue,me,Le)})(oe,new l1(S,R,F),U,H):(function(le,ue,me,Le,ye){return new eV(Vc.MORTON,le,ue,me,Le,ye)})(oe,new l1(S,R,F),U,H,X))}function gB(h,a,u){let p=new Int32Array(h.length+1),v=0;p[0]=v;let E=0;for(let S=0;S<h.length;S++)v=p[S+1]=v+(h[S]>u?a[E++]:1);return p}function iV(h,a,u,p){let v=new Int32Array(a[a.length-1]+1),E=0;v[0]=E;let S=1,R=0;for(let F=0;F<h.length;F++){let U=h[F],H=a[F+1]-a[F];if(U===5||U===2||p&&(U===4||U===1))for(let X=0;X<H;X++)E=v[S++]=E+u[R++];else for(let X=0;X<H;X++)v[S++]=++E}return v}class Cfe extends s1{dataVector;constructor(a,u,p){super(a,u.getBuffer(),p),this.dataVector=u}getValueFromBuffer(a){return this.dataVector.get(a)}}class Mfe extends mE{getValueFromBuffer(a){return this.dataBuffer[a]}}class oV extends s1{constructor(a,u,p){super(a,BigInt64Array.of(u),p)}getValueFromBuffer(a){return this.dataBuffer[0]}}function Vx(h,a,u){return sV(h,Math.ceil(a/8),u)}function sV(h,a,u){let p=new Uint8Array(a),v=0;for(;v<a;){let E=h[u.increment()];if(E<=127){let S=E+3,R=h[u.increment()],F=v+S;p.fill(R,v,F),v=F}else{let S=256-E;for(let R=0;R<S;R++)p[v++]=h[u.increment()]}}return p}let Ife=new TextDecoder;function mB(h,a,u){return u-a>=12?Ife.decode(h.subarray(a,u)):(function(p,v,E){let S=\"\",R=v;for(;R<E;){let F=p[R],U,H,X,$=null,te=F>239?4:F>223?3:F>191?2:1;if(R+te>E)break;te===1?F<128&&($=F):te===2?(U=p[R+1],(192&U)==128&&($=(31&F)<<6|63&U,$<=127&&($=null))):te===3?(U=p[R+1],H=p[R+2],(192&U)==128&&(192&H)==128&&($=(15&F)<<12|(63&U)<<6|63&H,($<=2047||$>=55296&&$<=57343)&&($=null))):te===4&&(U=p[R+1],H=p[R+2],X=p[R+3],(192&U)==128&&(192&H)==128&&(192&X)==128&&($=(15&F)<<18|(63&U)<<12|(63&H)<<6|63&X,($<=65535||$>=1114112)&&($=null))),$===null?($=65533,te=1):$>65535&&($-=65536,S+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),S+=String.fromCharCode($),R+=te}return S})(h,a,u)}class _B extends s1{offsetBuffer;constructor(a,u,p,v){super(a,p,v),this.offsetBuffer=u}}class aV extends _B{textEncoder;constructor(a,u,p,v){super(a,u,p,v??u.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(a){return mB(this.dataBuffer,this.offsetBuffer[a],this.offsetBuffer[a+1])}}class c1 extends _B{indexBuffer;textEncoder;constructor(a,u,p,v,E){super(a,p,v,E??u.length),this.indexBuffer=u,this.indexBuffer=u,this.textEncoder=new TextEncoder}getValueFromBuffer(a){let u=this.indexBuffer[a];return mB(this.dataBuffer,this.offsetBuffer[u],this.offsetBuffer[u+1])}}class lV extends _B{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(a,u,p,v,E,S,R){super(a,p,v,R),this.indexBuffer=u,this.symbolOffsetBuffer=E,this.symbolTableBuffer=S,this.textEncoder=new TextEncoder}getValueFromBuffer(a){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(p,v,E){let S=[],R=new Array(v.length).fill(0);for(let F=1;F<v.length;F++)R[F]=R[F-1]+v[F-1];for(let F=0;F<E.length;F++)if(E[F]===255)S.push(E[++F]);else{let U=v[E[F]],H=R[E[F]];for(let X=0;X<U;X++)S.push(p[H+X])}return new Uint8Array(S)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));let u=this.indexBuffer[a];return mB(this.decodedDictionary,this.offsetBuffer[u],this.offsetBuffer[u+1])}offsetToLengthBuffer(a){let u=new Uint32Array(a.length-1),p=a[0];for(let v=1;v<a.length;v++){let E=a[v];u[v-1]=E-p,p=E}return u}}function Pfe(h,a,u,p,v,E){return u.type===\"scalarType\"?(function(S,R,F,U,H,X){let $=null,te=0;if(S===0)return null;if(X.nullable){let le=al(R,F);te=le.numValues;let ue=F.get(),me=Vx(R,te,F);F.set(ue+le.byteLength),$=new kh(me,le.numValues)}let oe=$??U;switch(H.physicalType){case 4:case 3:return(function(le,ue,me,Le,ye){let we=al(le,ue),ke=xE(we,ye,le,ue),je=Le.physicalType===3;if(ke===Bs.FLAT){let ht=Gx(ye)?hB(le,ue,we,je,ye):ll(le,ue,we,je);return new iB(me.name,ht,ye)}if(ke===Bs.SEQUENCE){let ht=WU(le,ue,we);return new sB(me.name,ht[0],ht[1],we.numRleValues)}{let ht=uB(le,ue,we,je);return new aB(me.name,ht,ye)}})(R,F,X,H,oe);case 9:return(function(le,ue,me,Le,ye){let we=null,ke=null,je=null,ht=null,It=null,wt=null,Rt=null,Qt=null;for(let Gt=0;Gt<Le;Gt++){let bt=al(ue,me);if(bt.byteLength!==0)switch(bt.physicalStreamType){case ha.PRESENT:{let _t=Vx(ue,bt.numValues,me);wt=new kh(_t,bt.numValues);break}case ha.OFFSET:ke=ye!=null||wt!=null?hB(ue,me,bt,!1,ye??wt):ll(ue,me,bt,!1);break;case ha.LENGTH:{let _t=U0(ue,me,bt);hc.DICTIONARY===bt.logicalStreamType.lengthType?we=_t:hc.SYMBOL===bt.logicalStreamType.lengthType?ht=_t:Rt=_t;break}case ha.DATA:{let _t=ue.subarray(me.get(),me.get()+bt.byteLength);me.add(bt.byteLength);let cn=bt.logicalStreamType.dictionaryType;Fh.FSST===cn?It=_t:Fh.SINGLE===cn||Fh.SHARED===cn?je=_t:Fh.NONE===cn&&(Qt=_t);break}}}return(function(Gt,bt,_t,cn,nn,An,an){return bt?new lV(Gt,_t,cn,nn,An,bt,an):null})(le,It,ke,we,je,ht,ye??wt)??(function(Gt,bt,_t,cn,nn){return bt?nn?new c1(Gt,_t,cn,bt,nn):new c1(Gt,_t,cn,bt):null})(le,je,ke,we,ye??wt)??(function(Gt,bt,_t,cn,nn){if(!bt||!_t)return null;if(cn)return nn?new c1(Gt,cn,bt,_t,nn):new c1(Gt,cn,bt,_t);if(nn&&nn.size()!==bt.length-1){let An=new Int32Array(nn.size()),an=0;for(let En=0;En<nn.size();En++)An[En]=nn.get(En)?an++:0;return new c1(Gt,An,bt,_t,nn)}return nn?new aV(Gt,bt,_t,nn):new aV(Gt,bt,_t)})(le,Rt,Qt,ke,ye??wt)})(X.name,R,F,X.nullable?S-1:S,$);case 0:return(function(le,ue,me,Le,ye){let we=al(le,ue),ke=we.numValues,je=ue.get(),ht=Gx(ye)?(function(wt,Rt,Qt,Gt){let bt=sV(wt,Math.ceil(Rt/8),Qt),_t=new kh(bt,Rt),cn=Gt.size(),nn=new kh(new Uint8Array(cn),cn),An=0;for(let an=0;an<Gt.size();an++){let En=!!Gt.get(an)&&_t.get(An++);nn.set(an,En)}return nn.getBuffer()})(le,ke,ue,ye):Vx(le,ke,ue);ue.set(je+we.byteLength);let It=new kh(ht,ke);return new Cfe(me.name,It,ye)})(R,F,X,0,oe);case 6:case 5:return(function(le,ue,me,Le,ye){let we=al(le,ue),ke=xE(we,Le,le,ue),je=ye.physicalType===5;if(ke===Bs.FLAT){let ht=Gx(Le)?(function(It,wt,Rt,Qt,Gt){return(function(bt,_t,cn,nn){switch(_t.logicalLevelTechnique1){case yr.DELTA:return _t.logicalLevelTechnique2===yr.RLE&&(bt=VU(bt,_t.runs,_t.numRleValues)),(function(An,an){let En=new BigInt64Array(An.size()),Dr=0;An.get(0)?(En[0]=An.get(0)?an[0]>>1n^-(1n&an[0]):0n,Dr=1):En[0]=0n;let pr=1;for(;pr!=En.length;++pr)En[pr]=An.get(pr)?En[pr-1]+(an[Dr]>>1n^-(1n&an[Dr++])):En[pr-1];return En})(nn,bt);case yr.RLE:return(function(An,an,En,Dr){let pr=an;return En?(function(no,da,ns){let ro=new BigInt64Array(no.size()),Zi=0;for(let ii=0;ii<ns;ii++){let To=Number(da[ii]),Oo=da[ii+ns];Oo=Oo>>1n^-(1n&Oo);for(let ki=Zi;ki<Zi+To;ki++)no.get(ki)?ro[ki]=Oo:(ro[ki]=0n,Zi++);Zi+=To}return ro})(Dr,An,pr.runs):(function(no,da,ns){let ro=new BigInt64Array(no.size()),Zi=0;for(let ii=0;ii<ns;ii++){let To=Number(da[ii]),Oo=da[ii+ns];for(let ki=Zi;ki<Zi+To;ki++)no.get(ki)?ro[ki]=Oo:(ro[ki]=0n,Zi++);Zi+=To}return ro})(Dr,An,pr.runs)})(bt,_t,cn,nn);case yr.NONE:return bt=cn?(function(An,an){let En=new BigInt64Array(An.size()),Dr=0,pr=0;for(;pr!=En.length;++pr)if(An.get(pr)){let no=an[Dr++];En[pr]=no>>1n^-(1n&no)}else En[pr]=0n;return En})(nn,bt):(function(An,an){let En=new BigInt64Array(An.size()),Dr=0,pr=0;for(;pr!=En.length;++pr)En[pr]=An.get(pr)?an[Dr++]:0n;return En})(nn,bt),bt;default:throw new Error(\"The specified Logical level technique is not supported\")}})(_E(It,wt,Rt.numValues),Rt,Qt,Gt)})(le,ue,we,je,Le):XU(le,ue,we,je);return new ZU(me.name,ht,Le)}if(ke===Bs.SEQUENCE){let ht=jU(le,ue,we);return new qU(me.name,ht[0],ht[1],we.numRleValues)}{let ht=YU(le,ue,we,je);return new oV(me.name,ht,Le)}})(R,F,X,oe,H);case 7:return(function(le,ue,me,Le){let ye=al(le,ue),we=Gx(Le)?(function(ke,je,ht,It){let wt=je.get(),Rt=wt+It*Float32Array.BYTES_PER_ELEMENT,Qt=new Uint8Array(ke.subarray(wt,Rt)).buffer,Gt=new Float32Array(Qt);je.set(Rt);let bt=ht.size(),_t=new Float32Array(bt),cn=0;for(let nn=0;nn<bt;nn++)_t[nn]=ht.get(nn)?Gt[cn++]:0;return _t})(le,ue,Le,ye.numValues):(function(ke,je,ht){let It=je.get(),wt=It+ht*Float32Array.BYTES_PER_ELEMENT,Rt=new Uint8Array(ke.subarray(It,wt)).buffer,Qt=new Float32Array(Rt);return je.set(wt),Qt})(le,ue,ye.numValues);return new Mfe(me.name,we,Le)})(R,F,X,oe);case 8:return(function(le,ue,me,Le){let ye=al(le,ue),we=Gx(Le)?(function(ke,je,ht,It){let wt=je.get(),Rt=wt+It*Float64Array.BYTES_PER_ELEMENT,Qt=new Uint8Array(ke.subarray(wt,Rt)).buffer,Gt=new Float64Array(Qt);je.set(Rt);let bt=ht.size(),_t=new Float64Array(bt),cn=0;for(let nn=0;nn<bt;nn++)_t[nn]=ht.get(nn)?Gt[cn++]:0;return _t})(le,ue,Le,ye.numValues):(function(ke,je,ht){let It=je.get(),wt=It+ht*Float64Array.BYTES_PER_ELEMENT,Rt=new Uint8Array(ke.subarray(It,wt)).buffer,Qt=new Float64Array(Rt);return je.set(wt),Qt})(le,ue,ye.numValues);return new oB(me.name,we,Le)})(R,F,X,oe);default:throw new Error(`The specified data type for the field is currently not supported: ${H}`)}})(p,h,a,v,u.scalarType,u):p!=1?null:(function(S,R,F,U){let H=null,X=null,$=null,te=null,oe=!1;for(;!oe;){let Le=al(S,R);switch(Le.physicalStreamType){case ha.LENGTH:hc.DICTIONARY===Le.logicalStreamType.lengthType?H=U0(S,R,Le):$=U0(S,R,Le);break;case ha.DATA:Fh.SINGLE===Le.logicalStreamType.dictionaryType||Fh.SHARED===Le.logicalStreamType.dictionaryType?(X=S.subarray(R.get(),R.get()+Le.byteLength),oe=!0):te=S.subarray(R.get(),R.get()+Le.byteLength),R.add(Le.byteLength)}}let le=F.complexType.children,ue=[],me=0;for(let Le of le){let ye=Ks(S,R,1)[0];if(ye==0)continue;let we=`${F.name}${Le.name===\"default\"?\"\":\":\"+Le.name}`;if(ye!==2||Le.type!==\"scalarField\"||Le.scalarField.physicalType!==9)throw new Error(\"Currently only optional string fields are implemented for a struct.\");let ke=al(S,R),je=Vx(S,ke.numValues,R),ht=al(S,R),It=ht.decompressedCount!==U?hB(S,R,ht,!1,new kh(je,ke.numValues)):ll(S,R,ht,!1);ue[me++]=te?new lV(we,It,H,X,$,te,new kh(je,ke.numValues)):new c1(we,It,H,X,new kh(je,ke.numValues))}return ue})(h,a,u,v)}function Gx(h){return h instanceof kh}function Rfe(h){if(h.name===\"id\")return!1;if(h.type===\"scalarType\"){let a=h.scalarType;if(a.type===\"physicalType\")switch(a.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(a.type===\"logicalType\")return!1}else if(h.type===\"complexType\"){let a=h.complexType;if(a.type===\"physicalType\")switch(a.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn(\"Unexpected column type in hasStreamCount\",h),!1}let Bfe=new TextDecoder;function cV(h,a){let u=Ks(h,a,1)[0];if(u===0)return\"\";let p=a.get(),v=h.subarray(p,p+u);return a.add(u),Bfe.decode(v)}function uV(h,a){let u=Ks(h,a,1)[0]>>>0,p=!!(4&u),v=!!(2&u),E=Ks(h,a,1)[0]>>>0,S={};if(1&u&&(S.nullable=!0),v){let R={};if(p?(R.type=\"logicalType\",R.logicalType=E):(R.type=\"physicalType\",R.physicalType=E),8&u){let F=Ks(h,a,1)[0]>>>0;R.children=new Array(F);for(let U=0;U<F;U++)R.children[U]=uV(h,a)}S.type=\"complexField\",S.complexField=R}else{let R={};p?(R.type=\"logicalType\",R.logicalType=E):(R.type=\"physicalType\",R.physicalType=E),S.type=\"scalarField\",S.scalarField=R}return S}function Dfe(h,a){let u=Ks(h,a,1)[0]>>>0,p=(function(v){switch(v){case 0:case 1:case 2:case 3:{let E={};E.nullable=!!(1&v),E.columnScope=0;let S={};return S.physicalType=v>1?6:4,S.type=\"physicalType\",E.scalarType=S,E.type=\"scalarType\",E}case 4:{let E={nullable:!1,columnScope:0},S={type:\"physicalType\",physicalType:0};return E.type=\"complexType\",E.complexType=S,E}case 30:{let E={nullable:!1,columnScope:0},S={type:\"physicalType\",physicalType:1};return E.type=\"complexType\",E.complexType=S,E}default:return(function(E){let S=null;switch(E){case 10:case 11:S=0;break;case 12:case 13:S=1;break;case 14:case 15:S=2;break;case 16:case 17:S=3;break;case 18:case 19:S=4;break;case 20:case 21:S=5;break;case 22:case 23:S=6;break;case 24:case 25:S=7;break;case 26:case 27:S=8;break;case 28:case 29:S=9;break;default:return null}let R={};R.nullable=!!(1&E),R.columnScope=0;let F={type:\"physicalType\"};return F.physicalType=S,R.type=\"scalarType\",R.scalarType=F,R})(v)}})(u);if(!p)throw new Error(`Unsupported column type code: ${u}`);if((function(v){return v>=10})(u)?p.name=cV(h,a):u>=0&&u<=3?p.name=\"id\":u===4&&(p.name=\"geometry\"),(function(v){return v===30})(u)){let v=Ks(h,a,1)[0]>>>0,E=p.complexType;E.children=new Array(v);for(let S=0;S<v;S++)E.children[S]=uV(h,a)}return p}function Lfe(h,a){let u={featureTables:[]},p={};p.name=cV(h,a);let v=Ks(h,a,1)[0]>>>0,E=Ks(h,a,1)[0]>>>0;p.columns=new Array(E);for(let S=0;S<E;S++)p.columns[S]=Dfe(h,a);return u.featureTables.push(p),[u,v]}function Ofe(h,a,u,p,v,E,S=!1){let R=a.scalarType.physicalType,F=xE(v,E,h,u);if(R===4)switch(F){case Bs.FLAT:{let U=ll(h,u,v,!1);return new iB(p,U,E)}case Bs.SEQUENCE:{let U=WU(h,u,v);return new sB(p,U[0],U[1],v.numRleValues)}case Bs.CONST:{let U=uB(h,u,v,!1);return new aB(p,U,E)}}else switch(F){case Bs.FLAT:{if(S){let H=(function(X,$,te,oe){let le=(function(ue,me,Le){let ye=new Float64Array(me);for(let we=0;we<me;we++)ye[we]=vfe(ue,Le);return ye})(X,te.numValues,$);return(function(ue,me,Le){switch(me.logicalLevelTechnique1){case yr.DELTA:return me.logicalLevelTechnique2===yr.RLE&&(ue=GU(ue,me.runs,me.numRleValues)),(function(ye){ye[0]=ye[0]%2==1?(ye[0]+1)/-2:ye[0]/2;let we=ye.length/4*4,ke=1;if(we>=4)for(;ke<we-4;ke+=4){let je=ye[ke],ht=ye[ke+1],It=ye[ke+2],wt=ye[ke+3];ye[ke]=(je%2==1?(je+1)/-2:je/2)+ye[ke-1],ye[ke+1]=(ht%2==1?(ht+1)/-2:ht/2)+ye[ke],ye[ke+2]=(It%2==1?(It+1)/-2:It/2)+ye[ke+1],ye[ke+3]=(wt%2==1?(wt+1)/-2:wt/2)+ye[ke+2]}for(;ke!=ye.length;++ke)ye[ke]=(ye[ke]%2==1?(ye[ke]+1)/-2:ye[ke]/2)+ye[ke-1]})(ue),ue;case yr.RLE:return(function(ye,we,ke){return ke?(function(je,ht,It){let wt=new Float64Array(It),Rt=0;for(let Qt=0;Qt<ht;Qt++){let Gt=je[Qt],bt=je[Qt+ht];bt=bt%2==1?(bt+1)/-2:bt/2,wt.fill(bt,Rt,Rt+Gt),Rt+=Gt}return wt})(ye,we.runs,we.numRleValues):GU(ye,we.runs,we.numRleValues)})(ue,me,Le);case yr.NONE:return ue;default:throw new Error(`The specified Logical level technique is not supported: ${me.logicalLevelTechnique1}`)}})(le,te,oe)})(h,u,v,!1);return new oB(p,H,E)}let U=XU(h,u,v,!1);return new ZU(p,U,E)}case Bs.SEQUENCE:{let U=jU(h,u,v);return new qU(p,U[0],U[1],v.numRleValues)}case Bs.CONST:{let U=YU(h,u,v,!1);return new oV(p,U,E)}}throw new Error(\"Vector type not supported for id column.\")}class Ffe{constructor(a,u){var p;switch(this._featureData=a,this.properties=this._featureData.properties||{},(p=this._featureData.geometry)===null||p===void 0?void 0:p.type){case Ds.POINT:case Ds.MULTIPOINT:this.type=1;break;case Ds.LINESTRING:case Ds.MULTILINESTRING:this.type=2;break;case Ds.POLYGON:case Ds.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=u,this.id=Number(this._featureData.id)}loadGeometry(){let a=[];for(let u of this._featureData.geometry.coordinates){let p=[];for(let v of u)p.push(new s(v.x,v.y));a.push(p)}return a}}class kfe{constructor(a){this.features=[],this.featureTable=a,this.name=a.name,this.extent=a.extent,this.version=2,this.features=a.getFeatures(),this.length=this.features.length}feature(a){return new Ffe(this.features[a],this.extent)}}class hV{constructor(a){this.layers={};let u=(function(p,v,E=!0){let S=new xfe(0),R=[];for(;S.get()<p.length;){let F=Ks(p,S,1)[0]>>>0,U=S.get()+F;if(U>p.length)throw new Error(`Block overruns tile: ${U} > ${p.length}`);if(Ks(p,S,1)[0]>>>0!=1){S.set(U);continue}let H=Lfe(p,S),X=H[1],$=H[0].featureTables[0],te=null,oe=null,le=[],ue=0;for(let Le of $.columns){let ye=Le.name;if(ye===\"id\"){let we=null;if(Le.nullable){let je=al(p,S),ht=S.get(),It=Vx(p,je.numValues,S);S.set(ht+je.byteLength),we=new kh(It,je.numValues)}let ke=al(p,S);ue=ke.decompressedCount,te=Ofe(p,Le,S,ye,ke,we??ue,E)}else if(ye===\"geometry\"){let we=Ks(p,S,1)[0];if(ue===0){let ke=S.get();ue=al(p,S).decompressedCount,S.set(ke)}oe=Sfe(p,we,S,ue)}else{let we=Rfe(Le)?Ks(p,S,1)[0]:1;if(we===0&&Le.type===\"scalarType\")continue;let ke=Pfe(p,S,Le,we,ue);if(ke)if(Array.isArray(ke))for(let je of ke)le.push(je);else le.push(ke)}}let me=new yfe($.name,oe,te,le,X);R.push(me),S.set(U)}return R})(new Uint8Array(a));this.layers=u.reduce(((p,v)=>Object.assign(Object.assign({},p),{[v.name]:new kfe(v)})),{})}}class Nfe{constructor(a,u){this.feature=a,this.type=a.type,this.properties=a.tags?a.tags:{},this.extent=u,\"id\"in a&&(typeof a.id==\"string\"?this.id=parseInt(a.id,10):typeof a.id!=\"number\"||isNaN(a.id)||(this.id=a.id))}loadGeometry(){let a=[],u=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(let p of u){let v=[];for(let E of p)v.push(new s(E[0],E[1]));a.push(v)}return a}}let Hx=\"_geojsonTileLayer\";function zfe(h,a){a.writeVarintField(15,h.version||1),a.writeStringField(1,h.name||\"\"),a.writeVarintField(5,h.extent||4096);let u={keys:[],values:[],keycache:{},valuecache:{}};for(let E=0;E<h.length;E++)u.feature=h.feature(E),a.writeMessage(2,Ufe,u);let p=u.keys;for(let E of p)a.writeStringField(3,E);let v=u.values;for(let E of v)a.writeMessage(4,Hfe,E)}function Ufe(h,a){if(!h.feature)return;let u=h.feature;u.id!==void 0&&a.writeVarintField(1,u.id),a.writeMessage(2,Vfe,h),a.writeVarintField(3,u.type),a.writeMessage(4,Gfe,u)}function Vfe(h,a){for(let u in h.feature?.properties){let p=h.feature.properties[u],v=h.keycache[u];if(p==null)continue;v===void 0&&(h.keys.push(u),v=h.keys.length-1,h.keycache[u]=v),a.writeVarint(v),typeof p!=\"string\"&&typeof p!=\"boolean\"&&typeof p!=\"number\"&&(p=JSON.stringify(p));let E=typeof p+\":\"+p,S=h.valuecache[E];S===void 0&&(h.values.push(p),S=h.values.length-1,h.valuecache[E]=S),a.writeVarint(S)}}function yB(h,a){return(a<<3)+(7&h)}function fV(h){return h<<1^h>>31}function Gfe(h,a){let u=h.loadGeometry(),p=h.type,v=0,E=0;for(let S of u){let R=1;p===1&&(R=S.length),a.writeVarint(yB(1,R));let F=p===3?S.length-1:S.length;for(let U=0;U<F;U++){U===1&&p!==1&&a.writeVarint(yB(2,F-1));let H=S[U].x-v,X=S[U].y-E;a.writeVarint(fV(H)),a.writeVarint(fV(X)),v+=H,E+=X}h.type===3&&a.writeVarint(yB(7,1))}}function Hfe(h,a){let u=typeof h;u===\"string\"?a.writeStringField(1,h):u===\"boolean\"?a.writeBooleanField(7,h):u===\"number\"&&(h%1!=0?a.writeDoubleField(3,h):h<0?a.writeSVarintField(6,h):a.writeVarintField(5,h))}class dV{constructor(a,u){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Sf(rn,16,0),this.grid3D=new Sf(rn,16,0),this.featureIndexArray=new de,this.promoteId=u}insert(a,u,p,v,E,S){let R=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,v,E);let F=S?this.grid3D:this.grid;for(let U=0;U<u.length;U++){let H=u[U],X=[1/0,1/0,-1/0,-1/0];for(let $=0;$<H.length;$++){let te=H[$];X[0]=Math.min(X[0],te.x),X[1]=Math.min(X[1],te.y),X[2]=Math.max(X[2],te.x),X[3]=Math.max(X[3],te.y)}X[0]<rn&&X[1]<rn&&X[2]>=0&&X[3]>=0&&F.insert(R,X[0],X[1],X[2],X[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!==\"mlt\"?new J7(new fE(this.rawTileData)).layers:new hV(this.rawTileData).layers,this.sourceLayerCoder=new OU(this.vtLayers?Object.keys(this.vtLayers).sort():[Hx])),this.vtLayers}query(a,u,p,v){this.loadVTLayers();let E=a.params,S=rn/a.tileSize/a.scale,R=Tu(E.filter,E.globalState),F=a.queryGeometry,U=a.queryPadding*S,H=Xg.fromPoints(F),X=this.grid.query(H.minX-U,H.minY-U,H.maxX+U,H.maxY+U),$=Xg.fromPoints(a.cameraQueryGeometry).expandBy(U),te=this.grid3D.query($.minX,$.minY,$.maxX,$.maxY,((ue,me,Le,ye)=>(function(we,ke,je,ht,It){for(let Rt of we)if(ke<=Rt.x&&je<=Rt.y&&ht>=Rt.x&&It>=Rt.y)return!0;let wt=[new s(ke,je),new s(ke,It),new s(ht,It),new s(ht,je)];if(we.length>2){for(let Rt of wt)if(K_(we,Rt))return!0}for(let Rt=0;Rt<we.length-1;Rt++)if(jue(we[Rt],we[Rt+1],wt))return!0;return!1})(a.cameraQueryGeometry,ue-U,me-U,Le+U,ye+U)));for(let ue of te)X.push(ue);X.sort(Wfe);let oe={},le;for(let ue=0;ue<X.length;ue++){let me=X[ue];if(me===le)continue;le=me;let Le=this.featureIndexArray.get(me),ye=null;this.loadMatchingFeature(oe,Le.bucketIndex,Le.sourceLayerIndex,Le.featureIndex,R,E.layers,E.availableImages,u,p,v,((we,ke,je)=>(ye||(ye=dn(we)),ke.queryIntersectsFeature({queryGeometry:F,feature:we,featureState:je,geometry:ye,zoom:this.z,transform:a.transform,pixelsToTileUnits:S,pixelPosMatrix:a.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:a.getElevation}))))}return oe}loadMatchingFeature(a,u,p,v,E,S,R,F,U,H,X){let $=this.bucketLayerIDs[u];if(S&&!$.some((ue=>S.has(ue))))return;let te=this.sourceLayerCoder.decode(p),oe=this.vtLayers[te].feature(v);if(E.needGeometry){let ue=Vn(oe,!0);if(!E.filter(new ci(this.tileID.overscaledZ),ue,this.tileID.canonical))return}else if(!E.filter(new ci(this.tileID.overscaledZ),oe))return;let le=this.getId(oe,te);for(let ue=0;ue<$.length;ue++){let me=$[ue];if(S&&!S.has(me))continue;let Le=F[me];if(!Le)continue;let ye={};le&&H&&(ye=H.getState(Le.sourceLayer||Hx,le));let we=Fn({},U[me]);we.paint=pV(we.paint,Le.paint,oe,ye,R),we.layout=pV(we.layout,Le.layout,oe,ye,R);let ke=!X||X(oe,Le,ye);if(!ke)continue;let je=new FU(oe,this.z,this.x,this.y,le);je.layer=we;let ht=a[me];ht===void 0&&(ht=a[me]=[]),ht.push({featureIndex:v,feature:je,intersectionZ:ke})}}lookupSymbolFeatures(a,u,p,v,E,S,R,F){let U={};this.loadVTLayers();let H=Tu(E.filterSpec,E.globalState);for(let X of a)this.loadMatchingFeature(U,p,v,X,H,S,R,F,u);return U}hasLayer(a){for(let u of this.bucketLayerIDs)for(let p of u)if(a===p)return!0;return!1}getId(a,u){var p;let v=a.id;return this.promoteId&&(v=a.properties[typeof this.promoteId==\"string\"?this.promoteId:this.promoteId[u]],typeof v==\"boolean\"&&(v=Number(v)),v===void 0&&(!((p=a.properties)===null||p===void 0)&&p.cluster)&&this.promoteId&&(v=Number(a.properties.cluster_id))),v}}function pV(h,a,u,p,v){return nr(h,((E,S)=>{let R=a instanceof Wd?a.get(S):null;return R&&R.evaluate?R.evaluate(u,p,v):R}))}function Wfe(h,a){return a-h}function AV(h,a,u,p,v){let E=[];for(let S=0;S<h.length;S++){let R=h[S],F;for(let U=0;U<R.length-1;U++){let H=R[U],X=R[U+1];H.x<a&&X.x<a||(H.x<a?H=new s(a,H.y+(a-H.x)/(X.x-H.x)*(X.y-H.y))._round():X.x<a&&(X=new s(a,H.y+(a-H.x)/(X.x-H.x)*(X.y-H.y))._round()),H.y<u&&X.y<u||(H.y<u?H=new s(H.x+(u-H.y)/(X.y-H.y)*(X.x-H.x),u)._round():X.y<u&&(X=new s(H.x+(u-H.y)/(X.y-H.y)*(X.x-H.x),u)._round()),H.x>=p&&X.x>=p||(H.x>=p?H=new s(p,H.y+(p-H.x)/(X.x-H.x)*(X.y-H.y))._round():X.x>=p&&(X=new s(p,H.y+(p-H.x)/(X.x-H.x)*(X.y-H.y))._round()),H.y>=v&&X.y>=v||(H.y>=v?H=new s(H.x+(v-H.y)/(X.y-H.y)*(X.x-H.x),v)._round():X.y>=v&&(X=new s(H.x+(v-H.y)/(X.y-H.y)*(X.x-H.x),v)._round()),F&&H.equals(F[F.length-1])||(F=[H],E.push(F)),F.push(X)))))}}return E}function gV(h,a,u,p,v){switch(a){case 1:return(function(E,S,R,F){let U=[];for(let H of E)for(let X of H){let $=F===0?X.x:X.y;$>=S&&$<=R&&U.push([X])}return U})(h,u,p,v);case 2:return mV(h,u,p,v,!1);case 3:return mV(h,u,p,v,!0)}return[]}function jfe(h,a,u,p,v){let E=p===0?Xfe:Yfe,S=[],R=[];for(let H=0;H<h.length-1;H++){let X=h[H],$=h[H+1],te=p===0?X.x:X.y,oe=p===0?$.x:$.y,le=!1;te<a?oe>a&&S.push(E(X,$,a)):te>u?oe<u&&S.push(E(X,$,u)):S.push(X),oe<a&&te>=a&&(S.push(E(X,$,a)),le=!0),oe>u&&te<=u&&(S.push(E(X,$,u)),le=!0),!v&&le&&(R.push(S),S=[])}let F=h.length-1,U=p===0?h[F].x:h[F].y;return U>=a&&U<=u&&S.push(h[F]),v&&S.length>0&&!S[0].equals(S[S.length-1])&&S.push(new s(S[0].x,S[0].y)),S.length>0&&R.push(S),R}function mV(h,a,u,p,v){let E=[];for(let S of h){let R=jfe(S,a,u,p,v);R.length>0&&E.push(...R)}return E}function Xfe(h,a,u){return new s(u,h.y+(u-h.x)/(a.x-h.x)*(a.y-h.y))}function Yfe(h,a,u){return new s(h.x+(u-h.y)/(a.y-h.y)*(a.x-h.x),u)}un(\"FeatureIndex\",dV,{omit:[\"rawTileData\",\"sourceLayerCoder\"]});class V0 extends s{constructor(a,u,p,v){super(a,u),this.angle=p,v!==void 0&&(this.segment=v)}clone(){return new V0(this.x,this.y,this.angle,this.segment)}}function _V(h,a,u,p,v){if(a.segment===void 0||u===0)return!0;let E=a,S=a.segment+1,R=0;for(;R>-u/2;){if(S--,S<0)return!1;R-=h[S].dist(E),E=h[S]}R+=h[S].dist(h[S+1]),S++;let F=[],U=0;for(;R<u/2;){let H=h[S],X=h[S+1];if(!X)return!1;let $=h[S-1].angleTo(H)-H.angleTo(X);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),F.push({distance:R,angleDelta:$}),U+=$;R-F[0].distance>p;)U-=F.shift().angleDelta;if(U>v)return!1;S++,R+=H.dist(X)}return!0}function yV(h){let a=0;for(let u=0;u<h.length-1;u++)a+=h[u].dist(h[u+1]);return a}function xV(h,a,u){return h?.6*a*u:0}function vV(h,a){return Math.max(h?h.right-h.left:0,a?a.right-a.left:0)}function Zfe(h,a,u,p,v,E){let S=xV(u,v,E),R=vV(u,p)*E,F=0,U=yV(h)/2;for(let H=0;H<h.length-1;H++){let X=h[H],$=h[H+1],te=X.dist($);if(F+te>U){let oe=(U-F)/te,le=ji.number(X.x,$.x,oe),ue=ji.number(X.y,$.y,oe),me=new V0(le,ue,$.angleTo(X),H);return me._round(),!S||_V(h,me,R,S,a)?me:void 0}F+=te}}function qfe(h,a,u,p,v,E,S,R,F){let U=xV(p,E,S),H=vV(p,v),X=H*S,$=h[0].x===0||h[0].x===F||h[0].y===0||h[0].y===F;return a-X<a/4&&(a=X+a/4),bV(h,$?a/2*R%a:(H/2+2*E)*S*R%a,a,U,u,X,$,!1,F)}function bV(h,a,u,p,v,E,S,R,F){let U=E/2,H=yV(h),X=0,$=a-u,te=[];for(let oe=0;oe<h.length-1;oe++){let le=h[oe],ue=h[oe+1],me=le.dist(ue),Le=ue.angleTo(le);for(;$+u<X+me;){$+=u;let ye=($-X)/me,we=ji.number(le.x,ue.x,ye),ke=ji.number(le.y,ue.y,ye);if(we>=0&&we<F&&ke>=0&&ke<F&&$-U>=0&&$+U<=H){let je=new V0(we,ke,Le,oe);je._round(),p&&!_V(h,je,E,p,v)||te.push(je)}}X+=me}return R||te.length||S||(te=bV(h,X/2,u,p,v,E,S,!0,F)),te}function wV(h,a,u,p){let v=[],E=h.image,S=E.pixelRatio,R=E.paddedRect.w-2,F=E.paddedRect.h-2,U={x1:h.left,y1:h.top,x2:h.right,y2:h.bottom},H=E.stretchX||[[0,R]],X=E.stretchY||[[0,F]],$=(_t,cn)=>_t+cn[1]-cn[0],te=H.reduce($,0),oe=X.reduce($,0),le=R-te,ue=F-oe,me=0,Le=te,ye=0,we=oe,ke=0,je=le,ht=0,It=ue;if(E.content&&p){let _t=E.content,cn=_t[2]-_t[0],nn=_t[3]-_t[1];(E.textFitWidth||E.textFitHeight)&&(U=_U(h)),me=TE(H,0,_t[0]),ye=TE(X,0,_t[1]),Le=TE(H,_t[0],_t[2]),we=TE(X,_t[1],_t[3]),ke=_t[0]-me,ht=_t[1]-ye,je=cn-Le,It=nn-we}let wt=U.x1,Rt=U.y1,Qt=U.x2-wt,Gt=U.y2-Rt,bt=(_t,cn,nn,An)=>{let an=EE(_t.stretch-me,Le,Qt,wt),En=SE(_t.fixed-ke,je,_t.stretch,te),Dr=EE(cn.stretch-ye,we,Gt,Rt),pr=SE(cn.fixed-ht,It,cn.stretch,oe),no=EE(nn.stretch-me,Le,Qt,wt),da=SE(nn.fixed-ke,je,nn.stretch,te),ns=EE(An.stretch-ye,we,Gt,Rt),ro=SE(An.fixed-ht,It,An.stretch,oe),Zi=new s(an,Dr),ii=new s(no,Dr),To=new s(no,ns),Oo=new s(an,ns),ki=new s(En/S,pr/S),Ul=new s(da/S,ro/S),pa=a*Math.PI/180;if(pa){let Ls=Math.sin(pa),Ao=Math.cos(pa),rs=[Ao,-Ls,Ls,Ao];Zi._matMult(rs),ii._matMult(rs),Oo._matMult(rs),To._matMult(rs)}let Vl=_t.stretch+_t.fixed,Ru=cn.stretch+cn.fixed;return{tl:Zi,tr:ii,bl:Oo,br:To,tex:{x:E.paddedRect.x+1+Vl,y:E.paddedRect.y+1+Ru,w:nn.stretch+nn.fixed-Vl,h:An.stretch+An.fixed-Ru},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ki,pixelOffsetBR:Ul,minFontScaleX:je/S/Qt,minFontScaleY:It/S/Gt,isSDF:u}};if(p&&(E.stretchX||E.stretchY)){let _t=TV(H,le,te),cn=TV(X,ue,oe);for(let nn=0;nn<_t.length-1;nn++){let An=_t[nn],an=_t[nn+1];for(let En=0;En<cn.length-1;En++)v.push(bt(An,cn[En],an,cn[En+1]))}}else v.push(bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:R+1},{fixed:0,stretch:F+1}));return v}function TE(h,a,u){let p=0;for(let v of h)p+=Math.max(a,Math.min(u,v[1]))-Math.max(a,Math.min(u,v[0]));return p}function TV(h,a,u){let p=[{fixed:-1,stretch:0}];for(let[v,E]of h){let S=p[p.length-1];p.push({fixed:v-S.stretch,stretch:S.stretch}),p.push({fixed:v-S.stretch,stretch:S.stretch+(E-v)})}return p.push({fixed:a+1,stretch:u}),p}function EE(h,a,u,p){return h/a*u+p}function SE(h,a,u,p){return h-a*u/p}un(\"Anchor\",V0);class CE{constructor(a,u,p,v,E,S,R,F,U,H){var X;if(this.boxStartIndex=a.length,U){let $=S.top,te=S.bottom,oe=S.collisionPadding;oe&&($-=oe[1],te+=oe[3]);let le=te-$;le>0&&(le=Math.max(10,le),this.circleDiameter=le)}else{let $=!((X=S.image)===null||X===void 0)&&X.content&&(S.image.textFitWidth||S.image.textFitHeight)?_U(S):{x1:S.left,y1:S.top,x2:S.right,y2:S.bottom};$.y1=$.y1*R-F[0],$.y2=$.y2*R+F[2],$.x1=$.x1*R-F[3],$.x2=$.x2*R+F[1];let te=S.collisionPadding;if(te&&($.x1-=te[0]*R,$.y1-=te[1]*R,$.x2+=te[2]*R,$.y2+=te[3]*R),H){let oe=new s($.x1,$.y1),le=new s($.x2,$.y1),ue=new s($.x1,$.y2),me=new s($.x2,$.y2),Le=H*Math.PI/180;oe._rotate(Le),le._rotate(Le),ue._rotate(Le),me._rotate(Le),$.x1=Math.min(oe.x,le.x,ue.x,me.x),$.x2=Math.max(oe.x,le.x,ue.x,me.x),$.y1=Math.min(oe.y,le.y,ue.y,me.y),$.y2=Math.max(oe.y,le.y,ue.y,me.y)}a.emplaceBack(u.x,u.y,$.x1,$.y1,$.x2,$.y2,p,v,E)}this.boxEndIndex=a.length}}class Qfe{constructor(a=[],u=(p,v)=>p<v?-1:p>v?1:0){if(this.data=a,this.length=this.data.length,this.compare=u,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;let a=this.data[0],u=this.data.pop();return--this.length>0&&(this.data[0]=u,this._down(0)),a}peek(){return this.data[0]}_up(a){let{data:u,compare:p}=this,v=u[a];for(;a>0;){let E=a-1>>1,S=u[E];if(p(v,S)>=0)break;u[a]=S,a=E}u[a]=v}_down(a){let{data:u,compare:p}=this,v=this.length>>1,E=u[a];for(;a<v;){let S=1+(a<<1),R=S+1;if(R<this.length&&p(u[R],u[S])<0&&(S=R),p(u[S],E)>=0)break;u[a]=u[S],a=S}u[a]=E}}function Kfe(h,a=1,u=!1){let p=Xg.fromPoints(h[0]),v=Math.min(p.width(),p.height()),E=v/2,S=new Qfe([],Jfe),{minX:R,minY:F,maxX:U,maxY:H}=p;if(v===0)return new s(R,F);for(let te=R;te<U;te+=v)for(let oe=F;oe<H;oe+=v)S.push(new u1(te+E,oe+E,E,h));let X=(function(te){let oe=0,le=0,ue=0,me=te[0];for(let Le=0,ye=me.length,we=ye-1;Le<ye;we=Le++){let ke=me[Le],je=me[we],ht=ke.x*je.y-je.x*ke.y;le+=(ke.x+je.x)*ht,ue+=(ke.y+je.y)*ht,oe+=3*ht}return new u1(le/oe,ue/oe,0,te)})(h),$=S.length;for(;S.length;){let te=S.pop();(te.d>X.d||!X.d)&&(X=te,u&&console.log(\"found best %d after %d probes\",Math.round(1e4*te.d)/1e4,$)),te.max-X.d<=a||(E=te.h/2,S.push(new u1(te.p.x-E,te.p.y-E,E,h)),S.push(new u1(te.p.x+E,te.p.y-E,E,h)),S.push(new u1(te.p.x-E,te.p.y+E,E,h)),S.push(new u1(te.p.x+E,te.p.y+E,E,h)),$+=4)}return u&&(console.log(`num probes: ${$}`),console.log(`best distance: ${X.d}`)),X.p}function Jfe(h,a){return a.max-h.max}function u1(h,a,u,p){this.p=new s(h,a),this.h=u,this.d=(function(v,E){let S=!1,R=1/0;for(let F=0;F<E.length;F++){let U=E[F];for(let H=0,X=U.length,$=X-1;H<X;$=H++){let te=U[H],oe=U[$];te.y>v.y!=oe.y>v.y&&v.x<(oe.x-te.x)*(v.y-te.y)/(oe.y-te.y)+te.x&&(S=!S),R=Math.min(R,Mx(v,te,oe))}}return(S?1:-1)*Math.sqrt(R)})(this.p,p),this.max=this.d+this.h*Math.SQRT2}var fa;i.aP=void 0,(fa=i.aP||(i.aP={}))[fa.center=1]=\"center\",fa[fa.left=2]=\"left\",fa[fa.right=3]=\"right\",fa[fa.top=4]=\"top\",fa[fa.bottom=5]=\"bottom\",fa[fa[\"top-left\"]=6]=\"top-left\",fa[fa[\"top-right\"]=7]=\"top-right\",fa[fa[\"bottom-left\"]=8]=\"bottom-left\",fa[fa[\"bottom-right\"]=9]=\"bottom-right\";let xB=Number.POSITIVE_INFINITY;function EV(h,a){return a[1]!==xB?(function(u,p,v){let E=0,S=0;switch(p=Math.abs(p),v=Math.abs(v),u){case\"top-right\":case\"top-left\":case\"top\":S=v-7;break;case\"bottom-right\":case\"bottom-left\":case\"bottom\":S=7-v}switch(u){case\"top-right\":case\"bottom-right\":case\"right\":E=-p;break;case\"top-left\":case\"bottom-left\":case\"left\":E=p}return[E,S]})(h,a[0],a[1]):(function(u,p){let v=0,E=0;p<0&&(p=0);let S=p/Math.SQRT2;switch(u){case\"top-right\":case\"top-left\":E=S-7;break;case\"bottom-right\":case\"bottom-left\":E=7-S;break;case\"bottom\":E=7-p;break;case\"top\":E=p-7}switch(u){case\"top-right\":case\"bottom-right\":v=-S;break;case\"top-left\":case\"bottom-left\":v=S;break;case\"left\":v=p;break;case\"right\":v=-p}return[v,E]})(h,a[0])}function SV(h,a,u){var p;let v=h.layout,E=(p=v.get(\"text-variable-anchor-offset\"))===null||p===void 0?void 0:p.evaluate(a,{},u);if(E){let R=E.values,F=[];for(let U=0;U<R.length;U+=2){let H=F[U]=R[U],X=R[U+1].map(($=>$*Rs));H.startsWith(\"top\")?X[1]-=7:H.startsWith(\"bottom\")&&(X[1]+=7),F[U+1]=X}return new ia(F)}let S=v.get(\"text-variable-anchor\");if(S){let R;R=h._unevaluatedLayout.getValue(\"text-radial-offset\")!==void 0?[v.get(\"text-radial-offset\").evaluate(a,{},u)*Rs,xB]:v.get(\"text-offset\").evaluate(a,{},u).map((U=>U*Rs));let F=[];for(let U of S)F.push(U,EV(U,R));return new ia(F)}return null}function vB(h){switch(h){case\"right\":case\"top-right\":case\"bottom-right\":return\"right\";case\"left\":case\"top-left\":case\"bottom-left\":return\"left\"}return\"center\"}function $fe(h,a,u,p,v,E,S,R,F,U,H,X){let $=E.textMaxSize.evaluate(a,{});$===void 0&&($=S);let te=h.layers[0].layout,oe=te.get(\"icon-offset\").evaluate(a,{},H),le=MV(u.horizontal),ue=S/24,me=h.tilePixelRatio*ue,Le=h.tilePixelRatio*$/24,ye=h.tilePixelRatio*R,we=h.tilePixelRatio*te.get(\"symbol-spacing\"),ke=te.get(\"text-padding\")*h.tilePixelRatio,je=(function(nn,An,an,En=1){let Dr=nn.get(\"icon-padding\").evaluate(An,{},an),pr=Dr&&Dr.values;return[pr[0]*En,pr[1]*En,pr[2]*En,pr[3]*En]})(te,a,H,h.tilePixelRatio),ht=te.get(\"text-max-angle\")/180*Math.PI,It=te.get(\"text-rotation-alignment\")!==\"viewport\"&&te.get(\"symbol-placement\")!==\"point\",wt=te.get(\"icon-rotation-alignment\")===\"map\"&&te.get(\"symbol-placement\")!==\"point\",Rt=te.get(\"symbol-placement\"),Qt=we/2,Gt=te.get(\"icon-text-fit\"),bt;p&&Gt!==\"none\"&&(h.allowVerticalPlacement&&u.vertical&&(bt=yU(p,u.vertical,Gt,te.get(\"icon-text-fit-padding\"),oe,ue)),le&&(p=yU(p,le,Gt,te.get(\"icon-text-fit-padding\"),oe,ue)));let _t=H?X.line.getGranularityForZoomLevel(H.z):1,cn=(nn,An)=>{An.x<0||An.x>=rn||An.y<0||An.y>=rn||(function(an,En,Dr,pr,no,da,ns,ro,Zi,ii,To,Oo,ki,Ul,pa,Vl,Ru,Ls,Ao,rs,Eo,Os,ep,Nh,Xx){let G0=an.addToLineVertexArray(En,Dr),qg,h1,f1,d1,BV=0,DV=0,LV=0,OV=0,IB=-1,PB=-1,tp={},FV=ui(\"\");if(an.allowVerticalPlacement&&pr.vertical){let za=ro.layout.get(\"text-rotate\").evaluate(Eo,{},Nh)+90;f1=new CE(Zi,En,ii,To,Oo,pr.vertical,ki,Ul,pa,za),ns&&(d1=new CE(Zi,En,ii,To,Oo,ns,Ru,Ls,pa,za))}if(no){let za=ro.layout.get(\"icon-rotate\").evaluate(Eo,{}),Gc=ro.layout.get(\"icon-text-fit\")!==\"none\",Qg=wV(no,za,ep,Gc),Uh=ns?wV(ns,za,ep,Gc):void 0;h1=new CE(Zi,En,ii,To,Oo,no,Ru,Ls,!1,za),BV=4*Qg.length;let Kg=an.iconSizeData,Lf=null;Kg.kind===\"source\"?(Lf=[Jd*ro.layout.get(\"icon-size\").evaluate(Eo,{})],Lf[0]>N0&&yi(`${an.layerIds[0]}: Value for \"icon-size\" is >= 255. Reduce your \"icon-size\".`)):Kg.kind===\"composite\"&&(Lf=[Jd*Os.compositeIconSizes[0].evaluate(Eo,{},Nh),Jd*Os.compositeIconSizes[1].evaluate(Eo,{},Nh)],(Lf[0]>N0||Lf[1]>N0)&&yi(`${an.layerIds[0]}: Value for \"icon-size\" is >= 255. Reduce your \"icon-size\".`)),an.addSymbols(an.icon,Qg,Lf,rs,Ao,Eo,i.az.none,En,G0.lineStartIndex,G0.lineLength,-1,Nh),IB=an.icon.placedSymbolArray.length-1,Uh&&(DV=4*Uh.length,an.addSymbols(an.icon,Uh,Lf,rs,Ao,Eo,i.az.vertical,En,G0.lineStartIndex,G0.lineLength,-1,Nh),PB=an.icon.placedSymbolArray.length-1)}let kV=Object.keys(pr.horizontal);for(let za of kV){let Gc=pr.horizontal[za];if(!qg){FV=ui(Gc.text);let Uh=ro.layout.get(\"text-rotate\").evaluate(Eo,{},Nh);qg=new CE(Zi,En,ii,To,Oo,Gc,ki,Ul,pa,Uh)}let Qg=Gc.positionedLines.length===1;if(LV+=CV(an,En,Gc,da,ro,pa,Eo,Vl,G0,pr.vertical?i.az.horizontal:i.az.horizontalOnly,Qg?kV:[za],tp,IB,Os,Nh),Qg)break}pr.vertical&&(OV+=CV(an,En,pr.vertical,da,ro,pa,Eo,Vl,G0,i.az.vertical,[\"vertical\"],tp,PB,Os,Nh));let nde=qg?qg.boxStartIndex:an.collisionBoxArray.length,rde=qg?qg.boxEndIndex:an.collisionBoxArray.length,ide=f1?f1.boxStartIndex:an.collisionBoxArray.length,ode=f1?f1.boxEndIndex:an.collisionBoxArray.length,sde=h1?h1.boxStartIndex:an.collisionBoxArray.length,ade=h1?h1.boxEndIndex:an.collisionBoxArray.length,lde=d1?d1.boxStartIndex:an.collisionBoxArray.length,cde=d1?d1.boxEndIndex:an.collisionBoxArray.length,zh=-1,IE=(za,Gc)=>za&&za.circleDiameter?Math.max(za.circleDiameter,Gc):Gc;zh=IE(qg,zh),zh=IE(f1,zh),zh=IE(h1,zh),zh=IE(d1,zh);let NV=zh>-1?1:0;NV&&(zh*=Xx/Rs),an.glyphOffsetArray.length>=i1.MAX_GLYPHS&&yi(\"Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907\"),Eo.sortKey!==void 0&&an.addToSortKeyRanges(an.symbolInstances.length,Eo.sortKey);let ude=SV(ro,Eo,Nh),[hde,fde]=(function(za,Gc){let Qg=za.length,Uh=Gc?.values;if(Uh?.length>0)for(let Kg=0;Kg<Uh.length;Kg+=2){let Lf=Uh[Kg+1];za.emplaceBack(i.aP[Uh[Kg]],Lf[0],Lf[1])}return[Qg,za.length]})(an.textAnchorOffsets,ude);an.symbolInstances.emplaceBack(En.x,En.y,tp.right>=0?tp.right:-1,tp.center>=0?tp.center:-1,tp.left>=0?tp.left:-1,tp.vertical||-1,IB,PB,FV,nde,rde,ide,ode,sde,ade,lde,cde,ii,LV,OV,BV,DV,NV,0,ki,zh,hde,fde)})(h,An,nn,u,p,v,bt,h.layers[0],h.collisionBoxArray,a.index,a.sourceLayerIndex,h.index,me,[ke,ke,ke,ke],It,F,ye,je,wt,oe,a,E,U,H,S)};if(Rt===\"line\")for(let nn of AV(a.geometry,0,0,rn,rn)){let An=jg(nn,_t),an=qfe(An,we,ht,u.vertical||le,p,24,Le,h.overscaling,rn);for(let En of an)le&&ede(h,le.text,Qt,En)||cn(An,En)}else if(Rt===\"line-center\"){for(let nn of a.geometry)if(nn.length>1){let An=jg(nn,_t),an=Zfe(An,ht,u.vertical||le,p,24,Le);an&&cn(An,an)}}else if(a.type===\"Polygon\")for(let nn of ve(a.geometry,0)){let An=Kfe(nn,16);cn(jg(nn[0],_t,!0),new V0(An.x,An.y,0))}else if(a.type===\"LineString\")for(let nn of a.geometry){let An=jg(nn,_t);cn(An,new V0(An[0].x,An[0].y,0))}else if(a.type===\"Point\")for(let nn of a.geometry)for(let An of nn)cn([An],new V0(An.x,An.y,0))}function CV(h,a,u,p,v,E,S,R,F,U,H,X,$,te,oe){let le=(function(Le,ye,we,ke,je,ht,It,wt){let Rt=ke.layout.get(\"text-rotate\").evaluate(ht,{})*Math.PI/180,Qt=[];for(let Gt of ye.positionedLines)for(let bt of Gt.positionedGlyphs){if(!bt.rect)continue;let _t=bt.rect||{},cn=4,nn=!0,An=1,an=0,En=(je||wt)&&bt.vertical,Dr=bt.metrics.advance*bt.scale/2;if(wt&&ye.verticalizable&&(an=Gt.lineOffset/2-(bt.imageName?-(Rs-bt.metrics.width*bt.scale)/2:(bt.scale-1)*Rs)),bt.imageName){let Ls=It[bt.imageName];nn=Ls.sdf,An=Ls.pixelRatio,cn=1/An}let pr=je?[bt.x+Dr,bt.y]:[0,0],no=je?[0,0]:[bt.x+Dr+we[0],bt.y+we[1]-an],da=[0,0];En&&(da=no,no=[0,0]);let ns=bt.metrics.isDoubleResolution?2:1,ro=(bt.metrics.left-cn)*bt.scale-Dr+no[0],Zi=(-bt.metrics.top-cn)*bt.scale+no[1],ii=ro+_t.w/ns*bt.scale/An,To=Zi+_t.h/ns*bt.scale/An,Oo=new s(ro,Zi),ki=new s(ii,Zi),Ul=new s(ro,To),pa=new s(ii,To);if(En){let Ls=new s(-Dr,Dr- -17),Ao=-Math.PI/2,rs=12-Dr,Eo=new s(22-rs,-(bt.imageName?rs:0)),Os=new s(...da);Oo._rotateAround(Ao,Ls)._add(Eo)._add(Os),ki._rotateAround(Ao,Ls)._add(Eo)._add(Os),Ul._rotateAround(Ao,Ls)._add(Eo)._add(Os),pa._rotateAround(Ao,Ls)._add(Eo)._add(Os)}if(Rt){let Ls=Math.sin(Rt),Ao=Math.cos(Rt),rs=[Ao,-Ls,Ls,Ao];Oo._matMult(rs),ki._matMult(rs),Ul._matMult(rs),pa._matMult(rs)}let Vl=new s(0,0),Ru=new s(0,0);Qt.push({tl:Oo,tr:ki,bl:Ul,br:pa,tex:_t,writingMode:ye.writingMode,glyphOffset:pr,sectionIndex:bt.sectionIndex,isSDF:nn,pixelOffsetTL:Vl,pixelOffsetBR:Ru,minFontScaleX:0,minFontScaleY:0})}return Qt})(0,u,R,v,E,S,p,h.allowVerticalPlacement),ue=h.textSizeData,me=null;ue.kind===\"source\"?(me=[Jd*v.layout.get(\"text-size\").evaluate(S,{})],me[0]>N0&&yi(`${h.layerIds[0]}: Value for \"text-size\" is >= 255. Reduce your \"text-size\".`)):ue.kind===\"composite\"&&(me=[Jd*te.compositeTextSizes[0].evaluate(S,{},oe),Jd*te.compositeTextSizes[1].evaluate(S,{},oe)],(me[0]>N0||me[1]>N0)&&yi(`${h.layerIds[0]}: Value for \"text-size\" is >= 255. Reduce your \"text-size\".`)),h.addSymbols(h.text,le,me,R,E,S,U,a,F.lineStartIndex,F.lineLength,$,oe);for(let Le of H)X[Le]=h.text.placedSymbolArray.length-1;return 4*le.length}function MV(h){for(let a in h)return h[a];return null}function ede(h,a,u,p){let v=h.compareText;if(a in v){let E=v[a];for(let S=E.length-1;S>=0;S--)if(p.dist(E[S])<u)return!0}else v[a]=[];return v[a].push(p),!1}let IV=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class bB{static from(a){if(!(a instanceof ArrayBuffer))throw new Error(\"Data must be an instance of ArrayBuffer.\");let[u,p]=new Uint8Array(a,0,2);if(u!==219)throw new Error(\"Data does not appear to be in a KDBush format.\");let v=p>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);let E=IV[15&p];if(!E)throw new Error(\"Unrecognized array type.\");let[S]=new Uint16Array(a,2,1),[R]=new Uint32Array(a,4,1);return new bB(R,S,E,a)}constructor(a,u=64,p=Float64Array,v){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=p,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;let E=IV.indexOf(this.ArrayType),S=2*a*this.ArrayType.BYTES_PER_ELEMENT,R=a*this.IndexArrayType.BYTES_PER_ELEMENT,F=(8-R%8)%8;if(E<0)throw new Error(`Unexpected typed array class: ${p}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+R+F,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+S+R+F),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+R+F,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+E]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=a)}add(a,u){let p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=a,this.coords[this._pos++]=u,p}finish(){let a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return wB(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,u,p,v){if(!this._finished)throw new Error(\"Data not yet indexed - call index.finish().\");let{ids:E,coords:S,nodeSize:R}=this,F=[0,E.length-1,0],U=[];for(;F.length;){let H=F.pop()||0,X=F.pop()||0,$=F.pop()||0;if(X-$<=R){for(let ue=$;ue<=X;ue++){let me=S[2*ue],Le=S[2*ue+1];me>=a&&me<=p&&Le>=u&&Le<=v&&U.push(E[ue])}continue}let te=$+X>>1,oe=S[2*te],le=S[2*te+1];oe>=a&&oe<=p&&le>=u&&le<=v&&U.push(E[te]),(H===0?a<=oe:u<=le)&&(F.push($),F.push(te-1),F.push(1-H)),(H===0?p>=oe:v>=le)&&(F.push(te+1),F.push(X),F.push(1-H))}return U}within(a,u,p){if(!this._finished)throw new Error(\"Data not yet indexed - call index.finish().\");let{ids:v,coords:E,nodeSize:S}=this,R=[0,v.length-1,0],F=[],U=p*p;for(;R.length;){let H=R.pop()||0,X=R.pop()||0,$=R.pop()||0;if(X-$<=S){for(let ue=$;ue<=X;ue++)RV(E[2*ue],E[2*ue+1],a,u)<=U&&F.push(v[ue]);continue}let te=$+X>>1,oe=E[2*te],le=E[2*te+1];RV(oe,le,a,u)<=U&&F.push(v[te]),(H===0?a-p<=oe:u-p<=le)&&(R.push($),R.push(te-1),R.push(1-H)),(H===0?a+p>=oe:u+p>=le)&&(R.push(te+1),R.push(X),R.push(1-H))}return F}}function wB(h,a,u,p,v,E){if(v-p<=u)return;let S=p+v>>1;PV(h,a,S,p,v,E),wB(h,a,u,p,S-1,1-E),wB(h,a,u,S+1,v,1-E)}function PV(h,a,u,p,v,E){for(;v>p;){if(v-p>600){let U=v-p+1,H=u-p+1,X=Math.log(U),$=.5*Math.exp(2*X/3),te=.5*Math.sqrt(X*$*(U-$)/U)*(H-U/2<0?-1:1);PV(h,a,u,Math.max(p,Math.floor(u-H*$/U+te)),Math.min(v,Math.floor(u+(U-H)*$/U+te)),E)}let S=a[2*u+E],R=p,F=v;for(Wx(h,a,p,u),a[2*v+E]>S&&Wx(h,a,p,v);R<F;){for(Wx(h,a,R,F),R++,F--;a[2*R+E]<S;)R++;for(;a[2*F+E]>S;)F--}a[2*p+E]===S?Wx(h,a,p,F):(F++,Wx(h,a,F,v)),F<=u&&(p=F+1),u<=F&&(v=F-1)}}function Wx(h,a,u,p){TB(h,u,p),TB(a,2*u,2*p),TB(a,2*u+1,2*p+1)}function TB(h,a,u){let p=h[a];h[a]=h[u],h[u]=p}function RV(h,a,u,p){let v=h-u,E=a-p;return v*v+E*E}var EB;i.cI=void 0,(EB=i.cI||(i.cI={})).create=\"create\",EB.load=\"load\",EB.fullLoad=\"fullLoad\";let ME=null,jx=[],SB=1e3/60,CB=\"loadTime\",MB=\"fullLoadTime\",tde={mark(h){performance.mark(h)},frame(h){let a=h;ME!=null&&jx.push(a-ME),ME=a},clearMetrics(){ME=null,jx=[],performance.clearMeasures(CB),performance.clearMeasures(MB);for(let h in i.cI)performance.clearMarks(i.cI[h])},getPerformanceMetrics(){performance.measure(CB,i.cI.create,i.cI.load),performance.measure(MB,i.cI.create,i.cI.fullLoad);let h=performance.getEntriesByName(CB)[0].duration,a=performance.getEntriesByName(MB)[0].duration,u=jx.length,p=1/(jx.reduce(((E,S)=>E+S),0)/u/1e3),v=jx.filter((E=>E>SB)).reduce(((E,S)=>E+(S-SB)/SB),0);return{loadTime:h,fullLoadTime:a,fps:p,percentDroppedFrames:v/(u+v)*100,totalFrames:u}}};i.$=V,i.A=Y,i.B=Su,i.C=es,i.D=yn,i.E=Vt,i.F=function([h,a,u]){return a+=90,a*=Math.PI/180,u*=Math.PI/180,{x:h*Math.cos(a)*Math.sin(u),y:h*Math.sin(a)*Math.sin(u),z:h*Math.cos(u)}},i.G=ji,i.H=ci,i.I=Z5,i.J=C0,i.K=function(h){if(mr==null){let a=h.navigator?h.navigator.userAgent:null;mr=!!h.safari||!(!a||!(/\\b(iPad|iPhone|iPod)\\b/.test(a)||a.match(\"Safari\")&&!a.match(\"Chrome\")))}return mr},i.L=class{constructor(h,a){this.target=h,this.mapId=a,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new gfe((()=>this.process())),this.subscription=Zr(this.target,\"message\",(u=>this.receive(u)),!1),this.globalScope=co(self)?h:window}registerMessageHandler(h,a){this.messageHandlers[h]=a}unregisterMessageHandler(h){delete this.messageHandlers[h]}sendAsync(h,a){return new Promise(((u,p)=>{let v=Math.round(1e18*Math.random()).toString(36).substring(0,10),E=a?Zr(a.signal,\"abort\",(()=>{E?.unsubscribe(),delete this.resolveRejects[v];let F={id:v,type:\"<cancel>\",origin:location.origin,targetMapId:h.targetMapId,sourceMapId:this.mapId};this.target.postMessage(F)}),mfe):null;this.resolveRejects[v]={resolve:F=>{E?.unsubscribe(),u(F)},reject:F=>{E?.unsubscribe(),p(F)}};let S=[],R=Object.assign(Object.assign({},h),{id:v,sourceMapId:this.mapId,origin:location.origin,data:uc(h.data,S)});this.target.postMessage(R,{transfer:S})}))}receive(h){let a=h.data,u=a.id;if(!(a.origin!==\"file://\"&&location.origin!==\"file://\"&&a.origin!==\"resource://android\"&&location.origin!==\"resource://android\"&&a.origin!==location.origin||a.targetMapId&&this.mapId!==a.targetMapId)){if(a.type===\"<cancel>\"){delete this.tasks[u];let p=this.abortControllers[u];return delete this.abortControllers[u],void(p&&p.abort())}if(co(self)||a.mustQueue)return this.tasks[u]=a,this.taskQueue.push(u),void this.invoker.trigger();this.processTask(u,a)}}process(){if(this.taskQueue.length===0)return;let h=this.taskQueue.shift(),a=this.tasks[h];delete this.tasks[h],this.taskQueue.length>0&&this.invoker.trigger(),a&&this.processTask(h,a)}processTask(h,a){return o(this,void 0,void 0,(function*(){if(a.type===\"<response>\"){let v=this.resolveRejects[h];return delete this.resolveRejects[h],v?void(a.error?v.reject(zd(a.error)):v.resolve(zd(a.data))):void 0}if(!this.messageHandlers[a.type])return void this.completeTask(h,new Error(`Could not find a registered handler for ${a.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(\", \")}`));let u=zd(a.data),p=new AbortController;this.abortControllers[h]=p;try{let v=yield this.messageHandlers[a.type](a.sourceMapId,u,p);this.completeTask(h,null,v)}catch(v){this.completeTask(h,v)}}))}completeTask(h,a,u){let p=[];delete this.abortControllers[h];let v={id:h,type:\"<response>\",sourceMapId:this.mapId,origin:location.origin,error:a?uc(a):null,data:uc(u,p)};this.target.postMessage(v,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},i.M=pe,i.N=function(){var h=new Y(16);return Y!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},i.O=function(h,a,u){var p,v,E,S,R,F,U,H,X,$,te,oe,le=u[0],ue=u[1],me=u[2];return a===h?(h[12]=a[0]*le+a[4]*ue+a[8]*me+a[12],h[13]=a[1]*le+a[5]*ue+a[9]*me+a[13],h[14]=a[2]*le+a[6]*ue+a[10]*me+a[14],h[15]=a[3]*le+a[7]*ue+a[11]*me+a[15]):(v=a[1],E=a[2],S=a[3],R=a[4],F=a[5],U=a[6],H=a[7],X=a[8],$=a[9],te=a[10],oe=a[11],h[0]=p=a[0],h[1]=v,h[2]=E,h[3]=S,h[4]=R,h[5]=F,h[6]=U,h[7]=H,h[8]=X,h[9]=$,h[10]=te,h[11]=oe,h[12]=p*le+R*ue+X*me+a[12],h[13]=v*le+F*ue+$*me+a[13],h[14]=E*le+U*ue+te*me+a[14],h[15]=S*le+H*ue+oe*me+a[15]),h},i.P=s,i.Q=function(h,a,u){var p=u[0],v=u[1],E=u[2];return h[0]=a[0]*p,h[1]=a[1]*p,h[2]=a[2]*p,h[3]=a[3]*p,h[4]=a[4]*v,h[5]=a[5]*v,h[6]=a[6]*v,h[7]=a[7]*v,h[8]=a[8]*E,h[9]=a[9]*E,h[10]=a[10]*E,h[11]=a[11]*E,h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15],h},i.R=zl,i.S=function(h,a,u){var p=a[0],v=a[1],E=a[2],S=a[3],R=a[4],F=a[5],U=a[6],H=a[7],X=a[8],$=a[9],te=a[10],oe=a[11],le=a[12],ue=a[13],me=a[14],Le=a[15],ye=u[0],we=u[1],ke=u[2],je=u[3];return h[0]=ye*p+we*R+ke*X+je*le,h[1]=ye*v+we*F+ke*$+je*ue,h[2]=ye*E+we*U+ke*te+je*me,h[3]=ye*S+we*H+ke*oe+je*Le,h[4]=(ye=u[4])*p+(we=u[5])*R+(ke=u[6])*X+(je=u[7])*le,h[5]=ye*v+we*F+ke*$+je*ue,h[6]=ye*E+we*U+ke*te+je*me,h[7]=ye*S+we*H+ke*oe+je*Le,h[8]=(ye=u[8])*p+(we=u[9])*R+(ke=u[10])*X+(je=u[11])*le,h[9]=ye*v+we*F+ke*$+je*ue,h[10]=ye*E+we*U+ke*te+je*me,h[11]=ye*S+we*H+ke*oe+je*Le,h[12]=(ye=u[12])*p+(we=u[13])*R+(ke=u[14])*X+(je=u[15])*le,h[13]=ye*v+we*F+ke*$+je*ue,h[14]=ye*E+we*U+ke*te+je*me,h[15]=ye*S+we*H+ke*oe+je*Le,h},i.T=z5,i.U=function(h,a){let u={};for(let p=0;p<a.length;p++){let v=a[p];v in h&&(u[v]=h[v])}return u},i.V=z0,i.W=Mr,i.X=MU,i.Y=CU,i.Z=Ze,i._=o,i.a=Sn,i.a$=Ne,i.a0=q,i.a1=Ys,i.a2=Uc,i.a3=PU,i.a4=gE,i.a5=rn,i.a6=function(h,a,u){if(!h)return a||{};if(!a)return h||{};let p=LU(h),v=LU(a);(function(S,R){R.removeAll&&(S.add.clear(),S.update.clear(),S.remove.clear(),R.remove.clear());for(let F of R.remove)S.add.delete(F),S.update.delete(F);for(let[F,U]of R.update){let H=S.update.get(F);H&&(R.update.set(F,_fe(H,U)),S.update.delete(F))}})(p,v);let E={};if((p.removeAll||v.removeAll)&&(E.removeAll=!0),E.remove=new Set([...p.remove,...v.remove]),E.add=new Map([...p.add,...v.add]),E.update=new Map([...p.update,...v.update]),E.remove.size&&E.add.size)for(let S of E.add.keys())E.remove.delete(S);return(function(S){let R={};return S.removeAll&&(R.removeAll=S.removeAll),S.remove&&(R.remove=Array.from(S.remove)),S.add&&(R.add=Array.from(S.add.values())),S.update&&(R.update=Array.from(S.update.values())),R})(E)},i.a7=function(h,a){let u=new Map;if(h==null||h.type==null)return u;if(h.type===\"Feature\"){let p=rB(h,a);return p==null?void 0:(u.set(p,h),u)}if(h.type===\"FeatureCollection\"){let p=new Set;for(let v of h.features){let E=rB(v,a);if(E==null||p.has(E))return;p.add(E),u.set(E,v)}return u}},i.a8=function(h,a,u){var p,v;let E=[];if(a.removeAll)h.clear();else if(a.remove)for(let S of a.remove){let R=h.get(S);R&&(E.push(R.geometry),h.delete(S))}if(a.add)for(let S of a.add){let R=rB(S,u);if(R==null)continue;let F=h.get(R);F&&E.push(F.geometry),E.push(S.geometry),h.set(R,S)}if(a.update)for(let S of a.update){let R=h.get(S.id);if(!R)continue;let F=!!S.newGeometry,U=S.removeAllProperties||((p=S.removeProperties)===null||p===void 0?void 0:p.length)>0||((v=S.addOrUpdateProperties)===null||v===void 0?void 0:v.length)>0;if(!F&&!U)continue;E.push(R.geometry);let H=Object.assign({},R);if(h.set(S.id,H),F&&(E.push(S.newGeometry),H.geometry=S.newGeometry),U){if(H.properties=S.removeAllProperties?{}:Object.assign({},H.properties||{}),S.removeProperties)for(let X of S.removeProperties)delete H.properties[X];if(S.addOrUpdateProperties)for(let{key:X,value:$}of S.addOrUpdateProperties)H.properties[X]=$}}return E},i.a9=Ux,i.aA=function(h,{uSize:a,uSizeT:u},{lowerSize:p,upperSize:v}){return h.kind===\"source\"?p/Jd:h.kind===\"composite\"?ji.number(p/Jd,v/Jd,u):a},i.aB=function(h,a){var u=a[0],p=a[1],v=a[2],E=a[3],S=a[4],R=a[5],F=a[6],U=a[7],H=a[8],X=a[9],$=a[10],te=a[11],oe=a[12],le=a[13],ue=a[14],me=a[15],Le=u*R-p*S,ye=u*F-v*S,we=u*U-E*S,ke=p*F-v*R,je=p*U-E*R,ht=v*U-E*F,It=H*le-X*oe,wt=H*ue-$*oe,Rt=H*me-te*oe,Qt=X*ue-$*le,Gt=X*me-te*le,bt=$*me-te*ue,_t=Le*bt-ye*Gt+we*Qt+ke*Rt-je*wt+ht*It;return _t?(h[0]=(R*bt-F*Gt+U*Qt)*(_t=1/_t),h[1]=(v*Gt-p*bt-E*Qt)*_t,h[2]=(le*ht-ue*je+me*ke)*_t,h[3]=($*je-X*ht-te*ke)*_t,h[4]=(F*Rt-S*bt-U*wt)*_t,h[5]=(u*bt-v*Rt+E*wt)*_t,h[6]=(ue*we-oe*ht-me*ye)*_t,h[7]=(H*ht-$*we+te*ye)*_t,h[8]=(S*Gt-R*Rt+U*It)*_t,h[9]=(p*Rt-u*Gt-E*It)*_t,h[10]=(oe*je-le*we+me*Le)*_t,h[11]=(X*we-H*je-te*Le)*_t,h[12]=(R*wt-S*Qt-F*It)*_t,h[13]=(u*Qt-p*wt+v*It)*_t,h[14]=(le*ye-oe*ke-ue*Le)*_t,h[15]=(H*ke-X*ye+$*Le)*_t,h):null},i.aC=jt,i.aD=function(h){var a=h[0],u=h[1];return Math.sqrt(a*a+u*u)},i.aE=function(h){return h[0]=0,h[1]=0,h},i.aF=function(h,a,u){return h[0]=a[0]*u,h[1]=a[1]*u,h},i.aG=K5,i.aH=Ct,i.aI=function(h,a,u,p){let v=a.y-h.y,E=a.x-h.x,S=p.y-u.y,R=p.x-u.x,F=S*E-R*v;if(F===0)return null;let U=(R*(h.y-u.y)-S*(h.x-u.x))/F;return new s(h.x+U*E,h.y+U*v)},i.aJ=AV,i.aK=Tn,i.aL=function(h){let a=1/0,u=1/0,p=-1/0,v=-1/0;for(let E of h)a=Math.min(a,E.x),u=Math.min(u,E.y),p=Math.max(p,E.x),v=Math.max(v,E.y);return[a,u,p,v]},i.aM=Rs,i.aN=In,i.aO=function(h,a,u,p,v=!1){if(!u[0]&&!u[1])return[0,0];let E=v?p===\"map\"?-h.bearingInRadians:0:p===\"viewport\"?h.bearingInRadians:0;if(E){let S=Math.sin(E),R=Math.cos(E);u=[u[0]*R-u[1]*S,u[0]*S+u[1]*R]}return[v?u[0]:In(a,u[0],h.zoom),v?u[1]:In(a,u[1],h.zoom)]},i.aQ=Q5,i.aR=vB,i.aS=q5,i.aT=bB,i.aU=fo,i.aV=uE,i.aW=Te,i.aX=Jt,i.aY=ft,i.aZ=Fr,i.a_=RU,i.aa=Xg,i.ab=25,i.ac=nB,i.ad=h=>{let a=window.document.createElement(\"video\");return a.muted=!0,new Promise((u=>{a.onloadstart=()=>{u(a)};for(let p of h){let v=window.document.createElement(\"source\");tt(p)||(a.crossOrigin=\"Anonymous\"),v.src=p,a.appendChild(v)}}))},i.ae=Lt,i.af=function(){return Br++},i.ag=w,i.ah=i1,i.ai=Hx,i.aj=Tu,i.ak=Vn,i.al=FU,i.am=function(h){let a={};if(h.replace(/(?:^|(?:\\s*\\,\\s*))([^\\x00-\\x20\\(\\)<>@\\,;\\:\\\\\"\\/\\[\\]\\?\\=\\{\\}\\x7F]+)(?:\\=(?:([^\\x00-\\x20\\(\\)<>@\\,;\\:\\\\\"\\/\\[\\]\\?\\=\\{\\}\\x7F]+)|(?:\\\"((?:[^\"\\\\]|\\\\.)*)\\\")))?/g,((u,p,v,E)=>{let S=v||E;return a[p]=!S||S.toLowerCase(),\"\"})),a[\"max-age\"]){let u=parseInt(a[\"max-age\"],10);isNaN(u)?delete a[\"max-age\"]:a[\"max-age\"]=u}return a},i.an=Pt,i.ao=85.051129,i.ap=Oi,i.aq=function(h){return Math.pow(2,h)},i.ar=J,i.as=IU,i.at=function(h){return Math.log(h)/Math.LN2},i.au=function(h){var a=h[0],u=h[1];return a*a+u*u},i.av=function(h){if(!h.length)return new Set;let a=Math.max(...h.map((F=>F.canonical.z))),u=1/0,p=-1/0,v=1/0,E=-1/0,S=[];for(let F of h){let{x:U,y:H,z:X}=F.canonical,$=Math.pow(2,a-X),te=U*$,oe=H*$;S.push({id:F,x:te,y:oe}),te<u&&(u=te),te>p&&(p=te),oe<v&&(v=oe),oe>E&&(E=oe)}let R=new Set;for(let F of S)F.x!==u&&F.x!==p&&F.y!==v&&F.y!==E||R.add(F.id);return R},i.aw=function(h,a){let u=Math.abs(2*h.wrap)-+(h.wrap<0),p=Math.abs(2*a.wrap)-+(a.wrap<0);return h.overscaledZ-a.overscaledZ||p-u||a.canonical.y-h.canonical.y||a.canonical.x-h.canonical.x},i.ax=class{constructor(h,a){this.max=h,this.onRemove=a,this.reset()}reset(){for(let h in this.data)for(let a of this.data[h])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(h,a,u){let p=h.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);let v={value:a,timeout:void 0};if(u!==void 0&&(v.timeout=setTimeout((()=>{this.remove(h,v)}),u)),this.data[p].push(v),this.order.push(p),this.order.length>this.max){let E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(h){return h.wrapped().key in this.data}getAndRemove(h){return this.has(h)?this._getAndRemoveByKey(h.wrapped().key):null}_getAndRemoveByKey(h){let a=this.data[h].shift();return a.timeout&&clearTimeout(a.timeout),this.data[h].length===0&&delete this.data[h],this.order.splice(this.order.indexOf(h),1),a.value}getByKey(h){let a=this.data[h];return a?a[0].value:null}get(h){return this.has(h)?this.data[h.wrapped().key][0].value:null}remove(h,a){if(!this.has(h))return this;let u=h.wrapped().key,p=a===void 0?0:this.data[u].indexOf(a),v=this.data[u][p];return this.data[u].splice(p,1),v.timeout&&clearTimeout(v.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(v.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(h){for(this.max=h;this.order.length>this.max;){let a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(h){let a=[];for(let u in this.data)for(let p of this.data[u])h(p.value)||a.push(p);for(let u of a)this.remove(u.value.tileID,u)}},i.ay=function(h,a){let u=0,p=0;if(h.kind===\"constant\")p=h.layoutSize;else if(h.kind!==\"source\"){let{interpolationType:v,minZoom:E,maxZoom:S}=h,R=v?Pt(sa.interpolationFactor(v,a,E,S),0,1):0;h.kind===\"camera\"?p=ji.number(h.minSize,h.maxSize,R):u=R}return{uSizeT:u,uSize:p}},i.b=Yr,i.b$=N,i.b0=Xe,i.b1=function(h){var a=new Y(3);return a[0]=h[0],a[1]=h[1],a[2]=h[2],a},i.b2=function(h,a,u){return h[0]=a[0]-u[0],h[1]=a[1]-u[1],h[2]=a[2]-u[2],h},i.b3=function(h,a){var u=a[0],p=a[1],v=a[2],E=u*u+p*p+v*v;return E>0&&(E=1/Math.sqrt(E)),h[0]=a[0]*E,h[1]=a[1]*E,h[2]=a[2]*E,h},i.b4=be,i.b5=function(h,a){return h[0]*a[0]+h[1]*a[1]+h[2]*a[2]},i.b6=function(h,a,u){return h[0]=a[0]*u[0],h[1]=a[1]*u[1],h[2]=a[2]*u[2],h[3]=a[3]*u[3],h},i.b7=xe,i.b8=function(h,a,u){let p=a[0]*u[0]+a[1]*u[1]+a[2]*u[2];return p===0?null:(-(h[0]*u[0]+h[1]*u[1]+h[2]*u[2])-u[3])/p},i.b9=Qe,i.bA=function(){return new Float64Array(3)},i.bB=mt,i.bC=function(h,a,u){var p=u[0],v=u[1],E=u[2],S=u[3],R=a[0],F=a[1],U=a[2],H=v*U-E*F,X=E*R-p*U,$=p*F-v*R;return h[0]=R+S*(H+=H)+v*($+=$)-E*(X+=X),h[1]=F+S*X+E*H-p*$,h[2]=U+S*$+p*X-v*H,h},i.bD=function(h,a,u){let p=(v=[h[0],h[1],h[2],a[0],a[1],a[2],u[0],u[1],u[2]])[0]*((H=v[8])*(S=v[4])-(R=v[5])*(U=v[7]))+v[1]*(-H*(E=v[3])+R*(F=v[6]))+v[2]*(U*E-S*F);var v,E,S,R,F,U,H;if(p===0)return null;let X=be([],[a[0],a[1],a[2]],[u[0],u[1],u[2]]),$=be([],[u[0],u[1],u[2]],[h[0],h[1],h[2]]),te=be([],[h[0],h[1],h[2]],[a[0],a[1],a[2]]),oe=Ne([],X,-h[3]);return Xe(oe,oe,Ne([],$,-a[3])),Xe(oe,oe,Ne([],te,-u[3])),Ne(oe,oe,1/p),oe},i.bE=tB,i.bF=function(){return new Float64Array(4)},i.bG=function(h,a,u,p){var v=[],E=[];return v[0]=a[0]-u[0],v[1]=a[1]-u[1],v[2]=a[2]-u[2],E[0]=v[0]*Math.cos(p)-v[1]*Math.sin(p),E[1]=v[0]*Math.sin(p)+v[1]*Math.cos(p),E[2]=v[2],h[0]=E[0]+u[0],h[1]=E[1]+u[1],h[2]=E[2]+u[2],h},i.bH=function(h,a,u,p){var v=[],E=[];return v[0]=a[0]-u[0],v[1]=a[1]-u[1],v[2]=a[2]-u[2],E[0]=v[0],E[1]=v[1]*Math.cos(p)-v[2]*Math.sin(p),E[2]=v[1]*Math.sin(p)+v[2]*Math.cos(p),h[0]=E[0]+u[0],h[1]=E[1]+u[1],h[2]=E[2]+u[2],h},i.bI=function(h,a,u,p){var v=[],E=[];return v[0]=a[0]-u[0],v[1]=a[1]-u[1],v[2]=a[2]-u[2],E[0]=v[2]*Math.sin(p)+v[0]*Math.cos(p),E[1]=v[1],E[2]=v[2]*Math.cos(p)-v[0]*Math.sin(p),h[0]=E[0]+u[0],h[1]=E[1]+u[1],h[2]=E[2]+u[2],h},i.bJ=function(h,a,u){var p=Math.sin(u),v=Math.cos(u),E=a[0],S=a[1],R=a[2],F=a[3],U=a[8],H=a[9],X=a[10],$=a[11];return a!==h&&(h[4]=a[4],h[5]=a[5],h[6]=a[6],h[7]=a[7],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h[0]=E*v-U*p,h[1]=S*v-H*p,h[2]=R*v-X*p,h[3]=F*v-$*p,h[8]=E*p+U*v,h[9]=S*p+H*v,h[10]=R*p+X*v,h[11]=F*p+$*v,h},i.bK=function(h,a){let u=On(h,360),p=On(a,360),v=p-u,E=p>u?v-360:v+360;return Math.abs(v)<Math.abs(E)?v:E},i.bL=function(h){return h[0]=0,h[1]=0,h[2]=0,h},i.bM=function(h,a,u,p){let v=Math.sqrt(h*h+a*a),E=Math.sqrt(u*u+p*p);h/=v,a/=v,u/=E,p/=E;let S=Math.acos(h*u+a*p);return-a*u+h*p>0?S:-S},i.bN=function(h,a){let u=On(h,2*Math.PI),p=On(a,2*Math.PI);return Math.min(Math.abs(u-p),Math.abs(u-p+2*Math.PI),Math.abs(u-p-2*Math.PI))},i.bO=function(){let h={},a=Ke.$version;for(let u in Ke.$root){let p=Ke.$root[u];if(p.required){let v=null;v=u===\"version\"?a:p.type===\"array\"?[]:{},v!=null&&(h[u]=v)}}return h},i.bP=He,i.bQ=M0,i.bR=function h(a,u){if(Array.isArray(a)){if(!Array.isArray(u)||a.length!==u.length)return!1;for(let p=0;p<a.length;p++)if(!h(a[p],u[p]))return!1;return!0}if(typeof a==\"object\"&&a!==null&&u!==null){if(typeof u!=\"object\"||Object.keys(a).length!==Object.keys(u).length)return!1;for(let p in a)if(!h(a[p],u[p]))return!1;return!0}return a===u},i.bS=function(h){h=h.slice();let a=Object.create(null);for(let u=0;u<h.length;u++)a[h[u].id]=h[u];for(let u=0;u<h.length;u++)\"ref\"in h[u]&&(h[u]=Wr(h[u],a[h[u].ref]));return h},i.bT=function(h,a){if(h.type===\"custom\")return new Afe(h,a);switch(h.type){case\"background\":return new pfe(h,a);case\"circle\":return new Jue(h,a);case\"color-relief\":return new ihe(h,a);case\"fill\":return new yhe(h,a);case\"fill-extrusion\":return new Rhe(h,a);case\"heatmap\":return new ehe(h,a);case\"hillshade\":return new nhe(h,a);case\"line\":return new Nhe(h,a);case\"raster\":return new Sx(h,a);case\"symbol\":return new AE(h,a)}},i.bU=h=>h.type===\"raster\",i.bV=oi,i.bW=function(h,a){if(!h)return[{command:\"setStyle\",args:[a]}];let u=[];try{if(!fn(h.version,a.version))return[{command:\"setStyle\",args:[a]}];fn(h.center,a.center)||u.push({command:\"setCenter\",args:[a.center]}),fn(h.state,a.state)||u.push({command:\"setGlobalState\",args:[a.state]}),fn(h.centerAltitude,a.centerAltitude)||u.push({command:\"setCenterAltitude\",args:[a.centerAltitude]}),fn(h.zoom,a.zoom)||u.push({command:\"setZoom\",args:[a.zoom]}),fn(h.bearing,a.bearing)||u.push({command:\"setBearing\",args:[a.bearing]}),fn(h.pitch,a.pitch)||u.push({command:\"setPitch\",args:[a.pitch]}),fn(h.roll,a.roll)||u.push({command:\"setRoll\",args:[a.roll]}),fn(h.sprite,a.sprite)||u.push({command:\"setSprite\",args:[a.sprite]}),fn(h.glyphs,a.glyphs)||u.push({command:\"setGlyphs\",args:[a.glyphs]}),fn(h.transition,a.transition)||u.push({command:\"setTransition\",args:[a.transition]}),fn(h.light,a.light)||u.push({command:\"setLight\",args:[a.light]}),fn(h.terrain,a.terrain)||u.push({command:\"setTerrain\",args:[a.terrain]}),fn(h.sky,a.sky)||u.push({command:\"setSky\",args:[a.sky]}),fn(h.projection,a.projection)||u.push({command:\"setProjection\",args:[a.projection]});let p={},v=[];(function(S,R,F,U){let H;for(H in R=R||{},S=S||{})Object.prototype.hasOwnProperty.call(S,H)&&(Object.prototype.hasOwnProperty.call(R,H)||Ir(H,F,U));for(H in R)Object.prototype.hasOwnProperty.call(R,H)&&(Object.prototype.hasOwnProperty.call(S,H)?fn(S[H],R[H])||(S[H].type===\"geojson\"&&R[H].type===\"geojson\"&&di(S,R,H)?ln(F,{command:\"setGeoJSONSourceData\",args:[H,R[H].data]}):Et(H,R,F,U)):Nn(H,R,F))})(h.sources,a.sources,v,p);let E=[];h.layers&&h.layers.forEach((S=>{\"source\"in S&&p[S.source]?u.push({command:\"removeLayer\",args:[S.id]}):E.push(S)})),u=u.concat(v),(function(S,R,F){R=R||[];let U=(S=S||[]).map(ti),H=R.map(ti),X=S.reduce(Wi,{}),$=R.reduce(Wi,{}),te=U.slice(),oe=Object.create(null),le,ue,me,Le,ye;for(let we=0,ke=0;we<U.length;we++)le=U[we],Object.prototype.hasOwnProperty.call($,le)?ke++:(ln(F,{command:\"removeLayer\",args:[le]}),te.splice(te.indexOf(le,ke),1));for(let we=0,ke=0;we<H.length;we++)le=H[H.length-1-we],te[te.length-1-we]!==le&&(Object.prototype.hasOwnProperty.call(X,le)?(ln(F,{command:\"removeLayer\",args:[le]}),te.splice(te.lastIndexOf(le,te.length-ke),1)):ke++,Le=te[te.length-we],ln(F,{command:\"addLayer\",args:[$[le],Le]}),te.splice(te.length-we,0,le),oe[le]=!0);for(let we=0;we<H.length;we++)if(le=H[we],ue=X[le],me=$[le],!oe[le]&&!fn(ue,me))if(fn(ue.source,me.source)&&fn(ue[\"source-layer\"],me[\"source-layer\"])&&fn(ue.type,me.type)){for(ye in pi(ue.layout,me.layout,F,le,null,\"setLayoutProperty\"),pi(ue.paint,me.paint,F,le,null,\"setPaintProperty\"),fn(ue.filter,me.filter)||ln(F,{command:\"setFilter\",args:[le,me.filter]}),fn(ue.minzoom,me.minzoom)&&fn(ue.maxzoom,me.maxzoom)||ln(F,{command:\"setLayerZoomRange\",args:[le,me.minzoom,me.maxzoom]}),ue)Object.prototype.hasOwnProperty.call(ue,ye)&&ye!==\"layout\"&&ye!==\"paint\"&&ye!==\"filter\"&&ye!==\"metadata\"&&ye!==\"minzoom\"&&ye!==\"maxzoom\"&&(ye.indexOf(\"paint.\")===0?pi(ue[ye],me[ye],F,le,ye.slice(6),\"setPaintProperty\"):fn(ue[ye],me[ye])||ln(F,{command:\"setLayerProperty\",args:[le,ye,me[ye]]}));for(ye in me)Object.prototype.hasOwnProperty.call(me,ye)&&!Object.prototype.hasOwnProperty.call(ue,ye)&&ye!==\"layout\"&&ye!==\"paint\"&&ye!==\"filter\"&&ye!==\"metadata\"&&ye!==\"minzoom\"&&ye!==\"maxzoom\"&&(ye.indexOf(\"paint.\")===0?pi(ue[ye],me[ye],F,le,ye.slice(6),\"setPaintProperty\"):fn(ue[ye],me[ye])||ln(F,{command:\"setLayerProperty\",args:[le,ye,me[ye]]}))}else ln(F,{command:\"removeLayer\",args:[le]}),Le=te[te.lastIndexOf(le)+1],ln(F,{command:\"addLayer\",args:[me,Le]})})(E,a.layers,u)}catch(p){console.warn(\"Unable to compute style diff:\",p),u=[{command:\"setStyle\",args:[a]}]}return u},i.bX=function(h){let a=[],u=h.id;return u===void 0&&a.push({message:`layers.${u}: missing required property \"id\"`}),h.render===void 0&&a.push({message:`layers.${u}: missing required method \"render\"`}),h.renderingMode&&h.renderingMode!==\"2d\"&&h.renderingMode!==\"3d\"&&a.push({message:`layers.${u}: property \"renderingMode\" must be either \"2d\" or \"3d\"`}),a},i.bY=nr,i.bZ=lo,i.b_=class extends M{constructor(h,a){super(h,a),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},i.ba=function(h,a,u){return h[0]=a[0]*u,h[1]=a[1]*u,h[2]=a[2]*u,h[3]=a[3]*u,h},i.bb=function(h,a){return h[0]*a[0]+h[1]*a[1]+h[2]*a[2]+h[3]},i.bc=DU,i.bd=o1,i.be=function(h,a,u,p,v){var E=1/Math.tan(a/2);if(h[0]=E/u,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=E,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,v!=null&&v!==1/0){var S=1/(p-v);h[10]=(v+p)*S,h[14]=2*v*p*S}else h[10]=-1,h[14]=-2*p;return h},i.bf=function(h){var a=new Y(16);return a[0]=h[0],a[1]=h[1],a[2]=h[2],a[3]=h[3],a[4]=h[4],a[5]=h[5],a[6]=h[6],a[7]=h[7],a[8]=h[8],a[9]=h[9],a[10]=h[10],a[11]=h[11],a[12]=h[12],a[13]=h[13],a[14]=h[14],a[15]=h[15],a},i.bg=function(h,a,u){var p=Math.sin(u),v=Math.cos(u),E=a[0],S=a[1],R=a[2],F=a[3],U=a[4],H=a[5],X=a[6],$=a[7];return a!==h&&(h[8]=a[8],h[9]=a[9],h[10]=a[10],h[11]=a[11],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h[0]=E*v+U*p,h[1]=S*v+H*p,h[2]=R*v+X*p,h[3]=F*v+$*p,h[4]=U*v-E*p,h[5]=H*v-S*p,h[6]=X*v-R*p,h[7]=$*v-F*p,h},i.bh=function(h,a,u){var p=Math.sin(u),v=Math.cos(u),E=a[4],S=a[5],R=a[6],F=a[7],U=a[8],H=a[9],X=a[10],$=a[11];return a!==h&&(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h[4]=E*v+U*p,h[5]=S*v+H*p,h[6]=R*v+X*p,h[7]=F*v+$*p,h[8]=U*v-E*p,h[9]=H*v-S*p,h[10]=X*v-R*p,h[11]=$*v-F*p,h},i.bi=function(){let h=new Float32Array(16);return J(h),h},i.bj=function(){let h=new Float64Array(16);return J(h),h},i.bk=function(){return new Float64Array(16)},i.bl=function(h,a,u){let p=new Float64Array(4);return mt(p,h,a-90,u),p},i.bm=function(h,a,u,p){var v,E,S,R,F,U=a[0],H=a[1],X=a[2],$=a[3],te=u[0],oe=u[1],le=u[2],ue=u[3];return(E=U*te+H*oe+X*le+$*ue)<0&&(E=-E,te=-te,oe=-oe,le=-le,ue=-ue),1-E>K?(v=Math.acos(E),S=Math.sin(v),R=Math.sin((1-p)*v)/S,F=Math.sin(p*v)/S):(R=1-p,F=p),h[0]=R*U+F*te,h[1]=R*H+F*oe,h[2]=R*X+F*le,h[3]=R*$+F*ue,h},i.bn=function(h){let a=new Float64Array(9);var u,p,v,E,S,R,F,U,H,X,$,te,oe,le,ue,me,Le,ye;X=(v=(p=h)[0])*(F=v+v),$=(E=p[1])*F,oe=(S=p[2])*F,le=S*(U=E+E),me=(R=p[3])*F,Le=R*U,ye=R*(H=S+S),(u=a)[0]=1-(te=E*U)-(ue=S*H),u[3]=$-ye,u[6]=oe+Le,u[1]=$+ye,u[4]=1-X-ue,u[7]=le-me,u[2]=oe-Le,u[5]=le+me,u[8]=1-X-te;let we=Fr(-Math.asin(Pt(a[2],-1,1))),ke,je;return Math.hypot(a[5],a[8])<.001?(ke=0,je=-Fr(Math.atan2(a[3],a[4]))):(ke=Fr(a[5]===0&&a[8]===0?0:Math.atan2(a[5],a[8])),je=Fr(a[1]===0&&a[0]===0?0:Math.atan2(a[1],a[0]))),{roll:ke,pitch:we+90,bearing:je}},i.bo=function(h,a){return h.roll==a.roll&&h.pitch==a.pitch&&h.bearing==a.bearing},i.bp=Zn,i.bq=D,i.br=t1,i.bs=Lx,i.bt=e1,i.bu=Pn,i.bv=_n,i.bw=oa,i.bx=function(h,a,u,p,v){return Pn(p,v,Pt((h-a)/(u-a),0,1))},i.by=function(h,a,u,p){return h[0]=a[0]+u[0]*p,h[1]=a[1]+u[1]*p,h[2]=a[2]+u[2]*p,h},i.bz=On,i.c=ae,i.c$=class{constructor(h){this._marks={start:[h.url,\"start\"].join(\"#\"),end:[h.url,\"end\"].join(\"#\"),measure:h.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let h=performance.getEntriesByName(this._marks.measure);return h.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),h=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),h}},i.c0=class extends M{constructor(h,a){super(h,a),this.current=W}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let a=1;a<16;a++)if(h[a]!==this.current[a]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},i.c1=O,i.c2=class extends M{constructor(h,a){super(h,a),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},i.c3=class extends M{constructor(h,a){super(h,a),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},i.c4=ee,i.c5=function(h,a){var u=Math.sin(a),p=Math.cos(a);return h[0]=p,h[1]=u,h[2]=0,h[3]=-u,h[4]=p,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},i.c6=function(h,a,u){var p=a[0],v=a[1],E=a[2];return h[0]=p*u[0]+v*u[3]+E*u[6],h[1]=p*u[1]+v*u[4]+E*u[7],h[2]=p*u[2]+v*u[5]+E*u[8],h},i.c7=function(h,a,u,p,v,E,S){var R=1/(a-u),F=1/(p-v),U=1/(E-S);return h[0]=-2*R,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*F,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*U,h[11]=0,h[12]=(a+u)*R,h[13]=(v+p)*F,h[14]=(S+E)*U,h[15]=1,h},i.c8=class extends M{constructor(h,a){super(h,a),this.current=new Array}set(h){if(h!=this.current){this.current=h;let a=new Float32Array(4*h.length);for(let u=0;u<h.length;u++)a[4*u]=h[u].r,a[4*u+1]=h[u].g,a[4*u+2]=h[u].b,a[4*u+3]=h[u].a;this.gl.uniform4fv(this.location,a)}}},i.c9=class extends M{constructor(h,a){super(h,a),this.current=new Array}set(h){if(h!=this.current){this.current=h;let a=new Float32Array(h);this.gl.uniform1fv(this.location,a)}}},i.cA=function(h,a){var u;if(!$t[a])return!1;let p=h?.target,v=((u=p?.ownerDocument)===null||u===void 0?void 0:u.defaultView)||window;return h instanceof v.MouseEvent||h instanceof v.WheelEvent},i.cB=function(h,a){return eo[a]&&\"touches\"in h},i.cC=function(h){return eo[h]||$t[h]},i.cD=function(h,a,u){var p=a[0],v=a[1];return h[0]=u[0]*p+u[4]*v+u[12],h[1]=u[1]*p+u[5]*v+u[13],h},i.cE=function(h,a){let{x:u,y:p}=Ux.fromLngLat(a);return!(h<0||h>25||p<0||p>=1||u<0||u>=1)},i.cF=function(h,a){return h[0]=a[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=a[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=a[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},i.cG=class extends D0{},i.cH=tde,i.cJ=ze,i.cK=function(h,a){ae.REGISTERED_PROTOCOLS[h]=a},i.cL=function(h){delete ae.REGISTERED_PROTOCOLS[h]},i.cM=function(h,a){let u={};for(let v=0;v<h.length;v++){let E=a&&a[h[v].id]||W_(h[v]);a&&(a[h[v].id]=E);let S=u[E];S||(S=u[E]=[]),S.push(h[v])}let p=[];for(let v in u)p.push(u[v]);return p},i.cN=un,i.cO=OU,i.cP=dV,i.cQ=gU,i.cR=function(h){var a;h.bucket.createArrays(),h.bucket.tilePixelRatio=rn/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;let u=h.bucket.layers[0],p=u.layout,v=u._unevaluatedLayout._values,E={layoutIconSize:v[\"icon-size\"].possiblyEvaluate(new ci(h.bucket.zoom+1),h.canonical),layoutTextSize:v[\"text-size\"].possiblyEvaluate(new ci(h.bucket.zoom+1),h.canonical),textMaxSize:v[\"text-size\"].possiblyEvaluate(new ci(18))};if(h.bucket.textSizeData.kind===\"composite\"){let{minZoom:H,maxZoom:X}=h.bucket.textSizeData;E.compositeTextSizes=[v[\"text-size\"].possiblyEvaluate(new ci(H),h.canonical),v[\"text-size\"].possiblyEvaluate(new ci(X),h.canonical)]}if(h.bucket.iconSizeData.kind===\"composite\"){let{minZoom:H,maxZoom:X}=h.bucket.iconSizeData;E.compositeIconSizes=[v[\"icon-size\"].possiblyEvaluate(new ci(H),h.canonical),v[\"icon-size\"].possiblyEvaluate(new ci(X),h.canonical)]}let S=p.get(\"text-line-height\")*Rs,R=p.get(\"text-rotation-alignment\")!==\"viewport\"&&p.get(\"symbol-placement\")!==\"point\",F=p.get(\"text-keep-upright\"),U=p.get(\"text-size\");for(let H of h.bucket.features){let X=p.get(\"text-font\").evaluate(H,{},h.canonical).join(\",\"),$=U.evaluate(H,{},h.canonical),te=E.layoutTextSize.evaluate(H,{},h.canonical),oe=E.layoutIconSize.evaluate(H,{},h.canonical),le={horizontal:{},vertical:void 0},ue=H.text,me,Le=[0,0];if(ue){let ke=ue.toString(),je=p.get(\"text-letter-spacing\").evaluate(H,{},h.canonical)*Rs,ht=Fg(ke)?je:0,It=p.get(\"text-anchor\").evaluate(H,{},h.canonical),wt=SV(u,H,h.canonical);if(!wt){let bt=p.get(\"text-radial-offset\").evaluate(H,{},h.canonical);Le=bt?EV(It,[bt*Rs,xB]):p.get(\"text-offset\").evaluate(H,{},h.canonical).map((_t=>_t*Rs))}let Rt=R?\"center\":p.get(\"text-justify\").evaluate(H,{},h.canonical),Qt=p.get(\"symbol-placement\")===\"point\"?p.get(\"text-max-width\").evaluate(H,{},h.canonical)*Rs:1/0,Gt=()=>{h.bucket.allowVerticalPlacement&&Mf(ke)&&(le.vertical=dE(ue,h.glyphMap,h.glyphPositions,h.imagePositions,X,Qt,S,It,\"left\",ht,Le,i.az.vertical,!0,te,$))};if(!R&&wt){let bt=new Set;if(Rt===\"auto\")for(let cn=0;cn<wt.values.length;cn+=2)bt.add(vB(wt.values[cn]));else bt.add(Rt);let _t=!1;for(let cn of bt)if(!le.horizontal[cn])if(_t)le.horizontal[cn]=le.horizontal[0];else{let nn=dE(ue,h.glyphMap,h.glyphPositions,h.imagePositions,X,Qt,S,\"center\",cn,ht,Le,i.az.horizontal,!1,te,$);nn&&(le.horizontal[cn]=nn,_t=nn.positionedLines.length===1)}Gt()}else{Rt===\"auto\"&&(Rt=vB(It));let bt=dE(ue,h.glyphMap,h.glyphPositions,h.imagePositions,X,Qt,S,It,Rt,ht,Le,i.az.horizontal,!1,te,$);bt&&(le.horizontal[Rt]=bt),Gt(),Mf(ke)&&R&&F&&(le.vertical=dE(ue,h.glyphMap,h.glyphPositions,h.imagePositions,X,Qt,S,It,Rt,ht,Le,i.az.vertical,!1,te,$))}}let ye=!1;if(H.icon&&H.icon.name){let ke=h.imageMap[H.icon.name];ke&&(me=ufe(h.imagePositions[H.icon.name],p.get(\"icon-offset\").evaluate(H,{},h.canonical),p.get(\"icon-anchor\").evaluate(H,{},h.canonical)),ye=!!ke.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=ye:h.bucket.sdfIcons!==ye&&yi(\"Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer\"),(ke.pixelRatio!==h.bucket.pixelRatio||p.get(\"icon-rotate\").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}let we=MV(le.horizontal)||le.vertical;(a=h.bucket).iconsInText||(a.iconsInText=!!we&&we.iconsInText),(we||me)&&$fe(h.bucket,H,le,me,h.imageMap,E,te,oe,Le,ye,h.canonical,h.subdivisionGranularity)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},i.cS=H5,i.cT=j5,i.cU=X5,i.cV=function(h){let a=new fE;return(function(u,p){for(let v in u.layers)p.writeMessage(3,zfe,u.layers[v])})(h,a),a.finish()},i.cW=function(h,a,u,p,v,E){let S=gV(h,a,u,v,0);return S=gV(S,a,p,E,1),S},i.cX=class{constructor(h){this.maxEntries=h,this.map=new Map}get(h){let a=this.map.get(h);return a!==void 0&&(this.map.delete(h),this.map.set(h,a)),a}set(h,a){if(this.map.has(h))this.map.delete(h);else if(this.map.size>=this.maxEntries){let u=this.map.keys().next().value;this.map.delete(u)}this.map.set(h,a)}clear(){this.map.clear()}},i.cY=J7,i.cZ=fE,i.c_=hV,i.ca=class extends Pu{},i.cb=Ghe,i.cc=class extends Kd{},i.cd=N5,i.ce=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},i.cf=k7,i.cg=function(h,a,u){var p=a[0],v=a[1],E=a[2],S=u[3]*p+u[7]*v+u[11]*E+u[15];return h[0]=(u[0]*p+u[4]*v+u[8]*E+u[12])/(S=S||1),h[1]=(u[1]*p+u[5]*v+u[9]*E+u[13])/S,h[2]=(u[2]*p+u[6]*v+u[10]*E+u[14])/S,h},i.ch=class extends Bf{},i.ci=class extends l{},i.cj=function(h,a){return h[0]===a[0]&&h[1]===a[1]&&h[2]===a[2]&&h[3]===a[3]&&h[4]===a[4]&&h[5]===a[5]&&h[6]===a[6]&&h[7]===a[7]&&h[8]===a[8]&&h[9]===a[9]&&h[10]===a[10]&&h[11]===a[11]&&h[12]===a[12]&&h[13]===a[13]&&h[14]===a[14]&&h[15]===a[15]},i.ck=function(h,a){var u=h[0],p=h[1],v=h[2],E=h[3],S=h[4],R=h[5],F=h[6],U=h[7],H=h[8],X=h[9],$=h[10],te=h[11],oe=h[12],le=h[13],ue=h[14],me=h[15],Le=a[0],ye=a[1],we=a[2],ke=a[3],je=a[4],ht=a[5],It=a[6],wt=a[7],Rt=a[8],Qt=a[9],Gt=a[10],bt=a[11],_t=a[12],cn=a[13],nn=a[14],An=a[15];return Math.abs(u-Le)<=K*Math.max(1,Math.abs(u),Math.abs(Le))&&Math.abs(p-ye)<=K*Math.max(1,Math.abs(p),Math.abs(ye))&&Math.abs(v-we)<=K*Math.max(1,Math.abs(v),Math.abs(we))&&Math.abs(E-ke)<=K*Math.max(1,Math.abs(E),Math.abs(ke))&&Math.abs(S-je)<=K*Math.max(1,Math.abs(S),Math.abs(je))&&Math.abs(R-ht)<=K*Math.max(1,Math.abs(R),Math.abs(ht))&&Math.abs(F-It)<=K*Math.max(1,Math.abs(F),Math.abs(It))&&Math.abs(U-wt)<=K*Math.max(1,Math.abs(U),Math.abs(wt))&&Math.abs(H-Rt)<=K*Math.max(1,Math.abs(H),Math.abs(Rt))&&Math.abs(X-Qt)<=K*Math.max(1,Math.abs(X),Math.abs(Qt))&&Math.abs($-Gt)<=K*Math.max(1,Math.abs($),Math.abs(Gt))&&Math.abs(te-bt)<=K*Math.max(1,Math.abs(te),Math.abs(bt))&&Math.abs(oe-_t)<=K*Math.max(1,Math.abs(oe),Math.abs(_t))&&Math.abs(le-cn)<=K*Math.max(1,Math.abs(le),Math.abs(cn))&&Math.abs(ue-nn)<=K*Math.max(1,Math.abs(ue),Math.abs(nn))&&Math.abs(me-An)<=K*Math.max(1,Math.abs(me),Math.abs(An))},i.cl=function(h,a){return h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3],h[4]=a[4],h[5]=a[5],h[6]=a[6],h[7]=a[7],h[8]=a[8],h[9]=a[9],h[10]=a[10],h[11]=a[11],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15],h},i.cm=h=>h.type===\"symbol\",i.cn=h=>h.type===\"circle\",i.co=h=>h.type===\"heatmap\",i.cp=h=>h.type===\"line\",i.cq=h=>h.type===\"fill\",i.cr=h=>h.type===\"fill-extrusion\",i.cs=h=>h.type===\"hillshade\",i.ct=h=>h.type===\"color-relief\",i.cu=h=>h.type===\"background\",i.cv=h=>h.type===\"custom\",i.cw=tr,i.cx=function(h,a,u){if(a<=0)return h;let p=1/a;return u===void 0||Math.abs(u)<1e-10?Math.round(h*p)/p:(u>0?Math.ceil(h*p-1e-9):Math.floor(h*p+1e-10))/p},i.cy=function(h,a,u){let p=Mn(a.x-u.x,a.y-u.y),v=Mn(h.x-u.x,h.y-u.y);var E,S;return Fr(Math.atan2(p[0]*v[1]-p[1]*v[0],(E=p)[0]*(S=v)[0]+E[1]*S[1]))},i.cz=on,i.d=tt,i.d0=function(h,a,u,p,v){return o(this,void 0,void 0,(function*(){if(q())try{return yield Ys(h,a,u,p,v)}catch{}return(function(E,S,R,F,U){let H=E.width,X=E.height;Hi&&us||(Hi=new OffscreenCanvas(H,X),us=Hi.getContext(\"2d\",{willReadFrequently:!0})),Hi.width=H,Hi.height=X,us.drawImage(E,0,0,H,X);let $=us.getImageData(S,R,F,U);return us.clearRect(0,0,H,X),$.data})(h,a,u,p,v)}))},i.d1=U7,i.d2=c,i.d3=class{constructor(h,a){this.layers={[Hx]:this},this.name=Hx,this.version=a?a.version:1,this.extent=a?a.extent:4096,this.length=h.length,this.features=h}feature(h){return new Nfe(this.features[h],this.extent)}},i.d4=vf,i.d5=Iu,i.e=Fn,i.f=h=>o(void 0,void 0,void 0,(function*(){if(h.byteLength===0)return createImageBitmap(new ImageData(1,1));let a=new Blob([new Uint8Array(h)],{type:\"image/png\"});try{return createImageBitmap(a)}catch(u){throw new Error(`Could not load image because of ${u.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),i.g=he,i.h=h=>new Promise(((a,u)=>{let p=new Image;p.onload=()=>{a(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame((()=>{p.src=Xs}))},p.onerror=()=>u(new Error(\"Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.\"));let v=new Blob([new Uint8Array(h)],{type:\"image/png\"});p.src=h.byteLength?URL.createObjectURL(v):Xs})),i.i=co,i.j=(h,a)=>ot(Fn(h,{type:\"json\"}),a),i.k=vt,i.l=Dt,i.m=ot,i.n=(h,a)=>ot(Fn(h,{type:\"arrayBuffer\"}),a),i.o=function(h){return new fE(h).readFields(nfe,[])},i.p=AU,i.q=function(h){return/[\\u02EA\\u02EB\\u1100-\\u11FF\\u2E80-\\u2FDF\\u3000-\\u30FF\\u3105-\\u312F\\u3131-\\u318E\\u31A0-\\u4DBF\\u4E00-\\uA48C\\uA490-\\uA4C6\\uA960-\\uA97C\\uAC00-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFE10-\\uFE1F\\uFE30-\\uFE4F\\uFF00-\\uFFEF]|\\uD81B[\\uDFE0-\\uDFFF]|[\\uD81C-\\uD822\\uD840-\\uD868\\uD86A-\\uD86D\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883\\uD885-\\uD88C][\\uDC00-\\uDFFF]|\\uD823[\\uDC00-\\uDCD5\\uDCFF-\\uDD1E\\uDD80-\\uDDF2]|\\uD82B[\\uDFF0-\\uDFFF]|\\uD82C[\\uDC00-\\uDEFB]|\\uD83C[\\uDE00-\\uDEFF]|\\uD869[\\uDC00-\\uDEDF\\uDF00-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEAD\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0\\uDFF0-\\uDFFF]|\\uD87B[\\uDC00-\\uDE5D]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A\\uDF50-\\uDFFF]|\\uD88D[\\uDC00-\\uDC79]/gim.test(String.fromCodePoint(h))},i.r=Ix,i.s=Zr,i.t=qs,i.u=Ke,i.v=Nd,i.w=yi,i.x=Rf,i.y=ts,i.z=Hd})),n(\"worker\",[\"./shared\"],(function(i){\"use strict\";class o{constructor(ae,he){this.keyCache={},ae&&this.replace(ae,he)}replace(ae,he){this._layerConfigs={},this._layers={},this.update(ae,[],he)}update(ae,he,pe){for(let He of ae){this._layerConfigs[He.id]=He;let ot=this._layers[He.id]=i.bT(He,pe);ot._featureFilter=i.aj(ot.filter,pe),this.keyCache[He.id]&&delete this.keyCache[He.id]}for(let He of he)delete this.keyCache[He],delete this._layerConfigs[He],delete this._layers[He];this.familiesBySource={};let ze=i.cM(Object.values(this._layerConfigs),this.keyCache);for(let He of ze){let ot=He.map((Vt=>this._layers[Vt.id])),tt=ot[0];if(tt.isHidden())continue;let Je=tt.source||\"\",nt=this.familiesBySource[Je];nt||(nt=this.familiesBySource[Je]={});let Dt=tt.sourceLayer||i.ai,vt=nt[Dt];vt||(vt=nt[Dt]=[]),vt.push(ot)}}}class s{constructor(ae){let he={},pe=[];for(let tt in ae){let Je=ae[tt],nt=he[tt]={};for(let Dt in Je){let vt=Je[+Dt];if(!vt||vt.bitmap.width===0||vt.bitmap.height===0)continue;let Vt={x:0,y:0,w:vt.bitmap.width+2,h:vt.bitmap.height+2};pe.push(Vt),nt[Dt]={rect:Vt,metrics:vt.metrics}}}let{w:ze,h:He}=i.p(pe),ot=new i.r({width:ze||1,height:He||1});for(let tt in ae){let Je=ae[tt];for(let nt in Je){let Dt=Je[+nt];if(!Dt||Dt.bitmap.width===0||Dt.bitmap.height===0)continue;let vt=he[tt][nt].rect;i.r.copy(Dt.bitmap,ot,{x:0,y:0},{x:vt.x+1,y:vt.y+1},Dt.bitmap)}}this.image=ot,this.positions=he}}i.cN(\"GlyphAtlas\",s);class c{constructor(ae){this.tileID=new i.a2(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.uid=ae.uid,this.zoom=ae.zoom,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ae.showCollisionBoxes,this.collectResourceTiming=!!ae.collectResourceTiming,this.returnDependencies=!!ae.returnDependencies,this.promoteId=ae.promoteId,this.inFlightDependencies=[]}parse(ae,he,pe,ze,He){return i._(this,void 0,void 0,(function*(){this.status=\"parsing\",this.data=ae,this.collisionBoxArray=new i.ag;let ot=new i.cO(Object.keys(ae.layers).sort()),tt=new i.cP(this.tileID,this.promoteId);tt.bucketLayerIDs=[];let Je={},nt={featureIndex:tt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:pe,subdivisionGranularity:He},Dt=he.familiesBySource[this.source];for(let Lt in Dt){let Ai=ae.layers[Lt];if(!Ai)continue;Ai.version===1&&i.w(`Vector tile source \"${this.source}\" layer \"${Lt}\" does not use vector tile spec v2 and therefore may have some rendering errors.`);let Vo=ot.encode(Lt),Es=[];for(let qr=0;qr<Ai.length;qr++){let Yt=Ai.feature(qr),kn=tt.getId(Yt,Lt);Es.push({feature:Yt,id:kn,index:qr,sourceLayerIndex:Vo})}for(let qr of Dt[Lt]){let Yt=qr[0];Yt.source!==this.source&&i.w(`layer.source = ${Yt.source} does not equal this.source = ${this.source}`),Yt.isHidden(this.zoom,!0)||(d(qr,this.zoom,pe),(Je[Yt.id]=Yt.createBucket({index:tt.bucketLayerIDs.length,layers:qr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Vo,sourceID:this.source})).populate(Es,nt,this.tileID.canonical),tt.bucketLayerIDs.push(qr.map((kn=>kn.id))))}}let vt=i.bY(nt.glyphDependencies,(Lt=>Object.keys(Lt).map(Number)));this.inFlightDependencies.forEach((Lt=>Lt?.abort())),this.inFlightDependencies=[];let Vt=Promise.resolve({});if(Object.keys(vt).length){let Lt=new AbortController;this.inFlightDependencies.push(Lt),Vt=ze.sendAsync({type:\"GG\",data:{stacks:vt,source:this.source,tileID:this.tileID,type:\"glyphs\"}},Lt)}let Ke=Object.keys(nt.iconDependencies),zn=Promise.resolve({});if(Ke.length){let Lt=new AbortController;this.inFlightDependencies.push(Lt),zn=ze.sendAsync({type:\"GI\",data:{icons:Ke,source:this.source,tileID:this.tileID,type:\"icons\"}},Lt)}let Wr=Object.keys(nt.patternDependencies),fn=Promise.resolve({});if(Wr.length){let Lt=new AbortController;this.inFlightDependencies.push(Lt),fn=ze.sendAsync({type:\"GI\",data:{icons:Wr,source:this.source,tileID:this.tileID,type:\"patterns\"}},Lt)}let ln=nt.dashDependencies,Nn=Promise.resolve({});if(Object.keys(ln).length){let Lt=new AbortController;this.inFlightDependencies.push(Lt),Nn=ze.sendAsync({type:\"GDA\",data:{dashes:ln}},Lt)}let[Ir,Et,di,pi]=yield Promise.all([Vt,zn,fn,Nn]),ti=new s(Ir),Wi=new i.cQ(Et,di);for(let Lt in Je){let Ai=Je[Lt];Ai instanceof i.ah?(d(Ai.layers,this.zoom,pe),i.cR({bucket:Ai,glyphMap:Ir,glyphPositions:ti.positions,imageMap:Et,imagePositions:Wi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:nt.subdivisionGranularity})):Ai.hasDependencies&&(Ai instanceof i.cS||Ai instanceof i.cT||Ai instanceof i.cU)&&(d(Ai.layers,this.zoom,pe),Ai.addFeatures(nt,this.tileID.canonical,Wi.patternPositions,pi))}return this.status=\"done\",{buckets:Object.values(Je).filter((Lt=>!Lt.isEmpty())),featureIndex:tt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ti.image,imageAtlas:Wi,dashPositions:pi,glyphMap:this.returnDependencies?Ir:null,iconMap:this.returnDependencies?Et:null,glyphPositions:this.returnDependencies?ti.positions:null}}))}}function d(Ze,ae,he){let pe=new i.H(ae);for(let ze of Ze)ze.recalculate(pe,he)}class m{constructor(ae,he,pe,ze,He){this.type=ae,this.properties=pe||{},this.extent=He,this.pointsArray=he,this.id=ze}loadGeometry(){return this.pointsArray.map((ae=>ae.map((he=>new i.P(he.x,he.y)))))}}class b{constructor(ae,he,pe){this.version=2,this._myFeatures=ae,this.name=he,this.length=ae.length,this.extent=pe}feature(ae){return this._myFeatures[ae]}}class C{constructor(){this.layers={}}addLayer(ae){this.layers[ae.name]=ae}}function B(Ze){let ae=i.cV(Ze);return ae.byteOffset===0&&ae.byteLength===ae.buffer.byteLength||(ae=new Uint8Array(ae)),{vectorTile:Ze,rawData:ae.buffer}}function k(Ze,ae,he){let{extent:pe}=Ze,ze=Math.pow(2,he.z-ae.z),He=(he.x-ae.x*ze)*pe,ot=(he.y-ae.y*ze)*pe,tt=[];for(let Je=0;Je<Ze.length;Je++){let nt=Ze.feature(Je),Dt=nt.loadGeometry();for(let Vt of Dt)for(let Ke of Vt)Ke.x=Ke.x*ze-He,Ke.y=Ke.y*ze-ot;let vt=128;Dt=i.cW(Dt,nt.type,-vt,-vt,pe+vt,pe+vt),Dt.length!==0&&tt.push(new m(nt.type,Dt,nt.properties,nt.id,pe))}return new b(tt,Ze.name,pe)}class V{constructor(ae,he,pe){this.actor=ae,this.layerIndex=he,this.availableImages=pe,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new i.cX(1e3)}loadVectorTile(ae,he){return i._(this,void 0,void 0,(function*(){let pe=yield i.n(ae.request,he);try{return{vectorTile:ae.encoding!==\"mlt\"?new i.cY(new i.cZ(pe.data)):new i.c_(pe.data),rawData:pe.data,cacheControl:pe.cacheControl,expires:pe.expires}}catch(ze){let He=new Uint8Array(pe.data),ot=`Unable to parse the tile at ${ae.request.url}, `;throw ot+=He[0]===31&&He[1]===139?\"please make sure the data is not gzipped and that you have configured the relevant header in the server\":`got error: ${ze.message}`,new Error(ot)}}))}loadTile(ae){return i._(this,void 0,void 0,(function*(){let{uid:he,overzoomParameters:pe}=ae;pe&&(ae.request=pe.overzoomRequest);let ze=!!(ae&&ae.request&&ae.request.collectResourceTiming)&&new i.c$(ae.request),He=new c(ae);this.loading[he]=He;let ot=new AbortController;He.abort=ot;try{let tt=yield this.loadVectorTile(ae,ot);if(delete this.loading[he],!tt)return null;if(pe){let Vt=this._getOverzoomTile(ae,tt.vectorTile);tt.rawData=Vt.rawData,tt.vectorTile=Vt.vectorTile}let Je=tt.rawData,nt={};tt.expires&&(nt.expires=tt.expires),tt.cacheControl&&(nt.cacheControl=tt.cacheControl);let Dt={};if(ze){let Vt=ze.finish();Vt&&(Dt.resourceTiming=JSON.parse(JSON.stringify(Vt)))}He.vectorTile=tt.vectorTile;let vt=He.parse(tt.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity);this.loaded[he]=He,this.fetching[he]={rawTileData:Je,cacheControl:nt,resourceTiming:Dt};try{let Vt=yield vt;return i.e({rawTileData:Je.slice(0),encoding:ae.encoding},Vt,nt,Dt)}finally{delete this.fetching[he]}}catch(tt){throw delete this.loading[he],He.status=\"done\",this.loaded[he]=He,tt}}))}_getOverzoomTile(ae,he){let{tileID:pe,source:ze,overzoomParameters:He}=ae,{maxZoomTileID:ot}=He,tt=`${ot.key}_${pe.key}`,Je=this.overzoomedTileResultCache.get(tt);if(Je)return Je;let nt=new C,Dt=this.layerIndex.familiesBySource[ze];for(let Vt in Dt){let Ke=he.layers[Vt];if(!Ke)continue;let zn=k(Ke,ot,pe.canonical);zn.length>0&&nt.addLayer(zn)}let vt=B(nt);return this.overzoomedTileResultCache.set(tt,vt),vt}reloadTile(ae){return i._(this,void 0,void 0,(function*(){let he=ae.uid;if(!this.loaded||!this.loaded[he])throw new Error(\"Should not be trying to reload a tile that was never loaded or has been removed\");let pe=this.loaded[he];if(pe.showCollisionBoxes=ae.showCollisionBoxes,pe.status===\"parsing\"){let ze=yield pe.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity),He;if(this.fetching[he]){let{rawTileData:ot,cacheControl:tt,resourceTiming:Je}=this.fetching[he];delete this.fetching[he],He=i.e({rawTileData:ot.slice(0),encoding:ae.encoding},ze,tt,Je)}else He=ze;return He}if(pe.status===\"done\"&&pe.vectorTile)return pe.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity)}))}abortTile(ae){return i._(this,void 0,void 0,(function*(){let he=this.loading,pe=ae.uid;he&&he[pe]&&he[pe].abort&&(he[pe].abort.abort(),delete he[pe])}))}removeTile(ae){return i._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[ae.uid]&&delete this.loaded[ae.uid]}))}}class q{constructor(){this.loaded={}}loadTile(ae){return i._(this,void 0,void 0,(function*(){let{uid:he,encoding:pe,rawImageData:ze,redFactor:He,greenFactor:ot,blueFactor:tt,baseShift:Je}=ae,nt=ze.width+2,Dt=ze.height+2,vt=i.b(ze)?new i.R({width:nt,height:Dt},yield i.d0(ze,-1,-1,nt,Dt)):ze,Vt=new i.d1(he,vt,pe,He,ot,tt,Je);return this.loaded=this.loaded||{},this.loaded[he]=Vt,Vt}))}removeTile(ae){let he=this.loaded,pe=ae.uid;he&&he[pe]&&delete he[pe]}}var K,Y,ee=(function(){if(Y)return K;function Ze(he,pe){if(he.length!==0){ae(he[0],pe);for(var ze=1;ze<he.length;ze++)ae(he[ze],!pe)}}function ae(he,pe){for(var ze=0,He=0,ot=0,tt=he.length,Je=tt-1;ot<tt;Je=ot++){var nt=(he[ot][0]-he[Je][0])*(he[Je][1]+he[ot][1]),Dt=ze+nt;He+=Math.abs(ze)>=Math.abs(nt)?ze-Dt+nt:nt-Dt+ze,ze=Dt}ze+He>=0!=!!pe&&he.reverse()}return Y=1,K=function he(pe,ze){var He,ot=pe&&pe.type;if(ot===\"FeatureCollection\")for(He=0;He<pe.features.length;He++)he(pe.features[He],ze);else if(ot===\"GeometryCollection\")for(He=0;He<pe.geometries.length;He++)he(pe.geometries[He],ze);else if(ot===\"Feature\")he(pe.geometry,ze);else if(ot===\"Polygon\")Ze(pe.coordinates,ze);else if(ot===\"MultiPolygon\")for(He=0;He<pe.coordinates.length;He++)Ze(pe.coordinates[He],ze);return pe}})(),J=i.d2(ee);let se={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ze=>Ze},xe=Math.fround||(Ee=new Float32Array(1),Ze=>(Ee[0]=+Ze,Ee[0]));var Ee;class Xe{constructor(ae){this.options=Object.assign(Object.create(se),ae),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ae){let{log:he,minZoom:pe,maxZoom:ze}=this.options;he&&console.time(\"total time\");let He=`prepare ${ae.length} points`;he&&console.time(He),this.points=ae;let ot=[];for(let Je=0;Je<ae.length;Je++){let nt=ae[Je];if(!nt.geometry)continue;let[Dt,vt]=nt.geometry.coordinates,Vt=xe(ge(Dt)),Ke=xe(Qe(vt));ot.push(Vt,Ke,1/0,Je,-1,1),this.options.reduce&&ot.push(0)}let tt=this.trees[ze+1]=this._createTree(ot);he&&console.timeEnd(He);for(let Je=ze;Je>=pe;Je--){let nt=+Date.now();tt=this.trees[Je]=this._createTree(this._cluster(tt,Je)),he&&console.log(\"z%d: %d clusters in %dms\",Je,tt.numItems,+Date.now()-nt)}return he&&console.timeEnd(\"total time\"),this}getClusters(ae,he){let pe=((ae[0]+180)%360+360)%360-180,ze=Math.max(-90,Math.min(90,ae[1])),He=ae[2]===180?180:((ae[2]+180)%360+360)%360-180,ot=Math.max(-90,Math.min(90,ae[3]));if(ae[2]-ae[0]>=360)pe=-180,He=180;else if(pe>He){let vt=this.getClusters([pe,ze,180,ot],he),Vt=this.getClusters([-180,ze,He,ot],he);return vt.concat(Vt)}let tt=this.trees[this._limitZoom(he)],Je=tt.range(ge(pe),Qe(ot),ge(He),Qe(ze)),nt=tt.data,Dt=[];for(let vt of Je){let Vt=this.stride*vt;Dt.push(nt[Vt+5]>1?Ne(nt,Vt,this.clusterProps):this.points[nt[Vt+3]])}return Dt}getChildren(ae){let he=this._getOriginId(ae),pe=this._getOriginZoom(ae),ze=\"No cluster with the specified id.\",He=this.trees[pe];if(!He)throw new Error(ze);let ot=He.data;if(he*this.stride>=ot.length)throw new Error(ze);let tt=this.options.radius/(this.options.extent*Math.pow(2,pe-1)),Je=He.within(ot[he*this.stride],ot[he*this.stride+1],tt),nt=[];for(let Dt of Je){let vt=Dt*this.stride;ot[vt+4]===ae&&nt.push(ot[vt+5]>1?Ne(ot,vt,this.clusterProps):this.points[ot[vt+3]])}if(nt.length===0)throw new Error(ze);return nt}getLeaves(ae,he,pe){let ze=[];return this._appendLeaves(ze,ae,he=he||10,pe=pe||0,0),ze}getTile(ae,he,pe){let ze=this.trees[this._limitZoom(ae)],He=Math.pow(2,ae),{extent:ot,radius:tt}=this.options,Je=tt/ot,nt=(pe-Je)/He,Dt=(pe+1+Je)/He,vt={features:[]};return this._addTileFeatures(ze.range((he-Je)/He,nt,(he+1+Je)/He,Dt),ze.data,he,pe,He,vt),he===0&&this._addTileFeatures(ze.range(1-Je/He,nt,1,Dt),ze.data,He,pe,He,vt),he===He-1&&this._addTileFeatures(ze.range(0,nt,Je/He,Dt),ze.data,-1,pe,He,vt),vt.features.length?vt:null}getClusterExpansionZoom(ae){let he=this._getOriginZoom(ae)-1;for(;he<=this.options.maxZoom;){let pe=this.getChildren(ae);if(he++,pe.length!==1)break;ae=pe[0].properties.cluster_id}return he}_appendLeaves(ae,he,pe,ze,He){let ot=this.getChildren(he);for(let tt of ot){let Je=tt.properties;if(Je&&Je.cluster?He+Je.point_count<=ze?He+=Je.point_count:He=this._appendLeaves(ae,Je.cluster_id,pe,ze,He):He<ze?He++:ae.push(tt),ae.length===pe)break}return He}_createTree(ae){let he=new i.aT(ae.length/this.stride|0,this.options.nodeSize,Float32Array);for(let pe=0;pe<ae.length;pe+=this.stride)he.add(ae[pe],ae[pe+1]);return he.finish(),he.data=ae,he}_addTileFeatures(ae,he,pe,ze,He,ot){for(let tt of ae){let Je=tt*this.stride,nt=he[Je+5]>1,Dt,vt,Vt;if(nt)Dt=be(he,Je,this.clusterProps),vt=he[Je],Vt=he[Je+1];else{let Wr=this.points[he[Je+3]];Dt=Wr.properties;let[fn,ln]=Wr.geometry.coordinates;vt=ge(fn),Vt=Qe(ln)}let Ke={type:1,geometry:[[Math.round(this.options.extent*(vt*He-pe)),Math.round(this.options.extent*(Vt*He-ze))]],tags:Dt},zn;zn=nt||this.options.generateId?he[Je+3]:this.points[he[Je+3]].id,zn!==void 0&&(Ke.id=zn),ot.features.push(Ke)}}_limitZoom(ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+ae),this.options.maxZoom+1))}_cluster(ae,he){let{radius:pe,extent:ze,reduce:He,minPoints:ot}=this.options,tt=pe/(ze*Math.pow(2,he)),Je=ae.data,nt=[],Dt=this.stride;for(let vt=0;vt<Je.length;vt+=Dt){if(Je[vt+2]<=he)continue;Je[vt+2]=he;let Vt=Je[vt],Ke=Je[vt+1],zn=ae.within(Je[vt],Je[vt+1],tt),Wr=Je[vt+5],fn=Wr;for(let ln of zn){let Nn=ln*Dt;Je[Nn+2]>he&&(fn+=Je[Nn+5])}if(fn>Wr&&fn>=ot){let ln,Nn=Vt*Wr,Ir=Ke*Wr,Et=-1,di=(vt/Dt<<5)+(he+1)+this.points.length;for(let pi of zn){let ti=pi*Dt;if(Je[ti+2]<=he)continue;Je[ti+2]=he;let Wi=Je[ti+5];Nn+=Je[ti]*Wi,Ir+=Je[ti+1]*Wi,Je[ti+4]=di,He&&(ln||(ln=this._map(Je,vt,!0),Et=this.clusterProps.length,this.clusterProps.push(ln)),He(ln,this._map(Je,ti)))}Je[vt+4]=di,nt.push(Nn/fn,Ir/fn,1/0,di,-1,fn),He&&nt.push(Et)}else{for(let ln=0;ln<Dt;ln++)nt.push(Je[vt+ln]);if(fn>1)for(let ln of zn){let Nn=ln*Dt;if(!(Je[Nn+2]<=he)){Je[Nn+2]=he;for(let Ir=0;Ir<Dt;Ir++)nt.push(Je[Nn+Ir])}}}}return nt}_getOriginId(ae){return ae-this.points.length>>5}_getOriginZoom(ae){return(ae-this.points.length)%32}_map(ae,he,pe){if(ae[he+5]>1){let ot=this.clusterProps[ae[he+6]];return pe?Object.assign({},ot):ot}let ze=this.points[ae[he+3]].properties,He=this.options.map(ze);return pe&&He===ze?Object.assign({},He):He}}function Ne(Ze,ae,he){return{type:\"Feature\",id:Ze[ae+3],properties:be(Ze,ae,he),geometry:{type:\"Point\",coordinates:[(pe=Ze[ae],360*(pe-.5)),Ct(Ze[ae+1])]}};var pe}function be(Ze,ae,he){let pe=Ze[ae+5],ze=pe>=1e4?`${Math.round(pe/1e3)}k`:pe>=1e3?Math.round(pe/100)/10+\"k\":pe,He=Ze[ae+6],ot=He===-1?{}:Object.assign({},he[He]);return Object.assign(ot,{cluster:!0,cluster_id:Ze[ae+3],point_count:pe,point_count_abbreviated:ze})}function ge(Ze){return Ze/360+.5}function Qe(Ze){let ae=Math.sin(Ze*Math.PI/180),he=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return he<0?0:he>1?1:he}function Ct(Ze){let ae=(180-360*Ze)*Math.PI/180;return 360*Math.atan(Math.exp(ae))/Math.PI-90}function Mt(Ze,ae,he,pe){let ze=pe,He=ae+(he-ae>>1),ot,tt=he-ae,Je=Ze[ae],nt=Ze[ae+1],Dt=Ze[he],vt=Ze[he+1];for(let Vt=ae+3;Vt<he;Vt+=3){let Ke=mt(Ze[Vt],Ze[Vt+1],Je,nt,Dt,vt);if(Ke>ze)ot=Vt,ze=Ke;else if(Ke===ze){let zn=Math.abs(Vt-He);zn<tt&&(ot=Vt,tt=zn)}}ze>pe&&(ot-ae>3&&Mt(Ze,ae,ot,pe),Ze[ot+2]=ze,he-ot>3&&Mt(Ze,ot,he,pe))}function mt(Ze,ae,he,pe,ze,He){let ot=ze-he,tt=He-pe;if(ot!==0||tt!==0){let Je=((Ze-he)*ot+(ae-pe)*tt)/(ot*ot+tt*tt);Je>1?(he=ze,pe=He):Je>0&&(he+=ot*Je,pe+=tt*Je)}return ot=Ze-he,tt=ae-pe,ot*ot+tt*tt}function jt(Ze,ae,he,pe){let ze={type:ae,geom:he},He={id:Ze??null,type:ze.type,geometry:ze.geom,tags:pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};switch(ze.type){case\"Point\":case\"MultiPoint\":case\"LineString\":Mn(He,ze.geom);break;case\"Polygon\":Mn(He,ze.geom[0]);break;case\"MultiLineString\":for(let ot of ze.geom)Mn(He,ot);break;case\"MultiPolygon\":for(let ot of ze.geom)Mn(He,ot[0])}return He}function Mn(Ze,ae){for(let he=0;he<ae.length;he+=3)Ze.minX=Math.min(Ze.minX,ae[he]),Ze.minY=Math.min(Ze.minY,ae[he+1]),Ze.maxX=Math.max(Ze.maxX,ae[he]),Ze.maxY=Math.max(Ze.maxY,ae[he+1])}function rn(Ze,ae){let he=[];switch(Ze.type){case\"FeatureCollection\":for(let pe=0;pe<Ze.features.length;pe++)In(he,Ze.features[pe],ae,pe);break;case\"Feature\":In(he,Ze,ae);break;default:In(he,{geometry:Ze,properties:void 0},ae)}return he}function In(Ze,ae,he,pe){if(!ae.geometry)return;if(ae.geometry.type===\"GeometryCollection\"){for(let tt of ae.geometry.geometries)In(Ze,{id:ae.id,geometry:tt,properties:ae.properties},he,pe);return}if(!ae.geometry.coordinates?.length)return;let He=Math.pow(he.tolerance/((1<<he.maxZoom)*he.extent),2),ot=ae.id;switch(he.promoteId?ot=ae.properties?.[he.promoteId]:he.generateId&&(ot=pe||0),ae.geometry.type){case\"Point\":{let tt=[];return On(ae.geometry.coordinates,tt),void Ze.push(jt(ot,ae.geometry.type,tt,ae.properties))}case\"MultiPoint\":{let tt=[];for(let Je of ae.geometry.coordinates)On(Je,tt);return void Ze.push(jt(ot,ae.geometry.type,tt,ae.properties))}case\"LineString\":{let tt=[];return Pn(ae.geometry.coordinates,tt,He,!1),void Ze.push(jt(ot,ae.geometry.type,tt,ae.properties))}case\"MultiLineString\":{if(he.lineMetrics){for(let Je of ae.geometry.coordinates){let nt=[];Pn(Je,nt,He,!1),Ze.push(jt(ot,\"LineString\",nt,ae.properties))}return}let tt=[];return _n(ae.geometry.coordinates,tt,He,!1),void Ze.push(jt(ot,ae.geometry.type,tt,ae.properties))}case\"Polygon\":{let tt=[];return _n(ae.geometry.coordinates,tt,He,!0),void Ze.push(jt(ot,ae.geometry.type,tt,ae.properties))}case\"MultiPolygon\":{let tt=[];for(let Je of ae.geometry.coordinates){let nt=[];_n(Je,nt,He,!0),tt.push(nt)}return void Ze.push(jt(ot,ae.geometry.type,tt,ae.properties))}default:throw new Error(\"Input data is not a valid GeoJSON object.\")}}function On(Ze,ae){ae.push(tr(Ze[0]),on(Ze[1]),0)}function Pn(Ze,ae,he,pe){let ze,He,ot=0;for(let Je=0;Je<Ze.length;Je++){let nt=tr(Ze[Je][0]),Dt=on(Ze[Je][1]);ae.push(nt,Dt,0),Je>0&&(ot+=pe?(ze*Dt-nt*He)/2:Math.sqrt(Math.pow(nt-ze,2)+Math.pow(Dt-He,2))),ze=nt,He=Dt}let tt=ae.length-3;ae[2]=1,he>0&&Mt(ae,0,tt,he),ae[tt+2]=1,ae.size=Math.abs(ot),ae.start=0,ae.end=ae.size}function _n(Ze,ae,he,pe){for(let ze=0;ze<Ze.length;ze++){let He=[];Pn(Ze[ze],He,he,pe),ae.push(He)}}function tr(Ze){return Ze/360+.5}function on(Ze){let ae=Math.sin(Ze*Math.PI/180),he=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return he<0?0:he>1?1:he}function Pt(Ze,ae,he,pe,ze,He,ot,tt){if(pe/=ae,He>=(he/=ae)&&ot<pe)return Ze;if(ot<he||He>=pe)return null;let Je=[];for(let nt of Ze){let Dt=ze===0?nt.minX:nt.minY,vt=ze===0?nt.maxX:nt.maxY;if(Dt>=he&&vt<pe)Je.push(nt);else if(!(vt<he||Dt>=pe))switch(nt.type){case\"Point\":case\"MultiPoint\":{let Vt=[];if(Mr(nt.geometry,Vt,he,pe,ze),!Vt.length)continue;Je.push(jt(nt.id,Vt.length===3?\"Point\":\"MultiPoint\",Vt,nt.tags));continue}case\"LineString\":{let Vt=[];if(Fn(nt.geometry,Vt,he,pe,ze,!1,tt.lineMetrics),!Vt.length)continue;if(tt.lineMetrics){for(let Ke of Vt)Je.push(jt(nt.id,nt.type,Ke,nt.tags));continue}if(Vt.length>1){Je.push(jt(nt.id,\"MultiLineString\",Vt,nt.tags));continue}Je.push(jt(nt.id,nt.type,Vt[0],nt.tags));continue}case\"MultiLineString\":{let Vt=[];if(nr(nt.geometry,Vt,he,pe,ze,!1),!Vt.length)continue;if(Vt.length===1){Je.push(jt(nt.id,\"LineString\",Vt[0],nt.tags));continue}Je.push(jt(nt.id,nt.type,Vt,nt.tags));continue}case\"Polygon\":{let Vt=[];if(nr(nt.geometry,Vt,he,pe,ze,!0),!Vt.length)continue;Je.push(jt(nt.id,nt.type,Vt,nt.tags));continue}case\"MultiPolygon\":{let Vt=[];for(let Ke of nt.geometry){let zn=[];nr(Ke,zn,he,pe,ze,!0),zn.length&&Vt.push(zn)}if(!Vt.length)continue;Je.push(jt(nt.id,nt.type,Vt,nt.tags));continue}}}return Je.length?Je:null}function Mr(Ze,ae,he,pe,ze){for(let He=0;He<Ze.length;He+=3){let ot=Ze[He+ze];ot>=he&&ot<=pe&&lo(ae,Ze[He],Ze[He+1],Ze[He+2])}}function Fn(Ze,ae,he,pe,ze,He,ot){let tt=Br(Ze),Je=ze===0?oi:cs,nt,Dt,vt=Ze.start;for(let fn=0;fn<Ze.length-3;fn+=3){let ln=Ze[fn],Nn=Ze[fn+1],Ir=Ze[fn+2],Et=Ze[fn+3],di=Ze[fn+4],pi=ze===0?ln:Nn,ti=ze===0?Et:di,Wi=!1;ot&&(nt=Math.sqrt(Math.pow(ln-Et,2)+Math.pow(Nn-di,2))),pi<he?ti>he&&(Dt=Je(tt,ln,Nn,Et,di,he),ot&&(tt.start=vt+nt*Dt)):pi>pe?ti<pe&&(Dt=Je(tt,ln,Nn,Et,di,pe),ot&&(tt.start=vt+nt*Dt)):lo(tt,ln,Nn,Ir),ti<he&&pi>=he&&(Dt=Je(tt,ln,Nn,Et,di,he),Wi=!0),ti>pe&&pi<=pe&&(Dt=Je(tt,ln,Nn,Et,di,pe),Wi=!0),!He&&Wi&&(ot&&(tt.end=vt+nt*Dt),ae.push(tt),tt=Br(Ze)),ot&&(vt+=nt)}let Vt=Ze.length-3,Ke=Ze[Vt],zn=Ze[Vt+1],Wr=ze===0?Ke:zn;Wr>=he&&Wr<=pe&&lo(tt,Ke,zn,Ze[Vt+2]),Vt=tt.length-3,He&&Vt>=3&&(tt[Vt]!==tt[0]||tt[Vt+1]!==tt[1])&&lo(tt,tt[0],tt[1],tt[2]),tt.length&&ae.push(tt)}function Br(Ze){let ae=[];return ae.size=Ze.size,ae.start=Ze.start,ae.end=Ze.end,ae}function nr(Ze,ae,he,pe,ze,He){for(let ot of Ze)Fn(ot,ae,he,pe,ze,He,!1)}function lo(Ze,ae,he,pe){Ze.push(ae,he,pe)}function oi(Ze,ae,he,pe,ze,He){let ot=(He-ae)/(pe-ae);return lo(Ze,He,he+(ze-he)*ot,1),ot}function cs(Ze,ae,he,pe,ze,He){let ot=(He-he)/(ze-he);return lo(Ze,ae+(pe-ae)*ot,He,1),ot}function yi(Ze,ae){let he=ae.buffer/ae.extent,pe=Ze,ze=Pt(Ze,1,-1-he,he,0,-1,2,ae),He=Pt(Ze,1,1-he,2+he,0,-1,2,ae);return(ze||He)&&(pe=Pt(Ze,1,-he,1+he,0,-1,2,ae)||[],ze&&(pe=Ro(ze,1).concat(pe)),He&&(pe=pe.concat(Ro(He,-1)))),pe}function Ro(Ze,ae){let he=[];for(let pe of Ze)switch(pe.type){case\"Point\":case\"MultiPoint\":case\"LineString\":{let ze=co(pe.geometry,ae);he.push(jt(pe.id,pe.type,ze,pe.tags));continue}case\"MultiLineString\":case\"Polygon\":{let ze=[];for(let He of pe.geometry)ze.push(co(He,ae));he.push(jt(pe.id,pe.type,ze,pe.tags));continue}case\"MultiPolygon\":{let ze=[];for(let He of pe.geometry){let ot=[];for(let tt of He)ot.push(co(tt,ae));ze.push(ot)}he.push(jt(pe.id,pe.type,ze,pe.tags));continue}}return he}function co(Ze,ae){let he=[];he.size=Ze.size,Ze.start!==void 0&&(he.start=Ze.start,he.end=Ze.end);for(let pe=0;pe<Ze.length;pe+=3)he.push(Ze[pe]+ae,Ze[pe+1],Ze[pe+2]);return he}function mr(Ze,ae){if(Ze.transformed)return Ze;let he=1<<Ze.z,pe=Ze.x,ze=Ze.y;for(let He of Ze.features){if(He.type===1){let tt=[];for(let Je=0;Je<He.geometry.length;Je+=2)tt.push(Yr(He.geometry[Je],He.geometry[Je+1],ae,he,pe,ze));He.geometry=tt;continue}let ot=[];for(let tt of He.geometry){let Je=[];for(let nt=0;nt<tt.length;nt+=2)Je.push(Yr(tt[nt],tt[nt+1],ae,he,pe,ze));ot.push(Je)}He.geometry=ot}return Ze.transformed=!0,Ze}function Yr(Ze,ae,he,pe,ze,He){return[Math.round(he*(Ze*pe-ze)),Math.round(he*(ae*pe-He))]}function Xs(Ze,ae,he,pe,ze){let He=ae===ze.maxZoom?0:ze.tolerance/((1<<ae)*ze.extent),ot={features:[],numPoints:0,numSimplified:0,numFeatures:Ze.length,source:null,x:he,y:pe,z:ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let tt of Ze)Ys(ot,tt,He,ze);return ot}function Ys(Ze,ae,he,pe){Ze.minX=Math.min(Ze.minX,ae.minX),Ze.minY=Math.min(Ze.minY,ae.minY),Ze.maxX=Math.max(Ze.maxX,ae.maxX),Ze.maxY=Math.max(Ze.maxY,ae.maxY);let ze,He=ae.tags||null;switch(ae.type){case\"Point\":case\"MultiPoint\":{let ot=[];for(let tt=0;tt<ae.geometry.length;tt+=3)ot.push(ae.geometry[tt],ae.geometry[tt+1]),Ze.numPoints++,Ze.numSimplified++;if(!ot.length)return;ze={type:1,tags:He,geometry:ot};break}case\"LineString\":{let ot=[];if(Hi(ot,ae.geometry,Ze,he,!1,!1),!ot.length)return;if(pe.lineMetrics){He={};for(let tt in ae.tags)He[tt]=ae.tags[tt];He.mapbox_clip_start=ae.geometry.start/ae.geometry.size,He.mapbox_clip_end=ae.geometry.end/ae.geometry.size}ze={type:2,tags:He,geometry:ot};break}case\"MultiLineString\":case\"Polygon\":{let ot=[];for(let tt=0;tt<ae.geometry.length;tt++)Hi(ot,ae.geometry[tt],Ze,he,ae.type===\"Polygon\",tt===0);if(!ot.length)return;ze={type:ae.type===\"Polygon\"?3:2,tags:He,geometry:ot};break}case\"MultiPolygon\":{let ot=[];for(let tt=0;tt<ae.geometry.length;tt++){let Je=ae.geometry[tt];for(let nt=0;nt<Je.length;nt++)Hi(ot,Je[nt],Ze,he,!0,nt===0)}if(!ot.length)return;ze={type:3,tags:He,geometry:ot};break}}ae.id!==null&&(ze.id=ae.id),Ze.features.push(ze)}function Hi(Ze,ae,he,pe,ze,He){let ot=pe*pe;if(pe>0&&ae.size<(ze?ot:pe))return void(he.numPoints+=ae.length/3);let tt=[];for(let Je=0;Je<ae.length;Je+=3)(pe===0||ae[Je+2]>ot)&&(he.numSimplified++,tt.push(ae[Je],ae[Je+1])),he.numPoints++;ze&&(function(Je,nt){let Dt=0;for(let vt=0,Vt=Je.length,Ke=Vt-2;vt<Vt;Ke=vt,vt+=2)Dt+=(Je[vt]-Je[Ke])*(Je[vt+1]+Je[Ke+1]);if(Dt>0===nt)for(let vt=0,Vt=Je.length;vt<Vt/2;vt+=2){let Ke=Je[vt],zn=Je[vt+1];Je[vt]=Je[Vt-2-vt],Je[vt+1]=Je[Vt-1-vt],Je[Vt-2-vt]=Ke,Je[Vt-1-vt]=zn}})(tt,He),Ze.push(tt)}function us(Ze,ae,he){let pe=!!ae.newGeometry,ze=ae.removeAllProperties||ae.removeProperties?.length>0||ae.addOrUpdateProperties?.length>0;if(pe){let He=rn({type:\"FeatureCollection\",features:[{type:\"Feature\",id:Ze.id,geometry:ae.newGeometry,properties:ze?Zr(Ze.tags,ae):Ze.tags}]},he);return He=yi(He,he),He[0]}if(ze){let He={...Ze};return He.tags=Zr(He.tags,ae),He}return null}function Zr(Ze,ae){if(ae.removeAllProperties)return{};let he={...Ze||{}};if(ae.removeProperties)for(let pe of ae.removeProperties)delete he[pe];if(ae.addOrUpdateProperties)for(let{key:pe,value:ze}of ae.addOrUpdateProperties)he[pe]=ze;return he}let Oi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,updateable:!1,debug:0};class Fr{options;tiles;tileCoords;stats={};total=0;source;constructor(ae,he){let pe=(he=this.options=Object.assign({},Oi,he)).debug;if(pe&&console.time(\"preprocess data\"),he.maxZoom<0||he.maxZoom>24)throw new Error(\"maxZoom should be in the 0-24 range\");if(he.promoteId&&he.generateId)throw new Error(\"promoteId and generateId cannot be used together.\");let ze=rn(ae,he);this.tiles={},this.tileCoords=[],pe&&(console.timeEnd(\"preprocess data\"),console.log(\"index: maxZoom: %d, maxPoints: %d\",he.indexMaxZoom,he.indexMaxPoints),console.time(\"generate tiles\"),this.stats={},this.total=0),ze=yi(ze,he),ze.length&&this.splitTile(ze,0,0,0),he.updateable&&(this.source=ze),pe&&(ze.length&&console.log(\"features: %d, points: %d\",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd(\"generate tiles\"),console.log(\"tiles generated:\",this.total,JSON.stringify(this.stats)))}splitTile(ae,he,pe,ze,He,ot,tt){let Je=[ae,he,pe,ze],nt=this.options,Dt=nt.debug;for(;Je.length;){ze=Je.pop(),pe=Je.pop(),he=Je.pop(),ae=Je.pop();let vt=1<<he,Vt=eo(he,pe,ze),Ke=this.tiles[Vt];if(!Ke&&(Dt>1&&console.time(\"creation\"),Ke=this.tiles[Vt]=Xs(ae,he,pe,ze,nt),this.tileCoords.push({z:he,x:pe,y:ze,id:Vt}),Dt)){Dt>1&&(console.log(\"tile z%d-%d-%d (features: %d, points: %d, simplified: %d)\",he,pe,ze,Ke.numFeatures,Ke.numPoints,Ke.numSimplified),console.timeEnd(\"creation\"));let Wi=`z${he}`;this.stats[Wi]=(this.stats[Wi]||0)+1,this.total++}if(Ke.source=ae,He==null){if(he===nt.indexMaxZoom||Ke.numPoints<=nt.indexMaxPoints)continue}else{if(he===nt.maxZoom||he===He)continue;if(He!=null){let Wi=He-he;if(pe!==ot>>Wi||ze!==tt>>Wi)continue}}if(Ke.source=null,!ae.length)continue;Dt>1&&console.time(\"clipping\");let zn=.5*nt.buffer/nt.extent,Wr=.5-zn,fn=.5+zn,ln=1+zn,Nn=null,Ir=null,Et=null,di=null,pi=Pt(ae,vt,pe-zn,pe+fn,0,Ke.minX,Ke.maxX,nt),ti=Pt(ae,vt,pe+Wr,pe+ln,0,Ke.minX,Ke.maxX,nt);pi&&(Nn=Pt(pi,vt,ze-zn,ze+fn,1,Ke.minY,Ke.maxY,nt),Ir=Pt(pi,vt,ze+Wr,ze+ln,1,Ke.minY,Ke.maxY,nt)),ti&&(Et=Pt(ti,vt,ze-zn,ze+fn,1,Ke.minY,Ke.maxY,nt),di=Pt(ti,vt,ze+Wr,ze+ln,1,Ke.minY,Ke.maxY,nt)),Dt>1&&console.timeEnd(\"clipping\"),Je.push(Nn||[],he+1,2*pe,2*ze),Je.push(Ir||[],he+1,2*pe,2*ze+1),Je.push(Et||[],he+1,2*pe+1,2*ze),Je.push(di||[],he+1,2*pe+1,2*ze+1)}}getTile(ae,he,pe){ae=+ae,he=+he,pe=+pe;let ze=this.options,{extent:He,debug:ot}=ze;if(ae<0||ae>24)return null;let tt=1<<ae,Je=eo(ae,he=he+tt&tt-1,pe);if(this.tiles[Je])return mr(this.tiles[Je],He);ot>1&&console.log(\"drilling down to z%d-%d-%d\",ae,he,pe);let nt,Dt=ae,vt=he,Vt=pe;for(;!nt&&Dt>0;)Dt--,vt>>=1,Vt>>=1,nt=this.tiles[eo(Dt,vt,Vt)];return nt?.source?(ot>1&&(console.log(\"found parent tile z%d-%d-%d\",Dt,vt,Vt),console.time(\"drilling down\")),this.splitTile(nt.source,Dt,vt,Vt,ae,he,pe),ot>1&&console.timeEnd(\"drilling down\"),this.tiles[Je]?mr(this.tiles[Je],He):null):null}invalidateTiles(ae){let he=this.options,{debug:pe}=he,ze=1/0,He=-1/0,ot=1/0,tt=-1/0;for(let Dt of ae)ze=Math.min(ze,Dt.minX),He=Math.max(He,Dt.maxX),ot=Math.min(ot,Dt.minY),tt=Math.max(tt,Dt.maxY);let Je=he.buffer/he.extent,nt=new Set;for(let Dt in this.tiles){let vt=this.tiles[Dt],Vt=1<<vt.z,Ke=(vt.x-Je)/Vt,zn=(vt.x+1+Je)/Vt,Wr=(vt.y-Je)/Vt,fn=(vt.y+1+Je)/Vt;if(He<Ke||ze>=zn||tt<Wr||ot>=fn)continue;let ln=!1;for(let Nn of ae)if(Nn.maxX>=Ke&&Nn.minX<zn&&Nn.maxY>=Wr&&Nn.minY<fn){ln=!0;break}if(ln){if(pe){pe>1&&console.log(\"invalidate tile z%d-%d-%d (features: %d, points: %d, simplified: %d)\",vt.z,vt.x,vt.y,vt.numFeatures,vt.numPoints,vt.numSimplified);let Nn=`z${vt.z}`;this.stats[Nn]=(this.stats[Nn]||0)-1,this.total--}delete this.tiles[Dt],nt.add(Dt)}}nt.size&&(this.tileCoords=this.tileCoords.filter((Dt=>!nt.has(Dt.id))))}updateData(ae){let he=this.options,pe=he.debug;if(!he.updateable)throw new Error(\"to update tile geojson `updateable` option must be set to true\");let{affected:ze,source:He}=(function(vt,Vt,Ke){let zn=(function(fn){return fn?{removeAll:fn.removeAll,remove:new Set(fn.remove||[]),add:new Map(fn.add?.map((ln=>[ln.id,ln]))),update:new Map(fn.update?.map((ln=>[ln.id,ln])))}:{remove:new Set,add:new Map,update:new Map}})(Vt),Wr=[];if(zn.removeAll&&(Wr=vt,vt=[]),zn.remove.size||zn.add.size){let fn=[];for(let ln of vt){let{id:Nn}=ln;(zn.remove.has(Nn)||zn.add.has(Nn))&&fn.push(ln)}if(fn.length){Wr.push(...fn);let ln=new Set(fn.map((Nn=>Nn.id)));vt=vt.filter((Nn=>!ln.has(Nn.id)))}if(zn.add.size){let ln=rn({type:\"FeatureCollection\",features:Array.from(zn.add.values())},Ke);ln=yi(ln,Ke),Wr.push(...ln),vt.push(...ln)}}if(zn.update.size)for(let[fn,ln]of zn.update){let Nn=vt.findIndex((di=>di.id===fn));if(Nn===-1)continue;let Ir=vt[Nn],Et=us(Ir,ln,Ke);Et&&(Wr.push(Ir,Et),vt[Nn]=Et)}return{affected:Wr,source:vt}})(this.source,ae,he);if(!ze.length)return;this.source=He,pe>1&&(console.log(\"invalidating tiles\"),console.time(\"invalidating\")),this.invalidateTiles(ze),pe>1&&console.timeEnd(\"invalidating\");let[ot,tt,Je]=[0,0,0],nt=Xs(this.source,ot,tt,Je,this.options);nt.source=this.source;let Dt=eo(ot,tt,Je);if(this.tiles[Dt]=nt,this.tileCoords.push({z:ot,x:tt,y:Je,id:Dt}),pe){let vt=`z${ot}`;this.stats[vt]=(this.stats[vt]||0)+1,this.total++}}}function eo(Ze,ae,he){return 32*((1<<Ze)*he+ae)+Ze}class $t extends V{constructor(ae,he,pe,ze=en){super(ae,he,pe),this._dataUpdateable=new Map,this._createGeoJSONIndex=ze}loadVectorTile(ae,he){return i._(this,void 0,void 0,(function*(){let pe=ae.tileID.canonical;if(!this._geoJSONIndex)throw new Error(\"Unable to parse the data into a cluster or geojson\");let ze=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);return ze?B(new i.d3(ze.features,{version:2,extent:i.a5})):null}))}loadData(ae){return i._(this,void 0,void 0,(function*(){var he;(he=this._pendingRequest)===null||he===void 0||he.abort();let pe=this._startPerformance(ae);this._pendingRequest=new AbortController;try{(!this._pendingData||ae.request||ae.data||ae.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(ae,this._pendingRequest));let ze=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(ze,ae),this.loaded={};let He={};return ae.request&&(He.data=ze),this._finishPerformance(pe,ae,He),He}catch(ze){if(delete this._pendingRequest,i.Z(ze))return{abandoned:!0};throw ze}}))}_startPerformance(ae){var he;if(!((he=ae?.request)===null||he===void 0)&&he.collectResourceTiming)return new i.c$(ae.request)}_finishPerformance(ae,he,pe){if(!ae)return;let ze=ae.finish();ze&&(pe.resourceTiming={},pe.resourceTiming[he.source]=JSON.parse(JSON.stringify(ze)))}getData(){return i._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(ae){let he=this.loaded;return he&&he[ae.uid]?super.reloadTile(ae):this.loadTile(ae)}loadAndProcessGeoJSON(ae,he){return i._(this,void 0,void 0,(function*(){let pe;if(ae.request?pe=yield this.loadGeoJSONFromUrl(ae.request,ae.promoteId,he):ae.data?pe=this._loadGeoJSONFromObject(ae.data,ae.promoteId):ae.dataDiff&&(pe=this._loadGeoJSONFromDiff(ae.dataDiff,ae.promoteId,ae.source)),delete this._pendingRequest,typeof pe!=\"object\")throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`);return J(pe,!0),ae.filter&&(pe=this._filterGeoJSON(pe,ae.filter)),pe}))}loadGeoJSONFromUrl(ae,he,pe){return i._(this,void 0,void 0,(function*(){let ze=yield i.j(ae,pe);return this._dataUpdateable=i.a7(ze.data,he),ze.data}))}_loadGeoJSONFromObject(ae,he){return this._dataUpdateable=i.a7(ae,he),ae}_loadGeoJSONFromDiff(ae,he,pe){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${pe}`);i.a8(this._dataUpdateable,ae,he);let ze=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(ze)}_filterGeoJSON(ae,he){let pe=i.d4(he,{type:\"boolean\",\"property-type\":\"data-driven\",overridable:!1,transition:!1});if(pe.result===\"error\")throw new Error(pe.value.map((He=>`${He.key}: ${He.message}`)).join(\", \"));let ze=ae.features.filter((He=>pe.value.evaluate({zoom:0},He)));return this._toFeatureCollection(ze)}_toFeatureCollection(ae){return{type:\"FeatureCollection\",features:ae}}removeSource(ae){return i._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(ae){return this._geoJSONIndex.getClusterExpansionZoom(ae.clusterId)}getClusterChildren(ae){return this._geoJSONIndex.getChildren(ae.clusterId)}getClusterLeaves(ae){return this._geoJSONIndex.getLeaves(ae.clusterId,ae.limit,ae.offset)}}function en(Ze,ae){return ae.cluster?new Xe((function({superclusterOptions:he,clusterProperties:pe}){if(!pe||!he)return he;let ze={},He={},ot={accumulated:null,zoom:0},tt={properties:null},Je=Object.keys(pe);for(let nt of Je){let[Dt,vt]=pe[nt],Vt=i.d4(vt),Ke=i.d4(typeof Dt==\"string\"?[Dt,[\"accumulated\"],[\"get\",nt]]:Dt);ze[nt]=Vt.value,He[nt]=Ke.value}return he.map=nt=>{tt.properties=nt;let Dt={};for(let vt of Je)Dt[vt]=ze[vt].evaluate(ot,tt);return Dt},he.reduce=(nt,Dt)=>{tt.properties=Dt;for(let vt of Je)ot.accumulated=nt[vt],nt[vt]=He[vt].evaluate(ot,tt)},he})(ae)).load(Ze.features):(function(he,pe){return new Fr(he,pe)})(Ze,ae.geojsonVtOptions)}class Sn{constructor(ae){this.self=ae,this.actor=new i.L(ae),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(he,pe)=>{if(this.externalWorkerSourceTypes[he])throw new Error(`Worker source with name \"${he}\" already registered.`);this.externalWorkerSourceTypes[he]=pe},this.self.addProtocol=i.cK,this.self.removeProtocol=i.cL,this.self.registerRTLTextPlugin=he=>{i.d5.setMethods(he)},this.actor.registerMessageHandler(\"LDT\",((he,pe)=>this._getDEMWorkerSource(he,pe.source).loadTile(pe))),this.actor.registerMessageHandler(\"RDT\",((he,pe)=>i._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(he,pe.source).removeTile(pe)})))),this.actor.registerMessageHandler(\"GCEZ\",((he,pe)=>i._(this,void 0,void 0,(function*(){return this._getWorkerSource(he,pe.type,pe.source).getClusterExpansionZoom(pe)})))),this.actor.registerMessageHandler(\"GCC\",((he,pe)=>i._(this,void 0,void 0,(function*(){return this._getWorkerSource(he,pe.type,pe.source).getClusterChildren(pe)})))),this.actor.registerMessageHandler(\"GCL\",((he,pe)=>i._(this,void 0,void 0,(function*(){return this._getWorkerSource(he,pe.type,pe.source).getClusterLeaves(pe)})))),this.actor.registerMessageHandler(\"LD\",((he,pe)=>this._getWorkerSource(he,pe.type,pe.source).loadData(pe))),this.actor.registerMessageHandler(\"GD\",((he,pe)=>this._getWorkerSource(he,pe.type,pe.source).getData())),this.actor.registerMessageHandler(\"LT\",((he,pe)=>this._getWorkerSource(he,pe.type,pe.source).loadTile(pe))),this.actor.registerMessageHandler(\"RT\",((he,pe)=>this._getWorkerSource(he,pe.type,pe.source).reloadTile(pe))),this.actor.registerMessageHandler(\"AT\",((he,pe)=>this._getWorkerSource(he,pe.type,pe.source).abortTile(pe))),this.actor.registerMessageHandler(\"RMT\",((he,pe)=>this._getWorkerSource(he,pe.type,pe.source).removeTile(pe))),this.actor.registerMessageHandler(\"RS\",((he,pe)=>i._(this,void 0,void 0,(function*(){if(!this.workerSources[he]||!this.workerSources[he][pe.type]||!this.workerSources[he][pe.type][pe.source])return;let ze=this.workerSources[he][pe.type][pe.source];delete this.workerSources[he][pe.type][pe.source],ze.removeSource!==void 0&&ze.removeSource(pe)})))),this.actor.registerMessageHandler(\"RM\",(he=>i._(this,void 0,void 0,(function*(){delete this.layerIndexes[he],delete this.availableImages[he],delete this.workerSources[he],delete this.demWorkerSources[he],this.globalStates.delete(he)})))),this.actor.registerMessageHandler(\"SR\",((he,pe)=>i._(this,void 0,void 0,(function*(){this.referrer=pe})))),this.actor.registerMessageHandler(\"SRPS\",((he,pe)=>this._syncRTLPluginState(he,pe))),this.actor.registerMessageHandler(\"IS\",((he,pe)=>i._(this,void 0,void 0,(function*(){this.self.importScripts(pe)})))),this.actor.registerMessageHandler(\"SI\",((he,pe)=>this._setImages(he,pe))),this.actor.registerMessageHandler(\"UL\",((he,pe)=>i._(this,void 0,void 0,(function*(){this._getLayerIndex(he).update(pe.layers,pe.removedIds,this._getGlobalState(he))})))),this.actor.registerMessageHandler(\"UGS\",((he,pe)=>i._(this,void 0,void 0,(function*(){let ze=this._getGlobalState(he);for(let He in pe)ze[He]=pe[He]})))),this.actor.registerMessageHandler(\"SL\",((he,pe)=>i._(this,void 0,void 0,(function*(){this._getLayerIndex(he).replace(pe,this._getGlobalState(he))}))))}_getGlobalState(ae){let he=this.globalStates.get(ae);return he||(he={},this.globalStates.set(ae,he)),he}_setImages(ae,he){return i._(this,void 0,void 0,(function*(){this.availableImages[ae]=he;for(let pe in this.workerSources[ae]){let ze=this.workerSources[ae][pe];for(let He in ze)ze[He].availableImages=he}}))}_syncRTLPluginState(ae,he){return i._(this,void 0,void 0,(function*(){return yield i.d5.syncState(he,this.self.importScripts)}))}_getAvailableImages(ae){let he=this.availableImages[ae];return he||(he=[]),he}_getLayerIndex(ae){let he=this.layerIndexes[ae];return he||(he=this.layerIndexes[ae]=new o),he}_getWorkerSource(ae,he,pe){if(this.workerSources[ae]||(this.workerSources[ae]={}),this.workerSources[ae][he]||(this.workerSources[ae][he]={}),!this.workerSources[ae][he][pe]){let ze={sendAsync:(He,ot)=>(He.targetMapId=ae,this.actor.sendAsync(He,ot))};switch(he){case\"vector\":this.workerSources[ae][he][pe]=new V(ze,this._getLayerIndex(ae),this._getAvailableImages(ae));break;case\"geojson\":this.workerSources[ae][he][pe]=new $t(ze,this._getLayerIndex(ae),this._getAvailableImages(ae));break;default:this.workerSources[ae][he][pe]=new this.externalWorkerSourceTypes[he](ze,this._getLayerIndex(ae),this._getAvailableImages(ae))}}return this.workerSources[ae][he][pe]}_getDEMWorkerSource(ae,he){return this.demWorkerSources[ae]||(this.demWorkerSources[ae]={}),this.demWorkerSources[ae][he]||(this.demWorkerSources[ae][he]=new q),this.demWorkerSources[ae][he]}}return i.i(self)&&(self.worker=new Sn(self)),Sn})),n(\"index\",[\"exports\",\"./shared\"],(function(i,o){\"use strict\";var s=\"5.17.0\";function c(){var I=new o.A(4);return o.A!=Float32Array&&(I[1]=0,I[2]=0),I[0]=1,I[3]=1,I}let d,m,b,C={frame(I,l,f,y){let w=y||window,P=w.requestAnimationFrame((z=>{L(),l(z)})),{unsubscribe:L}=o.s(I.signal,\"abort\",(()=>{L(),w.cancelAnimationFrame(P),f(new o.a(I.signal.reason))}),!1)},frameAsync(I,l){return new Promise(((f,y)=>{this.frame(I,f,y,l)}))},getImageData(I,l=0){return this.getImageCanvasContext(I).getImageData(-l,-l,I.width+2*l,I.height+2*l)},getImageCanvasContext(I){let l=window.document.createElement(\"canvas\"),f=l.getContext(\"2d\",{willReadFrequently:!0});if(!f)throw new Error(\"failed to create canvas 2d context\");return l.width=I.width,l.height=I.height,f.drawImage(I,0,0,I.width,I.height),f},resolveURL:I=>(d||(d=document.createElement(\"a\")),d.href=I,d.href),hardwareConcurrency:typeof navigator<\"u\"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return b!==void 0?b:!!matchMedia&&(m==null&&(m=matchMedia(\"(prefers-reduced-motion: reduce)\")),m.matches)},set prefersReducedMotion(I){b=I}},B=new class{constructor(){this._realTime=typeof performance<\"u\"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(I){this._frozenAt=I}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function k(){return B.getCurrentTime()}class V{static testProp(l){if(!V.docStyle)return l[0];for(let f=0;f<l.length;f++)if(l[f]in V.docStyle)return l[f];return l[0]}static create(l,f,y){let w=window.document.createElement(l);return f!==void 0&&(w.className=f),y&&y.appendChild(w),w}static createNS(l,f){return window.document.createElementNS(l,f)}static disableDrag(){V.docStyle&&V.selectProp&&(V.userSelect=V.docStyle[V.selectProp],V.docStyle[V.selectProp]=\"none\")}static enableDrag(){V.docStyle&&V.selectProp&&(V.docStyle[V.selectProp]=V.userSelect)}static setTransform(l,f){l.style[V.transformProp]=f}static addEventListener(l,f,y,w={}){l.addEventListener(f,y,\"passive\"in w?w:w.capture)}static removeEventListener(l,f,y,w={}){l.removeEventListener(f,y,\"passive\"in w?w:w.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener(\"click\",V.suppressClickInternal,!0)}static suppressClick(){window.addEventListener(\"click\",V.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener(\"click\",V.suppressClickInternal,!0)}),0)}static getScale(l){let f=l.getBoundingClientRect();return{x:f.width/l.offsetWidth||1,y:f.height/l.offsetHeight||1,boundingClientRect:f}}static getPoint(l,f,y){let w=f.boundingClientRect;return new o.P((y.clientX-w.left)/f.x-l.clientLeft,(y.clientY-w.top)/f.y-l.clientTop)}static mousePos(l,f){let y=V.getScale(l);return V.getPoint(l,y,f)}static touchPos(l,f){let y=[],w=V.getScale(l);for(let P=0;P<f.length;P++)y.push(V.getPoint(l,w,f[P]));return y}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}static sanitize(l){let f=new DOMParser().parseFromString(l,\"text/html\").body||document.createElement(\"body\"),y=f.querySelectorAll(\"script\");for(let w of y)w.remove();return V.clean(f),f.innerHTML}static isPossiblyDangerous(l,f){let y=f.replace(/\\s+/g,\"\").toLowerCase();return!(![\"src\",\"href\",\"xlink:href\"].includes(l)||!y.includes(\"javascript:\")&&!y.includes(\"data:\"))||!!l.startsWith(\"on\")||void 0}static clean(l){let f=l.children;for(let y of f)V.removeAttributes(y),V.clean(y)}static removeAttributes(l){for(let{name:f,value:y}of l.attributes)V.isPossiblyDangerous(f,y)&&l.removeAttribute(f)}}V.docStyle=typeof window<\"u\"&&window.document&&window.document.documentElement.style,V.selectProp=V.testProp([\"userSelect\",\"MozUserSelect\",\"WebkitUserSelect\",\"msUserSelect\"]),V.transformProp=V.testProp([\"transform\",\"WebkitTransform\"]);let q={supported:!1,testSupport:function(I){!ee&&Y&&(J?se(I):K=I)}},K,Y,ee=!1,J=!1;function se(I){let l=I.createTexture();I.bindTexture(I.TEXTURE_2D,l);try{if(I.texImage2D(I.TEXTURE_2D,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,Y),I.isContextLost())return;q.supported=!0}catch{}I.deleteTexture(l),ee=!0}var xe;typeof document<\"u\"&&(Y=document.createElement(\"img\"),Y.onload=()=>{K&&se(K),K=null,J=!0},Y.onerror=()=>{ee=!0,K=null},Y.src=\"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=\"),(function(I){let l,f,y,w;I.resetRequestQueue=()=>{l=[],f=0,y=0,w={}},I.addThrottleControl=G=>{let j=y++;return w[j]=G,j},I.removeThrottleControl=G=>{delete w[G],L()},I.getImage=(G,j,Q=!0)=>new Promise(((ie,re)=>{q.supported&&(G.headers||(G.headers={}),G.headers.accept=\"image/webp,*/*\"),o.e(G,{type:\"image\"}),l.push({abortController:j,requestParameters:G,supportImageRefresh:Q,state:\"queued\",onError:ce=>{re(ce)},onSuccess:ce=>{ie(ce)}}),L()}));let P=G=>o._(this,void 0,void 0,(function*(){G.state=\"running\";let{requestParameters:j,supportImageRefresh:Q,onError:ie,onSuccess:re,abortController:ce}=G,de=Q===!1&&!o.i(self)&&!o.g(j.url)&&(!j.headers||Object.keys(j.headers).reduce(((Me,Oe)=>Me&&Oe===\"accept\"),!0));f++;let Te=de?z(j,ce):o.m(j,ce);try{let Me=yield Te;delete G.abortController,G.state=\"completed\",Me.data instanceof HTMLImageElement||o.b(Me.data)?re(Me):Me.data&&re({data:yield(Ie=Me.data,typeof createImageBitmap==\"function\"?o.f(Ie):o.h(Ie)),cacheControl:Me.cacheControl,expires:Me.expires})}catch(Me){delete G.abortController,ie(Me)}finally{f--,L()}var Ie})),L=()=>{let G=(()=>{for(let j of Object.keys(w))if(w[j]())return!0;return!1})()?o.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let j=f;j<G&&l.length>0;j++){let Q=l.shift();Q.abortController.signal.aborted?j--:P(Q)}},z=(G,j)=>new Promise(((Q,ie)=>{let re=new Image,ce=G.url,de=G.credentials;de&&de===\"include\"?re.crossOrigin=\"use-credentials\":(de&&de===\"same-origin\"||!o.d(ce))&&(re.crossOrigin=\"anonymous\"),j.signal.addEventListener(\"abort\",(()=>{re.src=\"\",ie(new o.a(j.signal.reason))})),re.fetchPriority=\"high\",re.onload=()=>{re.onerror=re.onload=null,Q({data:re})},re.onerror=()=>{re.onerror=re.onload=null,j.signal.aborted||ie(new Error(\"Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.\"))},re.src=ce}))})(xe||(xe={})),xe.resetRequestQueue();class Ee{constructor(l){this._transformRequestFn=l??null}transformRequest(l,f){return this._transformRequestFn&&this._transformRequestFn(l,f)||{url:l}}setTransformRequest(l){this._transformRequestFn=l}}function Xe(I){let l=[];if(typeof I==\"string\")l.push({id:\"default\",url:I});else if(I&&I.length>0){let f=[];for(let{id:y,url:w}of I){let P=`${y}${w}`;f.indexOf(P)===-1&&(f.push(P),l.push({id:y,url:w}))}}return l}function Ne(I,l,f){try{let y=new URL(I);return y.pathname+=`${l}${f}`,y.toString()}catch{throw new Error(`Invalid sprite URL \"${I}\", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function be(I){let{userImage:l}=I;return!!(l&&l.render&&l.render())&&(I.data.replace(new Uint8Array(l.data.buffer)),!0)}class ge extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(let l of Object.keys(this.images))this.removeImage(l);this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(let{ids:f,promiseResolve:y}of this.requestors)y(this._getImagesForIds(f));this.requestors=[]}}getImage(l){let f=this.images[l];if(f&&!f.data&&f.spriteData){let y=f.spriteData;f.data=new o.R({width:y.width,height:y.height},y.context.getImageData(y.x,y.y,y.width,y.height).data),f.spriteData=null}return f}addImage(l,f){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,f)&&(this.images[l]=f)}_validate(l,f){let y=!0,w=f.data||f.spriteData;return this._validateStretch(f.stretchX,w&&w.width)||(this.fire(new o.k(new Error(`Image \"${l}\" has invalid \"stretchX\" value`))),y=!1),this._validateStretch(f.stretchY,w&&w.height)||(this.fire(new o.k(new Error(`Image \"${l}\" has invalid \"stretchY\" value`))),y=!1),this._validateContent(f.content,f)||(this.fire(new o.k(new Error(`Image \"${l}\" has invalid \"content\" value`))),y=!1),y}_validateStretch(l,f){if(!l)return!0;let y=0;for(let w of l){if(w[0]<y||w[1]<w[0]||f<w[1])return!1;y=w[1]}return!0}_validateContent(l,f){if(!l)return!0;if(l.length!==4)return!1;let y=f.spriteData,w=y&&y.width||f.data.width,P=y&&y.height||f.data.height;return!(l[0]<0||w<l[0]||l[1]<0||P<l[1]||l[2]<0||w<l[2]||l[3]<0||P<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,f,y=!0){let w=this.getImage(l);if(y&&(w.data.width!==f.data.width||w.data.height!==f.data.height))throw new Error(`size mismatch between old image (${w.data.width}x${w.data.height}) and new image (${f.data.width}x${f.data.height}).`);f.version=w.version+1,this.images[l]=f,this.updatedImages[l]=!0}removeImage(l){let f=this.images[l];delete this.images[l],delete this.patterns[l],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise(((f,y)=>{let w=!0;if(!this.isLoaded())for(let P of l)this.images[P]||(w=!1);this.isLoaded()||w?f(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:f})}))}_getImagesForIds(l){let f={};for(let y of l){let w=this.getImage(y);w||(this.fire(new o.l(\"styleimagemissing\",{id:y})),w=this.getImage(y)),w?f[y]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,textFitWidth:w.textFitWidth,textFitHeight:w.textFitHeight,hasRenderCallback:!!(w.userImage&&w.userImage.render)}:o.w(`Image \"${y}\" could not be loaded. Please make sure you have added the image with map.addImage() or a \"sprite\" property in your style. You can provide missing images by listening for the \"styleimagemissing\" map event.`)}return f}getPixelSize(){let{width:l,height:f}=this.atlasImage;return{width:l,height:f}}getPattern(l){let f=this.patterns[l],y=this.getImage(l);if(!y)return null;if(f&&f.position.version===y.version)return f.position;if(f)f.position.version=y.version;else{let w={w:y.data.width+2,h:y.data.height+2,x:0,y:0},P=new o.I(w,y);this.patterns[l]={bin:w,position:P}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){let f=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(l,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){let l=[];for(let P in this.patterns)l.push(this.patterns[P].bin);let{w:f,h:y}=o.p(l),w=this.atlasImage;w.resize({width:f||1,height:y||1});for(let P in this.patterns){let{bin:L}=this.patterns[P],z=L.x+1,G=L.y+1,j=this.getImage(P).data,Q=j.width,ie=j.height;o.R.copy(j,w,{x:0,y:0},{x:z,y:G},{width:Q,height:ie}),o.R.copy(j,w,{x:0,y:ie-1},{x:z,y:G-1},{width:Q,height:1}),o.R.copy(j,w,{x:0,y:0},{x:z,y:G+ie},{width:Q,height:1}),o.R.copy(j,w,{x:Q-1,y:0},{x:z-1,y:G},{width:1,height:ie}),o.R.copy(j,w,{x:0,y:0},{x:z+Q,y:G},{width:1,height:ie})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(let f of l){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;let y=this.getImage(f);y||o.w(`Image with ID: \"${f}\" was not found`),be(y)&&this.updateImage(f,y)}}cloneImages(){let l={};for(let f in this.images){let y=this.images[f];l[f]=Object.assign(Object.assign({},y),{data:y.data?y.data.clone():null})}return l}}let Qe=1e20;function Ct(I,l,f,y,w,P,L,z,G){for(let j=l;j<l+y;j++)Mt(I,f*P+j,P,w,L,z,G);for(let j=f;j<f+w;j++)Mt(I,j*P+l,1,y,L,z,G)}function Mt(I,l,f,y,w,P,L){P[0]=0,L[0]=-Qe,L[1]=Qe,w[0]=I[l];for(let z=1,G=0,j=0;z<y;z++){w[z]=I[l+z*f];let Q=z*z;do{let ie=P[G];j=(w[z]-w[ie]+Q-ie*ie)/(z-ie)/2}while(j<=L[G]&&--G>-1);G++,P[G]=z,L[G]=j,L[G+1]=Qe}for(let z=0,G=0;z<y;z++){for(;L[G+1]<z;)G++;let j=P[G],Q=z-j;I[l+z*f]=w[j]+Q*Q}}let mt=o.v.layout_symbol[\"text-font\"].default.join(\",\");class jt{constructor(l,f,y){this.requestManager=l,this.localIdeographFontFamily=f,this.entries={},this.lang=y}setURL(l){this.url=l}getGlyphs(l){return o._(this,void 0,void 0,(function*(){let f=[];for(let P in l)for(let L of l[P])f.push(this._getAndCacheGlyphsPromise(P,L));let y=yield Promise.all(f),w={};for(let{stack:P,id:L,glyph:z}of y)w[P]||(w[P]={}),w[P][L]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};return w}))}_getAndCacheGlyphsPromise(l,f){return o._(this,void 0,void 0,(function*(){let y=this.entries[l];y||(y=this.entries[l]={glyphs:{},requests:{},ranges:{}});let w=y.glyphs[f];return w!==void 0?{stack:l,id:f,glyph:w}:!this.url||this._charUsesLocalIdeographFontFamily(f)?(w=y.glyphs[f]=this._drawGlyph(y,l,f),{stack:l,id:f,glyph:w}):yield this._downloadAndCacheRangePromise(l,f)}))}_downloadAndCacheRangePromise(l,f){return o._(this,void 0,void 0,(function*(){let y=this.entries[l],w=Math.floor(f/256);if(y.ranges[w])return{stack:l,id:f,glyph:null};if(!y.requests[w]){let P=jt.loadGlyphRange(l,w,this.url,this.requestManager);y.requests[w]=P}try{let P=yield y.requests[w];for(let L in P)y.glyphs[+L]=P[+L];return y.ranges[w]=!0,{stack:l,id:f,glyph:P[f]||null}}catch(P){let L=y.glyphs[f]=this._drawGlyph(y,l,f);return this._warnOnMissingGlyphRange(L,w,f,P),{stack:l,id:f,glyph:L}}}))}_warnOnMissingGlyphRange(l,f,y,w){let P=256*f,L=P+255,z=y.toString(16).padStart(4,\"0\").toUpperCase();o.w(`Unable to load glyph range ${f}, ${P}-${L}. Rendering codepoint U+${z} locally instead. ${w}`)}_charUsesLocalIdeographFontFamily(l){return!!this.localIdeographFontFamily&&o.q(l)}_drawGlyph(l,f,y){let w=f===mt&&this.localIdeographFontFamily!==\"\"&&this._charUsesLocalIdeographFontFamily(y),P=w?\"ideographTinySDF\":\"tinySDF\";l[P]||(l[P]=this._createTinySDF(w?this.localIdeographFontFamily:f));let L=l[P].draw(String.fromCodePoint(y)),z=/^\\p{gc=Cf}+$/u.test(String.fromCodePoint(y));return{id:y,bitmap:new o.r({width:L.width||60,height:L.height||60},L.data),metrics:{width:z?0:L.glyphWidth/2||24,height:L.glyphHeight/2||24,left:L.glyphLeft/2+.5||0,top:L.glyphTop/2-27.5||-8,advance:z?0:L.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(l){let f=l?l.split(\",\"):[];f.push(\"sans-serif\");let y=f.map((w=>/[-\\w]+/.test(w)?w:`'${CSS.escape(w)}'`)).join(\",\");return new jt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:y,fontWeight:this._fontWeight(f[0]),fontStyle:this._fontStyle(f[0]),lang:this.lang})}_fontStyle(l){return/italic/i.test(l)?\"italic\":/oblique/i.test(l)?\"oblique\":\"normal\"}_fontWeight(l){let f={thin:100,hairline:100,\"extra light\":200,\"ultra light\":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,\"extra bold\":800,\"ultra bold\":800,black:900,heavy:900,\"extra black\":950,\"ultra black\":950},y;for(let[w,P]of Object.entries(f))new RegExp(`\\\\b${w}\\\\b`,\"i\").test(l)&&(y=`${P}`);return y}destroy(){for(let l in this.entries){let f=this.entries[l];f.tinySDF&&(f.tinySDF=null),f.ideographTinySDF&&(f.ideographTinySDF=null),f.glyphs={},f.requests={},f.ranges={}}this.entries={}}}jt.loadGlyphRange=function(I,l,f,y){return o._(this,void 0,void 0,(function*(){let w=256*l,P=w+255,L=y.transformRequest(f.replace(\"{fontstack}\",I).replace(\"{range}\",`${w}-${P}`),\"Glyphs\"),z=yield o.n(L,new AbortController);if(!z||!z.data)throw new Error(`Could not load glyph range. range: ${l}, ${w}-${P}`);let G={};for(let j of o.o(z.data))G[j.id]=j;return G}))},jt.TinySDF=class{constructor({fontSize:I=24,buffer:l=3,radius:f=8,cutoff:y=.25,fontFamily:w=\"sans-serif\",fontWeight:P=\"normal\",fontStyle:L=\"normal\",lang:z=null}={}){this.buffer=l,this.cutoff=y,this.radius=f,this.lang=z;let G=this.size=I+4*l,j=this._createCanvas(G),Q=this.ctx=j.getContext(\"2d\",{willReadFrequently:!0});Q.font=`${L} ${P} ${I}px ${w}`,Q.textBaseline=\"alphabetic\",Q.textAlign=\"left\",Q.fillStyle=\"black\",this.gridOuter=new Float64Array(G*G),this.gridInner=new Float64Array(G*G),this.f=new Float64Array(G),this.z=new Float64Array(G+1),this.v=new Uint16Array(G)}_createCanvas(I){let l=document.createElement(\"canvas\");return l.width=l.height=I,l}draw(I){let{width:l,actualBoundingBoxAscent:f,actualBoundingBoxDescent:y,actualBoundingBoxLeft:w,actualBoundingBoxRight:P}=this.ctx.measureText(I),L=Math.ceil(f),z=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(P-w))),G=Math.min(this.size-this.buffer,L+Math.ceil(y)),j=z+2*this.buffer,Q=G+2*this.buffer,ie=Math.max(j*Q,0),re=new Uint8ClampedArray(ie),ce={data:re,width:j,height:Q,glyphWidth:z,glyphHeight:G,glyphTop:L,glyphLeft:0,glyphAdvance:l};if(z===0||G===0)return ce;let{ctx:de,buffer:Te,gridInner:Ie,gridOuter:Me}=this;this.lang&&(de.lang=this.lang),de.clearRect(Te,Te,z,G),de.fillText(I,Te,Te+L);let Oe=de.getImageData(Te,Te,z,G);Me.fill(Qe,0,ie),Ie.fill(0,0,ie);for(let We=0;We<G;We++)for(let De=0;De<z;De++){let Ge=Oe.data[4*(We*z+De)+3]/255;if(Ge===0)continue;let Be=(We+Te)*j+De+Te;if(Ge===1)Me[Be]=0,Ie[Be]=Qe;else{let Fe=.5-Ge;Me[Be]=Fe>0?Fe*Fe:0,Ie[Be]=Fe<0?Fe*Fe:0}}Ct(Me,0,0,j,Q,j,this.f,this.v,this.z),Ct(Ie,Te,Te,z,G,j,this.f,this.v,this.z);for(let We=0;We<ie;We++){let De=Math.sqrt(Me[We])-Math.sqrt(Ie[We]);re[We]=Math.round(255-255*(De/this.radius+this.cutoff))}return ce}};class Mn{constructor(){this.specification=o.u.light.position}possiblyEvaluate(l,f){return o.F(l.expression.evaluate(f))}interpolate(l,f,y){return{x:o.G.number(l.x,f.x,y),y:o.G.number(l.y,f.y,y),z:o.G.number(l.z,f.z,y)}}}let rn;class In extends o.E{constructor(l){super(),rn=rn||new o.t({anchor:new o.D(o.u.light.anchor),position:new Mn,color:new o.D(o.u.light.color),intensity:new o.D(o.u.light.intensity)}),this._transitionable=new o.x(rn,void 0),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,f={}){if(!this._validate(o.y,l,f))for(let y in l){let w=l[y];y.endsWith(o.z)?this._transitionable.setTransition(y.slice(0,-o.z.length),w):this._transitionable.setValue(y,w)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,f,y){return(!y||y.validate!==!1)&&o.B(this,l.call(o.C,{value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.u}))}}let On=new o.t({\"sky-color\":new o.D(o.u.sky[\"sky-color\"]),\"horizon-color\":new o.D(o.u.sky[\"horizon-color\"]),\"fog-color\":new o.D(o.u.sky[\"fog-color\"]),\"fog-ground-blend\":new o.D(o.u.sky[\"fog-ground-blend\"]),\"horizon-fog-blend\":new o.D(o.u.sky[\"horizon-fog-blend\"]),\"sky-horizon-blend\":new o.D(o.u.sky[\"sky-horizon-blend\"]),\"atmosphere-blend\":new o.D(o.u.sky[\"atmosphere-blend\"])});class Pn extends o.E{constructor(l){super(),this._transitionable=new o.x(On,void 0),this.setSky(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0))}setSky(l,f={}){if(!this._validate(o.J,l,f)){l||(l={\"sky-color\":\"transparent\",\"horizon-color\":\"transparent\",\"fog-color\":\"transparent\",\"fog-ground-blend\":1,\"atmosphere-blend\":0});for(let y in l){let w=l[y];y.endsWith(o.z)?this._transitionable.setTransition(y.slice(0,-o.z.length),w):this._transitionable.setValue(y,w)}}}getSky(){return this._transitionable.serialize()}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,f,y={}){return y?.validate!==!1&&o.B(this,l.call(o.C,o.e({value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.u})))}calculateFogBlendOpacity(l){return l<60?0:l<70?(l-60)/10:1}}class _n{constructor(l,f){this.width=l,this.height=f,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,f){let y=l.join(\",\")+String(f);return this.dashEntry[y]||(this.dashEntry[y]=this.addDash(l,f)),this.dashEntry[y]}getDashRanges(l,f,y){let w=[],P=l.length%2==1?-l[l.length-1]*y:0,L=l[0]*y,z=!0;w.push({left:P,right:L,isDash:z,zeroLength:l[0]===0});let G=l[0];for(let j=1;j<l.length;j++){z=!z;let Q=l[j];P=G*y,G+=Q,L=G*y,w.push({left:P,right:L,isDash:z,zeroLength:Q===0})}return w}addRoundDash(l,f,y){let w=f/2;for(let P=-y;P<=y;P++){let L=this.width*(this.nextRow+y+P),z=0,G=l[z];for(let j=0;j<this.width;j++){j/G.right>1&&(G=l[++z]);let Q=Math.abs(j-G.left),ie=Math.abs(j-G.right),re=Math.min(Q,ie),ce,de=P/y*(w+1);if(G.isDash){let Te=w-Math.abs(de);ce=Math.sqrt(re*re+Te*Te)}else ce=w-Math.sqrt(re*re+de*de);this.data[L+j]=Math.max(0,Math.min(255,ce+128))}}}addRegularDash(l){for(let z=l.length-1;z>=0;--z){let G=l[z],j=l[z+1];G.zeroLength?l.splice(z,1):j&&j.isDash===G.isDash&&(j.left=G.left,l.splice(z,1))}let f=l[0],y=l[l.length-1];f.isDash===y.isDash&&(f.left=y.left-this.width,y.right=f.right+this.width);let w=this.width*this.nextRow,P=0,L=l[P];for(let z=0;z<this.width;z++){z/L.right>1&&(L=l[++P]);let G=Math.abs(z-L.left),j=Math.abs(z-L.right),Q=Math.min(G,j);this.data[w+z]=Math.max(0,Math.min(255,(L.isDash?Q:-Q)+128))}}addDash(l,f){let y=f?7:0,w=2*y+1;if(this.nextRow+w>this.height)return o.w(\"LineAtlas out of space\"),null;let P=0;for(let z=0;z<l.length;z++)P+=l[z];if(P!==0){let z=this.width/P,G=this.getDashRanges(l,this.width,z);f?this.addRoundDash(G,z,y):this.addRegularDash(G)}let L={y:this.nextRow+y,height:2*y,width:P};return this.nextRow+=w,this.dirty=!0,L}bind(l){let f=l.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))}}let tr=\"maplibre_preloaded_worker_pool\";class on{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<on.workerCount;)this.workers.push(new Worker(o.c.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach((f=>{f.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[tr]}numActive(){return Object.keys(this.active).length}}let Pt=Math.floor(C.hardwareConcurrency/2),Mr,Fn;function Br(){return Mr||(Mr=new on),Mr}on.workerCount=o.K(globalThis)?Math.max(Math.min(Pt,3),1):1;class nr{constructor(l,f){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=f;let y=this.workerPool.acquire(f);for(let w=0;w<y.length;w++){let P=new o.L(y[w],f);P.name=`Worker ${w}`,this.actors.push(P)}if(!this.actors.length)throw new Error(\"No actors found\")}broadcast(l,f){let y=[];for(let w of this.actors)y.push(w.sendAsync({type:l,data:f}));return Promise.all(y)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(l=!0){this.actors.forEach((f=>{f.remove()})),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,f){for(let y of this.actors)y.registerMessageHandler(l,f)}unregisterMessageHandler(l){for(let f of this.actors)f.unregisterMessageHandler(l)}}function lo(){return Fn||(Fn=new nr(Br(),o.M),Fn.registerMessageHandler(\"GR\",((I,l,f)=>o.m(l,f)))),Fn}function oi(I,l){let f=o.N();return o.O(f,f,[1,1,0]),o.Q(f,f,[.5*I.width,.5*I.height,1]),I.calculatePosMatrix?o.S(f,f,I.calculatePosMatrix(l.toUnwrapped())):f}function cs(I,l,f,y,w,P,L){var z;let G=(function(re,ce,de){if(re)for(let Te of re){let Ie=ce[Te];if(Ie&&Ie.source===de&&Ie.type===\"fill-extrusion\")return!0}else for(let Te in ce){let Ie=ce[Te];if(Ie.source===de&&Ie.type===\"fill-extrusion\")return!0}return!1})((z=w?.layers)!==null&&z!==void 0?z:null,l,I.id),j=P.maxPitchScaleFactor(),Q=I.tilesIn(y,j,G);Q.sort(yi);let ie=[];for(let re of Q)ie.push({wrappedTileID:re.tileID.wrapped().key,queryResults:re.tile.queryRenderedFeatures(l,f,I.getState(),re.queryGeometry,re.cameraQueryGeometry,re.scale,w,P,j,oi(P,re.tileID),L?(ce,de)=>L(re.tileID,ce,de):void 0)});return(function(re,ce){for(let de in re)for(let Te of re[de])Ro(Te,ce);return re})((function(re){let ce={},de={};for(let Te of re){let Ie=Te.queryResults,Me=Te.wrappedTileID,Oe=de[Me]=de[Me]||{};for(let We in Ie){let De=Ie[We],Ge=Oe[We]=Oe[We]||{},Be=ce[We]=ce[We]||[];for(let Fe of De)Ge[Fe.featureIndex]||(Ge[Fe.featureIndex]=!0,Be.push(Fe))}}return ce})(ie),I)}function yi(I,l){let f=I.tileID,y=l.tileID;return f.overscaledZ-y.overscaledZ||f.canonical.y-y.canonical.y||f.wrap-y.wrap||f.canonical.x-y.canonical.x}function Ro(I,l){let f=I.feature,y=l.getFeatureState(f.layer[\"source-layer\"],f.id);f.source=f.layer.source,f.layer[\"source-layer\"]&&(f.sourceLayer=f.layer[\"source-layer\"]),f.state=y}function co(I,l,f,y){return o._(this,void 0,void 0,(function*(){let w=I;if(I.url?w=(yield o.j(l.transformRequest(I.url,\"Source\"),f)).data:yield C.frameAsync(f,y),!w)return null;let P=o.U(o.e(w,I),[\"tiles\",\"minzoom\",\"maxzoom\",\"attribution\",\"bounds\",\"scheme\",\"tileSize\",\"encoding\"]);return\"vector_layers\"in w&&w.vector_layers&&(P.vectorLayerIds=w.vector_layers.map((L=>L.id))),P}))}class mr{constructor(l,f){l&&(f?this.setSouthWest(l).setNorthEast(f):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof o.V?new o.V(l.lng,l.lat):o.V.convert(l),this}setSouthWest(l){return this._sw=l instanceof o.V?new o.V(l.lng,l.lat):o.V.convert(l),this}extend(l){let f=this._sw,y=this._ne,w,P;if(l instanceof o.V)w=l,P=l;else{if(!(l instanceof mr))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(mr.convert(l)):this.extend(o.V.convert(l)):l&&(\"lng\"in l||\"lon\"in l)&&\"lat\"in l?this.extend(o.V.convert(l)):this;if(w=l._sw,P=l._ne,!w||!P)return this}return f||y?(f.lng=Math.min(w.lng,f.lng),f.lat=Math.min(w.lat,f.lat),y.lng=Math.max(P.lng,y.lng),y.lat=Math.max(P.lat,y.lat)):(this._sw=new o.V(w.lng,w.lat),this._ne=new o.V(P.lng,P.lat)),this}getCenter(){return new o.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.V(this.getWest(),this.getNorth())}getSouthEast(){return new o.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){let{lng:f,lat:y}=o.V.convert(l),w=this._sw.lng<=f&&f<=this._ne.lng;return this._sw.lng>this._ne.lng&&(w=this._sw.lng>=f&&f>=this._ne.lng),this._sw.lat<=y&&y<=this._ne.lat&&w}intersects(l){if(!((l=mr.convert(l)).getNorth()>=this.getSouth()&&l.getSouth()<=this.getNorth()))return!1;let f=Math.abs(this.getEast()-this.getWest()),y=Math.abs(l.getEast()-l.getWest());if(f>=360||y>=360)return!0;let w=o.W(this.getWest(),-180,180),P=o.W(this.getEast(),-180,180),L=o.W(l.getWest(),-180,180),z=o.W(l.getEast(),-180,180),G=w>=P,j=L>=z;return!(!G||!j)||(G?z>=w||L<=P:j?P>=L||w<=z:L<=P&&z>=w)}static convert(l){return l instanceof mr?l:l&&new mr(l)}static fromLngLat(l,f=0){let y=360*f/40075017,w=y/Math.cos(Math.PI/180*l.lat);return new mr(new o.V(l.lng-w,l.lat-y),new o.V(l.lng+w,l.lat+y))}adjustAntiMeridian(){let l=new o.V(this._sw.lng,this._sw.lat),f=new o.V(this._ne.lng,this._ne.lat);return new mr(l,l.lng>f.lng?new o.V(f.lng+360,f.lat):f)}}class Yr{constructor(l,f,y){this.bounds=mr.convert(this.validateBounds(l)),this.minzoom=f||0,this.maxzoom=y||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){let f=Math.pow(2,l.z),y=Math.floor(o.Y(this.bounds.getWest())*f),w=Math.floor(o.X(this.bounds.getNorth())*f),P=Math.ceil(o.Y(this.bounds.getEast())*f),L=Math.ceil(o.X(this.bounds.getSouth())*f);return l.x>=y&&l.x<P&&l.y>=w&&l.y<L}}class Xs extends o.E{constructor(l,f,y,w){if(super(),this.id=l,this.dispatcher=y,this.type=\"vector\",this.minzoom=0,this.maxzoom=22,this.scheme=\"xyz\",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.U(f,[\"url\",\"scheme\",\"tileSize\",\"promoteId\",\"encoding\"])),this._options=o.e({type:\"vector\"},f),this._collectResourceTiming=f.collectResourceTiming,this.tileSize!==512)throw new Error(\"vector tile sources must have a tileSize of 512\");this.setEventedParent(w)}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l(\"dataloading\",{dataType:\"source\"})),this._tileJSONRequest=new AbortController;try{let l=yield co(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),l&&(o.e(this,l),l.bounds&&(this.tileBounds=new Yr(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l(\"data\",{dataType:\"source\",sourceDataType:\"metadata\"})),this.fire(new o.l(\"data\",{dataType:\"source\",sourceDataType:\"content\"})))}catch(l){this._tileJSONRequest=null,this._loaded=!0,o.Z(l)||this.fire(new o.k(l))}}))}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty((()=>{this._options.tiles=l})),this}setUrl(l){return this.setSourceProperty((()=>{this.url=l,this._options.url=l})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(l){return o._(this,void 0,void 0,(function*(){let f=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y={request:this.map._requestManager.transformRequest(f,\"Tile\"),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(l)};y.request.collectResourceTiming=this._collectResourceTiming;let w=\"RT\";if(l.actor&&l.state!==\"expired\"){if(l.state===\"loading\")return new Promise(((P,L)=>{l.reloadPromise={resolve:P,reject:L}}))}else l.actor=this.dispatcher.getActor(),w=\"LT\";l.abortController=new AbortController;try{let P=yield l.actor.sendAsync({type:w,data:y},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,P)}catch(P){if(delete l.abortController,l.aborted)return;if(P&&P.status!==404)throw P;this._afterTileLoadWorkerResponse(l,null)}}))}_getOverzoomParameters(l){if(l.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;let f=l.tileID.scaledTo(this.maxzoom).canonical,y=f.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:f,overzoomRequest:this.map._requestManager.transformRequest(y,\"Tile\")}}_afterTileLoadWorkerResponse(l,f){if(f&&f.resourceTiming&&(l.resourceTiming=f.resourceTiming),f&&this.map._refreshExpiredTiles&&l.setExpiryData(f),l.loadVectorData(f,this.map.painter),l.reloadPromise){let y=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(y.resolve).catch(y.reject)}}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:\"AT\",data:{uid:l.uid,type:this.type,source:this.id}}))}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:\"RMT\",data:{uid:l.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Ys extends o.E{constructor(l,f,y,w){super(),this.id=l,this.dispatcher=y,this.setEventedParent(w),this.type=\"raster\",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme=\"xyz\",this.tileSize=512,this._loaded=!1,this._options=o.e({type:\"raster\"},f),o.e(this,o.U(f,[\"url\",\"scheme\",\"tileSize\"]))}load(){return o._(this,arguments,void 0,(function*(l=!1){this._loaded=!1,this.fire(new o.l(\"dataloading\",{dataType:\"source\"})),this._tileJSONRequest=new AbortController;try{let f=yield co(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,f&&(o.e(this,f),f.bounds&&(this.tileBounds=new Yr(f.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l(\"data\",{dataType:\"source\",sourceDataType:\"metadata\"})),this.fire(new o.l(\"data\",{dataType:\"source\",sourceDataType:\"content\",sourceDataChanged:l})))}catch(f){this._tileJSONRequest=null,this._loaded=!0,o.Z(f)||this.fire(new o.k(f))}}))}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load(!0)}setTiles(l){return this.setSourceProperty((()=>{this._options.tiles=l})),this}setUrl(l){return this.setSourceProperty((()=>{this.url=l,this._options.url=l})),this}serialize(){return o.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return o._(this,void 0,void 0,(function*(){let f=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{let y=yield xe.getImage(this.map._requestManager.transformRequest(f,\"Tile\"),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state=\"unloaded\");if(y&&y.data){this.map._refreshExpiredTiles&&(y.cacheControl||y.expires)&&l.setExpiryData({cacheControl:y.cacheControl,expires:y.expires});let w=this.map.painter.context,P=w.gl,L=y.data;l.texture=this.map.painter.getTileTexture(L.width),l.texture?l.texture.update(L,{useMipmap:!0}):(l.texture=new o.T(w,L,P.RGBA,{useMipmap:!0}),l.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST)),l.state=\"loaded\"}}catch(y){if(delete l.abortController,l.aborted)l.state=\"unloaded\";else if(y)throw l.state=\"errored\",y}}))}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)}))}hasTransition(){return!1}}class Hi extends Ys{constructor(l,f,y,w){super(l,f,y,w),this.type=\"raster-dem\",this.maxzoom=22,this._options=o.e({type:\"raster-dem\"},f),this.encoding=f.encoding||\"mapbox\",this.redFactor=f.redFactor,this.greenFactor=f.greenFactor,this.blueFactor=f.blueFactor,this.baseShift=f.baseShift}loadTile(l){return o._(this,void 0,void 0,(function*(){let f=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y=this.map._requestManager.transformRequest(f,\"Tile\");l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{let w=yield xe.getImage(y,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state=\"unloaded\");if(w&&w.data){let P=w.data;this.map._refreshExpiredTiles&&(w.cacheControl||w.expires)&&l.setExpiryData({cacheControl:w.cacheControl,expires:w.expires});let L=o.b(P)&&o.$()?P:yield this.readImageNow(P),z={type:this.type,uid:l.uid,source:this.id,rawImageData:L,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state===\"expired\"){l.actor=this.dispatcher.getActor();let G=yield l.actor.sendAsync({type:\"LDT\",data:z});l.dem=G,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state=\"loaded\"}}}catch(w){if(delete l.abortController,l.aborted)l.state=\"unloaded\";else if(w)throw l.state=\"errored\",w}}))}readImageNow(l){return o._(this,void 0,void 0,(function*(){if(typeof VideoFrame<\"u\"&&o.a0()){let f=l.width+2,y=l.height+2;try{return new o.R({width:f,height:y},yield o.a1(l,-1,-1,f,y))}catch{}}return C.getImageData(l,1)}))}_getNeighboringTiles(l){let f=l.canonical,y=Math.pow(2,f.z),w=(f.x-1+y)%y,P=f.x===0?l.wrap-1:l.wrap,L=(f.x+1+y)%y,z=f.x+1===y?l.wrap+1:l.wrap,G={};return G[new o.a2(l.overscaledZ,P,f.z,w,f.y).key]={backfilled:!1},G[new o.a2(l.overscaledZ,z,f.z,L,f.y).key]={backfilled:!1},f.y>0&&(G[new o.a2(l.overscaledZ,P,f.z,w,f.y-1).key]={backfilled:!1},G[new o.a2(l.overscaledZ,l.wrap,f.z,f.x,f.y-1).key]={backfilled:!1},G[new o.a2(l.overscaledZ,z,f.z,L,f.y-1).key]={backfilled:!1}),f.y+1<y&&(G[new o.a2(l.overscaledZ,P,f.z,w,f.y+1).key]={backfilled:!1},G[new o.a2(l.overscaledZ,l.wrap,f.z,f.x,f.y+1).key]={backfilled:!1},G[new o.a2(l.overscaledZ,z,f.z,L,f.y+1).key]={backfilled:!1}),G}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state=\"unloaded\",l.actor&&(yield l.actor.sendAsync({type:\"RDT\",data:{type:this.type,uid:l.uid,source:this.id}}))}))}}function us(I){return I.type===\"GeometryCollection\"?I.geometries.map((l=>l.coordinates)).flat(1/0):I.coordinates.flat(1/0)}function Zr(I){let l=new mr,f;switch(I.type){case\"FeatureCollection\":f=I.features.map((y=>us(y.geometry))).flat(1/0);break;case\"Feature\":f=us(I.geometry);break;default:f=us(I)}if(f.length==0)return l;for(let y=0;y<f.length-1;y+=2)l.extend([f[y],f[y+1]]);return l}class Oi extends o.E{constructor(l,f,y,w){super(),this.id=l,this.type=\"geojson\",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:f.data},this.actor=y.getActor(),this.setEventedParent(w),this._data=typeof f.data==\"string\"?{url:f.data}:{geojson:f.data},this._options=o.e({},f),this._collectResourceTiming=f.collectResourceTiming,f.maxzoom!==void 0&&(this.maxzoom=f.maxzoom),f.type&&(this.type=f.type),f.attribution&&(this.attribution=f.attribution),this.promoteId=f.promoteId,f.clusterMaxZoom!==void 0&&this.maxzoom<=f.clusterMaxZoom&&o.w(`The maxzoom value \"${this.maxzoom}\" is expected to be greater than the clusterMaxZoom value \"${f.clusterMaxZoom}\".`),this.workerOptions=o.e({source:this.id,cluster:f.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(f.buffer!==void 0?f.buffer:128),tolerance:this._pixelsToTileUnits(f.tolerance!==void 0?f.tolerance:.375),extent:o.a5,maxZoom:this.maxzoom,lineMetrics:f.lineMetrics||!1,generateId:f.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(f.clusterMaxZoom),minPoints:Math.max(2,f.clusterMinPoints||2),extent:o.a5,radius:this._pixelsToTileUnits(f.clusterRadius||50),log:!1,generateId:f.generateId||!1},clusterProperties:f.clusterProperties,filter:f.filter},f.workerOptions),typeof this.promoteId==\"string\"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(l){return l*(o.a5/this.tileSize)}_getClusterMaxZoom(l){let f=l?Math.round(l):this.maxzoom-1;return Number.isInteger(l)||l===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value \"${l}\" rounded to \"${f}\"`),f}load(){return o._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(l){this.map=l,this.load()}setData(l,f){this._data=typeof l==\"string\"?{url:l}:{geojson:l},this._pendingWorkerUpdate={data:l};let y=this._updateWorkerData();return f?y:this}updateData(l,f){this._pendingWorkerUpdate.diff=o.a6(this._pendingWorkerUpdate.diff,l);let y=this._updateWorkerData();return f?y:this}getData(){return o._(this,void 0,void 0,(function*(){let l=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:\"GD\",data:l})}))}getBounds(){return o._(this,void 0,void 0,(function*(){return Zr(yield this.getData())}))}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(l.clusterRadius)),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(l.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:\"GCEZ\",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:\"GCC\",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,f,y){return this.actor.sendAsync({type:\"GCL\",data:{type:this.type,source:this.id,clusterId:l,limit:f,offset:y}})}_updateWorkerData(){return o._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void o.w(`No pending worker updates for GeoJSONSource ${this.id}.`);let{data:l,diff:f}=this._pendingWorkerUpdate,y=this._getLoadGeoJSONParameters(l,f);l!==void 0?this._pendingWorkerUpdate.data=void 0:f&&(this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,yield this._dispatchWorkerUpdate(y)}))}_getLoadGeoJSONParameters(l,f){let y=o.e({type:this.type},this.workerOptions);return typeof l==\"string\"?(y.request=this.map._requestManager.transformRequest(C.resolveURL(l),\"Source\"),y.request.collectResourceTiming=this._collectResourceTiming,y):l!==void 0?(y.data=l,y):(f&&(y.dataDiff=f),y)}_dispatchWorkerUpdate(l){return o._(this,void 0,void 0,(function*(){this._isUpdatingWorker=!0,this.fire(new o.l(\"dataloading\",{dataType:\"source\"}));try{let f=yield this.actor.sendAsync({type:\"LD\",data:l});if(this._isUpdatingWorker=!1,this._removed||f.abandoned)return void this.fire(new o.l(\"dataabort\",{dataType:\"source\"}));f.data&&(this._data={geojson:f.data});let y=this._applyDiffToSource(l.dataDiff),w=this._getShouldReloadTileOptions(y),P={dataType:\"source\"};this._applyResourceTiming(P,f),this.fire(new o.l(\"data\",Object.assign(Object.assign({},P),{sourceDataType:\"metadata\"}))),this.fire(new o.l(\"data\",Object.assign(Object.assign({},P),{sourceDataType:\"content\",shouldReloadTileOptions:w})))}catch(f){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l(\"dataabort\",{dataType:\"source\"}));this.fire(new o.k(f))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyResourceTiming(l,f){var y;if(!this._collectResourceTiming)return;let w=(y=f.resourceTiming)===null||y===void 0?void 0:y[this.id];if(!w)return;let P=w.slice(0);P?.length&&o.e(l,{resourceTiming:P})}_applyDiffToSource(l){if(!l)return;let f=typeof this.promoteId==\"string\"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){let w=o.a7(this._data.geojson,f);if(!w)throw new Error(`GeoJSONSource \"${this.id}\": GeoJSON data is not compatible with updateData`);this._data={updateable:w}}if(!this._data.updateable)return;let y=o.a8(this._data.updateable,l,f);return l.removeAll||this._options.cluster?void 0:y}_getShouldReloadTileOptions(l){if(l)return{affectedBounds:l.filter(Boolean).map((f=>Zr(f)))}}shouldReloadTile(l,{affectedBounds:f}){if(l.state===\"loading\")return!0;if(l.state===\"unloaded\")return!1;let{buffer:y,extent:w}=this.workerOptions.geojsonVtOptions,P=(function({x:L,y:z,z:G},j=0){let Q=o.a3((L-j)/Math.pow(2,G)),ie=o.a4((z+1+j)/Math.pow(2,G)),re=o.a3((L+1+j)/Math.pow(2,G)),ce=o.a4((z-j)/Math.pow(2,G));return new mr([Q,ie],[re,ce])})(l.tileID.canonical,y/w);for(let L of f)if(P.intersects(L))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(l){return o._(this,void 0,void 0,(function*(){let f=l.actor?\"RT\":\"LT\";l.actor=this.actor;let y={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.abortController=new AbortController;let w=yield this.actor.sendAsync({type:f,data:y},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(w,this.map.painter,f===\"RT\")}))}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:\"RMT\",data:{uid:l.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:\"RS\",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data.updateable?{type:\"FeatureCollection\",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class Fr extends o.E{constructor(l,f,y,w){super(),this.flippedWindingOrder=!1,this.id=l,this.dispatcher=y,this.coordinates=f.coordinates,this.type=\"image\",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=f}load(l){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l(\"dataloading\",{dataType:\"source\"})),this.url=this.options.url,this._request=new AbortController;try{let f=yield xe.getImage(this.map._requestManager.transformRequest(this.url,\"Image\"),this._request);this._request=null,this._loaded=!0,f&&f.data&&(this.image=f.data,l&&(this.coordinates=l),this._finishLoading())}catch(f){this._request=null,this._loaded=!0,o.Z(f)||this.fire(new o.k(f))}}))}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l(\"data\",{dataType:\"source\",sourceDataType:\"metadata\"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;let f=l.map(o.a9.fromLngLat);var y;return this.tileID=(function(w){let P=o.aa.fromPoints(w),L=P.width(),z=P.height(),G=Math.max(L,z),j=Math.max(0,Math.floor(-Math.log(G)/Math.LN2)),Q=Math.pow(2,j);return new o.ac(j,Math.floor((P.minX+P.maxX)/2*Q),Math.floor((P.minY+P.maxY)/2*Q))})(f),this.terrainTileRanges=this._getOverlappingTileRanges(f),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=f.map((w=>this.tileID.getTilePoint(w)._round())),this.flippedWindingOrder=((y=this.tileCoords)[1].x-y[0].x)*(y[2].y-y[0].y)-(y[1].y-y[0].y)*(y[2].x-y[0].x)<0,this.fire(new o.l(\"data\",{dataType:\"source\",sourceDataType:\"content\"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let l=this.map.painter.context,f=l.gl;this.texture||(this.texture=new o.T(l,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));let y=!1;for(let w in this.tiles){let P=this.tiles[w];P.state!==\"loaded\"&&(P.state=\"loaded\",P.texture=this.texture,y=!0)}y&&this.fire(new o.l(\"data\",{dataType:\"source\",sourceDataType:\"idle\",sourceId:this.id}))}loadTile(l){return o._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state=\"errored\"}))}serialize(){return{type:\"image\",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(l){let{minX:f,minY:y,maxX:w,maxY:P}=o.aa.fromPoints(l),L={};for(let z=0;z<=o.ab;z++){let G=Math.pow(2,z),j=Math.floor(f*G),Q=Math.floor(y*G),ie=Math.floor(w*G),re=Math.floor(P*G),ce=(j%G+G)%G,de=ie%G,Te=Math.floor(j/G),Ie=Math.floor(ie/G);L[z]={minWrap:Te,maxWrap:Ie,minTileXWrapped:ce,maxTileXWrapped:de,minTileY:Q,maxTileY:re}}return L}}class eo extends Fr{constructor(l,f,y,w){super(l,f,y,w),this.roundZoom=!0,this.type=\"video\",this.options=f}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1;let l=this.options;this.urls=[];for(let f of l.urls)this.urls.push(this.map._requestManager.transformRequest(f,\"Source\").url);try{let f=yield o.ad(this.urls);if(this._loaded=!0,!f)return;this.video=f,this.video.loop=!0,this.video.addEventListener(\"playing\",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(f){this.fire(new o.k(f))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){let f=this.video.seekable;l<f.start(0)||l>f.end(0)?this.fire(new o.k(new o.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${f.start(0)} and ${f.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let l=this.map.painter.context,f=l.gl;this.texture?this.video.paused||(this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.texSubImage2D(f.TEXTURE_2D,0,0,0,f.RGBA,f.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(l,this.video,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));let y=!1;for(let w in this.tiles){let P=this.tiles[w];P.state!==\"loaded\"&&(P.state=\"loaded\",P.texture=this.texture,y=!0)}y&&this.fire(new o.l(\"data\",{dataType:\"source\",sourceDataType:\"idle\",sourceId:this.id}))}serialize(){return{type:\"video\",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class $t extends Fr{constructor(l,f,y,w){super(l,f,y,w),f.coordinates?Array.isArray(f.coordinates)&&f.coordinates.length===4&&!f.coordinates.some((P=>!Array.isArray(P)||P.length!==2||P.some((L=>typeof L!=\"number\"))))||this.fire(new o.k(new o.ae(`sources.${l}`,null,'\"coordinates\" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.ae(`sources.${l}`,null,'missing required property \"coordinates\"'))),f.animate&&typeof f.animate!=\"boolean\"&&this.fire(new o.k(new o.ae(`sources.${l}`,null,'optional \"animate\" property must be a boolean value'))),f.canvas?typeof f.canvas==\"string\"||f.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.ae(`sources.${l}`,null,'\"canvas\" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.ae(`sources.${l}`,null,'missing required property \"canvas\"'))),this.options=f,this.animate=f.animate===void 0||f.animate}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error(\"Canvas dimensions cannot be less than or equal to zero.\"))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let f=this.map.painter.context,y=f.gl;this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new o.T(f,this.canvas,y.RGBA,{premultiply:!0}),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE));let w=!1;for(let P in this.tiles){let L=this.tiles[P];L.state!==\"loaded\"&&(L.state=\"loaded\",L.texture=this.texture,w=!0)}w&&this.fire(new o.l(\"data\",{dataType:\"source\",sourceDataType:\"idle\",sourceId:this.id}))}serialize(){return{type:\"canvas\",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}let en={},Sn=I=>{switch(I){case\"geojson\":return Oi;case\"image\":return Fr;case\"raster\":return Ys;case\"raster-dem\":return Hi;case\"vector\":return Xs;case\"video\":return eo;case\"canvas\":return $t}return en[I]},Ze=\"RTLPluginLoaded\";class ae extends o.E{constructor(){super(...arguments),this.status=\"unavailable\",this.url=null,this.dispatcher=lo()}_syncState(l){return this.status=l,this.dispatcher.broadcast(\"SRPS\",{pluginStatus:l,pluginURL:this.url}).catch((f=>{throw this.status=\"error\",f}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status=\"unavailable\",this.url=null}setRTLTextPlugin(l){return o._(this,arguments,void 0,(function*(f,y=!1){if(this.url)throw new Error(\"setRTLTextPlugin cannot be called multiple times.\");if(this.url=C.resolveURL(f),!this.url)throw new Error(`requested url ${f} is invalid`);if(this.status===\"unavailable\"){if(!y)return this._requestImport();this.status=\"deferred\",this._syncState(this.status)}else if(this.status===\"requested\")return this._requestImport()}))}_requestImport(){return o._(this,void 0,void 0,(function*(){yield this._syncState(\"loading\"),this.status=\"loaded\",this.fire(new o.l(Ze))}))}lazyLoad(){this.status===\"unavailable\"?this.status=\"requested\":this.status===\"deferred\"&&this._requestImport()}}let he=null;function pe(){return he||(he=new ae),he}var ze,He;(function(I){I[I.Base=0]=\"Base\",I[I.Parent=1]=\"Parent\"})(ze||(ze={})),(function(I){I[I.Departing=0]=\"Departing\",I[I.Incoming=1]=\"Incoming\"})(He||(He={}));class ot{constructor(l,f){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=l,this.uid=o.af(),this.uses=0,this.tileSize=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state=\"loading\"}isRenderable(l){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(l||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:l,fadingDirection:f,fadingParentID:y,fadeEndTime:w}){this.resetFadeLogic(),this.fadingRole=l,this.fadingDirection=f,this.fadingParentID=y,this.fadeEndTime=w}setSelfFadeLogic(l){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=l}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=k(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state===\"errored\"||this.state===\"loaded\"||this.state===\"reloading\"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,f,y){if(this.hasData()&&this.unloadVectorData(),this.state=\"loaded\",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData,this.latestFeatureIndex.encoding=l.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=(function(w,P){let L={};if(!P)return L;for(let z of w){let G=z.layerIds.map((j=>P.getLayer(j))).filter(Boolean);if(G.length!==0){z.layers=G,z.stateDependentLayerIds&&(z.stateDependentLayers=z.stateDependentLayerIds.map((j=>G.filter((Q=>Q.id===j))[0])));for(let j of G)L[j.id]=z}}return L})(l.buckets,f?.style),this.hasSymbolBuckets=!1;for(let w in this.buckets){let P=this.buckets[w];if(P instanceof o.ah){if(this.hasSymbolBuckets=!0,!y)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let w in this.buckets){let P=this.buckets[w];if(P instanceof o.ah&&P.hasRTLText){this.hasRTLText=!0,pe().lazyLoad();break}}this.queryPadding=0;for(let w in this.buckets){let P=this.buckets[w];this.queryPadding=Math.max(this.queryPadding,f.style.getLayer(w).queryRadius(P))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage),this.dashPositions=l.dashPositions}else this.collisionBoxArray=new o.ag}unloadVectorData(){for(let l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state=\"unloaded\"}getBucket(l){return this.buckets[l.id]}upload(l){for(let y in this.buckets){let w=this.buckets[y];w.uploadPending()&&w.upload(l)}let f=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(l,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(l,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,f,y,w,P,L,z,G,j,Q,ie){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:w,cameraQueryGeometry:P,scale:L,tileSize:this.tileSize,pixelPosMatrix:Q,transform:G,params:z,queryPadding:this.queryPadding*j,getElevation:ie},l,f,y):{}}querySourceFeatures(l,f){let y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;let w=y.loadVTLayers(),P=f&&f.sourceLayer?f.sourceLayer:\"\",L=w[o.ai]||w[P];if(!L)return;let z=o.aj(f?.filter,f?.globalState),{z:G,x:j,y:Q}=this.tileID.canonical,ie={z:G,x:j,y:Q};for(let re=0;re<L.length;re++){let ce=L.feature(re);if(z.needGeometry){let Ie=o.ak(ce,!0);if(!z.filter(new o.H(this.tileID.overscaledZ),Ie,this.tileID.canonical))continue}else if(!z.filter(new o.H(this.tileID.overscaledZ),ce))continue;let de=y.getId(ce,P),Te=new o.al(ce,G,j,Q,de);Te.tile=ie,l.push(Te)}}hasData(){return this.state===\"loaded\"||this.state===\"reloading\"||this.state===\"expired\"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){let f=this.expirationTime;if(l.cacheControl){let y=o.am(l.cacheControl);y[\"max-age\"]&&(this.expirationTime=Date.now()+1e3*y[\"max-age\"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){let y=Date.now(),w=!1;if(this.expirationTime>y)w=!1;else if(f)if(this.expirationTime<f)w=!0;else{let P=this.expirationTime-f;P?this.expirationTime=y+Math.max(P,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state=\"expired\"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,f){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;let y=this.latestFeatureIndex.loadVTLayers();for(let w in this.buckets){if(!f.style.hasLayer(w))continue;let P=this.buckets[w],L=P.layers[0].sourceLayer||o.ai,z=y[L],G=l[L];if(!z||!G||Object.keys(G).length===0)continue;P.update(G,z,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});let j=f&&f.style&&f.style.getLayer(w);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(P)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<k()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(l){this.symbolFadeHoldUntil=k()+l}setDependencies(l,f){let y={};for(let w of f)y[w]=!0;this.dependencies[l]=y}hasDependency(l,f){for(let y of l){let w=this.dependencies[y];if(w){for(let P of f)if(w[P])return!0}}return!1}}class tt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,f,y){let w=String(f);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][w]=this.stateChanges[l][w]||{},o.e(this.stateChanges[l][w],y),this.deletedStates[l]===null){this.deletedStates[l]={};for(let P in this.state[l])P!==w&&(this.deletedStates[l][P]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][w]===null){this.deletedStates[l][w]={};for(let P in this.state[l][w])y[P]||(this.deletedStates[l][w][P]=null)}else for(let P in y)this.deletedStates[l]&&this.deletedStates[l][w]&&this.deletedStates[l][w][P]===null&&delete this.deletedStates[l][w][P]}removeFeatureState(l,f,y){if(this.deletedStates[l]===null)return;let w=String(f);if(this.deletedStates[l]=this.deletedStates[l]||{},y&&f!==void 0)this.deletedStates[l][w]!==null&&(this.deletedStates[l][w]=this.deletedStates[l][w]||{},this.deletedStates[l][w][y]=null);else if(f!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][w])for(y in this.deletedStates[l][w]={},this.stateChanges[l][w])this.deletedStates[l][w][y]=null;else this.deletedStates[l][w]=null;else this.deletedStates[l]=null}getState(l,f){let y=String(f),w=o.e({},(this.state[l]||{})[y],(this.stateChanges[l]||{})[y]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){let P=this.deletedStates[l][f];if(P===null)return{};for(let L in P)delete w[L]}return w}initializeTileState(l,f){l.setFeatureState(this.state,f)}coalesceChanges(l,f){let y={};for(let w in this.stateChanges){this.state[w]=this.state[w]||{};let P={};for(let L in this.stateChanges[w])this.state[w][L]||(this.state[w][L]={}),o.e(this.state[w][L],this.stateChanges[w][L]),P[L]=this.state[w][L];y[w]=P}for(let w in this.deletedStates){this.state[w]=this.state[w]||{};let P={};if(this.deletedStates[w]===null)for(let L in this.state[w])P[L]={},this.state[w][L]={};else for(let L in this.deletedStates[w]){if(this.deletedStates[w][L]===null)this.state[w][L]={};else for(let z of Object.keys(this.deletedStates[w][L]))delete this.state[w][L][z];P[L]=this.state[w][L]}y[w]=y[w]||{},o.e(y[w],P)}this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0&&l.setFeatureState(y,f)}}let Je=89.25;function nt(I,l){let f=o.an(l.lat,-o.ao,o.ao);return new o.P(o.Y(l.lng)*I,o.X(f)*I)}function Dt(I,l){return new o.a9(l.x/I,l.y/I).toLngLat()}function vt(I){return I.cameraToCenterDistance*Math.min(.85*Math.tan(o.ap(90-I.pitch)),Math.tan(o.ap(Je-I.pitch)))}function Vt(I,l){let f=I.canonical,y=l/o.aq(f.z),w=f.x+Math.pow(2,f.z)*I.wrap,P=o.ar(new Float64Array(16));return o.O(P,P,[w*y,f.y*y,0]),o.Q(P,P,[y/o.a5,y/o.a5,1]),P}function Ke(I,l,f,y,w){let P=o.a9.fromLngLat(I,l),L=w*o.as(1,I.lat),{x:z,y:G,z:j}=zn(f,y);return new o.a9(P.x+L*-z,P.y+L*-G,P.z+L*-j)}function zn(I,l){let f=o.ap(I),y=o.ap(l),w=Math.cos(-f),P=Math.sin(f);return{x:P*Math.sin(y),y:-P*Math.cos(y),z:w}}function Wr(I,l,f){let y=l.intersectsFrustum(I);if(!f||y===0)return y;let w=l.intersectsPlane(f);return w===0?0:y===2&&w===2?2:1}function fn(I,l,f){let y=0,w=(f-l)/10;for(let P=0;P<10;P++)y+=w*Math.pow(Math.cos(l+(P+.5)/10*(f-l)),I);return y}function ln(I,l){return function(f,y,w,P,L){let z=2*((I-1)/o.at(Math.cos(o.ap(Je-L))/Math.cos(o.ap(Je)))-1),G=Math.acos(w/P),j=2*fn(z-1,0,o.ap(L/2)),Q=Math.min(o.ap(Je),G+o.ap(L/2)),ie=fn(z-1,Math.min(Q,G-o.ap(L/2)),Q),re=Math.atan(y/w),ce=Math.hypot(y,w),de=f;return de+=o.at(P/ce/Math.max(.5,Math.cos(o.ap(L/2)))),de+=z*o.at(Math.cos(re))/2,de-=o.at(Math.max(1,ie/j/l))/2,de}}let Nn=ln(9.314,3);function Ir(I,l){let f=(l.roundZoom?Math.round:Math.floor)(I.zoom+o.at(I.tileSize/l.tileSize));return Math.max(0,f)}function Et(I,l){let f=I.getCameraFrustum(),y=I.getClippingPlane(),w=I.screenPointToMercatorCoordinate(I.getCameraPoint()),P=o.a9.fromLngLat(I.center,I.elevation);w.z=P.z+Math.cos(I.pitchInRadians)*I.cameraToCenterDistance/I.worldSize;let L=I.getCoveringTilesDetailsProvider(),z=L.allowVariableZoom(I,l),G=Ir(I,l),j=l.minzoom||0,Q=l.maxzoom!==void 0?l.maxzoom:I.maxZoom,ie=Math.min(Math.max(0,G),Q),re=Math.pow(2,ie),ce=[re*w.x,re*w.y,0],de=[re*P.x,re*P.y,0],Te=Math.hypot(P.x-w.x,P.y-w.y),Ie=Math.abs(P.z-w.z),Me=Math.hypot(Te,Ie),Oe=Ge=>({zoom:0,x:0,y:0,wrap:Ge,fullyVisible:!1}),We=[],De=[];if(I.renderWorldCopies&&L.allowWorldCopies())for(let Ge=1;Ge<=3;Ge++)We.push(Oe(-Ge)),We.push(Oe(Ge));for(We.push(Oe(0));We.length>0;){let Ge=We.pop(),Be=Ge.x,Fe=Ge.y,Ve=Ge.fullyVisible,ct={x:Be,y:Fe,z:Ge.zoom},dt=L.getTileBoundingVolume(ct,Ge.wrap,I.elevation,l);if(!Ve){let Ut=Wr(f,dt,y);if(Ut===0)continue;Ve=Ut===2}let pt=L.distanceToTile2d(w.x,w.y,ct,dt),ft=G;z&&(ft=(l.calculateTileZoom||Nn)(I.zoom+o.at(I.tileSize/l.tileSize),pt,Ie,Me,I.fov)),ft=(l.roundZoom?Math.round:Math.floor)(ft),ft=Math.max(0,ft);let Xt=Math.min(ft,Q);if(Ge.wrap=L.getWrap(P,ct,Ge.wrap),Ge.zoom>=Xt){if(Ge.zoom<j)continue;let Ut=ie-Ge.zoom,Bt=ce[0]-.5-(Be<<Ut),Jt=ce[1]-.5-(Fe<<Ut),jn=l.reparseOverscaled?Math.max(Ge.zoom,ft):Ge.zoom;De.push({tileID:new o.a2(Ge.zoom===Q?jn:Ge.zoom,Ge.wrap,Ge.zoom,Be,Fe),distanceSq:o.au([de[0]-.5-Be,de[1]-.5-Fe]),tileDistanceToCamera:Math.sqrt(Bt*Bt+Jt*Jt)})}else for(let Ut=0;Ut<4;Ut++)We.push({zoom:Ge.zoom+1,x:(Be<<1)+Ut%2,y:(Fe<<1)+(Ut>>1),wrap:Ge.wrap,fullyVisible:Ve})}return De.sort(((Ge,Be)=>Ge.distanceSq-Be.distanceSq)).map((Ge=>Ge.tileID))}let di=o.aa.fromPoints([new o.P(0,0),new o.P(o.a5,o.a5)]);function pi(I){return I===\"raster\"||I===\"image\"||I===\"video\"}function ti(I,l,f,y,w,P,L){if(!l.hasData())return!1;let{tileID:z,fadingRole:G,fadingDirection:j,fadingParentID:Q}=l;if(G===ze.Base&&j===He.Incoming&&Q)return f[Q.key]=Q,!0;let ie=Math.max(z.overscaledZ-w,P);for(let re=z.overscaledZ-1;re>=ie;re--){let ce=z.scaledTo(re),de=I.getLoadedTile(ce);if(de)return l.setCrossFadeLogic({fadingRole:ze.Base,fadingDirection:He.Incoming,fadingParentID:de.tileID,fadeEndTime:y+L}),de.setCrossFadeLogic({fadingRole:ze.Parent,fadingDirection:He.Departing,fadeEndTime:y+L}),f[ce.key]=ce,!0}return!1}function Wi(I,l,f,y,w,P){if(!l.hasData())return!1;let L=l.tileID.children(w),z=Lt(I,l,L,f,y,w,P);if(z)return!0;for(let G of L)Lt(I,l,G.children(w),f,y,w,P)&&(z=!0);return z}function Lt(I,l,f,y,w,P,L){if(f[0].overscaledZ>=P)return!1;let z=!1;for(let G of f){let j=I.getLoadedTile(G);if(!j)continue;let{fadingRole:Q,fadingDirection:ie,fadingParentID:re}=j;Q===ze.Base&&ie===He.Departing&&re||(j.setCrossFadeLogic({fadingRole:ze.Base,fadingDirection:He.Departing,fadingParentID:l.tileID,fadeEndTime:w+L}),l.setCrossFadeLogic({fadingRole:ze.Parent,fadingDirection:He.Incoming,fadeEndTime:w+L})),y[G.key]=G,z=!0}return z}function Ai(I,l,f,y){let w=I.tileID;return!!I.selfFading||!I.hasData()&&!!l.has(w)&&(I.setSelfFadeLogic(f+y),!0)}function Vo(I,l){var f;I.needsHillshadePrepare=!0,I.needsTerrainPrepare=!0;let y=l.tileID.canonical.x-I.tileID.canonical.x,w=l.tileID.canonical.y-I.tileID.canonical.y,P=Math.pow(2,I.tileID.canonical.z),L=l.tileID.key;y===0&&w===0||Math.abs(w)>1||(Math.abs(y)>1&&(Math.abs(y+P)===1?y+=P:Math.abs(y-P)===1&&(y-=P)),l.dem&&I.dem&&(I.dem.backfillBorder(l.dem,y,w),!((f=I.neighboringTiles)===null||f===void 0)&&f[L]&&(I.neighboringTiles[L].backfilled=!0)))}class Es{constructor(){this._tiles={}}handleWrapJump(l){let f={};for(let y in this._tiles){let w=this._tiles[y];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),f[w.tileID.key]=w}this._tiles=f}setFeatureState(l,f){for(let y in this._tiles)this._tiles[y].setFeatureState(l,f)}getAllTiles(){return Object.values(this._tiles)}getAllIds(l=!1){return l?Object.values(this._tiles).map((f=>f.tileID)).sort(o.aw).map((f=>f.key)):Object.keys(this._tiles)}getTileById(l){return this._tiles[l]}setTile(l,f){this._tiles[l]=f}deleteTileById(l){delete this._tiles[l]}getLoadedTile(l){let f=this.getTileById(l.key);return f?.hasData()?f:null}isIdRenderable(l,f=!1){var y;return(y=this.getTileById(l))===null||y===void 0?void 0:y.isRenderable(f)}getRenderableIds(l=0,f){let y=[];for(let w of this.getAllIds())this.isIdRenderable(w,f)&&y.push(this.getTileById(w));return f?y.sort(((w,P)=>{let L=w.tileID,z=P.tileID,G=new o.P(L.canonical.x,L.canonical.y)._rotate(-l),j=new o.P(z.canonical.x,z.canonical.y)._rotate(-l);return L.overscaledZ-z.overscaledZ||j.y-G.y||j.x-G.x})).map((w=>w.tileID.key)):y.map((w=>w.tileID)).sort(o.aw).map((w=>w.key))}}class qr extends o.E{constructor(l,f,y){super(),this.id=l,this.dispatcher=y,this.on(\"data\",(w=>this._dataHandler(w))),this.on(\"dataloading\",(()=>{this._sourceErrored=!1})),this.on(\"error\",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((w,P,L,z)=>{let G=new(Sn(P.type))(w,P,L,z);if(G.id!==w)throw new Error(`Expected Source id to be ${w} instead of ${G.id}`);return G})(l,f,y,this),this._inViewTiles=new Es,this._outOfViewCache=new o.ax(0,(w=>this._unloadTile(w))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new tt,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){for(let f of this._inViewTiles.getAllTiles())f.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l),this._inViewTiles=new Es}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let l of this._inViewTiles.getAllTiles())if(l.state!==\"loaded\"&&l.state!==\"errored\")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;let l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,f,y){return o._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,f,y)}catch(w){l.state=\"errored\",w.status!==404?this._source.fire(new o.k(w,{tile:l})):this.update(this.transform,this.terrain)}}))}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new o.l(\"dataabort\",{tile:l,coord:l.tileID,dataType:\"source\"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(let f of this._inViewTiles.getAllTiles())f.upload(l),f.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(l){var f;return this._inViewTiles.getRenderableIds((f=this.transform)===null||f===void 0?void 0:f.bearingInRadians,l)}hasRenderableParent(l){let f=l.overscaledZ-1;if(f>=this._source.minzoom){let y=this.getLoadedTile(l.scaledTo(f));if(y)return this._inViewTiles.isIdRenderable(y.tileID.key)}return!1}reload(l,f=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(let y of this._inViewTiles.getAllIds()){let w=this._inViewTiles.getTileById(y);f&&!this._source.shouldReloadTile(w,f)||(l?this._reloadTile(y,\"expired\"):w.state!==\"errored\"&&this._reloadTile(y,\"reloading\"))}}}_reloadTile(l,f){return o._(this,void 0,void 0,(function*(){let y=this._inViewTiles.getTileById(l);y&&(y.state!==\"loading\"&&(y.state=f),yield this._loadTile(y,l,f))}))}_tileLoaded(l,f,y){l.timeAdded=k(),l.selfFading&&(l.fadeEndTime=l.timeAdded+this._rasterFadeDuration),y===\"expired\"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(f,l),this.getSource().type===\"raster-dem\"&&l.dem&&(function(w,P){var L,z;let G=P.getRenderableIds();for(let j of G){if(!w.neighboringTiles||!w.neighboringTiles[j])continue;let Q=P.getTileById(j);w.neighboringTiles[j].backfilled||Vo(w,Q),!((z=(L=Q.neighboringTiles)===null||L===void 0?void 0:L[w.tileID.key])===null||z===void 0)&&z.backfilled||Vo(Q,w)}})(l,this._inViewTiles),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new o.l(\"data\",{dataType:\"source\",tile:l,coord:l.tileID}))}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._inViewTiles.getTileById(l)}_retainLoadedChildren(l,f){let y=this._getLoadedDescendents(f),w=new Set;for(let P of f){let L=y[P.key];if(!L?.length){w.add(P);continue}let z=P.overscaledZ+qr.maxOverzooming,G=L.filter((ie=>ie.tileID.overscaledZ<=z));if(!G.length){w.add(P);continue}let j=Math.min(...G.map((ie=>ie.tileID.overscaledZ))),Q=G.filter((ie=>ie.tileID.overscaledZ===j)).map((ie=>ie.tileID));for(let ie of Q)l[ie.key]=ie;this._areDescendentsComplete(Q,j,P.overscaledZ)||w.add(P)}return w}_getLoadedDescendents(l){var f;let y={};for(let w of this._inViewTiles.getAllTiles().filter((P=>P.hasData())))for(let P of l)w.tileID.isChildOf(P)&&(y[f=P.key]||(y[f]=[])).push(w);return y}_areDescendentsComplete(l,f,y){return l.length===1&&l[0].isOverscaled()?l[0].overscaledZ===f:Math.pow(4,f-y)===l.length}getLoadedTile(l){return this._inViewTiles.getLoadedTile(l)}updateCacheSize(l){let f=Math.ceil(l.width/this._source.tileSize)+1,y=Math.ceil(l.height/this._source.tileSize)+1,w=Math.floor(f*y*(this._maxTileCacheZoomLevels===null?o.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),P=typeof this._maxTileCacheSize==\"number\"?Math.min(this._maxTileCacheSize,w):w;this._outOfViewCache.setMaxSize(P)}handleWrapJump(l){let f=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);this._prevLng=l,f&&(this._inViewTiles.handleWrapJump(f),this._resetTileReloadTimers())}update(l,f){if(!this._sourceLoaded||this._paused)return;let y;this.transform=l,this.terrain=f,this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?y=l.getVisibleUnwrappedCoordinates(this._source.tileID).map((G=>new o.a2(G.canonical.z,G.wrap,G.canonical.z,G.canonical.x,G.canonical.y))):(y=Et(l,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type===\"vector\"&&this.map._zoomLevelsToOverscale!==void 0?l.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:f,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(y=y.filter((G=>this._source.hasTile(G))))):y=[],this.usedForTerrain&&(y=this._addTerrainIdealTiles(y));let w=y.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new o.l(\"data\",{sourceDataType:\"idle\",dataType:\"source\",sourceId:this.id}));let P=Ir(l,this._source),L=this._updateRetainedTiles(y,P),z=pi(this._source.type);z&&this._rasterFadeDuration>0&&!f&&(function(G,j,Q,ie,re,ce,de){let Te=k(),Ie=o.av(j);for(let Me of j){let Oe=G.getTileById(Me.key);Oe.fadingDirection!==He.Departing&&Oe.fadeOpacity!==0||Oe.resetFadeLogic(),ti(G,Oe,Q,Te,ie,re,de)||Wi(G,Oe,Q,Te,ce,de)||Ai(Oe,Ie,Te,de)||Oe.resetFadeLogic()}})(this._inViewTiles,y,L,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),z?this._cleanUpRasterTiles(L):this._cleanUpVectorTiles(L)}_cleanUpRasterTiles(l){for(let f of this._inViewTiles.getAllIds())l[f]||this._removeTile(f)}_cleanUpVectorTiles(l){for(let f of this._inViewTiles.getAllIds()){let y=this._inViewTiles.getTileById(f);l[f]?y.clearSymbolFadeHold():y.hasSymbolBuckets?y.holdingForSymbolFade()?y.symbolFadeFinished()&&this._removeTile(f):y.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(f)}}_addTerrainIdealTiles(l){let f=[];for(let y of l)if(y.canonical.z>this._source.minzoom){let w=y.scaledTo(y.canonical.z-1);f.push(w);let P=y.scaledTo(Math.max(this._source.minzoom,Math.min(y.canonical.z,5)));f.push(P)}return l.concat(f)}releaseSymbolFadeTiles(){for(let l of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(l).holdingForSymbolFade()&&this._removeTile(l)}_updateRetainedTiles(l,f){var y;let w=new Set;for(let j of l)this._addTile(j).hasData()||w.add(j);let P=l.reduce(((j,Q)=>(j[Q.key]=Q,j)),{}),L=this._retainLoadedChildren(P,w),z={},G=Math.max(f-qr.maxUnderzooming,this._source.minzoom);for(let j of L){let Q=this._inViewTiles.getTileById(j.key),ie=Q?.wasRequested();for(let re=j.overscaledZ-1;re>=G;--re){let ce=j.scaledTo(re);if(z[ce.key])break;if(z[ce.key]=!0,Q=this.getTile(ce),!Q&&ie&&(Q=this._addTile(ce)),Q){let de=Q.hasData();if((de||!(!((y=this.map)===null||y===void 0)&&y.cancelPendingTileRequestsWhileZooming)||ie)&&(P[ce.key]=ce),ie=Q.wasRequested(),de)break}}}return P}_addTile(l){let f=this._inViewTiles.getTileById(l.key);if(f)return f;f=this._outOfViewCache.getAndRemove(l),f&&(f.resetFadeLogic(),this._setTileReloadTimer(l.key,f),f.tileID=l,this._state.initializeTileState(f,this.map?this.map.painter:null));let y=f;return f||(f=new ot(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(f,l.key,f.state)),f.uses++,this._inViewTiles.setTile(l.key,f),y||this._source.fire(new o.l(\"dataloading\",{tile:f,coord:f.tileID,dataType:\"source\"})),f}_setTileReloadTimer(l,f){this._clearTileReloadTimer(l);let y=f.getExpiryTimeout();y&&(this._timers[l]=setTimeout((()=>{this._reloadTile(l,\"expired\"),delete this._timers[l]}),y))}_clearTileReloadTimer(l){let f=this._timers[l];f&&(clearTimeout(f),delete this._timers[l])}_resetTileReloadTimers(){for(let l in this._timers)clearTimeout(this._timers[l]),delete this._timers[l];for(let l of this._inViewTiles.getAllIds()){let f=this._inViewTiles.getTileById(l);this._setTileReloadTimer(l,f)}}refreshTiles(l){for(let f of this._inViewTiles.getAllIds()){let y=this._inViewTiles.getTileById(f);(this._inViewTiles.isIdRenderable(f)||y.state==\"errored\")&&l.some((w=>w.equals(y.tileID.canonical)))&&this._reloadTile(f,\"expired\")}}_removeTile(l){let f=this._inViewTiles.getTileById(l);f&&(f.uses--,this._inViewTiles.deleteTileById(l),this._clearTileReloadTimer(l),f.uses>0||(f.hasData()&&f.state!==\"reloading\"?this._outOfViewCache.add(f.tileID,f,f.getExpiryTimeout()):(f.aborted=!0,this._abortTile(f),this._unloadTile(f))))}_dataHandler(l){l.dataType===\"source\"&&(l.sourceDataType!==\"metadata\"?l.sourceDataType===\"content\"&&this._sourceLoaded&&!this._paused&&(this.reload(l.sourceDataChanged,l.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let l of this._inViewTiles.getAllIds())this._removeTile(l);this._outOfViewCache.reset()}tilesIn(l,f,y){let w=[],P=this.transform;if(!P)return w;let L=P.getCoveringTilesDetailsProvider().allowWorldCopies(),z=y?P.getCameraQueryGeometry(l):l,G=ce=>P.screenPointToMercatorCoordinate(ce,this.terrain),j=this.transformBbox(l,G,!L),Q=this.transformBbox(z,G,!L),ie=this.getIds(),re=o.aa.fromPoints(Q);for(let ce=0;ce<ie.length;ce++){let de=this._inViewTiles.getTileById(ie[ce]);if(de.holdingForSymbolFade())continue;let Te=L?[de.tileID]:[de.tileID.unwrapTo(-1),de.tileID.unwrapTo(0)],Ie=Math.pow(2,P.zoom-de.tileID.overscaledZ),Me=f*de.queryPadding*o.a5/de.tileSize/Ie;for(let Oe of Te){let We=re.map((De=>Oe.getTilePoint(new o.a9(De.x,De.y))));if(We.expandBy(Me),We.intersects(di)){let De=j.map((Be=>Oe.getTilePoint(Be))),Ge=Q.map((Be=>Oe.getTilePoint(Be)));w.push({tile:de,tileID:L?Oe:Oe.unwrapTo(0),queryGeometry:De,cameraQueryGeometry:Ge,scale:Ie})}}}return w}transformBbox(l,f,y){let w=l.map(f);if(y){let P=o.aa.fromPoints(l);P.shrinkBy(.001*Math.min(P.width(),P.height()));let L=P.map(f);o.aa.fromPoints(w).covers(L)||(w=w.map((z=>z.x>.5?new o.a9(z.x-1,z.y,z.z):z)))}return w}getVisibleCoordinates(l){let f=this.getRenderableIds(l).map((y=>this._inViewTiles.getTileById(y).tileID));return this.transform&&this.transform.populateCache(f),f}hasTransition(){return!!this._source.hasTransition()||!(!pi(this._source.type)||!(function(l,f){if(f<=0)return!1;let y=k();for(let w of l.getAllTiles())if(w.fadeEndTime>=y)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(l){this._rasterFadeDuration=l}setFeatureState(l,f,y){this._state.updateState(l=l||o.ai,f,y)}removeFeatureState(l,f,y){this._state.removeFeatureState(l=l||o.ai,f,y)}getFeatureState(l,f){return this._state.getState(l=l||o.ai,f)}setDependencies(l,f,y){let w=this._inViewTiles.getTileById(l);w&&w.setDependencies(f,y)}reloadTilesForDependencies(l,f){for(let y of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(y).hasDependency(l,f)&&this._reloadTile(y,\"reloading\");this._outOfViewCache.filter((y=>!y.hasDependency(l,f)))}areTilesLoaded(){for(let l of this._inViewTiles.getAllTiles())if(l.state!==\"loaded\"&&l.state!==\"errored\")return!1;return!0}}qr.maxUnderzooming=10,qr.maxOverzooming=3;class Yt{constructor(l,f){this.reset(l,f)}reset(l,f){this.points=l||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.an(l,0,1);let f=1,y=this._distances[f],w=l*this.paddedLength+this.padding;for(;y<w&&f<this._distances.length;)y=this._distances[++f];let P=f-1,L=this._distances[P],z=y-L,G=z>0?(w-L)/z:0;return this.points[P].mult(1-G).add(this.points[f].mult(G))}}function kn(I,l){let f=!0;return I===\"always\"||I!==\"never\"&&l!==\"never\"||(f=!1),f}class Hn{constructor(l,f,y){let w=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(l/y),this.yCellCount=Math.ceil(f/y);for(let L=0;L<this.xCellCount*this.yCellCount;L++)w.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=f,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,f,y,w,P){this._forEachCell(f,y,w,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(w),this.bboxes.push(P)}insertCircle(l,f,y,w){this._forEachCell(f-w,y-w,f+w,y+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(f),this.circles.push(y),this.circles.push(w)}_insertBoxCell(l,f,y,w,P,L){this.boxCells[P].push(L)}_insertCircleCell(l,f,y,w,P,L){this.circleCells[P].push(L)}_query(l,f,y,w,P,L,z){if(y<0||l>this.width||w<0||f>this.height)return[];let G=[];if(l<=0&&f<=0&&this.width<=y&&this.height<=w){if(P)return[{key:null,x1:l,y1:f,x2:y,y2:w}];for(let j=0;j<this.boxKeys.length;j++)G.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(let j=0;j<this.circleKeys.length;j++){let Q=this.circles[3*j],ie=this.circles[3*j+1],re=this.circles[3*j+2];G.push({key:this.circleKeys[j],x1:Q-re,y1:ie-re,x2:Q+re,y2:ie+re})}}else this._forEachCell(l,f,y,w,this._queryCell,G,{hitTest:P,overlapMode:L,seenUids:{box:{},circle:{}}},z);return G}query(l,f,y,w){return this._query(l,f,y,w,!1,null)}hitTest(l,f,y,w,P,L){return this._query(l,f,y,w,!0,P,L).length>0}hitTestCircle(l,f,y,w,P){let L=l-y,z=l+y,G=f-y,j=f+y;if(z<0||L>this.width||j<0||G>this.height)return!1;let Q=[];return this._forEachCell(L,G,z,j,this._queryCellCircle,Q,{hitTest:!0,overlapMode:w,circle:{x:l,y:f,radius:y},seenUids:{box:{},circle:{}}},P),Q.length>0}_queryCell(l,f,y,w,P,L,z,G){let{seenUids:j,hitTest:Q,overlapMode:ie}=z,re=this.boxCells[P];if(re!==null){let de=this.bboxes;for(let Te of re)if(!j.box[Te]){j.box[Te]=!0;let Ie=4*Te,Me=this.boxKeys[Te];if(l<=de[Ie+2]&&f<=de[Ie+3]&&y>=de[Ie+0]&&w>=de[Ie+1]&&(!G||G(Me))&&(!Q||!kn(ie,Me.overlapMode))&&(L.push({key:Me,x1:de[Ie],y1:de[Ie+1],x2:de[Ie+2],y2:de[Ie+3]}),Q))return!0}}let ce=this.circleCells[P];if(ce!==null){let de=this.circles;for(let Te of ce)if(!j.circle[Te]){j.circle[Te]=!0;let Ie=3*Te,Me=this.circleKeys[Te];if(this._circleAndRectCollide(de[Ie],de[Ie+1],de[Ie+2],l,f,y,w)&&(!G||G(Me))&&(!Q||!kn(ie,Me.overlapMode))){let Oe=de[Ie],We=de[Ie+1],De=de[Ie+2];if(L.push({key:Me,x1:Oe-De,y1:We-De,x2:Oe+De,y2:We+De}),Q)return!0}}}return!1}_queryCellCircle(l,f,y,w,P,L,z,G){let{circle:j,seenUids:Q,overlapMode:ie}=z,re=this.boxCells[P];if(re!==null){let de=this.bboxes;for(let Te of re)if(!Q.box[Te]){Q.box[Te]=!0;let Ie=4*Te,Me=this.boxKeys[Te];if(this._circleAndRectCollide(j.x,j.y,j.radius,de[Ie+0],de[Ie+1],de[Ie+2],de[Ie+3])&&(!G||G(Me))&&!kn(ie,Me.overlapMode))return L.push(!0),!0}}let ce=this.circleCells[P];if(ce!==null){let de=this.circles;for(let Te of ce)if(!Q.circle[Te]){Q.circle[Te]=!0;let Ie=3*Te,Me=this.circleKeys[Te];if(this._circlesCollide(de[Ie],de[Ie+1],de[Ie+2],j.x,j.y,j.radius)&&(!G||G(Me))&&!kn(ie,Me.overlapMode))return L.push(!0),!0}}}_forEachCell(l,f,y,w,P,L,z,G){let j=this._convertToXCellCoord(l),Q=this._convertToYCellCoord(f),ie=this._convertToXCellCoord(y),re=this._convertToYCellCoord(w);for(let ce=j;ce<=ie;ce++)for(let de=Q;de<=re;de++)if(P.call(this,l,f,y,w,this.xCellCount*de+ce,L,z,G))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,f,y,w,P,L){let z=w-l,G=P-f,j=y+L;return j*j>z*z+G*G}_circleAndRectCollide(l,f,y,w,P,L,z){let G=(L-w)/2,j=Math.abs(l-(w+G));if(j>G+y)return!1;let Q=(z-P)/2,ie=Math.abs(f-(P+Q));if(ie>Q+y)return!1;if(j<=G||ie<=Q)return!0;let re=j-G,ce=ie-Q;return re*re+ce*ce<=y*y}}function Qo(I,l,f){let y=o.N();if(!I){let{vecSouth:ie,vecEast:re}=$a(l),ce=c();ce[0]=re[0],ce[1]=re[1],ce[2]=ie[0],ce[3]=ie[1],w=ce,(Q=(L=(P=ce)[0])*(j=P[3])-(G=P[2])*(z=P[1]))&&(w[0]=j*(Q=1/Q),w[1]=-z*Q,w[2]=-G*Q,w[3]=L*Q),y[0]=ce[0],y[1]=ce[1],y[4]=ce[2],y[5]=ce[3]}var w,P,L,z,G,j,Q;return o.Q(y,y,[1/f,1/f,1]),y}function Pc(I,l,f,y){if(I){let w=o.N();if(!l){let{vecSouth:P,vecEast:L}=$a(f);w[0]=L[0],w[1]=L[1],w[4]=P[0],w[5]=P[1]}return o.Q(w,w,[y,y,1]),w}return f.pixelsToClipSpaceMatrix}function $a(I){let l=Math.cos(I.rollInRadians),f=Math.sin(I.rollInRadians),y=Math.cos(I.pitchInRadians),w=Math.cos(I.bearingInRadians),P=Math.sin(I.bearingInRadians),L=o.aC();L[0]=-w*y*f-P*l,L[1]=-P*y*f+w*l;let z=o.aD(L);z<1e-9?o.aE(L):o.aF(L,L,1/z);let G=o.aC();G[0]=w*y*l-P*f,G[1]=P*y*l+w*f;let j=o.aD(G);return j<1e-9?o.aE(G):o.aF(G,G,1/j),{vecEast:G,vecSouth:L}}function Un(I,l,f,y){let w;y?(w=[I,l,y(I,l),1],o.aH(w,w,f)):(w=[I,l,0,1],ph(w,w,f));let P=w[3];return{point:new o.P(w[0]/P,w[1]/P),signedDistanceFromCamera:P,isOccluded:!1}}function Ko(I,l){return .5+I/l*.5}function mu(I,l){return I.x>=-l[0]&&I.x<=l[0]&&I.y>=-l[1]&&I.y<=l[1]}function hs(I,l,f,y,w,P,L,z,G,j,Q,ie,re){let ce=f?I.textSizeData:I.iconSizeData,de=o.ay(ce,l.transform.zoom),Te=[256/l.width*2+1,256/l.height*2+1],Ie=f?I.text.dynamicLayoutVertexArray:I.icon.dynamicLayoutVertexArray;Ie.clear();let Me=I.lineVertexArray,Oe=f?I.text.placedSymbolArray:I.icon.placedSymbolArray,We=l.transform.width/l.transform.height,De=!1;for(let Ge=0;Ge<Oe.length;Ge++){let Be=Oe.get(Ge);if(Be.hidden||Be.writingMode===o.az.vertical&&!De){$o(Be.numGlyphs,Ie);continue}De=!1;let Fe=new o.P(Be.anchorX,Be.anchorY),Ve={getElevation:re,pitchedLabelPlaneMatrix:y,lineVertexArray:Me,pitchWithMap:P,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:l.transform,tileAnchorPoint:Fe,unwrappedTileID:G,width:j,height:Q,translation:ie},ct=Il(Be.anchorX,Be.anchorY,Ve);if(!mu(ct.point,Te)){$o(Be.numGlyphs,Ie);continue}let dt=Ko(l.transform.cameraToCenterDistance,ct.signedDistanceFromCamera),pt=o.aA(ce,de,Be),ft=P?pt*l.transform.getPitchedTextCorrection(Be.anchorX,Be.anchorY,G)/dt:pt*dt,Xt=Zs({projectionContext:Ve,pitchedLabelPlaneMatrixInverse:w,symbol:Be,fontSize:ft,flip:!1,keepUpright:L,glyphOffsetArray:I.glyphOffsetArray,dynamicLayoutVertexArray:Ie,aspectRatio:We,rotateToLine:z});De=Xt.useVertical,(Xt.notEnoughRoom||De||Xt.needsFlipping&&Zs({projectionContext:Ve,pitchedLabelPlaneMatrixInverse:w,symbol:Be,fontSize:ft,flip:!0,keepUpright:L,glyphOffsetArray:I.glyphOffsetArray,dynamicLayoutVertexArray:Ie,aspectRatio:We,rotateToLine:z}).notEnoughRoom)&&$o(Be.numGlyphs,Ie)}f?I.text.dynamicLayoutVertexBuffer.updateData(Ie):I.icon.dynamicLayoutVertexBuffer.updateData(Ie)}function Ml(I,l,f,y,w,P,L,z){let G=P.glyphStartIndex+P.numGlyphs,j=P.lineStartIndex,Q=P.lineStartIndex+P.lineLength,ie=l.getoffsetX(P.glyphStartIndex),re=l.getoffsetX(G-1),ce=Do(I*ie,f,y,w,P.segment,j,Q,z,L);if(!ce)return null;let de=Do(I*re,f,y,w,P.segment,j,Q,z,L);return de?z.projectionCache.anyProjectionOccluded?null:{first:ce,last:de}:null}function Ss(I,l,f,y){return I===o.az.horizontal&&Math.abs(f.y-l.y)>Math.abs(f.x-l.x)*y?{useVertical:!0}:(I===o.az.vertical?l.y<f.y:l.x>f.x)?{needsFlipping:!0}:null}function Zs(I){let{projectionContext:l,pitchedLabelPlaneMatrixInverse:f,symbol:y,fontSize:w,flip:P,keepUpright:L,glyphOffsetArray:z,dynamicLayoutVertexArray:G,aspectRatio:j,rotateToLine:Q}=I,ie=w/24,re=y.lineOffsetX*ie,ce=y.lineOffsetY*ie,de;if(y.numGlyphs>1){let Te=y.glyphStartIndex+y.numGlyphs,Ie=y.lineStartIndex,Me=y.lineStartIndex+y.lineLength,Oe=Ml(ie,z,re,ce,P,y,Q,l);if(!Oe)return{notEnoughRoom:!0};let We=Rc(Oe.first.point.x,Oe.first.point.y,l,f),De=Rc(Oe.last.point.x,Oe.last.point.y,l,f);if(L&&!P){let Ge=Ss(y.writingMode,We,De,j);if(Ge)return Ge}de=[Oe.first];for(let Ge=y.glyphStartIndex+1;Ge<Te-1;Ge++){let Be=Do(ie*z.getoffsetX(Ge),re,ce,P,y.segment,Ie,Me,l,Q);if(!Be)return{notEnoughRoom:!0};de.push(Be)}de.push(Oe.last)}else{if(L&&!P){let Ie=rr(l.tileAnchorPoint.x,l.tileAnchorPoint.y,l).point,Me=y.lineStartIndex+y.segment+1,Oe=new o.P(l.lineVertexArray.getx(Me),l.lineVertexArray.gety(Me)),We=rr(Oe.x,Oe.y,l),De=We.signedDistanceFromCamera>0?We.point:Cs(l.tileAnchorPoint,Oe,Ie,1,l),Ge=Rc(Ie.x,Ie.y,l,f),Be=Rc(De.x,De.y,l,f),Fe=Ss(y.writingMode,Ge,Be,j);if(Fe)return Fe}let Te=Do(ie*z.getoffsetX(y.glyphStartIndex),re,ce,P,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,l,Q);if(!Te||l.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};de=[Te]}for(let Te of de)o.aG(G,Te.point,Te.angle);return{}}function Cs(I,l,f,y,w){let P=I.add(I.sub(l)._unit()),L=rr(P.x,P.y,w).point,z=f.sub(L);return f.add(z._mult(y/z.mag()))}function Bo(I,l,f){let y=l.projectionCache;if(y.projections[I])return y.projections[I];let w=new o.P(l.lineVertexArray.getx(I),l.lineVertexArray.gety(I)),P=rr(w.x,w.y,l);if(P.signedDistanceFromCamera>0)return y.projections[I]=P.point,y.anyProjectionOccluded=y.anyProjectionOccluded||P.isOccluded,P.point;let L=I-f.direction;return Cs(f.distanceFromAnchor===0?l.tileAnchorPoint:new o.P(l.lineVertexArray.getx(L),l.lineVertexArray.gety(L)),w,f.previousVertex,f.absOffsetX-f.distanceFromAnchor+1,l)}function rr(I,l,f){let y=I+f.translation[0],w=l+f.translation[1],P;return f.pitchWithMap?(P=Un(y,w,f.pitchedLabelPlaneMatrix,f.getElevation),P.isOccluded=!1):(P=f.transform.projectTileCoordinates(y,w,f.unwrappedTileID,f.getElevation),P.point.x=(.5*P.point.x+.5)*f.width,P.point.y=(.5*-P.point.y+.5)*f.height),P}function Rc(I,l,f,y){if(f.pitchWithMap){let w=[I,l,0,1];return o.aH(w,w,y),f.transform.projectTileCoordinates(w[0]/w[3],w[1]/w[3],f.unwrappedTileID,f.getElevation).point}return{x:I/f.width*2-1,y:1-l/f.height*2}}function Il(I,l,f){return f.transform.projectTileCoordinates(I,l,f.unwrappedTileID,f.getElevation)}function Jo(I,l,f){return I._unit()._perp()._mult(l*f)}function el(I,l,f,y,w,P,L,z,G){if(z.projectionCache.offsets[I])return z.projectionCache.offsets[I];let j=f.add(l);if(I+G.direction<y||I+G.direction>=w)return z.projectionCache.offsets[I]=j,j;let Q=Bo(I+G.direction,z,G),ie=Jo(Q.sub(f),L,G.direction),re=f.add(ie),ce=Q.add(ie);return z.projectionCache.offsets[I]=o.aI(P,j,re,ce)||j,z.projectionCache.offsets[I]}function Do(I,l,f,y,w,P,L,z,G){let j=y?I-l:I+l,Q=j>0?1:-1,ie=0;y&&(Q*=-1,ie=Math.PI),Q<0&&(ie+=Math.PI);let re,ce=Q>0?P+w:P+w+1;z.projectionCache.cachedAnchorPoint?re=z.projectionCache.cachedAnchorPoint:(re=rr(z.tileAnchorPoint.x,z.tileAnchorPoint.y,z).point,z.projectionCache.cachedAnchorPoint=re);let de,Te,Ie=re,Me=re,Oe=0,We=0,De=Math.abs(j),Ge=[],Be;for(;Oe+We<=De;){if(ce+=Q,ce<P||ce>=L)return null;Oe+=We,Me=Ie,Te=de;let ct={absOffsetX:De,direction:Q,distanceFromAnchor:Oe,previousVertex:Me};if(Ie=Bo(ce,z,ct),f===0)Ge.push(Me),Be=Ie.sub(Me);else{let dt,pt=Ie.sub(Me);dt=pt.mag()===0?Jo(Bo(ce+Q,z,ct).sub(Ie),f,Q):Jo(pt,f,Q),Te||(Te=Me.add(dt)),de=el(ce,dt,Ie,P,L,Te,f,z,ct),Ge.push(Te),Be=de.sub(Te)}We=Be.mag()}let Fe=Be._mult((De-Oe)/We)._add(Te||Me),Ve=ie+Math.atan2(Ie.y-Me.y,Ie.x-Me.x);return Ge.push(Fe),{point:Fe,angle:G?Ve:0,path:Ge}}let Bc=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function $o(I,l){for(let f=0;f<I;f++){let y=l.length;l.resize(y+4),l.float32.set(Bc,3*y)}}function ph(I,l,f){let y=l[0],w=l[1];return I[0]=f[0]*y+f[4]*w+f[12],I[1]=f[1]*y+f[5]*w+f[13],I[3]=f[3]*y+f[7]*w+f[15],I}let xi=100;class Ah{constructor(l,f=new Hn(l.width+200,l.height+200,25),y=new Hn(l.width+200,l.height+200,25)){this.transform=l,this.grid=f,this.ignoredGrid=y,this.pitchFactor=Math.cos(l.pitch*Math.PI/180)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+xi,this.screenBottomBoundary=l.height+xi,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,f,y,w,P,L,z,G,j,Q,ie,re){let ce=this.projectAndGetPerspectiveRatio(l.anchorPointX+G[0],l.anchorPointY+G[1],P,Q,re),de=y*ce.perspectiveRatio,Te;if(L||z)Te=this._projectCollisionBox(l,de,w,P,L,z,G,ce,Q,ie,re);else{let Be=ce.x+(ie?ie.x*de:0),Fe=ce.y+(ie?ie.y*de:0);Te={allPointsOccluded:!1,box:[Be+l.x1*de,Fe+l.y1*de,Be+l.x2*de,Fe+l.y2*de]}}let[Ie,Me,Oe,We]=Te.box,De=L?Te.allPointsOccluded:ce.isOccluded,Ge=De;return Ge||(Ge=ce.perspectiveRatio<this.perspectiveRatioCutoff),Ge||(Ge=!this.isInsideGrid(Ie,Me,Oe,We)),Ge||f!==\"always\"&&this.grid.hitTest(Ie,Me,Oe,We,f,j)?{box:[Ie,Me,Oe,We],placeable:!1,offscreen:!1,occluded:De}:{box:[Ie,Me,Oe,We],placeable:!0,offscreen:this.isOffscreen(Ie,Me,Oe,We),occluded:De}}placeCollisionCircles(l,f,y,w,P,L,z,G,j,Q,ie,re,ce,de){let Te=[],Ie=new o.P(f.anchorX,f.anchorY),Me=this.getPerspectiveRatio(Ie.x,Ie.y,L,de),Oe=(j?P*this.transform.getPitchedTextCorrection(f.anchorX,f.anchorY,L)/Me:P*Me)/o.aM,We={getElevation:de,pitchedLabelPlaneMatrix:z,lineVertexArray:y,pitchWithMap:j,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Ie,unwrappedTileID:L,width:this.transform.width,height:this.transform.height,translation:ce},De=Ml(Oe,w,f.lineOffsetX*Oe,f.lineOffsetY*Oe,!1,f,!1,We),Ge=!1,Be=!1,Fe=!0;if(De){let Ve=.5*ie*Me+re,ct=new o.P(-100,-100),dt=new o.P(this.screenRightBoundary,this.screenBottomBoundary),pt=new Yt,ft=De.first,Xt=De.last,Ut=[];for(let jn=ft.path.length-1;jn>=1;jn--)Ut.push(ft.path[jn]);for(let jn=1;jn<Xt.path.length;jn++)Ut.push(Xt.path[jn]);let Bt=2.5*Ve;if(j){let jn=this.projectPathToScreenSpace(Ut,We);Ut=jn.some((Tt=>Tt.signedDistanceFromCamera<=0))?[]:jn.map((Tt=>Tt.point))}let Jt=[];if(Ut.length>0){let jn=Ut[0].clone(),Tt=Ut[0].clone();for(let Ot=1;Ot<Ut.length;Ot++)jn.x=Math.min(jn.x,Ut[Ot].x),jn.y=Math.min(jn.y,Ut[Ot].y),Tt.x=Math.max(Tt.x,Ut[Ot].x),Tt.y=Math.max(Tt.y,Ut[Ot].y);Jt=jn.x>=ct.x&&Tt.x<=dt.x&&jn.y>=ct.y&&Tt.y<=dt.y?[Ut]:Tt.x<ct.x||jn.x>dt.x||Tt.y<ct.y||jn.y>dt.y?[]:o.aJ([Ut],ct.x,ct.y,dt.x,dt.y)}for(let jn of Jt){pt.reset(jn,.25*Ve);let Tt=0;Tt=pt.length<=.5*Ve?1:Math.ceil(pt.paddedLength/Bt)+1;for(let Ot=0;Ot<Tt;Ot++){let ni=Ot/Math.max(Tt-1,1),Pi=pt.lerp(ni),Kr=Pi.x+xi,Ri=Pi.y+xi;Te.push(Kr,Ri,Ve,0);let ri=Kr-Ve,Fi=Ri-Ve,po=Kr+Ve,ui=Ri+Ve;if(Fe=Fe&&this.isOffscreen(ri,Fi,po,ui),Be=Be||this.isInsideGrid(ri,Fi,po,ui),l!==\"always\"&&this.grid.hitTestCircle(Kr,Ri,Ve,l,Q)&&(Ge=!0,!G))return{circles:[],offscreen:!1,collisionDetected:Ge}}}}return{circles:!G&&Ge||!Be||Me<this.perspectiveRatioCutoff?[]:Te,offscreen:Fe,collisionDetected:Ge}}projectPathToScreenSpace(l,f){let y=(function(w,P){let L=o.N();return o.aB(L,P.pitchedLabelPlaneMatrix),w.map((z=>{let G=Un(z.x,z.y,L,P.getElevation),j=P.transform.projectTileCoordinates(G.point.x,G.point.y,P.unwrappedTileID,P.getElevation);return j.point.x=(.5*j.point.x+.5)*P.width,j.point.y=(.5*-j.point.y+.5)*P.height,j}))})(l,f);return(function(w){let P=0,L=0,z=0,G=0;for(let j=0;j<w.length;j++)w[j].isOccluded?(z=j+1,G=0):(G++,G>L&&(L=G,P=z));return w.slice(P,P+L)})(y)}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let f=[],y=new o.aa;for(let ie of l){let re=new o.P(ie.x+xi,ie.y+xi);y.extend(re),f.push(re)}let{minX:w,minY:P,maxX:L,maxY:z}=y,G=this.grid.query(w,P,L,z).concat(this.ignoredGrid.query(w,P,L,z)),j={},Q={};for(let ie of G){let re=ie.key;if(j[re.bucketInstanceId]===void 0&&(j[re.bucketInstanceId]={}),j[re.bucketInstanceId][re.featureIndex])continue;let ce=[new o.P(ie.x1,ie.y1),new o.P(ie.x2,ie.y1),new o.P(ie.x2,ie.y2),new o.P(ie.x1,ie.y2)];o.aK(f,ce)&&(j[re.bucketInstanceId][re.featureIndex]=!0,Q[re.bucketInstanceId]===void 0&&(Q[re.bucketInstanceId]=[]),Q[re.bucketInstanceId].push(re.featureIndex))}return Q}insertCollisionBox(l,f,y,w,P,L){(y?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:P,collisionGroupID:L,overlapMode:f},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,f,y,w,P,L){let z=y?this.ignoredGrid:this.grid,G={bucketInstanceId:w,featureIndex:P,collisionGroupID:L,overlapMode:f};for(let j=0;j<l.length;j+=4)z.insertCircle(G,l[j],l[j+1],l[j+2])}projectAndGetPerspectiveRatio(l,f,y,w,P){if(P){let L;w?(L=[l,f,w(l,f),1],o.aH(L,L,P)):(L=[l,f,0,1],ph(L,L,P));let z=L[3];return{x:(L[0]/z+1)/2*this.transform.width+xi,y:(-L[1]/z+1)/2*this.transform.height+xi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/z*.5,isOccluded:!1,signedDistanceFromCamera:z}}{let L=this.transform.projectTileCoordinates(l,f,y,w);return{x:(L.point.x+1)/2*this.transform.width+xi,y:(1-L.point.y)/2*this.transform.height+xi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/L.signedDistanceFromCamera*.5,isOccluded:L.isOccluded,signedDistanceFromCamera:L.signedDistanceFromCamera}}}getPerspectiveRatio(l,f,y,w){let P=this.transform.projectTileCoordinates(l,f,y,w);return .5+this.transform.cameraToCenterDistance/P.signedDistanceFromCamera*.5}isOffscreen(l,f,y,w){return y<xi||l>=this.screenRightBoundary||w<xi||f>this.screenBottomBoundary}isInsideGrid(l,f,y,w){return y>=0&&l<this.gridRightBoundary&&w>=0&&f<this.gridBottomBoundary}getViewportMatrix(){let l=o.ar([]);return o.O(l,l,[-100,-100,0]),l}_projectCollisionBox(l,f,y,w,P,L,z,G,j,Q,ie){let re=1,ce=0,de=0,Te=1,Ie=l.anchorPointX+z[0],Me=l.anchorPointY+z[1];if(L&&!P){let Ut=this.projectAndGetPerspectiveRatio(Ie+1,Me,w,j,ie),Bt=Ut.x-G.x,Jt=Math.atan((Ut.y-G.y)/Bt)+(Bt<0?Math.PI:0),jn=Math.sin(Jt),Tt=Math.cos(Jt);re=Tt,ce=jn,de=-jn,Te=Tt}else if(!L&&P){let Ut=$a(this.transform);re=Ut.vecEast[0],ce=Ut.vecEast[1],de=Ut.vecSouth[0],Te=Ut.vecSouth[1]}let Oe=G.x,We=G.y,De=f;P&&(Oe=Ie,We=Me,De=Math.pow(2,-(this.transform.zoom-y.overscaledZ)),De*=this.transform.getPitchedTextCorrection(Ie,Me,w),Q||(De*=o.an(.5+G.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),Q&&(Oe+=re*Q.x*De+de*Q.y*De,We+=ce*Q.x*De+Te*Q.y*De);let Ge=l.x1*De,Be=l.x2*De,Fe=(Ge+Be)/2,Ve=l.y1*De,ct=l.y2*De,dt=(Ve+ct)/2,pt=[{offsetX:Ge,offsetY:Ve},{offsetX:Fe,offsetY:Ve},{offsetX:Be,offsetY:Ve},{offsetX:Be,offsetY:dt},{offsetX:Be,offsetY:ct},{offsetX:Fe,offsetY:ct},{offsetX:Ge,offsetY:ct},{offsetX:Ge,offsetY:dt}],ft=[];for(let{offsetX:Ut,offsetY:Bt}of pt)ft.push(new o.P(Oe+re*Ut+de*Bt,We+ce*Ut+Te*Bt));let Xt=!1;if(P){let Ut=ft.map((Bt=>this.projectAndGetPerspectiveRatio(Bt.x,Bt.y,w,j,ie)));Xt=Ut.some((Bt=>!Bt.isOccluded)),ft=Ut.map((Bt=>new o.P(Bt.x,Bt.y)))}else Xt=!0;return{box:o.aL(ft),allPointsOccluded:!Xt}}}class Ia{constructor(l,f,y,w){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?f:-f))):w&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class Ms{constructor(l,f,y,w,P){this.text=new Ia(l?l.text:null,f,y,P),this.icon=new Ia(l?l.icon:null,f,w,P)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Pa{constructor(l,f,y){this.text=l,this.icon=f,this.skipFade=y}}class Pl{constructor(l,f,y,w,P){this.bucketInstanceId=l,this.featureIndex=f,this.sourceLayerIndex=y,this.bucketIndex=w,this.tileID=P}}class fs{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){let f=++this.maxGroupID;this.collisionGroups[l]={ID:f,predicate:y=>y.collisionGroupID===f}}return this.collisionGroups[l]}}function gh(I,l,f,y,w){let{horizontalAlign:P,verticalAlign:L}=o.aS(I);return new o.P(-(P-.5)*l+y[0]*w,-(L-.5)*f+y[1]*w)}class wr{constructor(l,f,y,w,P){this.transform=l.clone(),this.terrain=f,this.collisionIndex=new Ah(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=y,this.retainedQueryData={},this.collisionGroups=new fs(w),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=P,P&&(P.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(l){let f=this.terrain;return f?(y,w)=>f.getElevation(l,y,w):null}getBucketParts(l,f,y,w){let P=y.getBucket(f),L=y.latestFeatureIndex;if(!P||!L||f.id!==P.layerIds[0])return;let z=y.collisionBoxArray,G=P.layers[0].layout,j=P.layers[0].paint,Q=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),ie=y.tileSize/o.a5,re=y.tileID.toUnwrapped(),ce=G.get(\"text-rotation-alignment\")===\"map\",de=o.aN(y,1,this.transform.zoom),Te=o.aO(this.collisionIndex.transform,y,j.get(\"text-translate\"),j.get(\"text-translate-anchor\")),Ie=o.aO(this.collisionIndex.transform,y,j.get(\"icon-translate\"),j.get(\"icon-translate-anchor\")),Me=Qo(ce,this.transform,de);this.retainedQueryData[P.bucketInstanceId]=new Pl(P.bucketInstanceId,L,P.sourceLayerIndex,P.index,y.tileID);let Oe={bucket:P,layout:G,translationText:Te,translationIcon:Ie,unwrappedTileID:re,pitchedLabelPlaneMatrix:Me,scale:Q,textPixelRatio:ie,holdingForFade:y.holdingForSymbolFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:o.ay(P.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(w)for(let We of P.sortKeyRanges){let{sortKey:De,symbolInstanceStart:Ge,symbolInstanceEnd:Be}=We;l.push({sortKey:De,symbolInstanceStart:Ge,symbolInstanceEnd:Be,parameters:Oe})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:Oe})}attemptAnchorPlacement(l,f,y,w,P,L,z,G,j,Q,ie,re,ce,de,Te,Ie,Me,Oe,We,De){let Ge=o.aP[l.textAnchor],Be=[l.textOffset0,l.textOffset1],Fe=gh(Ge,y,w,Be,P),Ve=this.collisionIndex.placeCollisionBox(f,re,G,j,Q,z,L,Ie,ie.predicate,We,Fe,De);if((!Oe||this.collisionIndex.placeCollisionBox(Oe,re,G,j,Q,z,L,Me,ie.predicate,We,Fe,De).placeable)&&Ve.placeable){let ct;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID].text&&(ct=this.prevPlacement.variableOffsets[ce.crossTileID].anchor),ce.crossTileID===0)throw new Error(\"symbolInstance.crossTileID can't be 0\");return this.variableOffsets[ce.crossTileID]={textOffset:Be,width:y,height:w,anchor:Ge,textBoxScale:P,prevAnchor:ct},this.markUsedJustification(de,Ge,ce,Te),de.allowVerticalPlacement&&(this.markUsedOrientation(de,Te,ce),this.placedOrientations[ce.crossTileID]=Te),{shift:Fe,placedGlyphBoxes:Ve}}}placeLayerBucketPart(l,f,y){let{bucket:w,layout:P,translationText:L,translationIcon:z,unwrappedTileID:G,pitchedLabelPlaneMatrix:j,textPixelRatio:Q,holdingForFade:ie,collisionBoxArray:re,partiallyEvaluatedTextSize:ce,collisionGroup:de}=l.parameters,Te=P.get(\"text-optional\"),Ie=P.get(\"icon-optional\"),Me=o.aQ(P,\"text-overlap\",\"text-allow-overlap\"),Oe=Me===\"always\",We=o.aQ(P,\"icon-overlap\",\"icon-allow-overlap\"),De=We===\"always\",Ge=P.get(\"text-rotation-alignment\")===\"map\",Be=P.get(\"text-pitch-alignment\")===\"map\",Fe=P.get(\"icon-text-fit\")!==\"none\",Ve=P.get(\"symbol-z-order\")===\"viewport-y\",ct=Oe&&(De||!w.hasIconData()||Ie),dt=De&&(Oe||!w.hasTextData()||Te);!w.collisionArrays&&re&&w.deserializeCollisionBoxes(re);let pt=this.retainedQueryData[w.bucketInstanceId].tileID,ft=this._getTerrainElevationFunc(pt),Xt=this.transform.getFastPathSimpleProjectionMatrix(pt),Ut=(Bt,Jt,jn)=>{var Tt,Ot;if(f[Bt.crossTileID])return;if(ie)return void(this.placements[Bt.crossTileID]=new Pa(!1,!1,!1));let ni=!1,Pi=!1,Kr=!0,Ri=null,ri={box:null,placeable:!1,offscreen:null,occluded:!1},Fi={placeable:!1},po=null,ui=null,A=null,g=0,x=0,T=0;Jt.textFeatureIndex?g=Jt.textFeatureIndex:Bt.useRuntimeCollisionCircles&&(g=Bt.featureIndex),Jt.verticalTextFeatureIndex&&(x=Jt.verticalTextFeatureIndex);let M=Jt.textBox;if(M){let W=Ce=>{let Se=o.az.horizontal;if(w.allowVerticalPlacement&&!Ce&&this.prevPlacement){let Pe=this.prevPlacement.placedOrientations[Bt.crossTileID];Pe&&(this.placedOrientations[Bt.crossTileID]=Pe,Se=Pe,this.markUsedOrientation(w,Se,Bt))}return Se},Z=(Ce,Se)=>{if(w.allowVerticalPlacement&&Bt.numVerticalGlyphVertices>0&&Jt.verticalTextBox){for(let Pe of w.writingModes)if(Pe===o.az.vertical?(ri=Se(),Fi=ri):ri=Ce(),ri&&ri.placeable)break}else ri=Ce()},ne=Bt.textAnchorOffsetStartIndex,_e=Bt.textAnchorOffsetEndIndex;if(_e===ne){let Ce=(Se,Pe)=>{let Ye=this.collisionIndex.placeCollisionBox(Se,Me,Q,pt,G,Be,Ge,L,de.predicate,ft,void 0,Xt);return Ye&&Ye.placeable&&(this.markUsedOrientation(w,Pe,Bt),this.placedOrientations[Bt.crossTileID]=Pe),Ye};Z((()=>Ce(M,o.az.horizontal)),(()=>{let Se=Jt.verticalTextBox;return w.allowVerticalPlacement&&Bt.numVerticalGlyphVertices>0&&Se?Ce(Se,o.az.vertical):{box:null,offscreen:null}})),W(ri&&ri.placeable)}else{let Ce=o.aP[(Ot=(Tt=this.prevPlacement)===null||Tt===void 0?void 0:Tt.variableOffsets[Bt.crossTileID])===null||Ot===void 0?void 0:Ot.anchor],Se=(Ye,et,yt)=>{let at=Ye.x2-Ye.x1,lt=Ye.y2-Ye.y1,qe=Bt.textBoxScale,qt=Fe&&We===\"never\"?et:null,xn=null,dn=Me===\"never\"?1:2,Vn=\"never\";Ce&&dn++;for(let qn=0;qn<dn;qn++){for(let ur=ne;ur<_e;ur++){let Gn=w.textAnchorOffsets.get(ur);if(Ce&&Gn.textAnchor!==Ce)continue;let Tn=this.attemptAnchorPlacement(Gn,Ye,at,lt,qe,Ge,Be,Q,pt,G,de,Vn,Bt,w,yt,L,z,qt,ft);if(Tn&&(xn=Tn.placedGlyphBoxes,xn&&xn.placeable))return ni=!0,Ri=Tn.shift,xn}Ce?Ce=null:Vn=Me}return y&&!xn&&(xn={box:this.collisionIndex.placeCollisionBox(M,\"always\",Q,pt,G,Be,Ge,L,de.predicate,ft,void 0,Xt).box,offscreen:!1,placeable:!1,occluded:!1}),xn};Z((()=>Se(M,Jt.iconBox,o.az.horizontal)),(()=>{let Ye=Jt.verticalTextBox;return w.allowVerticalPlacement&&(!ri||!ri.placeable)&&Bt.numVerticalGlyphVertices>0&&Ye?Se(Ye,Jt.verticalIconBox,o.az.vertical):{box:null,occluded:!0,offscreen:null}})),ri&&(ni=ri.placeable,Kr=ri.offscreen);let Pe=W(ri&&ri.placeable);if(!ni&&this.prevPlacement){let Ye=this.prevPlacement.variableOffsets[Bt.crossTileID];Ye&&(this.variableOffsets[Bt.crossTileID]=Ye,this.markUsedJustification(w,Ye.anchor,Bt,Pe))}}}if(po=ri,ni=po&&po.placeable,Kr=po&&po.offscreen,Bt.useRuntimeCollisionCircles&&Bt.centerJustifiedTextSymbolIndex>=0){let W=w.text.placedSymbolArray.get(Bt.centerJustifiedTextSymbolIndex),Z=o.aA(w.textSizeData,ce,W),ne=P.get(\"text-padding\");ui=this.collisionIndex.placeCollisionCircles(Me,W,w.lineVertexArray,w.glyphOffsetArray,Z,G,j,y,Be,de.predicate,Bt.collisionCircleDiameter,ne,L,ft),ui.circles.length&&ui.collisionDetected&&!y&&o.w(\"Collisions detected, but collision boxes are not shown\"),ni=Oe||ui.circles.length>0&&!ui.collisionDetected,Kr=Kr&&ui.offscreen}if(Jt.iconFeatureIndex&&(T=Jt.iconFeatureIndex),Jt.iconBox){let W=Z=>this.collisionIndex.placeCollisionBox(Z,We,Q,pt,G,Be,Ge,z,de.predicate,ft,Fe&&Ri?Ri:void 0,Xt);Fi&&Fi.placeable&&Jt.verticalIconBox?(A=W(Jt.verticalIconBox),Pi=A.placeable):(A=W(Jt.iconBox),Pi=A.placeable),Kr=Kr&&A.offscreen}let D=Te||Bt.numHorizontalGlyphVertices===0&&Bt.numVerticalGlyphVertices===0,O=Ie||Bt.numIconVertices===0;D||O?O?D||(Pi=Pi&&ni):ni=Pi&&ni:Pi=ni=Pi&&ni;let N=Pi&&A.placeable;if(ni&&po.placeable&&this.collisionIndex.insertCollisionBox(po.box,Me,P.get(\"text-ignore-placement\"),w.bucketInstanceId,Fi&&Fi.placeable&&x?x:g,de.ID),N&&this.collisionIndex.insertCollisionBox(A.box,We,P.get(\"icon-ignore-placement\"),w.bucketInstanceId,T,de.ID),ui&&ni&&this.collisionIndex.insertCollisionCircles(ui.circles,Me,P.get(\"text-ignore-placement\"),w.bucketInstanceId,g,de.ID),y&&this.storeCollisionData(w.bucketInstanceId,jn,Jt,po,A,ui),Bt.crossTileID===0)throw new Error(\"symbolInstance.crossTileID can't be 0\");if(w.bucketInstanceId===0)throw new Error(\"bucket.bucketInstanceId can't be 0\");this.placements[Bt.crossTileID]=new Pa((ni||ct)&&!po?.occluded,(Pi||dt)&&!A?.occluded,Kr||w.justReloaded),f[Bt.crossTileID]=!0};if(Ve){if(l.symbolInstanceStart!==0)throw new Error(\"bucket.bucketInstanceId should be 0\");let Bt=w.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Jt=Bt.length-1;Jt>=0;--Jt){let jn=Bt[Jt];Ut(w.symbolInstances.get(jn),w.collisionArrays[jn],jn)}}else for(let Bt=l.symbolInstanceStart;Bt<l.symbolInstanceEnd;Bt++)Ut(w.symbolInstances.get(Bt),w.collisionArrays[Bt],Bt);w.justReloaded=!1}storeCollisionData(l,f,y,w,P,L){if(y.textBox||y.iconBox){let z,G;this.collisionBoxArrays.has(l)?z=this.collisionBoxArrays.get(l):(z=new Map,this.collisionBoxArrays.set(l,z)),z.has(f)?G=z.get(f):(G={text:null,icon:null},z.set(f,G)),y.textBox&&(G.text=w.box),y.iconBox&&(G.icon=P.box)}if(L){let z=this.collisionCircleArrays[l];z===void 0&&(z=this.collisionCircleArrays[l]=[]);for(let G=0;G<L.circles.length;G+=4)z.push(L.circles[G+0]-xi),z.push(L.circles[G+1]-xi),z.push(L.circles[G+2]),z.push(L.collisionDetected?1:0)}}markUsedJustification(l,f,y,w){let P;P=w===o.az.vertical?y.verticalPlacedTextSymbolIndex:{left:y.leftJustifiedTextSymbolIndex,center:y.centerJustifiedTextSymbolIndex,right:y.rightJustifiedTextSymbolIndex}[o.aR(f)];let L=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex,y.verticalPlacedTextSymbolIndex];for(let z of L)z>=0&&(l.text.placedSymbolArray.get(z).crossTileID=P>=0&&z!==P?0:y.crossTileID)}markUsedOrientation(l,f,y){let w=f===o.az.horizontal||f===o.az.horizontalOnly?f:0,P=f===o.az.vertical?f:0,L=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex];for(let z of L)l.text.placedSymbolArray.get(z).placedOrientation=w;y.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(y.verticalPlacedTextSymbolIndex).placedOrientation=P)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;let f=this.prevPlacement,y=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;let w=f?f.symbolFadeChange(l):1,P=f?f.opacities:{},L=f?f.variableOffsets:{},z=f?f.placedOrientations:{};for(let G in this.placements){let j=this.placements[G],Q=P[G];Q?(this.opacities[G]=new Ms(Q,w,j.text,j.icon),y=y||j.text!==Q.text.placed||j.icon!==Q.icon.placed):(this.opacities[G]=new Ms(null,w,j.text,j.icon,j.skipFade),y=y||j.text||j.icon)}for(let G in P){let j=P[G];if(!this.opacities[G]){let Q=new Ms(j,w,!1,!1);Q.isHidden()||(this.opacities[G]=Q,y=y||j.text.placed||j.icon.placed)}}for(let G in L)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=L[G]);for(let G in z)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=z[G]);if(f&&f.lastPlacementChangeTime===void 0)throw new Error(\"Last placement time for previous placement is not defined\");y?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!=\"number\"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:l)}updateLayerOpacities(l,f){let y={};for(let w of f){let P=w.getBucket(l);P&&w.latestFeatureIndex&&l.id===P.layerIds[0]&&this.updateBucketOpacities(P,w.tileID,y,w.collisionBoxArray)}}updateBucketOpacities(l,f,y,w){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();let P=l.layers[0],L=P.layout,z=new Ms(null,0,!1,!1,!0),G=L.get(\"text-allow-overlap\"),j=L.get(\"icon-allow-overlap\"),Q=P._unevaluatedLayout.hasValue(\"text-variable-anchor\")||P._unevaluatedLayout.hasValue(\"text-variable-anchor-offset\"),ie=L.get(\"text-rotation-alignment\")===\"map\",re=L.get(\"text-pitch-alignment\")===\"map\",ce=L.get(\"icon-text-fit\")!==\"none\",de=new Ms(null,0,G&&(j||!l.hasIconData()||L.get(\"icon-optional\")),j&&(G||!l.hasTextData()||L.get(\"text-optional\")),!0);!l.collisionArrays&&w&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(w);let Te=(Me,Oe,We)=>{for(let De=0;De<Oe/4;De++)Me.opacityVertexArray.emplaceBack(We);Me.hasVisibleVertices=Me.hasVisibleVertices||We!==tl},Ie=this.collisionBoxArrays.get(l.bucketInstanceId);for(let Me=0;Me<l.symbolInstances.length;Me++){let Oe=l.symbolInstances.get(Me),{numHorizontalGlyphVertices:We,numVerticalGlyphVertices:De,crossTileID:Ge}=Oe,Be=this.opacities[Ge];y[Ge]?Be=z:Be||(Be=de,this.opacities[Ge]=Be),y[Ge]=!0;let Fe=Oe.numIconVertices>0,Ve=this.placedOrientations[Oe.crossTileID],ct=Ve===o.az.vertical,dt=Ve===o.az.horizontal||Ve===o.az.horizontalOnly;if(We>0||De>0){let ft=oc(Be.text);Te(l.text,We,ct?tl:ft),Te(l.text,De,dt?tl:ft);let Xt=Be.text.isHidden();[Oe.rightJustifiedTextSymbolIndex,Oe.centerJustifiedTextSymbolIndex,Oe.leftJustifiedTextSymbolIndex].forEach((Jt=>{Jt>=0&&(l.text.placedSymbolArray.get(Jt).hidden=Xt||ct?1:0)})),Oe.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(Oe.verticalPlacedTextSymbolIndex).hidden=Xt||dt?1:0);let Ut=this.variableOffsets[Oe.crossTileID];Ut&&this.markUsedJustification(l,Ut.anchor,Oe,Ve);let Bt=this.placedOrientations[Oe.crossTileID];Bt&&(this.markUsedJustification(l,\"left\",Oe,Bt),this.markUsedOrientation(l,Bt,Oe))}if(Fe){let ft=oc(Be.icon),Xt=!(ce&&Oe.verticalPlacedIconSymbolIndex&&ct);Oe.placedIconSymbolIndex>=0&&(Te(l.icon,Oe.numIconVertices,Xt?ft:tl),l.icon.placedSymbolArray.get(Oe.placedIconSymbolIndex).hidden=Be.icon.isHidden()),Oe.verticalPlacedIconSymbolIndex>=0&&(Te(l.icon,Oe.numVerticalIconVertices,Xt?tl:ft),l.icon.placedSymbolArray.get(Oe.verticalPlacedIconSymbolIndex).hidden=Be.icon.isHidden())}let pt=Ie&&Ie.has(Me)?Ie.get(Me):{text:null,icon:null};if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){let ft=l.collisionArrays[Me];if(ft){let Xt=new o.P(0,0);if(ft.textBox||ft.verticalTextBox){let Ut=!0;if(Q){let Bt=this.variableOffsets[Ge];Bt?(Xt=gh(Bt.anchor,Bt.width,Bt.height,Bt.textOffset,Bt.textBoxScale),ie&&Xt._rotate(re?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Ut=!1}if(ft.textBox||ft.verticalTextBox){let Bt;ft.textBox&&(Bt=ct),ft.verticalTextBox&&(Bt=dt),_r(l.textCollisionBox.collisionVertexArray,Be.text.placed,!Ut||Bt,pt.text,Xt.x,Xt.y)}}if(ft.iconBox||ft.verticalIconBox){let Ut=!!(!dt&&ft.verticalIconBox),Bt;ft.iconBox&&(Bt=Ut),ft.verticalIconBox&&(Bt=!Ut),_r(l.iconCollisionBox.collisionVertexArray,Be.icon.placed,Bt,pt.icon,ce?Xt.x:0,ce?Xt.y:0)}}}}if(l.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);l.bucketInstanceId in this.collisionCircleArrays&&(l.collisionCircleArray=this.collisionCircleArrays[l.bucketInstanceId],delete this.collisionCircleArrays[l.bucketInstanceId])}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,f){let y=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*y>l}setStale(){this.stale=!0}}function _r(I,l,f,y,w,P){y&&y.length!==0||(y=[0,0,0,0]);let L=y[0]-xi,z=y[1]-xi,G=y[2]-xi,j=y[3]-xi;I.emplaceBack(l?1:0,f?1:0,w||0,P||0,L,z),I.emplaceBack(l?1:0,f?1:0,w||0,P||0,G,z),I.emplaceBack(l?1:0,f?1:0,w||0,P||0,G,j),I.emplaceBack(l?1:0,f?1:0,w||0,P||0,L,j)}let _u=Math.pow(2,25),Is=Math.pow(2,24),yu=Math.pow(2,17),Lo=Math.pow(2,16),Rl=Math.pow(2,9),mh=Math.pow(2,8),xo=Math.pow(2,1);function oc(I){if(I.opacity===0&&!I.placed)return 0;if(I.opacity===1&&I.placed)return 4294967295;let l=I.placed?1:0,f=Math.floor(127*I.opacity);return f*_u+l*Is+f*yu+l*Lo+f*Rl+l*mh+f*xo+l}let tl=0;class Ra{constructor(l){this._sortAcrossTiles=l.layout.get(\"symbol-z-order\")!==\"viewport-y\"&&!l.layout.get(\"symbol-sort-key\").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,f,y,w,P){let L=this._bucketParts;for(;this._currentTileIndex<l.length;)if(f.getBucketParts(L,w,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort(((z,G)=>z.sortKey-G.sortKey)));this._currentPartIndex<L.length;)if(f.placeLayerBucketPart(L[this._currentPartIndex],this._seenCrossTileIDs,y),this._currentPartIndex++,P())return!0;return!1}}class Ba{constructor(l,f,y,w,P,L,z,G){this.placement=new wr(l,f,L,z,G),this._currentPlacementIndex=y.length-1,this._forceFullPlacement=w,this._showCollisionBoxes=P,this._done=!1}isDone(){return this._done}continuePlacement(l,f,y){let w=k(),P=()=>!this._forceFullPlacement&&k()-w>2;for(;this._currentPlacementIndex>=0;){let L=f[l[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(L.type===\"symbol\"&&(!L.minzoom||L.minzoom<=z)&&(!L.maxzoom||L.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new Ra(L)),this._inProgressLayer.continuePlacement(y[L.source],this.placement,this._showCollisionBoxes,L,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}let Zn=512/o.a5/2;class sc{constructor(l,f,y){this.tileID=l,this.bucketInstanceId=y,this._symbolsByKey={};let w=new Map;for(let P=0;P<f.length;P++){let L=f.get(P),z=L.key,G=w.get(z);G?G.push(L):w.set(z,[L])}for(let[P,L]of w){let z={positions:L.map((G=>({x:Math.floor(G.anchorX*Zn),y:Math.floor(G.anchorY*Zn)}))),crossTileIDs:L.map((G=>G.crossTileID))};if(z.positions.length>128){let G=new o.aT(z.positions.length,16,Uint16Array);for(let{x:j,y:Q}of z.positions)G.add(j,Q);G.finish(),delete z.positions,z.index=G}this._symbolsByKey[P]=z}}getScaledCoordinates(l,f){let{x:y,y:w,z:P}=this.tileID.canonical,{x:L,y:z,z:G}=f.canonical,j=Zn/Math.pow(2,G-P),Q=(z*o.a5+l.anchorY)*j,ie=w*o.a5*Zn;return{x:Math.floor((L*o.a5+l.anchorX)*j-y*o.a5*Zn),y:Math.floor(Q-ie)}}findMatches(l,f,y){let w=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let P=0;P<l.length;P++){let L=l.get(P);if(L.crossTileID)continue;let z=this._symbolsByKey[L.key];if(!z)continue;let G=this.getScaledCoordinates(L,f);if(z.index){let j=z.index.range(G.x-w,G.y-w,G.x+w,G.y+w).sort();for(let Q of j){let ie=z.crossTileIDs[Q];if(!y[ie]){y[ie]=!0,L.crossTileID=ie;break}}}else if(z.positions)for(let j=0;j<z.positions.length;j++){let Q=z.positions[j],ie=z.crossTileIDs[j];if(Math.abs(Q.x-G.x)<=w&&Math.abs(Q.y-G.y)<=w&&!y[ie]){y[ie]=!0,L.crossTileID=ie;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:l})=>l))}}class df{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ac{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){let f=Math.round((l-this.lng)/360);if(f!==0)for(let y in this.indexes){let w=this.indexes[y],P={};for(let L in w){let z=w[L];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+f),P[z.tileID.key]=z}this.indexes[y]=P}this.lng=l}addBucket(l,f,y){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let P=0;P<f.symbolInstances.length;P++)f.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});let w=this.usedCrossTileIDs[l.overscaledZ];for(let P in this.indexes){let L=this.indexes[P];if(Number(P)>l.overscaledZ)for(let z in L){let G=L[z];G.tileID.isChildOf(l)&&G.findMatches(f.symbolInstances,l,w)}else{let z=L[l.scaledTo(Number(P)).key];z&&z.findMatches(f.symbolInstances,l,w)}}for(let P=0;P<f.symbolInstances.length;P++){let L=f.symbolInstances.get(P);L.crossTileID||(L.crossTileID=y.generate(),w[L.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new sc(l,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(l,f){for(let y of f.getCrossTileIDsLists())for(let w of y)delete this.usedCrossTileIDs[l][w]}removeStaleBuckets(l){let f=!1;for(let y in this.indexes){let w=this.indexes[y];for(let P in w)l[w[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,w[P]),delete w[P],f=!0)}return f}}class Go{constructor(){this.layerIndexes={},this.crossTileIDs=new df,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,f,y){let w=this.layerIndexes[l.id];w===void 0&&(w=this.layerIndexes[l.id]=new ac);let P=!1,L={};w.handleWrapJump(y);for(let z of f){let G=z.getBucket(l);G&&l.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(z.tileID,G,this.crossTileIDs)&&(P=!0),L[G.bucketInstanceId]=!0)}return w.removeStaleBuckets(L)&&(P=!0),P}pruneUnusedLayers(l){let f={};l.forEach((y=>{f[y]=!0}));for(let y in this.layerIndexes)f[y]||delete this.layerIndexes[y]}}var si=\"void main() {fragColor=vec4(1.0);}\";let Kn={prelude:Bn(`#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nout highp vec4 fragColor;`,`#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c\n);}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\n#ifdef GLOBE\nif ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}\n#endif\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Bn(\"\",\"float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}\"),projectionGlobe:Bn(\"\",`#define GLOBE_RADIUS 6371008.8\nuniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos\n);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); \nif (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len\n);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Bn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,\"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}\"),backgroundPattern:Bn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,\"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}\"),circle:Bn(`in vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {\n#ifdef GLOBE\nvec3 center_vector=projectToSphere(circle_center);\n#endif\nfloat angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {\n#ifdef GLOBE\nvec4 projected_center=interpolateProjection(circle_center,center_vector,ele);\n#else\nvec4 projected_center=projectTileWithElevation(circle_center,ele);\n#endif\ncorner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}\n#ifdef GLOBE\nvec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);\n#else\ngl_Position=projectTileWithElevation(corner_position,ele);\n#endif\n} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Bn(si,\"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}\"),heatmap:Bn(`uniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);\n#ifdef GLOBE\nvec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);\n#else\ngl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));\n#endif\n}`),heatmapTexture:Bn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(0.0);\n#endif\n}`,\"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}\"),collisionBox:Bn(\"in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}\",\"in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}\"),collisionCircle:Bn(\"in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}\",\"in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}\"),colorRelief:Bn(`#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else\n{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,\"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}\"),debug:Bn(\"uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}\",\"in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}\"),depth:Bn(si,`in vec2 a_pos;void main() {\n#ifdef GLOBE\ngl_Position=projectTileFor3D(a_pos,0.0);\n#else\ngl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);\n#endif\n}`),fill:Bn(`#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nfragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`uniform vec2 u_fill_translate;in vec2 a_pos;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Bn(`in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}`),fillOutlinePattern:Bn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}`),fillPattern:Bn(`#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Bn(`in vec4 v_color;void main() {fragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\nout vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);\n#ifdef GLOBE\nmat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);\n#endif\ndirectional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Bn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\n#ifdef GLOBE\nout vec3 v_sphere_pos;\n#endif\nout vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nvec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Bn(`#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,\"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}\"),hillshade:Bn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];\n#define PI 3.141592653589793\n#define STANDARD 0\n#define COMBINED 1\n#define IGOR 2\n#define MULTIDIRECTIONAL 3\n#define BASIC 4\nfloat get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else\n{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else\n{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,\"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}\"),line:Bn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}`),lineGradient:Bn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}`),linePattern:Bn(`#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Bn(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nfloat u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:Bn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nfloat u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:Bn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;\n#ifdef GLOBE\nif (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}\n#endif\nv_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Bn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Bn(`#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Bn(`#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Bn(\"uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}\",\"in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}\"),terrainDepth:Bn(\"in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}\",\"in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}\"),terrainCoords:Bn(\"precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}\",\"in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}\"),projectionErrorMeasurement:Bn(\"in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}\",\"in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}\"),atmosphere:Bn(`#ifdef GL_ES\nprecision highp float;\n#endif\nin vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758\n);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,\"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}\"),sky:Bn(\"uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}\",\"in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}\")};function Bn(I,l){let f=/#pragma mapbox: ([\\w]+) ([\\w]+) ([\\w]+) ([\\w]+)/g,y=l.match(/in ([\\w]+) ([\\w]+)/g),w=I.match(/uniform ([\\w]+) ([\\w]+)([\\s]*)([\\w]*)/g),P=l.match(/uniform ([\\w]+) ([\\w]+)([\\s]*)([\\w]*)/g),L=P?P.concat(w):w,z={};return{fragmentSource:I=I.replace(f,((G,j,Q,ie,re)=>(z[re]=!0,j===\"define\"?`\n#ifndef HAS_UNIFORM_u_${re}\nin ${Q} ${ie} ${re};\n#else\nuniform ${Q} ${ie} u_${re};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${re}\n    ${Q} ${ie} ${re} = u_${re};\n#endif\n`))),vertexSource:l=l.replace(f,((G,j,Q,ie,re)=>{let ce=ie===\"float\"?\"vec2\":\"vec4\",de=re.match(/color/)?\"color\":ce;return z[re]?j===\"define\"?`\n#ifndef HAS_UNIFORM_u_${re}\nuniform lowp float u_${re}_t;\nin ${Q} ${ce} a_${re};\nout ${Q} ${ie} ${re};\n#else\nuniform ${Q} ${ie} u_${re};\n#endif\n`:de===\"vec4\"?`\n#ifndef HAS_UNIFORM_u_${re}\n    ${re} = a_${re};\n#else\n    ${Q} ${ie} ${re} = u_${re};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${re}\n    ${re} = unpack_mix_${de}(a_${re}, u_${re}_t);\n#else\n    ${Q} ${ie} ${re} = u_${re};\n#endif\n`:j===\"define\"?`\n#ifndef HAS_UNIFORM_u_${re}\nuniform lowp float u_${re}_t;\nin ${Q} ${ce} a_${re};\n#else\nuniform ${Q} ${ie} u_${re};\n#endif\n`:de===\"vec4\"?`\n#ifndef HAS_UNIFORM_u_${re}\n    ${Q} ${ie} ${re} = a_${re};\n#else\n    ${Q} ${ie} ${re} = u_${re};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${re}\n    ${Q} ${ie} ${re} = unpack_mix_${de}(a_${re}, u_${re}_t);\n#else\n    ${Q} ${ie} ${re} = u_${re};\n#endif\n`})),staticAttributes:y,staticUniforms:L}}class vi{constructor(l,f,y){this.vertexBuffer=l,this.indexBuffer=f,this.segments=y}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var _h=o.aU([{name:\"a_pos\",type:\"Int16\",components:2}]);let ia=\"#define PROJECTION_MERCATOR\",nl=\"mercator\";class oa{constructor(){this._cachedMesh=null}get name(){return\"mercator\"}get useSubdivision(){return!1}get shaderVariantName(){return nl}get shaderDefine(){return ia}get shaderPreludeCode(){return Kn.projectionMercator}get vertexShaderPreludeCode(){return Kn.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(l){}getMeshFromTileID(l,f,y,w,P){if(this._cachedMesh)return this._cachedMesh;let L=new o.aW;L.emplaceBack(0,0),L.emplaceBack(o.a5,0),L.emplaceBack(0,o.a5),L.emplaceBack(o.a5,o.a5);let z=l.createVertexBuffer(L,_h.members),G=o.aX.simpleSegment(0,0,4,2),j=new o.aY;j.emplaceBack(1,0,2),j.emplaceBack(1,2,3);let Q=l.createIndexBuffer(j);return this._cachedMesh=new vi(z,Q,G),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(l){}}class gd{constructor(l=0,f=0,y=0,w=0){if(isNaN(l)||l<0||isNaN(f)||f<0||isNaN(y)||y<0||isNaN(w)||w<0)throw new Error(\"Invalid value for edge-insets, top, bottom, left and right must all be numbers\");this.top=l,this.bottom=f,this.left=y,this.right=w}interpolate(l,f,y){return f.top!=null&&l.top!=null&&(this.top=o.G.number(l.top,f.top,y)),f.bottom!=null&&l.bottom!=null&&(this.bottom=o.G.number(l.bottom,f.bottom,y)),f.left!=null&&l.left!=null&&(this.left=o.G.number(l.left,f.left,y)),f.right!=null&&l.right!=null&&(this.right=o.G.number(l.right,f.right,y)),this}getCenter(l,f){let y=o.an((this.left+l-this.right)/2,0,l),w=o.an((this.top+f-this.bottom)/2,0,f);return new o.P(y,w)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new gd(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function yh(I,l){if(!I.renderWorldCopies||I.lngRange)return;let f=l.lng-I.center.lng;l.lng+=f>180?-360:f<-180?360:0}function vo(I){return Math.max(0,Math.floor(I))}class pf{constructor(l,f){var y;this.applyConstrain=(w,P)=>this._constrainOverride!==null?this._constrainOverride(w,P):this._callbacks.defaultConstrain(w,P),this._callbacks=l,this._tileSize=512,this._renderWorldCopies=f?.renderWorldCopies===void 0||!!f?.renderWorldCopies,this._minZoom=f?.minZoom||0,this._maxZoom=f?.maxZoom||22,this._minPitch=f?.minPitch==null?0:f?.minPitch,this._maxPitch=f?.maxPitch==null?60:f?.maxPitch,this._constrainOverride=(y=f?.constrainOverride)!==null&&y!==void 0?y:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=vo(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new gd,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(l,f,y){this._constrainOverride=l.constrainOverride,this._latRange=l.latRange,this._lngRange=l.lngRange,this._width=l.width,this._height=l.height,this._center=l.center,this._elevation=l.elevation,this._minElevationForCurrentTile=l.minElevationForCurrentTile,this._zoom=l.zoom,this._tileZoom=vo(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=l.bearingInRadians,this._fovInRadians=l.fovInRadians,this._pitchInRadians=l.pitchInRadians,this._rollInRadians=l.rollInRadians,this._unmodified=l.unmodified,this._edgeInsets=new gd(l.padding.top,l.padding.bottom,l.padding.left,l.padding.right),this._minZoom=l.minZoom,this._maxZoom=l.maxZoom,this._minPitch=l.minPitch,this._maxPitch=l.maxPitch,this._renderWorldCopies=l.renderWorldCopies,this._cameraToCenterDistance=l.cameraToCenterDistance,this._nearZ=l.nearZ,this._farZ=l.farZ,this._autoCalculateNearFarZ=!y&&l.autoCalculateNearFarZ,f&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(l){this._minElevationForCurrentTile=l}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(l){this._minZoom!==l&&(this._minZoom=l,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(l){this._minPitch!==l&&(this._minPitch=l,this.setPitch(Math.max(this.pitch,l)))}get maxPitch(){return this._maxPitch}setMaxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.setPitch(Math.min(this.pitch,l)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get constrainOverride(){return this._constrainOverride}setConstrainOverride(l){l===void 0&&(l=null),this._constrainOverride!==l&&(this._constrainOverride=l,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(l){let f=o.W(l,-180,180)*Math.PI/180;var y,w,P,L,z,G,j,Q,ie;this._bearingInRadians!==f&&(this._unmodified=!1,this._bearingInRadians=f,this._calcMatrices(),this._rotationMatrix=c(),y=this._rotationMatrix,P=-this._bearingInRadians,L=(w=this._rotationMatrix)[0],z=w[1],G=w[2],j=w[3],Q=Math.sin(P),ie=Math.cos(P),y[0]=L*ie+G*Q,y[1]=z*ie+j*Q,y[2]=L*-Q+G*ie,y[3]=z*-Q+j*ie)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(l){let f=o.an(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==f&&(this._unmodified=!1,this._pitchInRadians=f,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(l){let f=l/180*Math.PI;this._rollInRadians!==f&&(this._unmodified=!1,this._rollInRadians=f,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aZ(this._fovInRadians)}setFov(l){l=o.an(l,.1,150),this.fov!==l&&(this._unmodified=!1,this._fovInRadians=o.ap(l),this._calcMatrices())}get zoom(){return this._zoom}setZoom(l){let f=this.applyConstrain(this._center,l).zoom;this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this._tileZoom=Math.max(0,Math.floor(f)),this._scale=o.aq(f),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(l){l!==this._elevation&&(this._elevation=l,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(l,f){this._autoCalculateNearFarZ=!1,this._nearZ=l,this._farZ=f,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,f,y){this._unmodified=!1,this._edgeInsets.interpolate(l,f,y),this.constrainInternal(),this._calcMatrices()}resize(l,f,y=!0){this._width=l,this._height=f,y&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new mr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(l){l?(this._lngRange=[l.getWest(),l.getEast()],this._latRange=[l.getSouth(),l.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-o.ao,o.ao])}getCameraQueryGeometry(l,f){if(f.length===1)return[f[0],l];{let{minX:y,minY:w,maxX:P,maxY:L}=o.aa.fromPoints(f).extend(l);return[new o.P(y,w),new o.P(P,w),new o.P(P,L),new o.P(y,L),new o.P(y,w)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;let l=this._unmodified,{center:f,zoom:y}=this.applyConstrain(this.center,this.zoom);this.setCenter(f),this.setZoom(y),this._unmodified=l,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let l=o.ar(new Float64Array(16));o.Q(l,l,[this._width/2,-this._height/2,1]),o.O(l,l,[1,-1,0]),this._clipSpaceToPixelsMatrix=l,l=o.ar(new Float64Array(16)),o.Q(l,l,[1,-1,1]),o.O(l,l,[-1,-1,0]),o.Q(l,l,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=l,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(l,f,y,w){let P=y!==void 0?y:this.bearing,L=w=w!==void 0?w:this.pitch,{distanceToCenter:z,clampedElevation:G}=this._distanceToCenterFromAltElevationPitch(f,this.elevation,L),{x:j,y:Q}=zn(L,P),ie=o.a9.fromLngLat(l,f),re,ce,de=o.a_(1,ie.y),Te=0;do{if(Te+=1,Te>10)break;ce=z/de,re=new o.a9(ie.x+j*ce,ie.y+Q*ce),de=1/re.meterInMercatorCoordinateUnits()}while(Math.abs(z-ce*de)>1e-12);return{center:re.toLngLat(),elevation:G,zoom:o.at(this.height/2/Math.tan(this.fovInRadians/2)/ce/this.tileSize)}}recalculateZoomAndCenter(l){if(this.elevation-l==0)return;let f=1/this.worldSize,y=o.as(1,this.center.lat)*this.worldSize,w=o.a9.fromLngLat(this.center,this.elevation),P=w.x/f,L=w.y/f,z=w.z/f,G=this.pitch,j=this.bearing,{x:Q,y:ie,z:re}=zn(G,j),ce=this.cameraToCenterDistance,de=P+ce*-Q,Te=L+ce*-ie,Ie=z+ce*re,{distanceToCenter:Me,clampedElevation:Oe}=this._distanceToCenterFromAltElevationPitch(Ie/y,l,G),We=Me*y,De=new o.a9((de+Q*We)*f,(Te+ie*We)*f,0).toLngLat(),Ge=o.as(1,De.lat),Be=o.at(this.height/2/Math.tan(this.fovInRadians/2)/Me/Ge/this.tileSize);this._elevation=Oe,this._center=De,this.setZoom(Be)}_distanceToCenterFromAltElevationPitch(l,f,y){let w=-Math.cos(o.ap(y)),P=l-f,L,z=f;return w*P>=0||Math.abs(w)<.1?(L=1e4,z=l+L*w):L=-P/w,{distanceToCenter:L,clampedElevation:z}}getCameraPoint(){let l=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(l*Math.sin(this.rollInRadians),l*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){let l=o.as(1,this.center.lat)*this.worldSize;return Ke(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/l).toLngLat()}getMercatorTileCoordinates(l){if(!l)return[0,0,1,1];let f=l.canonical.z>=0?1<<l.canonical.z:Math.pow(2,l.canonical.z);return[l.canonical.x/f,l.canonical.y/f,1/f/o.a5,1/f/o.a5]}}class Dc{constructor(l,f){this.min=l,this.max=f,this.center=o.a$([],o.b0([],this.min,this.max),.5)}quadrant(l){let f=[l%2==0,l<2],y=o.b1(this.min),w=o.b1(this.max);for(let P=0;P<f.length;P++)y[P]=f[P]?this.min[P]:this.center[P],w[P]=f[P]?this.center[P]:this.max[P];return w[2]=this.max[2],new Dc(y,w)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersectsFrustum(l){let f=!0;for(let y=0;y<l.planes.length;y++){let w=this.intersectsPlane(l.planes[y]);if(w===0)return 0;w===1&&(f=!1)}return f?2:l.aabb.min[0]>this.max[0]||l.aabb.min[1]>this.max[1]||l.aabb.min[2]>this.max[2]||l.aabb.max[0]<this.min[0]||l.aabb.max[1]<this.min[1]||l.aabb.max[2]<this.min[2]?0:1}intersectsPlane(l){let f=l[3],y=l[3];for(let w=0;w<3;w++)l[w]>0?(f+=l[w]*this.min[w],y+=l[w]*this.max[w]):(y+=l[w]*this.min[w],f+=l[w]*this.max[w]);return f>=0?2:y<0?0:1}}class Ag{distanceToTile2d(l,f,y,w){let P=w.distanceX([l,f]),L=w.distanceY([l,f]);return Math.hypot(P,L)}getWrap(l,f,y){return y}getTileBoundingVolume(l,f,y,w){var P,L;let z=0,G=0;if(w?.terrain){let Q=new o.a2(l.z,f,l.z,l.x,l.y),ie=w.terrain.getMinMaxElevation(Q);z=(P=ie.minElevation)!==null&&P!==void 0?P:Math.min(0,y),G=(L=ie.maxElevation)!==null&&L!==void 0?L:Math.max(0,y)}let j=1<<l.z;return new Dc([f+l.x/j,l.y/j,z],[f+(l.x+1)/j,(l.y+1)/j,G])}allowVariableZoom(l,f){let y=l.fov*(Math.abs(Math.cos(l.rollInRadians))*l.height+Math.abs(Math.sin(l.rollInRadians))*l.width)/l.height,w=o.an(78.5-y/2,0,60);return!!f.terrain||l.pitch>w}allowWorldCopies(){return!0}prepareNextFrame(){}}class Da{constructor(l,f,y){this.points=l,this.planes=f,this.aabb=y}static fromInvProjectionMatrix(l,f=1,y=0,w,P){let L=P?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],z=Math.pow(2,y),G=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((re=>(function(ce,de,Te,Ie){let Me=o.aH([],ce,de),Oe=1/Me[3]/Te*Ie;return o.b6(Me,Me,[Oe,Oe,1/Me[3],Oe])})(re,l,f,z)));w&&(function(re,ce,de,Te){let Ie=Te?4:0,Me=Te?0:4,Oe=0,We=[],De=[];for(let Fe=0;Fe<4;Fe++){let Ve=o.b2([],re[Fe+Me],re[Fe+Ie]),ct=o.b7(Ve);o.a$(Ve,Ve,1/ct),We.push(ct),De.push(Ve)}for(let Fe=0;Fe<4;Fe++){let Ve=o.b8(re[Fe+Ie],De[Fe],de);Oe=Ve!==null&&Ve>=0?Math.max(Oe,Ve):Math.max(Oe,We[Fe])}let Ge=(function(Fe,Ve){let ct=o.b2([],Fe[Ve[0]],Fe[Ve[1]]),dt=o.b2([],Fe[Ve[2]],Fe[Ve[1]]),pt=[0,0,0,0];return o.b3(pt,o.b4([],ct,dt)),pt[3]=-o.b5(pt,Fe[Ve[0]]),pt})(re,ce),Be=(function(Fe,Ve){let ct=o.b9(Fe),dt=o.ba([],Fe,1/ct),pt=o.b2([],Ve,o.a$([],dt,o.b5(Ve,dt))),ft=o.b9(pt);if(ft>0){let Xt=Math.sqrt(1-dt[3]*dt[3]),Ut=o.a$([],dt,-dt[3]),Bt=o.b0([],Ut,o.a$([],pt,Xt/ft));return o.bb(Ve,Bt)}return null})(de,Ge);if(Be!==null){let Fe=Be/o.b5(De[0],Ge);Oe=Math.min(Oe,Fe)}for(let Fe=0;Fe<4;Fe++){let Ve=Math.min(Oe,We[Fe]);re[Fe+Me]=[re[Fe+Ie][0]+De[Fe][0]*Ve,re[Fe+Ie][1]+De[Fe][1]*Ve,re[Fe+Ie][2]+De[Fe][2]*Ve,1]}})(G,L[0],w,P);let j=L.map((re=>{let ce=o.b2([],G[re[0]],G[re[1]]),de=o.b2([],G[re[2]],G[re[1]]),Te=o.b3([],o.b4([],ce,de)),Ie=-o.b5(Te,G[re[1]]);return Te.concat(Ie)})),Q=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],ie=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let re of G)for(let ce=0;ce<3;ce++)Q[ce]=Math.min(Q[ce],re[ce]),ie[ce]=Math.max(ie[ce],re[ce]);return new Da(G,j,new Dc(Q,ie))}}class Af{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,f,y){return this._helper.interpolatePadding(l,f,y)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,f,y=!0){this._helper.resize(l,f,y)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}setConstrainOverride(l){this._helper.setConstrainOverride(l)}overrideNearFarZ(l,f){this._helper.overrideNearFarZ(l,f)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l,f){}constructor(l){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(f,y)=>{y=o.an(+y,this.minZoom,this.maxZoom);let w={center:new o.V(f.lng,f.lat),zoom:y},P=this._helper._lngRange;if(!this._helper._renderWorldCopies&&P===null){let De=179.9999999999;P=[-De,De]}let L=this.tileSize*o.aq(w.zoom),z=0,G=L,j=0,Q=L,ie=0,re=0,{x:ce,y:de}=this.size;if(this._helper._latRange){let De=this._helper._latRange;z=o.X(De[1])*L,G=o.X(De[0])*L,G-z<de&&(ie=de/(G-z))}P&&(j=o.W(o.Y(P[0])*L,0,L),Q=o.W(o.Y(P[1])*L,0,L),Q<j&&(Q+=L),Q-j<ce&&(re=ce/(Q-j)));let{x:Te,y:Ie}=nt(L,f),Me,Oe,We=Math.max(re||0,ie||0);if(We){let De=new o.P(re?(Q+j)/2:Te,ie?(G+z)/2:Ie);return w.center=Dt(L,De).wrap(),w.zoom+=o.at(We),w}if(this._helper._latRange){let De=de/2;Ie-De<z&&(Oe=z+De),Ie+De>G&&(Oe=G-De)}if(P){let De=(j+Q)/2,Ge=Te;this._helper._renderWorldCopies&&(Ge=o.W(Te,De-L/2,De+L/2));let Be=ce/2;Ge-Be<j&&(Me=j+Be),Ge+Be>Q&&(Me=Q-Be)}if(Me!==void 0||Oe!==void 0){let De=new o.P(Me??Te,Oe??Ie);w.center=Dt(L,De).wrap()}return w},this.applyConstrain=(f,y)=>this._helper.applyConstrain(f,y),this._helper=new pf({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(f,y)=>this.defaultConstrain(f,y)},l),this._coveringTilesDetailsProvider=new Ag}clone(){let l=new Af;return l.apply(this,!1),l}apply(l,f,y){this._helper.apply(l,f,y)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(l){let f=[new o.bc(0,l)];if(this._helper._renderWorldCopies){let y=this.screenPointToMercatorCoordinate(new o.P(0,0)),w=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),P=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),L=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),z=Math.floor(Math.min(y.x,w.x,P.x,L.x)),G=Math.floor(Math.max(y.x,w.x,P.x,L.x)),j=1;for(let Q=z-j;Q<=G+j;Q++)Q!==0&&f.push(new o.bc(Q,l))}return f}getCameraFrustum(){return Da.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){let f=this.screenPointToLocation(this.centerPoint,l),y=l?l.getElevationForLngLatZoom(f,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(y)}setLocationAtPoint(l,f){let y=o.as(this.elevation,this.center.lat),w=this.screenPointToMercatorCoordinateAtZ(f,y),P=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,y),L=o.a9.fromLngLat(l),z=new o.a9(L.x-(w.x-P.x),L.y-(w.y-P.y));this.setCenter(z?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(l,f){return f?this.coordinatePoint(o.a9.fromLngLat(l),f.getElevationForLngLat(l,this),this._pixelMatrix3D):this.coordinatePoint(o.a9.fromLngLat(l))}screenPointToLocation(l,f){var y;return(y=this.screenPointToMercatorCoordinate(l,f))===null||y===void 0?void 0:y.toLngLat()}screenPointToMercatorCoordinate(l,f){if(f){let y=f.pointCoordinate(l);if(y!=null)return y}return this.screenPointToMercatorCoordinateAtZ(l)}screenPointToMercatorCoordinateAtZ(l,f){let y=f||0,w=[l.x,l.y,0,1],P=[l.x,l.y,1,1];o.aH(w,w,this._pixelMatrixInverse),o.aH(P,P,this._pixelMatrixInverse);let L=w[3],z=P[3],G=w[1]/L,j=P[1]/z,Q=w[2]/L,ie=P[2]/z,re=Q===ie?0:(y-Q)/(ie-Q);return new o.a9(o.G.number(w[0]/L,P[0]/z,re)/this.worldSize,o.G.number(G,j,re)/this.worldSize,y)}coordinatePoint(l,f=0,y=this._pixelMatrix){let w=[l.x*this.worldSize,l.y*this.worldSize,f,1];return o.aH(w,w,y),new o.P(w[0]/w[3],w[1]/w[3])}getBounds(){let l=Math.max(0,this._helper._height/2-vt(this));return new mr().extend(this.screenPointToLocation(new o.P(0,l))).extend(this.screenPointToLocation(new o.P(this._helper._width,l))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(l,f){return f?f.pointCoordinate(l)!=null:l.y>this.height/2-vt(this)}calculatePosMatrix(l,f=!1,y){var w;let P=(w=l.key)!==null&&w!==void 0?w:o.bd(l.wrap,l.canonical.z,l.canonical.z,l.canonical.x,l.canonical.y),L=f?this._alignedPosMatrixCache:this._posMatrixCache;if(L.has(P)){let j=L.get(P);return y?j.f32:j.f64}let z=Vt(l,this.worldSize);o.S(z,f?this._alignedProjMatrix:this._viewProjMatrix,z);let G={f64:z,f32:new Float32Array(z)};return L.set(P,G),y?G.f32:G.f64}calculateFogMatrix(l){let f=l.key,y=this._fogMatrixCacheF32;if(y.has(f))return y.get(f);let w=Vt(l,this.worldSize);return o.S(w,this._fogMatrix,w),y.set(f,new Float32Array(w)),y.get(f)}calculateCenterFromCameraLngLatAlt(l,f,y,w){return this._helper.calculateCenterFromCameraLngLatAlt(l,f,y,w)}_calculateNearFarZIfNeeded(l,f,y){if(!this._helper.autoCalculateNearFarZ)return;let w=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),P=l-w*this._helper._pixelPerMeter/Math.cos(f),L=w<0?P:l,z=Math.PI/2+this.pitchInRadians,G=o.ap(this.fov)*(Math.abs(Math.cos(o.ap(this.roll)))*this.height+Math.abs(Math.sin(o.ap(this.roll)))*this.width)/this.height*(.5+y.y/this.height),j=Math.sin(G)*L/Math.sin(o.an(Math.PI-z-G,.01,Math.PI-.01)),Q=vt(this),ie=Math.atan(Q/this._helper.cameraToCenterDistance),re=o.ap(.75),ce=ie>re?2*ie*(.5+y.y/(2*Q)):re,de=Math.sin(ce)*L/Math.sin(o.an(Math.PI-z-ce,.01,Math.PI-.01)),Te=Math.min(j,de);this._helper._farZ=1.01*(Math.cos(Math.PI/2-f)*Te+L),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;let l=this.centerOffset,f=nt(this.worldSize,this.center),y=f.x,w=f.y;this._helper._pixelPerMeter=o.as(1,this.center.lat)*this.worldSize;let P=o.ap(Math.min(this.pitch,Je)),L=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(P)),z;this._calculateNearFarZIfNeeded(L,P,l),z=new Float64Array(16),o.be(z,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aB(this._invProjMatrix,z),z[8]=2*-l.x/this._helper._width,z[9]=2*l.y/this._helper._height,this._projectionMatrix=o.bf(z),o.Q(z,z,[1,-1,1]),o.O(z,z,[0,0,-this._helper.cameraToCenterDistance]),o.bg(z,z,-this.rollInRadians),o.bh(z,z,this.pitchInRadians),o.bg(z,z,-this.bearingInRadians),o.O(z,z,[-y,-w,0]),this._mercatorMatrix=o.Q([],z,[this.worldSize,this.worldSize,this.worldSize]),o.Q(z,z,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,z),o.O(z,z,[0,0,-this.elevation]),this._viewProjMatrix=z,this._invViewProjMatrix=o.aB([],z);let G=[0,0,-1,1];o.aH(G,G,this._invViewProjMatrix),this._cameraPosition=[G[0]/G[3],G[1]/G[3],G[2]/G[3]],this._fogMatrix=new Float64Array(16),o.be(this._fogMatrix,this.fovInRadians,this.width/this.height,L,this._helper._farZ),this._fogMatrix[8]=2*-l.x/this.width,this._fogMatrix[9]=2*l.y/this.height,o.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.O(this._fogMatrix,this._fogMatrix,[-y,-w,0]),o.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,z);let j=this._helper._width%2/2,Q=this._helper._height%2/2,ie=Math.cos(this.bearingInRadians),re=Math.sin(-this.bearingInRadians),ce=y-Math.round(y)+ie*j+re*Q,de=w-Math.round(w)+ie*Q+re*j,Te=new Float64Array(z);if(o.O(Te,Te,[ce>.5?ce-1:ce,de>.5?de-1:de,0]),this._alignedProjMatrix=Te,z=o.aB(new Float64Array(16),this._pixelMatrix),!z)throw new Error(\"failed to invert matrix\");this._pixelMatrixInverse=z,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;let l=this.screenPointToMercatorCoordinate(new o.P(0,0)),f=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.aH(f,f,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){let l=o.as(1,this.center.lat)*this.worldSize;return Ke(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/l).toLngLat()}lngLatToCameraDepth(l,f){let y=o.a9.fromLngLat(l),w=[y.x*this.worldSize,y.y*this.worldSize,f,1];return o.aH(w,w,this._viewProjMatrix),w[2]/w[3]}getProjectionData(l){let{overscaledTileID:f,aligned:y,applyTerrainMatrix:w}=l,P=this._helper.getMercatorTileCoordinates(f),L=f?this.calculatePosMatrix(f,y,!0):null,z;return z=f&&f.terrainRttPosMatrix32f&&w?f.terrainRttPosMatrix32f:L||o.bi(),{mainMatrix:z,tileMercatorCoords:P,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:z}}isLocationOccluded(l){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(l,f,y){return 1}transformLightDirection(l){return o.b1(l)}getRayDirectionFromPixel(l){throw new Error(\"Not implemented.\")}projectTileCoordinates(l,f,y,w){let P=this.calculatePosMatrix(y),L;w?(L=[l,f,w(l,f),1],o.aH(L,L,P)):(L=[l,f,0,1],ph(L,L,P));let z=L[3];return{point:new o.P(L[0]/z,L[1]/z),signedDistanceFromCamera:z,isOccluded:!1}}populateCache(l){for(let f of l)this.calculatePosMatrix(f)}getMatrixForModel(l,f){let y=o.a9.fromLngLat(l,f),w=y.meterInMercatorCoordinateUnits(),P=o.bj();return o.O(P,P,[y.x,y.y,y.z]),o.bg(P,P,Math.PI),o.bh(P,P,Math.PI/2),o.Q(P,P,[-w,w,w]),P}getProjectionDataForCustomLayer(l=!0){let f=new o.a2(0,0,0,0,0),y=this.getProjectionData({overscaledTileID:f,applyGlobeMatrix:l}),w=Vt(f,this.worldSize);o.S(w,this._viewProjMatrix,w),y.tileMercatorCoords=[0,0,1,1];let P=[o.a5,o.a5,this.worldSize/this._helper.pixelsPerMeter],L=o.bk();return o.Q(L,w,P),y.fallbackMatrix=L,y.mainMatrix=L,y}getFastPathSimpleProjectionMatrix(l){return this.calculatePosMatrix(l)}}function xu(){o.w(\"Map cannot fit within canvas with the given bounds, padding, and/or offset.\")}function _x(I){if(I.useSlerp)if(I.k<1){let l=o.bl(I.startEulerAngles.roll,I.startEulerAngles.pitch,I.startEulerAngles.bearing),f=o.bl(I.endEulerAngles.roll,I.endEulerAngles.pitch,I.endEulerAngles.bearing),y=new Float64Array(4);o.bm(y,l,f,I.k);let w=o.bn(y);I.tr.setRoll(w.roll),I.tr.setPitch(w.pitch),I.tr.setBearing(w.bearing)}else I.tr.setRoll(I.endEulerAngles.roll),I.tr.setPitch(I.endEulerAngles.pitch),I.tr.setBearing(I.endEulerAngles.bearing);else I.tr.setRoll(o.G.number(I.startEulerAngles.roll,I.endEulerAngles.roll,I.k)),I.tr.setPitch(o.G.number(I.startEulerAngles.pitch,I.endEulerAngles.pitch,I.k)),I.tr.setBearing(o.G.number(I.startEulerAngles.bearing,I.endEulerAngles.bearing,I.k))}function P_(I,l,f,y,w){let P=w.padding,L=nt(w.worldSize,f.getNorthWest()),z=nt(w.worldSize,f.getNorthEast()),G=nt(w.worldSize,f.getSouthEast()),j=nt(w.worldSize,f.getSouthWest()),Q=o.ap(-y),ie=L.rotate(Q),re=z.rotate(Q),ce=G.rotate(Q),de=j.rotate(Q),Te=new o.P(Math.max(ie.x,re.x,de.x,ce.x),Math.max(ie.y,re.y,de.y,ce.y)),Ie=new o.P(Math.min(ie.x,re.x,de.x,ce.x),Math.min(ie.y,re.y,de.y,ce.y)),Me=Te.sub(Ie),Oe=(w.width-(P.left+P.right+l.left+l.right))/Me.x,We=(w.height-(P.top+P.bottom+l.top+l.bottom))/Me.y;if(We<0||Oe<0)return void xu();let De=Math.min(o.at(w.scale*Math.min(Oe,We)),I.maxZoom),Ge=o.P.convert(I.offset),Be=new o.P((l.left-l.right)/2,(l.top-l.bottom)/2).rotate(o.ap(y)),Fe=Ge.add(Be).mult(w.scale/o.aq(De));return{center:Dt(w.worldSize,L.add(G).div(2).sub(Fe)),zoom:De,bearing:y}}class gf{get useGlobeControls(){return!1}handlePanInertia(l,f){let y=l.mag(),w=Math.abs(vt(f));return{easingOffset:l.mult(Math.min(.75*w/y,1)),easingCenter:f.center}}handleMapControlsRollPitchBearingZoom(l,f){l.bearingDelta&&f.setBearing(f.bearing+l.bearingDelta),l.pitchDelta&&f.setPitch(f.pitch+l.pitchDelta),l.rollDelta&&f.setRoll(f.roll+l.rollDelta),l.zoomDelta&&f.setZoom(f.zoom+l.zoomDelta)}handleMapControlsPan(l,f,y){l.around.distSqr(f.centerPoint)<.01||f.setLocationAtPoint(y,l.around)}cameraForBoxAndBearing(l,f,y,w,P){return P_(l,f,y,w,P)}handleJumpToCenterZoom(l,f){l.zoom!==(f.zoom!==void 0?+f.zoom:l.zoom)&&l.setZoom(+f.zoom),f.center!==void 0&&l.setCenter(o.V.convert(f.center))}handleEaseTo(l,f){let y=l.zoom,w=l.padding,P={roll:l.roll,pitch:l.pitch,bearing:l.bearing},L={roll:f.roll===void 0?l.roll:f.roll,pitch:f.pitch===void 0?l.pitch:f.pitch,bearing:f.bearing===void 0?l.bearing:f.bearing},z=f.zoom!==void 0,G=!l.isPaddingEqual(f.padding),j=!1,Q=z?+f.zoom:l.zoom,ie=l.centerPoint.add(f.offsetAsPoint),re=l.screenPointToLocation(ie),{center:ce,zoom:de}=l.applyConstrain(o.V.convert(f.center||re),Q??y);yh(l,ce);let Te=nt(l.worldSize,re),Ie=nt(l.worldSize,ce).sub(Te),Me=o.aq(de-y);return j=de!==y,{easeFunc:Oe=>{if(j&&l.setZoom(o.G.number(y,de,Oe)),o.bo(P,L)||_x({startEulerAngles:P,endEulerAngles:L,tr:l,k:Oe,useSlerp:P.roll!=L.roll}),G&&(l.interpolatePadding(w,f.padding,Oe),ie=l.centerPoint.add(f.offsetAsPoint)),f.around)l.setLocationAtPoint(f.around,f.aroundPoint);else{let We=o.aq(l.zoom-y),De=de>y?Math.min(2,Me):Math.max(.5,Me),Ge=Math.pow(De,1-Oe),Be=Dt(l.worldSize,Te.add(Ie.mult(Oe*Ge)).mult(We));l.setLocationAtPoint(l.renderWorldCopies?Be.wrap():Be,ie)}},isZooming:j,elevationCenter:ce}}handleFlyTo(l,f){let y=f.zoom!==void 0,w=l.zoom,P=l.applyConstrain(o.V.convert(f.center||f.locationAtOffset),y?+f.zoom:w),L=P.center,z=P.zoom;yh(l,L);let G=nt(l.worldSize,f.locationAtOffset),j=nt(l.worldSize,L).sub(G),Q=j.mag(),ie=o.aq(z-w),re;if(f.minZoom!==void 0){let ce=Math.min(+f.minZoom,w,z),de=l.applyConstrain(L,ce).zoom;re=o.aq(de-w)}return{easeFunc:(ce,de,Te,Ie)=>{l.setZoom(ce===1?z:w+o.at(de));let Me=ce===1?L:Dt(l.worldSize,G.add(j.mult(Te)).mult(de));l.setLocationAtPoint(l.renderWorldCopies?Me.wrap():Me,Ie)},scaleOfZoom:ie,targetCenter:L,scaleOfMinZoom:re,pixelPathLength:Q}}}class bi{constructor(l,f,y){this.blendFunction=l,this.blendColor=f,this.mask=y}}bi.Replace=[1,0],bi.disabled=new bi(bi.Replace,o.bp.transparent,[!1,!1,!1,!1]),bi.unblended=new bi(bi.Replace,o.bp.transparent,[!0,!0,!0,!0]),bi.alphaBlended=new bi([1,771],o.bp.transparent,[!0,!0,!0,!0]);let md=2305;class Tr{constructor(l,f,y){this.enable=l,this.mode=f,this.frontFace=y}}Tr.disabled=new Tr(!1,1029,md),Tr.backCCW=new Tr(!0,1029,md),Tr.frontCCW=new Tr(!0,1028,md);class sr{constructor(l,f,y){this.func=l,this.mask=f,this.range=y}}sr.ReadOnly=!1,sr.ReadWrite=!0,sr.disabled=new sr(519,sr.ReadOnly,[0,1]);let _d=7680;class Pr{constructor(l,f,y,w,P,L){this.test=l,this.ref=f,this.mask=y,this.fail=w,this.depthFail=P,this.pass=L}}Pr.disabled=new Pr({func:519,mask:0},0,0,_d,_d,_d);let i0=new WeakMap;function Bl(I){var l;if(i0.has(I))return i0.get(I);{let f=(l=I.getParameter(I.VERSION))===null||l===void 0?void 0:l.startsWith(\"WebGL 2.0\");return i0.set(I,f),f}}class yd{get awaitingQuery(){return!!this._readbackQueue}constructor(l){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=l;let f=l.context,y=f.gl;this._texFormat=y.RGBA,this._texType=y.UNSIGNED_BYTE;let w=new o.aW;w.emplaceBack(-1,-1),w.emplaceBack(2,-1),w.emplaceBack(-1,2);let P=new o.aY;P.emplaceBack(0,1,2),this._fullscreenTriangle=new vi(f.createVertexBuffer(w,_h.members),f.createIndexBuffer(P),o.aX.simpleSegment(0,0,w.length,P.length)),this._resultBuffer=new Uint8Array(4),f.activeTexture.set(y.TEXTURE1);let L=y.createTexture();y.bindTexture(y.TEXTURE_2D,L),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.NEAREST),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.NEAREST),y.texImage2D(y.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=f.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(L),Bl(y)&&(this._pbo=y.createBuffer(),y.bindBuffer(y.PIXEL_PACK_BUFFER,this._pbo),y.bufferData(y.PIXEL_PACK_BUFFER,4,y.STREAM_READ),y.bindBuffer(y.PIXEL_PACK_BUFFER,null))}destroy(){let l=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),l.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(l,f){let y=this._updateCount;return this._readbackQueue?y>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():y>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(l,f),this._updateCount++,this._measuredError}_bindFramebuffer(){let l=this._cachedRenderContext.context,f=l.gl;l.activeTexture.set(f.TEXTURE1),f.bindTexture(f.TEXTURE_2D,this._fbo.colorAttachment.get()),l.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(l,f){let y=this._cachedRenderContext.context,w=y.gl;if(this._bindFramebuffer(),y.viewport.set([0,0,this._texWidth,this._texHeight]),y.clear({color:o.bp.transparent}),this._cachedRenderContext.useProgram(\"projectionErrorMeasurement\").draw(y,w.TRIANGLES,sr.disabled,Pr.disabled,bi.unblended,Tr.disabled,((P,L)=>({u_input:P,u_output_expected:L}))(l,f),null,null,\"$clipping\",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Bl(w)){w.bindBuffer(w.PIXEL_PACK_BUFFER,this._pbo),w.readBuffer(w.COLOR_ATTACHMENT0),w.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),w.bindBuffer(w.PIXEL_PACK_BUFFER,null);let P=w.fenceSync(w.SYNC_GPU_COMMANDS_COMPLETE,0);w.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:P}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){let l=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Bl(l)){let f=l.clientWaitSync(this._readbackQueue.sync,0,0);if(f===l.WAIT_FAILED)return o.w(\"WebGL2 clientWaitSync failed.\"),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(f===l.TIMEOUT_EXPIRED)return;l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),l.bindBuffer(l.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),l.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=yd._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(l){let f=0;return f+=l[0]/256,f+=l[1]/65536,f+=l[2]/16777216,l[3]<127&&(f=-f),f/128}}let xh=o.a5/128;function yx(I,l){let f=I.granularity!==void 0?Math.max(I.granularity,1):1,y=f+(I.generateBorders?2:0),w=f+(I.extendToNorthPole||I.generateBorders?1:0)+(I.extendToSouthPole||I.generateBorders?1:0),P=y+1,L=w+1,z=I.generateBorders?-1:0,G=I.generateBorders||I.extendToNorthPole?-1:0,j=f+(I.generateBorders?1:0),Q=f+(I.generateBorders||I.extendToSouthPole?1:0),ie=P*L,re=y*w*6,ce=P*L>65536;if(ce&&l===\"16bit\")throw new Error(\"Granularity is too large and meshes would not fit inside 16 bit vertex indices.\");let de=ce||l===\"32bit\",Te=new Int16Array(2*ie),Ie=0;for(let We=G;We<=Q;We++)for(let De=z;De<=j;De++){let Ge=De/f*o.a5;De===-1&&(Ge=-xh),De===f+1&&(Ge=o.a5+xh);let Be=We/f*o.a5;We===-1&&(Be=I.extendToNorthPole?o.br:-xh),We===f+1&&(Be=I.extendToSouthPole?o.bs:o.a5+xh),Te[Ie++]=Ge,Te[Ie++]=Be}let Me=de?new Uint32Array(re):new Uint16Array(re),Oe=0;for(let We=0;We<w;We++)for(let De=0;De<y;De++){let Ge=De+1+We*P,Be=De+(We+1)*P,Fe=De+1+(We+1)*P;Me[Oe++]=De+We*P,Me[Oe++]=Be,Me[Oe++]=Ge,Me[Oe++]=Ge,Me[Oe++]=Be,Me[Oe++]=Fe}return{vertices:Te.buffer.slice(0),indices:Me.buffer.slice(0),uses32bitIndices:de}}let o0=new o.aV({fill:new o.bt(128,2),line:new o.bt(512,0),tile:new o.bt(128,32),stencil:new o.bt(128,1),circle:3});class R_{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return\"vertical-perspective\"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return\"globe\"}get shaderDefine(){return\"#define GLOBE\"}get shaderPreludeCode(){return Kn.projectionGlobe}get vertexShaderPreludeCode(){return Kn.projectionMercator.vertexSource}get subdivisionGranularity(){return o0}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(l){this._errorMeasurement||(this._errorMeasurement=new yd(l));let f=o.X(this._errorQueryLatitudeDegrees),y=2*Math.atan(Math.exp(Math.PI-f*Math.PI*2))-.5*Math.PI,w=this._errorMeasurement.updateErrorLoop(f,y),P=k();w!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=w,this._errorMeasurementLastChangeTime=P);let L=Math.min(Math.max((P-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bv(L))}_getMeshKey(l){return`${l.granularity.toString(36)}_${l.generateBorders?\"b\":\"\"}${l.extendToNorthPole?\"n\":\"\"}${l.extendToSouthPole?\"s\":\"\"}`}getMeshFromTileID(l,f,y,w,P){let L=(P===\"stencil\"?o0.stencil:o0.tile).getGranularityForZoomLevel(f.z);return this._getMesh(l,{granularity:L,generateBorders:y,extendToNorthPole:f.y===0&&w,extendToSouthPole:f.y===(1<<f.z)-1&&w})}_getMesh(l,f){let y=this._getMeshKey(f);if(y in this._tileMeshCache)return this._tileMeshCache[y];let w=(function(P,L){let z=yx(L,\"16bit\"),G=o.aW.deserialize({arrayBuffer:z.vertices,length:z.vertices.byteLength/2/2}),j=o.aY.deserialize({arrayBuffer:z.indices,length:z.indices.byteLength/2/3});return new vi(P.createVertexBuffer(G,_h.members),P.createIndexBuffer(j),o.aX.simpleSegment(0,0,G.length,j.length))})(l,f);return this._tileMeshCache[y]=w,w}recalculate(l){}hasTransition(){let l=k(),f=!1;return f=f||(l-this._errorMeasurementLastChangeTime)/1e3<.7,f=f||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,f}setErrorQueryLatitudeDegrees(l){this._errorQueryLatitudeDegrees=l}}let iE=new o.t({type:new o.D(o.u.projection.type)});class xx extends o.E{constructor(l){super(),this._transitionable=new o.x(iE,void 0),this.setProjection(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0)),this._mercatorProjection=new oa,this._verticalPerspectiveProjection=new R_}get transitionState(){let l=this.properties.get(\"type\");if(typeof l==\"string\"&&l===\"mercator\")return 0;if(typeof l==\"string\"&&l===\"vertical-perspective\")return 1;if(l instanceof o.bw){if(l.from===\"vertical-perspective\"&&l.to===\"mercator\")return 1-l.transition;if(l.from===\"mercator\"&&l.to===\"vertical-perspective\")return l.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return\"globe\"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(l){this._mercatorProjection.updateGPUdependent(l),this._verticalPerspectiveProjection.updateGPUdependent(l)}getMeshFromTileID(l,f,y,w,P){return this.currentProjection.getMeshFromTileID(l,f,y,w,P)}setProjection(l){this._transitionable.setValue(\"type\",l?.type||\"mercator\")}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}setErrorQueryLatitudeDegrees(l){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(l),this._mercatorProjection.setErrorQueryLatitudeDegrees(l)}}function sa(I){let l=mf(I.worldSize,I.center.lat);return 2*Math.PI*l}function Lc(I,l,f,y,w){let P=1/(1<<w),L=l/o.a5*P+y*P,z=o.bz((I/o.a5*P+f*P)*Math.PI*2+Math.PI,2*Math.PI),G=2*Math.atan(Math.exp(Math.PI-L*Math.PI*2))-.5*Math.PI,j=Math.cos(G),Q=new Float64Array(3);return Q[0]=Math.sin(z)*j,Q[1]=Math.sin(G),Q[2]=Math.cos(z)*j,Q}function ji(I){return(function(l,f){let y=Math.cos(f),w=new Float64Array(3);return w[0]=Math.sin(l)*y,w[1]=Math.sin(f),w[2]=Math.cos(l)*y,w})(I.lng*Math.PI/180,I.lat*Math.PI/180)}function mf(I,l){return I/(2*Math.PI)/Math.cos(l*Math.PI/180)}function s0(I){let l=Math.asin(I[1])/Math.PI*180,f=Math.sqrt(I[0]*I[0]+I[2]*I[2]);if(f>1e-6){let y=I[0]/f,w=Math.acos(I[2]/f),P=(y>0?w:-w)/Math.PI*180;return new o.V(o.W(P,-180,180),l)}return new o.V(0,l)}function xd(I){return Math.cos(I*Math.PI/180)}function to(I,l){let f=xd(I),y=xd(l);return o.at(y/f)}function a0(I,l){let f=I.rotate(l.bearingInRadians),y=l.zoom+to(l.center.lat,0),w=o.bu(1/xd(l.center.lat),1/xd(Math.min(Math.abs(l.center.lat),60)),o.bx(y,7,3,0,1)),P=360/sa({worldSize:l.worldSize,center:{lat:l.center.lat}});return new o.V(l.center.lng-f.x*P*w,o.an(l.center.lat+f.y*P,-o.ao,o.ao))}function l0(I){let l=.5*I,f=Math.sin(l),y=Math.cos(l);return Math.log(f+y)-Math.log(y-f)}function gg(I,l,f,y){let w=I.lat+f*y;if(Math.abs(f)>1){let P=(Math.sign(I.lat+f)!==Math.sign(I.lat)?-Math.abs(I.lat):Math.abs(I.lat))*Math.PI/180,L=Math.abs(I.lat+f)*Math.PI/180,z=l0(P+y*(L-P)),G=l0(P),j=l0(L);return new o.V(I.lng+l*((z-G)/(j-G)),w)}return new o.V(I.lng+l*y,w)}class B_{constructor(l){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=l}swapBuffers(){if(!this._hadAnyChanges)return;let l=this._cachePrevious;this._cachePrevious=this._cache,this._cache=l,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(l,f,y,w){let P=`${l.z}_${l.x}_${l.y}_${w?.terrain?\"t\":\"\"}`,L=this._cache.get(P);if(L)return L;let z=this._cachePrevious.get(P);if(z)return this._cache.set(P,z),z;let G=this._boundingVolumeFactory(l,f,y,w);return this._cache.set(P,G),this._hadAnyChanges=!0,G}}class Oc{constructor(l,f,y,w){this.min=y,this.max=w,this.points=l,this.planes=f}static fromAabb(l,f){let y=[];for(let w=0;w<8;w++)y.push([1&~w?l[0]:f[0],(w>>1&1)==1?f[1]:l[1],(w>>2&1)==1?f[2]:l[2]]);return new Oc(y,[[-1,0,0,f[0]],[1,0,0,-l[0]],[0,-1,0,f[1]],[0,1,0,-l[1]],[0,0,-1,f[2]],[0,0,1,-l[2]]],l,f)}static fromCenterSizeAngles(l,f,y){let w=o.bB([],y[0],y[1],y[2]),P=o.bC([],[f[0],0,0],w),L=o.bC([],[0,f[1],0],w),z=o.bC([],[0,0,f[2]],w),G=[...l],j=[...l];for(let ie=0;ie<8;ie++)for(let re=0;re<3;re++){let ce=l[re]+P[re]*(1&~ie?-1:1)+L[re]*((ie>>1&1)==1?1:-1)+z[re]*((ie>>2&1)==1?1:-1);G[re]=Math.min(G[re],ce),j[re]=Math.max(j[re],ce)}let Q=[];for(let ie=0;ie<8;ie++){let re=[...l];o.b0(re,re,o.a$([],P,1&~ie?-1:1)),o.b0(re,re,o.a$([],L,(ie>>1&1)==1?1:-1)),o.b0(re,re,o.a$([],z,(ie>>2&1)==1?1:-1)),Q.push(re)}return new Oc(Q,[[...P,-o.b5(P,Q[0])],[...L,-o.b5(L,Q[0])],[...z,-o.b5(z,Q[0])],[-P[0],-P[1],-P[2],-o.b5(P,Q[7])],[-L[0],-L[1],-L[2],-o.b5(L,Q[7])],[-z[0],-z[1],-z[2],-o.b5(z,Q[7])]],G,j)}intersectsFrustum(l){let f=!0,y=this.points.length,w=this.planes.length,P=l.planes.length,L=l.points.length;for(let z=0;z<P;z++){let G=l.planes[z],j=0;for(let Q=0;Q<y;Q++){let ie=this.points[Q];G[0]*ie[0]+G[1]*ie[1]+G[2]*ie[2]+G[3]>=0&&j++}if(j===0)return 0;j<y&&(f=!1)}if(f)return 2;for(let z=0;z<w;z++){let G=this.planes[z],j=0;for(let Q=0;Q<L;Q++){let ie=l.points[Q];G[0]*ie[0]+G[1]*ie[1]+G[2]*ie[2]+G[3]>=0&&j++}if(j===0)return 0}return 1}intersectsPlane(l){let f=this.points.length,y=0;for(let w=0;w<f;w++){let P=this.points[w];l[0]*P[0]+l[1]*P[1]+l[2]*P[2]+l[3]>=0&&y++}return y===f?2:y===0?0:1}}function _f(I,l,f){let y=I-l;return y<0?-y:Math.max(0,y-f)}function rl(I,l,f,y,w){let P=I-f,L;return L=P<0?Math.min(-P,1+P-w):P>1?Math.min(Math.max(P-w,0),1-P):0,Math.max(L,_f(l,y,w))}class At{constructor(){this._boundingVolumeCache=new B_(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(l,f,y,w){let P=1<<y.z,L=1/P,z=y.x/P,G=y.y/P,j=2;return j=Math.min(j,rl(l,f,z,G,L)),j=Math.min(j,rl(l,f,z+.5,-G-L,L)),j=Math.min(j,rl(l,f,z+.5,2-G-L,L)),j}getWrap(l,f,y){let w=1<<f.z,P=1/w,L=f.x/w,z=_f(l.x,L,P),G=_f(l.x,L-1,P),j=_f(l.x,L+1,P),Q=Math.min(z,G,j);return Q===j?1:Q===G?-1:0}allowVariableZoom(l,f){return Ir(l,f)>4}allowWorldCopies(){return!1}getTileBoundingVolume(l,f,y,w){return this._boundingVolumeCache.getTileBoundingVolume(l,f,y,w)}_computeTileBoundingVolume(l,f,y,w){var P,L;let z=0,G=0;if(w?.terrain){let j=new o.a2(l.z,f,l.z,l.x,l.y),Q=w.terrain.getMinMaxElevation(j);z=(P=Q.minElevation)!==null&&P!==void 0?P:Math.min(0,y),G=(L=Q.maxElevation)!==null&&L!==void 0?L:Math.max(0,y)}if(z/=o.bE,G/=o.bE,z+=1,G+=1,l.z<=0)return Oc.fromAabb([-G,-G,-G],[G,G,G]);if(l.z===1)return Oc.fromAabb([l.x===0?-G:0,l.y===0?0:-G,-G],[l.x===0?0:G,l.y===0?G:0,G]);{let j=[Lc(0,0,l.x,l.y,l.z),Lc(o.a5,0,l.x,l.y,l.z),Lc(o.a5,o.a5,l.x,l.y,l.z),Lc(0,o.a5,l.x,l.y,l.z)],Q=[];for(let pt of j)Q.push(o.a$([],pt,G));if(G!==z)for(let pt of j)Q.push(o.a$([],pt,z));l.y===0&&Q.push([0,1,0]),l.y===(1<<l.z)-1&&Q.push([0,-1,0]);let ie=[1,1,1],re=[-1,-1,-1];for(let pt of Q)for(let ft=0;ft<3;ft++)ie[ft]=Math.min(ie[ft],pt[ft]),re[ft]=Math.max(re[ft],pt[ft]);let ce=Lc(o.a5/2,o.a5/2,l.x,l.y,l.z),de=o.b4([],[0,1,0],ce);o.b3(de,de);let Te=o.b4([],ce,de);o.b3(Te,Te);let Ie=o.b4([],j[2],j[1]);o.b3(Ie,Ie);let Me=o.b4([],j[0],j[3]);o.b3(Me,Me),Q.push(o.a$([],ce,G)),l.y>=(1<<l.z)/2&&Q.push(o.a$([],Lc(o.a5/2,0,l.x,l.y,l.z),G)),l.y<(1<<l.z)/2&&Q.push(o.a$([],Lc(o.a5/2,o.a5,l.x,l.y,l.z),G));let Oe=Nt(ce,Q),We=Nt(Te,Q),De=[-ce[0],-ce[1],-ce[2],Oe.max],Ge=[ce[0],ce[1],ce[2],-Oe.min],Be=[-Te[0],-Te[1],-Te[2],We.max],Fe=[Te[0],Te[1],Te[2],-We.min],Ve=[...Ie,0],ct=[...Me,0],dt=[];return l.y===0?dt.push(o.bD(ct,Ve,De),o.bD(ct,Ve,Ge)):dt.push(o.bD(Be,Ve,De),o.bD(Be,Ve,Ge),o.bD(Be,ct,De),o.bD(Be,ct,Ge)),l.y===(1<<l.z)-1?dt.push(o.bD(ct,Ve,De),o.bD(ct,Ve,Ge)):dt.push(o.bD(Fe,Ve,De),o.bD(Fe,Ve,Ge),o.bD(Fe,ct,De),o.bD(Fe,ct,Ge)),new Oc(dt,[De,Ge,Be,Fe,Ve,ct],ie,re)}}}function Nt(I,l){let f=1/0,y=-1/0;for(let w of l){let P=o.b5(I,w);f=Math.min(f,P),y=Math.max(y,P)}return{min:f,max:y}}class sn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,f,y){return this._helper.interpolatePadding(l,f,y)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,f){this._helper.resize(l,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}setConstrainOverride(l){this._helper.setConstrainOverride(l)}overrideNearFarZ(l,f){this._helper.overrideNearFarZ(l,f)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l){}constructor(l){this._cachedClippingPlane=o.bF(),this._projectionMatrix=o.bj(),this._globeViewProjMatrix32f=o.bi(),this._globeViewProjMatrixNoCorrection=o.bj(),this._globeViewProjMatrixNoCorrectionInverted=o.bj(),this._globeProjMatrixInverted=o.bj(),this._cameraPosition=o.bA(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(f,y)=>{let w=o.an(f.lat,-o.ao,o.ao),P=o.an(+y,this.minZoom+to(0,w),this.maxZoom);return{center:new o.V(f.lng,w),zoom:P}},this.applyConstrain=(f,y)=>this._helper.applyConstrain(f,y),this._helper=new pf({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(f,y)=>this.defaultConstrain(f,y)},l),this._coveringTilesDetailsProvider=new At}clone(){let l=new sn;return l.apply(this,!1),l}apply(l,f,y){this._globeLatitudeErrorCorrectionRadians=y||0,this._helper.apply(l,f)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){let l=o.bA();return l[0]=this._cameraPosition[0],l[1]=this._cameraPosition[1],l[2]=this._cameraPosition[2],l}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(l){let{overscaledTileID:f,applyGlobeMatrix:y}=l,w=this._helper.getMercatorTileCoordinates(f);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:w,clippingPlane:this._cachedClippingPlane,projectionTransition:y?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(l){let f=this.pitchInRadians,y=this.cameraToCenterDistance/l,w=Math.sin(f)*y,P=Math.cos(f)*y+1,L=1/Math.sqrt(w*w+P*P)*1,z=-w,G=P,j=Math.sqrt(z*z+G*G);z/=j,G/=j;let Q=[0,z,G];o.bG(Q,Q,[0,0,0],-this.bearingInRadians),o.bH(Q,Q,[0,0,0],-1*this.center.lat*Math.PI/180),o.bI(Q,Q,[0,0,0],this.center.lng*Math.PI/180);let ie=1/o.b7(Q);return o.a$(Q,Q,ie),[...Q,-L*ie]}isLocationOccluded(l){return!this.isSurfacePointVisible(ji(l))}transformLightDirection(l){let f=this._helper._center.lng*Math.PI/180,y=this._helper._center.lat*Math.PI/180,w=Math.cos(y),P=[Math.sin(f)*w,Math.sin(y),Math.cos(f)*w],L=[P[2],0,-P[0]],z=[0,0,0];o.b4(z,L,P),o.b3(L,L),o.b3(z,z);let G=[0,0,0];return o.b3(G,[L[0]*l[0]+z[0]*l[1]+P[0]*l[2],L[1]*l[0]+z[1]*l[1]+P[1]*l[2],L[2]*l[0]+z[2]*l[1]+P[2]*l[2]]),G}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(l,f,y){let w=(function(z,G,j){let Q=1/(1<<j.z);return new o.a9(z/o.a5*Q+j.x*Q,G/o.a5*Q+j.y*Q)})(l,f,y.canonical),P=(L=w.y,[o.bz(w.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-L*Math.PI*2))-.5*Math.PI]);var L;return this.getCircleRadiusCorrection()/Math.cos(P[1])}projectTileCoordinates(l,f,y,w){let P=y.canonical,L=Lc(l,f,P.x,P.y,P.z),z=1+(w?w(l,f):0)/o.bE,G=[L[0]*z,L[1]*z,L[2]*z,1];o.aH(G,G,this._globeViewProjMatrixNoCorrection);let j=this._cachedClippingPlane,Q=j[0]*L[0]+j[1]*L[1]+j[2]*L[2]+j[3]<0;return{point:new o.P(G[0]/G[3],G[1]/G[3]),signedDistanceFromCamera:G[3],isOccluded:Q}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;let l=mf(this.worldSize,this.center.lat),f=o.bk(),y=o.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*l),o.be(f,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);let w=this.centerOffset;f[8]=2*-w.x/this._helper._width,f[9]=2*w.y/this._helper._height,this._projectionMatrix=o.bf(f),this._globeProjMatrixInverted=o.bk(),o.aB(this._globeProjMatrixInverted,f),o.O(f,f,[0,0,-this.cameraToCenterDistance]),o.bg(f,f,this.rollInRadians),o.bh(f,f,-this.pitchInRadians),o.bg(f,f,this.bearingInRadians),o.O(f,f,[0,0,-l]);let P=o.bA();P[0]=l,P[1]=l,P[2]=l,o.bh(y,f,this.center.lat*Math.PI/180),o.bJ(y,y,-this.center.lng*Math.PI/180),o.Q(y,y,P),this._globeViewProjMatrixNoCorrection=y,o.bh(f,f,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bJ(f,f,-this.center.lng*Math.PI/180),o.Q(f,f,P),this._globeViewProjMatrix32f=new Float32Array(f),this._globeViewProjMatrixNoCorrectionInverted=o.bk(),o.aB(this._globeViewProjMatrixNoCorrectionInverted,y);let L=o.bA();this._cameraPosition=o.bA(),this._cameraPosition[2]=this.cameraToCenterDistance/l,o.bG(this._cameraPosition,this._cameraPosition,L,-this.rollInRadians),o.bH(this._cameraPosition,this._cameraPosition,L,this.pitchInRadians),o.bG(this._cameraPosition,this._cameraPosition,L,-this.bearingInRadians),o.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bH(this._cameraPosition,this._cameraPosition,L,-this.center.lat*Math.PI/180),o.bI(this._cameraPosition,this._cameraPosition,L,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(l);let z=o.bf(this._globeViewProjMatrixNoCorrectionInverted);o.Q(z,z,[1,1,-1]),this._cachedFrustum=Da.fromInvProjectionMatrix(z,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(l){o.w(\"calculateFogMatrix is not supported on globe projection.\");let f=o.bk();return o.ar(f),f}getVisibleUnwrappedCoordinates(l){return[new o.bc(0,l)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){l&&o.w(\"terrain is not fully supported on vertical perspective projection.\"),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,f){if(!this._globeViewProjMatrixNoCorrection)return 1;let y=ji(l);o.a$(y,y,1+f/o.bE);let w=o.bF();return o.aH(w,[y[0],y[1],y[2],1],this._globeViewProjMatrixNoCorrection),w[2]/w[3]}populateCache(l){}getBounds(){let l=.5*this.width,f=.5*this.height,y=[new o.P(0,0),new o.P(l,0),new o.P(this.width,0),new o.P(this.width,f),new o.P(this.width,this.height),new o.P(l,this.height),new o.P(0,this.height),new o.P(0,f)],w=[];for(let ie of y)w.push(this.unprojectScreenPoint(ie));let P=0,L=0,z=0,G=0,j=this.center;for(let ie of w){let re=o.bK(j.lng,ie.lng),ce=o.bK(j.lat,ie.lat);re<L&&(L=re),re>P&&(P=re),ce<G&&(G=ce),ce>z&&(z=ce)}let Q=[j.lng+L,j.lat+G,j.lng+P,j.lat+z];return this.isSurfacePointOnScreen([0,1,0])&&(Q[3]=90,Q[0]=-180,Q[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(Q[1]=-90,Q[0]=-180,Q[2]=180),new mr(Q)}calculateCenterFromCameraLngLatAlt(l,f,y,w){return this._helper.calculateCenterFromCameraLngLatAlt(l,f,y,w)}setLocationAtPoint(l,f){let y=ji(this.unprojectScreenPoint(f)),w=ji(l),P=o.bA();o.bL(P);let L=o.bA();o.bI(L,y,P,-this.center.lng*Math.PI/180),o.bH(L,L,P,this.center.lat*Math.PI/180);let z=w[0]*w[0]+w[2]*w[2],G=L[0]*L[0];if(z<G)return;let j=Math.sqrt(z-G),Q=-j,ie=o.bM(w[0],w[2],L[0],j),re=o.bM(w[0],w[2],L[0],Q),ce=o.bA();o.bI(ce,w,P,-ie);let de=o.bM(ce[1],ce[2],L[1],L[2]),Te=o.bA();o.bI(Te,w,P,-re);let Ie=o.bM(Te[1],Te[2],L[1],L[2]),Me=.5*Math.PI,Oe=de>=-Me&&de<=Me,We=Ie>=-Me&&Ie<=Me,De,Ge;if(Oe&&We){let ct=this.center.lng*Math.PI/180,dt=this.center.lat*Math.PI/180;o.bN(ie,ct)+o.bN(de,dt)<o.bN(re,ct)+o.bN(Ie,dt)?(De=ie,Ge=de):(De=re,Ge=Ie)}else if(Oe)De=ie,Ge=de;else{if(!We)return;De=re,Ge=Ie}let Be=De/Math.PI*180,Fe=Ge/Math.PI*180,Ve=this.center.lat;this.setCenter(new o.V(Be,o.an(Fe,-90,90))),this.setZoom(this.zoom+to(Ve,this.center.lat))}locationToScreenPoint(l,f){let y=ji(l);if(f){let w=f.getElevationForLngLatZoom(l,this._helper._tileZoom);o.a$(y,y,1+w/o.bE)}return this._projectSurfacePointToScreen(y)}_projectSurfacePointToScreen(l){let f=o.bF();return o.aH(f,[...l,1],this._globeViewProjMatrixNoCorrection),f[0]/=f[3],f[1]/=f[3],new o.P((.5*f[0]+.5)*this.width,(.5*-f[1]+.5)*this.height)}screenPointToMercatorCoordinate(l,f){if(f){let y=f.pointCoordinate(l);if(y)return y}return o.a9.fromLngLat(this.unprojectScreenPoint(l))}screenPointToLocation(l,f){var y;return(y=this.screenPointToMercatorCoordinate(l,f))===null||y===void 0?void 0:y.toLngLat()}isPointOnMapSurface(l,f){let y=this._cameraPosition,w=this.getRayDirectionFromPixel(l);return!!this.rayPlanetIntersection(y,w)}getRayDirectionFromPixel(l){let f=o.bF();f[0]=l.x/this.width*2-1,f[1]=-1*(l.y/this.height*2-1),f[2]=1,f[3]=1,o.aH(f,f,this._globeViewProjMatrixNoCorrectionInverted),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3];let y=o.bA();y[0]=f[0]-this._cameraPosition[0],y[1]=f[1]-this._cameraPosition[1],y[2]=f[2]-this._cameraPosition[2];let w=o.bA();return o.b3(w,y),w}isSurfacePointVisible(l){let f=this._cachedClippingPlane;return f[0]*l[0]+f[1]*l[1]+f[2]*l[2]+f[3]>=0}isSurfacePointOnScreen(l){if(!this.isSurfacePointVisible(l))return!1;let f=o.bF();return o.aH(f,[...l,1],this._globeViewProjMatrixNoCorrection),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3],f[0]>-1&&f[0]<1&&f[1]>-1&&f[1]<1&&f[2]>-1&&f[2]<1}rayPlanetIntersection(l,f){let y=o.b5(l,f),w=o.bA(),P=o.bA();o.a$(P,f,y),o.b2(w,l,P);let L=1-o.b5(w,w);if(L<0)return null;let z=o.b5(l,l)-1,G=-y+(y<0?1:-1)*Math.sqrt(L),j=z/G,Q=G;return{tMin:Math.min(j,Q),tMax:Math.max(j,Q)}}unprojectScreenPoint(l){let f=this._cameraPosition,y=this.getRayDirectionFromPixel(l),w=this.rayPlanetIntersection(f,y);if(w){let Q=o.bA();o.b0(Q,f,[y[0]*w.tMin,y[1]*w.tMin,y[2]*w.tMin]);let ie=o.bA();return o.b3(ie,Q),s0(ie)}let P=this._cachedClippingPlane,L=P[0]*y[0]+P[1]*y[1]+P[2]*y[2],z=-o.bb(P,f)/L,G=o.bA();if(z>0)o.b0(G,f,[y[0]*z,y[1]*z,y[2]*z]);else{let Q=o.bA();o.b0(Q,f,[2*y[0],2*y[1],2*y[2]]);let ie=o.bb(this._cachedClippingPlane,Q);o.b2(G,Q,[this._cachedClippingPlane[0]*ie,this._cachedClippingPlane[1]*ie,this._cachedClippingPlane[2]*ie])}let j=(function(Q){let ie=o.bA();return ie[0]=Q[0]*-Q[3],ie[1]=Q[1]*-Q[3],ie[2]=Q[2]*-Q[3],{center:ie,radius:Math.sqrt(1-Q[3]*Q[3])}})(P);return s0((function(Q,ie,re){let ce=o.bA();o.b2(ce,re,Q);let de=o.bA();return o.by(de,Q,ce,ie/o.b9(ce)),de})(j.center,j.radius,G))}getMatrixForModel(l,f){let y=o.V.convert(l),w=1/o.bE,P=o.bj();return o.bJ(P,P,y.lng/180*Math.PI),o.bh(P,P,-y.lat/180*Math.PI),o.O(P,P,[0,0,1+f/o.bE]),o.bh(P,P,.5*Math.PI),o.Q(P,P,[w,w,w]),P}getProjectionDataForCustomLayer(l=!0){let f=this.getProjectionData({overscaledTileID:new o.a2(0,0,0,0,0),applyGlobeMatrix:l});return f.tileMercatorCoords=[0,0,1,1],f}getFastPathSimpleProjectionMatrix(l){}}class zt{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,f,y){return this._helper.interpolatePadding(l,f,y)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,f,y=!0){this._helper.resize(l,f,y)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}setConstrainOverride(l){this._helper.setConstrainOverride(l)}overrideNearFarZ(l,f){this._helper.overrideNearFarZ(l,f)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(l,f){this._globeness=l,this._globeLatitudeErrorCorrectionRadians=f,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(l){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(f,y)=>this.currentTransform.defaultConstrain(f,y),this.applyConstrain=(f,y)=>this._helper.applyConstrain(f,y),this._helper=new pf({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(f,y)=>this.defaultConstrain(f,y)},l),this._globeness=1,this._mercatorTransform=new Af,this._verticalPerspectiveTransform=new sn}clone(){let l=new zt;return l._globeness=this._globeness,l._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,l.apply(this,!1),l}apply(l,f){this._helper.apply(l,f),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(l){let f=this._mercatorTransform.getProjectionData(l),y=this._verticalPerspectiveTransform.getProjectionData(l);return{mainMatrix:this.isGlobeRendering?y.mainMatrix:f.mainMatrix,clippingPlane:y.clippingPlane,tileMercatorCoords:y.tileMercatorCoords,projectionTransition:l.applyGlobeMatrix?this._globeness:0,fallbackMatrix:f.fallbackMatrix}}isLocationOccluded(l){return this.currentTransform.isLocationOccluded(l)}transformLightDirection(l){return this.currentTransform.transformLightDirection(l)}getPixelScale(){return o.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(l,f,y){let w=this._mercatorTransform.getPitchedTextCorrection(l,f,y),P=this._verticalPerspectiveTransform.getPitchedTextCorrection(l,f,y);return o.bu(w,P,this._globeness)}projectTileCoordinates(l,f,y,w){return this.currentTransform.projectTileCoordinates(l,f,y,w)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(l){return this.currentTransform.calculateFogMatrix(l)}getVisibleUnwrappedCoordinates(l){return this.currentTransform.getVisibleUnwrappedCoordinates(l)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(l){this._mercatorTransform.recalculateZoomAndCenter(l),this._verticalPerspectiveTransform.recalculateZoomAndCenter(l)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,f){return this.currentTransform.lngLatToCameraDepth(l,f)}populateCache(l){this._mercatorTransform.populateCache(l),this._verticalPerspectiveTransform.populateCache(l)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(l,f,y,w){return this._helper.calculateCenterFromCameraLngLatAlt(l,f,y,w)}setLocationAtPoint(l,f){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(l,f),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(l,f),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(l,f){return this.currentTransform.locationToScreenPoint(l,f)}screenPointToMercatorCoordinate(l,f){return this.currentTransform.screenPointToMercatorCoordinate(l,f)}screenPointToLocation(l,f){return this.currentTransform.screenPointToLocation(l,f)}isPointOnMapSurface(l,f){return this.currentTransform.isPointOnMapSurface(l,f)}getRayDirectionFromPixel(l){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(l)}getMatrixForModel(l,f){return this.currentTransform.getMatrixForModel(l,f)}getProjectionDataForCustomLayer(l=!0){let f=this._mercatorTransform.getProjectionDataForCustomLayer(l);if(!this.isGlobeRendering)return f;let y=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(l);return y.fallbackMatrix=f.mainMatrix,y}getFastPathSimpleProjectionMatrix(l){return this.currentTransform.getFastPathSimpleProjectionMatrix(l)}}class _{get useGlobeControls(){return!0}handlePanInertia(l,f){let y=a0(l,f);return Math.abs(y.lng-f.center.lng)>180&&(y.lng=f.center.lng+179.5*Math.sign(y.lng-f.center.lng)),{easingCenter:y,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(l,f){let y=l.around,w=f.screenPointToLocation(y);l.bearingDelta&&f.setBearing(f.bearing+l.bearingDelta),l.pitchDelta&&f.setPitch(f.pitch+l.pitchDelta),l.rollDelta&&f.setRoll(f.roll+l.rollDelta);let P=f.zoom;l.zoomDelta&&f.setZoom(f.zoom+l.zoomDelta);let L=f.zoom-P;if(L===0)return;let z=o.bK(f.center.lng,w.lng),G=z/(Math.abs(z/180)+1),j=o.bK(f.center.lat,w.lat),Q=f.getRayDirectionFromPixel(y),ie=f.cameraPosition,re=-1*o.b5(ie,Q),ce=o.bA();o.b0(ce,ie,[Q[0]*re,Q[1]*re,Q[2]*re]);let de=o.b7(ce)-1,Te=Math.exp(.5*-Math.max(de-.3,0)),Ie=mf(f.worldSize,f.center.lat)/Math.min(f.width,f.height),Me=o.bx(Ie,.9,.5,1,.25),Oe=(1-o.aq(-L))*Math.min(Te,Me),We=f.center.lat,De=f.zoom,Ge=new o.V(f.center.lng+G*Oe,o.an(f.center.lat+j*Oe,-o.ao,o.ao));f.setLocationAtPoint(w,y);let Be=f.center,Fe=o.bx(Math.abs(z),45,85,0,1),Ve=o.bx(Ie,.75,.35,0,1),ct=Math.pow(Math.max(Fe,Ve),.25),dt=o.bK(Be.lng,Ge.lng),pt=o.bK(Be.lat,Ge.lat);f.setCenter(new o.V(Be.lng+dt*ct,Be.lat+pt*ct).wrap()),f.setZoom(De+to(We,f.center.lat))}handleMapControlsPan(l,f,y){if(!l.panDelta)return;let w=f.center.lat,P=f.zoom;f.setCenter(a0(l.panDelta,f).wrap()),f.setZoom(P+to(w,f.center.lat))}cameraForBoxAndBearing(l,f,y,w,P){let L=P_(l,f,y,w,P),z=f.left/P.width*2-1,G=(P.width-f.right)/P.width*2-1,j=f.top/P.height*-2+1,Q=(P.height-f.bottom)/P.height*-2+1,ie=o.bK(y.getWest(),y.getEast())<0,re=ie?y.getEast():y.getWest(),ce=ie?y.getWest():y.getEast(),de=Math.max(y.getNorth(),y.getSouth()),Te=Math.min(y.getNorth(),y.getSouth()),Ie=re+.5*o.bK(re,ce),Me=de+.5*o.bK(de,Te),Oe=P.clone();Oe.setCenter(L.center),Oe.setBearing(L.bearing),Oe.setPitch(0),Oe.setRoll(0),Oe.setZoom(L.zoom);let We=Oe.modelViewProjectionMatrix,De=[ji(y.getNorthWest()),ji(y.getNorthEast()),ji(y.getSouthWest()),ji(y.getSouthEast()),ji(new o.V(ce,Me)),ji(new o.V(re,Me)),ji(new o.V(Ie,de)),ji(new o.V(Ie,Te))],Ge=ji(L.center),Be=Number.POSITIVE_INFINITY;for(let Fe of De)z<0&&(Be=_.getLesserNonNegativeNonNull(Be,_.solveVectorScale(Fe,Ge,We,\"x\",z))),G>0&&(Be=_.getLesserNonNegativeNonNull(Be,_.solveVectorScale(Fe,Ge,We,\"x\",G))),j>0&&(Be=_.getLesserNonNegativeNonNull(Be,_.solveVectorScale(Fe,Ge,We,\"y\",j))),Q<0&&(Be=_.getLesserNonNegativeNonNull(Be,_.solveVectorScale(Fe,Ge,We,\"y\",Q)));if(Number.isFinite(Be)&&Be!==0)return L.zoom=Oe.zoom+o.at(Be),L;xu()}handleJumpToCenterZoom(l,f){let y=l.center.lat,w=l.applyConstrain(f.center?o.V.convert(f.center):l.center,l.zoom).center;l.setCenter(w.wrap());let P=f.zoom!==void 0?+f.zoom:l.zoom+to(y,w.lat);l.zoom!==P&&l.setZoom(P)}handleEaseTo(l,f){let y=l.zoom,w=l.center,P=l.padding,L={roll:l.roll,pitch:l.pitch,bearing:l.bearing},z={roll:f.roll===void 0?l.roll:f.roll,pitch:f.pitch===void 0?l.pitch:f.pitch,bearing:f.bearing===void 0?l.bearing:f.bearing},G=f.zoom!==void 0,j=!l.isPaddingEqual(f.padding),Q=!1,ie=f.center?o.V.convert(f.center):w,re=l.applyConstrain(ie,y).center;yh(l,re);let ce=l.clone();ce.setCenter(re),ce.setZoom(G?+f.zoom:y+to(w.lat,ie.lat)),ce.setBearing(f.bearing);let de=new o.P(o.an(l.centerPoint.x+f.offsetAsPoint.x,0,l.width),o.an(l.centerPoint.y+f.offsetAsPoint.y,0,l.height));ce.setLocationAtPoint(re,de);let Te=(f.offset&&f.offsetAsPoint.mag())>0?ce.center:re,Ie=G?+f.zoom:y+to(w.lat,Te.lat),Me=y+to(w.lat,0),Oe=Ie+to(Te.lat,0),We=o.bK(w.lng,Te.lng),De=o.bK(w.lat,Te.lat),Ge=o.aq(Oe-Me);return Q=Ie!==y,{easeFunc:Be=>{if(o.bo(L,z)||_x({startEulerAngles:L,endEulerAngles:z,tr:l,k:Be,useSlerp:L.roll!=z.roll}),j&&l.interpolatePadding(P,f.padding,Be),f.around)o.w(\"Easing around a point is not supported under globe projection.\"),l.setLocationAtPoint(f.around,f.aroundPoint);else{let Fe=Oe>Me?Math.min(2,Ge):Math.max(.5,Ge),Ve=Math.pow(Fe,1-Be),ct=gg(w,We,De,Be*Ve);l.setCenter(ct.wrap())}if(Q){let Fe=o.G.number(Me,Oe,Be)+to(0,l.center.lat);l.setZoom(Fe)}},isZooming:Q,elevationCenter:Te}}handleFlyTo(l,f){let y=f.zoom!==void 0,w=l.center,P=l.zoom,L=l.padding,z=!l.isPaddingEqual(f.padding),G=l.applyConstrain(o.V.convert(f.center||f.locationAtOffset),P).center,j=y?+f.zoom:l.zoom+to(l.center.lat,G.lat),Q=l.clone();Q.setCenter(G),Q.setZoom(j),Q.setBearing(f.bearing);let ie=new o.P(o.an(l.centerPoint.x+f.offsetAsPoint.x,0,l.width),o.an(l.centerPoint.y+f.offsetAsPoint.y,0,l.height));Q.setLocationAtPoint(G,ie);let re=Q.center;yh(l,re);let ce=(function(De,Ge,Be){let Fe=ji(Ge),Ve=ji(Be),ct=o.b5(Fe,Ve),dt=Math.acos(ct),pt=sa(De);return dt/(2*Math.PI)*pt})(l,w,re),de=P+to(w.lat,0),Te=j+to(re.lat,0),Ie=o.aq(Te-de),Me;if(typeof f.minZoom==\"number\"){let De=+f.minZoom+to(re.lat,0),Ge=Math.min(De,de,Te)+to(0,re.lat),Be=l.applyConstrain(re,Ge).zoom+to(re.lat,0);Me=o.aq(Be-de)}let Oe=o.bK(w.lng,re.lng),We=o.bK(w.lat,re.lat);return{easeFunc:(De,Ge,Be,Fe)=>{let Ve=gg(w,Oe,We,Be);z&&l.interpolatePadding(L,f.padding,De);let ct=De===1?re:Ve;l.setCenter(ct.wrap());let dt=de+o.at(Ge);l.setZoom(De===1?j:dt+to(0,ct.lat))},scaleOfZoom:Ie,targetCenter:re,scaleOfMinZoom:Me,pixelPathLength:ce}}static solveVectorScale(l,f,y,w,P){let L=w===\"x\"?[y[0],y[4],y[8],y[12]]:[y[1],y[5],y[9],y[13]],z=[y[3],y[7],y[11],y[15]],G=l[0]*L[0]+l[1]*L[1]+l[2]*L[2],j=l[0]*z[0]+l[1]*z[1]+l[2]*z[2],Q=f[0]*L[0]+f[1]*L[1]+f[2]*L[2],ie=f[0]*z[0]+f[1]*z[1]+f[2]*z[2];return Q+P*j===G+P*ie||z[3]*(G-Q)+L[3]*(ie-j)+G*ie==Q*j?null:(Q+L[3]-P*ie-P*z[3])/(Q-G-P*ie+P*j)}static getLesserNonNegativeNonNull(l,f){return f!==null&&f>=0&&f<l?f:l}}class ai{constructor(l){this._globe=l,this._mercatorCameraHelper=new gf,this._verticalPerspectiveCameraHelper=new _}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(l,f){return this.currentHelper.handlePanInertia(l,f)}handleMapControlsRollPitchBearingZoom(l,f){return this.currentHelper.handleMapControlsRollPitchBearingZoom(l,f)}handleMapControlsPan(l,f,y){this.currentHelper.handleMapControlsPan(l,f,y)}cameraForBoxAndBearing(l,f,y,w,P){return this.currentHelper.cameraForBoxAndBearing(l,f,y,w,P)}handleJumpToCenterZoom(l,f){this.currentHelper.handleJumpToCenterZoom(l,f)}handleEaseTo(l,f){return this.currentHelper.handleEaseTo(l,f)}handleFlyTo(l,f){return this.currentHelper.handleFlyTo(l,f)}}let Er=(I,l)=>o.B(I,l&&l.filter((f=>f.identifier!==\"source.canvas\"))),fe=o.bO();class Xi extends o.E{constructor(l,f={}){var y,w;super(),this._rtlPluginLoaded=()=>{for(let L in this.tileManagers){let z=this.tileManagers[L].getSource().type;z!==\"vector\"&&z!==\"geojson\"||this.tileManagers[L].reload()}},this.map=l,this.dispatcher=new nr(Br(),l._getMapId()),this.dispatcher.registerMessageHandler(\"GG\",((L,z)=>this.getGlyphs(L,z))),this.dispatcher.registerMessageHandler(\"GI\",((L,z)=>this.getImages(L,z))),this.dispatcher.registerMessageHandler(\"GDA\",((L,z)=>this.getDashes(L,z))),this.imageManager=new ge,this.imageManager.setEventedParent(this);let P=((y=l._container)===null||y===void 0?void 0:y.lang)||typeof document<\"u\"&&((w=document.documentElement)===null||w===void 0?void 0:w.lang)||void 0;this.glyphManager=new jt(l._requestManager,f.localIdeographFontFamily,P),this.lineAtlas=new _n(256,512),this.crossTileSymbolIndex=new Go,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast(\"SR\",o.bP()),pe().on(Ze,this._rtlPluginLoaded),this.on(\"data\",(L=>{if(L.dataType!==\"source\"||L.sourceDataType!==\"metadata\")return;let z=this.tileManagers[L.sourceId];if(!z)return;let G=z.getSource();if(G&&G.vectorLayerIds)for(let j in this._layers){let Q=this._layers[j];Q.source===G.id&&this._validateLayer(Q)}}))}_setInitialValues(){var l;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new o.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((l=this.crossTileSymbolIndex)===null||l===void 0?void 0:l.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(l,f){var y,w,P;this._checkLoaded();let L=f===null?(P=(w=(y=this.stylesheet.state)===null||y===void 0?void 0:y[l])===null||w===void 0?void 0:w.default)!==null&&P!==void 0?P:null:f;if(o.bR(L,this._globalState[l]))return this;this._globalState[l]=L,this._applyGlobalStateChanges([l])}getGlobalState(){return this._globalState}setGlobalState(l){this._checkLoaded();let f=[];for(let y in l)!o.bR(this._globalState[y],l[y].default)&&(f.push(y),this._globalState[y]=l[y].default);this._applyGlobalStateChanges(f)}_applyGlobalStateChanges(l){if(l.length===0)return;let f=new Set,y={};for(let w of l){y[w]=this._globalState[w];for(let P in this._layers){let L=this._layers[P],z=L.getLayoutAffectingGlobalStateRefs(),G=L.getPaintAffectingGlobalStateRefs(),j=L.getVisibilityAffectingGlobalStateRefs();if(z.has(w)&&f.add(L.source),G.has(w))for(let{name:Q,value:ie}of G.get(w))this._updatePaintProperty(L,Q,ie);j?.has(w)&&(L.recalculateVisibility(),this._updateLayer(L))}}this.dispatcher.broadcast(\"UGS\",y);for(let w in this.tileManagers)f.has(w)&&(this._reloadSource(w),this._changed=!0)}loadURL(l,f={},y){this.fire(new o.l(\"dataloading\",{dataType:\"style\"})),f.validate=typeof f.validate!=\"boolean\"||f.validate;let w=this.map._requestManager.transformRequest(l,\"Style\");this._loadStyleRequest=new AbortController;let P=this._loadStyleRequest;o.j(w,this._loadStyleRequest).then((L=>{this._loadStyleRequest=null,this._load(L.data,f,y)})).catch((L=>{this._loadStyleRequest=null,L&&!P.signal.aborted&&this.fire(new o.k(L))}))}loadJSON(l,f={},y){this.fire(new o.l(\"dataloading\",{dataType:\"style\"})),this._frameRequest=new AbortController,C.frameAsync(this._frameRequest,this.map._ownerWindow).then((()=>{this._frameRequest=null,f.validate=f.validate!==!1,this._load(l,f,y)})).catch((()=>{}))}loadEmpty(){this.fire(new o.l(\"dataloading\",{dataType:\"style\"})),this._load(fe,{validate:!1})}_load(l,f,y){var w,P;let L=f.transformStyle?f.transformStyle(y,l):l;if(!f.validate||!Er(this,o.C(L))){L=Object.assign({},L),this._loaded=!0,this.stylesheet=L;for(let z in L.sources)this.addSource(z,L.sources[z],{validate:!1});L.sprite?this._loadSprite(L.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(L.glyphs),this._createLayers(),this.light=new In(this.stylesheet.light),this._setProjectionInternal(((w=this.stylesheet.projection)===null||w===void 0?void 0:w.type)||\"mercator\"),this.sky=new Pn(this.stylesheet.sky),this.map.setTerrain((P=this.stylesheet.terrain)!==null&&P!==void 0?P:null),this.fire(new o.l(\"data\",{dataType:\"style\"})),this.fire(new o.l(\"style.load\"))}}_createLayers(){var l,f,y;let w=o.bS(this.stylesheet.layers);this.setGlobalState((l=this.stylesheet.state)!==null&&l!==void 0?l:null),this.dispatcher.broadcast(\"SL\",w),this._order=w.map((P=>P.id)),this._layers={},this._serializedLayers=null;for(let P of w){let L=o.bT(P,this._globalState);if(L.setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=L,o.bU(L)&&this.tileManagers[L.source]){let z=(y=(f=P.paint)===null||f===void 0?void 0:f[\"raster-fade-duration\"])!==null&&y!==void 0?y:L.paint.get(\"raster-fade-duration\");this.tileManagers[L.source].setRasterFadeDuration(z)}}}_loadSprite(l,f=!1,y=void 0){this.imageManager.setLoaded(!1);let w=new AbortController,P;this._spriteRequest=w,(function(L,z,G,j){return o._(this,void 0,void 0,(function*(){let Q=Xe(L),ie=G>1?\"@2x\":\"\",re={},ce={};for(let{id:de,url:Te}of Q){let Ie=z.transformRequest(Ne(Te,ie,\".json\"),\"SpriteJSON\");re[de]=o.j(Ie,j);let Me=z.transformRequest(Ne(Te,ie,\".png\"),\"SpriteImage\");ce[de]=xe.getImage(Me,j)}return yield Promise.all([...Object.values(re),...Object.values(ce)]),(function(de,Te){return o._(this,void 0,void 0,(function*(){let Ie={};for(let Me in de){Ie[Me]={};let Oe=C.getImageCanvasContext((yield Te[Me]).data),We=(yield de[Me]).data;for(let De in We){let{width:Ge,height:Be,x:Fe,y:Ve,sdf:ct,pixelRatio:dt,stretchX:pt,stretchY:ft,content:Xt,textFitWidth:Ut,textFitHeight:Bt}=We[De];Ie[Me][De]={data:null,pixelRatio:dt,sdf:ct,stretchX:pt,stretchY:ft,content:Xt,textFitWidth:Ut,textFitHeight:Bt,spriteData:{width:Ge,height:Be,x:Fe,y:Ve,context:Oe}}}}return Ie}))})(re,ce)}))})(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((L=>{if(this._spriteRequest=null,L)for(let z in L){this._spritesImagesIds[z]=[];let G=this._spritesImagesIds[z]?this._spritesImagesIds[z].filter((j=>!(j in L))):[];for(let j of G)this.imageManager.removeImage(j),this._changedImages[j]=!0;for(let j in L[z]){let Q=z===\"default\"?j:`${z}:${j}`;this._spritesImagesIds[z].push(Q),Q in this.imageManager.images?this.imageManager.updateImage(Q,L[z][j],!1):this.imageManager.addImage(Q,L[z][j]),f&&(this._changedImages[Q]=!0)}}})).catch((L=>{this._spriteRequest=null,P=L,w.signal.aborted||this.fire(new o.k(P))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),f&&(this._changed=!0),this.dispatcher.broadcast(\"SI\",this._availableImages),this.fire(new o.l(\"data\",{dataType:\"style\"})),y&&y(P)}))}_unloadSprite(){for(let l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast(\"SI\",this._availableImages),this.fire(new o.l(\"data\",{dataType:\"style\"}))}_validateLayer(l){let f=this.tileManagers[l.source];if(!f)return;let y=l.sourceLayer;if(!y)return;let w=f.getSource();(w.type===\"geojson\"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(y)===-1)&&this.fire(new o.k(new Error(`Source layer \"${y}\" does not exist on source \"${w.id}\" as specified by style layer \"${l.id}\".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let l in this.tileManagers)if(!this.tileManagers[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l,f=!1){let y=this._serializedAllLayers();if(!l||l.length===0)return Object.values(f?o.bV(y):y);let w=[];for(let P of l)if(y[P]){let L=f?o.bV(y[P]):y[P];w.push(L)}return w}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};let f=Object.keys(this._layers);for(let y of f){let w=this._layers[y];w.type!==\"custom\"&&(l[y]=w.serialize())}return l}hasTransitions(){var l,f,y;if(!((l=this.light)===null||l===void 0)&&l.hasTransition()||!((f=this.sky)===null||f===void 0)&&f.hasTransition()||!((y=this.projection)===null||y===void 0)&&y.hasTransition())return!0;for(let w in this.tileManagers)if(this.tileManagers[w].hasTransition())return!0;for(let w in this._layers)if(this._layers[w].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error(\"Style is not done loading.\")}update(l){if(!this._loaded)return;let f=this._changed;if(f){let w=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(w.length||P.length)&&this._updateWorkerLayers(w,P);for(let L in this._updatedSources){let z=this._updatedSources[L];if(z===\"reload\")this._reloadSource(L);else{if(z!==\"clear\")throw new Error(`Invalid action ${z}`);this._clearSource(L)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let L in this._updatedPaintProps)this._layers[L].updateTransitions(l);this.light.updateTransitions(l),this.sky.updateTransitions(l),this._resetUpdates()}let y={};for(let w in this.tileManagers){let P=this.tileManagers[w];y[w]=P.used,P.used=!1}for(let w of this._order){let P=this._layers[w];P.recalculate(l,this._availableImages),!P.isHidden(l.zoom)&&P.source&&(this.tileManagers[P.source].used=!0)}for(let w in y){let P=this.tileManagers[w];!!y[w]!=!!P.used&&P.fire(new o.l(\"data\",{sourceDataType:\"visibility\",dataType:\"source\",sourceId:w}))}this.light.recalculate(l),this.sky.recalculate(l),this.projection.recalculate(l),this.z=l.zoom,f&&this.fire(new o.l(\"data\",{dataType:\"style\"}))}_updateTilesForChangedImages(){let l=Object.keys(this._changedImages);if(l.length){for(let f in this.tileManagers)this.tileManagers[f].reloadTilesForDependencies([\"icons\",\"patterns\"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let l in this.tileManagers)this.tileManagers[l].reloadTilesForDependencies([\"glyphs\"],[\"\"]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,f){this.dispatcher.broadcast(\"UL\",{layers:this._serializeByIds(l,!1),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l,f={}){var y;this._checkLoaded();let w=this.serialize();if(l=f.transformStyle?f.transformStyle(w,l):l,((y=f.validate)===null||y===void 0||y)&&Er(this,o.C(l)))return!1;(l=o.bV(l)).layers=o.bS(l.layers);let P=o.bW(w,l),L=this._getOperationsToPerform(P);if(L.unimplemented.length>0)throw new Error(`Unimplemented: ${L.unimplemented.join(\", \")}.`);if(L.operations.length===0)return!1;for(let z of L.operations)z();return this.stylesheet=l,this._serializedLayers=null,this.fire(new o.l(\"style.load\",{style:this})),!0}_getOperationsToPerform(l){let f=[],y=[];for(let w of l)switch(w.command){case\"setCenter\":case\"setZoom\":case\"setBearing\":case\"setPitch\":case\"setRoll\":continue;case\"addLayer\":f.push((()=>this.addLayer.apply(this,w.args)));break;case\"removeLayer\":f.push((()=>this.removeLayer.apply(this,w.args)));break;case\"setPaintProperty\":f.push((()=>this.setPaintProperty.apply(this,w.args)));break;case\"setLayoutProperty\":f.push((()=>this.setLayoutProperty.apply(this,w.args)));break;case\"setFilter\":f.push((()=>this.setFilter.apply(this,w.args)));break;case\"addSource\":f.push((()=>this.addSource.apply(this,w.args)));break;case\"removeSource\":f.push((()=>this.removeSource.apply(this,w.args)));break;case\"setLayerZoomRange\":f.push((()=>this.setLayerZoomRange.apply(this,w.args)));break;case\"setLight\":f.push((()=>this.setLight.apply(this,w.args)));break;case\"setGeoJSONSourceData\":f.push((()=>this.setGeoJSONSourceData.apply(this,w.args)));break;case\"setGlyphs\":f.push((()=>this.setGlyphs.apply(this,w.args)));break;case\"setSprite\":f.push((()=>this.setSprite.apply(this,w.args)));break;case\"setTerrain\":f.push((()=>this.map.setTerrain.apply(this,w.args)));break;case\"setSky\":f.push((()=>this.setSky.apply(this,w.args)));break;case\"setProjection\":this.setProjection.apply(this,w.args);break;case\"setGlobalState\":f.push((()=>this.setGlobalState.apply(this,w.args)));break;case\"setTransition\":f.push((()=>{}));break;default:y.push(w.command)}return{operations:f,unimplemented:y}}addImage(l,f){if(this.getImage(l))return this.fire(new o.k(new Error(`An image named \"${l}\" already exists.`)));this.imageManager.addImage(l,f),this._afterImageUpdated(l)}updateImage(l,f){this.imageManager.updateImage(l,f)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new o.k(new Error(`An image named \"${l}\" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast(\"SI\",this._availableImages),this.fire(new o.l(\"data\",{dataType:\"style\"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,f,y={}){if(this._checkLoaded(),this.tileManagers[l]!==void 0)throw new Error(`Source \"${l}\" already exists.`);if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(\", \")}.`);if([\"vector\",\"raster\",\"geojson\",\"video\",\"image\"].indexOf(f.type)>=0&&this._validate(o.C.source,`sources.${l}`,f,null,y))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);let w=this.tileManagers[l]=new qr(l,f,this.dispatcher);w.style=this,w.setEventedParent(this,(()=>({isSourceLoaded:w.loaded(),source:w.serialize(),sourceId:l}))),w.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.tileManagers[l]===void 0)throw new Error(\"There is no source with this ID\");for(let y in this._layers)if(this._layers[y].source===l)return this.fire(new o.k(new Error(`Source \"${l}\" cannot be removed while layer \"${y}\" is using it.`)));let f=this.tileManagers[l];delete this.tileManagers[l],delete this._updatedSources[l],f.fire(new o.l(\"data\",{sourceDataType:\"metadata\",dataType:\"source\",sourceId:l})),f.setEventedParent(null),f.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,f){if(this._checkLoaded(),this.tileManagers[l]===void 0)throw new Error(`There is no source with this ID=${l}`);let y=this.tileManagers[l].getSource();if(y.type!==\"geojson\")throw new Error(`geojsonSource.type is ${y.type}, which is !== 'geojson`);y.setData(f),this._changed=!0}getSource(l){return this.tileManagers[l]&&this.tileManagers[l].getSource()}addLayer(l,f,y={}){this._checkLoaded();let w=l.id;if(this.getLayer(w))return void this.fire(new o.k(new Error(`Layer \"${w}\" already exists on this map.`)));let P;if(l.type===\"custom\"){if(Er(this,o.bX(l)))return;P=o.bT(l,this._globalState)}else{if(\"source\"in l&&typeof l.source==\"object\"&&(this.addSource(w,l.source),l=o.bV(l),l=o.e(l,{source:w})),this._validate(o.C.layer,`layers.${w}`,l,{arrayIndex:-1},y))return;P=o.bT(l,this._globalState),this._validateLayer(P),P.setEventedParent(this,{layer:{id:w}})}let L=f?this._order.indexOf(f):this._order.length;if(f&&L===-1)this.fire(new o.k(new Error(`Cannot add layer \"${w}\" before non-existing layer \"${f}\".`)));else{if(this._order.splice(L,0,w),this._layerOrderChanged=!0,this._layers[w]=P,this._removedLayers[w]&&P.source&&P.type!==\"custom\"){let z=this._removedLayers[w];delete this._removedLayers[w],z.type!==P.type?this._updatedSources[P.source]=\"clear\":(this._updatedSources[P.source]=\"reload\",this.tileManagers[P.source].pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map)}}moveLayer(l,f){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.k(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===f)return;let y=this._order.indexOf(l);this._order.splice(y,1);let w=f?this._order.indexOf(f):this._order.length;f&&w===-1?this.fire(new o.k(new Error(`Cannot move layer \"${l}\" before non-existing layer \"${f}\".`))):(this._order.splice(w,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();let f=this._layers[l];if(!f)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer \"${l}\".`)));f.setEventedParent(null);let y=this._order.indexOf(l);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=f,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],f.onRemove&&f.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,f,y){this._checkLoaded();let w=this.getLayer(l);w?w.minzoom===f&&w.maxzoom===y||(f!=null&&(w.minzoom=f),y!=null&&(w.maxzoom=y),this._updateLayer(w)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer \"${l}\".`)))}setFilter(l,f,y={}){this._checkLoaded();let w=this.getLayer(l);if(w){if(!o.bR(w.filter,f))return f==null?(w.setFilter(void 0),void this._updateLayer(w)):void(this._validate(o.C.filter,`layers.${w.id}.filter`,f,null,y)||(w.setFilter(o.bV(f)),this._updateLayer(w)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer \"${l}\".`)))}getFilter(l){return o.bV(this.getLayer(l).filter)}setLayoutProperty(l,f,y,w={}){this._checkLoaded();let P=this.getLayer(l);P?o.bR(P.getLayoutProperty(f),y)||(P.setLayoutProperty(f,y,w),this._updateLayer(P)):this.fire(new o.k(new Error(`Cannot style non-existing layer \"${l}\".`)))}getLayoutProperty(l,f){let y=this.getLayer(l);if(y)return y.getLayoutProperty(f);this.fire(new o.k(new Error(`Cannot get style of non-existing layer \"${l}\".`)))}setPaintProperty(l,f,y,w={}){this._checkLoaded();let P=this.getLayer(l);P?o.bR(P.getPaintProperty(f),y)||this._updatePaintProperty(P,f,y,w):this.fire(new o.k(new Error(`Cannot style non-existing layer \"${l}\".`)))}_updatePaintProperty(l,f,y,w={}){l.setPaintProperty(f,y,w)&&this._updateLayer(l),o.bU(l)&&f===\"raster-fade-duration\"&&this.tileManagers[l.source].setRasterFadeDuration(y),this._changed=!0,this._updatedPaintProps[l.id]=!0,this._serializedLayers=null}getPaintProperty(l,f){return this.getLayer(l).getPaintProperty(f)}setFeatureState(l,f){this._checkLoaded();let y=l.source,w=l.sourceLayer,P=this.tileManagers[y];if(P===void 0)return void this.fire(new o.k(new Error(`The source '${y}' does not exist in the map's style.`)));let L=P.getSource().type;L===\"geojson\"&&w?this.fire(new o.k(new Error(\"GeoJSON sources cannot have a sourceLayer parameter.\"))):L!==\"vector\"||w?(l.id===void 0&&this.fire(new o.k(new Error(\"The feature id parameter must be provided.\"))),P.setFeatureState(w,l.id,f)):this.fire(new o.k(new Error(\"The sourceLayer parameter must be provided for vector source types.\")))}removeFeatureState(l,f){this._checkLoaded();let y=l.source,w=this.tileManagers[y];if(w===void 0)return void this.fire(new o.k(new Error(`The source '${y}' does not exist in the map's style.`)));let P=w.getSource().type,L=P===\"vector\"?l.sourceLayer:void 0;P!==\"vector\"||L?f&&typeof l.id!=\"string\"&&typeof l.id!=\"number\"?this.fire(new o.k(new Error(\"A feature id is required to remove its specific state property.\"))):w.removeFeatureState(L,l.id,f):this.fire(new o.k(new Error(\"The sourceLayer parameter must be provided for vector source types.\")))}getFeatureState(l){this._checkLoaded();let f=l.source,y=l.sourceLayer,w=this.tileManagers[f];if(w!==void 0)return w.getSource().type!==\"vector\"||y?(l.id===void 0&&this.fire(new o.k(new Error(\"The feature id parameter must be provided.\"))),w.getFeatureState(y,l.id)):void this.fire(new o.k(new Error(\"The sourceLayer parameter must be provided for vector source types.\")));this.fire(new o.k(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let l=o.bY(this.tileManagers,(P=>P.serialize())),f=this._serializeByIds(this._order,!0),y=this.map.getTerrain()||void 0,w=this.stylesheet;return o.bZ({version:w.version,name:w.name,metadata:w.metadata,light:w.light,sky:w.sky,center:w.center,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch,sprite:w.sprite,glyphs:w.glyphs,transition:w.transition,projection:w.projection,sources:l,layers:f,terrain:y},(P=>P!==void 0))}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.tileManagers[l.source].getSource().type!==\"raster\"&&(this._updatedSources[l.source]=\"reload\",this.tileManagers[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){let f=L=>this._layers[L].type===\"fill-extrusion\",y={},w=[];for(let L=this._order.length-1;L>=0;L--){let z=this._order[L];if(f(z)){y[z]=L;for(let G of l){let j=G[z];if(j)for(let Q of j)w.push(Q)}}}w.sort(((L,z)=>z.intersectionZ-L.intersectionZ));let P=[];for(let L=this._order.length-1;L>=0;L--){let z=this._order[L];if(f(z))for(let G=w.length-1;G>=0;G--){let j=w[G].feature;if(y[j.layer.id]<L)break;P.push(j),w.pop()}else for(let G of l){let j=G[z];if(j)for(let Q of j)P.push(Q.feature)}}return P}queryRenderedFeatures(l,f,y){f&&f.filter&&this._validate(o.C.filter,\"queryRenderedFeatures.filter\",f.filter,null,f);let w={};if(f&&f.layers){if(!(Array.isArray(f.layers)||f.layers instanceof Set))return this.fire(new o.k(new Error(\"parameters.layers must be an Array or a Set of strings\"))),[];for(let j of f.layers){let Q=this._layers[j];if(!Q)return this.fire(new o.k(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];w[Q.source]=!0}}let P=[];f.availableImages=this._availableImages;let L=this._serializedAllLayers(),z=f.layers instanceof Set?f.layers:Array.isArray(f.layers)?new Set(f.layers):null,G=Object.assign(Object.assign({},f),{layers:z,globalState:this._globalState});for(let j in this.tileManagers)f.layers&&!w[j]||P.push(cs(this.tileManagers[j],this._layers,L,l,G,y,this.map.terrain?(Q,ie,re)=>this.map.terrain.getElevation(Q,ie,re):void 0));return this.placement&&P.push((function(j,Q,ie,re,ce,de,Te){let Ie={},Me=de.queryRenderedSymbols(re),Oe=[];for(let We of Object.keys(Me).map(Number))Oe.push(Te[We]);Oe.sort(yi);for(let We of Oe){let De=We.featureIndex.lookupSymbolFeatures(Me[We.bucketInstanceId],Q,We.bucketIndex,We.sourceLayerIndex,{filterSpec:ce.filter,globalState:ce.globalState},ce.layers,ce.availableImages,j);for(let Ge in De){let Be=Ie[Ge]=Ie[Ge]||[],Fe=De[Ge];Fe.sort(((Ve,ct)=>{let dt=We.featureSortOrder;if(dt){let pt=dt.indexOf(Ve.featureIndex);return dt.indexOf(ct.featureIndex)-pt}return ct.featureIndex-Ve.featureIndex}));for(let Ve of Fe)Be.push(Ve)}}return(function(We,De,Ge){for(let Be in We)for(let Fe of We[Be])Ro(Fe,Ge[De[Be].source]);return We})(Ie,j,ie)})(this._layers,L,this.tileManagers,l,G,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(l,f){f?.filter&&this._validate(o.C.filter,\"querySourceFeatures.filter\",f.filter,null,f);let y=this.tileManagers[l];return y?(function(w,P){let L=w.getRenderableIds().map((j=>w.getTileByID(j))),z=[],G={};for(let j=0;j<L.length;j++){let Q=L[j],ie=Q.tileID.canonical.key;G[ie]||(G[ie]=!0,Q.querySourceFeatures(z,P))}return z})(y,f?Object.assign(Object.assign({},f),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(l,f={}){this._checkLoaded();let y=this.light.getLight(),w=!1;for(let L in l)if(!o.bR(l[L],y[L])){w=!0;break}if(!w)return;let P={now:k(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,f),this.light.updateTransitions(P)}getProjection(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.projection}setProjection(l){if(this._checkLoaded(),this.projection){if(this.projection.name===l.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=l,this._setProjectionInternal(l.type)}getSky(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.sky}setSky(l,f={}){this._checkLoaded();let y=this.getSky(),w=!1;if(!l&&!y)return;if(l&&!y)w=!0;else if(!l&&y)w=!0;else for(let L in l)if(!o.bR(l[L],y[L])){w=!0;break}if(!w)return;let P={now:k(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=l,this.sky.setSky(l,f),this.sky.updateTransitions(P)}_setProjectionInternal(l){let f=(function(y,w){let P={constrainOverride:w};if(Array.isArray(y)){let L=new xx({type:y});return{projection:L,transform:new zt(P),cameraHelper:new ai(L)}}switch(y){case\"mercator\":return{projection:new oa,transform:new Af(P),cameraHelper:new gf};case\"globe\":{let L=new xx({type:[\"interpolate\",[\"linear\"],[\"zoom\"],11,\"vertical-perspective\",12,\"mercator\"]});return{projection:L,transform:new zt(P),cameraHelper:new ai(L)}}case\"vertical-perspective\":return{projection:new R_,transform:new sn(P),cameraHelper:new _};default:return o.w(`Unknown projection name: ${y}. Falling back to mercator projection.`),{projection:new oa,transform:new Af(P),cameraHelper:new gf}}})(l,this.map.transformConstrain);this.projection=f.projection,this.map.migrateProjection(f.transform,f.cameraHelper);for(let y in this.tileManagers)this.tileManagers[y].reload()}_validate(l,f,y,w,P={}){return(!P||P.validate!==!1)&&Er(this,l.call(o.C,o.e({key:f,style:this.serialize(),value:y,styleSpec:o.u},w)))}_remove(l=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),pe().off(Ze,this._rtlPluginLoaded);for(let f in this._layers)this._layers[f].setEventedParent(null);for(let f in this.tileManagers){let y=this.tileManagers[f];y.setEventedParent(null),y.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast(\"RM\",void 0),this.dispatcher.remove(l)}_clearSource(l){this.tileManagers[l].clearTiles()}_reloadSource(l){this.tileManagers[l].resume(),this.tileManagers[l].reload()}_updateSources(l){for(let f in this.tileManagers)this.tileManagers[f].update(l,this.map.terrain)}_generateCollisionBoxes(){for(let l in this.tileManagers)this._reloadSource(l)}_updatePlacement(l,f,y,w,P=!1){let L=!1,z=!1,G={};for(let j of this._order){let Q=this._layers[j];if(Q.type!==\"symbol\")continue;if(!G[Q.source]){let re=this.tileManagers[Q.source];G[Q.source]=re.getRenderableIds(!0).map((ce=>re.getTileByID(ce))).sort(((ce,de)=>de.tileID.overscaledZ-ce.tileID.overscaledZ||(ce.tileID.isLessThan(de.tileID)?-1:1)))}let ie=this.crossTileSymbolIndex.addLayer(Q,G[Q.source],l.center.lng);L=L||ie}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((P=P||this._layerOrderChanged||y===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(k(),l.zoom))&&(this.pauseablePlacement=new Ba(l,this.map.terrain,this._order,P,f,y,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,G),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(k()),z=!0),L&&this.pauseablePlacement.placement.setStale()),z||L)for(let j of this._order){let Q=this._layers[j];Q.type===\"symbol\"&&this.placement.updateLayerOpacities(Q,G[Q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(k())}_releaseSymbolFadeTiles(){for(let l in this.tileManagers)this.tileManagers[l].releaseSymbolFadeTiles()}getImages(l,f){return o._(this,void 0,void 0,(function*(){let y=yield this.imageManager.getImages(f.icons);this._updateTilesForChangedImages();let w=this.tileManagers[f.source];return w&&w.setDependencies(f.tileID.key,f.type,f.icons),y}))}getGlyphs(l,f){return o._(this,void 0,void 0,(function*(){let y=yield this.glyphManager.getGlyphs(f.stacks),w=this.tileManagers[f.source];return w&&w.setDependencies(f.tileID.key,f.type,[\"\"]),y}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l,f={}){this._checkLoaded(),l&&this._validate(o.C.glyphs,\"glyphs\",l,null,f)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}getDashes(l,f){return o._(this,void 0,void 0,(function*(){let y={};for(let[w,P]of Object.entries(f.dashes))y[w]=this.lineAtlas.getDash(P.dasharray,P.round);return y}))}addSprite(l,f,y={},w){this._checkLoaded();let P=[{id:l,url:f}],L=[...Xe(this.stylesheet.sprite),...P];this._validate(o.C.sprite,\"sprite\",L,null,y)||(this.stylesheet.sprite=L,this._loadSprite(P,!0,w))}removeSprite(l){this._checkLoaded();let f=Xe(this.stylesheet.sprite);if(f.find((y=>y.id===l))){if(this._spritesImagesIds[l])for(let y of this._spritesImagesIds[l])this.imageManager.removeImage(y),this._changedImages[y]=!0;f.splice(f.findIndex((y=>y.id===l)),1),this.stylesheet.sprite=f.length>0?f:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast(\"SI\",this._availableImages),this.fire(new o.l(\"data\",{dataType:\"style\"}))}else this.fire(new o.k(new Error(`Sprite \"${l}\" doesn't exists on this map.`)))}getSprite(){return Xe(this.stylesheet.sprite)}setSprite(l,f={},y){this._checkLoaded(),l&&this._validate(o.C.sprite,\"sprite\",l,null,f)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,y):(this._unloadSprite(),y&&y(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(let l in this.tileManagers){let f=this.tileManagers[l];f.setEventedParent(null),f.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(let l in this._layers){let f=this._layers[l];f.setEventedParent(null),f.onRemove&&f.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler(\"GG\"),this.dispatcher.unregisterMessageHandler(\"GI\"),this.dispatcher.unregisterMessageHandler(\"GDA\"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var aa=o.aU([{name:\"a_pos\",type:\"Int16\",components:2},{name:\"a_texture_pos\",type:\"Int16\",components:2}]);class bo{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,f,y,w,P,L,z,G,j){this.context=l;let Q=this.boundPaintVertexBuffers.length!==w.length;for(let ie=0;!Q&&ie<w.length;ie++)this.boundPaintVertexBuffers[ie]!==w[ie]&&(Q=!0);!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==y||Q||this.boundIndexBuffer!==P||this.boundVertexOffset!==L||this.boundDynamicVertexBuffer!==z||this.boundDynamicVertexBuffer2!==G||this.boundDynamicVertexBuffer3!==j?this.freshBind(f,y,w,P,L,z,G,j):(l.bindVertexArray.set(this.vao),z&&z.bind(),P&&P.dynamicDraw&&P.bind(),G&&G.bind(),j&&j.bind())}freshBind(l,f,y,w,P,L,z,G){let j=l.numAttributes,Q=this.context,ie=Q.gl;this.vao&&this.destroy(),this.vao=Q.createVertexArray(),Q.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=w,this.boundVertexOffset=P,this.boundDynamicVertexBuffer=L,this.boundDynamicVertexBuffer2=z,this.boundDynamicVertexBuffer3=G,f.enableAttributes(ie,l);for(let re of y)re.enableAttributes(ie,l);L&&L.enableAttributes(ie,l),z&&z.enableAttributes(ie,l),G&&G.enableAttributes(ie,l),f.bind(),f.setVertexAttribPointers(ie,l,P);for(let re of y)re.bind(),re.setVertexAttribPointers(ie,l,P);L&&(L.bind(),L.setVertexAttribPointers(ie,l,P)),w&&w.bind(),z&&(z.bind(),z.setVertexAttribPointers(ie,l,P)),G&&(G.bind(),G.setVertexAttribPointers(ie,l,P)),Q.currentNumAttributes=j}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}let kr=(I,l,f,y,w)=>({u_texture:0,u_ele_delta:I,u_fog_matrix:l,u_fog_color:f?f.properties.get(\"fog-color\"):o.bp.white,u_fog_ground_blend:f?f.properties.get(\"fog-ground-blend\"):1,u_fog_ground_blend_opacity:w?0:f?f.calculateFogBlendOpacity(y):0,u_horizon_color:f?f.properties.get(\"horizon-color\"):o.bp.white,u_horizon_fog_blend:f?f.properties.get(\"horizon-fog-blend\"):1,u_is_globe_mode:w?1:0}),li={mainMatrix:\"u_projection_matrix\",tileMercatorCoords:\"u_projection_tile_mercator_coords\",clippingPlane:\"u_projection_clipping_plane\",projectionTransition:\"u_projection_transition\",fallbackMatrix:\"u_projection_fallback_matrix\"};function wo(I){let l=[];for(let f=0;f<I.length;f++){if(I[f]===null)continue;let y=I[f].split(\" \");l.push(y.pop())}return l}class Sr{constructor(l,f,y,w,P,L,z,G,j=[]){let Q=l.gl;this.program=Q.createProgram();let ie=wo(f.staticAttributes),re=y?y.getBinderAttributes():[],ce=ie.concat(re),de=Kn.prelude.staticUniforms?wo(Kn.prelude.staticUniforms):[],Te=z.staticUniforms?wo(z.staticUniforms):[],Ie=f.staticUniforms?wo(f.staticUniforms):[],Me=y?y.getBinderUniforms():[],Oe=de.concat(Te).concat(Ie).concat(Me),We=[];for(let dt of Oe)We.indexOf(dt)<0&&We.push(dt);let De=y?y.defines():[];Bl(Q)&&De.unshift(\"#version 300 es\"),P&&De.push(\"#define OVERDRAW_INSPECTOR;\"),L&&De.push(\"#define TERRAIN3D;\"),G&&De.push(G),j&&De.push(...j);let Ge=De.concat(Kn.prelude.fragmentSource,z.fragmentSource,f.fragmentSource).join(`\n`),Be=De.concat(Kn.prelude.vertexSource,z.vertexSource,f.vertexSource).join(`\n`);Bl(Q)||(Ge=(function(dt){return dt.replace(/\\bin\\s/g,\"varying \").replace(\"out highp vec4 fragColor;\",\"\").replace(/fragColor/g,\"gl_FragColor\").replace(/texture\\(/g,\"texture2D(\")})(Ge),Be=(function(dt){return dt.replace(/\\bin\\s/g,\"attribute \").replace(/\\bout\\s/g,\"varying \").replace(/texture\\(/g,\"texture2D(\")})(Be));let Fe=Q.createShader(Q.FRAGMENT_SHADER);if(Q.isContextLost())return void(this.failedToCreate=!0);if(Q.shaderSource(Fe,Ge),Q.compileShader(Fe),!Q.getShaderParameter(Fe,Q.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${Q.getShaderInfoLog(Fe)}`);Q.attachShader(this.program,Fe);let Ve=Q.createShader(Q.VERTEX_SHADER);if(Q.isContextLost())return void(this.failedToCreate=!0);if(Q.shaderSource(Ve,Be),Q.compileShader(Ve),!Q.getShaderParameter(Ve,Q.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${Q.getShaderInfoLog(Ve)}`);Q.attachShader(this.program,Ve),this.attributes={};let ct={};this.numAttributes=ce.length;for(let dt=0;dt<this.numAttributes;dt++)ce[dt]&&(Q.bindAttribLocation(this.program,dt,ce[dt]),this.attributes[ce[dt]]=dt);if(Q.linkProgram(this.program),!Q.getProgramParameter(this.program,Q.LINK_STATUS))throw new Error(`Program failed to link: ${Q.getProgramInfoLog(this.program)}`);Q.deleteShader(Ve),Q.deleteShader(Fe);for(let dt=0;dt<We.length;dt++){let pt=We[dt];if(pt&&!ct[pt]){let ft=Q.getUniformLocation(this.program,pt);ft&&(ct[pt]=ft)}}this.fixedUniforms=w(l,ct),this.terrainUniforms=((dt,pt)=>({u_depth:new o.b_(dt,pt.u_depth),u_terrain:new o.b_(dt,pt.u_terrain),u_terrain_dim:new o.bq(dt,pt.u_terrain_dim),u_terrain_matrix:new o.c0(dt,pt.u_terrain_matrix),u_terrain_unpack:new o.c1(dt,pt.u_terrain_unpack),u_terrain_exaggeration:new o.bq(dt,pt.u_terrain_exaggeration)}))(l,ct),this.projectionUniforms=((dt,pt)=>({u_projection_matrix:new o.c0(dt,pt.u_projection_matrix),u_projection_tile_mercator_coords:new o.c1(dt,pt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.c1(dt,pt.u_projection_clipping_plane),u_projection_transition:new o.bq(dt,pt.u_projection_transition),u_projection_fallback_matrix:new o.c0(dt,pt.u_projection_fallback_matrix)}))(l,ct),this.binderUniforms=y?y.getUniforms(l,ct):[]}draw(l,f,y,w,P,L,z,G,j,Q,ie,re,ce,de,Te,Ie,Me,Oe,We){let De=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(y),l.setStencilMode(w),l.setColorMode(P),l.setCullFace(L),G){l.activeTexture.set(De.TEXTURE2),De.bindTexture(De.TEXTURE_2D,G.depthTexture),l.activeTexture.set(De.TEXTURE3),De.bindTexture(De.TEXTURE_2D,G.texture);for(let Be in this.terrainUniforms)this.terrainUniforms[Be].set(G[Be])}if(j)for(let Be in j)this.projectionUniforms[li[Be]].set(j[Be]);if(z)for(let Be in this.fixedUniforms)this.fixedUniforms[Be].set(z[Be]);Ie&&Ie.setUniforms(l,this.binderUniforms,de,{zoom:Te});let Ge=0;switch(f){case De.LINES:Ge=2;break;case De.TRIANGLES:Ge=3;break;case De.LINE_STRIP:Ge=1}for(let Be of ce.get()){let Fe=Be.vaos||(Be.vaos={});(Fe[Q]||(Fe[Q]=new bo)).bind(l,this,ie,Ie?Ie.getPaintVertexBuffers():[],re,Be.vertexOffset,Me,Oe,We),De.drawElements(f,Be.primitiveLength*Ge,De.UNSIGNED_SHORT,Be.primitiveOffset*Ge*2)}}}function Nr(I,l,f){let y=1/o.aN(f,1,l.transform.tileZoom),w=Math.pow(2,f.tileID.overscaledZ),P=f.tileSize*Math.pow(2,l.transform.tileZoom)/w,L=P*(f.tileID.canonical.x+f.tileID.wrap*w),z=P*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[y,I.fromScale,I.toScale],u_fade:I.t,u_pixel_coord_upper:[L>>16,z>>16],u_pixel_coord_lower:[65535&L,65535&z]}}let vh=(I,l,f,y)=>{let w=I.style.light,P=w.properties.get(\"position\"),L=[P.x,P.y,P.z],z=o.c4();w.properties.get(\"anchor\")===\"viewport\"&&o.c5(z,I.transform.bearingInRadians),o.c6(L,L,z);let G=I.transform.transformLightDirection(L),j=w.properties.get(\"color\");return{u_lightpos:L,u_lightpos_globe:G,u_lightintensity:w.properties.get(\"intensity\"),u_lightcolor:[j.r,j.g,j.b],u_vertical_gradient:+l,u_opacity:f,u_fill_translate:y}},mg=(I,l,f,y,w,P,L)=>o.e(vh(I,l,f,y),Nr(P,I,L),{u_height_factor:-Math.pow(2,w.overscaledZ)/L.tileSize/8}),_g=(I,l,f,y)=>o.e(Nr(l,I,f),{u_fill_translate:y}),c0=(I,l)=>({u_world:I,u_fill_translate:l}),La=(I,l,f,y,w)=>o.e(_g(I,l,f,w),{u_world:y}),bh=(I,l,f,y,w)=>{let P=I.transform,L,z,G=0;if(f.paint.get(\"circle-pitch-alignment\")===\"map\"){let j=o.aN(l,1,P.zoom);L=!0,z=[j,j],G=j/(o.a5*Math.pow(2,l.tileID.overscaledZ))*2*Math.PI*w}else L=!1,z=P.pixelsToGLUnits;return{u_camera_to_center_distance:P.cameraToCenterDistance,u_scale_with_map:+(f.paint.get(\"circle-pitch-scale\")===\"map\"),u_pitch_with_map:+L,u_device_pixel_ratio:I.pixelRatio,u_extrude_scale:z,u_globe_extrude_scale:G,u_translate:y}},Ps=I=>({u_pixel_extrude_scale:[1/I.width,1/I.height]}),u0=I=>({u_viewport_size:[I.width,I.height]}),yg=(I,l=1)=>({u_color:I,u_overlay:0,u_overlay_scale:l}),la=(I,l,f,y)=>{let w=o.aN(I,1,l)/(o.a5*Math.pow(2,I.tileID.overscaledZ))*2*Math.PI*y;return{u_extrude_scale:o.aN(I,1,l),u_intensity:f,u_globe_extrude_scale:w}},Jn=(I,l,f,y)=>{let w=o.N();o.c7(w,0,I.width,I.height,0,0,1);let P=I.context.gl;return{u_matrix:w,u_world:[P.drawingBufferWidth,P.drawingBufferHeight],u_image:f,u_color_ramp:y,u_opacity:l.paint.get(\"heatmap-opacity\")}},ve=(I,l,f)=>{let y=f.paint.get(\"hillshade-accent-color\"),w;switch(f.paint.get(\"hillshade-method\")){case\"basic\":w=4;break;case\"combined\":w=1;break;case\"igor\":w=2;break;case\"multidirectional\":w=3;break;default:w=0}let P=f.getIlluminationProperties();for(let L=0;L<P.directionRadians.length;L++)f.paint.get(\"hillshade-illumination-anchor\")===\"viewport\"&&(P.directionRadians[L]+=I.transform.bearingInRadians);return{u_image:0,u_latrange:D_(0,l.tileID),u_exaggeration:f.paint.get(\"hillshade-exaggeration\"),u_altitudes:P.altitudeRadians,u_azimuths:P.directionRadians,u_accent:y,u_method:w,u_highlights:P.highlightColor,u_shadows:P.shadowColor}},Wn=(I,l)=>{let f=l.stride,y=o.N();return o.c7(y,0,o.a5,-o.a5,0,0,1),o.O(y,y,[0,-o.a5,0]),{u_matrix:y,u_image:1,u_dimension:[f,f],u_zoom:I.overscaledZ,u_unpack:l.getUnpackVector()}};function D_(I,l){let f=Math.pow(2,l.canonical.z),y=l.canonical.y;return[new o.a9(0,y/f).toLngLat().lat,new o.a9(0,(y+1)/f).toLngLat().lat]}let L_=(I,l,f=0)=>({u_image:0,u_unpack:l.getUnpackVector(),u_dimension:[l.stride,l.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:f,u_opacity:I.paint.get(\"color-relief-opacity\")}),vd=(I,l,f,y)=>{let w=I.transform;return{u_translation:f0(I,l,f),u_ratio:y/o.aN(l,1,w.zoom),u_device_pixel_ratio:I.pixelRatio,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},O_=(I,l,f,y,w)=>o.e(vd(I,l,f,y),{u_image:0,u_image_height:w}),xg=(I,l,f,y,w)=>{let P=I.transform,L=Dl(l,P);return{u_translation:f0(I,l,f),u_texsize:l.imageAtlasTexture.size,u_ratio:y/o.aN(l,1,P.zoom),u_device_pixel_ratio:I.pixelRatio,u_image:0,u_scale:[L,w.fromScale,w.toScale],u_fade:w.t,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},Ae=(I,l,f,y,w)=>{let P=Dl(l,I.transform);return o.e(vd(I,l,f,y),{u_tileratio:P,u_crossfade_from:w.fromScale,u_crossfade_to:w.toScale,u_image:0,u_mix:w.t,u_lineatlas_width:I.lineAtlas.width,u_lineatlas_height:I.lineAtlas.height})},h0=(I,l,f,y,w,P)=>{let L=Dl(l,I.transform);return o.e(vd(I,l,f,y),{u_image:0,u_image_height:P,u_tileratio:L,u_crossfade_from:w.fromScale,u_crossfade_to:w.toScale,u_image_dash:1,u_mix:w.t,u_lineatlas_width:I.lineAtlas.width,u_lineatlas_height:I.lineAtlas.height})};function Dl(I,l){return 1/o.aN(I,1,l.tileZoom)}function f0(I,l,f){return o.aO(I.transform,l,f.paint.get(\"line-translate\"),f.paint.get(\"line-translate-anchor\"))}let vg=(I,l,f,y,w)=>{return{u_tl_parent:I,u_scale_parent:l,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*y.paint.get(\"raster-opacity\"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get(\"raster-brightness-min\"),u_brightness_high:y.paint.get(\"raster-brightness-max\"),u_saturation_factor:(L=y.paint.get(\"raster-saturation\"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(P=y.paint.get(\"raster-contrast\"),P>0?1/(1-P):1+P),u_spin_weights:bg(y.paint.get(\"raster-hue-rotate\")),u_coords_top:[w[0].x,w[0].y,w[1].x,w[1].y],u_coords_bottom:[w[3].x,w[3].y,w[2].x,w[2].y]};var P,L};function bg(I){I*=Math.PI/180;let l=Math.sin(I),f=Math.cos(I);return[(2*f+1)/3,(-Math.sqrt(3)*l-f+1)/3,(Math.sqrt(3)*l-f+1)/3]}let wg=(I,l,f,y,w,P,L,z,G,j,Q,ie,re)=>{let ce=L.transform;return{u_is_size_zoom_constant:+(I===\"constant\"||I===\"source\"),u_is_size_feature_constant:+(I===\"constant\"||I===\"camera\"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:ce.cameraToCenterDistance,u_pitch:ce.pitch/360*2*Math.PI,u_rotate_symbol:+f,u_aspect_ratio:ce.width/ce.height,u_fade_change:L.options.fadeDuration?L.symbolFadeChange:1,u_label_plane_matrix:z,u_coord_matrix:G,u_is_text:+Q,u_pitch_with_map:+y,u_is_along_line:w,u_is_variable_anchor:P,u_texsize:ie,u_texture:0,u_translation:j,u_pitched_scale:re}},bd=(I,l,f,y,w,P,L,z,G,j,Q,ie,re,ce)=>{let de=L.transform;return o.e(wg(I,l,f,y,w,P,L,z,G,j,Q,ie,ce),{u_gamma_scale:y?Math.cos(de.pitch*Math.PI/180)*de.cameraToCenterDistance:1,u_device_pixel_ratio:L.pixelRatio,u_is_halo:1})},vu=(I,l,f,y,w,P,L,z,G,j,Q,ie,re)=>o.e(bd(I,l,f,y,w,P,L,z,G,j,!0,Q,0,re),{u_texsize_icon:ie,u_texture_icon:1}),d0=(I,l)=>({u_opacity:I,u_color:l}),lc=(I,l,f,y,w)=>o.e((function(P,L,z,G){let j=z.imageManager.getPattern(P.from.toString()),Q=z.imageManager.getPattern(P.to.toString()),{width:ie,height:re}=z.imageManager.getPixelSize(),ce=Math.pow(2,G.tileID.overscaledZ),de=G.tileSize*Math.pow(2,z.transform.tileZoom)/ce,Te=de*(G.tileID.canonical.x+G.tileID.wrap*ce),Ie=de*G.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:Q.tl,u_pattern_br_b:Q.br,u_texsize:[ie,re],u_mix:L.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:Q.displaySize,u_scale_a:L.fromScale,u_scale_b:L.toScale,u_tile_units_to_pixels:1/o.aN(G,1,z.transform.tileZoom),u_pixel_coord_upper:[Te>>16,Ie>>16],u_pixel_coord_lower:[65535&Te,65535&Ie]}})(f,w,l,y),{u_opacity:I}),Ho=(I,l)=>{},vx={fillExtrusion:(I,l)=>({u_lightpos:new o.c2(I,l.u_lightpos),u_lightpos_globe:new o.c2(I,l.u_lightpos_globe),u_lightintensity:new o.bq(I,l.u_lightintensity),u_lightcolor:new o.c2(I,l.u_lightcolor),u_vertical_gradient:new o.bq(I,l.u_vertical_gradient),u_opacity:new o.bq(I,l.u_opacity),u_fill_translate:new o.c3(I,l.u_fill_translate)}),fillExtrusionPattern:(I,l)=>({u_lightpos:new o.c2(I,l.u_lightpos),u_lightpos_globe:new o.c2(I,l.u_lightpos_globe),u_lightintensity:new o.bq(I,l.u_lightintensity),u_lightcolor:new o.c2(I,l.u_lightcolor),u_vertical_gradient:new o.bq(I,l.u_vertical_gradient),u_height_factor:new o.bq(I,l.u_height_factor),u_opacity:new o.bq(I,l.u_opacity),u_fill_translate:new o.c3(I,l.u_fill_translate),u_image:new o.b_(I,l.u_image),u_texsize:new o.c3(I,l.u_texsize),u_pixel_coord_upper:new o.c3(I,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(I,l.u_pixel_coord_lower),u_scale:new o.c2(I,l.u_scale),u_fade:new o.bq(I,l.u_fade)}),fill:(I,l)=>({u_fill_translate:new o.c3(I,l.u_fill_translate)}),fillPattern:(I,l)=>({u_image:new o.b_(I,l.u_image),u_texsize:new o.c3(I,l.u_texsize),u_pixel_coord_upper:new o.c3(I,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(I,l.u_pixel_coord_lower),u_scale:new o.c2(I,l.u_scale),u_fade:new o.bq(I,l.u_fade),u_fill_translate:new o.c3(I,l.u_fill_translate)}),fillOutline:(I,l)=>({u_world:new o.c3(I,l.u_world),u_fill_translate:new o.c3(I,l.u_fill_translate)}),fillOutlinePattern:(I,l)=>({u_world:new o.c3(I,l.u_world),u_image:new o.b_(I,l.u_image),u_texsize:new o.c3(I,l.u_texsize),u_pixel_coord_upper:new o.c3(I,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(I,l.u_pixel_coord_lower),u_scale:new o.c2(I,l.u_scale),u_fade:new o.bq(I,l.u_fade),u_fill_translate:new o.c3(I,l.u_fill_translate)}),circle:(I,l)=>({u_camera_to_center_distance:new o.bq(I,l.u_camera_to_center_distance),u_scale_with_map:new o.b_(I,l.u_scale_with_map),u_pitch_with_map:new o.b_(I,l.u_pitch_with_map),u_extrude_scale:new o.c3(I,l.u_extrude_scale),u_device_pixel_ratio:new o.bq(I,l.u_device_pixel_ratio),u_globe_extrude_scale:new o.bq(I,l.u_globe_extrude_scale),u_translate:new o.c3(I,l.u_translate)}),collisionBox:(I,l)=>({u_pixel_extrude_scale:new o.c3(I,l.u_pixel_extrude_scale)}),collisionCircle:(I,l)=>({u_viewport_size:new o.c3(I,l.u_viewport_size)}),debug:(I,l)=>({u_color:new o.b$(I,l.u_color),u_overlay:new o.b_(I,l.u_overlay),u_overlay_scale:new o.bq(I,l.u_overlay_scale)}),depth:Ho,clippingMask:Ho,heatmap:(I,l)=>({u_extrude_scale:new o.bq(I,l.u_extrude_scale),u_intensity:new o.bq(I,l.u_intensity),u_globe_extrude_scale:new o.bq(I,l.u_globe_extrude_scale)}),heatmapTexture:(I,l)=>({u_matrix:new o.c0(I,l.u_matrix),u_world:new o.c3(I,l.u_world),u_image:new o.b_(I,l.u_image),u_color_ramp:new o.b_(I,l.u_color_ramp),u_opacity:new o.bq(I,l.u_opacity)}),hillshade:(I,l)=>({u_image:new o.b_(I,l.u_image),u_latrange:new o.c3(I,l.u_latrange),u_exaggeration:new o.bq(I,l.u_exaggeration),u_altitudes:new o.c9(I,l.u_altitudes),u_azimuths:new o.c9(I,l.u_azimuths),u_accent:new o.b$(I,l.u_accent),u_method:new o.b_(I,l.u_method),u_shadows:new o.c8(I,l.u_shadows),u_highlights:new o.c8(I,l.u_highlights)}),hillshadePrepare:(I,l)=>({u_matrix:new o.c0(I,l.u_matrix),u_image:new o.b_(I,l.u_image),u_dimension:new o.c3(I,l.u_dimension),u_zoom:new o.bq(I,l.u_zoom),u_unpack:new o.c1(I,l.u_unpack)}),colorRelief:(I,l)=>({u_image:new o.b_(I,l.u_image),u_unpack:new o.c1(I,l.u_unpack),u_dimension:new o.c3(I,l.u_dimension),u_elevation_stops:new o.b_(I,l.u_elevation_stops),u_color_stops:new o.b_(I,l.u_color_stops),u_color_ramp_size:new o.b_(I,l.u_color_ramp_size),u_opacity:new o.bq(I,l.u_opacity)}),line:(I,l)=>({u_translation:new o.c3(I,l.u_translation),u_ratio:new o.bq(I,l.u_ratio),u_device_pixel_ratio:new o.bq(I,l.u_device_pixel_ratio),u_units_to_pixels:new o.c3(I,l.u_units_to_pixels)}),lineGradient:(I,l)=>({u_translation:new o.c3(I,l.u_translation),u_ratio:new o.bq(I,l.u_ratio),u_device_pixel_ratio:new o.bq(I,l.u_device_pixel_ratio),u_units_to_pixels:new o.c3(I,l.u_units_to_pixels),u_image:new o.b_(I,l.u_image),u_image_height:new o.bq(I,l.u_image_height)}),linePattern:(I,l)=>({u_translation:new o.c3(I,l.u_translation),u_texsize:new o.c3(I,l.u_texsize),u_ratio:new o.bq(I,l.u_ratio),u_device_pixel_ratio:new o.bq(I,l.u_device_pixel_ratio),u_image:new o.b_(I,l.u_image),u_units_to_pixels:new o.c3(I,l.u_units_to_pixels),u_scale:new o.c2(I,l.u_scale),u_fade:new o.bq(I,l.u_fade)}),lineSDF:(I,l)=>({u_translation:new o.c3(I,l.u_translation),u_ratio:new o.bq(I,l.u_ratio),u_device_pixel_ratio:new o.bq(I,l.u_device_pixel_ratio),u_units_to_pixels:new o.c3(I,l.u_units_to_pixels),u_image:new o.b_(I,l.u_image),u_mix:new o.bq(I,l.u_mix),u_tileratio:new o.bq(I,l.u_tileratio),u_crossfade_from:new o.bq(I,l.u_crossfade_from),u_crossfade_to:new o.bq(I,l.u_crossfade_to),u_lineatlas_width:new o.bq(I,l.u_lineatlas_width),u_lineatlas_height:new o.bq(I,l.u_lineatlas_height)}),lineGradientSDF:(I,l)=>({u_translation:new o.c3(I,l.u_translation),u_ratio:new o.bq(I,l.u_ratio),u_device_pixel_ratio:new o.bq(I,l.u_device_pixel_ratio),u_units_to_pixels:new o.c3(I,l.u_units_to_pixels),u_image:new o.b_(I,l.u_image),u_image_height:new o.bq(I,l.u_image_height),u_tileratio:new o.bq(I,l.u_tileratio),u_crossfade_from:new o.bq(I,l.u_crossfade_from),u_crossfade_to:new o.bq(I,l.u_crossfade_to),u_image_dash:new o.b_(I,l.u_image_dash),u_mix:new o.bq(I,l.u_mix),u_lineatlas_width:new o.bq(I,l.u_lineatlas_width),u_lineatlas_height:new o.bq(I,l.u_lineatlas_height)}),raster:(I,l)=>({u_tl_parent:new o.c3(I,l.u_tl_parent),u_scale_parent:new o.bq(I,l.u_scale_parent),u_buffer_scale:new o.bq(I,l.u_buffer_scale),u_fade_t:new o.bq(I,l.u_fade_t),u_opacity:new o.bq(I,l.u_opacity),u_image0:new o.b_(I,l.u_image0),u_image1:new o.b_(I,l.u_image1),u_brightness_low:new o.bq(I,l.u_brightness_low),u_brightness_high:new o.bq(I,l.u_brightness_high),u_saturation_factor:new o.bq(I,l.u_saturation_factor),u_contrast_factor:new o.bq(I,l.u_contrast_factor),u_spin_weights:new o.c2(I,l.u_spin_weights),u_coords_top:new o.c1(I,l.u_coords_top),u_coords_bottom:new o.c1(I,l.u_coords_bottom)}),symbolIcon:(I,l)=>({u_is_size_zoom_constant:new o.b_(I,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(I,l.u_is_size_feature_constant),u_size_t:new o.bq(I,l.u_size_t),u_size:new o.bq(I,l.u_size),u_camera_to_center_distance:new o.bq(I,l.u_camera_to_center_distance),u_pitch:new o.bq(I,l.u_pitch),u_rotate_symbol:new o.b_(I,l.u_rotate_symbol),u_aspect_ratio:new o.bq(I,l.u_aspect_ratio),u_fade_change:new o.bq(I,l.u_fade_change),u_label_plane_matrix:new o.c0(I,l.u_label_plane_matrix),u_coord_matrix:new o.c0(I,l.u_coord_matrix),u_is_text:new o.b_(I,l.u_is_text),u_pitch_with_map:new o.b_(I,l.u_pitch_with_map),u_is_along_line:new o.b_(I,l.u_is_along_line),u_is_variable_anchor:new o.b_(I,l.u_is_variable_anchor),u_texsize:new o.c3(I,l.u_texsize),u_texture:new o.b_(I,l.u_texture),u_translation:new o.c3(I,l.u_translation),u_pitched_scale:new o.bq(I,l.u_pitched_scale)}),symbolSDF:(I,l)=>({u_is_size_zoom_constant:new o.b_(I,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(I,l.u_is_size_feature_constant),u_size_t:new o.bq(I,l.u_size_t),u_size:new o.bq(I,l.u_size),u_camera_to_center_distance:new o.bq(I,l.u_camera_to_center_distance),u_pitch:new o.bq(I,l.u_pitch),u_rotate_symbol:new o.b_(I,l.u_rotate_symbol),u_aspect_ratio:new o.bq(I,l.u_aspect_ratio),u_fade_change:new o.bq(I,l.u_fade_change),u_label_plane_matrix:new o.c0(I,l.u_label_plane_matrix),u_coord_matrix:new o.c0(I,l.u_coord_matrix),u_is_text:new o.b_(I,l.u_is_text),u_pitch_with_map:new o.b_(I,l.u_pitch_with_map),u_is_along_line:new o.b_(I,l.u_is_along_line),u_is_variable_anchor:new o.b_(I,l.u_is_variable_anchor),u_texsize:new o.c3(I,l.u_texsize),u_texture:new o.b_(I,l.u_texture),u_gamma_scale:new o.bq(I,l.u_gamma_scale),u_device_pixel_ratio:new o.bq(I,l.u_device_pixel_ratio),u_is_halo:new o.b_(I,l.u_is_halo),u_translation:new o.c3(I,l.u_translation),u_pitched_scale:new o.bq(I,l.u_pitched_scale)}),symbolTextAndIcon:(I,l)=>({u_is_size_zoom_constant:new o.b_(I,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(I,l.u_is_size_feature_constant),u_size_t:new o.bq(I,l.u_size_t),u_size:new o.bq(I,l.u_size),u_camera_to_center_distance:new o.bq(I,l.u_camera_to_center_distance),u_pitch:new o.bq(I,l.u_pitch),u_rotate_symbol:new o.b_(I,l.u_rotate_symbol),u_aspect_ratio:new o.bq(I,l.u_aspect_ratio),u_fade_change:new o.bq(I,l.u_fade_change),u_label_plane_matrix:new o.c0(I,l.u_label_plane_matrix),u_coord_matrix:new o.c0(I,l.u_coord_matrix),u_is_text:new o.b_(I,l.u_is_text),u_pitch_with_map:new o.b_(I,l.u_pitch_with_map),u_is_along_line:new o.b_(I,l.u_is_along_line),u_is_variable_anchor:new o.b_(I,l.u_is_variable_anchor),u_texsize:new o.c3(I,l.u_texsize),u_texsize_icon:new o.c3(I,l.u_texsize_icon),u_texture:new o.b_(I,l.u_texture),u_texture_icon:new o.b_(I,l.u_texture_icon),u_gamma_scale:new o.bq(I,l.u_gamma_scale),u_device_pixel_ratio:new o.bq(I,l.u_device_pixel_ratio),u_is_halo:new o.b_(I,l.u_is_halo),u_translation:new o.c3(I,l.u_translation),u_pitched_scale:new o.bq(I,l.u_pitched_scale)}),background:(I,l)=>({u_opacity:new o.bq(I,l.u_opacity),u_color:new o.b$(I,l.u_color)}),backgroundPattern:(I,l)=>({u_opacity:new o.bq(I,l.u_opacity),u_image:new o.b_(I,l.u_image),u_pattern_tl_a:new o.c3(I,l.u_pattern_tl_a),u_pattern_br_a:new o.c3(I,l.u_pattern_br_a),u_pattern_tl_b:new o.c3(I,l.u_pattern_tl_b),u_pattern_br_b:new o.c3(I,l.u_pattern_br_b),u_texsize:new o.c3(I,l.u_texsize),u_mix:new o.bq(I,l.u_mix),u_pattern_size_a:new o.c3(I,l.u_pattern_size_a),u_pattern_size_b:new o.c3(I,l.u_pattern_size_b),u_scale_a:new o.bq(I,l.u_scale_a),u_scale_b:new o.bq(I,l.u_scale_b),u_pixel_coord_upper:new o.c3(I,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(I,l.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bq(I,l.u_tile_units_to_pixels)}),terrain:(I,l)=>({u_texture:new o.b_(I,l.u_texture),u_ele_delta:new o.bq(I,l.u_ele_delta),u_fog_matrix:new o.c0(I,l.u_fog_matrix),u_fog_color:new o.b$(I,l.u_fog_color),u_fog_ground_blend:new o.bq(I,l.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bq(I,l.u_fog_ground_blend_opacity),u_horizon_color:new o.b$(I,l.u_horizon_color),u_horizon_fog_blend:new o.bq(I,l.u_horizon_fog_blend),u_is_globe_mode:new o.bq(I,l.u_is_globe_mode)}),terrainDepth:(I,l)=>({u_ele_delta:new o.bq(I,l.u_ele_delta)}),terrainCoords:(I,l)=>({u_texture:new o.b_(I,l.u_texture),u_terrain_coords_id:new o.bq(I,l.u_terrain_coords_id),u_ele_delta:new o.bq(I,l.u_ele_delta)}),projectionErrorMeasurement:(I,l)=>({u_input:new o.bq(I,l.u_input),u_output_expected:new o.bq(I,l.u_output_expected)}),atmosphere:(I,l)=>({u_sun_pos:new o.c2(I,l.u_sun_pos),u_atmosphere_blend:new o.bq(I,l.u_atmosphere_blend),u_globe_position:new o.c2(I,l.u_globe_position),u_globe_radius:new o.bq(I,l.u_globe_radius),u_inv_proj_matrix:new o.c0(I,l.u_inv_proj_matrix)}),sky:(I,l)=>({u_sky_color:new o.b$(I,l.u_sky_color),u_horizon_color:new o.b$(I,l.u_horizon_color),u_horizon:new o.c3(I,l.u_horizon),u_horizon_normal:new o.c3(I,l.u_horizon_normal),u_sky_horizon_blend:new o.bq(I,l.u_sky_horizon_blend),u_sky_blend:new o.bq(I,l.u_sky_blend)})};class F_{constructor(l,f,y){this.context=l;let w=l.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){let f=this.context.gl;if(!this.dynamicDraw)throw new Error(\"Attempted to update data while not in dynamic mode.\");this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let k_={Int8:\"BYTE\",Uint8:\"UNSIGNED_BYTE\",Int16:\"SHORT\",Uint16:\"UNSIGNED_SHORT\",Int32:\"INT\",Uint32:\"UNSIGNED_INT\",Float32:\"FLOAT\"};class Tg{constructor(l,f,y,w){this.length=f.length,this.attributes=y,this.itemSize=f.bytesPerElement,this.dynamicDraw=w,this.context=l;let P=l.gl;this.buffer=P.createBuffer(),l.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);let f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,f){for(let y=0;y<this.attributes.length;y++){let w=f.attributes[this.attributes[y].name];w!==void 0&&l.enableVertexAttribArray(w)}}setVertexAttribPointers(l,f,y){for(let w=0;w<this.attributes.length;w++){let P=this.attributes[w],L=f.attributes[P.name];L!==void 0&&l.vertexAttribPointer(L,P.components,l[k_[P.type]],!1,this.itemSize,P.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class zr{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class wd extends zr{getDefault(){return o.bp.transparent}set(l){let f=this.current;(l.r!==f.r||l.g!==f.g||l.b!==f.b||l.a!==f.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class p0 extends zr{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class A0 extends zr{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Eg extends zr{getDefault(){return[!0,!0,!0,!0]}set(l){let f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Qr extends zr{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class wh extends zr{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class Th extends zr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){let f=this.current;(l.func!==f.func||l.ref!==f.ref||l.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class il extends zr{getDefault(){let l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){let f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class N_ extends zr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;l?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=l,this.dirty=!1}}class z_ extends zr{getDefault(){return[0,1]}set(l){let f=this.current;(l[0]!==f[0]||l[1]!==f[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class g0 extends zr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;l?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=l,this.dirty=!1}}class Fc extends zr{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class yf extends zr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;l?f.enable(f.BLEND):f.disable(f.BLEND),this.current=l,this.dirty=!1}}class m0 extends zr{getDefault(){let l=this.gl;return[l.ONE,l.ZERO]}set(l){let f=this.current;(l[0]!==f[0]||l[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class Td extends zr{getDefault(){return o.bp.transparent}set(l){let f=this.current;(l.r!==f.r||l.g!==f.g||l.b!==f.b||l.a!==f.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class _0 extends zr{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class Sg extends zr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;l?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=l,this.dirty=!1}}class xf extends zr{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class bu extends zr{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class y0 extends zr{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class Cg extends zr{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class cr extends zr{getDefault(){let l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){let f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Ed extends zr{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class U_ extends zr{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class V_ extends zr{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.bindTexture(f.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Sd extends zr{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class bx extends zr{getDefault(){return null}set(l){let f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class wx extends zr{getDefault(){return null}set(l){var f;if(l===this.current&&!this.dirty)return;let y=this.gl;Bl(y)?y.bindVertexArray(l):(f=y.getExtension(\"OES_vertex_array_object\"))===null||f===void 0||f.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class ds extends zr{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class Eh extends zr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class ps extends zr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class wu extends zr{constructor(l,f){super(l),this.context=l,this.parent=f}getDefault(){return null}}class vf extends wu{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Sh extends wu{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Mg extends wu{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}let Ig=\"Framebuffer is not complete\";class x0{constructor(l,f,y,w,P){this.context=l,this.width=f,this.height=y;let L=l.gl,z=this.framebuffer=L.createFramebuffer();if(this.colorAttachment=new vf(l,z),w)this.depthAttachment=P?new Mg(l,z):new Sh(l,z);else if(P)throw new Error(\"Stencil cannot be set without depth\");if(L.checkFramebufferStatus(L.FRAMEBUFFER)!==L.FRAMEBUFFER_COMPLETE)throw new Error(Ig)}destroy(){let l=this.context.gl,f=this.colorAttachment.get();if(f&&l.deleteTexture(f),this.depthAttachment){let y=this.depthAttachment.get();y&&l.deleteRenderbuffer(y)}l.deleteFramebuffer(this.framebuffer)}}class Cd{constructor(l){var f,y;if(this.gl=l,this.clearColor=new wd(this),this.clearDepth=new p0(this),this.clearStencil=new A0(this),this.colorMask=new Eg(this),this.depthMask=new Qr(this),this.stencilMask=new wh(this),this.stencilFunc=new Th(this),this.stencilOp=new il(this),this.stencilTest=new N_(this),this.depthRange=new z_(this),this.depthTest=new g0(this),this.depthFunc=new Fc(this),this.blend=new yf(this),this.blendFunc=new m0(this),this.blendColor=new Td(this),this.blendEquation=new _0(this),this.cullFace=new Sg(this),this.cullFaceSide=new xf(this),this.frontFace=new bu(this),this.program=new y0(this),this.activeTexture=new Cg(this),this.viewport=new cr(this),this.bindFramebuffer=new Ed(this),this.bindRenderbuffer=new U_(this),this.bindTexture=new V_(this),this.bindVertexBuffer=new Sd(this),this.bindElementBuffer=new bx(this),this.bindVertexArray=new wx(this),this.pixelStoreUnpack=new ds(this),this.pixelStoreUnpackPremultiplyAlpha=new Eh(this),this.pixelStoreUnpackFlipY=new ps(this),this.extTextureFilterAnisotropic=l.getExtension(\"EXT_texture_filter_anisotropic\")||l.getExtension(\"MOZ_EXT_texture_filter_anisotropic\")||l.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),Bl(l)){this.HALF_FLOAT=l.HALF_FLOAT;let w=l.getExtension(\"EXT_color_buffer_half_float\");this.RGBA16F=(f=l.RGBA16F)!==null&&f!==void 0?f:w?.RGBA16F_EXT,this.RGB16F=(y=l.RGB16F)!==null&&y!==void 0?y:w?.RGB16F_EXT,l.getExtension(\"EXT_color_buffer_float\")}else{l.getExtension(\"EXT_color_buffer_half_float\"),l.getExtension(\"OES_texture_half_float_linear\");let w=l.getExtension(\"OES_texture_half_float\");this.HALF_FLOAT=w?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,f){return new F_(this,l,f)}createVertexBuffer(l,f,y){return new Tg(this,l,f,y)}createRenderbuffer(l,f,y){let w=this.gl,P=w.createRenderbuffer();return this.bindRenderbuffer.set(P),w.renderbufferStorage(w.RENDERBUFFER,l,f,y),this.bindRenderbuffer.set(null),P}createFramebuffer(l,f,y,w){return new x0(this,l,f,y,w)}clear({color:l,depth:f,stencil:y}){let w=this.gl,P=0;l&&(P|=w.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(P|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),y!==void 0&&(P|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),w.clear(P)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){o.bR(l.blendFunction,bi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return Bl(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension(\"OES_vertex_array_object\"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var f;return Bl(this.gl)?this.gl.deleteVertexArray(l):(f=this.gl.getExtension(\"OES_vertex_array_object\"))===null||f===void 0?void 0:f.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}let Ll;function Oa(I,l,f,y,w){let P=I.context,L=I.transform,z=P.gl,G=I.useProgram(\"collisionBox\"),j=[],Q=0,ie=0;for(let Me=0;Me<y.length;Me++){let Oe=y[Me],We=l.getTile(Oe).getBucket(f);if(!We)continue;let De=w?We.textCollisionBox:We.iconCollisionBox,Ge=We.collisionCircleArray;Ge.length>0&&(j.push({circleArray:Ge,circleOffset:ie,coord:Oe}),Q+=Ge.length/4,ie=Q),De&&G.draw(P,z.LINES,sr.disabled,Pr.disabled,I.colorModeForRenderPass(),Tr.disabled,Ps(I.transform),I.style.map.terrain&&I.style.map.terrain.getTerrainData(Oe),L.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),f.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,null,I.transform.zoom,null,null,De.collisionVertexBuffer)}if(!w||!j.length)return;let re=I.useProgram(\"collisionCircle\"),ce=new o.ca;ce.resize(4*Q),ce._trim();let de=0;for(let Me of j)for(let Oe=0;Oe<Me.circleArray.length/4;Oe++){let We=4*Oe,De=Me.circleArray[We+0],Ge=Me.circleArray[We+1],Be=Me.circleArray[We+2],Fe=Me.circleArray[We+3];ce.emplace(de++,De,Ge,Be,Fe,0),ce.emplace(de++,De,Ge,Be,Fe,1),ce.emplace(de++,De,Ge,Be,Fe,2),ce.emplace(de++,De,Ge,Be,Fe,3)}(!Ll||Ll.length<2*Q)&&(Ll=(function(Me){let Oe=2*Me,We=new o.cc;We.resize(Oe),We._trim();for(let De=0;De<Oe;De++){let Ge=6*De;We.uint16[Ge+0]=4*De+0,We.uint16[Ge+1]=4*De+1,We.uint16[Ge+2]=4*De+2,We.uint16[Ge+3]=4*De+2,We.uint16[Ge+4]=4*De+3,We.uint16[Ge+5]=4*De+0}return We})(Q));let Te=P.createIndexBuffer(Ll,!0),Ie=P.createVertexBuffer(ce,o.cb.members,!0);for(let Me of j){let Oe=u0(I.transform);re.draw(P,z.TRIANGLES,sr.disabled,Pr.disabled,I.colorModeForRenderPass(),Tr.disabled,Oe,I.style.map.terrain&&I.style.map.terrain.getTerrainData(Me.coord),null,f.id,Ie,Te,o.aX.simpleSegment(0,2*Me.circleOffset,Me.circleArray.length,Me.circleArray.length/2),null,I.transform.zoom,null,null,null)}Ie.destroy(),Te.destroy()}let v0=o.ar(new Float32Array(16));function G_(I,l,f,y,w,P){let{horizontalAlign:L,verticalAlign:z}=o.aS(I);return new o.P((-(L-.5)*l/w+y[0])*P,(-(z-.5)*f/w+y[1])*P)}function Tu(I,l,f,y,w,P){let L=l.tileAnchorPoint.add(new o.P(l.translation[0],l.translation[1]));if(l.pitchWithMap){let z=y.mult(P);f||(z=z.rotate(-w));let G=L.add(z);return Un(G.x,G.y,l.pitchedLabelPlaneMatrix,l.getElevation).point}if(f){let z=rr(l.tileAnchorPoint.x+1,l.tileAnchorPoint.y,l).point.sub(I),G=Math.atan(z.y/z.x)+(z.x<0?Math.PI:0);return I.add(y.rotate(G))}return I.add(y)}function Ch(I,l,f,y,w,P,L,z,G,j,Q,ie){let re=I.text.placedSymbolArray,ce=I.text.dynamicLayoutVertexArray,de=I.icon.dynamicLayoutVertexArray,Te={};ce.clear();for(let Ie=0;Ie<re.length;Ie++){let Me=re.get(Ie),Oe=Me.hidden||!Me.crossTileID||I.allowVerticalPlacement&&!Me.placedOrientation?null:y[Me.crossTileID];if(Oe){let We=new o.P(Me.anchorX,Me.anchorY),De={getElevation:ie,width:w.width,height:w.height,pitchedLabelPlaneMatrix:P,pitchWithMap:f,transform:w,tileAnchorPoint:We,translation:j,unwrappedTileID:Q},Ge=f?Il(We.x,We.y,De):rr(We.x,We.y,De),Be=Ko(w.cameraToCenterDistance,Ge.signedDistanceFromCamera),Fe=o.aA(I.textSizeData,z,Me)*Be/o.aM;f&&(Fe*=I.tilePixelRatio/L);let{width:Ve,height:ct,anchor:dt,textOffset:pt,textBoxScale:ft}=Oe,Xt=G_(dt,Ve,ct,pt,ft,Fe),Ut=w.getPitchedTextCorrection(We.x+j[0],We.y+j[1],Q),Bt=Tu(Ge.point,De,l,Xt,-w.bearingInRadians,Ut),Jt=I.allowVerticalPlacement&&Me.placedOrientation===o.az.vertical?Math.PI/2:0;for(let jn=0;jn<Me.numGlyphs;jn++)o.aG(ce,Bt,Jt);G&&Me.associatedIconIndex>=0&&(Te[Me.associatedIconIndex]={shiftedAnchor:Bt,angle:Jt})}else $o(Me.numGlyphs,ce)}if(G){de.clear();let Ie=I.icon.placedSymbolArray;for(let Me=0;Me<Ie.length;Me++){let Oe=Ie.get(Me);if(Oe.hidden)$o(Oe.numGlyphs,de);else{let We=Te[Me];if(We)for(let De=0;De<Oe.numGlyphs;De++)o.aG(de,We.shiftedAnchor,We.angle);else $o(Oe.numGlyphs,de)}}I.icon.dynamicLayoutVertexBuffer.updateData(de)}I.text.dynamicLayoutVertexBuffer.updateData(ce)}function kc(I,l,f){return f.iconsInText&&l?\"symbolTextAndIcon\":I?\"symbolSDF\":\"symbolIcon\"}function bf(I,l,f,y,w,P,L,z,G,j,Q,ie,re){let ce=I.context,de=ce.gl,Te=I.transform,Ie=z===\"map\",Me=G===\"map\",Oe=z!==\"viewport\"&&f.layout.get(\"symbol-placement\")!==\"point\",We=Ie&&!Me&&!Oe,De=!f.layout.get(\"symbol-sort-key\").isConstant(),Ge=!1,Be=I.getDepthModeForSublayer(0,sr.ReadOnly),Fe=f._unevaluatedLayout.hasValue(\"text-variable-anchor\")||f._unevaluatedLayout.hasValue(\"text-variable-anchor-offset\"),Ve=[],ct=Te.getCircleRadiusCorrection();for(let dt of y){let pt=l.getTile(dt),ft=pt.getBucket(f);if(!ft)continue;let Xt=w?ft.text:ft.icon;if(!Xt||!Xt.segments.get().length||!Xt.hasVisibleVertices)continue;let Ut=Xt.programConfigurations.get(f.id),Bt=w||ft.sdfIcons,Jt=w?ft.textSizeData:ft.iconSizeData,jn=Me||Te.pitch!==0,Tt=I.useProgram(kc(Bt,w,ft),Ut),Ot=o.ay(Jt,Te.zoom),ni=I.style.map.terrain&&I.style.map.terrain.getTerrainData(dt),Pi,Kr,Ri,ri,Fi=[0,0],po=null;if(w)Kr=pt.glyphAtlasTexture,Ri=de.LINEAR,Pi=pt.glyphAtlasTexture.size,ft.iconsInText&&(Fi=pt.imageAtlasTexture.size,po=pt.imageAtlasTexture,ri=jn||I.options.rotating||I.options.zooming||Jt.kind===\"composite\"||Jt.kind===\"camera\"?de.LINEAR:de.NEAREST);else{let Ce=f.layout.get(\"icon-size\").constantOr(0)!==1||ft.iconsNeedLinear;Kr=pt.imageAtlasTexture,Ri=Bt||I.options.rotating||I.options.zooming||Ce||jn?de.LINEAR:de.NEAREST,Pi=pt.imageAtlasTexture.size}let ui=o.aN(pt,1,I.transform.zoom),A=Qo(Ie,I.transform,ui),g=o.N();o.aB(g,A);let x=Pc(Me,Ie,I.transform,ui),T=o.aO(Te,pt,P,L),M=Te.getProjectionData({overscaledTileID:dt,applyGlobeMatrix:!re,applyTerrainMatrix:!0}),D=Fe&&ft.hasTextData(),O=f.layout.get(\"icon-text-fit\")!==\"none\"&&D&&ft.hasIconData();if(Oe){let Ce=I.style.map.terrain?(Pe,Ye)=>I.style.map.terrain.getElevation(dt,Pe,Ye):null,Se=f.layout.get(\"text-rotation-alignment\")===\"map\";hs(ft,I,w,A,g,Me,j,Se,dt.toUnwrapped(),Te.width,Te.height,T,Ce)}let N=w&&Fe||O,W=Oe||N?v0:Me?A:I.transform.clipSpaceToPixelsMatrix,Z=Bt&&f.paint.get(w?\"text-halo-width\":\"icon-halo-width\").constantOr(1)!==0,ne;ne=Bt?ft.iconsInText?vu(Jt.kind,Ot,We,Me,Oe,N,I,W,x,T,Pi,Fi,ct):bd(Jt.kind,Ot,We,Me,Oe,N,I,W,x,T,w,Pi,0,ct):wg(Jt.kind,Ot,We,Me,Oe,N,I,W,x,T,w,Pi,ct);let _e={program:Tt,buffers:Xt,uniformValues:ne,projectionData:M,atlasTexture:Kr,atlasTextureIcon:po,atlasInterpolation:Ri,atlasInterpolationIcon:ri,isSDF:Bt,hasHalo:Z};if(De&&ft.canOverlap){Ge=!0;let Ce=Xt.segments.get();for(let Se of Ce)Ve.push({segments:new o.aX([Se]),sortKey:Se.sortKey,state:_e,terrainData:ni})}else Ve.push({segments:Xt.segments,sortKey:0,state:_e,terrainData:ni})}Ge&&Ve.sort(((dt,pt)=>dt.sortKey-pt.sortKey));for(let dt of Ve){let pt=dt.state;if(ce.activeTexture.set(de.TEXTURE0),pt.atlasTexture.bind(pt.atlasInterpolation,de.CLAMP_TO_EDGE),pt.atlasTextureIcon&&(ce.activeTexture.set(de.TEXTURE1),pt.atlasTextureIcon&&pt.atlasTextureIcon.bind(pt.atlasInterpolationIcon,de.CLAMP_TO_EDGE)),pt.isSDF){let ft=pt.uniformValues;pt.hasHalo&&(ft.u_is_halo=1,Md(pt.buffers,dt.segments,f,I,pt.program,Be,Q,ie,ft,pt.projectionData,dt.terrainData)),ft.u_is_halo=0}Md(pt.buffers,dt.segments,f,I,pt.program,Be,Q,ie,pt.uniformValues,pt.projectionData,dt.terrainData)}}function Md(I,l,f,y,w,P,L,z,G,j,Q){let ie=y.context;w.draw(ie,ie.gl.TRIANGLES,P,L,z,Tr.backCCW,G,Q,j,f.id,I.layoutVertexBuffer,I.indexBuffer,l,f.paint,y.transform.zoom,I.programConfigurations.get(f.id),I.dynamicLayoutVertexBuffer,I.opacityVertexBuffer)}function b0(I,l,f,y,w){let P=I.context,L=P.gl,z=Pr.disabled,G=new bi([L.ONE,L.ONE],o.bp.transparent,[!0,!0,!0,!0]),j=l.getBucket(f);if(!j)return;let Q=y.key,ie=f.heatmapFbos.get(Q);ie||(ie=Id(P,l.tileSize,l.tileSize),f.heatmapFbos.set(Q,ie)),P.bindFramebuffer.set(ie.framebuffer),P.viewport.set([0,0,l.tileSize,l.tileSize]),P.clear({color:o.bp.transparent});let re=j.programConfigurations.get(f.id),ce=I.useProgram(\"heatmap\",re,!w),de=I.transform.getProjectionData({overscaledTileID:l.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Te=I.style.map.terrain.getTerrainData(y);ce.draw(P,L.TRIANGLES,sr.disabled,z,G,Tr.disabled,la(l,I.transform.zoom,f.paint.get(\"heatmap-intensity\"),1),Te,de,f.id,j.layoutVertexBuffer,j.indexBuffer,j.segments,f.paint,I.transform.zoom,re)}function H_(I,l,f,y,w){let P=I.context,L=P.gl,z=I.transform;P.setColorMode(I.colorModeForRenderPass());let G=Pd(P,l),j=f.key,Q=l.heatmapFbos.get(j);if(!Q)return;P.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,Q.colorAttachment.get()),P.activeTexture.set(L.TEXTURE1),G.bind(L.LINEAR,L.CLAMP_TO_EDGE);let ie=z.getProjectionData({overscaledTileID:f,applyTerrainMatrix:w,applyGlobeMatrix:!y});I.useProgram(\"heatmapTexture\").draw(P,L.TRIANGLES,sr.disabled,Pr.disabled,I.colorModeForRenderPass(),Tr.disabled,Jn(I,l,0,1),null,ie,l.id,I.rasterBoundsBuffer,I.quadTriangleIndexBuffer,I.rasterBoundsSegments,l.paint,z.zoom),Q.destroy(),l.heatmapFbos.delete(j)}function Id(I,l,f){var y,w;let P=I.gl,L=P.createTexture();P.bindTexture(P.TEXTURE_2D,L),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,P.LINEAR);let z=(y=I.HALF_FLOAT)!==null&&y!==void 0?y:P.UNSIGNED_BYTE,G=(w=I.RGBA16F)!==null&&w!==void 0?w:P.RGBA;P.texImage2D(P.TEXTURE_2D,0,G,l,f,0,P.RGBA,z,null);let j=I.createFramebuffer(l,f,!1,!1);return j.colorAttachment.set(L),j}function Pd(I,l){return l.colorRampTexture||(l.colorRampTexture=new o.T(I,l.colorRamp,I.gl.RGBA)),l.colorRampTexture}function W_(I,l,f,y,w,P,L,z){let G=256;if(w.stepInterpolant){let j=l.getSource().maxzoom,Q=L.canonical.z===j?Math.ceil(1<<I.transform.maxZoom-L.canonical.z):1;G=o.an(o.ce(P.maxLineLength/o.a5*1024*Q),256,f.maxTextureSize)}return z.gradient=o.cf({expression:w.gradientExpression(),evaluationKey:\"lineProgress\",resolution:G,image:z.gradient||void 0,clips:P.lineClipsArray}),z.texture?z.texture.update(z.gradient):z.texture=new o.T(f,z.gradient,y.RGBA),z.version=w.gradientVersion,z.texture}function j_(I,l,f,y,w){I.activeTexture.set(l.TEXTURE0),f.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),y.updatePaintBuffers(w)}function uo(I,l,f,y,w,P){(w||I.lineAtlas.dirty)&&(l.activeTexture.set(f.TEXTURE0),I.lineAtlas.bind(l)),y.updatePaintBuffers(P)}function Mh(I,l,f,y,w,P,L){let z=P.gradients[w.id],G=z.texture;w.gradientVersion!==z.version&&(G=W_(I,l,f,y,w,P,L,z)),f.activeTexture.set(y.TEXTURE0),G.bind(w.stepInterpolant?y.NEAREST:y.LINEAR,y.CLAMP_TO_EDGE)}function Fa(I,l,f,y,w,P,L,z,G){let j=P.gradients[w.id],Q=j.texture;w.gradientVersion!==j.version&&(Q=W_(I,l,f,y,w,P,L,j)),f.activeTexture.set(y.TEXTURE0),Q.bind(w.stepInterpolant?y.NEAREST:y.LINEAR,y.CLAMP_TO_EDGE),f.activeTexture.set(y.TEXTURE1),I.lineAtlas.bind(f),z.updatePaintBuffers(G)}function Rd(I,l,f,y,w){if(!f||!y||!y.imageAtlas)return;let P=y.imageAtlas.patternPositions,L=P[f.to.toString()],z=P[f.from.toString()];if(!L&&z&&(L=z),!z&&L&&(z=L),!L||!z){let G=w.getPaintProperty(l);L=P[G],z=P[G]}L&&z&&I.setConstantPatternPositions(L,z)}function Bd(I,l,f,y,w,P,L,z){let G=I.context.gl,j=\"fill-pattern\",Q=f.paint.get(j),ie=Q&&Q.constantOr(1),re=f.getCrossfadeParameters(),ce,de,Te,Ie,Me,Oe=I.transform,We=f.paint.get(\"fill-translate\"),De=f.paint.get(\"fill-translate-anchor\");L?(de=ie&&!f.getPaintProperty(\"fill-outline-color\")?\"fillOutlinePattern\":\"fillOutline\",ce=G.LINES):(de=ie?\"fillPattern\":\"fill\",ce=G.TRIANGLES);let Ge=Q.constantOr(null);for(let Be of y){let Fe=l.getTile(Be);if(ie&&!Fe.patternsLoaded())continue;let Ve=Fe.getBucket(f);if(!Ve)continue;let ct=Ve.programConfigurations.get(f.id),dt=I.useProgram(de,ct),pt=I.style.map.terrain&&I.style.map.terrain.getTerrainData(Be);ie&&(I.context.activeTexture.set(G.TEXTURE0),Fe.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),ct.updatePaintBuffers(re)),Rd(ct,j,Ge,Fe,f);let ft=Oe.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),Xt=o.aO(Oe,Fe,We,De);if(L){Ie=Ve.indexBuffer2,Me=Ve.segments2;let Bt=[G.drawingBufferWidth,G.drawingBufferHeight];Te=de===\"fillOutlinePattern\"&&ie?La(I,re,Fe,Bt,Xt):c0(Bt,Xt)}else Ie=Ve.indexBuffer,Me=Ve.segments,Te=ie?_g(I,re,Fe,Xt):{u_fill_translate:Xt};let Ut=I.stencilModeForClipping(Be);dt.draw(I.context,ce,w,Ut,P,Tr.backCCW,Te,pt,ft,f.id,Ve.layoutVertexBuffer,Ie,Me,f.paint,I.transform.zoom,ct)}}function w0(I,l,f,y,w,P,L,z){let G=I.context,j=G.gl,Q=\"fill-extrusion-pattern\",ie=f.paint.get(Q),re=ie.constantOr(1),ce=f.getCrossfadeParameters(),de=f.paint.get(\"fill-extrusion-opacity\"),Te=ie.constantOr(null),Ie=I.transform;for(let Me of y){let Oe=l.getTile(Me),We=Oe.getBucket(f);if(!We)continue;let De=I.style.map.terrain&&I.style.map.terrain.getTerrainData(Me),Ge=We.programConfigurations.get(f.id),Be=I.useProgram(re?\"fillExtrusionPattern\":\"fillExtrusion\",Ge);re&&(I.context.activeTexture.set(j.TEXTURE0),Oe.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),Ge.updatePaintBuffers(ce));let Fe=Ie.getProjectionData({overscaledTileID:Me,applyGlobeMatrix:!z,applyTerrainMatrix:!0});Rd(Ge,Q,Te,Oe,f);let Ve=o.aO(Ie,Oe,f.paint.get(\"fill-extrusion-translate\"),f.paint.get(\"fill-extrusion-translate-anchor\")),ct=f.paint.get(\"fill-extrusion-vertical-gradient\"),dt=re?mg(I,ct,de,Ve,Me,ce,Oe):vh(I,ct,de,Ve);Be.draw(G,G.gl.TRIANGLES,w,P,L,Tr.backCCW,dt,De,Fe,f.id,We.layoutVertexBuffer,We.indexBuffer,We.segments,f.paint,I.transform.zoom,Ge,I.style.map.terrain&&We.centroidVertexBuffer)}}function Ol(I,l,f,y,w,P,L,z,G){var j;let Q=I.style.projection,ie=I.context,re=I.transform,ce=ie.gl,de=[`#define NUM_ILLUMINATION_SOURCES ${f.paint.get(\"hillshade-highlight-color\").values.length}`],Te=I.useProgram(\"hillshade\",null,!1,de),Ie=!I.options.moving;for(let Me of y){let Oe=l.getTile(Me),We=Oe.fbo;if(!We)continue;let De=Q.getMeshFromTileID(ie,Me.canonical,z,!0,\"raster\"),Ge=(j=I.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(Me);ie.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,We.colorAttachment.get());let Be=re.getProjectionData({overscaledTileID:Me,aligned:Ie,applyGlobeMatrix:!G,applyTerrainMatrix:!0});Te.draw(ie,ce.TRIANGLES,P,w[Me.overscaledZ],L,Tr.backCCW,ve(I,Oe,f),Ge,Be,f.id,De.vertexBuffer,De.indexBuffer,De.segments)}}function Dd(I,l,f,y,w,P,L,z,G){var j;let Q=I.style.projection,ie=I.context,re=I.transform,ce=ie.gl,de=I.useProgram(\"colorRelief\"),Te=!I.options.moving,Ie=!0,Me=0;for(let Oe of y){let We=l.getTile(Oe),De=We.dem;if(Ie){let dt=ce.getParameter(ce.MAX_TEXTURE_SIZE),{elevationTexture:pt,colorTexture:ft}=f.getColorRampTextures(ie,dt,De.getUnpackVector());ie.activeTexture.set(ce.TEXTURE1),pt.bind(ce.NEAREST,ce.CLAMP_TO_EDGE),ie.activeTexture.set(ce.TEXTURE4),ft.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),Ie=!1,Me=pt.size[0]}if(!De||!De.data)continue;let Ge=De.stride,Be=De.getPixels();if(ie.activeTexture.set(ce.TEXTURE0),ie.pixelStoreUnpackPremultiplyAlpha.set(!1),We.demTexture=We.demTexture||I.getTileTexture(Ge),We.demTexture){let dt=We.demTexture;dt.update(Be,{premultiply:!1}),dt.bind(ce.LINEAR,ce.CLAMP_TO_EDGE)}else We.demTexture=new o.T(ie,Be,ce.RGBA,{premultiply:!1}),We.demTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);let Fe=Q.getMeshFromTileID(ie,Oe.canonical,z,!0,\"raster\"),Ve=(j=I.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(Oe),ct=re.getProjectionData({overscaledTileID:Oe,aligned:Te,applyGlobeMatrix:!G,applyTerrainMatrix:!0});de.draw(ie,ce.TRIANGLES,P,w[Oe.overscaledZ],L,Tr.backCCW,L_(f,We.dem,Me),Ve,ct,f.id,Fe.vertexBuffer,Fe.indexBuffer,Fe.segments)}}let Ih=[new o.P(0,0),new o.P(o.a5,0),new o.P(o.a5,o.a5),new o.P(0,o.a5)];function wf(I,l,f,y,w,P,L,z,G=!1,j=!1){let Q=y[y.length-1].overscaledZ,ie=I.context,re=ie.gl,ce=I.useProgram(\"raster\"),de=I.transform,Te=I.style.projection,Ie=I.colorModeForRenderPass(),Me=!I.options.moving,Oe=f.paint.get(\"raster-opacity\"),We=f.paint.get(\"raster-resampling\"),De=f.paint.get(\"raster-fade-duration\"),Ge=!!I.style.map.terrain;for(let Be of y){let Fe=I.getDepthModeForSublayer(Be.overscaledZ-Q,Oe===1?sr.ReadWrite:sr.ReadOnly,re.LESS),Ve=l.getTile(Be),ct=We===\"nearest\"?re.NEAREST:re.LINEAR;ie.activeTexture.set(re.TEXTURE0),Ve.texture.bind(ct,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST),ie.activeTexture.set(re.TEXTURE1);let{parentTile:dt,parentScaleBy:pt,parentTopLeft:ft,fadeValues:Xt}=Tf(Ve,l,De,Ge);Ve.fadeOpacity=Xt.tileOpacity,dt?(dt.fadeOpacity=Xt.parentTileOpacity,dt.texture.bind(ct,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST)):Ve.texture.bind(ct,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST),Ve.texture.useMipmap&&ie.extTextureFilterAnisotropic&&I.transform.pitch>20&&re.texParameterf(re.TEXTURE_2D,ie.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ie.extTextureFilterAnisotropicMax);let Ut=I.style.map.terrain&&I.style.map.terrain.getTerrainData(Be),Bt=de.getProjectionData({overscaledTileID:Be,aligned:Me,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Jt=vg(ft,pt,Xt.fadeMix,f,z),jn=Te.getMeshFromTileID(ie,Be.canonical,P,L,\"raster\");ce.draw(ie,re.TRIANGLES,Fe,w?w[Be.overscaledZ]:Pr.disabled,Ie,G?Tr.frontCCW:Tr.backCCW,Jt,Ut,Bt,f.id,jn.vertexBuffer,jn.indexBuffer,jn.segments)}}function Tf(I,l,f,y){let w={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(f===0||y)return w;if(I.fadingParentID){let P=l.getLoadedTile(I.fadingParentID);if(!P)return w;let L=Math.pow(2,P.tileID.overscaledZ-I.tileID.overscaledZ),z=[I.tileID.canonical.x*L%1,I.tileID.canonical.y*L%1],G=(function(j,Q,ie){let re=k(),ce=(re-Q.timeAdded)/ie,de=j.fadingDirection===He.Incoming,Te=o.an((re-j.timeAdded)/ie,0,1),Ie=o.an(1-ce,0,1),Me=de?Te:Ie;return{tileOpacity:Me,parentTileOpacity:de?Ie:Te,fadeMix:{opacity:1,mix:1-Me}}})(I,P,f);return{parentTile:P,parentScaleBy:L,parentTopLeft:z,fadeValues:G}}if(I.selfFading){let P=(function(L,z){let G=(k()-L.timeAdded)/z,j=o.an(G,0,1);return{tileOpacity:j,fadeMix:{opacity:j,mix:0}}})(I,f);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:P}}return w}let X_=new o.bp(1,0,0,1),T0=new o.bp(0,1,0,1),Pg=new o.bp(0,0,1,1),Ph=new o.bp(1,0,1,1),Eu=new o.bp(0,1,1,1);function Ld(I,l,f,y){Od(I,0,l+f/2,I.transform.width,f,y)}function E0(I,l,f,y){Od(I,l-f/2,0,f,I.transform.height,y)}function Od(I,l,f,y,w,P){let L=I.context,z=L.gl;z.enable(z.SCISSOR_TEST),z.scissor(l*I.pixelRatio,f*I.pixelRatio,y*I.pixelRatio,w*I.pixelRatio),L.clear({color:P}),z.disable(z.SCISSOR_TEST)}function Rg(I,l,f){let y=I.context,w=y.gl,P=I.useProgram(\"debug\"),L=sr.disabled,z=Pr.disabled,G=I.colorModeForRenderPass(),j=\"$debug\",Q=I.style.map.terrain&&I.style.map.terrain.getTerrainData(f);y.activeTexture.set(w.TEXTURE0);let ie=l.getTileByID(f.key).latestRawTileData,re=Math.floor((ie&&ie.byteLength||0)/1024),ce=l.getTile(f).tileSize,de=512/Math.min(ce,512)*(f.overscaledZ/I.transform.zoom)*.5,Te=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Te+=` => ${f.overscaledZ}`),(function(Me,Oe){Me.initDebugOverlayCanvas();let We=Me.debugOverlayCanvas,De=Me.context.gl,Ge=Me.debugOverlayCanvas.getContext(\"2d\");Ge.clearRect(0,0,We.width,We.height),Ge.shadowColor=\"white\",Ge.shadowBlur=2,Ge.lineWidth=1.5,Ge.strokeStyle=\"white\",Ge.textBaseline=\"top\",Ge.font=\"bold 36px Open Sans, sans-serif\",Ge.fillText(Oe,5,5),Ge.strokeText(Oe,5,5),Me.debugOverlayTexture.update(We),Me.debugOverlayTexture.bind(De.LINEAR,De.CLAMP_TO_EDGE)})(I,`${Te} ${re}kB`);let Ie=I.transform.getProjectionData({overscaledTileID:f,applyGlobeMatrix:!0,applyTerrainMatrix:!0});P.draw(y,w.TRIANGLES,L,z,bi.alphaBlended,Tr.disabled,yg(o.bp.transparent,de),null,Ie,j,I.debugBuffer,I.quadTriangleIndexBuffer,I.debugSegments),P.draw(y,w.LINE_STRIP,L,z,G,Tr.disabled,yg(o.bp.red),Q,Ie,j,I.debugBuffer,I.tileBorderIndexBuffer,I.debugSegments)}function Bg(I,l,f,y){let{isRenderingGlobe:w}=y,P=I.context,L=P.gl,z=I.transform,G=I.colorModeForRenderPass(),j=I.getDepthModeFor3D(),Q=I.useProgram(\"terrain\");P.bindFramebuffer.set(null),P.viewport.set([0,0,I.width,I.height]);for(let ie of f){let re=l.getTerrainMesh(ie.tileID),ce=I.renderToTexture.getTexture(ie),de=l.getTerrainData(ie.tileID);P.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,ce.texture);let Te=l.getMeshFrameDelta(z.zoom),Ie=z.calculateFogMatrix(ie.tileID.toUnwrapped()),Me=kr(Te,Ie,I.style.sky,z.pitch,w),Oe=z.getProjectionData({overscaledTileID:ie.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Q.draw(P,L.TRIANGLES,j,Pr.disabled,G,Tr.backCCW,Me,de,Oe,\"terrain\",re.vertexBuffer,re.indexBuffer,re.segments)}}function Dg(I,l){if(!l.mesh){let f=new o.aW;f.emplaceBack(-1,-1),f.emplaceBack(1,-1),f.emplaceBack(1,1),f.emplaceBack(-1,1);let y=new o.aY;y.emplaceBack(0,1,2),y.emplaceBack(0,2,3),l.mesh=new vi(I.createVertexBuffer(f,_h.members),I.createIndexBuffer(y),o.aX.simpleSegment(0,0,f.length,y.length))}return l.mesh}class S0{constructor(l,f){this.context=new Cd(l),this.transform=f,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=qr.maxOverzooming+qr.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Go}resize(l,f,y){if(this.width=Math.floor(l*y),this.height=Math.floor(f*y),this.pixelRatio=y,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let w of this.style._order)this.style._layers[w].resize()}setup(){let l=this.context,f=new o.aW;f.emplaceBack(0,0),f.emplaceBack(o.a5,0),f.emplaceBack(0,o.a5),f.emplaceBack(o.a5,o.a5),this.tileExtentBuffer=l.createVertexBuffer(f,_h.members),this.tileExtentSegments=o.aX.simpleSegment(0,0,4,2);let y=new o.aW;y.emplaceBack(0,0),y.emplaceBack(o.a5,0),y.emplaceBack(0,o.a5),y.emplaceBack(o.a5,o.a5),this.debugBuffer=l.createVertexBuffer(y,_h.members),this.debugSegments=o.aX.simpleSegment(0,0,4,5);let w=new o.ch;w.emplaceBack(0,0,0,0),w.emplaceBack(o.a5,0,o.a5,0),w.emplaceBack(0,o.a5,0,o.a5),w.emplaceBack(o.a5,o.a5,o.a5,o.a5),this.rasterBoundsBuffer=l.createVertexBuffer(w,aa.members),this.rasterBoundsSegments=o.aX.simpleSegment(0,0,4,2);let P=new o.aW;P.emplaceBack(0,0),P.emplaceBack(o.a5,0),P.emplaceBack(0,o.a5),P.emplaceBack(o.a5,o.a5),this.rasterBoundsBufferPosOnly=l.createVertexBuffer(P,_h.members),this.rasterBoundsSegmentsPosOnly=o.aX.simpleSegment(0,0,4,5);let L=new o.aW;L.emplaceBack(0,0),L.emplaceBack(1,0),L.emplaceBack(0,1),L.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(L,_h.members),this.viewportSegments=o.aX.simpleSegment(0,0,4,2);let z=new o.ci;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(z);let G=new o.aY;G.emplaceBack(1,0,2),G.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(G);let j=this.context.gl;this.stencilClearMode=new Pr({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO),this.tileExtentMesh=new vi(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){let l=this.context,f=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let y=o.N();o.c7(y,0,this.width,this.height,0,0,1),o.Q(y,y,[f.drawingBufferWidth,f.drawingBufferHeight,0]);let w={mainMatrix:y,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:y};this.useProgram(\"clippingMask\",null,!0).draw(l,f.TRIANGLES,sr.disabled,this.stencilClearMode,bi.disabled,Tr.disabled,null,null,w,\"$clipping\",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,f,y){if(this.currentStencilSource===l.source||!l.isTileClipped()||!f||!f.length)return;this.currentStencilSource=l.source,this.nextStencilID+f.length>256&&this.clearStencil();let w=this.context;w.setColorMode(bi.disabled),w.setDepthMode(sr.disabled);let P={};for(let L of f)P[L.key]=this.nextStencilID++;this._renderTileMasks(P,f,y,!0),this._renderTileMasks(P,f,y,!1),this._tileClippingMaskIDs=P}_renderTileMasks(l,f,y,w){let P=this.context,L=P.gl,z=this.style.projection,G=this.transform,j=this.useProgram(\"clippingMask\");for(let Q of f){let ie=l[Q.key],re=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Q),ce=z.getMeshFromTileID(this.context,Q.canonical,w,!0,\"stencil\"),de=G.getProjectionData({overscaledTileID:Q,applyGlobeMatrix:!y,applyTerrainMatrix:!0});j.draw(P,L.TRIANGLES,sr.disabled,new Pr({func:L.ALWAYS,mask:0},ie,255,L.KEEP,L.KEEP,L.REPLACE),bi.disabled,y?Tr.disabled:Tr.backCCW,null,re,de,\"$clipping\",ce.vertexBuffer,ce.indexBuffer,ce.segments)}}_renderTilesDepthBuffer(){let l=this.context,f=l.gl,y=this.style.projection,w=this.transform,P=this.useProgram(\"depth\"),L=this.getDepthModeFor3D(),z=Et(w,{tileSize:w.tileSize});for(let G of z){let j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(G),Q=y.getMeshFromTileID(this.context,G.canonical,!0,!0,\"raster\"),ie=w.getProjectionData({overscaledTileID:G,applyGlobeMatrix:!0,applyTerrainMatrix:!0});P.draw(l,f.TRIANGLES,L,Pr.disabled,bi.disabled,Tr.backCCW,null,j,ie,\"$clipping\",Q.vertexBuffer,Q.indexBuffer,Q.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let l=this.nextStencilID++,f=this.context.gl;return new Pr({func:f.NOTEQUAL,mask:255},l,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(l){let f=this.context.gl;return new Pr({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,f.KEEP,f.KEEP,f.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(l){let f=this.context.gl,y=l.sort(((L,z)=>z.overscaledZ-L.overscaledZ)),w=y[y.length-1].overscaledZ,P=y[0].overscaledZ-w+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();let L={};for(let z=0;z<P;z++)L[z+w]=new Pr({func:f.GEQUAL,mask:255},z+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=P,[L,y]}return[{[w]:Pr.disabled},y]}stencilConfigForOverlapTwoPass(l){let f=this.context.gl,y=l.sort(((L,z)=>z.overscaledZ-L.overscaledZ)),w=y[y.length-1].overscaledZ,P=y[0].overscaledZ-w+1;if(this.clearStencil(),P>1){let L={},z={};for(let G=0;G<P;G++)L[G+w]=new Pr({func:f.GREATER,mask:255},P+1+G,255,f.KEEP,f.KEEP,f.REPLACE),z[G+w]=new Pr({func:f.GREATER,mask:255},1+G,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID=2*P+1,[L,z,y]}return this.nextStencilID=3,[{[w]:new Pr({func:f.GREATER,mask:255},2,255,f.KEEP,f.KEEP,f.REPLACE)},{[w]:new Pr({func:f.GREATER,mask:255},1,255,f.KEEP,f.KEEP,f.REPLACE)},y]}colorModeForRenderPass(){let l=this.context.gl;return this._showOverdrawInspector?new bi([l.CONSTANT_COLOR,l.ONE],new o.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass===\"opaque\"?bi.unblended:bi.alphaBlended}getDepthModeForSublayer(l,f,y){if(!this.opaquePassEnabledForLayer())return sr.disabled;let w=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new sr(y||this.context.gl.LEQUAL,f,[w,w])}getDepthModeFor3D(){return new sr(this.context.gl.LEQUAL,sr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,f){var y,w;this.style=l,this.options=f,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(k()),this.imageManager.beginFrame();let P=this.style._order,L=this.style.tileManagers,z={},G={},j={},Q={isRenderingToTexture:!1,isRenderingGlobe:((y=l.projection)===null||y===void 0?void 0:y.transitionState)>0};for(let re in L){let ce=L[re];ce.used&&ce.prepare(this.context),z[re]=ce.getVisibleCoordinates(!1),G[re]=z[re].slice().reverse(),j[re]=ce.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let re=0;re<P.length;re++)if(this.style._layers[P[re]].is3D()){this.opaquePassCutoff=re;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass=\"offscreen\";for(let re of P){let ce=this.style._layers[re];if(!ce.hasOffscreenPass()||ce.isHidden(this.transform.zoom))continue;let de=G[ce.source];(ce.type===\"custom\"||de.length)&&this.renderLayer(this,L[ce.source],ce,de,Q)}if((w=this.style.projection)===null||w===void 0||w.updateGPUdependent({context:this.context,useProgram:re=>this.useProgram(re)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?o.bp.black:o.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(re,ce){let de=re.context,Te=de.gl,Ie=((Be,Fe,Ve)=>{let ct=Math.cos(Fe.rollInRadians),dt=Math.sin(Fe.rollInRadians),pt=vt(Fe),ft=Fe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Be.properties.get(\"sky-color\"),u_horizon_color:Be.properties.get(\"horizon-color\"),u_horizon:[(Fe.width/2-pt*dt)*Ve,(Fe.height/2+pt*ct)*Ve],u_horizon_normal:[-dt,ct],u_sky_horizon_blend:Be.properties.get(\"sky-horizon-blend\")*Fe.height/2*Ve,u_sky_blend:ft}})(ce,re.style.map.transform,re.pixelRatio),Me=new sr(Te.LEQUAL,sr.ReadWrite,[0,1]),Oe=Pr.disabled,We=re.colorModeForRenderPass(),De=re.useProgram(\"sky\"),Ge=Dg(de,ce);De.draw(de,Te.TRIANGLES,Me,Oe,We,Tr.disabled,Ie,null,void 0,\"sky\",Ge.vertexBuffer,Ge.indexBuffer,Ge.segments)})(this,this.style.sky),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass=\"opaque\",this.currentLayer=P.length-1;this.currentLayer>=0;this.currentLayer--){let re=this.style._layers[P[this.currentLayer]],ce=L[re.source],de=z[re.source];this._renderTileClippingMasks(re,de,!1),this.renderLayer(this,ce,re,de,Q)}this.renderPass=\"translucent\";let ie=!1;for(this.currentLayer=0;this.currentLayer<P.length;this.currentLayer++){let re=this.style._layers[P[this.currentLayer]],ce=L[re.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(re,Q))continue;this.opaquePassEnabledForLayer()||ie||(ie=!0,Q.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());let de=(re.type===\"symbol\"?j:G)[re.source];this._renderTileClippingMasks(re,z[re.source],!!this.renderToTexture),this.renderLayer(this,ce,re,de,Q)}if(Q.isRenderingGlobe&&(function(re,ce,de){let Te=re.context,Ie=Te.gl,Me=re.useProgram(\"atmosphere\"),Oe=new sr(Ie.LEQUAL,sr.ReadOnly,[0,1]),We=re.transform,De=(function(ft,Xt){let Ut=ft.properties.get(\"position\"),Bt=[-Ut.x,-Ut.y,-Ut.z],Jt=o.ar(new Float64Array(16));return ft.properties.get(\"anchor\")===\"map\"&&(o.bg(Jt,Jt,Xt.rollInRadians),o.bh(Jt,Jt,-Xt.pitchInRadians),o.bg(Jt,Jt,Xt.bearingInRadians),o.bh(Jt,Jt,Xt.center.lat*Math.PI/180),o.bJ(Jt,Jt,-Xt.center.lng*Math.PI/180)),o.cg(Bt,Bt,Jt),Bt})(de,re.transform),Ge=We.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Be=ce.properties.get(\"atmosphere-blend\")*Ge.projectionTransition;if(Be===0)return;let Fe=mf(We.worldSize,We.center.lat),Ve=We.inverseProjectionMatrix,ct=new Float64Array(4);ct[3]=1,o.aH(ct,ct,We.modelViewProjectionMatrix),ct[0]/=ct[3],ct[1]/=ct[3],ct[2]/=ct[3],ct[3]=1,o.aH(ct,ct,Ve),ct[0]/=ct[3],ct[1]/=ct[3],ct[2]/=ct[3],ct[3]=1;let dt=((ft,Xt,Ut,Bt,Jt)=>({u_sun_pos:ft,u_atmosphere_blend:Xt,u_globe_position:Ut,u_globe_radius:Bt,u_inv_proj_matrix:Jt}))(De,Be,[ct[0],ct[1],ct[2]],Fe,Ve),pt=Dg(Te,ce);Me.draw(Te,Ie.TRIANGLES,Oe,Pr.disabled,bi.alphaBlended,Tr.disabled,dt,null,null,\"atmosphere\",pt.vertexBuffer,pt.indexBuffer,pt.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){let re=(function(ce,de){let Te=null,Ie=Object.values(ce._layers).flatMap((De=>De.source&&!De.isHidden(de)?[ce.tileManagers[De.source]]:[])),Me=Ie.filter((De=>De.getSource().type===\"vector\")),Oe=Ie.filter((De=>De.getSource().type!==\"vector\")),We=De=>{(!Te||Te.getSource().maxzoom<De.getSource().maxzoom)&&(Te=De)};return Me.forEach((De=>We(De))),Te||Oe.forEach((De=>We(De))),Te})(this.style,this.transform.zoom);re&&(function(ce,de,Te){for(let Ie=0;Ie<Te.length;Ie++)Rg(ce,de,Te[Ie])})(this,re,re.getVisibleCoordinates())}this.options.showPadding&&(function(re){let ce=re.transform.padding;Ld(re,re.transform.height-(ce.top||0),3,X_),Ld(re,ce.bottom||0,3,T0),E0(re,ce.left||0,3,Pg),E0(re,re.transform.width-(ce.right||0),3,Ph);let de=re.transform.centerPoint;(function(Te,Ie,Me,Oe){Od(Te,Ie-1,Me-10,2,20,Oe),Od(Te,Ie-10,Me-1,20,2,Oe)})(re,de.x,re.transform.height-de.y,Eu)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;let f=this.terrainFacilitator.matrix,y=this.transform.modelViewProjectionMatrix,w=this.terrainFacilitator.dirty;w||(w=l?!o.cj(f,y):!o.ck(f,y)),w||(w=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),w&&(o.cl(f,y),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(P,L){let z=P.context,G=z.gl,j=P.transform,Q=bi.unblended,ie=new sr(G.LEQUAL,sr.ReadWrite,[0,1]),re=L.tileManager.getRenderableTiles(),ce=P.useProgram(\"terrainDepth\");z.bindFramebuffer.set(L.getFramebuffer(\"depth\").framebuffer),z.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),z.clear({color:o.bp.transparent,depth:1});for(let de of re){let Te=L.getTerrainMesh(de.tileID),Ie=L.getTerrainData(de.tileID),Me=j.getProjectionData({overscaledTileID:de.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Oe={u_ele_delta:L.getMeshFrameDelta(j.zoom)};ce.draw(z,G.TRIANGLES,ie,Pr.disabled,Q,Tr.backCCW,Oe,Ie,Me,\"terrain\",Te.vertexBuffer,Te.indexBuffer,Te.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,P.width,P.height])})(this,this.style.map.terrain),(function(P,L){let z=P.context,G=z.gl,j=P.transform,Q=bi.unblended,ie=new sr(G.LEQUAL,sr.ReadWrite,[0,1]),re=L.getCoordsTexture(),ce=L.tileManager.getRenderableTiles(),de=P.useProgram(\"terrainCoords\");z.bindFramebuffer.set(L.getFramebuffer(\"coords\").framebuffer),z.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),z.clear({color:o.bp.transparent,depth:1}),L.coordsIndex=[];for(let Te of ce){let Ie=L.getTerrainMesh(Te.tileID),Me=L.getTerrainData(Te.tileID);z.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,re.texture);let Oe={u_terrain_coords_id:(255-L.coordsIndex.length)/255,u_texture:0,u_ele_delta:L.getMeshFrameDelta(j.zoom)},We=j.getProjectionData({overscaledTileID:Te.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});de.draw(z,G.TRIANGLES,ie,Pr.disabled,Q,Tr.backCCW,Oe,Me,We,\"terrain\",Ie.vertexBuffer,Ie.indexBuffer,Ie.segments),L.coordsIndex.push(Te.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,P.width,P.height])})(this,this.style.map.terrain))}renderLayer(l,f,y,w,P){y.isHidden(this.transform.zoom)||(y.type===\"background\"||y.type===\"custom\"||(w||[]).length)&&(this.id=y.id,o.cm(y)?(function(L,z,G,j,Q,ie){if(L.renderPass!==\"translucent\")return;let{isRenderingToTexture:re}=ie,ce=Pr.disabled,de=L.colorModeForRenderPass();(G._unevaluatedLayout.hasValue(\"text-variable-anchor\")||G._unevaluatedLayout.hasValue(\"text-variable-anchor-offset\"))&&(function(Te,Ie,Me,Oe,We,De,Ge,Be,Fe){let Ve=Ie.transform,ct=Ie.style.map.terrain,dt=We===\"map\",pt=De===\"map\";for(let ft of Te){let Xt=Oe.getTile(ft),Ut=Xt.getBucket(Me);if(!Ut||!Ut.text||!Ut.text.segments.get().length)continue;let Bt=o.ay(Ut.textSizeData,Ve.zoom),Jt=o.aN(Xt,1,Ie.transform.zoom),jn=Qo(dt,Ie.transform,Jt),Tt=Me.layout.get(\"icon-text-fit\")!==\"none\"&&Ut.hasIconData();if(Bt){let Ot=Math.pow(2,Ve.zoom-Xt.tileID.overscaledZ),ni=ct?(Pi,Kr)=>ct.getElevation(ft,Pi,Kr):null;Ch(Ut,dt,pt,Fe,Ve,jn,Ot,Bt,Tt,o.aO(Ve,Xt,Ge,Be),ft.toUnwrapped(),ni)}}})(j,L,G,z,G.layout.get(\"text-rotation-alignment\"),G.layout.get(\"text-pitch-alignment\"),G.paint.get(\"text-translate\"),G.paint.get(\"text-translate-anchor\"),Q),G.paint.get(\"icon-opacity\").constantOr(1)!==0&&bf(L,z,G,j,!1,G.paint.get(\"icon-translate\"),G.paint.get(\"icon-translate-anchor\"),G.layout.get(\"icon-rotation-alignment\"),G.layout.get(\"icon-pitch-alignment\"),G.layout.get(\"icon-keep-upright\"),ce,de,re),G.paint.get(\"text-opacity\").constantOr(1)!==0&&bf(L,z,G,j,!0,G.paint.get(\"text-translate\"),G.paint.get(\"text-translate-anchor\"),G.layout.get(\"text-rotation-alignment\"),G.layout.get(\"text-pitch-alignment\"),G.layout.get(\"text-keep-upright\"),ce,de,re),z.map.showCollisionBoxes&&(Oa(L,z,G,j,!0),Oa(L,z,G,j,!1))})(l,f,y,w,this.style.placement.variableOffsets,P):o.cn(y)?(function(L,z,G,j,Q){if(L.renderPass!==\"translucent\")return;let{isRenderingToTexture:ie}=Q,re=G.paint.get(\"circle-opacity\"),ce=G.paint.get(\"circle-stroke-width\"),de=G.paint.get(\"circle-stroke-opacity\"),Te=!G.layout.get(\"circle-sort-key\").isConstant();if(re.constantOr(1)===0&&(ce.constantOr(1)===0||de.constantOr(1)===0))return;let Ie=L.context,Me=Ie.gl,Oe=L.transform,We=L.getDepthModeForSublayer(0,sr.ReadOnly),De=Pr.disabled,Ge=L.colorModeForRenderPass(),Be=[],Fe=Oe.getCircleRadiusCorrection();for(let Ve=0;Ve<j.length;Ve++){let ct=j[Ve],dt=z.getTile(ct),pt=dt.getBucket(G);if(!pt)continue;let ft=G.paint.get(\"circle-translate\"),Xt=G.paint.get(\"circle-translate-anchor\"),Ut=o.aO(Oe,dt,ft,Xt),Bt=pt.programConfigurations.get(G.id),Jt=L.useProgram(\"circle\",Bt),jn=pt.layoutVertexBuffer,Tt=pt.indexBuffer,Ot=L.style.map.terrain&&L.style.map.terrain.getTerrainData(ct),ni={programConfiguration:Bt,program:Jt,layoutVertexBuffer:jn,indexBuffer:Tt,uniformValues:bh(L,dt,G,Ut,Fe),terrainData:Ot,projectionData:Oe.getProjectionData({overscaledTileID:ct,applyGlobeMatrix:!ie,applyTerrainMatrix:!0})};if(Te){let Pi=pt.segments.get();for(let Kr of Pi)Be.push({segments:new o.aX([Kr]),sortKey:Kr.sortKey,state:ni})}else Be.push({segments:pt.segments,sortKey:0,state:ni})}Te&&Be.sort(((Ve,ct)=>Ve.sortKey-ct.sortKey));for(let Ve of Be){let{programConfiguration:ct,program:dt,layoutVertexBuffer:pt,indexBuffer:ft,uniformValues:Xt,terrainData:Ut,projectionData:Bt}=Ve.state;dt.draw(Ie,Me.TRIANGLES,We,De,Ge,Tr.backCCW,Xt,Ut,Bt,G.id,pt,ft,Ve.segments,G.paint,L.transform.zoom,ct)}})(l,f,y,w,P):o.co(y)?(function(L,z,G,j,Q){if(G.paint.get(\"heatmap-opacity\")===0)return;let ie=L.context,{isRenderingToTexture:re,isRenderingGlobe:ce}=Q;if(L.style.map.terrain){for(let de of j){let Te=z.getTile(de);z.hasRenderableParent(de)||(L.renderPass===\"offscreen\"?b0(L,Te,G,de,ce):L.renderPass===\"translucent\"&&H_(L,G,de,re,ce))}ie.viewport.set([0,0,L.width,L.height])}else L.renderPass===\"offscreen\"?(function(de,Te,Ie,Me){let Oe=de.context,We=Oe.gl,De=de.transform,Ge=Pr.disabled,Be=new bi([We.ONE,We.ONE],o.bp.transparent,[!0,!0,!0,!0]);(function(Fe,Ve,ct){let dt=Fe.gl;Fe.activeTexture.set(dt.TEXTURE1),Fe.viewport.set([0,0,Ve.width/4,Ve.height/4]);let pt=ct.heatmapFbos.get(o.cd);pt?(dt.bindTexture(dt.TEXTURE_2D,pt.colorAttachment.get()),Fe.bindFramebuffer.set(pt.framebuffer)):(pt=Id(Fe,Ve.width/4,Ve.height/4),ct.heatmapFbos.set(o.cd,pt))})(Oe,de,Ie),Oe.clear({color:o.bp.transparent});for(let Fe=0;Fe<Me.length;Fe++){let Ve=Me[Fe];if(Te.hasRenderableParent(Ve))continue;let ct=Te.getTile(Ve),dt=ct.getBucket(Ie);if(!dt)continue;let pt=dt.programConfigurations.get(Ie.id),ft=de.useProgram(\"heatmap\",pt),Xt=De.getProjectionData({overscaledTileID:Ve,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Ut=De.getCircleRadiusCorrection();ft.draw(Oe,We.TRIANGLES,sr.disabled,Ge,Be,Tr.backCCW,la(ct,De.zoom,Ie.paint.get(\"heatmap-intensity\"),Ut),null,Xt,Ie.id,dt.layoutVertexBuffer,dt.indexBuffer,dt.segments,Ie.paint,De.zoom,pt)}Oe.viewport.set([0,0,de.width,de.height])})(L,z,G,j):L.renderPass===\"translucent\"&&(function(de,Te){let Ie=de.context,Me=Ie.gl;Ie.setColorMode(de.colorModeForRenderPass());let Oe=Te.heatmapFbos.get(o.cd);Oe&&(Ie.activeTexture.set(Me.TEXTURE0),Me.bindTexture(Me.TEXTURE_2D,Oe.colorAttachment.get()),Ie.activeTexture.set(Me.TEXTURE1),Pd(Ie,Te).bind(Me.LINEAR,Me.CLAMP_TO_EDGE),de.useProgram(\"heatmapTexture\").draw(Ie,Me.TRIANGLES,sr.disabled,Pr.disabled,de.colorModeForRenderPass(),Tr.disabled,Jn(de,Te,0,1),null,null,Te.id,de.viewportBuffer,de.quadTriangleIndexBuffer,de.viewportSegments,Te.paint,de.transform.zoom))})(L,G)})(l,f,y,w,P):o.cp(y)?(function(L,z,G,j,Q){if(L.renderPass!==\"translucent\")return;let{isRenderingToTexture:ie}=Q,re=G.paint.get(\"line-opacity\"),ce=G.paint.get(\"line-width\");if(re.constantOr(1)===0||ce.constantOr(1)===0)return;let de=L.getDepthModeForSublayer(0,sr.ReadOnly),Te=L.colorModeForRenderPass(),Ie=G.paint.get(\"line-dasharray\"),Me=Ie.constantOr(1),Oe=G.paint.get(\"line-pattern\"),We=Oe.constantOr(1),De=G.paint.get(\"line-gradient\"),Ge=G.getCrossfadeParameters(),Be;Be=We?\"linePattern\":Me&&De?\"lineGradientSDF\":Me?\"lineSDF\":De?\"lineGradient\":\"line\";let Fe=L.context,Ve=Fe.gl,ct=L.transform,dt=!0;for(let pt of j){let ft=z.getTile(pt);if(We&&!ft.patternsLoaded())continue;let Xt=ft.getBucket(G);if(!Xt)continue;let Ut=Xt.programConfigurations.get(G.id),Bt=L.context.program.get(),Jt=L.useProgram(Be,Ut),jn=dt||Jt.program!==Bt,Tt=L.style.map.terrain&&L.style.map.terrain.getTerrainData(pt),Ot=Oe.constantOr(null),ni=Ie&&Ie.constantOr(null);if(Ot&&ft.imageAtlas){let Fi=ft.imageAtlas,po=Fi.patternPositions[Ot.to.toString()],ui=Fi.patternPositions[Ot.from.toString()];po&&ui&&Ut.setConstantPatternPositions(po,ui)}else if(ni){let Fi=G.layout.get(\"line-cap\")===\"round\",po=L.lineAtlas.getDash(ni.to,Fi),ui=L.lineAtlas.getDash(ni.from,Fi);Ut.setConstantDashPositions(po,ui)}let Pi=ct.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!ie,applyTerrainMatrix:!0}),Kr=ct.getPixelScale(),Ri;We?(Ri=xg(L,ft,G,Kr,Ge),j_(Fe,Ve,ft,Ut,Ge)):Me&&De?(Ri=h0(L,ft,G,Kr,Ge,Xt.lineClipsArray.length),Fa(L,z,Fe,Ve,G,Xt,pt,Ut,Ge)):Me?(Ri=Ae(L,ft,G,Kr,Ge),uo(L,Fe,Ve,Ut,jn,Ge)):De?(Ri=O_(L,ft,G,Kr,Xt.lineClipsArray.length),Mh(L,z,Fe,Ve,G,Xt,pt)):Ri=vd(L,ft,G,Kr);let ri=L.stencilModeForClipping(pt);Jt.draw(Fe,Ve.TRIANGLES,de,ri,Te,Tr.disabled,Ri,Tt,Pi,G.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,G.paint,L.transform.zoom,Ut,Xt.layoutVertexBuffer2),dt=!1}})(l,f,y,w,P):o.cq(y)?(function(L,z,G,j,Q){let ie=G.paint.get(\"fill-color\"),re=G.paint.get(\"fill-opacity\");if(re.constantOr(1)===0)return;let{isRenderingToTexture:ce}=Q,de=L.colorModeForRenderPass(),Te=G.paint.get(\"fill-pattern\"),Ie=L.opaquePassEnabledForLayer()&&!Te.constantOr(1)&&ie.constantOr(o.bp.transparent).a===1&&re.constantOr(0)===1?\"opaque\":\"translucent\";if(L.renderPass===Ie){let Me=L.getDepthModeForSublayer(1,L.renderPass===\"opaque\"?sr.ReadWrite:sr.ReadOnly);Bd(L,z,G,j,Me,de,!1,ce)}if(L.renderPass===\"translucent\"&&G.paint.get(\"fill-antialias\")){let Me=L.getDepthModeForSublayer(G.getPaintProperty(\"fill-outline-color\")?2:0,sr.ReadOnly);Bd(L,z,G,j,Me,de,!0,ce)}})(l,f,y,w,P):o.cr(y)?(function(L,z,G,j,Q){let ie=G.paint.get(\"fill-extrusion-opacity\");if(ie===0)return;let{isRenderingToTexture:re}=Q;if(L.renderPass===\"translucent\"){let ce=new sr(L.context.gl.LEQUAL,sr.ReadWrite,L.depthRangeFor3D);if(ie!==1||G.paint.get(\"fill-extrusion-pattern\").constantOr(1))w0(L,z,G,j,ce,Pr.disabled,bi.disabled,re),w0(L,z,G,j,ce,L.stencilModeFor3D(),L.colorModeForRenderPass(),re);else{let de=L.colorModeForRenderPass();w0(L,z,G,j,ce,Pr.disabled,de,re)}}})(l,f,y,w,P):o.cs(y)?(function(L,z,G,j,Q){if(L.renderPass!==\"offscreen\"&&L.renderPass!==\"translucent\")return;let{isRenderingToTexture:ie}=Q,re=L.context,ce=L.style.projection.useSubdivision,de=L.getDepthModeForSublayer(0,sr.ReadOnly),Te=L.colorModeForRenderPass();if(L.renderPass===\"offscreen\")(function(Ie,Me,Oe,We,De,Ge,Be){let Fe=Ie.context,Ve=Fe.gl;for(let ct of Oe){let dt=Me.getTile(ct),pt=dt.dem;if(!pt||!pt.data||!dt.needsHillshadePrepare)continue;let ft=pt.dim,Xt=pt.stride,Ut=pt.getPixels();if(Fe.activeTexture.set(Ve.TEXTURE1),Fe.pixelStoreUnpackPremultiplyAlpha.set(!1),dt.demTexture=dt.demTexture||Ie.getTileTexture(Xt),dt.demTexture){let Jt=dt.demTexture;Jt.update(Ut,{premultiply:!1}),Jt.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE)}else dt.demTexture=new o.T(Fe,Ut,Ve.RGBA,{premultiply:!1}),dt.demTexture.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE);Fe.activeTexture.set(Ve.TEXTURE0);let Bt=dt.fbo;if(!Bt){let Jt=new o.T(Fe,{width:ft,height:ft,data:null},Ve.RGBA);Jt.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE),Bt=dt.fbo=Fe.createFramebuffer(ft,ft,!0,!1),Bt.colorAttachment.set(Jt.texture)}Fe.bindFramebuffer.set(Bt.framebuffer),Fe.viewport.set([0,0,ft,ft]),Ie.useProgram(\"hillshadePrepare\").draw(Fe,Ve.TRIANGLES,De,Ge,Be,Tr.disabled,Wn(dt.tileID,pt),null,null,We.id,Ie.rasterBoundsBuffer,Ie.quadTriangleIndexBuffer,Ie.rasterBoundsSegments),dt.needsHillshadePrepare=!1}})(L,z,j,G,de,Pr.disabled,Te),re.viewport.set([0,0,L.width,L.height]);else if(L.renderPass===\"translucent\")if(ce){let[Ie,Me,Oe]=L.stencilConfigForOverlapTwoPass(j);Ol(L,z,G,Oe,Ie,de,Te,!1,ie),Ol(L,z,G,Oe,Me,de,Te,!0,ie)}else{let[Ie,Me]=L.getStencilConfigForOverlapAndUpdateStencilID(j);Ol(L,z,G,Me,Ie,de,Te,!1,ie)}})(l,f,y,w,P):o.ct(y)?(function(L,z,G,j,Q){if(L.renderPass!==\"translucent\"||!j.length)return;let{isRenderingToTexture:ie}=Q,re=L.style.projection.useSubdivision,ce=L.getDepthModeForSublayer(0,sr.ReadOnly),de=L.colorModeForRenderPass();if(re){let[Te,Ie,Me]=L.stencilConfigForOverlapTwoPass(j);Dd(L,z,G,Me,Te,ce,de,!1,ie),Dd(L,z,G,Me,Ie,ce,de,!0,ie)}else{let[Te,Ie]=L.getStencilConfigForOverlapAndUpdateStencilID(j);Dd(L,z,G,Ie,Te,ce,de,!1,ie)}})(l,f,y,w,P):o.bU(y)?(function(L,z,G,j,Q){if(L.renderPass!==\"translucent\"||G.paint.get(\"raster-opacity\")===0||!j.length)return;let{isRenderingToTexture:ie}=Q,re=z.getSource(),ce=L.style.projection.useSubdivision;if(re instanceof Fr)wf(L,z,G,j,null,!1,!1,re.tileCoords,re.flippedWindingOrder,ie);else if(ce){let[de,Te,Ie]=L.stencilConfigForOverlapTwoPass(j);wf(L,z,G,Ie,de,!1,!0,Ih,!1,ie),wf(L,z,G,Ie,Te,!0,!0,Ih,!1,ie)}else{let[de,Te]=L.getStencilConfigForOverlapAndUpdateStencilID(j);wf(L,z,G,Te,de,!1,!0,Ih,!1,ie)}})(l,f,y,w,P):o.cu(y)?(function(L,z,G,j,Q){let ie=G.paint.get(\"background-color\"),re=G.paint.get(\"background-opacity\");if(re===0)return;let{isRenderingToTexture:ce}=Q,de=L.context,Te=de.gl,Ie=L.style.projection,Me=L.transform,Oe=Me.tileSize,We=G.paint.get(\"background-pattern\");if(L.isPatternMissing(We))return;let De=!We&&ie.a===1&&re===1&&L.opaquePassEnabledForLayer()?\"opaque\":\"translucent\";if(L.renderPass!==De)return;let Ge=Pr.disabled,Be=L.getDepthModeForSublayer(0,De===\"opaque\"?sr.ReadWrite:sr.ReadOnly),Fe=L.colorModeForRenderPass(),Ve=L.useProgram(We?\"backgroundPattern\":\"background\"),ct=j||Et(Me,{tileSize:Oe,terrain:L.style.map.terrain});We&&(de.activeTexture.set(Te.TEXTURE0),L.imageManager.bind(L.context));let dt=G.getCrossfadeParameters();for(let pt of ct){let ft=Me.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!ce,applyTerrainMatrix:!0}),Xt=We?lc(re,L,We,{tileID:pt,tileSize:Oe},dt):d0(re,ie),Ut=L.style.map.terrain&&L.style.map.terrain.getTerrainData(pt),Bt=Ie.getMeshFromTileID(de,pt.canonical,!1,!0,\"raster\");Ve.draw(de,Te.TRIANGLES,Be,Ge,Fe,Tr.backCCW,Xt,Ut,ft,G.id,Bt.vertexBuffer,Bt.indexBuffer,Bt.segments)}})(l,0,y,w,P):o.cv(y)&&(function(L,z,G,j){let{isRenderingGlobe:Q}=j,ie=L.context,re=G.implementation,ce=L.style.projection,de=L.transform,Te=de.getProjectionDataForCustomLayer(Q),Ie={farZ:de.farZ,nearZ:de.nearZ,fov:de.fov*Math.PI/180,modelViewProjectionMatrix:de.modelViewProjectionMatrix,projectionMatrix:de.projectionMatrix,shaderData:{variantName:ce.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;\nuniform mat4 u_projection_matrix;\n${ce.shaderPreludeCode.vertexSource}`,define:ce.shaderDefine},defaultProjectionData:Te},Me=re.renderingMode?re.renderingMode:\"2d\";if(L.renderPass===\"offscreen\"){let Oe=re.prerender;Oe&&(L.setCustomLayerDefaults(),ie.setColorMode(L.colorModeForRenderPass()),Oe.call(re,ie.gl,Ie),ie.setDirty(),L.setBaseState())}else if(L.renderPass===\"translucent\"){L.setCustomLayerDefaults(),ie.setColorMode(L.colorModeForRenderPass()),ie.setStencilMode(Pr.disabled);let Oe=Me===\"3d\"?L.getDepthModeFor3D():L.getDepthModeForSublayer(0,sr.ReadOnly);ie.setDepthMode(Oe),re.render(ie.gl,Ie),ie.setDirty(),L.setBaseState(),ie.bindFramebuffer.set(null)}})(l,0,y,P))}saveTileTexture(l){let f=this._tileTextures[l.size[0]];f?f.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){let f=this._tileTextures[l];return f&&f.length>0?f.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;let f=this.imageManager.getPattern(l.from.toString()),y=this.imageManager.getPattern(l.to.toString());return!f||!y}useProgram(l,f,y=!1,w=[]){this.cache=this.cache||{};let P=!!this.style.map.terrain,L=this.style.projection,z=y?Kn.projectionMercator:L.shaderPreludeCode,G=y?ia:L.shaderDefine,j=l+(f?f.cacheKey:\"\")+`/${y?nl:L.shaderVariantName}`+(this._showOverdrawInspector?\"/overdraw\":\"\")+(P?\"/terrain\":\"\")+(w?`/${w.join(\"/\")}`:\"\");return this.cache[j]||(this.cache[j]=new Sr(this.context,Kn[l],f,vx[l],this._showOverdrawInspector,P,z,G,w)),this.cache[j]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement(\"canvas\"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var l,f;if(this._tileTextures){for(let y in this._tileTextures){let w=this._tileTextures[y];if(w)for(let P of w)P.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((l=this.tileExtentMesh.vertexBuffer)===null||l===void 0||l.destroy()),this.tileExtentMesh&&((f=this.tileExtentMesh.indexBuffer)===null||f===void 0||f.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(let y in this.cache){let w=this.cache[y];w&&w.program&&this.context.gl.deleteProgram(w.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){let{drawingBufferWidth:l,drawingBufferHeight:f}=this.context.gl;return this.width!==l||this.height!==f}}function Lg(I,l){let f,y=!1,w=null,P=null,L=()=>{w=null,y&&(I.apply(P,f),w=setTimeout(L,l),y=!1)};return(...z)=>(y=!0,P=this,f=z,w||L(),w)}class Fd{constructor(l){this._getCurrentHash=()=>{let f=window.location.hash.replace(\"#\",\"\");if(this._hashName){let y;return f.split(\"&\").map((w=>w.split(\"=\"))).forEach((w=>{w[0]===this._hashName&&(y=w)})),(y&&y[1]||\"\").split(\"/\")}return f.split(\"/\")},this._onHashChange=()=>{let f=this._getCurrentHash();if(!this._isValidHash(f))return!1;let y=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(f[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:y,pitch:+(f[4]||0)}),!0},this._updateHashUnthrottled=()=>{let f=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,f)},this._removeHash=()=>{let f=this._getCurrentHash();if(f.length===0)return;let y=f.join(\"/\"),w=y;w.split(\"&\").length>0&&(w=w.split(\"&\")[0]),this._hashName&&(w=`${this._hashName}=${y}`);let P=window.location.hash.replace(w,\"\");P.startsWith(\"#&\")?P=P.slice(0,1)+P.slice(2):P===\"#\"&&(P=\"\");let L=window.location.href.replace(/(#.+)?$/,P);L=L.replace(\"&&\",\"&\"),window.history.replaceState(window.history.state,null,L)},this._updateHash=Lg(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener(\"hashchange\",this._onHashChange,!1),this._map.on(\"moveend\",this._updateHash),this}remove(){return removeEventListener(\"hashchange\",this._onHashChange,!1),this._map.off(\"moveend\",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(l){let f=this._map.getCenter(),y=Math.round(100*this._map.getZoom())/100,w=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,w),L=Math.round(f.lng*P)/P,z=Math.round(f.lat*P)/P,G=this._map.getBearing(),j=this._map.getPitch(),Q=\"\";if(Q+=l?`/${L}/${z}/${y}`:`${y}/${z}/${L}`,(G||j)&&(Q+=\"/\"+Math.round(10*G)/10),j&&(Q+=`/${Math.round(j)}`),this._hashName){let ie=this._hashName,re=!1,ce=window.location.hash.slice(1).split(\"&\").map((de=>{let Te=de.split(\"=\")[0];return Te===ie?(re=!0,`${Te}=${Q}`):de})).filter((de=>de));return re||ce.push(`${ie}=${Q}`),`#${ce.join(\"&\")}`}return`#${Q}`}_isValidHash(l){if(l.length<3||l.some(isNaN))return!1;try{new o.V(+l[2],+l[1])}catch{return!1}let f=+l[0],y=+(l[3]||0),w=+(l[4]||0);return f>=this._map.getMinZoom()&&f<=this._map.getMaxZoom()&&y>=-180&&y<=180&&w>=this._map.getMinPitch()&&w<=this._map.getMaxPitch()}}let cc={linearity:.3,easing:o.cw(0,0,.3,1)},Ef=o.e({deceleration:2500,maxSpeed:1400},cc),dr=o.e({deceleration:20,maxSpeed:1400},cc),Fl=o.e({deceleration:1e3,maxSpeed:360},cc),Og=o.e({deceleration:1e3,maxSpeed:90},cc),ol=o.e({deceleration:1e3,maxSpeed:360},cc);class Tx{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:k(),settings:l})}_drainInertiaBuffer(){let l=this._inertiaBuffer,f=k();for(;l.length>0&&f-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let f={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:P}of this._inertiaBuffer)f.zoom+=P.zoomDelta||0,f.bearing+=P.bearingDelta||0,f.pitch+=P.pitchDelta||0,f.roll+=P.rollDelta||0,P.panDelta&&f.pan._add(P.panDelta),P.around&&(f.around=P.around),P.pinchAround&&(f.pinchAround=P.pinchAround);let y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(f.pan.mag()){let P=Nd(f.pan.mag(),y,o.e({},Ef,l||{})),L=f.pan.mult(P.amount/f.pan.mag()),z=this._map.cameraHelper.handlePanInertia(L,this._map.transform);w.center=z.easingCenter,w.offset=z.easingOffset,kd(w,P)}if(f.zoom){let P=Nd(f.zoom,y,dr),L=o.cx(this._map.transform.zoom+P.amount,this._map.getZoomSnap(),P.amount);w.zoom=L,kd(w,P)}if(f.bearing){let P=Nd(f.bearing,y,Fl);w.bearing=this._map.transform.bearing+o.an(P.amount,-179,179),kd(w,P)}if(f.pitch){let P=Nd(f.pitch,y,Og);w.pitch=this._map.transform.pitch+P.amount,kd(w,P)}if(f.roll){let P=Nd(f.roll,y,ol);w.roll=this._map.transform.roll+o.an(P.amount,-179,179),kd(w,P)}if(w.zoom||w.bearing){let P=f.pinchAround===void 0?f.around:f.pinchAround;w.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),o.e(w,{noMoveStart:!0})}}function kd(I,l){(!I.duration||I.duration<l.duration)&&(I.duration=l.duration,I.easing=l.easing)}function Nd(I,l,f){let{maxSpeed:y,linearity:w,deceleration:P}=f,L=o.an(I*w/(l/1e3),-y,y),z=Math.abs(L)/(P*w);return{easing:f.easing,duration:1e3*z,amount:L*(z/2)}}class es extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,y,w={}){y=y instanceof MouseEvent?y:new MouseEvent(l,y);let P=V.mousePos(f.getCanvas(),y),L=f.unproject(P);super(l,o.e({point:P,lngLat:L,originalEvent:y},w)),this._defaultPrevented=!1,this.target=f}}class ts extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,y){let w=l===\"touchend\"?y.changedTouches:y.touches,P=V.touchPos(f.getCanvasContainer(),w),L=P.map((G=>f.unproject(G))),z=P.reduce(((G,j,Q,ie)=>G.add(j.div(ie.length))),new o.P(0,0));super(l,{points:P,point:z,lngLats:L,lngLat:f.unproject(z),originalEvent:y}),this._defaultPrevented=!1}}class C0 extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,y){super(l,{originalEvent:y}),this._defaultPrevented=!1}}class Rh{constructor(l,f){this._map=l,this._clickTolerance=f.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new C0(l.type,this._map,l))}mousedown(l,f){return this._mousedownPos=f,this._firePreventable(new es(l.type,this._map,l))}mouseup(l){this._map.fire(new es(l.type,this._map,l))}click(l,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new es(l.type,this._map,l))}dblclick(l){return this._firePreventable(new es(l.type,this._map,l))}mouseover(l){this._map.fire(new es(l.type,this._map,l))}mouseout(l){this._map.fire(new es(l.type,this._map,l))}touchstart(l){return this._firePreventable(new ts(l.type,this._map,l))}touchmove(l){this._map.fire(new ts(l.type,this._map,l))}touchend(l){this._map.fire(new ts(l.type,this._map,l))}touchcancel(l){this._map.fire(new ts(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ex{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new es(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new es(\"contextmenu\",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new es(l.type,this._map,l)),this._map.listens(\"contextmenu\")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Su{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.screenPointToLocation(o.P.convert(l),this._map.terrain)}}class Sf{constructor(l,f){this._map=l,this._tr=new Su(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,f){this.isEnabled()&&l.shiftKey&&l.button===0&&(V.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(l,f){if(!this._active)return;let y=f;if(this._lastPos.equals(y)||!this._box&&y.dist(this._startPos)<this._clickTolerance)return;let w=this._startPos;this._lastPos=y,this._box||(this._box=V.create(\"div\",\"maplibregl-boxzoom\",this._container),this._container.classList.add(\"maplibregl-crosshair\"),this._fireEvent(\"boxzoomstart\",l));let P=Math.min(w.x,y.x),L=Math.max(w.x,y.x),z=Math.min(w.y,y.y),G=Math.max(w.y,y.y);V.setTransform(this._box,`translate(${P}px,${z}px)`),this._box.style.width=L-P+\"px\",this._box.style.height=G-z+\"px\"}mouseupWindow(l,f){if(!this._active||l.button!==0)return;let y=this._startPos,w=f;if(this.reset(),V.suppressClick(),y.x!==w.x||y.y!==w.y)return this._map.fire(new o.l(\"boxzoomend\",{originalEvent:l})),{cameraAnimation:P=>P.fitScreenCoordinates(y,w,this._tr.bearing,{linear:!0})};this._fireEvent(\"boxzoomcancel\",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent(\"boxzoomcancel\",l))}reset(){this._active=!1,this._container.classList.remove(\"maplibregl-crosshair\"),this._box&&(V.remove(this._box),this._box=null),V.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,f){return this._map.fire(new o.l(l,{originalEvent:f}))}}function ho(I,l){if(I.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${I.length}, points ${l.length}`);let f={};for(let y=0;y<I.length;y++)f[I[y].identifier]=l[y];return f}class un{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,f,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),y.length===this.numTouches&&(this.centroid=(function(w){let P=new o.P(0,0);for(let L of w)P._add(L);return P.div(w.length)})(f),this.touches=ho(y,f)))}touchmove(l,f,y){if(this.aborted||!this.centroid)return;let w=ho(y,f);for(let P in this.touches){let L=w[P];(!L||L.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(l,f,y){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){let w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class Cf{constructor(l){this.singleTap=new un(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,f,y){this.singleTap.touchstart(l,f,y)}touchmove(l,f,y){this.singleTap.touchmove(l,f,y)}touchend(l,f,y){let w=this.singleTap.touchend(l,f,y);if(w){let P=l.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(w)<30;if(P&&L||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class Cu{constructor(l){this._tr=new Su(l),this._zoomIn=new Cf({numTouches:1,numTaps:2}),this._zoomOut=new Cf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,f,y){this._zoomIn.touchstart(l,f,y),this._zoomOut.touchstart(l,f,y)}touchmove(l,f,y){this._zoomIn.touchmove(l,f,y),this._zoomOut.touchmove(l,f,y)}touchend(l,f,y){let w=this._zoomIn.touchend(l,f,y),P=this._zoomOut.touchend(l,f,y),L=this._tr;return w?(this._active=!0,l.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:o.cx(L.zoom+1,z.getZoomSnap()),around:L.unproject(w)},{originalEvent:l})}):P?(this._active=!0,l.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:o.cx(L.zoom-1,z.getZoomSnap()),around:L.unproject(P)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sl{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(...l){let f=this._moveFunction(...l);if(f.bearingDelta||f.pitchDelta||f.rollDelta||f.around||f.panDelta)return this._active=!0,f}dragStart(l,f){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=Array.isArray(f)?f[0]:f,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,f){if(!this.isEnabled())return;let y=this._lastPoint;if(!y)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);let w=Array.isArray(f)?f[0]:f;return!this._moved&&w.dist(y)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=w,this._move(y,w))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&V.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let uc=0,zd=2,M0={[uc]:1,[zd]:2};class Ud{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){let f=V.mouseButton(l);this._eventButton=f}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!(function(f,y){let w=M0[y];return f.buttons===void 0||(f.buttons&w)!==w})(l,this._eventButton)}isValidEndEvent(l){return V.mouseButton(l)===this._eventButton}}class Vd{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}class Y_{constructor(l=new Ud({checkCorrectEvent:()=>!0}),f=new Vd){this.mouseMoveStateManager=l,this.oneFingerTouchMoveStateManager=f}_executeRelevantHandler(l,f,y){return l instanceof MouseEvent?f(l):typeof TouchEvent<\"u\"&&l instanceof TouchEvent?y(l):void 0}startMove(l){this._executeRelevantHandler(l,(f=>this.mouseMoveStateManager.startMove(f)),(f=>this.oneFingerTouchMoveStateManager.startMove(f)))}endMove(l){this._executeRelevantHandler(l,(f=>this.mouseMoveStateManager.endMove(f)),(f=>this.oneFingerTouchMoveStateManager.endMove(f)))}isValidStartEvent(l){return this._executeRelevantHandler(l,(f=>this.mouseMoveStateManager.isValidStartEvent(f)),(f=>this.oneFingerTouchMoveStateManager.isValidStartEvent(f)))}isValidMoveEvent(l){return this._executeRelevantHandler(l,(f=>this.mouseMoveStateManager.isValidMoveEvent(f)),(f=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(f)))}isValidEndEvent(l){return this._executeRelevantHandler(l,(f=>this.mouseMoveStateManager.isValidEndEvent(f)),(f=>this.oneFingerTouchMoveStateManager.isValidEndEvent(f)))}}let Mf=I=>{I.mousedown=I.dragStart,I.mousemoveWindow=I.dragMove,I.mouseup=I.dragEnd,I.contextmenu=l=>{l.preventDefault()}};class Fg{constructor(l,f){this._clickTolerance=l.clickTolerance||1,this._map=f,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(l){return l<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(l,f,y){return this._calculateTransform(l,f,y)}touchmove(l,f,y){if(this._active){if(!this._shouldBePrevented(y.length))return l.preventDefault(),this._calculateTransform(l,f,y);this._map.cooperativeGestures.notifyGestureBlocked(\"touch_pan\",l)}}touchend(l,f,y){this._calculateTransform(l,f,y),this._active&&this._shouldBePrevented(y.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,f,y){y.length>0&&(this._active=!0);let w=ho(y,f),P=new o.P(0,0),L=new o.P(0,0),z=0;for(let j in w){let Q=w[j],ie=this._touches[j];ie&&(P._add(Q),L._add(Q.sub(ie)),z++,w[j]=Q)}if(this._touches=w,this._shouldBePrevented(z)||!L.mag())return;let G=L.div(z);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(z),panDelta:G}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gd{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,f,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([f[0],f[1]]))}touchmove(l,f,y){if(!this._firstTwoTouches)return;l.preventDefault();let[w,P]=this._firstTwoTouches,L=If(y,f,w),z=If(y,f,P);if(!L||!z)return;let G=this._aroundCenter?null:L.add(z).div(2);return this._move([L,z],G,l)}touchend(l,f,y){if(!this._firstTwoTouches)return;let[w,P]=this._firstTwoTouches,L=If(y,f,w),z=If(y,f,P);L&&z||(this._active&&V.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around===\"center\"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function If(I,l,f){for(let y=0;y<I.length;y++)if(I[y].identifier===f)return l[y]}function Pf(I,l){return Math.log(I/l)/Math.LN2}class Mu extends Gd{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,f){let y=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Pf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Pf(this._distance,y),pinchAround:f}}}function ca(I,l){return 180*I.angleWith(l)/Math.PI}class kg extends Gd{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,f,y){let w=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ca(this._vector,w),pinchAround:f}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());let f=25/(Math.PI*this._minDiameter)*360,y=ca(l,this._startVector);return Math.abs(y)<f}}function Bh(I){return Math.abs(I.y)>Math.abs(I.x)}class Z_ extends Gd{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,f,y){super.touchstart(l,f,y),this._currentTouchCount=y.length}_start(l){this._lastPoints=l,Bh(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,f,y){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let w=l[0].sub(this._lastPoints[0]),P=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(w,P,y.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(w.y+P.y)/2*-.5}):void 0}gestureBeginsVertically(l,f,y){if(this._valid!==void 0)return this._valid;let w=l.mag()>=2,P=f.mag()>=2;if(!w&&!P)return;if(!w||!P)return this._firstMove===void 0&&(this._firstMove=y),y-this._firstMove<100&&void 0;let L=l.y>0==f.y>0;return Bh(l)&&Bh(f)&&L}}let Iu={panStep:100,bearingStep:15,pitchStep:10};class ci{constructor(l){this._tr=new Su(l);let f=Iu;this._panStep=f.panStep,this._bearingStep=f.bearingStep,this._pitchStep=f.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let f=0,y=0,w=0,P=0,L=0;switch(l.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:l.shiftKey?y=-1:(l.preventDefault(),P=-1);break;case 39:l.shiftKey?y=1:(l.preventDefault(),P=1);break;case 38:l.shiftKey?w=1:(l.preventDefault(),L=-1);break;case 40:l.shiftKey?w=-1:(l.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(y=0,w=0),{cameraAnimation:z=>{let G=this._tr;z.easeTo({duration:300,easeId:\"keyboardHandler\",easing:q_,zoom:f?o.cx(G.zoom+f*(l.shiftKey?2:1),z.getZoomSnap()):G.zoom,bearing:G.bearing+y*this._bearingStep,pitch:G.pitch+w*this._pitchStep,offset:[-P*this._panStep,-L*this._panStep],center:G.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function q_(I){return I*(2-I)}let Hd=4.000244140625,I0=1/450;class P0{constructor(l,f){this._onTimeout=y=>{this._type=\"wheel\",this._delta-=this._lastValue,this._active||this._start(y)},this._map=l,this._tr=new Su(l),this._triggerRenderFrame=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=I0}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around===\"center\")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(l){return!!this._map.cooperativeGestures.isEnabled()&&!(l.ctrlKey||this._map.cooperativeGestures.isBypassed(l))}wheel(l){if(!this.isEnabled())return;if(this._shouldBePrevented(l))return void this._map.cooperativeGestures.notifyGestureBlocked(\"wheel_zoom\",l);let f=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,y=k(),w=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,f!==0&&f%Hd==0?this._type=\"wheel\":f!==0&&Math.abs(f)<4?this._type=\"trackpad\":w>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(w*f)<200?\"trackpad\":\"wheel\",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),l.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=l,this._delta-=f,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let f=V.mousePos(this._map.getCanvas(),l),y=this._tr;this._aroundPoint=this._aroundCenter?y.transform.locationToScreenPoint(o.V.convert(y.center)):f,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let l=this._tr.transform;if(typeof this._lastExpectedZoom==\"number\"){let z=l.zoom-this._lastExpectedZoom;typeof this._startZoom==\"number\"&&(this._startZoom+=z),typeof this._targetZoom==\"number\"&&(this._targetZoom+=z)}if(this._delta!==0){let z=this._type===\"wheel\"&&Math.abs(this._delta)>Hd?this._wheelZoomRate:this._defaultZoomRate,G=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&G!==0&&(G=1/G);let j=typeof this._targetZoom!=\"number\"?l.scale:o.aq(this._targetZoom),Q=l.applyConstrain(l.getCameraLngLat(),o.at(j*G)).zoom,ie=this._map.getZoomSnap();if(this._type===\"wheel\"&&ie>0){let re=o.cx(l.zoom,ie);this._targetZoom=o.cx(Q,ie,Q-re)}else this._targetZoom=Q;this._type===\"wheel\"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let f=typeof this._targetZoom!=\"number\"?l.zoom:this._targetZoom,y=this._startZoom,w=this._easing,P,L=!1;if(this._type===\"wheel\"&&y&&w){let z=k()-this._lastWheelEventTime,G=Math.min((z+5)/200,1),j=w(G);P=o.G.number(y,f,j),G<1?this._frameId||(this._frameId=!0):L=!0}else P=f,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=P,{noInertia:!0,needsRenderFrame:!L,zoomDelta:P-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let f=o.cz;if(this._prevEase){let y=this._prevEase,w=(k()-y.start)/y.duration,P=y.easing(w+.01)-y.easing(w),L=.27/Math.sqrt(P*P+1e-4)*.01,z=Math.sqrt(.0729-L*L);f=o.cw(L,z,.25,1)}return this._prevEase={start:k(),duration:l,easing:f},f}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Rf{constructor(l,f){this._clickZoom=l,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ng{constructor(l){this._tr=new Su(l),this.reset()}reset(){this._active=!1}dblclick(l,f){return l.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:o.cx(this._tr.zoom+(l.shiftKey?-1:1),y.getZoomSnap()),around:this._tr.unproject(f)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class R0{constructor(){this._tap=new Cf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,f,y){if(!this._swipePoint)if(this._tapTime){let w=f[0],P=l.timeStamp-this._tapTime<500,L=this._tapPoint.dist(w)<30;P&&L?y.length>0&&(this._swipePoint=w,this._swipeTouch=y[0].identifier):this.reset()}else this._tap.touchstart(l,f,y)}touchmove(l,f,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;let w=f[0],P=w.y-this._swipePoint.y;return this._swipePoint=w,l.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(l,f,y)}touchend(l,f,y){if(this._tapTime)this._swipePoint&&y.length===0&&this.reset();else{let w=this._tap.touchend(l,f,y);w&&(this._tapTime=l.timeStamp,this._tapPoint=w)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Q_{constructor(l,f,y){this._el=l,this._mousePan=f,this._touchPan=y}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add(\"maplibregl-touch-drag-pan\")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove(\"maplibregl-touch-drag-pan\")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class kl{constructor(l,f,y,w){this._pitchWithRotate=l.pitchWithRotate,this._rollEnabled=l.rollEnabled,this._mouseRotate=f,this._mousePitch=y,this._mouseRoll=w}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Wd{constructor(l,f,y,w){this._el=l,this._touchZoom=f,this._touchRotate=y,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add(\"maplibregl-touch-zoom-rotate\")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove(\"maplibregl-touch-zoom-rotate\")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class yn{constructor(l,f){this._bypassKey=navigator.userAgent.indexOf(\"Mac\")!==-1?\"metaKey\":\"ctrlKey\",this._map=l,this._options=f,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let l=this._map.getCanvasContainer();l.classList.add(\"maplibregl-cooperative-gestures\"),this._container=V.create(\"div\",\"maplibregl-cooperative-gesture-screen\",l);let f=this._map._getUIString(\"CooperativeGesturesHandler.WindowsHelpText\");this._bypassKey===\"metaKey\"&&(f=this._map._getUIString(\"CooperativeGesturesHandler.MacHelpText\"));let y=this._map._getUIString(\"CooperativeGesturesHandler.MobileHelpText\"),w=document.createElement(\"div\");w.className=\"maplibregl-desktop-message\",w.textContent=f,this._container.appendChild(w);let P=document.createElement(\"div\");P.className=\"maplibregl-mobile-message\",P.textContent=y,this._container.appendChild(P),this._container.setAttribute(\"aria-hidden\",\"true\")}_destroyUI(){this._container&&(V.remove(this._container),this._map.getCanvasContainer().classList.remove(\"maplibregl-cooperative-gestures\")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(l){return l[this._bypassKey]}notifyGestureBlocked(l,f){this._enabled&&(this._map.fire(new o.l(\"cooperativegestureprevented\",{gestureType:l,originalEvent:f})),this._container.classList.add(\"maplibregl-show\"),setTimeout((()=>{this._container.classList.remove(\"maplibregl-show\")}),100))}}let Rn=I=>I.zoom||I.drag||I.roll||I.pitch||I.rotate;class jd extends o.l{}function B0(I){return I.panDelta&&I.panDelta.mag()||I.zoomDelta||I.bearingDelta||I.pitchDelta||I.rollDelta}class Xd{get _ownerDocument(){var l;return((l=this._el)===null||l===void 0?void 0:l.ownerDocument)||document}get _ownerWindow(){var l,f;return((f=(l=this._el)===null||l===void 0?void 0:l.ownerDocument)===null||f===void 0?void 0:f.defaultView)||window}constructor(l,f){this.handleWindowEvent=w=>{this.handleEvent(w,`${w.type}Window`)},this.handleEvent=(w,P)=>{if(w.type===\"blur\")return void this.stop(!0);this._updatingCamera=!0;let L=w.type===\"renderFrame\"?void 0:w,z={needsRenderFrame:!1},G={},j={};for(let{handlerName:re,handler:ce,allowed:de}of this._handlers){if(!ce.isEnabled())continue;let Te;if(this._blockedByActive(j,de,re))ce.reset();else if(ce[P||w.type]){if(o.cA(w,P||w.type)){let Ie=V.mousePos(this._map.getCanvas(),w);Te=ce[P||w.type](w,Ie)}else if(o.cB(w,P||w.type)){let Ie=this._getMapTouches(w.touches),Me=V.touchPos(this._map.getCanvas(),Ie);Te=ce[P||w.type](w,Me,Ie)}else o.cC(P||w.type)||(Te=ce[P||w.type](w));this.mergeHandlerResult(z,G,Te,re,L),Te&&Te.needsRenderFrame&&this._triggerRenderFrame()}(Te||ce.isActive())&&(j[re]=ce)}let Q={};for(let re in this._previousActiveHandlers)j[re]||(Q[re]=L);this._previousActiveHandlers=j,(Object.keys(Q).length||B0(z))&&(this._changes.push([z,G,Q]),this._triggerRenderFrame()),(Object.keys(j).length||B0(z))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:ie}=z;ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ie(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Tx(l),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f);let y=this._el;this._listeners=[[y,\"touchstart\",{passive:!0}],[y,\"touchmove\",{passive:!1}],[y,\"touchend\",void 0],[y,\"touchcancel\",void 0],[y,\"mousedown\",void 0],[y,\"mousemove\",void 0],[y,\"mouseup\",void 0],[this._ownerDocument,\"mousemove\",{capture:!0}],[this._ownerDocument,\"mouseup\",void 0],[y,\"mouseover\",void 0],[y,\"mouseout\",void 0],[y,\"dblclick\",void 0],[y,\"click\",void 0],[y,\"keydown\",{capture:!1}],[y,\"keyup\",void 0],[y,\"wheel\",{passive:!1}],[y,\"contextmenu\",void 0],[this._ownerWindow,\"blur\",void 0]];for(let[w,P,L]of this._listeners)V.addEventListener(w,P,w===this._ownerDocument?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(let[l,f,y]of this._listeners)V.removeEventListener(l,f,l===this._ownerDocument?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(l){let f=this._map,y=f.getCanvasContainer();this._add(\"mapEvent\",new Rh(f,l));let w=f.boxZoom=new Sf(f,l);this._add(\"boxZoom\",w),l.interactive&&l.boxZoom&&w.enable();let P=f.cooperativeGestures=new yn(f,l.cooperativeGestures);this._add(\"cooperativeGestures\",P),l.cooperativeGestures&&P.enable();let L=new Cu(f),z=new Ng(f);f.doubleClickZoom=new Rf(z,L),this._add(\"tapZoom\",L),this._add(\"clickZoom\",z),l.interactive&&l.doubleClickZoom&&f.doubleClickZoom.enable();let G=new R0;this._add(\"tapDragZoom\",G);let j=f.touchPitch=new Z_(f);this._add(\"touchPitch\",j),l.interactive&&l.touchPitch&&f.touchPitch.enable(l.touchPitch);let Q=()=>f.project(f.getCenter()),ie=(function({enable:De,clickTolerance:Ge,aroundCenter:Be=!0,minPixelCenterThreshold:Fe=100,rotateDegreesPerPixelMoved:Ve=.8},ct){let dt=new Ud({checkCorrectEvent:pt=>V.mouseButton(pt)===0&&pt.ctrlKey||V.mouseButton(pt)===2&&!pt.ctrlKey});return new sl({clickTolerance:Ge,move:(pt,ft)=>{let Xt=ct();if(Be&&Math.abs(Xt.y-pt.y)>Fe)return{bearingDelta:o.cy(new o.P(pt.x,ft.y),ft,Xt)};let Ut=(ft.x-pt.x)*Ve;return Be&&ft.y<Xt.y&&(Ut=-Ut),{bearingDelta:Ut}},moveStateManager:dt,enable:De,assignEvents:Mf})})(l,Q),re=(function({enable:De,clickTolerance:Ge,pitchDegreesPerPixelMoved:Be=-.5}){let Fe=new Ud({checkCorrectEvent:Ve=>V.mouseButton(Ve)===0&&Ve.ctrlKey||V.mouseButton(Ve)===2});return new sl({clickTolerance:Ge,move:(Ve,ct)=>({pitchDelta:(ct.y-Ve.y)*Be}),moveStateManager:Fe,enable:De,assignEvents:Mf})})(l),ce=(function({enable:De,clickTolerance:Ge,rollDegreesPerPixelMoved:Be=.3},Fe){let Ve=new Ud({checkCorrectEvent:ct=>V.mouseButton(ct)===2&&ct.ctrlKey});return new sl({clickTolerance:Ge,move:(ct,dt)=>{let pt=Fe(),ft=(dt.x-ct.x)*Be;return dt.y<pt.y&&(ft=-ft),{rollDelta:ft}},moveStateManager:Ve,enable:De,assignEvents:Mf})})(l,Q);f.dragRotate=new kl(l,ie,re,ce),this._add(\"mouseRotate\",ie,[\"mousePitch\"]),this._add(\"mousePitch\",re,[\"mouseRotate\",\"mouseRoll\"]),this._add(\"mouseRoll\",ce,[\"mousePitch\"]),l.interactive&&l.dragRotate&&f.dragRotate.enable();let de=(function({enable:De,clickTolerance:Ge}){let Be=new Ud({checkCorrectEvent:Fe=>V.mouseButton(Fe)===0&&!Fe.ctrlKey});return new sl({clickTolerance:Ge,move:(Fe,Ve)=>({around:Ve,panDelta:Ve.sub(Fe)}),activateOnStart:!0,moveStateManager:Be,enable:De,assignEvents:Mf})})(l),Te=new Fg(l,f);f.dragPan=new Q_(y,de,Te),this._add(\"mousePan\",de),this._add(\"touchPan\",Te,[\"touchZoom\",\"touchRotate\"]),l.interactive&&l.dragPan&&f.dragPan.enable(l.dragPan);let Ie=new kg,Me=new Mu;f.touchZoomRotate=new Wd(y,Me,Ie,G),this._add(\"touchRotate\",Ie,[\"touchPan\",\"touchZoom\"]),this._add(\"touchZoom\",Me,[\"touchPan\",\"touchRotate\"]),l.interactive&&l.touchZoomRotate&&f.touchZoomRotate.enable(l.touchZoomRotate),this._add(\"blockableMapEvent\",new Ex(f));let Oe=f.scrollZoom=new P0(f,(()=>this._triggerRenderFrame()));this._add(\"scrollZoom\",Oe,[\"mousePan\"]),l.interactive&&l.scrollZoom&&f.scrollZoom.enable(l.scrollZoom);let We=f.keyboard=new ci(f);this._add(\"keyboard\",We),l.interactive&&l.keyboard&&f.keyboard.enable()}_add(l,f,y){this._handlers.push({handlerName:l,handler:f,allowed:y}),this._handlersById[l]=f}stop(l){if(!this._updatingCamera){for(let{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(let{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Rn(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,f,y){for(let w in l)if(w!==y&&(!f||f.indexOf(w)<0))return!0;return!1}_getMapTouches(l){let f=[];for(let y of l)this._el.contains(y.target)&&f.push(y);return f}mergeHandlerResult(l,f,y,w,P){if(!y)return;o.e(l,y);let L={handlerName:w,originalEvent:y.originalEvent||P};y.zoomDelta!==void 0&&(f.zoom=L),y.panDelta!==void 0&&(f.drag=L),y.rollDelta!==void 0&&(f.roll=L),y.pitchDelta!==void 0&&(f.pitch=L),y.bearingDelta!==void 0&&(f.rotate=L)}_applyChanges(){let l={},f={},y={};for(let[w,P,L]of this._changes)w.panDelta&&(l.panDelta=(l.panDelta||new o.P(0,0))._add(w.panDelta)),w.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+w.pitchDelta),w.rollDelta&&(l.rollDelta=(l.rollDelta||0)+w.rollDelta),w.around!==void 0&&(l.around=w.around),w.pinchAround!==void 0&&(l.pinchAround=w.pinchAround),w.noInertia&&(l.noInertia=w.noInertia),o.e(f,P),o.e(y,L);this._updateMapTransform(l,f,y),this._changes=[]}_updateMapTransform(l,f,y){let w=this._map,P=w._getTransformForUpdate(),L=w.terrain;if(!(B0(l)||L&&this._terrainMovement))return this._fireEvents(f,y,!0);w._stop(!0);let{panDelta:z,zoomDelta:G,bearingDelta:j,pitchDelta:Q,rollDelta:ie,around:re,pinchAround:ce}=l;ce!==void 0&&(re=ce),re=re||w.transform.centerPoint,L&&!P.isPointOnMapSurface(re)&&(re=P.centerPoint);let de={panDelta:z,zoomDelta:G,rollDelta:ie,pitchDelta:Q,bearingDelta:j,around:re};this._map.cameraHelper.useGlobeControls&&!P.isPointOnMapSurface(re)&&(re=P.centerPoint);let Te=re.distSqr(P.centerPoint)<.01?P.center:P.screenPointToLocation(z?re.sub(z):re);this._handleMapControls({terrain:L,tr:P,deltasForHelper:de,preZoomAroundLoc:Te,combinedEventsInProgress:f,panDelta:z}),w._applyUpdatedTransform(P),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(f,y,!0)}_handleMapControls({terrain:l,tr:f,deltasForHelper:y,preZoomAroundLoc:w,combinedEventsInProgress:P,panDelta:L}){let z=this._map.cameraHelper;if(z.handleMapControlsRollPitchBearingZoom(y,f),l)return z.useGlobeControls?(this._terrainMovement||!P.drag&&!P.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void z.handleMapControlsPan(y,f,w)):this._terrainMovement||!P.drag&&!P.zoom?void(P.drag&&this._terrainMovement&&L?f.setCenter(f.screenPointToLocation(f.centerPoint.sub(L))):z.handleMapControlsPan(y,f,w)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void z.handleMapControlsPan(y,f,w));z.handleMapControlsPan(y,f,w)}_fireEvents(l,f,y){let w=Rn(this._eventsInProgress),P=Rn(l),L={};for(let ie in l){let{originalEvent:re}=l[ie];this._eventsInProgress[ie]||(L[`${ie}start`]=re),this._eventsInProgress[ie]=l[ie]}!w&&P&&this._fireEvent(\"movestart\",P.originalEvent);for(let ie in L)this._fireEvent(ie,L[ie]);P&&this._fireEvent(\"move\",P.originalEvent);for(let ie in l){let{originalEvent:re}=l[ie];this._fireEvent(ie,re)}let z={},G;for(let ie in this._eventsInProgress){let{handlerName:re,originalEvent:ce}=this._eventsInProgress[ie];this._handlersById[re].isActive()||(delete this._eventsInProgress[ie],G=f[re]||ce,z[`${ie}end`]=G)}for(let ie in z)this._fireEvent(ie,z[ie]);let j=Rn(this._eventsInProgress),Q=(w||P)&&!j;if(Q&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;let ie=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&ie.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(ie)}if(y&&Q){this._updatingCamera=!0;let ie=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),re=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;!ie||!ie.essential&&C.prefersReducedMotion?(this._map.fire(new o.l(\"moveend\",{originalEvent:G})),re(this._map.getBearing())&&this._map.resetNorth()):(re(ie.bearing||this._map.getBearing())&&(ie.bearing=0),ie.freezeElevation=!0,this._map.easeTo(ie,{originalEvent:G})),this._updatingCamera=!1}}_fireEvent(l,f){this._map.fire(new o.l(l,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((l=>{delete this._frameId,this.handleEvent(new jd(\"renderFrame\",{timeStamp:l})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class qs extends o.E{constructor(l,f,y){super(),this._renderFrameCallback=()=>{let w=Math.min((k()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(w)),w<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=y.bearingSnap,this._zoomSnap=y.zoomSnap,this.cameraHelper=f,this.on(\"moveend\",(()=>{delete this._requestedCameraState}))}migrateProjection(l,f){l.apply(this.transform,!0),this.transform=l,this.cameraHelper=f}getCenter(){return new o.V(this.transform.center.lng,this.transform.center.lat)}setCenter(l,f){return this.jumpTo({center:l},f)}getCenterElevation(){return this.transform.elevation}setCenterElevation(l,f){return this.jumpTo({elevation:l},f),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(l){this._centerClampedToGround=l}panBy(l,f,y){return l=o.P.convert(l).mult(-1),this.panTo(this.transform.center,o.e({offset:l},f),y)}panTo(l,f,y){return this.easeTo(o.e({center:l},f),y)}getZoom(){return this.transform.zoom}setZoom(l,f){return this.jumpTo({zoom:l},f),this}zoomTo(l,f,y){return this.easeTo(o.e({zoom:l},f),y)}zoomIn(l,f){return this.zoomTo(o.cx(this.getZoom()+1,this._zoomSnap),l,f),this}zoomOut(l,f){return this.zoomTo(o.cx(this.getZoom()-1,this._zoomSnap),l,f),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(l,f){return l!=this.transform.fov&&(this.transform.setFov(l),this.fire(new o.l(\"movestart\",f)).fire(new o.l(\"move\",f)).fire(new o.l(\"moveend\",f))),this}getBearing(){return this.transform.bearing}setZoomSnap(l){return this._zoomSnap=l,this}getZoomSnap(){return this._zoomSnap}setBearing(l,f){return this.jumpTo({bearing:l},f),this}getPadding(){return this.transform.padding}setPadding(l,f){return this.jumpTo({padding:l},f),this}rotateTo(l,f,y){return this.easeTo(o.e({bearing:l},f),y)}resetNorth(l,f){return this.rotateTo(0,o.e({duration:1e3},l),f),this}resetNorthPitch(l,f){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},l),f),this}snapToNorth(l,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,f):this}getPitch(){return this.transform.pitch}setPitch(l,f){return this.jumpTo({pitch:l},f),this}getRoll(){return this.transform.roll}setRoll(l,f){return this.jumpTo({roll:l},f),this}cameraForBounds(l,f){l=mr.convert(l).adjustAntiMeridian();let y=f&&f.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),y,f)}_cameraForBoxAndBearing(l,f,y,w){let P={top:0,bottom:0,right:0,left:0};if(typeof(w=o.e({padding:P,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding==\"number\"){let j=w.padding;w.padding={top:j,bottom:j,right:j,left:j}}let L=o.e(P,w.padding);w.padding=L;let z=this.transform,G=new mr(l,f);return this.cameraHelper.cameraForBoxAndBearing(w,L,G,y,z)}fitBounds(l,f,y){return this._fitInternal(this.cameraForBounds(l,f),f,y)}fitScreenCoordinates(l,f,y,w,P){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(l)),this.transform.screenPointToLocation(o.P.convert(f)),y,w),w,P)}_fitInternal(l,f,y){return l?(delete(f=o.e(l,f)).padding,f.linear?this.easeTo(f,y):this.flyTo(f,y)):this}jumpTo(l,f){this.stop();let y=this._getTransformForUpdate(),w=!1,P=!1,L=!1,z=y.zoom;this.cameraHelper.handleJumpToCenterZoom(y,l);let G=y.zoom!==z;return\"elevation\"in l&&y.elevation!==+l.elevation&&y.setElevation(+l.elevation),\"bearing\"in l&&y.bearing!==+l.bearing&&(w=!0,y.setBearing(+l.bearing)),\"pitch\"in l&&y.pitch!==+l.pitch&&(P=!0,y.setPitch(+l.pitch)),\"roll\"in l&&y.roll!==+l.roll&&(L=!0,y.setRoll(+l.roll)),l.padding==null||y.isPaddingEqual(l.padding)||y.setPadding(l.padding),this._applyUpdatedTransform(y),this.fire(new o.l(\"movestart\",f)).fire(new o.l(\"move\",f)),G&&this.fire(new o.l(\"zoomstart\",f)).fire(new o.l(\"zoom\",f)).fire(new o.l(\"zoomend\",f)),w&&this.fire(new o.l(\"rotatestart\",f)).fire(new o.l(\"rotate\",f)).fire(new o.l(\"rotateend\",f)),P&&this.fire(new o.l(\"pitchstart\",f)).fire(new o.l(\"pitch\",f)).fire(new o.l(\"pitchend\",f)),L&&this.fire(new o.l(\"rollstart\",f)).fire(new o.l(\"roll\",f)).fire(new o.l(\"rollend\",f)),this.fire(new o.l(\"moveend\",f))}calculateCameraOptionsFromTo(l,f,y,w=0){let P=o.a9.fromLngLat(l,f),L=o.a9.fromLngLat(y,w),z=L.x-P.x,G=L.y-P.y,j=L.z-P.z,Q=Math.hypot(z,G,j);if(Q===0)throw new Error(\"Can't calculate camera options with same From and To\");let ie=Math.hypot(z,G),re=o.at(this.transform.cameraToCenterDistance/Q/this.transform.tileSize),ce=180*Math.atan2(z,-G)/Math.PI,de=180*Math.acos(ie/Q)/Math.PI;return de=j<0?90-de:90+de,{center:L.toLngLat(),elevation:w,zoom:re,pitch:de,bearing:ce}}calculateCameraOptionsFromCameraLngLatAltRotation(l,f,y,w,P){let L=this.transform.calculateCenterFromCameraLngLatAlt(l,f,y,w);return{center:L.center,elevation:L.elevation,zoom:L.zoom,bearing:y,pitch:w,roll:P}}easeTo(l,f){this._stop(!1,l.easeId),((l=o.e({offset:[0,0],duration:500,easing:o.cz},l)).animate===!1||!l.essential&&C.prefersReducedMotion)&&(l.duration=0);let y=this._getTransformForUpdate(),w=this.getBearing(),P=y.pitch,L=y.roll,z=\"bearing\"in l?this._normalizeBearing(l.bearing,w):w,G=\"pitch\"in l?+l.pitch:P,j=\"roll\"in l?this._normalizeBearing(l.roll,L):L,Q=\"padding\"in l?l.padding:y.padding,ie=o.P.convert(l.offset),re,ce;l.around&&(re=o.V.convert(l.around),ce=y.locationToScreenPoint(re));let de={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Te=this.cameraHelper.handleEaseTo(y,{bearing:z,pitch:G,roll:j,padding:Q,around:re,aroundPoint:ce,offsetAsPoint:ie,offset:l.offset,zoom:l.zoom,center:l.center});return this._rotating=this._rotating||w!==z,this._pitching=this._pitching||G!==P,this._rolling=this._rolling||j!==L,this._padding=!y.isPaddingEqual(Q),this._zooming=this._zooming||Te.isZooming,this._easeId=l.easeId,this._prepareEase(f,l.noMoveStart,de),this.terrain&&this._prepareElevation(Te.elevationCenter),this._ease((Ie=>{Te.easeFunc(Ie),this.terrain&&!l.freezeElevation&&this._updateElevation(Ie),this._applyUpdatedTransform(y),this._fireMoveEvents(f)}),(Ie=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(f,Ie)}),l),this}_prepareEase(l,f,y={}){this._moving=!0,f||y.moving||this.fire(new o.l(\"movestart\",l)),this._zooming&&!y.zooming&&this.fire(new o.l(\"zoomstart\",l)),this._rotating&&!y.rotating&&this.fire(new o.l(\"rotatestart\",l)),this._pitching&&!y.pitching&&this.fire(new o.l(\"pitchstart\",l)),this._rolling&&!y.rolling&&this.fire(new o.l(\"rollstart\",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));let f=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&f!==this._elevationTarget){let y=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(y-(f-(y*l+this._elevationStart))/(1-l)),this._elevationTarget=f}this.transform.setElevation(o.G.number(this._elevationStart,this._elevationTarget,l))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(l){if(!this.terrain&&l.elevation>=0&&l.pitch<=90)return{};let f=l.getCameraLngLat(),y=l.getCameraAltitude(),w=this.terrain?this.terrain.getElevationForLngLatZoom(f,l.zoom):0;if(y<w){let P=this.calculateCameraOptionsFromTo(f,w,l.center,l.elevation);return{pitch:P.pitch,zoom:P.zoom}}return{}}_applyUpdatedTransform(l){let f=[];if(f.push((w=>this._elevateCameraIfInsideTerrain(w))),this.transformCameraUpdate&&f.push((w=>this.transformCameraUpdate(w))),!f.length)return;let y=l.clone();for(let w of f){let P=y.clone(),{center:L,zoom:z,roll:G,pitch:j,bearing:Q,elevation:ie}=w(P);L&&P.setCenter(L),ie!==void 0&&P.setElevation(ie),z!==void 0&&P.setZoom(z),G!==void 0&&P.setRoll(G),j!==void 0&&P.setPitch(j),Q!==void 0&&P.setBearing(Q),y.apply(P,!1)}this.transform.apply(y,!1)}_fireMoveEvents(l){this.fire(new o.l(\"move\",l)),this._zooming&&this.fire(new o.l(\"zoom\",l)),this._rotating&&this.fire(new o.l(\"rotate\",l)),this._pitching&&this.fire(new o.l(\"pitch\",l)),this._rolling&&this.fire(new o.l(\"roll\",l))}_afterEase(l,f){if(this._easeId&&f&&this._easeId===f)return;delete this._easeId;let y=this._zooming,w=this._rotating,P=this._pitching,L=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,y&&this.fire(new o.l(\"zoomend\",l)),w&&this.fire(new o.l(\"rotateend\",l)),P&&this.fire(new o.l(\"pitchend\",l)),L&&this.fire(new o.l(\"rollend\",l)),this.fire(new o.l(\"moveend\",l))}flyTo(l,f){if(!l.essential&&C.prefersReducedMotion){let ft=o.U(l,[\"center\",\"zoom\",\"bearing\",\"pitch\",\"roll\",\"elevation\",\"padding\"]);return this.jumpTo(ft,f)}this.stop(),l=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.cz},l);let y=this._getTransformForUpdate(),w=y.bearing,P=y.pitch,L=y.roll,z=y.padding,G=\"bearing\"in l?this._normalizeBearing(l.bearing,w):w,j=\"pitch\"in l?+l.pitch:P,Q=\"roll\"in l?this._normalizeBearing(l.roll,L):L,ie=\"padding\"in l?l.padding:y.padding,re=o.P.convert(l.offset),ce=y.centerPoint.add(re),de=y.screenPointToLocation(ce),Te=this.cameraHelper.handleFlyTo(y,{bearing:G,pitch:j,roll:Q,padding:ie,locationAtOffset:de,offsetAsPoint:re,center:l.center,minZoom:l.minZoom,zoom:l.zoom}),Ie=l.curve,Me=Math.max(y.width,y.height),Oe=Me/Te.scaleOfZoom,We=Te.pixelPathLength;typeof Te.scaleOfMinZoom==\"number\"&&(Ie=Math.sqrt(Me/Te.scaleOfMinZoom/We*2));let De=Ie*Ie;function Ge(ft){let Xt=(Oe*Oe-Me*Me+(ft?-1:1)*De*De*We*We)/(2*(ft?Oe:Me)*De*We);return Math.log(Math.sqrt(Xt*Xt+1)-Xt)}function Be(ft){return(Math.exp(ft)-Math.exp(-ft))/2}function Fe(ft){return(Math.exp(ft)+Math.exp(-ft))/2}let Ve=Ge(!1),ct=function(ft){return Fe(Ve)/Fe(Ve+Ie*ft)},dt=function(ft){return Me*((Fe(Ve)*(Be(Xt=Ve+Ie*ft)/Fe(Xt))-Be(Ve))/De)/We;var Xt},pt=(Ge(!0)-Ve)/Ie;if(Math.abs(We)<2e-6||!isFinite(pt)){if(Math.abs(Me-Oe)<1e-6)return this.easeTo(l,f);let ft=Oe<Me?-1:1;pt=Math.abs(Math.log(Oe/Me))/Ie,dt=()=>0,ct=Xt=>Math.exp(ft*Ie*Xt)}return l.duration=\"duration\"in l?+l.duration:1e3*pt/(\"screenSpeed\"in l?+l.screenSpeed/Ie:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=w!==G,this._pitching=j!==P,this._rolling=Q!==L,this._padding=!y.isPaddingEqual(ie),this._prepareEase(f,!1),this.terrain&&this._prepareElevation(Te.targetCenter),this._ease((ft=>{let Xt=ft*pt,Ut=1/ct(Xt),Bt=dt(Xt);this._rotating&&y.setBearing(o.G.number(w,G,ft)),this._pitching&&y.setPitch(o.G.number(P,j,ft)),this._rolling&&y.setRoll(o.G.number(L,Q,ft)),this._padding&&(y.interpolatePadding(z,ie,ft),ce=y.centerPoint.add(re)),Te.easeFunc(ft,Ut,Bt,ce),this.terrain&&!l.freezeElevation&&this._updateElevation(ft),this._applyUpdatedTransform(y),this._fireMoveEvents(f)}),(()=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(f)}),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,f){var y;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let w=this._onEaseEnd;delete this._onEaseEnd,w.call(this,f)}return l||(y=this.handlers)===null||y===void 0||y.stop(!1),this}_ease(l,f,y){y.animate===!1||y.duration===0?(l(1),f()):(this._easeStart=k(),this._easeOptions=y,this._onEaseFrame=l,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,f){l=o.W(l,-180,180);let y=Math.abs(l-f);return Math.abs(l-360-f)<y&&(l-=360),Math.abs(l+360-f)<y&&(l+=360),l}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLat(o.V.convert(l),this.transform):null}}let ka={compact:!0,customAttribution:'<a href=\"https://maplibre.org/\" target=\"_blank\">MapLibre</a>'};class Nl{constructor(l=ka){this._toggleAttribution=()=>{this._container.classList.contains(\"maplibregl-compact\")&&(this._container.classList.contains(\"maplibregl-compact-show\")?(this._container.setAttribute(\"open\",\"\"),this._container.classList.remove(\"maplibregl-compact-show\")):(this._container.classList.add(\"maplibregl-compact-show\"),this._container.removeAttribute(\"open\")))},this._updateData=f=>{!f||f.sourceDataType!==\"metadata\"&&f.sourceDataType!==\"visibility\"&&f.dataType!==\"style\"&&f.type!==\"terrain\"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute(\"open\",\"\"):this._container.classList.contains(\"maplibregl-compact\")||this._container.classList.contains(\"maplibregl-attrib-empty\")||(this._container.setAttribute(\"open\",\"\"),this._container.classList.add(\"maplibregl-compact\",\"maplibregl-compact-show\")):(this._container.setAttribute(\"open\",\"\"),this._container.classList.contains(\"maplibregl-compact\")&&this._container.classList.remove(\"maplibregl-compact\",\"maplibregl-compact-show\"))},this._updateCompactMinimize=()=>{this._container.classList.contains(\"maplibregl-compact\")&&this._container.classList.contains(\"maplibregl-compact-show\")&&this._container.classList.remove(\"maplibregl-compact-show\")},this.options=l}getDefaultPosition(){return\"bottom-right\"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=V.create(\"details\",\"maplibregl-ctrl maplibregl-ctrl-attrib\"),this._compactButton=V.create(\"summary\",\"maplibregl-ctrl-attrib-button\",this._container),this._compactButton.addEventListener(\"click\",this._toggleAttribution),this._setElementTitle(this._compactButton,\"ToggleAttribution\"),this._innerContainer=V.create(\"div\",\"maplibregl-ctrl-attrib-inner\",this._container),this._updateAttributions(),this._updateCompact(),this._map.on(\"styledata\",this._updateData),this._map.on(\"sourcedata\",this._updateData),this._map.on(\"terrain\",this._updateData),this._map.on(\"resize\",this._updateCompact),this._map.on(\"drag\",this._updateCompactMinimize),this._container}onRemove(){V.remove(this._container),this._map.off(\"styledata\",this._updateData),this._map.off(\"sourcedata\",this._updateData),this._map.off(\"terrain\",this._updateData),this._map.off(\"resize\",this._updateCompact),this._map.off(\"drag\",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,f){let y=this._map._getUIString(`AttributionControl.${f}`);l.title=y,l.setAttribute(\"aria-label\",y)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map((w=>typeof w!=\"string\"?\"\":w))):typeof this.options.customAttribution==\"string\"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){let w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}let f=this._map.style.tileManagers;for(let w in f){let P=f[w];if(P.used||P.usedForTerrain){let L=P.getSource();L.attribution&&l.indexOf(L.attribution)<0&&l.push(L.attribution)}}l=l.filter((w=>String(w).trim())),l.sort(((w,P)=>w.length-P.length)),l=l.filter(((w,P)=>{for(let L=P+1;L<l.length;L++)if(l[L].indexOf(w)>=0)return!1;return!0}));let y=l.join(\" | \");y!==this._attribHTML&&(this._attribHTML=y,l.length?(this._innerContainer.innerHTML=V.sanitize(y),this._container.classList.remove(\"maplibregl-attrib-empty\")):this._container.classList.add(\"maplibregl-attrib-empty\"),this._updateCompact(),this._editLink=null)}}class zg{constructor(l={}){this._updateCompact=()=>{let f=this._container.children;if(f.length){let y=f[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&y.classList.add(\"maplibregl-compact\"):y.classList.remove(\"maplibregl-compact\")}},this.options=l}getDefaultPosition(){return\"bottom-left\"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=V.create(\"div\",\"maplibregl-ctrl\");let f=V.create(\"a\",\"maplibregl-ctrl-logo\");return f.target=\"_blank\",f.rel=\"noopener nofollow\",f.href=\"https://maplibre.org/\",f.setAttribute(\"aria-label\",this._map._getUIString(\"LogoControl.Title\")),f.setAttribute(\"rel\",\"noopener nofollow\"),this._container.appendChild(f),this._container.style.display=\"block\",this._map.on(\"resize\",this._updateCompact),this._updateCompact(),this._container}onRemove(){V.remove(this._container),this._map.off(\"resize\",this._updateCompact),this._map=void 0,this._compact=void 0}}class Sx{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){let f=++this._id;return this._queue.push({callback:l,id:f,cancelled:!1}),f}remove(l){let f=this._currentlyRunning,y=f?this._queue.concat(f):this._queue;for(let w of y)if(w.id===l)return void(w.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error(\"Attempting to run(), but is already running.\");let f=this._currentlyRunning=this._queue;this._queue=[];for(let y of f)if(!y.cancelled&&(y.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Cx=o.aU([{name:\"a_pos3d\",type:\"Int16\",components:3}]);class Yd extends o.E{constructor(l){super(),this._lastTilesetChange=k(),this.tileManager=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=l._source.tileSize*2**this.deltaZoom,l.usedForTerrain=!0,l.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(l,f){this.tileManager.update(l,f),this._renderableTilesKeys=[];let y={};for(let w of Et(l,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:f,calculateTileZoom:this.tileManager._source.calculateTileZoom}))y[w.key]=!0,this._renderableTilesKeys.push(w.key),this._tiles[w.key]||(w.terrainRttPosMatrix32f=new Float64Array(16),o.c7(w.terrainRttPosMatrix32f,0,o.a5,o.a5,0,0,1),this._tiles[w.key]=new ot(w,this.tileSize),this._lastTilesetChange=k());for(let w in this._tiles)y[w]||delete this._tiles[w]}freeRtt(l){for(let f in this._tiles){let y=this._tiles[f];(!l||y.tileID.equals(l)||y.tileID.isChildOf(l)||l.isChildOf(y.tileID))&&(y.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((l=>this.getTileByID(l)))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l,f){return f?this._getTerrainCoordsForTileRanges(l,f):this._getTerrainCoordsForRegularTile(l)}_getTerrainCoordsForRegularTile(l){let f={};for(let y of this._renderableTilesKeys){let w=this._tiles[y].tileID,P=l.clone(),L=o.bk();if(w.canonical.equals(l.canonical))o.c7(L,0,o.a5,o.a5,0,0,1);else if(w.canonical.isChildOf(l.canonical)){let z=w.canonical.z-l.canonical.z,G=w.canonical.x-(w.canonical.x>>z<<z),j=w.canonical.y-(w.canonical.y>>z<<z),Q=o.a5>>z;o.c7(L,0,Q,Q,0,0,1),o.O(L,L,[-G*Q,-j*Q,0])}else{if(!l.canonical.isChildOf(w.canonical))continue;{let z=l.canonical.z-w.canonical.z,G=l.canonical.x-(l.canonical.x>>z<<z),j=l.canonical.y-(l.canonical.y>>z<<z),Q=o.a5>>z;o.c7(L,0,o.a5,o.a5,0,0,1),o.O(L,L,[G*Q,j*Q,0]),o.Q(L,L,[1/2**z,1/2**z,0])}}P.terrainRttPosMatrix32f=new Float32Array(L),f[y]=P}return f}_getTerrainCoordsForTileRanges(l,f){let y={};for(let w of this._renderableTilesKeys){let P=this._tiles[w].tileID;if(!this._isWithinTileRanges(P,f))continue;let L=l.clone(),z=o.bk();if(P.canonical.z===l.canonical.z){let G=l.canonical.x-P.canonical.x+l.wrap*(1<<l.canonical.z),j=l.canonical.y-P.canonical.y;o.c7(z,0,o.a5,o.a5,0,0,1),o.O(z,z,[G*o.a5,j*o.a5,0])}else if(P.canonical.z>l.canonical.z){let G=P.canonical.z-l.canonical.z,j=P.canonical.x-(P.canonical.x>>G<<G)+l.wrap*(1<<P.canonical.z),Q=P.canonical.y-(P.canonical.y>>G<<G),ie=l.canonical.x-(P.canonical.x>>G),re=l.canonical.y-(P.canonical.y>>G),ce=o.a5>>G;o.c7(z,0,ce,ce,0,0,1),o.O(z,z,[-j*ce+ie*o.a5,-Q*ce+re*o.a5,0])}else{let G=l.canonical.z-P.canonical.z,j=l.canonical.x-(l.canonical.x>>G<<G)+l.wrap*(1<<l.canonical.z),Q=l.canonical.y-(l.canonical.y>>G<<G),ie=(l.canonical.x>>G)-P.canonical.x,re=(l.canonical.y>>G)-P.canonical.y,ce=o.a5<<G;o.c7(z,0,ce,ce,0,0,1),o.O(z,z,[j*o.a5+ie*ce,Q*o.a5+re*ce,0])}L.terrainRttPosMatrix32f=new Float32Array(z),y[w]=L}return y}getSourceTile(l,f){let y=this.tileManager._source,w=l.overscaledZ-this.deltaZoom;if(w>y.maxzoom&&(w=y.maxzoom),w<y.minzoom)return;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(w).key);let P=this.findTileInCaches(this._sourceTileCache[l.key]);if(!P?.dem&&f)for(;w>=y.minzoom&&!P?.dem;)P=this.findTileInCaches(l.scaledTo(w--).key);return P}findTileInCaches(l){let f=this.tileManager.getTileByID(l);return f||(f=this.tileManager._outOfViewCache.getByKey(l),f)}anyTilesAfterTime(l=Date.now()){return this._lastTilesetChange>=l}_isWithinTileRanges(l,f){let y=f[l.canonical.z];return!!y&&(l.wrap>y.minWrap||l.wrap<y.maxWrap||l.canonical.x>=y.minTileXWrapped&&l.canonical.x<=y.maxTileXWrapped&&l.canonical.y>=y.minTileY&&l.canonical.y<=y.maxTileY)}}class Yi{constructor(l,f,y){this._meshCache={},this.painter=l,this.tileManager=new Yd(f),this.options=y,this.exaggeration=typeof y.exaggeration==\"number\"?y.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,f,y,w=o.a5){var P;if(!(f>=0&&f<w&&y>=0&&y<w))return 0;let L=this.getTerrainData(l),z=(P=L.tile)===null||P===void 0?void 0:P.dem;if(!z)return 0;let G=o.cD([],[f/w*o.a5,y/w*o.a5],L.u_terrain_matrix),j=[G[0]*z.dim,G[1]*z.dim],Q=Math.floor(j[0]),ie=Math.floor(j[1]),re=j[0]-Q,ce=j[1]-ie;return z.get(Q,ie)*(1-re)*(1-ce)+z.get(Q+1,ie)*re*(1-ce)+z.get(Q,ie+1)*(1-re)*ce+z.get(Q+1,ie+1)*re*ce}getElevationForLngLatZoom(l,f){if(!o.cE(f,l.wrap()))return 0;let{tileID:y,mercatorX:w,mercatorY:P}=this._getOverscaledTileIDFromLngLatZoom(l,f);return this.getElevation(y,w%o.a5,P%o.a5,o.a5)}getElevationForLngLat(l,f){let y=Et(f,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this}),w=0;for(let P of y)P.canonical.z>w&&(w=Math.min(P.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(l,w)}getElevation(l,f,y,w=o.a5){return this.getDEMElevation(l,f,y,w)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){let w=this.painter.context,P=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(w,P,w.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(w,new o.R({width:1,height:1}),w.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(w.gl.NEAREST,w.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ar([])}let f=this.tileManager.getSourceTile(l,!0);if(f&&f.dem&&(!f.demTexture||f.needsTerrainPrepare)){let w=this.painter.context;f.demTexture=this.painter.getTileTexture(f.dem.stride),f.demTexture?f.demTexture.update(f.dem.getPixels(),{premultiply:!1}):f.demTexture=new o.T(w,f.dem.getPixels(),w.gl.RGBA,{premultiply:!1}),f.demTexture.bind(w.gl.NEAREST,w.gl.CLAMP_TO_EDGE),f.needsTerrainPrepare=!1}let y=f&&f.toString()+f.tileID.key+l.key;if(y&&!this._demMatrixCache[y]){let w=this.tileManager.getSource().maxzoom,P=l.canonical.z-f.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=w?P=l.canonical.z-w:o.w(\"cannot calculate elevation if elevation maxzoom > source.maxzoom\"));let L=l.canonical.x-(l.canonical.x>>P<<P),z=l.canonical.y-(l.canonical.y>>P<<P),G=o.cF(new Float64Array(16),[1/(o.a5<<P),1/(o.a5<<P),0]);o.O(G,G,[L*o.a5,z*o.a5,0]),this._demMatrixCache[l.key]={matrix:G,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:f&&f.dem&&f.dem.dim||1,u_terrain_matrix:y?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:f&&f.dem&&f.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(f&&f.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:f}}getFramebuffer(l){let f=this.painter,y=f.width/devicePixelRatio,w=f.height/devicePixelRatio;return!this._fbo||this._fbo.width===y&&this._fbo.height===w||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(f.context,{width:y,height:w,data:null},f.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(f.context.gl.NEAREST,f.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(f.context,{width:y,height:w,data:null},f.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(f.context.gl.NEAREST,f.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=f.context.createFramebuffer(y,w,!0,!1),this._fbo.depthAttachment.set(f.context.createRenderbuffer(f.context.gl.DEPTH_COMPONENT16,y,w))),this._fbo.colorAttachment.set(l===\"coords\"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let f=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let P=0,L=0;P<this._coordsTextureSize;P++)for(let z=0;z<this._coordsTextureSize;z++,L+=4)f[L+0]=255&z,f[L+1]=255&P,f[L+2]=z>>8<<4|P>>8,f[L+3]=0;let y=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(f.buffer)),w=new o.T(l,y,l.gl.RGBA,{premultiply:!1});return w.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=w,w}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);let f=new Uint8Array(4),y=this.painter.context,w=y.gl,P=Math.round(l.x*this.painter.pixelRatio/devicePixelRatio),L=Math.round(l.y*this.painter.pixelRatio/devicePixelRatio),z=Math.round(this.painter.height/devicePixelRatio);y.bindFramebuffer.set(this.getFramebuffer(\"coords\").framebuffer),w.readPixels(P,z-L-1,1,1,w.RGBA,w.UNSIGNED_BYTE,f),y.bindFramebuffer.set(null);let G=f[0]+(f[2]>>4<<8),j=f[1]+((15&f[2])<<8),Q=this.coordsIndex[255-f[3]],ie=Q&&this.tileManager.getTileByID(Q);if(!ie)return null;let re=this._coordsTextureSize,ce=(1<<ie.tileID.canonical.z)*re;return new o.a9((ie.tileID.canonical.x*re+G)/ce+ie.tileID.wrap,(ie.tileID.canonical.y*re+j)/ce,this.getElevation(ie.tileID,G,j,re))}depthAtPoint(l){let f=new Uint8Array(4),y=this.painter.context,w=y.gl;return y.bindFramebuffer.set(this.getFramebuffer(\"depth\").framebuffer),w.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,w.RGBA,w.UNSIGNED_BYTE,f),y.bindFramebuffer.set(null),(f[0]/16777216+f[1]/65536+f[2]/256+f[3])/256}getTerrainMesh(l){var f;let y=((f=this.painter.style.projection)===null||f===void 0?void 0:f.transitionState)>0,w=y&&l.canonical.y===0,P=y&&l.canonical.y===(1<<l.canonical.z)-1,L=`m_${w?\"n\":\"\"}_${P?\"s\":\"\"}`;if(this._meshCache[L])return this._meshCache[L];let z=this.painter.context,G=new o.cG,j=new o.aY,Q=this.meshSize,ie=o.a5/Q,re=Q*Q;for(let Fe=0;Fe<=Q;Fe++)for(let Ve=0;Ve<=Q;Ve++)G.emplaceBack(Ve*ie,Fe*ie,0);for(let Fe=0;Fe<re;Fe+=Q+1)for(let Ve=0;Ve<Q;Ve++)j.emplaceBack(Ve+Fe,Q+Ve+Fe+1,Q+Ve+Fe+2),j.emplaceBack(Ve+Fe,Q+Ve+Fe+2,Ve+Fe+1);let ce=G.length,de=ce+(Q+1),Te=(Q+1)*Q,Ie=w?o.br:0,Me=w?0:1,Oe=P?o.bs:o.a5,We=P?0:1;for(let Fe=0;Fe<=Q;Fe++)G.emplaceBack(Fe*ie,Ie,Me);for(let Fe=0;Fe<=Q;Fe++)G.emplaceBack(Fe*ie,Oe,We);for(let Fe=0;Fe<Q;Fe++)j.emplaceBack(Te+Fe,de+Fe,de+Fe+1),j.emplaceBack(Te+Fe,de+Fe+1,Te+Fe+1),j.emplaceBack(0+Fe,ce+Fe+1,ce+Fe),j.emplaceBack(0+Fe,0+Fe+1,ce+Fe+1);let De=G.length,Ge=De+2*(Q+1);for(let Fe of[0,1])for(let Ve=0;Ve<=Q;Ve++)for(let ct of[0,1])G.emplaceBack(Fe*o.a5,Ve*ie,ct);for(let Fe=0;Fe<2*Q;Fe+=2)j.emplaceBack(De+Fe,De+Fe+1,De+Fe+3),j.emplaceBack(De+Fe,De+Fe+3,De+Fe+2),j.emplaceBack(Ge+Fe,Ge+Fe+3,Ge+Fe+1),j.emplaceBack(Ge+Fe,Ge+Fe+2,Ge+Fe+3);let Be=new vi(z.createVertexBuffer(G,Cx.members),z.createIndexBuffer(j),o.aX.simpleSegment(0,0,G.length,j.length));return this._meshCache[L]=Be,Be}getMeshFrameDelta(l){return 2*Math.PI*o.bE/Math.pow(2,Math.max(l,0))/5}getMinTileElevationForLngLatZoom(l,f){var y;if(!o.cE(f,l.wrap()))return 0;let{tileID:w}=this._getOverscaledTileIDFromLngLatZoom(l,f);return(y=this.getMinMaxElevation(w).minElevation)!==null&&y!==void 0?y:0}getMinMaxElevation(l){let f=this.getTerrainData(l).tile,y={minElevation:null,maxElevation:null};return f&&f.dem&&(y.minElevation=f.dem.min*this.exaggeration,y.maxElevation=f.dem.max*this.exaggeration),y}_getOverscaledTileIDFromLngLatZoom(l,f){let y=o.a9.fromLngLat(l.wrap()),w=(1<<f)*o.a5,P=y.x*w,L=y.y*w,z=Math.floor(P/o.a5),G=Math.floor(L/o.a5);return{tileID:new o.a2(f,0,f,z,G),mercatorX:P,mercatorY:L}}}class fo{constructor(l,f,y){this._context=l,this._size=f,this._tileSize=y,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){let f=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),y=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return y.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),f.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),f.colorAttachment.set(y.texture),{id:l,fbo:f,texture:y,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((f=>l.id!==f)),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(let f of this._recentlyUsed)if(!this._objects[f].inUse)return this._objects[f];if(this._objects.length>=this._size)throw new Error(\"No free RenderPool available, call freeAllObjects() required!\");let l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(let l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((l=>!l.inUse))===!1}}let ua={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,\"color-relief\":!0};class Dh{constructor(l,f){this.painter=l,this.terrain=f,this.pool=new fo(l.context,30,f.tileManager.tileSize*f.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,f){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=l._order.filter((y=>!l._layers[y].isHidden(f))),this._coordsAscending={};for(let y in l.tileManagers){this._coordsAscending[y]={};let w=l.tileManagers[y].getVisibleCoordinates(),P=l.tileManagers[y].getSource(),L=P instanceof Fr?P.terrainTileRanges:null;for(let z of w){let G=this.terrain.tileManager.getTerrainCoords(z,L);for(let j in G)this._coordsAscending[y][j]||(this._coordsAscending[y][j]=[]),this._coordsAscending[y][j].push(G[j])}}this._coordsAscendingStr={};for(let y of l._order){let w=l._layers[y],P=w.source;if(ua[w.type]&&!this._coordsAscendingStr[P]){this._coordsAscendingStr[P]={};for(let L in this._coordsAscending[P])this._coordsAscendingStr[P][L]=this._coordsAscending[P][L].map((z=>z.key)).sort().join()}}for(let y of this._renderableTiles)for(let w in this._coordsAscendingStr){let P=this._coordsAscendingStr[w][y.tileID.key];P&&P!==y.rttCoords[w]&&(y.rtt=[])}}renderLayer(l,f){if(l.isHidden(this.painter.transform.zoom))return!1;let y=Object.assign(Object.assign({},f),{isRenderingToTexture:!0}),w=l.type,P=this.painter,L=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(ua[w]&&(this._prevType&&ua[this._prevType]||this._stacks.push([]),this._prevType=w,this._stacks[this._stacks.length-1].push(l.id),!L))return!0;if(ua[this._prevType]||ua[w]&&L){this._prevType=w;let z=this._stacks.length-1,G=this._stacks[z]||[];for(let j of this._renderableTiles){if(this.pool.isFull()&&(Bg(this.painter,this.terrain,this._rttTiles,y),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(j),j.rtt[z]){let ie=this.pool.getObjectForId(j.rtt[z].id);if(ie.stamp===j.rtt[z].stamp){this.pool.useObject(ie);continue}}let Q=this.pool.getOrCreateFreeObject();this.pool.useObject(Q),this.pool.stampObject(Q),j.rtt[z]={id:Q.id,stamp:Q.stamp},P.context.bindFramebuffer.set(Q.fbo.framebuffer),P.context.clear({color:o.bp.transparent,stencil:0}),P.currentStencilSource=void 0;for(let ie=0;ie<G.length;ie++){let re=P.style._layers[G[ie]],ce=re.source?this._coordsAscending[re.source][j.tileID.key]:[j.tileID];P.context.viewport.set([0,0,Q.fbo.width,Q.fbo.height]),P._renderTileClippingMasks(re,ce,!0),P.renderLayer(P,P.style.tileManagers[re.source],re,ce,y),re.source&&(j.rttCoords[re.source]=this._coordsAscendingStr[re.source][j.tileID.key])}}return Bg(this.painter,this.terrain,this._rttTiles,y),this._rttTiles=[],this.pool.freeAllObjects(),ua[w]}return!1}}let D0={\"AttributionControl.ToggleAttribution\":\"Toggle attribution\",\"AttributionControl.MapFeedback\":\"Map feedback\",\"FullscreenControl.Enter\":\"Enter fullscreen\",\"FullscreenControl.Exit\":\"Exit fullscreen\",\"GeolocateControl.FindMyLocation\":\"Find my location\",\"GeolocateControl.LocationNotAvailable\":\"Location not available\",\"LogoControl.Title\":\"MapLibre logo\",\"Map.Title\":\"Map\",\"Marker.Title\":\"Map marker\",\"NavigationControl.ResetBearing\":\"Reset bearing to north\",\"NavigationControl.ZoomIn\":\"Zoom in\",\"NavigationControl.ZoomOut\":\"Zoom out\",\"Popup.Close\":\"Close popup\",\"ScaleControl.Feet\":\"ft\",\"ScaleControl.Meters\":\"m\",\"ScaleControl.Kilometers\":\"km\",\"ScaleControl.Miles\":\"mi\",\"ScaleControl.NauticalMiles\":\"nm\",\"GlobeControl.Enable\":\"Enable globe\",\"GlobeControl.Disable\":\"Disable globe\",\"TerrainControl.Enable\":\"Enable terrain\",\"TerrainControl.Disable\":\"Disable terrain\",\"CooperativeGesturesHandler.WindowsHelpText\":\"Use Ctrl + scroll to zoom the map\",\"CooperativeGesturesHandler.MacHelpText\":\"Use \\u2318 + scroll to zoom the map\",\"CooperativeGesturesHandler.MobileHelpText\":\"Use two fingers to move the map\"},Bf=s,Zd={hash:!1,interactive:!0,bearingSnap:7,zoomSnap:0,attributionControl:ka,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:\"high-performance\",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:\"sans-serif\",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},Ug={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class qd{constructor(l,f,y=!1){this.mousedown=P=>{this.startMove(P,V.mousePos(this.element,P)),V.addEventListener(window,\"mousemove\",this.mousemove),V.addEventListener(window,\"mouseup\",this.mouseup)},this.mousemove=P=>{this.move(P,V.mousePos(this.element,P))},this.mouseup=P=>{this._rotatePitchHandler.dragEnd(P),this.offTemp()},this.touchstart=P=>{P.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=V.touchPos(this.element,P.targetTouches)[0],this.startMove(P,this._startPos),V.addEventListener(window,\"touchmove\",this.touchmove,{passive:!1}),V.addEventListener(window,\"touchend\",this.touchend))},this.touchmove=P=>{P.targetTouches.length!==1?this.reset():(this._lastPos=V.touchPos(this.element,P.targetTouches)[0],this.move(P,this._lastPos))},this.touchend=P=>{P.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=f;let w=new Y_;this._rotatePitchHandler=new sl({clickTolerance:3,move:(P,L)=>{let z=f.getBoundingClientRect(),G=new o.P((z.bottom-z.top)/2,(z.right-z.left)/2);return{bearingDelta:o.cy(new o.P(P.x,L.y),L,G),pitchDelta:y?-.5*(L.y-P.y):void 0}},moveStateManager:w,enable:!0,assignEvents:()=>{}}),this.map=l,V.addEventListener(f,\"mousedown\",this.mousedown),V.addEventListener(f,\"touchstart\",this.touchstart,{passive:!1}),V.addEventListener(f,\"touchcancel\",this.reset)}startMove(l,f){this._rotatePitchHandler.dragStart(l,f),V.disableDrag()}move(l,f){let y=this.map,{bearingDelta:w,pitchDelta:P}=this._rotatePitchHandler.dragMove(l,f)||{};w&&y.setBearing(y.getBearing()+w),P&&y.setPitch(y.getPitch()+P)}off(){let l=this.element;V.removeEventListener(l,\"mousedown\",this.mousedown),V.removeEventListener(l,\"touchstart\",this.touchstart,{passive:!1}),V.removeEventListener(window,\"touchmove\",this.touchmove,{passive:!1}),V.removeEventListener(window,\"touchend\",this.touchend),V.removeEventListener(l,\"touchcancel\",this.reset),this.offTemp()}offTemp(){V.enableDrag(),V.removeEventListener(window,\"mousemove\",this.mousemove),V.removeEventListener(window,\"mouseup\",this.mouseup),V.removeEventListener(window,\"touchmove\",this.touchmove,{passive:!1}),V.removeEventListener(window,\"touchend\",this.touchend)}}let Na;function Qd(I,l,f,y=!1){if(y||!f.getCoveringTilesDetailsProvider().allowWorldCopies())return I?.wrap();let w=new o.V(I.lng,I.lat);if(I=new o.V(I.lng,I.lat),l){let P=new o.V(I.lng-360,I.lat),L=new o.V(I.lng+360,I.lat),z=f.locationToScreenPoint(I).distSqr(l);f.locationToScreenPoint(P).distSqr(l)<z?I=P:f.locationToScreenPoint(L).distSqr(l)<z&&(I=L)}for(;Math.abs(I.lng-f.center.lng)>180;){let P=f.locationToScreenPoint(I);if(P.x>=0&&P.y>=0&&P.x<=f.width&&P.y<=f.height)break;I.lng>f.center.lng?I.lng-=360:I.lng+=360}return I.lng!==w.lng&&f.isPointOnMapSurface(f.locationToScreenPoint(I))?I:w}let Nc={center:\"translate(-50%,-50%)\",top:\"translate(-50%,0)\",\"top-left\":\"translate(0,0)\",\"top-right\":\"translate(-100%,0)\",bottom:\"translate(-50%,-100%)\",\"bottom-left\":\"translate(0,-100%)\",\"bottom-right\":\"translate(-100%,-100%)\",left:\"translate(0,-50%)\",right:\"translate(-100%,-50%)\"};function Df(I,l,f){let y=I.classList;for(let w in Nc)y.remove(`maplibregl-${f}-anchor-${w}`);y.add(`maplibregl-${f}-anchor-${l}`)}class Lh extends o.E{constructor(l){if(super(),this._onKeyPress=f=>{let y=f.code,w=f.charCode||f.keyCode;y!==\"Space\"&&y!==\"Enter\"&&w!==32&&w!==13||this.togglePopup()},this._onMapClick=f=>{let y=f.originalEvent.target,w=this._element;this._popup&&(y===w||w.contains(y))&&this.togglePopup()},this._update=f=>{if(!this._map)return;let y=this._map.loaded()&&!this._map.isMoving();(f?.type===\"terrain\"||f?.type===\"render\"&&!y)&&this._map.once(\"render\",this._update),this._lngLat=Qd(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let w=\"\";this._rotationAlignment===\"viewport\"||this._rotationAlignment===\"auto\"?w=`rotateZ(${this._rotation}deg)`:this._rotationAlignment===\"map\"&&(w=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let P=\"\";this._pitchAlignment===\"viewport\"||this._pitchAlignment===\"auto\"?P=\"rotateX(0deg)\":this._pitchAlignment===\"map\"&&(P=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||f&&f.type!==\"moveend\"||(this._pos=this._pos.round()),V.setTransform(this._element,`${Nc[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${P} ${w}`),C.frameAsync(new AbortController,this._map._ownerWindow).then((()=>{this._updateOpacity(f&&f.type===\"moveend\")})).catch((()=>{}))},this._onMove=f=>{if(!this._isDragging){let y=this._clickTolerance||this._map._clickTolerance;this._isDragging=f.point.dist(this._pointerdownPos)>=y}this._isDragging&&(this._pos=f.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents=\"none\",this._state===\"pending\"&&(this._state=\"active\",this.fire(new o.l(\"dragstart\"))),this.fire(new o.l(\"drag\")))},this._onUp=()=>{this._element.style.pointerEvents=\"auto\",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off(\"mousemove\",this._onMove),this._map.off(\"touchmove\",this._onMove),this._state===\"active\"&&this.fire(new o.l(\"dragend\")),this._state=\"inactive\"},this._addDragHandler=f=>{this._element.contains(f.originalEvent.target)&&(f.preventDefault(),this._positionDelta=f.point.sub(this._pos).add(this._offset),this._pointerdownPos=f.point,this._state=\"pending\",this._map.on(\"mousemove\",this._onMove),this._map.on(\"touchmove\",this._onMove),this._map.once(\"mouseup\",this._onUp),this._map.once(\"touchend\",this._onUp))},this._anchor=l&&l.anchor||\"center\",this._color=l&&l.color||\"#3FB1CE\",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._subpixelPositioning=l&&l.subpixelPositioning||!1,this._isDragging=!1,this._state=\"inactive\",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||\"auto\",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!==\"auto\"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(l?.opacity,l?.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=o.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=V.create(\"div\");let f=V.createNS(\"http://www.w3.org/2000/svg\",\"svg\"),y=41,w=27;f.setAttributeNS(null,\"display\",\"block\"),f.setAttributeNS(null,\"height\",`${y}px`),f.setAttributeNS(null,\"width\",`${w}px`),f.setAttributeNS(null,\"viewBox\",`0 0 ${w} ${y}`);let P=V.createNS(\"http://www.w3.org/2000/svg\",\"g\");P.setAttributeNS(null,\"stroke\",\"none\"),P.setAttributeNS(null,\"stroke-width\",\"1\"),P.setAttributeNS(null,\"fill\",\"none\"),P.setAttributeNS(null,\"fill-rule\",\"evenodd\");let L=V.createNS(\"http://www.w3.org/2000/svg\",\"g\");L.setAttributeNS(null,\"fill-rule\",\"nonzero\");let z=V.createNS(\"http://www.w3.org/2000/svg\",\"g\");z.setAttributeNS(null,\"transform\",\"translate(3.0, 29.0)\"),z.setAttributeNS(null,\"fill\",\"#000000\");let G=[{rx:\"10.5\",ry:\"5.25002273\"},{rx:\"10.5\",ry:\"5.25002273\"},{rx:\"9.5\",ry:\"4.77275007\"},{rx:\"8.5\",ry:\"4.29549936\"},{rx:\"7.5\",ry:\"3.81822308\"},{rx:\"6.5\",ry:\"3.34094679\"},{rx:\"5.5\",ry:\"2.86367051\"},{rx:\"4.5\",ry:\"2.38636864\"}];for(let Me of G){let Oe=V.createNS(\"http://www.w3.org/2000/svg\",\"ellipse\");Oe.setAttributeNS(null,\"opacity\",\"0.04\"),Oe.setAttributeNS(null,\"cx\",\"10.5\"),Oe.setAttributeNS(null,\"cy\",\"5.80029008\"),Oe.setAttributeNS(null,\"rx\",Me.rx),Oe.setAttributeNS(null,\"ry\",Me.ry),z.appendChild(Oe)}let j=V.createNS(\"http://www.w3.org/2000/svg\",\"g\");j.setAttributeNS(null,\"fill\",this._color);let Q=V.createNS(\"http://www.w3.org/2000/svg\",\"path\");Q.setAttributeNS(null,\"d\",\"M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z\"),j.appendChild(Q);let ie=V.createNS(\"http://www.w3.org/2000/svg\",\"g\");ie.setAttributeNS(null,\"opacity\",\"0.25\"),ie.setAttributeNS(null,\"fill\",\"#000000\");let re=V.createNS(\"http://www.w3.org/2000/svg\",\"path\");re.setAttributeNS(null,\"d\",\"M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z\"),ie.appendChild(re);let ce=V.createNS(\"http://www.w3.org/2000/svg\",\"g\");ce.setAttributeNS(null,\"transform\",\"translate(6.0, 7.0)\"),ce.setAttributeNS(null,\"fill\",\"#FFFFFF\");let de=V.createNS(\"http://www.w3.org/2000/svg\",\"g\");de.setAttributeNS(null,\"transform\",\"translate(8.0, 8.0)\");let Te=V.createNS(\"http://www.w3.org/2000/svg\",\"circle\");Te.setAttributeNS(null,\"fill\",\"#000000\"),Te.setAttributeNS(null,\"opacity\",\"0.25\"),Te.setAttributeNS(null,\"cx\",\"5.5\"),Te.setAttributeNS(null,\"cy\",\"5.5\"),Te.setAttributeNS(null,\"r\",\"5.4999962\");let Ie=V.createNS(\"http://www.w3.org/2000/svg\",\"circle\");Ie.setAttributeNS(null,\"fill\",\"#FFFFFF\"),Ie.setAttributeNS(null,\"cx\",\"5.5\"),Ie.setAttributeNS(null,\"cy\",\"5.5\"),Ie.setAttributeNS(null,\"r\",\"5.4999962\"),de.appendChild(Te),de.appendChild(Ie),L.appendChild(z),L.appendChild(j),L.appendChild(ie),L.appendChild(ce),L.appendChild(de),f.appendChild(L),f.setAttributeNS(null,\"height\",y*this._scale+\"px\"),f.setAttributeNS(null,\"width\",w*this._scale+\"px\"),this._element.appendChild(f),this._offset=o.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add(\"maplibregl-marker\"),this._element.addEventListener(\"dragstart\",(f=>{f.preventDefault()})),this._element.addEventListener(\"mousedown\",(f=>{f.preventDefault()})),Df(this._element,this._anchor,\"marker\"),l&&l.className)for(let f of l.className.split(\" \"))this._element.classList.add(f);this._popup=null}addTo(l){return this.remove(),this._map=l,this._element.hasAttribute(\"aria-label\")||this._element.setAttribute(\"aria-label\",l._getUIString(\"Marker.Title\")),this._element.hasAttribute(\"role\")||this._element.setAttribute(\"role\",\"button\"),l.getCanvasContainer().appendChild(this._element),l.on(\"move\",this._update),l.on(\"moveend\",this._update),l.on(\"terrain\",this._update),l.on(\"projectiontransition\",this._update),this.setDraggable(this._draggable),this._update(),this._map.on(\"click\",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off(\"click\",this._onMapClick),this._map.off(\"move\",this._update),this._map.off(\"moveend\",this._update),this._map.off(\"terrain\",this._update),this._map.off(\"projectiontransition\",this._update),this._map.off(\"mousedown\",this._addDragHandler),this._map.off(\"touchstart\",this._addDragHandler),this._map.off(\"mouseup\",this._onUp),this._map.off(\"touchend\",this._onUp),this._map.off(\"mousemove\",this._onMove),this._map.off(\"touchmove\",this._onMove),delete this._map),V.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.V.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener(\"keypress\",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute(\"tabindex\")),l){if(!(\"offset\"in l.options)){let w=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],\"top-left\":[0,0],\"top-right\":[0,0],bottom:[0,-38.1],\"bottom-left\":[w,-1*(38.1-13.5+w)],\"bottom-right\":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute(\"tabindex\"),this._originalTabIndex||this._element.setAttribute(\"tabindex\",\"0\"),this._element.addEventListener(\"keypress\",this._onKeyPress)}return this}setSubpixelPositioning(l){return this._subpixelPositioning=l,this}getPopup(){return this._popup}togglePopup(){let l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(l=!1){var f,y;let w=(f=this._map)===null||f===void 0?void 0:f.terrain,P=this._map.transform.isLocationOccluded(this._lngLat);if(!w||P){let ce=P?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==ce&&(this._element.style.opacity=ce))}if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}let L=this._map,z=L.terrain.depthAtPoint(this._pos),G=L.terrain.getElevationForLngLat(this._lngLat,L.transform);if(L.transform.lngLatToCameraDepth(this._lngLat,G)-z<.006)return void(this._element.style.opacity=this._opacity);let j=-this._offset.y/L.transform.pixelsPerMeter,Q=Math.sin(L.getPitch()*Math.PI/180)*j,ie=L.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),re=L.transform.lngLatToCameraDepth(this._lngLat,G+Q)-ie>.006;!((y=this._popup)===null||y===void 0)&&y.isOpen()&&re&&this._popup.remove(),this._element.style.opacity=re?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=o.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on(\"mousedown\",this._addDragHandler),this._map.on(\"touchstart\",this._addDragHandler)):(this._map.off(\"mousedown\",this._addDragHandler),this._map.off(\"touchstart\",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||\"auto\",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!==\"auto\"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,f){return(this._opacity===void 0||l===void 0&&f===void 0)&&(this._opacity=\"1\",this._opacityWhenCovered=\"0.2\"),l!==void 0&&(this._opacity=l),f!==void 0&&(this._opacityWhenCovered=f),this._map&&this._updateOpacity(!0),this}}let L0={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},zc=0,Pu=!1,Vg={maxWidth:100,unit:\"metric\"};function Kd(I,l,f){let y=f&&f.maxWidth||100,w=I._container.clientHeight/2,P=I._container.clientWidth/2,L=I.unproject([P-y/2,w]),z=I.unproject([P+y/2,w]),G=Math.round(I.project(z).x-I.project(L).x),j=Math.min(y,G,I._container.clientWidth),Q=L.distanceTo(z);if(f&&f.unit===\"imperial\"){let ie=3.2808*Q;ie>5280?Oh(l,j,ie/5280,I._getUIString(\"ScaleControl.Miles\")):Oh(l,j,ie,I._getUIString(\"ScaleControl.Feet\"))}else f&&f.unit===\"nautical\"?Oh(l,j,Q/1852,I._getUIString(\"ScaleControl.NauticalMiles\")):Q>=1e3?Oh(l,j,Q/1e3,I._getUIString(\"ScaleControl.Kilometers\")):Oh(l,j,Q,I._getUIString(\"ScaleControl.Meters\"))}function Oh(I,l,f,y){let w=(function(P){let L=Math.pow(10,`${Math.floor(P)}`.length-1),z=P/L;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:(function(G){let j=Math.pow(10,Math.ceil(-Math.log(G)/Math.LN10));return Math.round(G*j)/j})(z),L*z})(f);I.style.width=l*(w/f)+\"px\",I.innerHTML=`${w}&nbsp;${y}`}let Gg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:\"\",maxWidth:\"240px\",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},O0=[\"a[href]\",\"[tabindex]:not([tabindex='-1'])\",\"[contenteditable]:not([contenteditable='false'])\",\"button:not([disabled])\",\"input:not([disabled])\",\"select:not([disabled])\",\"textarea:not([disabled])\"].join(\", \");function F0(I){if(I){if(typeof I==\"number\"){let l=Math.round(Math.abs(I)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,I),\"top-left\":new o.P(l,l),\"top-right\":new o.P(-l,l),bottom:new o.P(0,-I),\"bottom-left\":new o.P(l,-l),\"bottom-right\":new o.P(-l,-l),left:new o.P(I,0),right:new o.P(-I,0)}}if(I instanceof o.P||Array.isArray(I)){let l=o.P.convert(I);return{center:l,top:l,\"top-left\":l,\"top-right\":l,bottom:l,\"bottom-left\":l,\"bottom-right\":l,left:l,right:l}}return{center:o.P.convert(I.center||[0,0]),top:o.P.convert(I.top||[0,0]),\"top-left\":o.P.convert(I[\"top-left\"]||[0,0]),\"top-right\":o.P.convert(I[\"top-right\"]||[0,0]),bottom:o.P.convert(I.bottom||[0,0]),\"bottom-left\":o.P.convert(I[\"bottom-left\"]||[0,0]),\"bottom-right\":o.P.convert(I[\"bottom-right\"]||[0,0]),left:o.P.convert(I.left||[0,0]),right:o.P.convert(I.right||[0,0])}}return F0(new o.P(0,0))}let Hg=s;i.AJAXError=o.cJ,i.Event=o.l,i.Evented=o.E,i.LngLat=o.V,i.MercatorCoordinate=o.a9,i.Point=o.P,i.addProtocol=o.cK,i.config=o.c,i.removeProtocol=o.cL,i.AttributionControl=Nl,i.BoxZoomHandler=Sf,i.CanvasSource=$t,i.CooperativeGesturesHandler=yn,i.DoubleClickZoomHandler=Rf,i.DragPanHandler=Q_,i.DragRotateHandler=kl,i.EdgeInsets=gd,i.FullscreenControl=class extends o.E{constructor(I={}){super(),this._onFullscreenChange=()=>{var l;let f=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=f?.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)f=f.shadowRoot.fullscreenElement;f===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,I&&I.container&&(I.container instanceof HTMLElement?this._container=I.container:o.w(\"Full screen control 'container' must be a DOM element.\")),\"onfullscreenchange\"in document?this._fullscreenchange=\"fullscreenchange\":\"onmozfullscreenchange\"in document?this._fullscreenchange=\"mozfullscreenchange\":\"onwebkitfullscreenchange\"in document?this._fullscreenchange=\"webkitfullscreenchange\":\"onmsfullscreenchange\"in document&&(this._fullscreenchange=\"MSFullscreenChange\")}onAdd(I){return this._map=I,this._container||(this._container=this._map.getContainer()),this._controlContainer=V.create(\"div\",\"maplibregl-ctrl maplibregl-ctrl-group\"),this._setupUI(),this._controlContainer}onRemove(){V.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let I=this._fullscreenButton=V.create(\"button\",\"maplibregl-ctrl-fullscreen\",this._controlContainer);V.create(\"span\",\"maplibregl-ctrl-icon\",I).setAttribute(\"aria-hidden\",\"true\"),I.type=\"button\",this._updateTitle(),this._fullscreenButton.addEventListener(\"click\",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let I=this._getTitle();this._fullscreenButton.setAttribute(\"aria-label\",I),this._fullscreenButton.title=I}_getTitle(){return this._map._getUIString(this._isFullscreen()?\"FullscreenControl.Exit\":\"FullscreenControl.Enter\")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(\"maplibregl-ctrl-shrink\"),this._fullscreenButton.classList.toggle(\"maplibregl-ctrl-fullscreen\"),this._updateTitle(),this._fullscreen?(this.fire(new o.l(\"fullscreenstart\")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l(\"fullscreenend\")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle(\"maplibregl-pseudo-fullscreen\"),this._handleFullscreenChange(),this._map.resize()}},i.GeoJSONSource=Oi,i.GeolocateControl=class extends o.E{constructor(I){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.l(\"outofmaxbounds\",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case\"WAITING_ACTIVE\":case\"ACTIVE_LOCK\":case\"ACTIVE_ERROR\":this._watchState=\"ACTIVE_LOCK\",this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-waiting\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-active-error\"),this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-active\");break;case\"BACKGROUND\":case\"BACKGROUND_ERROR\":this._watchState=\"BACKGROUND\",this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-waiting\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-background-error\"),this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-background\");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!==\"OFF\"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!==\"ACTIVE_LOCK\"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove(\"maplibregl-user-location-dot-stale\"),this.fire(new o.l(\"geolocate\",l)),this._finish()}},this._updateCamera=l=>{let f=new o.V(l.coords.longitude,l.coords.latitude),y=l.coords.accuracy,w=this._map.getBearing(),P=o.e({bearing:w},this.options.fitBoundsOptions),L=mr.fromLngLat(f,y);this._map.fitBounds(L,P,{geolocateSource:!0})},this._updateMarker=l=>{if(l){let f=new o.V(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(f).addTo(this._map),this._userLocationDotMarker.setLngLat(f).addTo(this._map),this._accuracy=l.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=l=>{if(this._map){if(l.code===1){this._watchState=\"OFF\",this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-waiting\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-active\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-active-error\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-background\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-background-error\"),this._geolocateButton.disabled=!0;let f=this._map._getUIString(\"GeolocateControl.LocationNotAvailable\");this._geolocateButton.title=f,this._geolocateButton.setAttribute(\"aria-label\",f),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&Pu)return;this._setErrorState()}this._watchState!==\"OFF\"&&this.options.showUserLocation&&this._dotElement.classList.add(\"maplibregl-user-location-dot-stale\"),this.fire(new o.l(\"error\",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener(\"contextmenu\",(l=>l.preventDefault())),this._geolocateButton=V.create(\"button\",\"maplibregl-ctrl-geolocate\",this._container),V.create(\"span\",\"maplibregl-ctrl-icon\",this._geolocateButton).setAttribute(\"aria-hidden\",\"true\"),this._geolocateButton.type=\"button\",this._geolocateButton.disabled=!0)},this._finishSetupUI=l=>{if(this._map){if(l===!1){o.w(\"Geolocation support is not available so the GeolocateControl will be disabled.\");let f=this._map._getUIString(\"GeolocateControl.LocationNotAvailable\");this._geolocateButton.disabled=!0,this._geolocateButton.title=f,this._geolocateButton.setAttribute(\"aria-label\",f)}else{let f=this._map._getUIString(\"GeolocateControl.FindMyLocation\");this._geolocateButton.disabled=!1,this._geolocateButton.title=f,this._geolocateButton.setAttribute(\"aria-label\",f)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute(\"aria-pressed\",\"false\"),this._watchState=\"OFF\"),this.options.showUserLocation&&(this._dotElement=V.create(\"div\",\"maplibregl-user-location-dot\"),this._userLocationDotMarker=new Lh({element:this._dotElement}),this._circleElement=V.create(\"div\",\"maplibregl-user-location-accuracy-circle\"),this._accuracyCircleMarker=new Lh({element:this._circleElement,pitchAlignment:\"map\"}),this.options.trackUserLocation&&(this._watchState=\"OFF\"),this._map.on(\"zoom\",this._onUpdate),this._map.on(\"move\",this._onUpdate),this._map.on(\"rotate\",this._onUpdate),this._map.on(\"pitch\",this._onUpdate)),this._geolocateButton.addEventListener(\"click\",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on(\"movestart\",(f=>{let y=f?.[0]instanceof ResizeObserverEntry;f.geolocateSource||this._watchState!==\"ACTIVE_LOCK\"||y||this._map.isZooming()||(this._watchState=\"BACKGROUND\",this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-background\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-active\"),this.fire(new o.l(\"trackuserlocationend\")),this.fire(new o.l(\"userlocationlostfocus\")))}))}},this.options=o.e({},L0,I)}onAdd(I){return this._map=I,this._container=V.create(\"div\",\"maplibregl-ctrl maplibregl-ctrl-group\"),this._setupUI(),(function(){return o._(this,arguments,void 0,(function*(l=!1){if(Na!==void 0&&!l)return Na;if(window.navigator.permissions===void 0)return Na=!!window.navigator.geolocation,Na;try{Na=(yield window.navigator.permissions.query({name:\"geolocation\"})).state!==\"denied\"}catch{Na=!!window.navigator.geolocation}return Na}))})().then((l=>this._finishSetupUI(l))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),V.remove(this._container),this._map.off(\"zoom\",this._onUpdate),this._map.off(\"move\",this._onUpdate),this._map.off(\"rotate\",this._onUpdate),this._map.off(\"pitch\",this._onUpdate),this._map=void 0,zc=0,Pu=!1}_isOutOfMapMaxBounds(I){let l=this._map.getMaxBounds(),f=I.coords;return l&&(f.longitude<l.getWest()||f.longitude>l.getEast()||f.latitude<l.getSouth()||f.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case\"WAITING_ACTIVE\":this._watchState=\"ACTIVE_ERROR\",this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-active\"),this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-active-error\");break;case\"ACTIVE_LOCK\":this._watchState=\"ACTIVE_ERROR\",this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-active\"),this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-active-error\"),this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-waiting\");break;case\"BACKGROUND\":this._watchState=\"BACKGROUND_ERROR\",this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-background\"),this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-background-error\"),this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-waiting\");break;case\"ACTIVE_ERROR\":case\"BACKGROUND_ERROR\":case\"OFF\":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){let I=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&I))return;let l=this._map.project(I),f=this._map.unproject([l.x+100,l.y]),y=I.distanceTo(f)/100,w=2*this._accuracy/y;this._circleElement.style.width=`${w.toFixed(2)}px`,this._circleElement.style.height=`${w.toFixed(2)}px`}trigger(){if(!this._setup)return o.w(\"Geolocate control triggered before added to a map\"),!1;if(this.options.trackUserLocation){switch(this._watchState){case\"OFF\":this._watchState=\"WAITING_ACTIVE\",this.fire(new o.l(\"trackuserlocationstart\"));break;case\"WAITING_ACTIVE\":case\"ACTIVE_LOCK\":case\"ACTIVE_ERROR\":case\"BACKGROUND_ERROR\":zc--,Pu=!1,this._watchState=\"OFF\",this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-waiting\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-active\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-active-error\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-background\"),this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-background-error\"),this.fire(new o.l(\"trackuserlocationend\"));break;case\"BACKGROUND\":this._watchState=\"ACTIVE_LOCK\",this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-background\"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l(\"trackuserlocationstart\")),this.fire(new o.l(\"userlocationfocus\"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case\"WAITING_ACTIVE\":this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-waiting\"),this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-active\");break;case\"ACTIVE_LOCK\":this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-active\");break;case\"OFF\":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState===\"OFF\"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let I;this._geolocateButton.classList.add(\"maplibregl-ctrl-geolocate-waiting\"),this._geolocateButton.setAttribute(\"aria-pressed\",\"true\"),zc++,zc>1?(I={maximumAge:6e5,timeout:0},Pu=!0):(I=this.options.positionOptions,Pu=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,I)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove(\"maplibregl-ctrl-geolocate-waiting\"),this._geolocateButton.setAttribute(\"aria-pressed\",\"false\"),this.options.showUserLocation&&this._updateMarker(null)}},i.GlobeControl=class{constructor(){this._toggleProjection=()=>{var I;let l=(I=this._map.getProjection())===null||I===void 0?void 0:I.type;this._map.setProjection(l!==\"mercator\"&&l?{type:\"mercator\"}:{type:\"globe\"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var I;this._globeButton.classList.remove(\"maplibregl-ctrl-globe\"),this._globeButton.classList.remove(\"maplibregl-ctrl-globe-enabled\"),((I=this._map.getProjection())===null||I===void 0?void 0:I.type)===\"globe\"?(this._globeButton.classList.add(\"maplibregl-ctrl-globe-enabled\"),this._globeButton.title=this._map._getUIString(\"GlobeControl.Disable\")):(this._globeButton.classList.add(\"maplibregl-ctrl-globe\"),this._globeButton.title=this._map._getUIString(\"GlobeControl.Enable\"))}}onAdd(I){return this._map=I,this._container=V.create(\"div\",\"maplibregl-ctrl maplibregl-ctrl-group\"),this._globeButton=V.create(\"button\",\"maplibregl-ctrl-globe\",this._container),V.create(\"span\",\"maplibregl-ctrl-icon\",this._globeButton).setAttribute(\"aria-hidden\",\"true\"),this._globeButton.type=\"button\",this._globeButton.addEventListener(\"click\",this._toggleProjection),this._updateGlobeIcon(),this._map.on(\"styledata\",this._updateGlobeIcon),this._container}onRemove(){V.remove(this._container),this._map.off(\"styledata\",this._updateGlobeIcon),this._globeButton.removeEventListener(\"click\",this._toggleProjection),this._map=void 0}},i.Hash=Fd,i.ImageSource=Fr,i.KeyboardHandler=ci,i.LngLatBounds=mr,i.LogoControl=zg,i.Map=class extends qs{get _ownerWindow(){var I,l;return((l=(I=this._container)===null||I===void 0?void 0:I.ownerDocument)===null||l===void 0?void 0:l.defaultView)||window}constructor(I){var l,f;o.cH.mark(o.cI.create);let y=Object.assign(Object.assign(Object.assign({},Zd),I),{canvasContextAttributes:Object.assign(Object.assign({},Zd.canvasContextAttributes),I.canvasContextAttributes)});if(y.minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error(\"maxZoom must be greater than or equal to minZoom\");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error(\"maxPitch must be greater than or equal to minPitch\");if(y.minPitch!=null&&y.minPitch<0)throw new Error(\"minPitch must be greater than or equal to 0\");if(y.maxPitch!=null&&y.maxPitch>180)throw new Error(\"maxPitch must be less than or equal to 180\");let w=new Af,P=new gf;y.minZoom!==void 0&&w.setMinZoom(y.minZoom),y.maxZoom!==void 0&&w.setMaxZoom(y.maxZoom),y.minPitch!==void 0&&w.setMinPitch(y.minPitch),y.maxPitch!==void 0&&w.setMaxPitch(y.maxPitch),y.renderWorldCopies!==void 0&&w.setRenderWorldCopies(y.renderWorldCopies),y.transformConstrain!==null&&w.setConstrainOverride(y.transformConstrain),super(w,P,{bearingSnap:y.bearingSnap,zoomSnap:y.zoomSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Sx,this._controls=[],this._mapId=o.af(),this._lostContextStyle={style:null,images:null},this._contextLost=z=>{z.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(let G of Object.values(this.style._layers))if(G.type===\"custom\"&&console.warn(`Custom layer with id '${G.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),G._listeners)for(let[j]of Object.entries(G._listeners))console.warn(`Custom layer with id '${G.id}' had event listeners for event '${j}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new o.l(\"webglcontextlost\",{originalEvent:z}))},this._contextRestored=z=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new o.l(\"webglcontextrestored\",{originalEvent:z}))},this._onMapScroll=z=>{if(z.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=y.interactive,this._maxTileCacheSize=y.maxTileCacheSize,this._maxTileCacheZoomLevels=y.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},y.canvasContextAttributes),this._trackResize=y.trackResize===!0,this._bearingSnap=y.bearingSnap,this._zoomSnap=y.zoomSnap,this._centerClampedToGround=y.centerClampedToGround,this._refreshExpiredTiles=y.refreshExpiredTiles===!0,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions===!0,this._collectResourceTiming=y.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},D0),y.locale),this._clickTolerance=y.clickTolerance,this._overridePixelRatio=y.pixelRatio,this._maxCanvasSize=y.maxCanvasSize,this._zoomLevelsToOverscale=y.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=y.transformCameraUpdate,this.transformConstrain=y.transformConstrain,this.cancelPendingTileRequestsWhileZooming=y.cancelPendingTileRequestsWhileZooming===!0,y.reduceMotion!==void 0&&(C.prefersReducedMotion=y.reduceMotion),this._imageQueueHandle=xe.addThrottleControl((()=>this.isMoving())),this._requestManager=new Ee(y.transformRequest),this._container=this._resolveContainer(y.container),y.maxBounds&&this.setMaxBounds(y.maxBounds),this._setupContainer(),this._setupPainter(),this.on(\"move\",(()=>this._update(!1))),this.on(\"moveend\",(()=>this._update(!1))),this.on(\"zoom\",(()=>this._update(!0))),this.on(\"terrain\",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once(\"idle\",(()=>{this._idleTriggered=!0})),typeof window<\"u\"&&(this._ownerWindow.addEventListener(\"online\",this._onWindowOnline,!1),this._setupResizeObserver()),this.handlers=new Xd(this,y),this._hash=y.hash&&new Fd(typeof y.hash==\"string\"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,elevation:y.elevation,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch,roll:y.roll}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,o.e({},y.fitBoundsOptions,{duration:0}))));let L=typeof y.style==\"string\"||((f=(l=y.style)===null||l===void 0?void 0:l.projection)===null||f===void 0?void 0:f.type)!==\"globe\";this.resize(null,L),this._localIdeographFontFamily=y.localIdeographFontFamily,this._validateStyle=y.validateStyle,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new Nl(typeof y.attributionControl==\"boolean\"?void 0:y.attributionControl)),y.maplibreLogo&&this.addControl(new zg,y.logoPosition),this.on(\"style.load\",(()=>{if(L||this._resizeTransform(),this.transform.unmodified){let z=o.U(this.style.stylesheet,[\"center\",\"zoom\",\"bearing\",\"pitch\",\"roll\"]);this.jumpTo(z)}})),this.on(\"data\",(z=>{this._update(z.dataType===\"style\"),this.fire(new o.l(`${z.dataType}data`,z))})),this.on(\"dataloading\",(z=>{this.fire(new o.l(`${z.dataType}dataloading`,z))})),this.on(\"dataabort\",(z=>{this.fire(new o.l(\"sourcedataabort\",z))}))}_getMapId(){return this._mapId}setGlobalStateProperty(I,l){return this.style.setGlobalStateProperty(I,l),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(I,l){if(l===void 0&&(l=I.getDefaultPosition?I.getDefaultPosition():\"top-right\"),!I||!I.onAdd)return this.fire(new o.k(new Error(\"Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.\")));let f=I.onAdd(this);this._controls.push(I);let y=this._controlPositions[l];return l.indexOf(\"bottom\")!==-1?y.insertBefore(f,y.firstChild):y.appendChild(f),this}removeControl(I){if(!I||!I.onRemove)return this.fire(new o.k(new Error(\"Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.\")));let l=this._controls.indexOf(I);return l>-1&&this._controls.splice(l,1),I.onRemove(this),this}hasControl(I){return this._controls.indexOf(I)>-1}coveringTiles(I){return Et(this.transform,I)}calculateCameraOptionsFromTo(I,l,f,y){return y==null&&this.terrain&&(y=this.terrain.getElevationForLngLat(f,this.transform)),super.calculateCameraOptionsFromTo(I,l,f,y)}resize(I,l=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(l);let f=!this._moving;return f&&(this.stop(),this.fire(new o.l(\"movestart\",I)).fire(new o.l(\"move\",I))),this.fire(new o.l(\"resize\",I)),f&&this.fire(new o.l(\"moveend\",I)),this}_resizeInternal(I=!0){let[l,f]=this._containerDimensions(),y=this._getClampedPixelRatio(l,f);if(this._resizeCanvas(l,f,y),this.painter.resize(l,f,y),this.painter.overLimit()){let w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];let P=this._getClampedPixelRatio(l,f);this._resizeCanvas(l,f,P),this.painter.resize(l,f,P)}this._resizeTransform(I)}_resizeTransform(I=!0){var l;let[f,y]=this._containerDimensions();this.transform.resize(f,y,I),(l=this._requestedCameraState)===null||l===void 0||l.resize(f,y,I)}_getClampedPixelRatio(I,l){let{0:f,1:y}=this._maxCanvasSize,w=this.getPixelRatio(),P=I*w,L=l*w;return Math.min(P>f?f/P:1,L>y?y/L:1)*w}getPixelRatio(){var I;return(I=this._overridePixelRatio)!==null&&I!==void 0?I:devicePixelRatio}setPixelRatio(I){this._overridePixelRatio=I,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(I){return this.transform.setMaxBounds(mr.convert(I)),this._update()}setMinZoom(I){if((I=I??-2)>=-2&&I<=this.transform.maxZoom){let l=this.transform.zoom,f=this._getTransformForUpdate();return f.setMinZoom(I),this._applyUpdatedTransform(f),this._update(),l!==this.transform.zoom&&this.fire(new o.l(\"zoomstart\")).fire(new o.l(\"zoom\")).fire(new o.l(\"zoomend\")).fire(new o.l(\"movestart\")).fire(new o.l(\"move\")).fire(new o.l(\"moveend\")),this}throw new Error(\"minZoom must be between -2 and the current maxZoom, inclusive\")}getMinZoom(){return this.transform.minZoom}setMaxZoom(I){if((I=I??22)>=this.transform.minZoom){let l=this.transform.zoom,f=this._getTransformForUpdate();return f.setMaxZoom(I),this._applyUpdatedTransform(f),this._update(),l!==this.transform.zoom&&this.fire(new o.l(\"zoomstart\")).fire(new o.l(\"zoom\")).fire(new o.l(\"zoomend\")).fire(new o.l(\"movestart\")).fire(new o.l(\"move\")).fire(new o.l(\"moveend\")),this}throw new Error(\"maxZoom must be greater than the current minZoom\")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(I){if((I=I??0)<0)throw new Error(\"minPitch must be greater than or equal to 0\");if(I>=0&&I<=this.transform.maxPitch){let l=this.transform.pitch,f=this._getTransformForUpdate();return f.setMinPitch(I),this._applyUpdatedTransform(f),this._update(),l!==this.transform.pitch&&this.fire(new o.l(\"pitchstart\")).fire(new o.l(\"pitch\")).fire(new o.l(\"pitchend\")).fire(new o.l(\"movestart\")).fire(new o.l(\"move\")).fire(new o.l(\"moveend\")),this}throw new Error(\"minPitch must be between 0 and the current maxPitch, inclusive\")}getMinPitch(){return this.transform.minPitch}setMaxPitch(I){if((I=I??60)>180)throw new Error(\"maxPitch must be less than or equal to 180\");if(I>=this.transform.minPitch){let l=this.transform.pitch,f=this._getTransformForUpdate();return f.setMaxPitch(I),this._applyUpdatedTransform(f),this._update(),l!==this.transform.pitch&&this.fire(new o.l(\"pitchstart\")).fire(new o.l(\"pitch\")).fire(new o.l(\"pitchend\")).fire(new o.l(\"movestart\")).fire(new o.l(\"move\")).fire(new o.l(\"moveend\")),this}throw new Error(\"maxPitch must be greater than the current minPitch\")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(I){return this.transform.setRenderWorldCopies(I),this._update()}setTransformConstrain(I){return this.transform.setConstrainOverride(I),this._update()}project(I){return this.transform.locationToScreenPoint(o.V.convert(I),this.style&&this.terrain)}unproject(I){return this.transform.screenPointToLocation(o.P.convert(I),this.terrain)}isMoving(){var I;return this._moving||((I=this.handlers)===null||I===void 0?void 0:I.isMoving())}isZooming(){var I;return this._zooming||((I=this.handlers)===null||I===void 0?void 0:I.isZooming())}isRotating(){var I;return this._rotating||((I=this.handlers)===null||I===void 0?void 0:I.isRotating())}_createDelegatedListener(I,l,f){if(I===\"mouseenter\"||I===\"mouseover\"){let y=!1;return{layers:l,listener:f,delegates:{mousemove:P=>{let L=l.filter((G=>this.getLayer(G))),z=L.length!==0?this.queryRenderedFeatures(P.point,{layers:L}):[];z.length?y||(y=!0,f.call(this,new es(I,this,P.originalEvent,{features:z}))):y=!1},mouseout:()=>{y=!1}}}}if(I===\"mouseleave\"||I===\"mouseout\"){let y=!1;return{layers:l,listener:f,delegates:{mousemove:L=>{let z=l.filter((G=>this.getLayer(G)));(z.length!==0?this.queryRenderedFeatures(L.point,{layers:z}):[]).length?y=!0:y&&(y=!1,f.call(this,new es(I,this,L.originalEvent)))},mouseout:L=>{y&&(y=!1,f.call(this,new es(I,this,L.originalEvent)))}}}}{let y=w=>{let P=l.filter((z=>this.getLayer(z))),L=P.length!==0?this.queryRenderedFeatures(w.point,{layers:P}):[];L.length&&(w.features=L,f.call(this,w),delete w.features)};return{layers:l,listener:f,delegates:{[I]:y}}}}_saveDelegatedListener(I,l){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[I]=this._delegatedListeners[I]||[],this._delegatedListeners[I].push(l)}_removeDelegatedListener(I,l,f){if(!this._delegatedListeners||!this._delegatedListeners[I])return;let y=this._delegatedListeners[I];for(let w=0;w<y.length;w++){let P=y[w];if(P.listener===f&&P.layers.length===l.length&&P.layers.every((L=>l.includes(L)))){for(let L in P.delegates)this.off(L,P.delegates[L]);return void y.splice(w,1)}}}on(I,l,f){if(f===void 0)return super.on(I,l);let y=typeof l==\"string\"?[l]:l,w=this._createDelegatedListener(I,y,f);this._saveDelegatedListener(I,w);for(let P in w.delegates)this.on(P,w.delegates[P]);return{unsubscribe:()=>{this._removeDelegatedListener(I,y,f)}}}once(I,l,f){if(f===void 0)return super.once(I,l);let y=typeof l==\"string\"?[l]:l,w=this._createDelegatedListener(I,y,f);for(let P in w.delegates){let L=w.delegates[P];w.delegates[P]=(...z)=>{this._removeDelegatedListener(I,y,f),L(...z)}}this._saveDelegatedListener(I,w);for(let P in w.delegates)this.once(P,w.delegates[P]);return this}off(I,l,f){return f===void 0?super.off(I,l):(this._removeDelegatedListener(I,typeof l==\"string\"?[l]:l,f),this)}queryRenderedFeatures(I,l){if(!this.style)return[];let f,y=I instanceof o.P||Array.isArray(I),w=y?I:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(y?{}:I)||{},w instanceof o.P||typeof w[0]==\"number\")f=[o.P.convert(w)];else{let P=o.P.convert(w[0]),L=o.P.convert(w[1]);f=[P,new o.P(L.x,P.y),L,new o.P(P.x,L.y),P]}return this.style.queryRenderedFeatures(f,l,this.transform)}querySourceFeatures(I,l){return this.style.querySourceFeatures(I,l)}setStyle(I,l){return(l=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&I?(this._diffStyle(I,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(I,l))}setTransformRequest(I){return this._requestManager.setTransformRequest(I),this}_getUIString(I){let l=this._locale[I];if(l==null)throw new Error(`Missing UI string '${I}'`);return l}_updateStyle(I,l){var f,y;if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once(\"style.load\",(()=>this._updateStyle(I,l)));let w=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!I)),I?(this.style=new Xi(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof I==\"string\"?this.style.loadURL(I,l,w):this.style.loadJSON(I,l,w),this):((y=(f=this.style)===null||f===void 0?void 0:f.projection)===null||y===void 0||y.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Xi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(I,l){if(typeof I==\"string\"){let f=this._requestManager.transformRequest(I,\"Style\");o.j(f,new AbortController).then((y=>{this._updateDiff(y.data,l)})).catch((y=>{y&&this.fire(new o.k(y))}))}else typeof I==\"object\"&&this._updateDiff(I,l)}_updateDiff(I,l){try{this.style.setState(I,l)&&this._update(!0)}catch(f){o.w(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(I,l)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():o.w(\"There is no style added to the map.\")}addSource(I,l){return this._lazyInitEmptyStyle(),this.style.addSource(I,l),this._update(!0)}isSourceLoaded(I){let l=this.style&&this.style.tileManagers[I];if(l!==void 0)return l.loaded();this.fire(new o.k(new Error(`There is no tile manager with ID '${I}'`)))}setTerrain(I){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off(\"data\",this._terrainDataCallback),I){let l=this.style.tileManagers[I.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${I.source}`);this.terrain===null&&l.reload();for(let f in this.style._layers){let y=this.style._layers[f];y.type===\"hillshade\"&&y.source===I.source&&o.w(\"You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.\"),y.type===\"color-relief\"&&y.source===I.source&&o.w(\"You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.\")}this.terrain=new Yi(this.painter,l,I),this.painter.renderToTexture=new Dh(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=f=>{var y;f.dataType===\"style\"?this.terrain.tileManager.freeRtt():f.dataType===\"source\"&&f.tile&&(f.sourceId!==I.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((y=f.source)===null||y===void 0?void 0:y.type)===\"image\"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(f.tile.tileID))},this.style.on(\"data\",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l(\"terrain\",{terrain:I})),this}getTerrain(){var I,l;return(l=(I=this.terrain)===null||I===void 0?void 0:I.options)!==null&&l!==void 0?l:null}areTilesLoaded(){let I=this.style&&this.style.tileManagers;for(let l of Object.values(I))if(!l.areTilesLoaded())return!1;return!0}removeSource(I){return this.style.removeSource(I),this._update(!0)}getSource(I){return this.style.getSource(I)}setSourceTileLodParams(I,l,f){if(f){let y=this.getSource(f);if(!y)throw new Error(`There is no source with ID \"${f}\", cannot set LOD parameters`);y.calculateTileZoom=ln(Math.max(1,I),Math.max(1,l))}else for(let y in this.style.tileManagers)this.style.tileManagers[y].getSource().calculateTileZoom=ln(Math.max(1,I),Math.max(1,l));return this._update(!0),this}refreshTiles(I,l){let f=this.style.tileManagers[I];if(!f)throw new Error(`There is no tile manager with ID \"${I}\", cannot refresh tile`);l===void 0?f.reload(!0):f.refreshTiles(l.map((y=>new o.ac(y.z,y.x,y.y))))}addImage(I,l,f={}){let{pixelRatio:y=1,sdf:w=!1,stretchX:P,stretchY:L,content:z,textFitWidth:G,textFitHeight:j}=f;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||o.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new o.k(new Error(\"Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`\")));{let{width:Q,height:ie,data:re}=l,ce=l;return this.style.addImage(I,{data:new o.R({width:Q,height:ie},new Uint8Array(re)),pixelRatio:y,stretchX:P,stretchY:L,content:z,textFitWidth:G,textFitHeight:j,sdf:w,version:0,userImage:ce}),ce.onAdd&&ce.onAdd(this,I),this}}{let{width:Q,height:ie,data:re}=C.getImageData(l);this.style.addImage(I,{data:new o.R({width:Q,height:ie},re),pixelRatio:y,stretchX:P,stretchY:L,content:z,textFitWidth:G,textFitHeight:j,sdf:w,version:0})}}updateImage(I,l){let f=this.style.getImage(I);if(!f)return this.fire(new o.k(new Error(\"The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.\")));let y=l instanceof HTMLImageElement||o.b(l)?C.getImageData(l):l,{width:w,height:P,data:L}=y;if(w===void 0||P===void 0)return this.fire(new o.k(new Error(\"Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`\")));if(w!==f.data.width||P!==f.data.height)return this.fire(new o.k(new Error(\"The width and height of the updated image must be that same as the previous version of the image\")));let z=!(l instanceof HTMLImageElement||o.b(l));return f.data.replace(L,z),this.style.updateImage(I,f),this}getImage(I){return this.style.getImage(I)}hasImage(I){return I?!!this.style.getImage(I):(this.fire(new o.k(new Error(\"Missing required image id\"))),!1)}removeImage(I){this.style.removeImage(I)}loadImage(I){return xe.getImage(this._requestManager.transformRequest(I,\"Image\"),new AbortController)}listImages(){return this.style.listImages()}addLayer(I,l){return this._lazyInitEmptyStyle(),this.style.addLayer(I,l),this._update(!0)}moveLayer(I,l){return this.style.moveLayer(I,l),this._update(!0)}removeLayer(I){return this.style.removeLayer(I),this._update(!0)}getLayer(I){return this.style.getLayer(I)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(I,l,f){return this.style.setLayerZoomRange(I,l,f),this._update(!0)}setFilter(I,l,f={}){return this.style.setFilter(I,l,f),this._update(!0)}getFilter(I){return this.style.getFilter(I)}setPaintProperty(I,l,f,y={}){return this.style.setPaintProperty(I,l,f,y),this._update(!0)}getPaintProperty(I,l){return this.style.getPaintProperty(I,l)}setLayoutProperty(I,l,f,y={}){return this.style.setLayoutProperty(I,l,f,y),this._update(!0)}getLayoutProperty(I,l){return this.style.getLayoutProperty(I,l)}setGlyphs(I,l={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(I,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(I,l,f={}){return this._lazyInitEmptyStyle(),this.style.addSprite(I,l,f,(y=>{y||this._update(!0)})),this}removeSprite(I){return this._lazyInitEmptyStyle(),this.style.removeSprite(I),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(I,l={}){return this._lazyInitEmptyStyle(),this.style.setSprite(I,l,(f=>{f||this._update(!0)})),this}setLight(I,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(I,l),this._update(!0)}getLight(){return this.style.getLight()}setSky(I,l={}){return this._lazyInitEmptyStyle(),this.style.setSky(I,l),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(I,l){return this.style.setFeatureState(I,l),this._update()}removeFeatureState(I,l){return this.style.removeFeatureState(I,l),this._update()}getFeatureState(I){return this.style.getFeatureState(I)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let I=0,l=0;return this._container&&(I=this._container.clientWidth||400,l=this._container.clientHeight||300),[I,l]}_setupResizeObserver(){var I;let l=!1,f=Lg((w=>{this._trackResize&&!this._removed&&(this.resize(w),this.redraw())}),50),y=(I=this._ownerWindow.ResizeObserver)!==null&&I!==void 0?I:ResizeObserver;this._resizeObserver=new y((w=>{l?f(w):l=!0})),this._resizeObserver.observe(this._container)}_resolveContainer(I){if(typeof I==\"string\"){let l=document.getElementById(I);if(!l)throw new Error(`Container '${I}' not found.`);return l}if(I instanceof HTMLElement||I&&typeof I==\"object\"&&I.nodeType===1)return I;throw new Error(\"Invalid type: 'container' must be a String or HTMLElement.\")}_setupContainer(){let I=this._container;I.classList.add(\"maplibregl-map\");let l=this._canvasContainer=V.create(\"div\",\"maplibregl-canvas-container\",I);this._interactive&&l.classList.add(\"maplibregl-interactive\"),this._canvas=V.create(\"canvas\",\"maplibregl-canvas\",l),this._canvas.addEventListener(\"webglcontextlost\",this._contextLost,!1),this._canvas.addEventListener(\"webglcontextrestored\",this._contextRestored,!1),this._canvas.setAttribute(\"tabindex\",this._interactive?\"0\":\"-1\"),this._canvas.setAttribute(\"aria-label\",this._getUIString(\"Map.Title\")),this._canvas.setAttribute(\"role\",\"region\");let f=this._containerDimensions(),y=this._getClampedPixelRatio(f[0],f[1]);this._resizeCanvas(f[0],f[1],y);let w=this._controlContainer=V.create(\"div\",\"maplibregl-control-container\",I),P=this._controlPositions={};[\"top-left\",\"top-right\",\"bottom-left\",\"bottom-right\"].forEach((L=>{P[L]=V.create(\"div\",`maplibregl-ctrl-${L} `,w)})),this._container.addEventListener(\"scroll\",this._onMapScroll,!1)}_resizeCanvas(I,l,f){this._canvas.width=Math.floor(f*I),this._canvas.height=Math.floor(f*l),this._canvas.style.width=`${I}px`,this._canvas.style.height=`${l}px`}_setupPainter(){let I=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0}),l=null;this._canvas.addEventListener(\"webglcontextcreationerror\",(y=>{l={requestedAttributes:I},y&&(l.statusMessage=y.statusMessage,l.type=y.type)}),{once:!0});let f=null;if(f=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,I):this._canvas.getContext(\"webgl2\",I)||this._canvas.getContext(\"webgl\",I),!f){let y=\"Failed to initialize WebGL\";throw l?(l.message=y,new Error(JSON.stringify(l))):new Error(y)}this.painter=new S0(f,this.transform),q.testSupport(f)}migrateProjection(I,l){super.migrateProjection(I,l),this.painter.transform=I,this.fire(new o.l(\"projectiontransition\",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(I){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||I,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(I){return this._update(),this._renderTaskQueue.add(I)}_cancelRenderFrame(I){this._renderTaskQueue.remove(I)}_render(I){var l,f,y,w,P;let L=this._idleTriggered?this._fadeDuration:0,z=((l=this.style.projection)===null||l===void 0?void 0:l.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(I),this._removed)return;let G=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let ie=this.transform.zoom,re=k();this.style.zoomHistory.update(ie,re);let ce=new o.H(ie,{now:re,fadeDuration:L,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),de=ce.crossFadingFactor();de===1&&de===this._crossFadingFactor||(G=!0,this._crossFadingFactor=de),this.style.update(ce)}let j=((f=this.style.projection)===null||f===void 0?void 0:f.transitionState)>0!==z;(y=this.style.projection)===null||y===void 0||y.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((w=this.style.projection)===null||w===void 0?void 0:w.transitionState,(P=this.style.projection)===null||P===void 0?void 0:P.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||j)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,L,this._crossSourceCollisions,j),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:L,showPadding:this.showPadding}),this.fire(new o.l(\"render\")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cH.mark(o.cI.load),this.fire(new o.l(\"load\"))),this.style&&(this.style.hasTransitions()||G)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let Q=this._sourcesDirty||this._styleDirty||this._placementDirty;return Q||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l(\"idle\")),!this._loaded||this._fullyLoaded||Q||(this._fullyLoaded=!0,o.cH.mark(o.cI.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var I;this._hash&&this._hash.remove();for(let f of this._controls)f.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<\"u\"&&this._ownerWindow.removeEventListener(\"online\",this._onWindowOnline,!1),xe.removeThrottleControl(this._imageQueueHandle),(I=this._resizeObserver)===null||I===void 0||I.disconnect();let l=this.painter.context.gl.getExtension(\"WEBGL_lose_context\");l?.loseContext&&l.loseContext(),this._canvas.removeEventListener(\"webglcontextrestored\",this._contextRestored,!1),this._canvas.removeEventListener(\"webglcontextlost\",this._contextLost,!1),V.remove(this._canvasContainer),V.remove(this._controlContainer),this._container.removeEventListener(\"scroll\",this._onMapScroll,!1),this._container.classList.remove(\"maplibregl-map\"),o.cH.clearMetrics(),this._removed=!0,this.fire(new o.l(\"remove\"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,C.frame(this._frameRequest,(I=>{o.cH.frame(I),this._frameRequest=null;try{this._render(I)}catch(l){if(!o.Z(l)&&!(function(f){return f.message===Ig})(l))throw l}}),(()=>{}),this._ownerWindow))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(I){this._showTileBoundaries!==I&&(this._showTileBoundaries=I,this._update())}get showPadding(){return!!this._showPadding}set showPadding(I){this._showPadding!==I&&(this._showPadding=I,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(I){this._showCollisionBoxes!==I&&(this._showCollisionBoxes=I,I?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(I){this._showOverdrawInspector!==I&&(this._showOverdrawInspector=I,this._update())}get repaint(){return!!this._repaint}set repaint(I){this._repaint!==I&&(this._repaint=I,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(I){this._vertices=I,this._update()}get version(){return Bf}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(I){return this._lazyInitEmptyStyle(),this.style.setProjection(I),this._update(!0)}},i.MapMouseEvent=es,i.MapTouchEvent=ts,i.MapWheelEvent=C0,i.Marker=Lh,i.NavigationControl=class{constructor(I){this._updateZoomButtons=()=>{let l=this._map.getZoom(),f=l===this._map.getMaxZoom(),y=l===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute(\"aria-disabled\",f.toString()),this._zoomOutButton.setAttribute(\"aria-disabled\",y.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(l,f)=>{let y=this._map._getUIString(`NavigationControl.${f}`);l.title=y,l.setAttribute(\"aria-label\",y)},this.options=o.e({},Ug,I),this._container=V.create(\"div\",\"maplibregl-ctrl maplibregl-ctrl-group\"),this._container.addEventListener(\"contextmenu\",(l=>l.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton(\"maplibregl-ctrl-zoom-in\",(l=>this._map.zoomIn({},{originalEvent:l}))),V.create(\"span\",\"maplibregl-ctrl-icon\",this._zoomInButton).setAttribute(\"aria-hidden\",\"true\"),this._zoomOutButton=this._createButton(\"maplibregl-ctrl-zoom-out\",(l=>this._map.zoomOut({},{originalEvent:l}))),V.create(\"span\",\"maplibregl-ctrl-icon\",this._zoomOutButton).setAttribute(\"aria-hidden\",\"true\")),this.options.showCompass&&(this._compass=this._createButton(\"maplibregl-ctrl-compass\",(l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})})),this._compassIcon=V.create(\"span\",\"maplibregl-ctrl-icon\",this._compass),this._compassIcon.setAttribute(\"aria-hidden\",\"true\"))}onAdd(I){return this._map=I,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,\"ZoomIn\"),this._setButtonTitle(this._zoomOutButton,\"ZoomOut\"),this._map.on(\"zoom\",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,\"ResetBearing\"),this.options.visualizePitch&&this._map.on(\"pitch\",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on(\"roll\",this._rotateCompassArrow),this._map.on(\"rotate\",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qd(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){V.remove(this._container),this.options.showZoom&&this._map.off(\"zoom\",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off(\"pitch\",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off(\"roll\",this._rotateCompassArrow),this._map.off(\"rotate\",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(I,l){let f=V.create(\"button\",I,this._container);return f.type=\"button\",f.addEventListener(\"click\",l),f}},i.Popup=class extends o.E{constructor(I){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:\"\")},this.remove=()=>(this._content&&V.remove(this._content),this._container&&(V.remove(this._container),delete this._container),this._map&&(this._map.off(\"move\",this._update),this._map.off(\"move\",this._onClose),this._map.off(\"click\",this._onClose),this._map.off(\"remove\",this.remove),this._map.off(\"mousemove\",this._onMouseMove),this._map.off(\"mouseup\",this._onMouseUp),this._map.off(\"drag\",this._onDrag),this._map._canvasContainer.classList.remove(\"maplibregl-track-pointer\"),delete this._map,this.fire(new o.l(\"close\"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=V.create(\"div\",\"maplibregl-popup\",this._map.getContainer()),this._tip=V.create(\"div\",\"maplibregl-popup-tip\",this._container),this._container.appendChild(this._content),this.options.className)for(let L of this.options.className.split(\" \"))this._container.classList.add(L);this._closeButton&&this._closeButton.setAttribute(\"aria-label\",this._map._getUIString(\"Popup.Close\")),this._trackPointer&&this._container.classList.add(\"maplibregl-popup-track-pointer\")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Qd(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!l)return;let f=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationToScreenPoint(this._lngLat));let y=this.options.anchor,w=F0(this.options.offset);if(!y){let L=this._container.offsetWidth,z=this._container.offsetHeight,G=(function(Q){var ie,re,ce,de;return Q?{top:(ie=Q.top)!==null&&ie!==void 0?ie:0,right:(re=Q.right)!==null&&re!==void 0?re:0,bottom:(ce=Q.bottom)!==null&&ce!==void 0?ce:0,left:(de=Q.left)!==null&&de!==void 0?de:0}:{top:0,right:0,bottom:0,left:0}})(this.options.padding),j;j=f.y+w.bottom.y<z+G.top?[\"top\"]:f.y>this._map.transform.height-z-G.bottom?[\"bottom\"]:[],f.x<L/2+G.left?j.push(\"left\"):f.x>this._map.transform.width-L/2-G.right&&j.push(\"right\"),y=j.length===0?\"bottom\":j.join(\"-\")}let P=f.add(w[y]);this.options.subpixelPositioning||(P=P.round()),V.setTransform(this._container,`${Nc[y]} translate(${P.x}px,${P.y}px)`),Df(this._container,y,\"popup\"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Gg),I)}addTo(I){return this._map&&this.remove(),this._map=I,this.options.closeOnClick&&this._map.on(\"click\",this._onClose),this.options.closeOnMove&&this._map.on(\"move\",this._onClose),this._map.on(\"remove\",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on(\"mousemove\",this._onMouseMove),this._map.on(\"mouseup\",this._onMouseUp),this._container&&this._container.classList.add(\"maplibregl-popup-track-pointer\"),this._map._canvasContainer.classList.add(\"maplibregl-track-pointer\")):this._map.on(\"move\",this._update),this.fire(new o.l(\"open\")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(I){return this._lngLat=o.V.convert(I),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on(\"move\",this._update),this._map.off(\"mousemove\",this._onMouseMove),this._container&&this._container.classList.remove(\"maplibregl-popup-track-pointer\"),this._map._canvasContainer.classList.remove(\"maplibregl-track-pointer\")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off(\"move\",this._update),this._map.on(\"mousemove\",this._onMouseMove),this._map.on(\"drag\",this._onDrag),this._container&&this._container.classList.add(\"maplibregl-popup-track-pointer\"),this._map._canvasContainer.classList.add(\"maplibregl-track-pointer\")),this}getElement(){return this._container}setText(I){return this.setDOMContent(document.createTextNode(I))}setHTML(I){let l=document.createDocumentFragment(),f=document.createElement(\"body\"),y;for(f.innerHTML=I;y=f.firstChild,y;)l.appendChild(y);return this.setDOMContent(l)}getMaxWidth(){var I;return(I=this._container)===null||I===void 0?void 0:I.style.maxWidth}setMaxWidth(I){return this.options.maxWidth=I,this._update(),this}setDOMContent(I){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=V.create(\"div\",\"maplibregl-popup-content\",this._container);return this._content.appendChild(I),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(I){return this._container&&this._container.classList.add(I),this}removeClassName(I){return this._container&&this._container.classList.remove(I),this}setOffset(I){return this.options.offset=I,this._update(),this}toggleClassName(I){if(this._container)return this._container.classList.toggle(I)}setSubpixelPositioning(I){this.options.subpixelPositioning=I}setPadding(I){this.options.padding=I,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=V.create(\"button\",\"maplibregl-popup-close-button\",this._content),this._closeButton.type=\"button\",this._closeButton.innerHTML=\"&#215;\",this._closeButton.addEventListener(\"click\",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let I=this._container.querySelector(O0);I&&I.focus()}},i.RasterDEMTileSource=Hi,i.RasterTileSource=Ys,i.ScaleControl=class{constructor(I){this._onMove=()=>{Kd(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,Kd(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Vg),I)}getDefaultPosition(){return\"bottom-left\"}onAdd(I){return this._map=I,this._container=V.create(\"div\",\"maplibregl-ctrl maplibregl-ctrl-scale\",I.getContainer()),this._map.on(\"move\",this._onMove),this._onMove(),this._container}onRemove(){V.remove(this._container),this._map.off(\"move\",this._onMove),this._map=void 0}},i.ScrollZoomHandler=P0,i.Style=Xi,i.TerrainControl=class{constructor(I){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove(\"maplibregl-ctrl-terrain\"),this._terrainButton.classList.remove(\"maplibregl-ctrl-terrain-enabled\"),this._map.terrain?(this._terrainButton.classList.add(\"maplibregl-ctrl-terrain-enabled\"),this._terrainButton.title=this._map._getUIString(\"TerrainControl.Disable\")):(this._terrainButton.classList.add(\"maplibregl-ctrl-terrain\"),this._terrainButton.title=this._map._getUIString(\"TerrainControl.Enable\"))},this.options=I}onAdd(I){return this._map=I,this._container=V.create(\"div\",\"maplibregl-ctrl maplibregl-ctrl-group\"),this._terrainButton=V.create(\"button\",\"maplibregl-ctrl-terrain\",this._container),V.create(\"span\",\"maplibregl-ctrl-icon\",this._terrainButton).setAttribute(\"aria-hidden\",\"true\"),this._terrainButton.type=\"button\",this._terrainButton.addEventListener(\"click\",this._toggleTerrain),this._updateTerrainIcon(),this._map.on(\"terrain\",this._updateTerrainIcon),this._container}onRemove(){V.remove(this._container),this._map.off(\"terrain\",this._updateTerrainIcon),this._map=void 0}},i.TwoFingersTouchPitchHandler=Z_,i.TwoFingersTouchRotateHandler=kg,i.TwoFingersTouchZoomHandler=Mu,i.TwoFingersTouchZoomRotateHandler=Wd,i.VectorTileSource=Xs,i.VideoSource=eo,i.addSourceType=(I,l)=>o._(void 0,void 0,void 0,(function*(){if(Sn(I))throw new Error(`A source type called \"${I}\" already exists.`);((f,y)=>{en[f]=y})(I,l)})),i.clearPrewarmedResources=function(){let I=Mr;I&&(I.isPreloaded()&&I.numActive()===1?(I.release(tr),Mr=null):console.warn(\"Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()\"))},i.createTileMesh=yx,i.getMaxParallelImageRequests=function(){return o.c.MAX_PARALLEL_IMAGE_REQUESTS},i.getRTLTextPluginStatus=function(){return pe().getRTLTextPluginStatus()},i.getVersion=function(){return Hg},i.getWorkerCount=function(){return on.workerCount},i.getWorkerUrl=function(){return o.c.WORKER_URL},i.importScriptInWorkers=function(I){return lo().broadcast(\"IS\",I)},i.isTimeFrozen=function(){return B.isFrozen()},i.now=k,i.prewarm=function(){Br().acquire(tr)},i.restoreNow=function(){B.restoreNow()},i.setMaxParallelImageRequests=function(I){o.c.MAX_PARALLEL_IMAGE_REQUESTS=I},i.setNow=function(I){B.setNow(I)},i.setRTLTextPlugin=function(I,l){return pe().setRTLTextPlugin(I,l)},i.setWorkerCount=function(I){on.workerCount=I},i.setWorkerUrl=function(I){o.c.WORKER_URL=I}}));var r=t;return r}))});var gC,GAe,mC,HAe,XX,CL=Kt(()=>{gC=globalThis,GAe=globalThis.document||{},mC=globalThis.process||{},HAe=globalThis.console,XX=globalThis.navigator||{}});function _C(t){if(typeof window<\"u\"&&window.process?.type===\"renderer\"||typeof process<\"u\"&&process.versions?.electron)return!0;let e=typeof navigator<\"u\"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf(\"Electron\")>=0)}var ML=Kt(()=>{});function Zl(){return!(typeof process==\"object\"&&String(process)===\"[object process]\"&&!process?.browser)||_C()}var IL=Kt(()=>{ML()});function PL(t){return!t&&!Zl()?\"Node\":_C(t)?\"Electron\":(t||XX.userAgent||\"\").indexOf(\"Edge\")>-1?\"Edge\":globalThis.chrome?\"Chrome\":globalThis.safari?\"Safari\":globalThis.mozInnerScreenX?\"Firefox\":\"Unknown\"}var YX=Kt(()=>{IL();ML();CL()});var RL,yA=Kt(()=>{CL();IL();YX();RL=\"4.1.0\"});function jAe(t){try{let e=window[t],n=\"__storage_test__\";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}var yC,ZX=Kt(()=>{yC=class{constructor(e,n,r=\"sessionStorage\"){this.storage=jAe(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){let n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){let n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}});function qX(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function QX(t,e=8){let n=Math.max(e-t.length,0);return`${\" \".repeat(n)}${t}`}var KX=Kt(()=>{});function JX(t){return typeof t!=\"string\"?t:(t=t.toUpperCase(),xC[t]||xC.WHITE)}function $X(t,e,n){return!Zl&&typeof t==\"string\"&&(e&&(t=`\\x1B[${JX(e)}m${t}\\x1B[39m`),n&&(t=`\\x1B[${JX(n)+XAe}m${t}\\x1B[49m`)),t}var xC,XAe,eY=Kt(()=>{yA();(function(t){t[t.BLACK=30]=\"BLACK\",t[t.RED=31]=\"RED\",t[t.GREEN=32]=\"GREEN\",t[t.YELLOW=33]=\"YELLOW\",t[t.BLUE=34]=\"BLUE\",t[t.MAGENTA=35]=\"MAGENTA\",t[t.CYAN=36]=\"CYAN\",t[t.WHITE=37]=\"WHITE\",t[t.BRIGHT_BLACK=90]=\"BRIGHT_BLACK\",t[t.BRIGHT_RED=91]=\"BRIGHT_RED\",t[t.BRIGHT_GREEN=92]=\"BRIGHT_GREEN\",t[t.BRIGHT_YELLOW=93]=\"BRIGHT_YELLOW\",t[t.BRIGHT_BLUE=94]=\"BRIGHT_BLUE\",t[t.BRIGHT_MAGENTA=95]=\"BRIGHT_MAGENTA\",t[t.BRIGHT_CYAN=96]=\"BRIGHT_CYAN\",t[t.BRIGHT_WHITE=97]=\"BRIGHT_WHITE\"})(xC||(xC={}));XAe=10});function tY(t,e=[\"constructor\"]){let n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(let o of r){let s=i[o];typeof s==\"function\"&&(e.find(c=>o===c)||(i[o]=s.bind(t)))}}var nY=Kt(()=>{});function qv(t,e){if(!t)throw new Error(e||\"Assertion failed\")}var rY=Kt(()=>{});function ym(){let t;if(Zl()&&gC.performance)t=gC?.performance?.now?.();else if(\"hrtime\"in mC){let e=mC?.hrtime?.();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}var iY=Kt(()=>{yA()});function uy(){}function lY(t){if(!t)return 0;let e;switch(typeof t){case\"number\":e=t;break;case\"object\":e=t.logLevel||t.priority||0;break;default:return 0}return qv(Number.isFinite(e)&&e>=0),e}function aY(t){let{logLevel:e,message:n}=t;t.logLevel=lY(e);let r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case\"string\":case\"function\":n!==void 0&&r.unshift(n),t.message=e;break;case\"object\":Object.assign(t,e);break;default:}typeof t.message==\"function\"&&(t.message=t.message());let i=typeof t.message;return qv(i===\"string\"||i===\"object\"),Object.assign(t,{args:r},t.opts)}function ZAe(t,e,n){if(typeof e==\"string\"){let r=n.time?QX(qX(n.total)):\"\";e=n.time?`${t}: ${r}  ${e}`:`${t}: ${e}`,e=$X(e,n.color,n.background)}return e}function qAe(t){for(let e in t)for(let n in t[e])return n||\"untitled\";return\"empty\"}var cy,YAe,oY,sY,xc,BL=Kt(()=>{yA();ZX();KX();eY();nY();rY();iY();cy={debug:Zl()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},YAe={enabled:!0,level:0};oY={},sY={once:!0},xc=class{constructor({id:e}={id:\"\"}){this.VERSION=RL,this._startTs=ym(),this._deltaTs=ym(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new yC(`__probe-${this.id}__`,YAe),this.timeStamp(`${this.id} started`),tY(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((ym()-this._startTs).toPrecision(10))}getDelta(){return Number((ym()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){if(!e)throw new Error(n||\"Assertion failed\")}warn(e){return this._getLogFunction(0,e,cy.warn,arguments,sY)}error(e){return this._getLogFunction(0,e,cy.error,arguments)}deprecated(e,n){return this.warn(`\\`${e}\\` is deprecated and will be removed in a later version. Use \\`${n}\\` instead`)}removed(e,n){return this.error(`\\`${e}\\` has been removed. Use \\`${n}\\` instead`)}probe(e,n){return this._getLogFunction(e,n,cy.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,cy.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,cy.debug||cy.info,arguments,sY)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||uy,r&&[r],{tag:qAe(n)}):uy}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||uy)}group(e,n,r={collapsed:!1}){let i=aY({logLevel:e,message:n,opts:r}),{collapsed:o}=r;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n,r={}){return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,\"\",console.groupEnd||uy)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=lY(e)}_getLogFunction(e,n,r,i,o){if(this._shouldLog(e)){o=aY({logLevel:e,message:n,args:i,opts:o}),r=r||o.method,qv(r),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=ym();let s=o.tag||o.message;if(o.once&&s)if(!oY[s])oY[s]=ym();else return uy;return n=ZAe(this.id,o.message,o),r.bind(console,n,...o.args)}return uy}};xc.VERSION=RL});var cY=Kt(()=>{globalThis.probe={}});var DL,hy=Kt(()=>{BL();BL();cY();DL=new xc({id:\"@probe.gl/log\"})});function nb(){let t;if(typeof window<\"u\"&&window.performance)t=window.performance.now();else if(typeof process<\"u\"&&process.hrtime){let e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}var JL=Kt(()=>{});var bm,$L=Kt(()=>{JL();bm=class{constructor(e,n){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=nb(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(nb()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}});var hl,vY=Kt(()=>{$L();hl=class{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,n=\"count\"){return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(let e of Object.values(this.stats))e.reset();return this}forEach(e){for(let n of Object.values(this.stats))e(n)}getTable(){let e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(n=>this._getOrCreate(n))}_getOrCreate(e){let{name:n,type:r}=e,i=this.stats[n];return i||(e instanceof bm?i=e:i=new bm(n,r),this.stats[n]=i),i}}});var wm=Kt(()=>{vY();$L();JL()});var MO,RC,IO=Kt(()=>{wm();MO=class{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new hl({id:e})),this.stats.get(e)}},RC=new MO});var St,Tp=Kt(()=>{hy();St=new xc({id:\"luma.gl\"})});function wA(t=\"id\"){PO[t]=PO[t]||1;let e=PO[t]++;return`${t}-${e}`}var PO,gb=Kt(()=>{PO={}});function Nme(t,e){let n={...e};for(let r in t)t[r]!==void 0&&(n[r]=t[r]);return n}var fr,ql=Kt(()=>{gb();fr=class{static defaultProps={id:\"undefined\",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:\"${this.id}\"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,n,r){if(!e)throw new Error(\"no device\");this._device=e,this.props=Nme(n,r);let i=this.props.id!==\"undefined\"?this.props.id:wA(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(let e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){let e=this._device.statsManager.getStats(\"Resource Counts\"),n=this[Symbol.toStringTag];e.get(`${n}s Active`).decrementCount()}trackAllocatedMemory(e,n=this[Symbol.toStringTag]){let r=this._device.statsManager.getStats(\"Resource Counts\");r.get(\"GPU Memory\").addCount(e),r.get(`${n} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){let n=this._device.statsManager.getStats(\"Resource Counts\");n.get(\"GPU Memory\").subtractCount(this.allocatedBytes),n.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){let e=this._device.statsManager.getStats(\"Resource Counts\"),n=this[Symbol.toStringTag];e.get(\"Resources Created\").incrementCount(),e.get(`${n}s Created`).incrementCount(),e.get(`${n}s Active`).incrementCount()}}});var ei,BC=Kt(()=>{ql();ei=class t extends fr{static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;get[Symbol.toStringTag](){return\"Buffer\"}usage;indexType;updateTimestamp;constructor(e,n){let r={...n};(n.usage||0)&t.INDEX&&!n.indexType&&(n.data instanceof Uint32Array?r.indexType=\"uint32\":n.data instanceof Uint16Array?r.indexType=\"uint16\":n.data instanceof Uint8Array&&(r.indexType=\"uint8\")),delete r.data,super(e,r,t.defaultProps),this.usage=r.usage||0,this.indexType=r.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,n,r){let i=ArrayBuffer.isView(e)?e.buffer:e,o=Math.min(e?e.byteLength:r,t.DEBUG_DATA_MAX_LENGTH);i===null?this.debugData=new ArrayBuffer(o):n===0&&r===i.byteLength?this.debugData=i.slice(0,o):this.debugData=i.slice(n,n+o)}static defaultProps={...fr.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:\"uint16\",onMapped:void 0}}});function mb(t){let[e,n,r]=BO[t],i=t.includes(\"norm\"),o=!i&&!t.startsWith(\"float\"),s=t.startsWith(\"s\");return{signedType:e,primitiveType:n,byteLength:r,normalized:i,integer:o,signed:s}}function RO(t){let e=t;switch(e){case\"uint8\":return\"unorm8\";case\"sint8\":return\"snorm8\";case\"uint16\":return\"unorm16\";case\"sint16\":return\"snorm16\";default:return e}}function FZ(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}function Mm(t){let e=ArrayBuffer.isView(t)?t.constructor:t;if(e===Uint8ClampedArray)return\"uint8\";let n=Object.values(BO).find(r=>e===r[4]);if(!n)throw new Error(e.name);return n[0]}function Im(t){let[,,,,e]=BO[t];return e}var BO,_b=Kt(()=>{BO={uint8:[\"uint8\",\"u32\",1,!1,Uint8Array],sint8:[\"sint8\",\"i32\",1,!1,Int8Array],unorm8:[\"uint8\",\"f32\",1,!0,Uint8Array],snorm8:[\"sint8\",\"f32\",1,!0,Int8Array],uint16:[\"uint16\",\"u32\",2,!1,Uint16Array],sint16:[\"sint16\",\"i32\",2,!1,Int16Array],unorm16:[\"uint16\",\"u32\",2,!0,Uint16Array],snorm16:[\"sint16\",\"i32\",2,!0,Int16Array],float16:[\"float16\",\"f16\",2,!1,Uint16Array],float32:[\"float32\",\"f32\",4,!1,Float32Array],uint32:[\"uint32\",\"u32\",4,!1,Uint32Array],sint32:[\"sint32\",\"i32\",4,!1,Int32Array]}});function gy(t){let e;t.endsWith(\"-webgl\")&&(t.replace(\"-webgl\",\"\"),e=!0);let[n,r]=t.split(\"x\"),i=n,o=r?parseInt(r):1,s=mb(i),c={type:i,components:o,byteLength:s.byteLength*o,integer:s.integer,signed:s.signed,normalized:s.normalized};return e&&(c.webglOnly=!0),c}function kZ(t,e,n){let r=n?RO(t):t;switch(r){case\"unorm8\":return e===1?\"unorm8\":e===3?\"unorm8x3-webgl\":`${r}x${e}`;case\"snorm8\":case\"uint8\":case\"sint8\":case\"uint16\":case\"sint16\":case\"unorm16\":case\"snorm16\":case\"float16\":if(e===1||e===3)throw new Error(`size: ${e}`);return`${r}x${e}`;default:return e===1?r:`${r}x${e}`}}function DO(t,e,n){if(!e||e>4)throw new Error(`size ${e}`);let r=e,i=Mm(t);return kZ(i,r,n)}function NZ(t){let e;switch(t.primitiveType){case\"f32\":e=\"float32\";break;case\"i32\":e=\"sint32\";break;case\"u32\":e=\"uint32\";break;case\"f16\":return t.components<=2?\"float16x2\":\"float16x4\"}return t.components===1?e:`${e}x${t.components}`}var DC=Kt(()=>{_b()});function NO(t){let e=Hme[t];if(!e)throw new Error(`Unsupported texture format ${t}`);return e}var fl,Ki,Zf,zme,LC,LO,OC,OO,Ume,FO,yb,kO,FC,zZ,Vme,Gme,Hme,UZ=Kt(()=>{fl=\"texture-compression-bc\",Ki=\"texture-compression-astc\",Zf=\"texture-compression-etc2\",zme=\"texture-compression-etc1-webgl\",LC=\"texture-compression-pvrtc-webgl\",LO=\"texture-compression-atc-webgl\",OC=\"float32-renderable-webgl\",OO=\"float16-renderable-webgl\",Ume=\"rgb9e5ufloat-renderable-webgl\",FO=\"snorm8-renderable-webgl\",yb=\"norm16-renderable-webgl\",kO=\"snorm16-renderable-webgl\",FC=\"float32-filterable\",zZ=\"float16-filterable-webgl\";Vme={r8unorm:{},rg8unorm:{},\"rgb8unorm-webgl\":{},rgba8unorm:{},\"rgba8unorm-srgb\":{},r8snorm:{render:FO},rg8snorm:{render:FO},\"rgb8snorm-webgl\":{},rgba8snorm:{render:FO},r8uint:{},rg8uint:{},rgba8uint:{},r8sint:{},rg8sint:{},rgba8sint:{},bgra8unorm:{},\"bgra8unorm-srgb\":{},r16unorm:{f:yb},rg16unorm:{render:yb},\"rgb16unorm-webgl\":{f:yb},rgba16unorm:{render:yb},r16snorm:{f:kO},rg16snorm:{render:kO},\"rgb16snorm-webgl\":{f:yb},rgba16snorm:{render:kO},r16uint:{},rg16uint:{},rgba16uint:{},r16sint:{},rg16sint:{},rgba16sint:{},r16float:{render:OO,filter:\"float16-filterable-webgl\"},rg16float:{render:OO,filter:zZ},rgba16float:{render:OO,filter:zZ},r32uint:{},rg32uint:{},rgba32uint:{},r32sint:{},rg32sint:{},rgba32sint:{},r32float:{render:OC,filter:FC},rg32float:{render:!1,filter:FC},\"rgb32float-webgl\":{render:OC,filter:FC},rgba32float:{render:OC,filter:FC},\"rgba4unorm-webgl\":{channels:\"rgba\",bitsPerChannel:[4,4,4,4],packed:!0},\"rgb565unorm-webgl\":{channels:\"rgb\",bitsPerChannel:[5,6,5,0],packed:!0},\"rgb5a1unorm-webgl\":{channels:\"rgba\",bitsPerChannel:[5,5,5,1],packed:!0},rgb9e5ufloat:{channels:\"rgb\",packed:!0,render:Ume},rg11b10ufloat:{channels:\"rgb\",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:OC},rgb10a2unorm:{channels:\"rgba\",bitsPerChannel:[10,10,10,2],packed:!0,p:1},rgb10a2uint:{channels:\"rgba\",bitsPerChannel:[10,10,10,2],packed:!0,p:1},stencil8:{attachment:\"stencil\",bitsPerChannel:[8,0,0,0],dataType:\"uint8\"},depth16unorm:{attachment:\"depth\",bitsPerChannel:[16,0,0,0],dataType:\"uint16\"},depth24plus:{attachment:\"depth\",bitsPerChannel:[24,0,0,0],dataType:\"uint32\"},depth32float:{attachment:\"depth\",bitsPerChannel:[32,0,0,0],dataType:\"float32\"},\"depth24plus-stencil8\":{attachment:\"depth-stencil\",bitsPerChannel:[24,8,0,0],packed:!0},\"depth32float-stencil8\":{attachment:\"depth-stencil\",bitsPerChannel:[32,8,0,0],packed:!0}},Gme={\"bc1-rgb-unorm-webgl\":{f:fl},\"bc1-rgb-unorm-srgb-webgl\":{f:fl},\"bc1-rgba-unorm\":{f:fl},\"bc1-rgba-unorm-srgb\":{f:fl},\"bc2-rgba-unorm\":{f:fl},\"bc2-rgba-unorm-srgb\":{f:fl},\"bc3-rgba-unorm\":{f:fl},\"bc3-rgba-unorm-srgb\":{f:fl},\"bc4-r-unorm\":{f:fl},\"bc4-r-snorm\":{f:fl},\"bc5-rg-unorm\":{f:fl},\"bc5-rg-snorm\":{f:fl},\"bc6h-rgb-ufloat\":{f:fl},\"bc6h-rgb-float\":{f:fl},\"bc7-rgba-unorm\":{f:fl},\"bc7-rgba-unorm-srgb\":{f:fl},\"etc2-rgb8unorm\":{f:Zf},\"etc2-rgb8unorm-srgb\":{f:Zf},\"etc2-rgb8a1unorm\":{f:Zf},\"etc2-rgb8a1unorm-srgb\":{f:Zf},\"etc2-rgba8unorm\":{f:Zf},\"etc2-rgba8unorm-srgb\":{f:Zf},\"eac-r11unorm\":{f:Zf},\"eac-r11snorm\":{f:Zf},\"eac-rg11unorm\":{f:Zf},\"eac-rg11snorm\":{f:Zf},\"astc-4x4-unorm\":{f:Ki},\"astc-4x4-unorm-srgb\":{f:Ki},\"astc-5x4-unorm\":{f:Ki},\"astc-5x4-unorm-srgb\":{f:Ki},\"astc-5x5-unorm\":{f:Ki},\"astc-5x5-unorm-srgb\":{f:Ki},\"astc-6x5-unorm\":{f:Ki},\"astc-6x5-unorm-srgb\":{f:Ki},\"astc-6x6-unorm\":{f:Ki},\"astc-6x6-unorm-srgb\":{f:Ki},\"astc-8x5-unorm\":{f:Ki},\"astc-8x5-unorm-srgb\":{f:Ki},\"astc-8x6-unorm\":{f:Ki},\"astc-8x6-unorm-srgb\":{f:Ki},\"astc-8x8-unorm\":{f:Ki},\"astc-8x8-unorm-srgb\":{f:Ki},\"astc-10x5-unorm\":{f:Ki},\"astc-10x5-unorm-srgb\":{f:Ki},\"astc-10x6-unorm\":{f:Ki},\"astc-10x6-unorm-srgb\":{f:Ki},\"astc-10x8-unorm\":{f:Ki},\"astc-10x8-unorm-srgb\":{f:Ki},\"astc-10x10-unorm\":{f:Ki},\"astc-10x10-unorm-srgb\":{f:Ki},\"astc-12x10-unorm\":{f:Ki},\"astc-12x10-unorm-srgb\":{f:Ki},\"astc-12x12-unorm\":{f:Ki},\"astc-12x12-unorm-srgb\":{f:Ki},\"pvrtc-rgb4unorm-webgl\":{f:LC},\"pvrtc-rgba4unorm-webgl\":{f:LC},\"pvrtc-rbg2unorm-webgl\":{f:LC},\"pvrtc-rgba2unorm-webgl\":{f:LC},\"etc1-rbg-unorm-webgl\":{f:zme},\"atc-rgb-unorm-webgl\":{f:LO},\"atc-rgba-unorm-webgl\":{f:LO},\"atc-rgbai-unorm-webgl\":{f:LO}},Hme={...Vme,...Gme}});function VZ(t){let e=Xme(t);if(Ep.isCompressed(t)){e.channels=\"rgb\",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;let r=Yme(t);r&&(e.blockWidth=r.blockWidth,e.blockHeight=r.blockHeight)}let n=jme.exec(t);if(n){let[,r,i,o,s,c]=n,d=`${o}${i}`,m=mb(d),b=m.byteLength*8,C=r.length,B=[b,C>=2?b:0,C>=3?b:0,C>=4?b:0];e={format:t,attachment:e.attachment,dataType:m.signedType,components:C,channels:r,integer:m.integer,signed:m.signed,normalized:m.normalized,bitsPerChannel:B,bytesPerPixel:m.byteLength*r.length,packed:e.packed,srgb:e.srgb},c===\"-webgl\"&&(e.webgl=!0),s===\"-srgb\"&&(e.srgb=!0)}return t.endsWith(\"-webgl\")&&(e.webgl=!0),t.endsWith(\"-srgb\")&&(e.srgb=!0),e}function Xme(t){let e=NO(t),n=e.bytesPerPixel||1,r=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:t,attachment:e.attachment||\"color\",channels:e.channels||\"r\",components:e.components||e.channels?.length||1,bytesPerPixel:n,bitsPerChannel:r,dataType:e.dataType||\"uint8\",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function Yme(t){let n=/.*-(\\d+)x(\\d+)-.*/.exec(t);if(n){let[,r,i]=n;return{blockWidth:Number(r),blockHeight:Number(i)}}return null}var Wme,jme,kC,Ep,zO=Kt(()=>{_b();UZ();Wme=[\"bc1\",\"bc2\",\"bc3\",\"bc4\",\"bc5\",\"bc6\",\"bc7\",\"etc1\",\"etc2\",\"eac\",\"atc\",\"astc\",\"pvrtc\"],jme=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/,kC=class{getInfo(e){return VZ(e)}isColor(e){return e.startsWith(\"rgba\")||e.startsWith(\"bgra\")||e.startsWith(\"rgb\")}isDepthStencil(e){return e.startsWith(\"depth\")||e.startsWith(\"stencil\")}isCompressed(e){return Wme.some(n=>e.startsWith(n))}getCapabilities(e){let n=NO(e),r={format:e,create:n.f??!0,render:n.render??!0,filter:n.filter??!0,blend:n.blend??!0,store:n.store??!0},i=VZ(e),o=e.startsWith(\"depth\")||e.startsWith(\"stencil\"),s=i?.signed,c=i?.integer,d=i?.webgl;return r.render&&=!s,r.filter&&=!o&&!s&&!c&&!d,r}},Ep=new kC});function GZ(t){return typeof ImageData<\"u\"&&t instanceof ImageData||typeof ImageBitmap<\"u\"&&t instanceof ImageBitmap||typeof HTMLImageElement<\"u\"&&t instanceof HTMLImageElement||typeof HTMLVideoElement<\"u\"&&t instanceof HTMLVideoElement||typeof VideoFrame<\"u\"&&t instanceof VideoFrame||typeof HTMLCanvasElement<\"u\"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<\"u\"&&t instanceof OffscreenCanvas}function HZ(t){if(typeof ImageData<\"u\"&&t instanceof ImageData||typeof ImageBitmap<\"u\"&&t instanceof ImageBitmap||typeof HTMLCanvasElement<\"u\"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<\"u\"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height};if(typeof HTMLImageElement<\"u\"&&t instanceof HTMLImageElement)return{width:t.naturalWidth,height:t.naturalHeight};if(typeof HTMLVideoElement<\"u\"&&t instanceof HTMLVideoElement)return{width:t.videoWidth,height:t.videoHeight};if(typeof VideoFrame<\"u\"&&t instanceof VideoFrame)return{width:t.displayWidth,height:t.displayHeight};throw new Error(\"Unknown image type\")}var WZ=Kt(()=>{});var xb,vb,Wh,UO=Kt(()=>{IO();Tp();gb();BC();DC();zO();WZ();xb=class{},vb=class{features;disabledFeatures;constructor(e=[],n){this.features=new Set(e),this.disabledFeatures=n||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}},Wh=class t{static defaultProps={id:null,powerPreference:\"high-performance\",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,webgl:{},onError:(e,n)=>{},onResize:(e,n)=>{let[r,i]=e.getDevicePixelSize();St.log(1,`${e} resized => ${r}x${i}px`)()},onPositionChange:(e,n)=>{let[r,i]=e.getPosition();St.log(1,`${e} repositioned => ${r},${i}`)()},onVisibilityChange:e=>St.log(1,`${e} Visibility changed ${e.isVisible}`)(),onDevicePixelRatioChange:(e,n)=>St.log(1,`${e} DPR changed ${n.oldRatio} => ${e.devicePixelRatio}`)(),debug:St.get(\"debug\")||void 0,debugShaders:St.get(\"debug-shaders\")||void 0,debugFramebuffers:!!St.get(\"debug-framebuffers\"),debugFactories:!!St.get(\"debug-factories\"),debugWebGL:!!St.get(\"debug-webgl\"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_reuseDevices:!1,_requestMaxLimits:!0,_cacheShaders:!1,_cachePipelines:!1,_cacheDestroyPolicy:\"unused\",_initializeFeatures:!0,_disabledFeatures:{\"compilation-status-async-webgl\":!0},_handle:void 0};get[Symbol.toStringTag](){return\"Device\"}toString(){return`Device(${this.id})`}id;props;userData={};statsManager=RC;timestamp=0;_reused=!1;_lumaData={};_textureCaps={};constructor(e){this.props={...t.defaultProps,...e},this.id=this.props.id||wA(this[Symbol.toStringTag].toLowerCase())}getVertexFormatInfo(e){return gy(e)}isVertexFormatSupported(e){return!0}getTextureFormatInfo(e){return Ep.getInfo(e)}getTextureFormatCapabilities(e){let n=this._textureCaps[e];if(!n){let r=this._getDeviceTextureFormatCapabilities(e);n=this._getDeviceSpecificTextureFormatCapabilities(r),this._textureCaps[e]=n}return n}getMipLevelCount(e,n,r=1){let i=Math.max(e,n,r);return 1+Math.floor(Math.log2(i))}isExternalImage(e){return GZ(e)}getExternalImageSize(e){return HZ(e)}isTextureFormatSupported(e){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return Ep.isCompressed(e)}pushDebugGroup(e){this.commandEncoder.pushDebugGroup(e)}popDebugGroup(){this.commandEncoder?.popDebugGroup()}insertDebugMarker(e){this.commandEncoder?.insertDebugMarker(e)}loseDevice(){return!1}incrementTimestamp(){return this.timestamp++}reportError(e,n,...r){return this.props.onError(e,n)?()=>{}:St.error(e.message,n,...r)}debug(){if(this.props.debug)debugger;else St.once(0,`'Type luma.log.set({debug: true}) in console to enable debug breakpoints',\nor create a device with the 'debug: true' prop.`)()}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error(\"Device has no default CanvasContext. See props.createCanvasContext\");return this.canvasContext}beginRenderPass(e){return this.commandEncoder.beginRenderPass(e)}beginComputePass(e){return this.commandEncoder.beginComputePass(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,n){throw new Error(\"not implemented\")}readPixelsToBufferWebGL(e,n){throw new Error(\"not implemented\")}setParametersWebGL(e){throw new Error(\"not implemented\")}getParametersWebGL(e){throw new Error(\"not implemented\")}withParametersWebGL(e,n){throw new Error(\"not implemented\")}clearWebGL(e){throw new Error(\"not implemented\")}resetWebGL(){throw new Error(\"not implemented\")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_getDeviceTextureFormatCapabilities(e){let n=Ep.getCapabilities(e),r=o=>(typeof o==\"string\"?this.features.has(o):o)??!0,i=r(n.create);return{format:e,create:i,render:i&&r(n.render),filter:i&&r(n.filter),blend:i&&r(n.blend),store:i&&r(n.store)}}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});let n={...e};if((e.usage||0)&ei.INDEX&&(e.indexType||(e.data instanceof Uint32Array?n.indexType=\"uint32\":e.data instanceof Uint16Array?n.indexType=\"uint16\":e.data instanceof Uint8Array&&(n.data=new Uint16Array(e.data),n.indexType=\"uint16\")),!n.indexType))throw new Error(\"indices buffer content must be of type uint16 or uint32\");return n}}});var Zme,jZ,VO,my,XZ=Kt(()=>{UO();IO();Tp();Zme=\"set luma.log.level=1 (or higher) to trace rendering\",jZ=\"No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.\",VO=class t{static defaultProps={...Wh.defaultProps,type:\"best-available\",adapters:void 0,waitForPageLoad:!0};stats=RC;log=St;VERSION=\"9.2.6\";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw St.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),St.error(\"'yarn why @luma.gl/core' can help identify the source of the conflict\")(),new Error(\"luma.gl - multiple versions detected: see console log\");St.error(\"This version of luma.gl has already been initialized\")()}St.log(1,`${this.VERSION} - ${Zme}`)(),globalThis.luma=this}async createDevice(e={}){let n={...t.defaultProps,...e},r=this.selectAdapter(n.type,n.adapters);if(!r)throw new Error(jZ);return n.waitForPageLoad&&await r.pageLoaded,await r.create(n)}async attachDevice(e,n){let r=this._getTypeFromHandle(e,n.adapters),i=r&&this.selectAdapter(r,n.adapters);if(!i)throw new Error(jZ);return await i?.attach?.(e,n)}registerAdapters(e){for(let n of e)this.preregisteredAdapters.set(n.type,n)}getSupportedAdapters(e=[]){let n=this._getAdapterMap(e);return Array.from(n).map(([,r])=>r).filter(r=>r.isSupported?.()).map(r=>r.type)}getBestAvailableAdapterType(e=[]){let n=[\"webgpu\",\"webgl\",\"null\"],r=this._getAdapterMap(e);for(let i of n)if(r.get(i)?.isSupported?.())return i;return null}selectAdapter(e,n=[]){let r=e;e===\"best-available\"&&(r=this.getBestAvailableAdapterType(n));let i=this._getAdapterMap(n);return r&&i.get(r)||null}enforceWebGL2(e=!0,n=[]){let i=this._getAdapterMap(n).get(\"webgl\");i||St.warn(\"enforceWebGL2: webgl adapter not found\")(),i?.enforceWebGL2?.(e)}setDefaultDeviceProps(e){Object.assign(t.defaultProps,e)}_getAdapterMap(e=[]){let n=new Map(this.preregisteredAdapters);for(let r of e)n.set(r.type,r);return n}_getTypeFromHandle(e,n=[]){return e instanceof WebGL2RenderingContext?\"webgl\":typeof GPUDevice<\"u\"&&e instanceof GPUDevice||e?.queue?\"webgpu\":e===null?\"null\":(e instanceof WebGLRenderingContext?St.warn(\"WebGL1 is not supported\",e)():St.warn(\"Unknown handle type\",e)(),null)}},my=new VO});function Kme(){return NC||(Qme()||typeof window>\"u\"?NC=Promise.resolve():NC=new Promise(t=>window.addEventListener(\"load\",()=>t()))),NC}var bb,qme,Qme,NC,YZ=Kt(()=>{yA();bb=class{get pageLoaded(){return Kme()}},qme=Zl()&&typeof document<\"u\",Qme=()=>qme&&document.readyState===\"complete\",NC=null});function ZZ(){let t,e;return{promise:new Promise((r,i)=>{t=r,e=i}),resolve:t,reject:e}}var qZ=Kt(()=>{});function Jme(t){if(typeof t==\"string\"){let e=document.getElementById(t);if(!e)throw new Error(`${t} is not an HTML element`);return e}return t||document.body}function $me(t){let e=document.getElementById(t);if(!_y.isHTMLCanvas(e))throw new Error(\"Object is not a canvas element\");return e}function e_e(t){let{width:e,height:n}=t,r=document.createElement(\"canvas\");r.id=wA(\"lumagl-auto-created-canvas\"),r.width=e||1,r.height=n||1,r.style.width=Number.isFinite(e)?`${e}px`:\"100%\",r.style.height=Number.isFinite(n)?`${n}px`:\"100%\",t?.visible||(r.style.visibility=\"hidden\");let i=Jme(t?.container||null);return i.insertBefore(r,i.firstChild),r}function t_e(t,e,n,r,i){let o=t,s=QZ(o[0],e,n),c=KZ(o[1],e,r,i),d=QZ(o[0]+1,e,n),m=d===n-1?d:d-1;d=KZ(o[1]+1,e,r,i);let b;return i?(d=d===0?d:d+1,b=c,c=d):b=d===r-1?d:d-1,{x:s,y:c,width:Math.max(m-s+1,1),height:Math.max(b-c+1,1)}}function QZ(t,e,n){return Math.min(Math.round(t*e),n-1)}function KZ(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}var _y,JZ=Kt(()=>{yA();gb();qZ();_y=class t{static isHTMLCanvas(e){return typeof HTMLCanvasElement<\"u\"&&e instanceof HTMLCanvasElement}static isOffscreenCanvas(e){return typeof OffscreenCanvas<\"u\"&&e instanceof OffscreenCanvas}static defaultProps={id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:\"opaque\",colorSpace:\"srgb\",trackPosition:!1};id;props;canvas;htmlCanvas;offscreenCanvas;type;initialized;isInitialized=!1;isVisible=!0;cssWidth;cssHeight;devicePixelRatio;devicePixelWidth;devicePixelHeight;drawingBufferWidth;drawingBufferHeight;_initializedResolvers=ZZ();_resizeObserver;_intersectionObserver;_position;destroyed=!1;toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...t.defaultProps,...e},e=this.props,this.initialized=this._initializedResolvers.promise,Zl()?e.canvas?typeof e.canvas==\"string\"?this.canvas=$me(e.canvas):this.canvas=e.canvas:this.canvas=e_e(e):this.canvas={width:e.width||1,height:e.height||1},t.isHTMLCanvas(this.canvas)?(this.id=e.id||this.canvas.id,this.type=\"html-canvas\",this.htmlCanvas=this.canvas):t.isOffscreenCanvas(this.canvas)?(this.id=e.id||\"offscreen-canvas\",this.type=\"offscreen-canvas\",this.offscreenCanvas=this.canvas):(this.id=e.id||\"node-canvas-context\",this.type=\"node\"),this.cssWidth=this.htmlCanvas?.clientWidth||this.canvas.width,this.cssHeight=this.htmlCanvas?.clientHeight||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],t.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver(n=>this._handleIntersection(n)),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver(n=>this._handleResize(n));try{this._resizeObserver.observe(this.canvas,{box:\"device-pixel-content-box\"})}catch{this._resizeObserver.observe(this.canvas,{box:\"content-box\"})}setTimeout(()=>this._observeDevicePixelRatio(),0),this.props.trackPosition&&this._trackPosition()}}destroy(){this.destroyed=!0}setProps(e){return\"useDevicePixels\"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this}getCSSSize(){return[this.cssWidth,this.cssHeight]}getPosition(){return this._position}getDevicePixelSize(){return[this.devicePixelWidth,this.devicePixelHeight]}getDrawingBufferSize(){return[this.drawingBufferWidth,this.drawingBufferHeight]}getMaxDrawingBufferSize(){let e=this.device.limits.maxTextureDimension2D;return[e,e]}setDrawingBufferSize(e,n){this.canvas.width=e,this.canvas.height=n,this.drawingBufferWidth=e,this.drawingBufferHeight=n}getDevicePixelRatio(){return typeof window<\"u\"&&window.devicePixelRatio||1}cssToDevicePixels(e,n=!0){let r=this.cssToDeviceRatio(),[i,o]=this.getDrawingBufferSize();return t_e(e,r,i,o,n)}getPixelSize(){return this.getDevicePixelSize()}getAspect(){let[e,n]=this.getDevicePixelSize();return e/n}cssToDeviceRatio(){try{let[e]=this.getDrawingBufferSize(),[n]=this.getCSSSize();return n?e/n:1}catch{return 1}}resize(e){this.setDrawingBufferSize(e.width,e.height)}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id===\"lumagl-auto-created-canvas\"&&(this.htmlCanvas.id=e)}_handleIntersection(e){let n=e.find(i=>i.target===this.canvas);if(!n)return;let r=n.isIntersecting;this.isVisible!==r&&(this.isVisible=r,this.device.props.onVisibilityChange(this))}_handleResize(e){let n=e.find(d=>d.target===this.canvas);if(!n)return;this.cssWidth=n.contentBoxSize[0].inlineSize,this.cssHeight=n.contentBoxSize[0].blockSize;let r=this.getDevicePixelSize(),i=n.devicePixelContentBoxSize?.[0].inlineSize||n.contentBoxSize[0].inlineSize*devicePixelRatio,o=n.devicePixelContentBoxSize?.[0].blockSize||n.contentBoxSize[0].blockSize*devicePixelRatio,[s,c]=this.getMaxDrawingBufferSize();this.devicePixelWidth=Math.max(1,Math.min(i,s)),this.devicePixelHeight=Math.max(1,Math.min(o,c)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:r})}_updateDrawingBufferSize(){if(this.props.autoResize){if(typeof this.props.useDevicePixels==\"number\"){let e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._updateDevice()}this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()}_observeDevicePixelRatio(){let e=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:e}),matchMedia(`(resolution: ${this.devicePixelRatio}dppx)`).addEventListener(\"change\",()=>this._observeDevicePixelRatio(),{once:!0})}_trackPosition(e=100){let n=setInterval(()=>{this.destroyed?clearInterval(n):this.updatePosition()},e)}updatePosition(){let e=this.htmlCanvas?.getBoundingClientRect();if(e){let n=[e.left,e.top];if(this._position??=n,n[0]!==this._position[0]||n[1]!==this._position[1]){let i=this._position;this._position=n,this.device.props.onPositionChange?.(this,{oldPosition:i})}}}}});var jh,GO=Kt(()=>{ql();jh=class t extends fr{static defaultProps={...fr.defaultProps,type:\"color-sampler\",addressModeU:\"clamp-to-edge\",addressModeV:\"clamp-to-edge\",addressModeW:\"clamp-to-edge\",magFilter:\"nearest\",minFilter:\"nearest\",mipmapFilter:\"none\",lodMinClamp:0,lodMaxClamp:32,compare:\"less-equal\",maxAnisotropy:1};get[Symbol.toStringTag](){return\"Sampler\"}constructor(e,n){n=t.normalizeProps(e,n),super(e,n,t.defaultProps)}static normalizeProps(e,n){return n}}});var n_e,jo,HO=Kt(()=>{ql();GO();Tp();n_e={\"1d\":\"1d\",\"2d\":\"2d\",\"2d-array\":\"2d\",cube:\"2d\",\"cube-array\":\"2d\",\"3d\":\"3d\"},jo=class t extends fr{static SAMPLE=4;static STORAGE=8;static RENDER=16;static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static RENDER_ATTACHMENT=16;dimension;baseDimension;format;width;height;depth;mipLevels;updateTimestamp;get[Symbol.toStringTag](){return\"Texture\"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}constructor(e,n){if(n=t.normalizeProps(e,n),super(e,n,t.defaultProps),this.dimension=this.props.dimension,this.baseDimension=n_e[this.dimension],this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.mipLevels=this.props.mipLevels,this.props.width===void 0||this.props.height===void 0)if(e.isExternalImage(n.data)){let r=e.getExternalImageSize(n.data);this.width=r?.width||1,this.height=r?.height||1}else this.width=1,this.height=1,(this.props.width===void 0||this.props.height===void 0)&&St.warn(`${this} created with undefined width or height. This is deprecated. Use AsyncTexture instead.`)();this.updateTimestamp=e.incrementTimestamp()}setSampler(e){this.sampler=e instanceof jh?e:this.device.createSampler(e)}clone(e){return this.device.createTexture({...this.props,...e})}static normalizeProps(e,n){let r={...n},{width:i,height:o}=r;return typeof i==\"number\"&&(r.width=Math.max(1,Math.ceil(i))),typeof o==\"number\"&&(r.height=Math.max(1,Math.ceil(o))),r}_initializeData(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:\"all\",colorSpace:\"srgb\",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:\"all\"})}_normalizeCopyImageDataOptions(e){let{width:n,height:r,depth:i}=this,o={...t.defaultCopyDataOptions,width:n,height:r,depth:i,...e},s=this.device.getTextureFormatInfo(this.format);if(!e.bytesPerRow&&!s.bytesPerPixel)throw new Error(`bytesPerRow must be provided for texture format ${this.format}`);return o.bytesPerRow=e.bytesPerRow||n*(s.bytesPerPixel||4),o.rowsPerImage=e.rowsPerImage||r,o}_normalizeCopyExternalImageOptions(e){let n=this.device.getExternalImageSize(e.image),r={...t.defaultCopyExternalImageOptions,...n,...e};return r.width=Math.min(r.width,this.width-r.x),r.height=Math.min(r.height,this.height-r.y),r}static defaultProps={...fr.defaultProps,data:null,dimension:\"2d\",format:\"rgba8unorm\",usage:t.TEXTURE|t.RENDER_ATTACHMENT|t.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0};static defaultCopyDataOptions={data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:\"all\"};static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:\"all\",colorSpace:\"srgb\",premultipliedAlpha:!1,flipY:!1}}});var Pm,$Z=Kt(()=>{ql();Pm=class t extends fr{get[Symbol.toStringTag](){return\"TextureView\"}constructor(e,n){super(e,n,t.defaultProps)}static defaultProps={...fr.defaultProps,format:void 0,dimension:void 0,aspect:\"all\",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}}});function eq(t,e,n){let r=\"\",i=e.split(/\\r?\\n/),o=t.slice().sort((s,c)=>s.lineNum-c.lineNum);switch(n?.showSourceCode||\"no\"){case\"all\":let s=0;for(let c=1;c<=i.length;c++)for(r+=tq(i[c-1],c,n);o.length>s&&o[s].lineNum===c;){let d=o[s++];r+=WO(d,i,d.lineNum,{...n,inlineSource:!1})}for(;o.length>s;){let c=o[s++];r+=WO(c,[],0,{...n,inlineSource:!1})}return r;case\"issues\":case\"no\":for(let c of t)r+=WO(c,i,c.lineNum,{inlineSource:n?.showSourceCode!==\"no\"});return r}}function WO(t,e,n,r){if(r?.inlineSource){let o=r_e(e,n),s=t.linePos>0?`${\" \".repeat(t.linePos+5)}^^^\n`:\"\";return`\n${o}${s}${t.type.toUpperCase()}: ${t.message}\n\n`}let i=t.type===\"error\"?\"red\":\"#8B4000\";return r?.html?`<div class='luma-compiler-log-error' style=\"color:${i};\"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function r_e(t,e,n){let r=\"\";for(let i=e-2;i<=e;i++){let o=t[i-1];o!==void 0&&(r+=tq(o,e,n))}return r}function tq(t,e,n){let r=n?.html?o_e(t):t;return`${i_e(String(e),4)}: ${r}${n?.html?\"<br/>\":`\n`}`}function i_e(t,e){let n=\"\";for(let r=t.length;r<e;++r)n+=\" \";return n+t}function o_e(t){return t.replaceAll(\"&\",\"&amp;\").replaceAll(\"<\",\"&lt;\").replaceAll(\">\",\"&gt;\").replaceAll('\"',\"&quot;\").replaceAll(\"'\",\"&#039;\")}var nq=Kt(()=>{});function s_e(t){return a_e(t.source)||t.id||wA(`unnamed ${t.stage}-shader`)}function a_e(t,e=\"unnamed\"){let r=/#define[\\s*]SHADER_NAME[\\s*]([A-Za-z0-9_-]+)[\\s*]/.exec(t);return r?r[1]:e}var Rm,rq=Kt(()=>{ql();gb();nq();Rm=class t extends fr{get[Symbol.toStringTag](){return\"Shader\"}stage;source;compilationStatus=\"pending\";constructor(e,n){n={...n,debugShaders:n.debugShaders||e.props.debugShaders||\"errors\"},super(e,{id:s_e(n),...n},t.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){let e=this.props.debugShaders;switch(e){case\"never\":return;case\"errors\":if(this.compilationStatus===\"success\")return;break;case\"warnings\":case\"always\":break}let n=await this.getCompilationInfo();e===\"warnings\"&&n?.length===0||this._displayShaderLog(n,this.id)}_displayShaderLog(e,n){if(typeof document>\"u\"||!document?.createElement)return;let r=n,i=`${this.stage} shader \"${r}\"`,o=eq(e,this.source,{showSourceCode:\"all\",html:!0}),s=this.getTranslatedSource();s&&(o+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style=\"user-select:text;\"><pre>${s}</pre></code>`);let c=document.createElement(\"Button\");c.innerHTML=`\n<h1>Compilation error in ${i}</h1><br /><br />\n<code style=\"user-select:text;\"><pre>\n${o}\n</pre></code>`,c.style.top=\"10px\",c.style.left=\"10px\",c.style.position=\"absolute\",c.style.zIndex=\"9999\",c.style.width=\"100%\",c.style.textAlign=\"left\",document.body.appendChild(c),document.getElementsByClassName(\"luma-compiler-log-error\")[0]?.scrollIntoView(),c.onclick=()=>{let m=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(m)}}static defaultProps={...fr.defaultProps,language:\"auto\",stage:void 0,source:\"\",sourceMap:null,entryPoint:\"main\",debugShaders:void 0}}});var Bm,iq=Kt(()=>{ql();HO();Tp();Bm=class t extends fr{get[Symbol.toStringTag](){return\"Framebuffer\"}width;height;constructor(e,n={}){super(e,n,t.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){let n=this.colorAttachments.map(i=>i.texture.clone(e)),r=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:n,depthStencilAttachment:r})}resize(e){let n=!e;if(e){let[r,i]=Array.isArray(e)?e:[e.width,e.height];n=n||i!==this.height||r!==this.width,this.width=r,this.height=i}n&&(St.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error(\"Framebuffer has noattachments\");this.colorAttachments=this.props.colorAttachments.map((n,r)=>{if(typeof n==\"string\"){let i=this.createColorTexture(n,r);return this.attachResource(i),i.view}return n instanceof jo?n.view:n});let e=this.props.depthStencilAttachment;if(e)if(typeof e==\"string\"){let n=this.createDepthStencilTexture(e);this.attachResource(n),this.depthStencilAttachment=n.view}else e instanceof jo?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,n){return this.device.createTexture({id:`${this.id}-color-attachment-${n}`,usage:jo.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:\"linear\",minFilter:\"linear\"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:jo.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})}resizeAttachments(e,n){for(let r=0;r<this.colorAttachments.length;++r)if(this.colorAttachments[r]){let i=this.colorAttachments[r].texture.clone({width:e,height:n});this.destroyAttachedResource(this.colorAttachments[r]),this.colorAttachments[r]=i.view,this.attachResource(i.view)}if(this.depthStencilAttachment){let r=this.depthStencilAttachment.texture.clone({width:e,height:n});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=r.view,this.attachResource(r)}this.updateAttachments()}static defaultProps={...fr.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null}}});var Xh,oq=Kt(()=>{ql();Xh=class t extends fr{get[Symbol.toStringTag](){return\"RenderPipeline\"}shaderLayout;bufferLayout;linkStatus=\"pending\";hash=\"\";constructor(e,n){super(e,n,t.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}static defaultProps={...fr.defaultProps,vs:null,vertexEntryPoint:\"vertexMain\",vsConstants:{},fs:null,fragmentEntryPoint:\"fragmentMain\",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:\"triangle-list\",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}}}});var wb,sq=Kt(()=>{ql();wb=class t extends fr{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;get[Symbol.toStringTag](){return\"RenderPass\"}constructor(e,n){n=t.normalizeProps(e,n),super(e,n,t.defaultProps)}static normalizeProps(e,n){return n}static defaultProps={...fr.defaultProps,framebuffer:null,parameters:void 0,clearColor:t.defaultClearColor,clearColors:void 0,clearDepth:t.defaultClearDepth,clearStencil:t.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}}});var yy,aq=Kt(()=>{ql();yy=class t extends fr{get[Symbol.toStringTag](){return\"ComputePipeline\"}hash=\"\";shaderLayout;constructor(e,n){super(e,n,t.defaultProps),this.shaderLayout=n.shaderLayout}static defaultProps={...fr.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}}});var Tb,lq=Kt(()=>{ql();Tb=class t extends fr{get[Symbol.toStringTag](){return\"CommandEncoder\"}constructor(e,n){super(e,n,t.defaultProps)}static defaultProps={...fr.defaultProps,measureExecutionTime:void 0}}});var Eb,cq=Kt(()=>{ql();Eb=class t extends fr{get[Symbol.toStringTag](){return\"CommandBuffer\"}constructor(e,n){super(e,n,t.defaultProps)}static defaultProps={...fr.defaultProps}}});function Sb(t){return u_e[t]}function jO(t){let[e,n]=c_e[t],r=e===\"i32\"||e===\"u32\",i=e!==\"u32\",o=l_e[e]*n;return{primitiveType:e,components:n,byteLength:o,integer:r,signed:i}}var l_e,c_e,u_e,h_e,WUe,zC=Kt(()=>{l_e={f32:4,f16:2,i32:4,u32:4},c_e={f32:[\"f32\",1],\"vec2<f32>\":[\"f32\",2],\"vec3<f32>\":[\"f32\",3],\"vec4<f32>\":[\"f32\",4],f16:[\"f16\",1],\"vec2<f16>\":[\"f16\",2],\"vec3<f16>\":[\"f16\",3],\"vec4<f16>\":[\"f16\",4],i32:[\"i32\",1],\"vec2<i32>\":[\"i32\",2],\"vec3<i32>\":[\"i32\",3],\"vec4<i32>\":[\"i32\",4],u32:[\"u32\",1],\"vec2<u32>\":[\"u32\",2],\"vec3<u32>\":[\"u32\",3],\"vec4<u32>\":[\"u32\",4]},u_e={f32:{type:\"f32\",components:1},f16:{type:\"f16\",components:1},i32:{type:\"i32\",components:1},u32:{type:\"u32\",components:1},\"vec2<f32>\":{type:\"f32\",components:2},\"vec3<f32>\":{type:\"f32\",components:3},\"vec4<f32>\":{type:\"f32\",components:4},\"vec2<f16>\":{type:\"f16\",components:2},\"vec3<f16>\":{type:\"f16\",components:3},\"vec4<f16>\":{type:\"f16\",components:4},\"vec2<i32>\":{type:\"i32\",components:2},\"vec3<i32>\":{type:\"i32\",components:3},\"vec4<i32>\":{type:\"i32\",components:4},\"vec2<u32>\":{type:\"u32\",components:2},\"vec3<u32>\":{type:\"u32\",components:3},\"vec4<u32>\":{type:\"u32\",components:4},\"mat2x2<f32>\":{type:\"f32\",components:4},\"mat2x3<f32>\":{type:\"f32\",components:6},\"mat2x4<f32>\":{type:\"f32\",components:8},\"mat3x2<f32>\":{type:\"f32\",components:6},\"mat3x3<f32>\":{type:\"f32\",components:9},\"mat3x4<f32>\":{type:\"f32\",components:12},\"mat4x2<f32>\":{type:\"f32\",components:8},\"mat4x3<f32>\":{type:\"f32\",components:12},\"mat4x4<f32>\":{type:\"f32\",components:16},\"mat2x2<f16>\":{type:\"f16\",components:4},\"mat2x3<f16>\":{type:\"f16\",components:6},\"mat2x4<f16>\":{type:\"f16\",components:8},\"mat3x2<f16>\":{type:\"f16\",components:6},\"mat3x3<f16>\":{type:\"f16\",components:9},\"mat3x4<f16>\":{type:\"f16\",components:12},\"mat4x2<f16>\":{type:\"f16\",components:8},\"mat4x3<f16>\":{type:\"f16\",components:12},\"mat4x4<f16>\":{type:\"f16\",components:16},\"mat2x2<i32>\":{type:\"i32\",components:4},\"mat2x3<i32>\":{type:\"i32\",components:6},\"mat2x4<i32>\":{type:\"i32\",components:8},\"mat3x2<i32>\":{type:\"i32\",components:6},\"mat3x3<i32>\":{type:\"i32\",components:9},\"mat3x4<i32>\":{type:\"i32\",components:12},\"mat4x2<i32>\":{type:\"i32\",components:8},\"mat4x3<i32>\":{type:\"i32\",components:12},\"mat4x4<i32>\":{type:\"i32\",components:16},\"mat2x2<u32>\":{type:\"u32\",components:4},\"mat2x3<u32>\":{type:\"u32\",components:6},\"mat2x4<u32>\":{type:\"u32\",components:8},\"mat3x2<u32>\":{type:\"u32\",components:6},\"mat3x3<u32>\":{type:\"u32\",components:9},\"mat3x4<u32>\":{type:\"u32\",components:12},\"mat4x2<u32>\":{type:\"u32\",components:8},\"mat4x3<u32>\":{type:\"u32\",components:12},\"mat4x4<u32>\":{type:\"u32\",components:16}},h_e={vec2i:\"vec2<i32>\",vec3i:\"vec3<i32>\",vec4i:\"vec4<i32>\",vec2u:\"vec2<u32>\",vec3u:\"vec3<u32>\",vec4u:\"vec4<u32>\",vec2f:\"vec2<f32>\",vec3f:\"vec3<f32>\",vec4f:\"vec4<f32>\",vec2h:\"vec2<f16>\",vec3h:\"vec3<f16>\",vec4h:\"vec4<f16>\"},WUe={...h_e,mat2x2f:\"mat2x2<f32>\",mat2x3f:\"mat2x3<f32>\",mat2x4f:\"mat2x4<f32>\",mat3x2f:\"mat3x2<f32>\",mat3x3f:\"mat3x3<f32>\",mat3x4f:\"mat3x4<f32>\",mat4x2f:\"mat4x2<f32>\",mat4x3f:\"mat4x3<f32>\",mat4x4f:\"mat4x4<f32>\",mat2x2i:\"mat2x2<i32>\",mat2x3i:\"mat2x3<i32>\",mat2x4i:\"mat2x4<i32>\",mat3x2i:\"mat3x2<i32>\",mat3x3i:\"mat3x3<i32>\",mat3x4i:\"mat3x4<i32>\",mat4x2i:\"mat4x2<i32>\",mat4x3i:\"mat4x3<i32>\",mat4x4i:\"mat4x4<i32>\",mat2x2u:\"mat2x2<u32>\",mat2x3u:\"mat2x3<u32>\",mat2x4u:\"mat2x4<u32>\",mat3x2u:\"mat3x2<u32>\",mat3x3u:\"mat3x3<u32>\",mat3x4u:\"mat3x4<u32>\",mat4x2u:\"mat4x2<u32>\",mat4x3u:\"mat4x3<u32>\",mat4x4u:\"mat4x4<u32>\",mat2x2h:\"mat2x2<f16>\",mat2x3h:\"mat2x3<f16>\",mat2x4h:\"mat2x4<f16>\",mat3x2h:\"mat3x2<f16>\",mat3x3h:\"mat3x3<f16>\",mat3x4h:\"mat3x4<f16>\",mat4x2h:\"mat4x2<f16>\",mat4x3h:\"mat4x3<f16>\",mat4x4h:\"mat4x4<f16>\"}});function UC(t,e){let n={};for(let r of t.attributes){let i=f_e(t,e,r.name);i&&(n[r.name]=i)}return n}function uq(t,e,n=16){let r=UC(t,e),i=new Array(n).fill(null);for(let o of Object.values(r))i[o.location]=o;return i}function f_e(t,e,n){let r=d_e(t,n),i=p_e(e,n);if(!r)return null;let o=jO(r.type),s=NZ(o),c=i?.vertexFormat||s,d=gy(c);return{attributeName:i?.attributeName||r.name,bufferName:i?.bufferName||r.name,location:r.location,shaderType:r.type,primitiveType:o.primitiveType,shaderComponents:o.components,vertexFormat:c,bufferDataType:d.type,bufferComponents:d.components,normalized:d.normalized,integer:o.integer,stepMode:i?.stepMode||r.stepMode||\"vertex\",byteOffset:i?.byteOffset||0,byteStride:i?.byteStride||0}}function d_e(t,e){let n=t.attributes.find(r=>r.name===e);return n||St.warn(`shader layout attribute \"${e}\" not present in shader`),n||null}function p_e(t,e){A_e(t);let n=g_e(t,e);return n||(n=m_e(t,e),n)?n:(St.warn(`layout for attribute \"${e}\" not present in buffer layout`),null)}function A_e(t){for(let e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&St.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function g_e(t,e){for(let n of t)if(n.format&&n.name===e)return{attributeName:n.name,bufferName:e,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}function m_e(t,e){for(let n of t){let r=n.byteStride;if(typeof n.byteStride!=\"number\")for(let o of n.attributes||[]){let s=gy(o.format);r+=s.byteLength}let i=n.attributes?.find(o=>o.attribute===e);if(i)return{attributeName:i.attribute,bufferName:n.name,stepMode:n.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:r}}return null}var XO=Kt(()=>{Tp();zC();DC()});var Cb,hq=Kt(()=>{XO();ql();Cb=class t extends fr{static defaultProps={...fr.defaultProps,shaderLayout:void 0,bufferLayout:[]};get[Symbol.toStringTag](){return\"VertexArray\"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,n){super(e,n,t.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=uq(n.shaderLayout,n.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(e,n){this.device.reportError(new Error(\"constant attributes not supported\"),this)()}}});var Mb,fq=Kt(()=>{ql();Mb=class t extends fr{static defaultProps={...fr.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return\"TransformFeedback\"}constructor(e,n){super(e,n,t.defaultProps)}}});var Ib,dq=Kt(()=>{ql();Ib=class t extends fr{get[Symbol.toStringTag](){return\"QuerySet\"}constructor(e,n){super(e,n,t.defaultProps)}static defaultProps={...fr.defaultProps,type:void 0,count:void 0}}});function YO(t){return(!VC||VC.byteLength<t)&&(VC=new ArrayBuffer(t)),VC}function ZO(t,e){let n=YO(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}var VC,qO=Kt(()=>{});function __e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function xy(t){return Array.isArray(t)?t.length===0||typeof t[0]==\"number\":__e(t)}var QO=Kt(()=>{});var y_e,GC,pq=Kt(()=>{_b();zC();qO();QO();Tp();y_e=1024,GC=class{layout={};byteLength;constructor(e,n={}){let r=0;for(let[o,s]of Object.entries(e)){let c=Sb(s),{type:d,components:m}=c,b=m*(n?.[o]??1);r=FZ(r,b);let C=r;r+=b,this.layout[o]={type:d,size:b,offset:C}}r+=(4-r%4)%4;let i=r*4;this.byteLength=Math.max(i,y_e)}getData(e){let n=YO(this.byteLength),r={i32:new Int32Array(n),u32:new Uint32Array(n),f32:new Float32Array(n),f16:new Uint16Array(n)};for(let[i,o]of Object.entries(e)){let s=this.layout[i];if(!s){St.warn(`Supplied uniform value ${i} not present in uniform block layout`)();continue}let{type:c,size:d,offset:m}=s,b=r[c];if(d===1){if(typeof o!=\"number\"&&typeof o!=\"boolean\"){St.warn(`Supplied value for single component uniform ${i} is not a number: ${o}`)();continue}b[m]=Number(o)}else{if(!xy(o)){St.warn(`Supplied value for multi component / array uniform ${i} is not a numeric array: ${o}`)();continue}b.set(o,m)}}return new Uint8Array(n,0,this.byteLength)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}});function Aq(t,e,n=16){if(t!==e)return!1;let r=t,i=e;if(!xy(r))return!1;if(xy(i)&&r.length===i.length){for(let o=0;o<r.length;++o)if(i[o]!==r[o])return!1}return!0}function gq(t){return xy(t)?t.slice():t}var mq=Kt(()=>{QO()});var HC,_q=Kt(()=>{mq();HC=class{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw=\"initialized\";constructor(e){if(this.name=e?.name||\"unnamed\",e?.name&&e?.shaderLayout){let n=e?.shaderLayout.bindings?.find(i=>i.type===\"uniform\"&&i.name===e?.name);if(!n)throw new Error(e?.name);let r=n;for(let i of r.uniforms||[])this.bindingLayout[i.name]=i}}setUniforms(e){for(let[n,r]of Object.entries(e))this._setUniform(n,r),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${n}=${r}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,n){Aq(this.uniforms[e],n)||(this.uniforms[e]=gq(n),this.modifiedUniforms[e]=!0,this.modified=!0)}}});var Pb,yq=Kt(()=>{BC();Tp();_q();pq();Pb=class{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(let[n,r]of Object.entries(e)){let i=n,o=new GC(r.uniformTypes??{},r.uniformSizes??{});this.uniformBufferLayouts.set(i,o);let s=new HC({name:n});s.setUniforms(r.defaultUniforms||{}),this.uniformBlocks.set(i,s)}}destroy(){for(let e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(let[n,r]of Object.entries(e))this.uniformBlocks.get(n)?.setUniforms(r);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){let n=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(n)}createUniformBuffer(e,n,r){r&&this.setUniforms(r);let i=this.getUniformBufferByteLength(n),o=e.createBuffer({usage:ei.UNIFORM|ei.COPY_DST,byteLength:i}),s=this.getUniformBufferData(n);return o.write(s),o}getManagedUniformBuffer(e,n){if(!this.uniformBuffers.get(n)){let r=this.getUniformBufferByteLength(n),i=e.createBuffer({usage:ei.UNIFORM|ei.COPY_DST,byteLength:r});this.uniformBuffers.set(n,i)}return this.uniformBuffers.get(n)}updateUniformBuffers(){let e=!1;for(let n of this.uniformBlocks.keys()){let r=this.updateUniformBuffer(n);e||=r}return e&&St.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){let n=this.uniformBlocks.get(e),r=this.uniformBuffers.get(e),i=!1;if(r&&n?.needsRedraw){i||=n.needsRedraw;let o=this.getUniformBufferData(e);r=this.uniformBuffers.get(e),r?.write(o);let s=this.uniformBlocks.get(e)?.getAllUniforms();St.log(4,`Writing to uniform buffer ${String(e)}`,o,s)()}return i}}});var lr=Kt(()=>{XZ();YZ();UO();JZ();BC();HO();$Z();rq();GO();iq();oq();sq();aq();lq();cq();hq();fq();dq();yq();_b();zC();DC();zO();Tp();qO();XO()});var kA,qK=Kt(()=>{(function(t){t[t.DEPTH_BUFFER_BIT=256]=\"DEPTH_BUFFER_BIT\",t[t.STENCIL_BUFFER_BIT=1024]=\"STENCIL_BUFFER_BIT\",t[t.COLOR_BUFFER_BIT=16384]=\"COLOR_BUFFER_BIT\",t[t.POINTS=0]=\"POINTS\",t[t.LINES=1]=\"LINES\",t[t.LINE_LOOP=2]=\"LINE_LOOP\",t[t.LINE_STRIP=3]=\"LINE_STRIP\",t[t.TRIANGLES=4]=\"TRIANGLES\",t[t.TRIANGLE_STRIP=5]=\"TRIANGLE_STRIP\",t[t.TRIANGLE_FAN=6]=\"TRIANGLE_FAN\",t[t.ZERO=0]=\"ZERO\",t[t.ONE=1]=\"ONE\",t[t.SRC_COLOR=768]=\"SRC_COLOR\",t[t.ONE_MINUS_SRC_COLOR=769]=\"ONE_MINUS_SRC_COLOR\",t[t.SRC_ALPHA=770]=\"SRC_ALPHA\",t[t.ONE_MINUS_SRC_ALPHA=771]=\"ONE_MINUS_SRC_ALPHA\",t[t.DST_ALPHA=772]=\"DST_ALPHA\",t[t.ONE_MINUS_DST_ALPHA=773]=\"ONE_MINUS_DST_ALPHA\",t[t.DST_COLOR=774]=\"DST_COLOR\",t[t.ONE_MINUS_DST_COLOR=775]=\"ONE_MINUS_DST_COLOR\",t[t.SRC_ALPHA_SATURATE=776]=\"SRC_ALPHA_SATURATE\",t[t.CONSTANT_COLOR=32769]=\"CONSTANT_COLOR\",t[t.ONE_MINUS_CONSTANT_COLOR=32770]=\"ONE_MINUS_CONSTANT_COLOR\",t[t.CONSTANT_ALPHA=32771]=\"CONSTANT_ALPHA\",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]=\"ONE_MINUS_CONSTANT_ALPHA\",t[t.FUNC_ADD=32774]=\"FUNC_ADD\",t[t.FUNC_SUBTRACT=32778]=\"FUNC_SUBTRACT\",t[t.FUNC_REVERSE_SUBTRACT=32779]=\"FUNC_REVERSE_SUBTRACT\",t[t.BLEND_EQUATION=32777]=\"BLEND_EQUATION\",t[t.BLEND_EQUATION_RGB=32777]=\"BLEND_EQUATION_RGB\",t[t.BLEND_EQUATION_ALPHA=34877]=\"BLEND_EQUATION_ALPHA\",t[t.BLEND_DST_RGB=32968]=\"BLEND_DST_RGB\",t[t.BLEND_SRC_RGB=32969]=\"BLEND_SRC_RGB\",t[t.BLEND_DST_ALPHA=32970]=\"BLEND_DST_ALPHA\",t[t.BLEND_SRC_ALPHA=32971]=\"BLEND_SRC_ALPHA\",t[t.BLEND_COLOR=32773]=\"BLEND_COLOR\",t[t.ARRAY_BUFFER_BINDING=34964]=\"ARRAY_BUFFER_BINDING\",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]=\"ELEMENT_ARRAY_BUFFER_BINDING\",t[t.LINE_WIDTH=2849]=\"LINE_WIDTH\",t[t.ALIASED_POINT_SIZE_RANGE=33901]=\"ALIASED_POINT_SIZE_RANGE\",t[t.ALIASED_LINE_WIDTH_RANGE=33902]=\"ALIASED_LINE_WIDTH_RANGE\",t[t.CULL_FACE_MODE=2885]=\"CULL_FACE_MODE\",t[t.FRONT_FACE=2886]=\"FRONT_FACE\",t[t.DEPTH_RANGE=2928]=\"DEPTH_RANGE\",t[t.DEPTH_WRITEMASK=2930]=\"DEPTH_WRITEMASK\",t[t.DEPTH_CLEAR_VALUE=2931]=\"DEPTH_CLEAR_VALUE\",t[t.DEPTH_FUNC=2932]=\"DEPTH_FUNC\",t[t.STENCIL_CLEAR_VALUE=2961]=\"STENCIL_CLEAR_VALUE\",t[t.STENCIL_FUNC=2962]=\"STENCIL_FUNC\",t[t.STENCIL_FAIL=2964]=\"STENCIL_FAIL\",t[t.STENCIL_PASS_DEPTH_FAIL=2965]=\"STENCIL_PASS_DEPTH_FAIL\",t[t.STENCIL_PASS_DEPTH_PASS=2966]=\"STENCIL_PASS_DEPTH_PASS\",t[t.STENCIL_REF=2967]=\"STENCIL_REF\",t[t.STENCIL_VALUE_MASK=2963]=\"STENCIL_VALUE_MASK\",t[t.STENCIL_WRITEMASK=2968]=\"STENCIL_WRITEMASK\",t[t.STENCIL_BACK_FUNC=34816]=\"STENCIL_BACK_FUNC\",t[t.STENCIL_BACK_FAIL=34817]=\"STENCIL_BACK_FAIL\",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]=\"STENCIL_BACK_PASS_DEPTH_FAIL\",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]=\"STENCIL_BACK_PASS_DEPTH_PASS\",t[t.STENCIL_BACK_REF=36003]=\"STENCIL_BACK_REF\",t[t.STENCIL_BACK_VALUE_MASK=36004]=\"STENCIL_BACK_VALUE_MASK\",t[t.STENCIL_BACK_WRITEMASK=36005]=\"STENCIL_BACK_WRITEMASK\",t[t.VIEWPORT=2978]=\"VIEWPORT\",t[t.SCISSOR_BOX=3088]=\"SCISSOR_BOX\",t[t.COLOR_CLEAR_VALUE=3106]=\"COLOR_CLEAR_VALUE\",t[t.COLOR_WRITEMASK=3107]=\"COLOR_WRITEMASK\",t[t.UNPACK_ALIGNMENT=3317]=\"UNPACK_ALIGNMENT\",t[t.PACK_ALIGNMENT=3333]=\"PACK_ALIGNMENT\",t[t.MAX_TEXTURE_SIZE=3379]=\"MAX_TEXTURE_SIZE\",t[t.MAX_VIEWPORT_DIMS=3386]=\"MAX_VIEWPORT_DIMS\",t[t.SUBPIXEL_BITS=3408]=\"SUBPIXEL_BITS\",t[t.RED_BITS=3410]=\"RED_BITS\",t[t.GREEN_BITS=3411]=\"GREEN_BITS\",t[t.BLUE_BITS=3412]=\"BLUE_BITS\",t[t.ALPHA_BITS=3413]=\"ALPHA_BITS\",t[t.DEPTH_BITS=3414]=\"DEPTH_BITS\",t[t.STENCIL_BITS=3415]=\"STENCIL_BITS\",t[t.POLYGON_OFFSET_UNITS=10752]=\"POLYGON_OFFSET_UNITS\",t[t.POLYGON_OFFSET_FACTOR=32824]=\"POLYGON_OFFSET_FACTOR\",t[t.TEXTURE_BINDING_2D=32873]=\"TEXTURE_BINDING_2D\",t[t.SAMPLE_BUFFERS=32936]=\"SAMPLE_BUFFERS\",t[t.SAMPLES=32937]=\"SAMPLES\",t[t.SAMPLE_COVERAGE_VALUE=32938]=\"SAMPLE_COVERAGE_VALUE\",t[t.SAMPLE_COVERAGE_INVERT=32939]=\"SAMPLE_COVERAGE_INVERT\",t[t.COMPRESSED_TEXTURE_FORMATS=34467]=\"COMPRESSED_TEXTURE_FORMATS\",t[t.VENDOR=7936]=\"VENDOR\",t[t.RENDERER=7937]=\"RENDERER\",t[t.VERSION=7938]=\"VERSION\",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]=\"IMPLEMENTATION_COLOR_READ_TYPE\",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]=\"IMPLEMENTATION_COLOR_READ_FORMAT\",t[t.BROWSER_DEFAULT_WEBGL=37444]=\"BROWSER_DEFAULT_WEBGL\",t[t.STATIC_DRAW=35044]=\"STATIC_DRAW\",t[t.STREAM_DRAW=35040]=\"STREAM_DRAW\",t[t.DYNAMIC_DRAW=35048]=\"DYNAMIC_DRAW\",t[t.ARRAY_BUFFER=34962]=\"ARRAY_BUFFER\",t[t.ELEMENT_ARRAY_BUFFER=34963]=\"ELEMENT_ARRAY_BUFFER\",t[t.BUFFER_SIZE=34660]=\"BUFFER_SIZE\",t[t.BUFFER_USAGE=34661]=\"BUFFER_USAGE\",t[t.CURRENT_VERTEX_ATTRIB=34342]=\"CURRENT_VERTEX_ATTRIB\",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]=\"VERTEX_ATTRIB_ARRAY_ENABLED\",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]=\"VERTEX_ATTRIB_ARRAY_SIZE\",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]=\"VERTEX_ATTRIB_ARRAY_STRIDE\",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]=\"VERTEX_ATTRIB_ARRAY_TYPE\",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]=\"VERTEX_ATTRIB_ARRAY_NORMALIZED\",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]=\"VERTEX_ATTRIB_ARRAY_POINTER\",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]=\"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING\",t[t.CULL_FACE=2884]=\"CULL_FACE\",t[t.FRONT=1028]=\"FRONT\",t[t.BACK=1029]=\"BACK\",t[t.FRONT_AND_BACK=1032]=\"FRONT_AND_BACK\",t[t.BLEND=3042]=\"BLEND\",t[t.DEPTH_TEST=2929]=\"DEPTH_TEST\",t[t.DITHER=3024]=\"DITHER\",t[t.POLYGON_OFFSET_FILL=32823]=\"POLYGON_OFFSET_FILL\",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]=\"SAMPLE_ALPHA_TO_COVERAGE\",t[t.SAMPLE_COVERAGE=32928]=\"SAMPLE_COVERAGE\",t[t.SCISSOR_TEST=3089]=\"SCISSOR_TEST\",t[t.STENCIL_TEST=2960]=\"STENCIL_TEST\",t[t.NO_ERROR=0]=\"NO_ERROR\",t[t.INVALID_ENUM=1280]=\"INVALID_ENUM\",t[t.INVALID_VALUE=1281]=\"INVALID_VALUE\",t[t.INVALID_OPERATION=1282]=\"INVALID_OPERATION\",t[t.OUT_OF_MEMORY=1285]=\"OUT_OF_MEMORY\",t[t.CONTEXT_LOST_WEBGL=37442]=\"CONTEXT_LOST_WEBGL\",t[t.CW=2304]=\"CW\",t[t.CCW=2305]=\"CCW\",t[t.DONT_CARE=4352]=\"DONT_CARE\",t[t.FASTEST=4353]=\"FASTEST\",t[t.NICEST=4354]=\"NICEST\",t[t.GENERATE_MIPMAP_HINT=33170]=\"GENERATE_MIPMAP_HINT\",t[t.BYTE=5120]=\"BYTE\",t[t.UNSIGNED_BYTE=5121]=\"UNSIGNED_BYTE\",t[t.SHORT=5122]=\"SHORT\",t[t.UNSIGNED_SHORT=5123]=\"UNSIGNED_SHORT\",t[t.INT=5124]=\"INT\",t[t.UNSIGNED_INT=5125]=\"UNSIGNED_INT\",t[t.FLOAT=5126]=\"FLOAT\",t[t.DOUBLE=5130]=\"DOUBLE\",t[t.DEPTH_COMPONENT=6402]=\"DEPTH_COMPONENT\",t[t.ALPHA=6406]=\"ALPHA\",t[t.RGB=6407]=\"RGB\",t[t.RGBA=6408]=\"RGBA\",t[t.LUMINANCE=6409]=\"LUMINANCE\",t[t.LUMINANCE_ALPHA=6410]=\"LUMINANCE_ALPHA\",t[t.UNSIGNED_SHORT_4_4_4_4=32819]=\"UNSIGNED_SHORT_4_4_4_4\",t[t.UNSIGNED_SHORT_5_5_5_1=32820]=\"UNSIGNED_SHORT_5_5_5_1\",t[t.UNSIGNED_SHORT_5_6_5=33635]=\"UNSIGNED_SHORT_5_6_5\",t[t.FRAGMENT_SHADER=35632]=\"FRAGMENT_SHADER\",t[t.VERTEX_SHADER=35633]=\"VERTEX_SHADER\",t[t.COMPILE_STATUS=35713]=\"COMPILE_STATUS\",t[t.DELETE_STATUS=35712]=\"DELETE_STATUS\",t[t.LINK_STATUS=35714]=\"LINK_STATUS\",t[t.VALIDATE_STATUS=35715]=\"VALIDATE_STATUS\",t[t.ATTACHED_SHADERS=35717]=\"ATTACHED_SHADERS\",t[t.ACTIVE_ATTRIBUTES=35721]=\"ACTIVE_ATTRIBUTES\",t[t.ACTIVE_UNIFORMS=35718]=\"ACTIVE_UNIFORMS\",t[t.MAX_VERTEX_ATTRIBS=34921]=\"MAX_VERTEX_ATTRIBS\",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]=\"MAX_VERTEX_UNIFORM_VECTORS\",t[t.MAX_VARYING_VECTORS=36348]=\"MAX_VARYING_VECTORS\",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]=\"MAX_COMBINED_TEXTURE_IMAGE_UNITS\",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]=\"MAX_VERTEX_TEXTURE_IMAGE_UNITS\",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]=\"MAX_TEXTURE_IMAGE_UNITS\",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]=\"MAX_FRAGMENT_UNIFORM_VECTORS\",t[t.SHADER_TYPE=35663]=\"SHADER_TYPE\",t[t.SHADING_LANGUAGE_VERSION=35724]=\"SHADING_LANGUAGE_VERSION\",t[t.CURRENT_PROGRAM=35725]=\"CURRENT_PROGRAM\",t[t.NEVER=512]=\"NEVER\",t[t.LESS=513]=\"LESS\",t[t.EQUAL=514]=\"EQUAL\",t[t.LEQUAL=515]=\"LEQUAL\",t[t.GREATER=516]=\"GREATER\",t[t.NOTEQUAL=517]=\"NOTEQUAL\",t[t.GEQUAL=518]=\"GEQUAL\",t[t.ALWAYS=519]=\"ALWAYS\",t[t.KEEP=7680]=\"KEEP\",t[t.REPLACE=7681]=\"REPLACE\",t[t.INCR=7682]=\"INCR\",t[t.DECR=7683]=\"DECR\",t[t.INVERT=5386]=\"INVERT\",t[t.INCR_WRAP=34055]=\"INCR_WRAP\",t[t.DECR_WRAP=34056]=\"DECR_WRAP\",t[t.NEAREST=9728]=\"NEAREST\",t[t.LINEAR=9729]=\"LINEAR\",t[t.NEAREST_MIPMAP_NEAREST=9984]=\"NEAREST_MIPMAP_NEAREST\",t[t.LINEAR_MIPMAP_NEAREST=9985]=\"LINEAR_MIPMAP_NEAREST\",t[t.NEAREST_MIPMAP_LINEAR=9986]=\"NEAREST_MIPMAP_LINEAR\",t[t.LINEAR_MIPMAP_LINEAR=9987]=\"LINEAR_MIPMAP_LINEAR\",t[t.TEXTURE_MAG_FILTER=10240]=\"TEXTURE_MAG_FILTER\",t[t.TEXTURE_MIN_FILTER=10241]=\"TEXTURE_MIN_FILTER\",t[t.TEXTURE_WRAP_S=10242]=\"TEXTURE_WRAP_S\",t[t.TEXTURE_WRAP_T=10243]=\"TEXTURE_WRAP_T\",t[t.TEXTURE_2D=3553]=\"TEXTURE_2D\",t[t.TEXTURE=5890]=\"TEXTURE\",t[t.TEXTURE_CUBE_MAP=34067]=\"TEXTURE_CUBE_MAP\",t[t.TEXTURE_BINDING_CUBE_MAP=34068]=\"TEXTURE_BINDING_CUBE_MAP\",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]=\"TEXTURE_CUBE_MAP_POSITIVE_X\",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]=\"TEXTURE_CUBE_MAP_NEGATIVE_X\",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]=\"TEXTURE_CUBE_MAP_POSITIVE_Y\",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]=\"TEXTURE_CUBE_MAP_NEGATIVE_Y\",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]=\"TEXTURE_CUBE_MAP_POSITIVE_Z\",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]=\"TEXTURE_CUBE_MAP_NEGATIVE_Z\",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]=\"MAX_CUBE_MAP_TEXTURE_SIZE\",t[t.TEXTURE0=33984]=\"TEXTURE0\",t[t.ACTIVE_TEXTURE=34016]=\"ACTIVE_TEXTURE\",t[t.REPEAT=10497]=\"REPEAT\",t[t.CLAMP_TO_EDGE=33071]=\"CLAMP_TO_EDGE\",t[t.MIRRORED_REPEAT=33648]=\"MIRRORED_REPEAT\",t[t.TEXTURE_WIDTH=4096]=\"TEXTURE_WIDTH\",t[t.TEXTURE_HEIGHT=4097]=\"TEXTURE_HEIGHT\",t[t.FLOAT_VEC2=35664]=\"FLOAT_VEC2\",t[t.FLOAT_VEC3=35665]=\"FLOAT_VEC3\",t[t.FLOAT_VEC4=35666]=\"FLOAT_VEC4\",t[t.INT_VEC2=35667]=\"INT_VEC2\",t[t.INT_VEC3=35668]=\"INT_VEC3\",t[t.INT_VEC4=35669]=\"INT_VEC4\",t[t.BOOL=35670]=\"BOOL\",t[t.BOOL_VEC2=35671]=\"BOOL_VEC2\",t[t.BOOL_VEC3=35672]=\"BOOL_VEC3\",t[t.BOOL_VEC4=35673]=\"BOOL_VEC4\",t[t.FLOAT_MAT2=35674]=\"FLOAT_MAT2\",t[t.FLOAT_MAT3=35675]=\"FLOAT_MAT3\",t[t.FLOAT_MAT4=35676]=\"FLOAT_MAT4\",t[t.SAMPLER_2D=35678]=\"SAMPLER_2D\",t[t.SAMPLER_CUBE=35680]=\"SAMPLER_CUBE\",t[t.LOW_FLOAT=36336]=\"LOW_FLOAT\",t[t.MEDIUM_FLOAT=36337]=\"MEDIUM_FLOAT\",t[t.HIGH_FLOAT=36338]=\"HIGH_FLOAT\",t[t.LOW_INT=36339]=\"LOW_INT\",t[t.MEDIUM_INT=36340]=\"MEDIUM_INT\",t[t.HIGH_INT=36341]=\"HIGH_INT\",t[t.FRAMEBUFFER=36160]=\"FRAMEBUFFER\",t[t.RENDERBUFFER=36161]=\"RENDERBUFFER\",t[t.RGBA4=32854]=\"RGBA4\",t[t.RGB5_A1=32855]=\"RGB5_A1\",t[t.RGB565=36194]=\"RGB565\",t[t.DEPTH_COMPONENT16=33189]=\"DEPTH_COMPONENT16\",t[t.STENCIL_INDEX=6401]=\"STENCIL_INDEX\",t[t.STENCIL_INDEX8=36168]=\"STENCIL_INDEX8\",t[t.DEPTH_STENCIL=34041]=\"DEPTH_STENCIL\",t[t.RENDERBUFFER_WIDTH=36162]=\"RENDERBUFFER_WIDTH\",t[t.RENDERBUFFER_HEIGHT=36163]=\"RENDERBUFFER_HEIGHT\",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]=\"RENDERBUFFER_INTERNAL_FORMAT\",t[t.RENDERBUFFER_RED_SIZE=36176]=\"RENDERBUFFER_RED_SIZE\",t[t.RENDERBUFFER_GREEN_SIZE=36177]=\"RENDERBUFFER_GREEN_SIZE\",t[t.RENDERBUFFER_BLUE_SIZE=36178]=\"RENDERBUFFER_BLUE_SIZE\",t[t.RENDERBUFFER_ALPHA_SIZE=36179]=\"RENDERBUFFER_ALPHA_SIZE\",t[t.RENDERBUFFER_DEPTH_SIZE=36180]=\"RENDERBUFFER_DEPTH_SIZE\",t[t.RENDERBUFFER_STENCIL_SIZE=36181]=\"RENDERBUFFER_STENCIL_SIZE\",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]=\"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE\",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]=\"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME\",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]=\"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL\",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]=\"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE\",t[t.COLOR_ATTACHMENT0=36064]=\"COLOR_ATTACHMENT0\",t[t.DEPTH_ATTACHMENT=36096]=\"DEPTH_ATTACHMENT\",t[t.STENCIL_ATTACHMENT=36128]=\"STENCIL_ATTACHMENT\",t[t.DEPTH_STENCIL_ATTACHMENT=33306]=\"DEPTH_STENCIL_ATTACHMENT\",t[t.NONE=0]=\"NONE\",t[t.FRAMEBUFFER_COMPLETE=36053]=\"FRAMEBUFFER_COMPLETE\",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]=\"FRAMEBUFFER_INCOMPLETE_ATTACHMENT\",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]=\"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT\",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]=\"FRAMEBUFFER_INCOMPLETE_DIMENSIONS\",t[t.FRAMEBUFFER_UNSUPPORTED=36061]=\"FRAMEBUFFER_UNSUPPORTED\",t[t.FRAMEBUFFER_BINDING=36006]=\"FRAMEBUFFER_BINDING\",t[t.RENDERBUFFER_BINDING=36007]=\"RENDERBUFFER_BINDING\",t[t.READ_FRAMEBUFFER=36008]=\"READ_FRAMEBUFFER\",t[t.DRAW_FRAMEBUFFER=36009]=\"DRAW_FRAMEBUFFER\",t[t.MAX_RENDERBUFFER_SIZE=34024]=\"MAX_RENDERBUFFER_SIZE\",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]=\"INVALID_FRAMEBUFFER_OPERATION\",t[t.UNPACK_FLIP_Y_WEBGL=37440]=\"UNPACK_FLIP_Y_WEBGL\",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]=\"UNPACK_PREMULTIPLY_ALPHA_WEBGL\",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]=\"UNPACK_COLORSPACE_CONVERSION_WEBGL\",t[t.READ_BUFFER=3074]=\"READ_BUFFER\",t[t.UNPACK_ROW_LENGTH=3314]=\"UNPACK_ROW_LENGTH\",t[t.UNPACK_SKIP_ROWS=3315]=\"UNPACK_SKIP_ROWS\",t[t.UNPACK_SKIP_PIXELS=3316]=\"UNPACK_SKIP_PIXELS\",t[t.PACK_ROW_LENGTH=3330]=\"PACK_ROW_LENGTH\",t[t.PACK_SKIP_ROWS=3331]=\"PACK_SKIP_ROWS\",t[t.PACK_SKIP_PIXELS=3332]=\"PACK_SKIP_PIXELS\",t[t.TEXTURE_BINDING_3D=32874]=\"TEXTURE_BINDING_3D\",t[t.UNPACK_SKIP_IMAGES=32877]=\"UNPACK_SKIP_IMAGES\",t[t.UNPACK_IMAGE_HEIGHT=32878]=\"UNPACK_IMAGE_HEIGHT\",t[t.MAX_3D_TEXTURE_SIZE=32883]=\"MAX_3D_TEXTURE_SIZE\",t[t.MAX_ELEMENTS_VERTICES=33e3]=\"MAX_ELEMENTS_VERTICES\",t[t.MAX_ELEMENTS_INDICES=33001]=\"MAX_ELEMENTS_INDICES\",t[t.MAX_TEXTURE_LOD_BIAS=34045]=\"MAX_TEXTURE_LOD_BIAS\",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]=\"MAX_FRAGMENT_UNIFORM_COMPONENTS\",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]=\"MAX_VERTEX_UNIFORM_COMPONENTS\",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]=\"MAX_ARRAY_TEXTURE_LAYERS\",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]=\"MIN_PROGRAM_TEXEL_OFFSET\",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]=\"MAX_PROGRAM_TEXEL_OFFSET\",t[t.MAX_VARYING_COMPONENTS=35659]=\"MAX_VARYING_COMPONENTS\",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]=\"FRAGMENT_SHADER_DERIVATIVE_HINT\",t[t.RASTERIZER_DISCARD=35977]=\"RASTERIZER_DISCARD\",t[t.VERTEX_ARRAY_BINDING=34229]=\"VERTEX_ARRAY_BINDING\",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]=\"MAX_VERTEX_OUTPUT_COMPONENTS\",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]=\"MAX_FRAGMENT_INPUT_COMPONENTS\",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]=\"MAX_SERVER_WAIT_TIMEOUT\",t[t.MAX_ELEMENT_INDEX=36203]=\"MAX_ELEMENT_INDEX\",t[t.RED=6403]=\"RED\",t[t.RGB8=32849]=\"RGB8\",t[t.RGBA8=32856]=\"RGBA8\",t[t.RGB10_A2=32857]=\"RGB10_A2\",t[t.TEXTURE_3D=32879]=\"TEXTURE_3D\",t[t.TEXTURE_WRAP_R=32882]=\"TEXTURE_WRAP_R\",t[t.TEXTURE_MIN_LOD=33082]=\"TEXTURE_MIN_LOD\",t[t.TEXTURE_MAX_LOD=33083]=\"TEXTURE_MAX_LOD\",t[t.TEXTURE_BASE_LEVEL=33084]=\"TEXTURE_BASE_LEVEL\",t[t.TEXTURE_MAX_LEVEL=33085]=\"TEXTURE_MAX_LEVEL\",t[t.TEXTURE_COMPARE_MODE=34892]=\"TEXTURE_COMPARE_MODE\",t[t.TEXTURE_COMPARE_FUNC=34893]=\"TEXTURE_COMPARE_FUNC\",t[t.SRGB=35904]=\"SRGB\",t[t.SRGB8=35905]=\"SRGB8\",t[t.SRGB8_ALPHA8=35907]=\"SRGB8_ALPHA8\",t[t.COMPARE_REF_TO_TEXTURE=34894]=\"COMPARE_REF_TO_TEXTURE\",t[t.RGBA32F=34836]=\"RGBA32F\",t[t.RGB32F=34837]=\"RGB32F\",t[t.RGBA16F=34842]=\"RGBA16F\",t[t.RGB16F=34843]=\"RGB16F\",t[t.TEXTURE_2D_ARRAY=35866]=\"TEXTURE_2D_ARRAY\",t[t.TEXTURE_BINDING_2D_ARRAY=35869]=\"TEXTURE_BINDING_2D_ARRAY\",t[t.R11F_G11F_B10F=35898]=\"R11F_G11F_B10F\",t[t.RGB9_E5=35901]=\"RGB9_E5\",t[t.RGBA32UI=36208]=\"RGBA32UI\",t[t.RGB32UI=36209]=\"RGB32UI\",t[t.RGBA16UI=36214]=\"RGBA16UI\",t[t.RGB16UI=36215]=\"RGB16UI\",t[t.RGBA8UI=36220]=\"RGBA8UI\",t[t.RGB8UI=36221]=\"RGB8UI\",t[t.RGBA32I=36226]=\"RGBA32I\",t[t.RGB32I=36227]=\"RGB32I\",t[t.RGBA16I=36232]=\"RGBA16I\",t[t.RGB16I=36233]=\"RGB16I\",t[t.RGBA8I=36238]=\"RGBA8I\",t[t.RGB8I=36239]=\"RGB8I\",t[t.RED_INTEGER=36244]=\"RED_INTEGER\",t[t.RGB_INTEGER=36248]=\"RGB_INTEGER\",t[t.RGBA_INTEGER=36249]=\"RGBA_INTEGER\",t[t.R8=33321]=\"R8\",t[t.RG8=33323]=\"RG8\",t[t.R16F=33325]=\"R16F\",t[t.R32F=33326]=\"R32F\",t[t.RG16F=33327]=\"RG16F\",t[t.RG32F=33328]=\"RG32F\",t[t.R8I=33329]=\"R8I\",t[t.R8UI=33330]=\"R8UI\",t[t.R16I=33331]=\"R16I\",t[t.R16UI=33332]=\"R16UI\",t[t.R32I=33333]=\"R32I\",t[t.R32UI=33334]=\"R32UI\",t[t.RG8I=33335]=\"RG8I\",t[t.RG8UI=33336]=\"RG8UI\",t[t.RG16I=33337]=\"RG16I\",t[t.RG16UI=33338]=\"RG16UI\",t[t.RG32I=33339]=\"RG32I\",t[t.RG32UI=33340]=\"RG32UI\",t[t.R8_SNORM=36756]=\"R8_SNORM\",t[t.RG8_SNORM=36757]=\"RG8_SNORM\",t[t.RGB8_SNORM=36758]=\"RGB8_SNORM\",t[t.RGBA8_SNORM=36759]=\"RGBA8_SNORM\",t[t.RGB10_A2UI=36975]=\"RGB10_A2UI\",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]=\"TEXTURE_IMMUTABLE_FORMAT\",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]=\"TEXTURE_IMMUTABLE_LEVELS\",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]=\"UNSIGNED_INT_2_10_10_10_REV\",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]=\"UNSIGNED_INT_10F_11F_11F_REV\",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]=\"UNSIGNED_INT_5_9_9_9_REV\",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]=\"FLOAT_32_UNSIGNED_INT_24_8_REV\",t[t.UNSIGNED_INT_24_8=34042]=\"UNSIGNED_INT_24_8\",t[t.HALF_FLOAT=5131]=\"HALF_FLOAT\",t[t.RG=33319]=\"RG\",t[t.RG_INTEGER=33320]=\"RG_INTEGER\",t[t.INT_2_10_10_10_REV=36255]=\"INT_2_10_10_10_REV\",t[t.CURRENT_QUERY=34917]=\"CURRENT_QUERY\",t[t.QUERY_RESULT=34918]=\"QUERY_RESULT\",t[t.QUERY_RESULT_AVAILABLE=34919]=\"QUERY_RESULT_AVAILABLE\",t[t.ANY_SAMPLES_PASSED=35887]=\"ANY_SAMPLES_PASSED\",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]=\"ANY_SAMPLES_PASSED_CONSERVATIVE\",t[t.MAX_DRAW_BUFFERS=34852]=\"MAX_DRAW_BUFFERS\",t[t.DRAW_BUFFER0=34853]=\"DRAW_BUFFER0\",t[t.DRAW_BUFFER1=34854]=\"DRAW_BUFFER1\",t[t.DRAW_BUFFER2=34855]=\"DRAW_BUFFER2\",t[t.DRAW_BUFFER3=34856]=\"DRAW_BUFFER3\",t[t.DRAW_BUFFER4=34857]=\"DRAW_BUFFER4\",t[t.DRAW_BUFFER5=34858]=\"DRAW_BUFFER5\",t[t.DRAW_BUFFER6=34859]=\"DRAW_BUFFER6\",t[t.DRAW_BUFFER7=34860]=\"DRAW_BUFFER7\",t[t.DRAW_BUFFER8=34861]=\"DRAW_BUFFER8\",t[t.DRAW_BUFFER9=34862]=\"DRAW_BUFFER9\",t[t.DRAW_BUFFER10=34863]=\"DRAW_BUFFER10\",t[t.DRAW_BUFFER11=34864]=\"DRAW_BUFFER11\",t[t.DRAW_BUFFER12=34865]=\"DRAW_BUFFER12\",t[t.DRAW_BUFFER13=34866]=\"DRAW_BUFFER13\",t[t.DRAW_BUFFER14=34867]=\"DRAW_BUFFER14\",t[t.DRAW_BUFFER15=34868]=\"DRAW_BUFFER15\",t[t.MAX_COLOR_ATTACHMENTS=36063]=\"MAX_COLOR_ATTACHMENTS\",t[t.COLOR_ATTACHMENT1=36065]=\"COLOR_ATTACHMENT1\",t[t.COLOR_ATTACHMENT2=36066]=\"COLOR_ATTACHMENT2\",t[t.COLOR_ATTACHMENT3=36067]=\"COLOR_ATTACHMENT3\",t[t.COLOR_ATTACHMENT4=36068]=\"COLOR_ATTACHMENT4\",t[t.COLOR_ATTACHMENT5=36069]=\"COLOR_ATTACHMENT5\",t[t.COLOR_ATTACHMENT6=36070]=\"COLOR_ATTACHMENT6\",t[t.COLOR_ATTACHMENT7=36071]=\"COLOR_ATTACHMENT7\",t[t.COLOR_ATTACHMENT8=36072]=\"COLOR_ATTACHMENT8\",t[t.COLOR_ATTACHMENT9=36073]=\"COLOR_ATTACHMENT9\",t[t.COLOR_ATTACHMENT10=36074]=\"COLOR_ATTACHMENT10\",t[t.COLOR_ATTACHMENT11=36075]=\"COLOR_ATTACHMENT11\",t[t.COLOR_ATTACHMENT12=36076]=\"COLOR_ATTACHMENT12\",t[t.COLOR_ATTACHMENT13=36077]=\"COLOR_ATTACHMENT13\",t[t.COLOR_ATTACHMENT14=36078]=\"COLOR_ATTACHMENT14\",t[t.COLOR_ATTACHMENT15=36079]=\"COLOR_ATTACHMENT15\",t[t.SAMPLER_3D=35679]=\"SAMPLER_3D\",t[t.SAMPLER_2D_SHADOW=35682]=\"SAMPLER_2D_SHADOW\",t[t.SAMPLER_2D_ARRAY=36289]=\"SAMPLER_2D_ARRAY\",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]=\"SAMPLER_2D_ARRAY_SHADOW\",t[t.SAMPLER_CUBE_SHADOW=36293]=\"SAMPLER_CUBE_SHADOW\",t[t.INT_SAMPLER_2D=36298]=\"INT_SAMPLER_2D\",t[t.INT_SAMPLER_3D=36299]=\"INT_SAMPLER_3D\",t[t.INT_SAMPLER_CUBE=36300]=\"INT_SAMPLER_CUBE\",t[t.INT_SAMPLER_2D_ARRAY=36303]=\"INT_SAMPLER_2D_ARRAY\",t[t.UNSIGNED_INT_SAMPLER_2D=36306]=\"UNSIGNED_INT_SAMPLER_2D\",t[t.UNSIGNED_INT_SAMPLER_3D=36307]=\"UNSIGNED_INT_SAMPLER_3D\",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]=\"UNSIGNED_INT_SAMPLER_CUBE\",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]=\"UNSIGNED_INT_SAMPLER_2D_ARRAY\",t[t.MAX_SAMPLES=36183]=\"MAX_SAMPLES\",t[t.SAMPLER_BINDING=35097]=\"SAMPLER_BINDING\",t[t.PIXEL_PACK_BUFFER=35051]=\"PIXEL_PACK_BUFFER\",t[t.PIXEL_UNPACK_BUFFER=35052]=\"PIXEL_UNPACK_BUFFER\",t[t.PIXEL_PACK_BUFFER_BINDING=35053]=\"PIXEL_PACK_BUFFER_BINDING\",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]=\"PIXEL_UNPACK_BUFFER_BINDING\",t[t.COPY_READ_BUFFER=36662]=\"COPY_READ_BUFFER\",t[t.COPY_WRITE_BUFFER=36663]=\"COPY_WRITE_BUFFER\",t[t.COPY_READ_BUFFER_BINDING=36662]=\"COPY_READ_BUFFER_BINDING\",t[t.COPY_WRITE_BUFFER_BINDING=36663]=\"COPY_WRITE_BUFFER_BINDING\",t[t.FLOAT_MAT2x3=35685]=\"FLOAT_MAT2x3\",t[t.FLOAT_MAT2x4=35686]=\"FLOAT_MAT2x4\",t[t.FLOAT_MAT3x2=35687]=\"FLOAT_MAT3x2\",t[t.FLOAT_MAT3x4=35688]=\"FLOAT_MAT3x4\",t[t.FLOAT_MAT4x2=35689]=\"FLOAT_MAT4x2\",t[t.FLOAT_MAT4x3=35690]=\"FLOAT_MAT4x3\",t[t.UNSIGNED_INT_VEC2=36294]=\"UNSIGNED_INT_VEC2\",t[t.UNSIGNED_INT_VEC3=36295]=\"UNSIGNED_INT_VEC3\",t[t.UNSIGNED_INT_VEC4=36296]=\"UNSIGNED_INT_VEC4\",t[t.UNSIGNED_NORMALIZED=35863]=\"UNSIGNED_NORMALIZED\",t[t.SIGNED_NORMALIZED=36764]=\"SIGNED_NORMALIZED\",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]=\"VERTEX_ATTRIB_ARRAY_INTEGER\",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]=\"VERTEX_ATTRIB_ARRAY_DIVISOR\",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]=\"TRANSFORM_FEEDBACK_BUFFER_MODE\",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]=\"MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS\",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]=\"TRANSFORM_FEEDBACK_VARYINGS\",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]=\"TRANSFORM_FEEDBACK_BUFFER_START\",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]=\"TRANSFORM_FEEDBACK_BUFFER_SIZE\",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]=\"TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN\",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]=\"MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS\",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]=\"MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS\",t[t.INTERLEAVED_ATTRIBS=35980]=\"INTERLEAVED_ATTRIBS\",t[t.SEPARATE_ATTRIBS=35981]=\"SEPARATE_ATTRIBS\",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]=\"TRANSFORM_FEEDBACK_BUFFER\",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]=\"TRANSFORM_FEEDBACK_BUFFER_BINDING\",t[t.TRANSFORM_FEEDBACK=36386]=\"TRANSFORM_FEEDBACK\",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]=\"TRANSFORM_FEEDBACK_PAUSED\",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]=\"TRANSFORM_FEEDBACK_ACTIVE\",t[t.TRANSFORM_FEEDBACK_BINDING=36389]=\"TRANSFORM_FEEDBACK_BINDING\",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]=\"FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING\",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]=\"FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE\",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]=\"FRAMEBUFFER_ATTACHMENT_RED_SIZE\",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]=\"FRAMEBUFFER_ATTACHMENT_GREEN_SIZE\",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]=\"FRAMEBUFFER_ATTACHMENT_BLUE_SIZE\",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]=\"FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE\",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]=\"FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE\",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]=\"FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE\",t[t.FRAMEBUFFER_DEFAULT=33304]=\"FRAMEBUFFER_DEFAULT\",t[t.DEPTH24_STENCIL8=35056]=\"DEPTH24_STENCIL8\",t[t.DRAW_FRAMEBUFFER_BINDING=36006]=\"DRAW_FRAMEBUFFER_BINDING\",t[t.READ_FRAMEBUFFER_BINDING=36010]=\"READ_FRAMEBUFFER_BINDING\",t[t.RENDERBUFFER_SAMPLES=36011]=\"RENDERBUFFER_SAMPLES\",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]=\"FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER\",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]=\"FRAMEBUFFER_INCOMPLETE_MULTISAMPLE\",t[t.UNIFORM_BUFFER=35345]=\"UNIFORM_BUFFER\",t[t.UNIFORM_BUFFER_BINDING=35368]=\"UNIFORM_BUFFER_BINDING\",t[t.UNIFORM_BUFFER_START=35369]=\"UNIFORM_BUFFER_START\",t[t.UNIFORM_BUFFER_SIZE=35370]=\"UNIFORM_BUFFER_SIZE\",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]=\"MAX_VERTEX_UNIFORM_BLOCKS\",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]=\"MAX_FRAGMENT_UNIFORM_BLOCKS\",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]=\"MAX_COMBINED_UNIFORM_BLOCKS\",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]=\"MAX_UNIFORM_BUFFER_BINDINGS\",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]=\"MAX_UNIFORM_BLOCK_SIZE\",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]=\"MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS\",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]=\"MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS\",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]=\"UNIFORM_BUFFER_OFFSET_ALIGNMENT\",t[t.ACTIVE_UNIFORM_BLOCKS=35382]=\"ACTIVE_UNIFORM_BLOCKS\",t[t.UNIFORM_TYPE=35383]=\"UNIFORM_TYPE\",t[t.UNIFORM_SIZE=35384]=\"UNIFORM_SIZE\",t[t.UNIFORM_BLOCK_INDEX=35386]=\"UNIFORM_BLOCK_INDEX\",t[t.UNIFORM_OFFSET=35387]=\"UNIFORM_OFFSET\",t[t.UNIFORM_ARRAY_STRIDE=35388]=\"UNIFORM_ARRAY_STRIDE\",t[t.UNIFORM_MATRIX_STRIDE=35389]=\"UNIFORM_MATRIX_STRIDE\",t[t.UNIFORM_IS_ROW_MAJOR=35390]=\"UNIFORM_IS_ROW_MAJOR\",t[t.UNIFORM_BLOCK_BINDING=35391]=\"UNIFORM_BLOCK_BINDING\",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]=\"UNIFORM_BLOCK_DATA_SIZE\",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]=\"UNIFORM_BLOCK_ACTIVE_UNIFORMS\",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]=\"UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES\",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]=\"UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER\",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]=\"UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER\",t[t.OBJECT_TYPE=37138]=\"OBJECT_TYPE\",t[t.SYNC_CONDITION=37139]=\"SYNC_CONDITION\",t[t.SYNC_STATUS=37140]=\"SYNC_STATUS\",t[t.SYNC_FLAGS=37141]=\"SYNC_FLAGS\",t[t.SYNC_FENCE=37142]=\"SYNC_FENCE\",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]=\"SYNC_GPU_COMMANDS_COMPLETE\",t[t.UNSIGNALED=37144]=\"UNSIGNALED\",t[t.SIGNALED=37145]=\"SIGNALED\",t[t.ALREADY_SIGNALED=37146]=\"ALREADY_SIGNALED\",t[t.TIMEOUT_EXPIRED=37147]=\"TIMEOUT_EXPIRED\",t[t.CONDITION_SATISFIED=37148]=\"CONDITION_SATISFIED\",t[t.WAIT_FAILED=37149]=\"WAIT_FAILED\",t[t.SYNC_FLUSH_COMMANDS_BIT=1]=\"SYNC_FLUSH_COMMANDS_BIT\",t[t.COLOR=6144]=\"COLOR\",t[t.DEPTH=6145]=\"DEPTH\",t[t.STENCIL=6146]=\"STENCIL\",t[t.MIN=32775]=\"MIN\",t[t.MAX=32776]=\"MAX\",t[t.DEPTH_COMPONENT24=33190]=\"DEPTH_COMPONENT24\",t[t.STREAM_READ=35041]=\"STREAM_READ\",t[t.STREAM_COPY=35042]=\"STREAM_COPY\",t[t.STATIC_READ=35045]=\"STATIC_READ\",t[t.STATIC_COPY=35046]=\"STATIC_COPY\",t[t.DYNAMIC_READ=35049]=\"DYNAMIC_READ\",t[t.DYNAMIC_COPY=35050]=\"DYNAMIC_COPY\",t[t.DEPTH_COMPONENT32F=36012]=\"DEPTH_COMPONENT32F\",t[t.DEPTH32F_STENCIL8=36013]=\"DEPTH32F_STENCIL8\",t[t.INVALID_INDEX=4294967295]=\"INVALID_INDEX\",t[t.TIMEOUT_IGNORED=-1]=\"TIMEOUT_IGNORED\",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]=\"MAX_CLIENT_WAIT_TIMEOUT_WEBGL\",t[t.UNMASKED_VENDOR_WEBGL=37445]=\"UNMASKED_VENDOR_WEBGL\",t[t.UNMASKED_RENDERER_WEBGL=37446]=\"UNMASKED_RENDERER_WEBGL\",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]=\"MAX_TEXTURE_MAX_ANISOTROPY_EXT\",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]=\"TEXTURE_MAX_ANISOTROPY_EXT\",t[t.R16_EXT=33322]=\"R16_EXT\",t[t.RG16_EXT=33324]=\"RG16_EXT\",t[t.RGB16_EXT=32852]=\"RGB16_EXT\",t[t.RGBA16_EXT=32859]=\"RGBA16_EXT\",t[t.R16_SNORM_EXT=36760]=\"R16_SNORM_EXT\",t[t.RG16_SNORM_EXT=36761]=\"RG16_SNORM_EXT\",t[t.RGB16_SNORM_EXT=36762]=\"RGB16_SNORM_EXT\",t[t.RGBA16_SNORM_EXT=36763]=\"RGBA16_SNORM_EXT\",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]=\"COMPRESSED_RGB_S3TC_DXT1_EXT\",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]=\"COMPRESSED_RGBA_S3TC_DXT1_EXT\",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]=\"COMPRESSED_RGBA_S3TC_DXT3_EXT\",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]=\"COMPRESSED_RGBA_S3TC_DXT5_EXT\",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]=\"COMPRESSED_SRGB_S3TC_DXT1_EXT\",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]=\"COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT\",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]=\"COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT\",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]=\"COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT\",t[t.COMPRESSED_RED_RGTC1_EXT=36283]=\"COMPRESSED_RED_RGTC1_EXT\",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]=\"COMPRESSED_SIGNED_RED_RGTC1_EXT\",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]=\"COMPRESSED_RED_GREEN_RGTC2_EXT\",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]=\"COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT\",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]=\"COMPRESSED_RGBA_BPTC_UNORM_EXT\",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]=\"COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT\",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]=\"COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT\",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]=\"COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT\",t[t.COMPRESSED_R11_EAC=37488]=\"COMPRESSED_R11_EAC\",t[t.COMPRESSED_SIGNED_R11_EAC=37489]=\"COMPRESSED_SIGNED_R11_EAC\",t[t.COMPRESSED_RG11_EAC=37490]=\"COMPRESSED_RG11_EAC\",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]=\"COMPRESSED_SIGNED_RG11_EAC\",t[t.COMPRESSED_RGB8_ETC2=37492]=\"COMPRESSED_RGB8_ETC2\",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]=\"COMPRESSED_RGBA8_ETC2_EAC\",t[t.COMPRESSED_SRGB8_ETC2=37494]=\"COMPRESSED_SRGB8_ETC2\",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]=\"COMPRESSED_SRGB8_ALPHA8_ETC2_EAC\",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]=\"COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2\",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]=\"COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2\",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]=\"COMPRESSED_RGB_PVRTC_4BPPV1_IMG\",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]=\"COMPRESSED_RGBA_PVRTC_4BPPV1_IMG\",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]=\"COMPRESSED_RGB_PVRTC_2BPPV1_IMG\",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]=\"COMPRESSED_RGBA_PVRTC_2BPPV1_IMG\",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]=\"COMPRESSED_RGB_ETC1_WEBGL\",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]=\"COMPRESSED_RGB_ATC_WEBGL\",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]=\"COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL\",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]=\"COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL\",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]=\"COMPRESSED_RGBA_ASTC_4x4_KHR\",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]=\"COMPRESSED_RGBA_ASTC_5x4_KHR\",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]=\"COMPRESSED_RGBA_ASTC_5x5_KHR\",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]=\"COMPRESSED_RGBA_ASTC_6x5_KHR\",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]=\"COMPRESSED_RGBA_ASTC_6x6_KHR\",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]=\"COMPRESSED_RGBA_ASTC_8x5_KHR\",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]=\"COMPRESSED_RGBA_ASTC_8x6_KHR\",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]=\"COMPRESSED_RGBA_ASTC_8x8_KHR\",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]=\"COMPRESSED_RGBA_ASTC_10x5_KHR\",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]=\"COMPRESSED_RGBA_ASTC_10x6_KHR\",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]=\"COMPRESSED_RGBA_ASTC_10x8_KHR\",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]=\"COMPRESSED_RGBA_ASTC_10x10_KHR\",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]=\"COMPRESSED_RGBA_ASTC_12x10_KHR\",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]=\"COMPRESSED_RGBA_ASTC_12x12_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR\",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]=\"COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR\",t[t.QUERY_COUNTER_BITS_EXT=34916]=\"QUERY_COUNTER_BITS_EXT\",t[t.CURRENT_QUERY_EXT=34917]=\"CURRENT_QUERY_EXT\",t[t.QUERY_RESULT_EXT=34918]=\"QUERY_RESULT_EXT\",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]=\"QUERY_RESULT_AVAILABLE_EXT\",t[t.TIME_ELAPSED_EXT=35007]=\"TIME_ELAPSED_EXT\",t[t.TIMESTAMP_EXT=36392]=\"TIMESTAMP_EXT\",t[t.GPU_DISJOINT_EXT=36795]=\"GPU_DISJOINT_EXT\",t[t.COMPLETION_STATUS_KHR=37297]=\"COMPLETION_STATUS_KHR\",t[t.DEPTH_CLAMP_EXT=34383]=\"DEPTH_CLAMP_EXT\",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]=\"FIRST_VERTEX_CONVENTION_WEBGL\",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]=\"LAST_VERTEX_CONVENTION_WEBGL\",t[t.PROVOKING_VERTEX_WEBL=36431]=\"PROVOKING_VERTEX_WEBL\",t[t.POLYGON_MODE_WEBGL=2880]=\"POLYGON_MODE_WEBGL\",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]=\"POLYGON_OFFSET_LINE_WEBGL\",t[t.LINE_WEBGL=6913]=\"LINE_WEBGL\",t[t.FILL_WEBGL=6914]=\"FILL_WEBGL\",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]=\"MAX_CLIP_DISTANCES_WEBGL\",t[t.MAX_CULL_DISTANCES_WEBGL=33529]=\"MAX_CULL_DISTANCES_WEBGL\",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]=\"MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL\",t[t.CLIP_DISTANCE0_WEBGL=12288]=\"CLIP_DISTANCE0_WEBGL\",t[t.CLIP_DISTANCE1_WEBGL=12289]=\"CLIP_DISTANCE1_WEBGL\",t[t.CLIP_DISTANCE2_WEBGL=12290]=\"CLIP_DISTANCE2_WEBGL\",t[t.CLIP_DISTANCE3_WEBGL=12291]=\"CLIP_DISTANCE3_WEBGL\",t[t.CLIP_DISTANCE4_WEBGL=12292]=\"CLIP_DISTANCE4_WEBGL\",t[t.CLIP_DISTANCE5_WEBGL=12293]=\"CLIP_DISTANCE5_WEBGL\",t[t.CLIP_DISTANCE6_WEBGL=12294]=\"CLIP_DISTANCE6_WEBGL\",t[t.CLIP_DISTANCE7_WEBGL=12295]=\"CLIP_DISTANCE7_WEBGL\",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]=\"POLYGON_OFFSET_CLAMP_EXT\",t[t.LOWER_LEFT_EXT=36001]=\"LOWER_LEFT_EXT\",t[t.UPPER_LEFT_EXT=36002]=\"UPPER_LEFT_EXT\",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]=\"NEGATIVE_ONE_TO_ONE_EXT\",t[t.ZERO_TO_ONE_EXT=37727]=\"ZERO_TO_ONE_EXT\",t[t.CLIP_ORIGIN_EXT=37724]=\"CLIP_ORIGIN_EXT\",t[t.CLIP_DEPTH_MODE_EXT=37725]=\"CLIP_DEPTH_MODE_EXT\",t[t.SRC1_COLOR_WEBGL=35065]=\"SRC1_COLOR_WEBGL\",t[t.SRC1_ALPHA_WEBGL=34185]=\"SRC1_ALPHA_WEBGL\",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]=\"ONE_MINUS_SRC1_COLOR_WEBGL\",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]=\"ONE_MINUS_SRC1_ALPHA_WEBGL\",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]=\"MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL\",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]=\"MIRROR_CLAMP_TO_EDGE_EXT\"})(kA||(kA={}))});var QK=Kt(()=>{qK()});function KK(t=!0){let e=HTMLCanvasElement.prototype;if(!t&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(n,r){if(n===\"webgl\"||n===\"experimental-webgl\"){let i=this.originalGetContext(\"webgl2\",r);return i instanceof HTMLElement&&nbe(i),i}return this.originalGetContext(n,r)}}function nbe(t){t.getExtension(\"EXT_color_buffer_float\");let e={...Jve,WEBGL_disjoint_timer_query:t.getExtension(\"EXT_disjoint_timer_query_webgl2\"),WEBGL_draw_buffers:$ve(t),OES_vertex_array_object:ebe(t),ANGLE_instanced_arrays:tbe(t)},n=t.getExtension;t.getExtension=function(i){let o=n.call(t,i);return o||(i in e?e[i]:null)};let r=t.getSupportedExtensions;t.getSupportedExtensions=function(){return(r.apply(t)||[])?.concat(Object.keys(e))}}var Jve,$ve,ebe,tbe,JK=Kt(()=>{Jve={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},$ve=t=>({drawBuffersWEBGL(e){return t.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),ebe=t=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return t.createVertexArray()},deleteVertexArrayOES(e){return t.deleteVertexArray(e)},isVertexArrayOES(e){return t.isVertexArray(e)},bindVertexArrayOES(e){return t.bindVertexArray(e)}}),tbe=t=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return t.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return t.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return t.vertexAttribDivisor(...e)}})});async function _4(t,e){let n=document.getElementsByTagName(\"head\")[0];if(!n)throw new Error(\"loadScript\");let r=document.createElement(\"script\");return r.setAttribute(\"type\",\"text/javascript\"),r.setAttribute(\"src\",t),e&&(r.id=e),new Promise((i,o)=>{r.onload=i,r.onerror=s=>o(new Error(`Unable to load script '${t}': ${s}`)),n.appendChild(r)})}var ZF=Kt(()=>{});async function eJ(t){if(!globalThis.SPECTOR)try{await _4(t.debugSpectorJSUrl||y4.debugSpectorJSUrl)}catch(e){St.warn(String(e))}}function tJ(t){if(t={...y4,...t},!t.debugSpectorJS)return null;if(!lu&&globalThis.SPECTOR&&!globalThis.luma?.spector){St.probe(rbe,\"SPECTOR found and initialized. Start with `luma.spector.displayUI()`\")();let{Spector:e}=globalThis.SPECTOR;lu=new e,globalThis.luma&&(globalThis.luma.spector=lu)}if(!lu)return null;if($K||($K=!0,lu.spyCanvases(),lu?.onCaptureStarted.add(e=>St.info(\"Spector capture started:\",e)()),lu?.onCapture.add(e=>{St.info(\"Spector capture complete:\",e)(),lu?.getResultUI(),lu?.resultView.display(),lu?.resultView.addCapture(e)})),t.gl){let e=t.gl,n=e.device;lu?.startCapture(t.gl,500),e.device=n,new Promise(r=>setTimeout(r,2e3)).then(r=>{St.info(\"Spector capture stopped after 2 seconds\")(),lu?.stopCapture()})}return lu}var rbe,lu,$K,y4,qF=Kt(()=>{lr();ZF();rbe=1,lu=null,$K=!1,y4={debugSpectorJS:St.get(\"debug-spectorjs\"),debugSpectorJSUrl:\"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js\",gl:void 0}});function rJ(t){return t.luma=t.luma||{},t.luma}async function iJ(){Zl()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await _4(ibe))}function oJ(t,e={}){return e.debugWebGL||e.traceWebGL?sbe(t,e):obe(t)}function obe(t){let e=rJ(t);return e.realContext?e.realContext:t}function sbe(t,e){if(!globalThis.WebGLDebugUtils)return St.warn(\"webgl-debug not loaded\")(),t;let n=rJ(t);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...kA,...t});let r=globalThis.WebGLDebugUtils.makeDebugContext(t,abe.bind(null,e),lbe.bind(null,e));for(let s in kA)!(s in r)&&typeof kA[s]==\"number\"&&(r[s]=kA[s]);class i{}Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,r);let o=Object.create(i);return n.realContext=t,n.debugContext=o,o.debug=!0,o}function nJ(t,e){e=Array.from(e).map(r=>r===void 0?\"undefined\":r);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return n=`${n.slice(0,100)}${n.length>100?\"...\":\"\"}`,`gl.${t}(${n})`}function abe(t,e,n,r){r=Array.from(r).map(c=>c===void 0?\"undefined\":c);let i=globalThis.WebGLDebugUtils.glEnumToString(e),o=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,r),s=`${i} in gl.${n}(${o})`;St.error(s)();debugger}function lbe(t,e,n){let r=\"\";St.level>=1&&(r=nJ(e,n),t.traceWebGL&&St.log(1,r)());for(let i of n)if(i===void 0){r=r||nJ(e,n);debugger}}var ibe,QF=Kt(()=>{lr();QK();yA();ZF();ibe=\"https://unpkg.com/webgl-debug@2.0.1/index.js\"});function KF(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ls(t,e,n){return e[t]!==void 0?e[t]:n[t]}var Sw,Hs,sJ,cu,aJ,Ew,lJ,cJ,JF,id,$F,uJ,ek=Kt(()=>{Sw={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Hs=(t,e,n)=>e?t.enable(n):t.disable(n),sJ=(t,e,n)=>t.hint(n,e),cu=(t,e,n)=>t.pixelStorei(n,e),aJ=(t,e,n)=>{let r=n===36006?36009:36008;return t.bindFramebuffer(r,e)},Ew=(t,e,n)=>{let i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];t.bindBuffer(i,e)};lJ={3042:Hs,32773:(t,e)=>t.blendColor(...e),32777:\"blendEquation\",34877:\"blendEquation\",32969:\"blendFunc\",32968:\"blendFunc\",32971:\"blendFunc\",32970:\"blendFunc\",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Hs,2885:(t,e)=>t.cullFace(e),2929:Hs,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Hs,35723:sJ,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>t.bindTransformFeedback?.(36386,e),34229:(t,e)=>t.bindVertexArray(e),36006:aJ,36010:aJ,34964:Ew,36662:Ew,36663:Ew,35053:Ew,35055:Ew,2886:(t,e)=>t.frontFace(e),33170:sJ,2849:(t,e)=>t.lineWidth(e),32823:Hs,32824:\"polygonOffset\",10752:\"polygonOffset\",35977:Hs,32926:Hs,32928:Hs,32938:\"sampleCoverage\",32939:\"sampleCoverage\",3089:Hs,3088:(t,e)=>t.scissor(...e),2960:Hs,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:\"stencilFuncFront\",2967:\"stencilFuncFront\",2963:\"stencilFuncFront\",34816:\"stencilFuncBack\",36003:\"stencilFuncBack\",36004:\"stencilFuncBack\",2964:\"stencilOpFront\",2965:\"stencilOpFront\",2966:\"stencilOpFront\",34817:\"stencilOpBack\",34818:\"stencilOpBack\",34819:\"stencilOpBack\",2978:(t,e)=>t.viewport(...e),34383:Hs,10754:Hs,12288:Hs,12289:Hs,12290:Hs,12291:Hs,12292:Hs,12293:Hs,12294:Hs,12295:Hs,3333:cu,3317:cu,37440:cu,37441:cu,37443:cu,3330:cu,3332:cu,3331:cu,3314:cu,32878:cu,3316:cu,3315:cu,32877:cu,framebuffer:(t,e)=>{let n=e&&\"handle\"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{let n=typeof e==\"number\"?[e,e]:e;t.blendEquationSeparate(...n)},blendFunc:(t,e)=>{let n=e?.length===2?[...e,...e]:e;t.blendFuncSeparate(...n)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(e[0],e[1]||!1),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=KF(e)?e:[e,e];let[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=KF(e)&&e.length===3?[...e,...e]:e;let[n,r,i,o,s,c]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,o,s,c)},stencilOp:(t,e)=>{e=KF(e)&&e.length===3?[...e,...e]:e;let[n,r,i,o,s,c]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,o,s,c)},viewport:(t,e)=>t.viewport(...e)};cJ={blendEquation:(t,e,n)=>t.blendEquationSeparate(ls(32777,e,n),ls(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(ls(32969,e,n),ls(32968,e,n),ls(32971,e,n),ls(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(ls(32824,e,n),ls(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(ls(32938,e,n),ls(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,ls(2962,e,n),ls(2967,e,n),ls(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,ls(34816,e,n),ls(36003,e,n),ls(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,ls(2964,e,n),ls(2965,e,n),ls(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,ls(34817,e,n),ls(34818,e,n),ls(34819,e,n))},JF={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,n)=>t({36007:n}),bindTransformFeedback:(t,e,n)=>t({36389:n}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},bindBuffer:(t,e,n)=>{let r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return r?t({[r]:n}):{valueChanged:!0}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},id=(t,e)=>t.isEnabled(e),$F={3042:id,2884:id,2929:id,3024:id,32823:id,32926:id,32928:id,3089:id,2960:id,35977:id},uJ=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068])});function nf(t,e){if(cbe(e))return;let n={};for(let i in e){let o=Number(i),s=lJ[i];s&&(typeof s==\"string\"?n[s]=!0:s(t,e[i],o))}let r=t.state&&t.state.cache;if(r)for(let i in n){let o=cJ[i];o(t,e,r)}}function x4(t,e=Sw){if(typeof e==\"number\"){let i=e,o=$F[i];return o?o(t,i):t.getParameter(i)}let n=Array.isArray(e)?e:Object.keys(e),r={};for(let i of n){let o=$F[i];r[i]=o?o(t,Number(i)):t.getParameter(Number(i))}return r}function hJ(t){nf(t,Sw)}function cbe(t){for(let e in t)return!1;return!0}var qy=Kt(()=>{ek()});function dJ(t,e){if(t===e)return!0;if(fJ(t)&&fJ(e)&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}function fJ(t){return Array.isArray(t)||ArrayBuffer.isView(t)}var pJ=Kt(()=>{});function AJ(t,e){let n=t[e].bind(t);t[e]=function(i){if(i===void 0||uJ.has(i))return n(i);let o=rf.get(t);return i in o.cache||(o.cache[i]=n(i)),o.enable?o.cache[i]:n(i)},Object.defineProperty(t[e],\"name\",{value:`${e}-from-cache`,configurable:!1})}function ube(t,e,n){if(!t[e])return;let r=t[e].bind(t);t[e]=function(...o){let s=rf.get(t),{valueChanged:c,oldValue:d}=n(s._updateCache,...o);return c&&r(...o),d},Object.defineProperty(t[e],\"name\",{value:`${e}-to-cache`,configurable:!1})}function hbe(t){let e=t.useProgram.bind(t);t.useProgram=function(r){let i=rf.get(t);i.program!==r&&(e(r),i.program=r)}}var rf,tk=Kt(()=>{qy();pJ();ek();rf=class{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,n){this.gl=e,this.log=n?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){let e=this.stateStack[this.stateStack.length-1];nf(this.gl,e),this.stateStack.pop()}trackState(e,n){if(this.cache=n?.copyState?x4(e):Object.assign({},Sw),this.initialized)throw new Error(\"WebGLStateTracker\");this.initialized=!0,this.gl.state=this,hbe(e);for(let r in JF){let i=JF[r];ube(e,r,i)}AJ(e,\"getParameter\"),AJ(e,\"isEnabled\")}_updateCache(e){let n=!1,r,i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(let o in e){let s=e[o],c=this.cache[o];dJ(s,c)||(n=!0,r=c,i&&!(o in i)&&(i[o]=c),this.cache[o]=s)}return{valueChanged:n,oldValue:r}}}});function gJ(t,e,n){let r=\"\",i={preserveDrawingBuffer:!0,...n},o=null;if(o||=t.getContext(\"webgl2\",i),i.failIfMajorPerformanceCaveat&&(r||=\"Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow.\"),!o&&!n.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,o=t.getContext(\"webgl2\",i),o.luma||={},o.luma.softwareRenderer=!0),o||(o=t.getContext(\"webgl\",{}),o&&(o=null,r||=\"Your browser only supports WebGL1\")),!o)throw r||=\"Your browser does not support WebGL\",new Error(`Failed to create WebGL context: ${r}`);let{onContextLost:s,onContextRestored:c}=e;return t.addEventListener(\"webglcontextlost\",d=>s(d),!1),t.addEventListener(\"webglcontextrestored\",d=>c(d),!1),o.luma||={},o}var mJ=Kt(()=>{});function od(t,e,n){return n[e]===void 0&&(n[e]=t.getExtension(e)||null),n[e]}var Cw=Kt(()=>{});function _J(t,e){let n=t.getParameter(7936),r=t.getParameter(7937);od(t,\"WEBGL_debug_renderer_info\",e);let i=e.WEBGL_debug_renderer_info,o=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),s=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),c=o||n,d=s||r,m=t.getParameter(7938),b=yJ(c,d),C=fbe(c,d),B=dbe(c,d);return{type:\"webgl\",gpu:b,gpuType:B,gpuBackend:C,vendor:c,renderer:d,version:m,shadingLanguage:\"glsl\",shadingLanguageVersion:300}}function yJ(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?\"nvidia\":/INTEL/i.exec(t)||/INTEL/i.exec(e)?\"intel\":/Apple/i.exec(t)||/Apple/i.exec(e)?\"apple\":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?\"amd\":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?\"software\":\"unknown\"}function fbe(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?\"metal\":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?\"opengl\":\"unknown\"}function dbe(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return\"cpu\";switch(yJ(t,e)){case\"intel\":return\"integrated\";case\"software\":return\"cpu\";case\"unknown\":return\"unknown\";default:return\"discrete\"}}var xJ=Kt(()=>{Cw()});function v4(t){switch(t){case\"uint8\":return 5121;case\"sint8\":return 5120;case\"unorm8\":return 5121;case\"snorm8\":return 5120;case\"uint16\":return 5123;case\"sint16\":return 5122;case\"unorm16\":return 5123;case\"snorm16\":return 5122;case\"uint32\":return 5125;case\"sint32\":return 5124;case\"float16\":return 5131;case\"float32\":return 5126}throw new Error(String(t))}var nk=Kt(()=>{});function wJ(t){return t in b4}function TJ(t,e,n){return(b4[e]||[]).every(i=>od(t,i,n))}function EJ(t,e,n){let r=e.create,i=rk[e.format];return i?.gl===void 0&&(r=!1),i?.x&&(r=r&&!!od(t,i.x,n)),{format:e.format,create:r&&e.create,render:r&&e.render,filter:r&&e.filter,blend:r&&e.blend,store:r&&e.store}}function w4(t){let e=rk[t],n=vbe(t),r=Ep.getInfo(t);return r.compressed&&(e.dataFormat=n),{internalFormat:n,format:e?.dataFormat||xbe(r.channels,r.integer,r.normalized,n),type:r.dataType?v4(r.dataType):e?.types?.[0]||5121,compressed:r.compressed||!1}}function SJ(t){switch(Ep.getInfo(t).attachment){case\"depth\":return 36096;case\"stencil\":return 36128;case\"depth-stencil\":return 33306;default:throw new Error(`Not a depth stencil format: ${t}`)}}function xbe(t,e,n,r){if(r===6408||r===6407)return r;switch(t){case\"r\":return e&&!n?36244:6403;case\"rg\":return e&&!n?33320:33319;case\"rgb\":return e&&!n?36248:6407;case\"rgba\":return e&&!n?36249:6408;case\"bgra\":throw new Error(\"bgra pixels not supported by WebGL\");default:return 6408}}function vbe(t){let n=rk[t]?.gl;if(n===void 0)throw new Error(`Unsupported texture format ${t}`);return n}var Mw,Iw,Qy,Ky,pbe,Abe,gbe,mbe,_be,vJ,bJ,ybe,b4,rk,Jy=Kt(()=>{lr();Cw();nk();Mw=\"WEBGL_compressed_texture_s3tc\",Iw=\"WEBGL_compressed_texture_s3tc_srgb\",Qy=\"EXT_texture_compression_rgtc\",Ky=\"EXT_texture_compression_bptc\",pbe=\"WEBGL_compressed_texture_etc\",Abe=\"WEBGL_compressed_texture_astc\",gbe=\"WEBGL_compressed_texture_etc1\",mbe=\"WEBGL_compressed_texture_pvrtc\",_be=\"WEBGL_compressed_texture_atc\",vJ=\"EXT_texture_norm16\",bJ=\"EXT_render_snorm\",ybe=\"EXT_color_buffer_float\",b4={\"float32-renderable-webgl\":[\"EXT_color_buffer_float\"],\"float16-renderable-webgl\":[\"EXT_color_buffer_half_float\"],\"rgb9e5ufloat-renderable-webgl\":[\"WEBGL_render_shared_exponent\"],\"snorm8-renderable-webgl\":[bJ],\"norm16-renderable-webgl\":[vJ],\"snorm16-renderable-webgl\":[vJ,bJ],\"float32-filterable\":[\"OES_texture_float_linear\"],\"float16-filterable-webgl\":[\"OES_texture_half_float_linear\"],\"texture-filterable-anisotropic-webgl\":[\"EXT_texture_filter_anisotropic\"],\"texture-blend-float-webgl\":[\"EXT_float_blend\"],\"texture-compression-bc\":[Mw,Iw,Qy,Ky],\"texture-compression-bc5-webgl\":[Qy],\"texture-compression-bc7-webgl\":[Ky],\"texture-compression-etc2\":[pbe],\"texture-compression-astc\":[Abe],\"texture-compression-etc1-webgl\":[gbe],\"texture-compression-pvrtc-webgl\":[mbe],\"texture-compression-atc-webgl\":[_be]};rk={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},r16unorm:{gl:33322,rb:!0},r16snorm:{gl:36760},\"rgba4unorm-webgl\":{gl:32854,rb:!0},\"rgb565unorm-webgl\":{gl:36194,rb:!0},\"rgb5a1unorm-webgl\":{gl:32855,rb:!0},\"rgb8unorm-webgl\":{gl:32849},\"rgb8snorm-webgl\":{gl:36758},rgba8unorm:{gl:32856},\"rgba8unorm-srgb\":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},\"bgra8unorm-srgb\":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},rg16unorm:{gl:33324},rg16snorm:{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},rgb10a2uint:{gl:36975,rb:!0},\"rgb16unorm-webgl\":{gl:32852},\"rgb16snorm-webgl\":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},rgba16unorm:{gl:32859,rb:!0},rgba16snorm:{gl:36763},\"rgb32float-webgl\":{gl:34837,x:ybe,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},\"depth24plus-stencil8\":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},\"depth32float-stencil8\":{gl:36013,dataFormat:34041,types:[36269],rb:!0},\"bc1-rgb-unorm-webgl\":{gl:33776,x:Mw},\"bc1-rgb-unorm-srgb-webgl\":{gl:35916,x:Iw},\"bc1-rgba-unorm\":{gl:33777,x:Mw},\"bc1-rgba-unorm-srgb\":{gl:35916,x:Iw},\"bc2-rgba-unorm\":{gl:33778,x:Mw},\"bc2-rgba-unorm-srgb\":{gl:35918,x:Iw},\"bc3-rgba-unorm\":{gl:33779,x:Mw},\"bc3-rgba-unorm-srgb\":{gl:35919,x:Iw},\"bc4-r-unorm\":{gl:36283,x:Qy},\"bc4-r-snorm\":{gl:36284,x:Qy},\"bc5-rg-unorm\":{gl:36285,x:Qy},\"bc5-rg-snorm\":{gl:36286,x:Qy},\"bc6h-rgb-ufloat\":{gl:36495,x:Ky},\"bc6h-rgb-float\":{gl:36494,x:Ky},\"bc7-rgba-unorm\":{gl:36492,x:Ky},\"bc7-rgba-unorm-srgb\":{gl:36493,x:Ky},\"etc2-rgb8unorm\":{gl:37492},\"etc2-rgb8unorm-srgb\":{gl:37494},\"etc2-rgb8a1unorm\":{gl:37496},\"etc2-rgb8a1unorm-srgb\":{gl:37497},\"etc2-rgba8unorm\":{gl:37493},\"etc2-rgba8unorm-srgb\":{gl:37495},\"eac-r11unorm\":{gl:37488},\"eac-r11snorm\":{gl:37489},\"eac-rg11unorm\":{gl:37490},\"eac-rg11snorm\":{gl:37491},\"astc-4x4-unorm\":{gl:37808},\"astc-4x4-unorm-srgb\":{gl:37840},\"astc-5x4-unorm\":{gl:37809},\"astc-5x4-unorm-srgb\":{gl:37841},\"astc-5x5-unorm\":{gl:37810},\"astc-5x5-unorm-srgb\":{gl:37842},\"astc-6x5-unorm\":{gl:37811},\"astc-6x5-unorm-srgb\":{gl:37843},\"astc-6x6-unorm\":{gl:37812},\"astc-6x6-unorm-srgb\":{gl:37844},\"astc-8x5-unorm\":{gl:37813},\"astc-8x5-unorm-srgb\":{gl:37845},\"astc-8x6-unorm\":{gl:37814},\"astc-8x6-unorm-srgb\":{gl:37846},\"astc-8x8-unorm\":{gl:37815},\"astc-8x8-unorm-srgb\":{gl:37847},\"astc-10x5-unorm\":{gl:37819},\"astc-10x5-unorm-srgb\":{gl:37851},\"astc-10x6-unorm\":{gl:37817},\"astc-10x6-unorm-srgb\":{gl:37849},\"astc-10x8-unorm\":{gl:37818},\"astc-10x8-unorm-srgb\":{gl:37850},\"astc-10x10-unorm\":{gl:37819},\"astc-10x10-unorm-srgb\":{gl:37851},\"astc-12x10-unorm\":{gl:37820},\"astc-12x10-unorm-srgb\":{gl:37852},\"astc-12x12-unorm\":{gl:37821},\"astc-12x12-unorm-srgb\":{gl:37853},\"pvrtc-rgb4unorm-webgl\":{gl:35840},\"pvrtc-rgba4unorm-webgl\":{gl:35842},\"pvrtc-rbg2unorm-webgl\":{gl:35841},\"pvrtc-rgba2unorm-webgl\":{gl:35843},\"etc1-rbg-unorm-webgl\":{gl:36196},\"atc-rgb-unorm-webgl\":{gl:35986},\"atc-rgba-unorm-webgl\":{gl:35986},\"atc-rgbai-unorm-webgl\":{gl:34798}}});var CJ,T4,MJ=Kt(()=>{lr();Cw();Jy();CJ={\"depth-clip-control\":\"EXT_depth_clamp\",\"timer-query-webgl\":\"EXT_disjoint_timer_query_webgl2\",\"compilation-status-async-webgl\":\"KHR_parallel_shader_compile\",\"polygon-mode-webgl\":\"WEBGL_polygon_mode\",\"provoking-vertex-webgl\":\"WEBGL_provoking_vertex\",\"shader-clip-cull-distance-webgl\":\"WEBGL_clip_cull_distance\",\"shader-noperspective-interpolation-webgl\":\"NV_shader_noperspective_interpolation\",\"shader-conservative-depth-webgl\":\"EXT_conservative_depth\"},T4=class extends vb{gl;extensions;testedFeatures=new Set;constructor(e,n,r){super([],r),this.gl=e,this.extensions=n,od(e,\"EXT_color_buffer_float\",n)}*[Symbol.iterator](){let e=this.getFeatures();for(let n of e)this.has(n)&&(yield n);return[]}has(e){return this.disabledFeatures?.[e]?!1:(this.testedFeatures.has(e)||(this.testedFeatures.add(e),wJ(e)&&TJ(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){let e=this.getFeatures().filter(n=>n!==\"polygon-mode-webgl\");for(let n of e)this.has(n)}getFeatures(){return[...Object.keys(CJ),...Object.keys(b4)]}getWebGLFeature(e){let n=CJ[e];return typeof n==\"string\"?!!od(this.gl,n,this.extensions):!!n}}});var E4,IJ=Kt(()=>{lr();E4=class extends xb{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderVariables(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return this.limits[e]===void 0&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}});function bbe(t){return t<34069?t+34069:t}function wbe(t){switch(t){case 36053:return\"success\";case 36054:return\"Mismatched attachments\";case 36055:return\"No attachments\";case 36057:return\"Height/width mismatch\";case 36061:return\"Unsupported or split attachments\";case 36182:return\"Samples mismatch\";default:return`${t}`}}var sd,S4=Kt(()=>{lr();Jy();sd=class extends Bm{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,n){super(e,n);let r=n.handle===null;this.device=e,this.gl=e.gl,this.handle=this.props.handle||r?this.props.handle:this.gl.createFramebuffer(),r||(e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){let e=this.gl.bindFramebuffer(36160,this.handle);for(let n=0;n<this.colorAttachments.length;++n){let r=this.colorAttachments[n];if(r){let i=36064+n;this._attachTextureView(i,r)}}if(this.depthStencilAttachment){let n=SJ(this.depthStencilAttachment.props.format);this._attachTextureView(n,this.depthStencilAttachment)}if(this.device.props.debug){let n=this.gl.checkFramebufferStatus(36160);if(n!==36053)throw new Error(`Framebuffer ${wbe(n)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,n){let{gl:r}=this.device,{texture:i}=n,o=n.props.baseMipLevel,s=n.props.baseArrayLayer;switch(r.bindTexture(i.glTarget,i.handle),i.glTarget){case 35866:case 32879:r.framebufferTextureLayer(36160,e,i.handle,o,s);break;case 34067:let c=bbe(s);r.framebufferTexture2D(36160,e,c,i.handle,o);break;case 3553:r.framebufferTexture2D(36160,e,3553,i.handle,o);break;default:throw new Error(\"Illegal texture type\")}r.bindTexture(i.glTarget,null)}}});var C4,PJ=Kt(()=>{lr();S4();C4=class extends _y{device;handle=null;_framebuffer=null;get[Symbol.toStringTag](){return\"WebGLCanvasContext\"}constructor(e,n){super(n),this.device=e,this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this._updateDevice()}getCurrentFramebuffer(){return this._framebuffer=this._framebuffer||new sd(this.device,{handle:null}),this._framebuffer}_updateDevice(){}}});function RJ(t=\"id\"){ik[t]=ik[t]||1;let e=ik[t]++;return`${t}-${e}`}var ik,BJ=Kt(()=>{ik={}});function Tbe(t){return t&ei.INDEX?34963:t&ei.VERTEX?34962:t&ei.UNIFORM?35345:34962}function Ebe(t){return t&ei.INDEX||t&ei.VERTEX?35044:t&ei.UNIFORM?35048:35044}var of,M4=Kt(()=>{lr();of=class extends ei{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength=0;bytesUsed=0;constructor(e,n={}){super(e,n),this.device=e,this.gl=this.device.gl;let r=typeof n==\"object\"?n.handle:void 0;this.handle=r||this.gl.createBuffer(),e._setWebGLDebugMetadata(this.handle,this,{spector:{...this.props,data:typeof this.props.data}}),this.glTarget=Tbe(this.props.usage),this.glUsage=Ebe(this.props.usage),this.glIndexType=this.props.indexType===\"uint32\"?5125:5123,n.data?this._initWithData(n.data,n.byteOffset,n.byteLength):this._initWithByteLength(n.byteLength||0)}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}_initWithData(e,n=0,r=e.byteLength+n){let i=this.glTarget;this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.glUsage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.bytesUsed=r,this.byteLength=r,this._setDebugData(e,n,r),this.trackAllocatedMemory(r)}_initWithByteLength(e){let n=e;e===0&&(n=new Float32Array(0));let r=this.glTarget;return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.glUsage),this.gl.bindBuffer(r,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}write(e,n=0){let r=ArrayBuffer.isView(e)?e:new Uint8Array(e),i=0,o=void 0,s=36663;this.gl.bindBuffer(s,this.handle),i!==0||o!==void 0?this.gl.bufferSubData(s,n,r,i,o):this.gl.bufferSubData(s,n,r),this.gl.bindBuffer(s,null),this._setDebugData(e,n,e.byteLength)}async mapAndWriteAsync(e,n=0,r=this.byteLength-n){let i=new ArrayBuffer(r);await e(i,\"copied\"),this.write(i,n)}async readAsync(e=0,n){return this.readSyncWebGL(e,n)}async mapAndReadAsync(e,n=0,r){let i=await this.readAsync(n,r);return await e(i.buffer,\"copied\")}readSyncWebGL(e=0,n){n=n??this.byteLength-e;let r=new Uint8Array(n),i=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,r,i,n),this.gl.bindBuffer(36662,null),this._setDebugData(r,e,n),r}}});function LJ(t){let e=t.split(/\\r?\\n/),n=[];for(let r of e){if(r.length<=1)continue;let i=r.split(\":\");if(i.length===2){let[C,B]=i;n.push({message:B.trim(),type:DJ(C),lineNum:0,linePos:0});continue}let[o,s,c,...d]=i,m=parseInt(c,10);isNaN(m)&&(m=0);let b=parseInt(s,10);isNaN(b)&&(b=0),n.push({message:d.join(\":\").trim(),type:DJ(o),lineNum:m,linePos:b})}return n}function DJ(t){let e=[\"warning\",\"error\",\"info\"],n=t.toLowerCase();return e.includes(n)?n:\"info\"}var OJ=Kt(()=>{});var I4,FJ=Kt(()=>{lr();OJ();I4=class extends Rm{device;handle;constructor(e,n){switch(super(e,n),this.device=e,this.props.stage){case\"vertex\":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case\"fragment\":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0,this.handle.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>(this._getCompilationStatus(),this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){let e=this.device.gl.getShaderInfoLog(this.handle);return e?LJ(e):[]}getTranslatedSource(){return this.device.getExtension(\"WEBGL_debug_shaders\").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith(\"#version \")?e:`#version 300 es\n${e}`;let{gl:n}=this.device;if(n.shaderSource(this.handle,e),n.compileShader(this.handle),!this.device.props.debug){this.compilationStatus=\"pending\";return}if(!this.device.features.has(\"compilation-status-async-webgl\")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus===\"error\")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}St.once(1,\"Shader compilation is asynchronous\")(),await this._waitForCompilationComplete(),St.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){let e=async i=>await new Promise(o=>setTimeout(o,i));if(!this.device.features.has(\"compilation-status-async-webgl\")){await e(10);return}let{gl:r}=this.device;for(;;){if(r.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?\"success\":\"error\"}}});function NJ(t,e,n,r){if(Ibe(e))return r(t);let i=t;i.pushState();try{return Sbe(t,e),nf(i.gl,n),r(t)}finally{i.popState()}}function Sbe(t,e){let n=t,{gl:r}=n;if(e.cullMode)switch(e.cullMode){case\"none\":r.disable(2884);break;case\"front\":r.enable(2884),r.cullFace(1028);break;case\"back\":r.enable(2884),r.cullFace(1029);break}if(e.frontFace&&r.frontFace(Jm(\"frontFace\",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has(\"depth-clip-control\")&&r.enable(34383),e.depthBias!==void 0&&(r.enable(32823),r.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has(\"provoking-vertex-webgl\")){let o=n.getExtension(\"WEBGL_provoking_vertex\").WEBGL_provoking_vertex,s=Jm(\"provokingVertex\",e.provokingVertex,{first:36429,last:36430});o?.provokingVertexWEBGL(s)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has(\"polygon-mode-webgl\")){if(e.polygonMode){let o=n.getExtension(\"WEBGL_polygon_mode\").WEBGL_polygon_mode,s=Jm(\"polygonMode\",e.polygonMode,{fill:6914,line:6913});o?.polygonModeWEBGL(1028,s),o?.polygonModeWEBGL(1029,s)}e.polygonOffsetLine&&r.enable(10754)}if(t.features.has(\"shader-clip-cull-distance-webgl\")&&(e.clipDistance0&&r.enable(12288),e.clipDistance1&&r.enable(12289),e.clipDistance2&&r.enable(12290),e.clipDistance3&&r.enable(12291),e.clipDistance4&&r.enable(12292),e.clipDistance5&&r.enable(12293),e.clipDistance6&&r.enable(12294),e.clipDistance7&&r.enable(12295)),e.depthWriteEnabled!==void 0&&r.depthMask(Mbe(\"depthWriteEnabled\",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!==\"always\"?r.enable(2929):r.disable(2929),r.depthFunc(R4(\"depthCompare\",e.depthCompare))),e.stencilWriteMask){let i=e.stencilWriteMask;r.stencilMaskSeparate(1028,i),r.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&St.warn(\"stencilReadMask not supported under WebGL\"),e.stencilCompare){let i=e.stencilReadMask||4294967295,o=R4(\"depthCompare\",e.stencilCompare);e.stencilCompare!==\"always\"?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,o,0,i),r.stencilFuncSeparate(1029,o,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){let i=ok(\"stencilPassOperation\",e.stencilPassOperation),o=ok(\"stencilFailOperation\",e.stencilFailOperation),s=ok(\"stencilDepthFailOperation\",e.stencilDepthFailOperation);r.stencilOpSeparate(1028,o,s,i),r.stencilOpSeparate(1029,o,s,i)}switch(e.blend){case!0:r.enable(3042);break;case!1:r.disable(3042);break;default:}if(e.blendColorOperation||e.blendAlphaOperation){let i=kJ(\"blendColorOperation\",e.blendColorOperation||\"add\"),o=kJ(\"blendAlphaOperation\",e.blendAlphaOperation||\"add\");r.blendEquationSeparate(i,o);let s=P4(\"blendColorSrcFactor\",e.blendColorSrcFactor||\"one\"),c=P4(\"blendColorDstFactor\",e.blendColorDstFactor||\"zero\"),d=P4(\"blendAlphaSrcFactor\",e.blendAlphaSrcFactor||\"one\"),m=P4(\"blendAlphaDstFactor\",e.blendAlphaDstFactor||\"zero\");r.blendFuncSeparate(s,c,d,m)}}function R4(t,e){return Jm(t,e,{never:512,less:513,equal:514,\"less-equal\":515,greater:516,\"not-equal\":517,\"greater-equal\":518,always:519})}function ok(t,e){return Jm(t,e,{keep:7680,zero:0,replace:7681,invert:5386,\"increment-clamp\":7682,\"decrement-clamp\":7683,\"increment-wrap\":34055,\"decrement-wrap\":34056})}function kJ(t,e){return Jm(t,e,{add:32774,subtract:32778,\"reverse-subtract\":32779,min:32775,max:32776})}function P4(t,e,n=\"color\"){return Jm(t,e,{one:1,zero:0,src:768,\"one-minus-src\":769,dst:774,\"one-minus-dst\":775,\"src-alpha\":770,\"one-minus-src-alpha\":771,\"dst-alpha\":772,\"one-minus-dst-alpha\":773,\"src-alpha-saturated\":776,constant:n===\"color\"?32769:32771,\"one-minus-constant\":n===\"color\"?32770:32772,src1:768,\"one-minus-src1\":769,\"src1-alpha\":770,\"one-minus-src1-alpha\":771})}function Cbe(t,e){return`Illegal parameter ${e} for ${t}`}function Jm(t,e,n){if(!(e in n))throw new Error(Cbe(t,e));return n[e]}function Mbe(t,e){return e}function Ibe(t){let e=!0;for(let n in t){e=!1;break}return e}var sk=Kt(()=>{lr();qy()});function B4(t){let e={};return t.addressModeU&&(e[10242]=ak(t.addressModeU)),t.addressModeV&&(e[10243]=ak(t.addressModeV)),t.addressModeW&&(e[32882]=ak(t.addressModeW)),t.magFilter&&(e[10240]=lk(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=Pbe(t.minFilter||\"linear\",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type===\"comparison-sampler\"&&(e[34892]=34894),t.compare&&(e[34893]=R4(\"compare\",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function ak(t){switch(t){case\"clamp-to-edge\":return 33071;case\"repeat\":return 10497;case\"mirror-repeat\":return 33648}}function lk(t){switch(t){case\"nearest\":return 9728;case\"linear\":return 9729}}function Pbe(t,e=\"none\"){if(!e)return lk(t);switch(e){case\"none\":return lk(t);case\"nearest\":switch(t){case\"nearest\":return 9984;case\"linear\":return 9985}break;case\"linear\":switch(t){case\"nearest\":return 9986;case\"linear\":return 9987}}}var ck=Kt(()=>{sk()});var D4,zJ=Kt(()=>{lr();ck();D4=class extends jh{device;handle;parameters;constructor(e,n){super(e,n),this.device=e,this.parameters=B4(n),this.handle=n.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(let[n,r]of Object.entries(e)){let i=Number(n);switch(i){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,i,r);break;default:this.device.gl.samplerParameteri(this.handle,i,r);break}}}}});function NA(t,e,n){if(Rbe(e))return n(t);let{nocatch:r=!0}=e,i=rf.get(t);i.push(),nf(t,e);let o;if(r)o=n(t),i.pop();else try{o=n(t)}finally{i.pop()}return o}function Rbe(t){for(let e in t)return!1;return!0}var L4=Kt(()=>{qy();tk()});var ad,uk=Kt(()=>{lr();ad=class extends Pm{device;gl;handle;texture;constructor(e,n){super(e,{...jo.defaultProps,...n}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=n.texture}}});function Bbe(t){switch(t){case\"1d\":break;case\"2d\":return 3553;case\"3d\":return 32879;case\"cube\":return 34067;case\"2d-array\":return 35866;case\"cube-array\":break}throw new Error(t)}function UJ(t,e,n){return e===\"cube\"?34069+n:t}var ld,O4=Kt(()=>{lr();Jy();ck();L4();uk();ld=class extends jo{device;gl;handle;sampler=void 0;view;glTarget;glFormat;glType;glInternalFormat;compressed;_textureUnit=0;constructor(e,n){super(e,n),this.device=e,this.gl=this.device.gl;let r=w4(this.props.format);this.glTarget=Bbe(this.props.dimension),this.glInternalFormat=r.internalFormat,this.glFormat=r.format,this.glType=r.type,this.compressed=r.compressed,this.handle=this.props.handle||this.gl.createTexture(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.gl.bindTexture(this.glTarget,this.handle);let{dimension:i,width:o,height:s,depth:c,mipLevels:d,glTarget:m,glInternalFormat:b}=this;switch(i){case\"2d\":case\"cube\":this.gl.texStorage2D(m,d,b,o,s);break;case\"2d-array\":case\"3d\":this.gl.texStorage3D(m,d,b,o,s,c);break;default:throw new Error(i)}this.gl.bindTexture(this.glTarget,null),this._initializeData(n.data),this.setSampler(this.props.sampler),this.view=new ad(this.device,{...this.props,texture:this}),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory(\"Texture\"),this.destroyed=!0)}createView(e){return new ad(this.device,{...e,texture:this})}setSampler(e={}){super.setSampler(e);let n=B4(this.sampler.props);this._setSamplerParameters(n)}copyImageData(e){let n=this._normalizeCopyImageDataOptions(e),r=n.data,{width:i,height:o,depth:s}=this,{mipLevel:c=0,byteOffset:d=0,x:m=0,y:b=0,z:C=0}=n,{glFormat:B,glType:k,compressed:V}=this,q=UJ(this.glTarget,this.dimension,C),K;if(!this.compressed){let{bytesPerPixel:ee}=this.device.getTextureFormatInfo(this.format);if(ee){if(n.bytesPerRow%ee!==0)throw new Error(`bytesPerRow (${n.bytesPerRow}) must be a multiple of bytesPerPixel (${ee}) for ${this.format}`);K=n.bytesPerRow/ee}}let Y=this.compressed?{}:{...K!==void 0?{3314:K}:{},32878:n.rowsPerImage};this.gl.bindTexture(q,this.handle),NA(this.gl,Y,()=>{switch(this.dimension){case\"2d\":case\"cube\":V?this.gl.compressedTexSubImage2D(q,c,m,b,i,o,B,r,d):this.gl.texSubImage2D(q,c,m,b,i,o,B,k,r,d);break;case\"2d-array\":case\"3d\":V?this.gl.compressedTexSubImage3D(q,c,m,b,C,i,o,s,B,r,d):this.gl.texSubImage3D(q,c,m,b,C,i,o,s,B,k,r,d);break;default:}}),this.gl.bindTexture(q,null)}copyExternalImage(e){let n=this._normalizeCopyExternalImageOptions(e);if(n.sourceX||n.sourceY)throw new Error(\"WebGL does not support sourceX/sourceY)\");let{glFormat:r,glType:i}=this,{image:o,depth:s,mipLevel:c,x:d,y:m,z:b,width:C,height:B}=n,k=UJ(this.glTarget,this.dimension,s),V=n.flipY?{37440:!0}:{};return this.gl.bindTexture(this.glTarget,this.handle),NA(this.gl,V,()=>{switch(this.dimension){case\"2d\":case\"cube\":this.gl.texSubImage2D(k,c,d,m,C,B,r,i,o);break;case\"2d-array\":case\"3d\":this.gl.texSubImage3D(k,c,d,m,b,C,B,s,r,i,o);break;default:}}),this.gl.bindTexture(this.glTarget,null),{width:n.width,height:n.height}}generateMipmapsWebGL(e){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(St.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!e?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(r){St.warn(`Error generating mipmap for ${this}: ${r.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}_setSamplerParameters(e){St.log(2,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(let[n,r]of Object.entries(e)){let i=Number(n),o=r;switch(i){case 33082:case 33083:this.gl.texParameterf(this.glTarget,i,o);break;case 10240:case 10241:this.gl.texParameteri(this.glTarget,i,o);break;case 10242:case 10243:case 32882:this.gl.texParameteri(this.glTarget,i,o);break;case 34046:this.device.features.has(\"texture-filterable-anisotropic-webgl\")&&this.gl.texParameteri(this.glTarget,i,o);break;case 34892:case 34893:this.gl.texParameteri(this.glTarget,i,o);break}}this.gl.bindTexture(this.glTarget,null)}_getActiveUnit(){return this.gl.getParameter(34016)-33984}_bind(e){let{gl:n}=this;return e!==void 0&&(this._textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.glTarget,this.handle),e}_unbind(e){let{gl:n}=this;return e!==void 0&&(this._textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.glTarget,null),e}}});function VJ(t){return Lbe[t]}function F4(t){return Dbe[t]}function GJ(t){return!!WJ[t]}function HJ(t){return WJ[t]}var Dbe,WJ,Lbe,hk=Kt(()=>{Dbe={5126:\"f32\",35664:\"vec2<f32>\",35665:\"vec3<f32>\",35666:\"vec4<f32>\",5124:\"i32\",35667:\"vec2<i32>\",35668:\"vec3<i32>\",35669:\"vec4<i32>\",5125:\"u32\",36294:\"vec2<u32>\",36295:\"vec3<u32>\",36296:\"vec4<u32>\",35670:\"f32\",35671:\"vec2<f32>\",35672:\"vec3<f32>\",35673:\"vec4<f32>\",35674:\"mat2x2<f32>\",35685:\"mat2x3<f32>\",35686:\"mat2x4<f32>\",35687:\"mat3x2<f32>\",35675:\"mat3x3<f32>\",35688:\"mat3x4<f32>\",35689:\"mat4x2<f32>\",35690:\"mat4x3<f32>\",35676:\"mat4x4<f32>\"},WJ={35678:{viewDimension:\"2d\",sampleType:\"float\"},35680:{viewDimension:\"cube\",sampleType:\"float\"},35679:{viewDimension:\"3d\",sampleType:\"float\"},35682:{viewDimension:\"3d\",sampleType:\"depth\"},36289:{viewDimension:\"2d-array\",sampleType:\"float\"},36292:{viewDimension:\"2d-array\",sampleType:\"depth\"},36293:{viewDimension:\"cube\",sampleType:\"float\"},36298:{viewDimension:\"2d\",sampleType:\"sint\"},36299:{viewDimension:\"3d\",sampleType:\"sint\"},36300:{viewDimension:\"cube\",sampleType:\"sint\"},36303:{viewDimension:\"2d-array\",sampleType:\"uint\"},36306:{viewDimension:\"2d\",sampleType:\"uint\"},36307:{viewDimension:\"3d\",sampleType:\"uint\"},36308:{viewDimension:\"cube\",sampleType:\"uint\"},36311:{viewDimension:\"2d-array\",sampleType:\"uint\"}},Lbe={uint8:5121,sint8:5120,unorm8:5121,snorm8:5120,uint16:5123,sint16:5122,unorm16:5123,snorm16:5122,uint32:5125,sint32:5124,float16:5131,float32:5126}});function jJ(t,e){let n={attributes:[],bindings:[]};n.attributes=Obe(t,e);let r=Nbe(t,e);for(let c of r){let d=c.uniforms.map(m=>({name:m.name,format:m.format,byteOffset:m.byteOffset,byteStride:m.byteStride,arrayLength:m.arrayLength}));n.bindings.push({type:\"uniform\",name:c.name,group:0,location:c.location,visibility:(c.vertex?1:0)&(c.fragment?2:0),minBindingSize:c.byteLength,uniforms:d})}let i=kbe(t,e),o=0;for(let c of i)if(GJ(c.type)){let{viewDimension:d,sampleType:m}=HJ(c.type);n.bindings.push({type:\"texture\",name:c.name,group:0,location:o,viewDimension:d,sampleType:m}),c.textureUnit=o,o+=1}i.length&&(n.uniforms=i);let s=Fbe(t,e);return s?.length&&(n.varyings=s),n}function Obe(t,e){let n=[],r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){let o=t.getActiveAttrib(e,i);if(!o)throw new Error(\"activeInfo\");let{name:s,type:c}=o,d=t.getAttribLocation(e,s);if(d>=0){let m=F4(c),b=/instance/i.test(s)?\"instance\":\"vertex\";n.push({name:s,location:d,stepMode:b,type:m})}}return n.sort((i,o)=>i.location-o.location),n}function Fbe(t,e){let n=[],r=t.getProgramParameter(e,35971);for(let i=0;i<r;i++){let o=t.getTransformFeedbackVarying(e,i);if(!o)throw new Error(\"activeInfo\");let{name:s,type:c,size:d}=o,m=F4(c),{type:b,components:C}=Sb(m);n.push({location:i,name:s,type:b,size:d*C})}return n.sort((i,o)=>i.location-o.location),n}function kbe(t,e){let n=[],r=t.getProgramParameter(e,35718);for(let i=0;i<r;i++){let o=t.getActiveUniform(e,i);if(!o)throw new Error(\"activeInfo\");let{name:s,size:c,type:d}=o,{name:m,isArray:b}=zbe(s),C=t.getUniformLocation(e,m),B={location:C,name:m,size:c,type:d,isArray:b};if(n.push(B),B.size>1)for(let k=0;k<B.size;k++){let V=`${m}[${k}]`;C=t.getUniformLocation(e,V);let q={...B,name:V,location:C};n.push(q)}}return n}function Nbe(t,e){let n=(o,s)=>t.getActiveUniformBlockParameter(e,o,s),r=[],i=t.getProgramParameter(e,35382);for(let o=0;o<i;o++){let s={name:t.getActiveUniformBlockName(e,o)||\"\",location:n(o,35391),byteLength:n(o,35392),vertex:n(o,35396),fragment:n(o,35398),uniformCount:n(o,35394),uniforms:[]},c=n(o,35395)||[],d=t.getActiveUniforms(e,c,35383),m=t.getActiveUniforms(e,c,35384),b=t.getActiveUniforms(e,c,35387),C=t.getActiveUniforms(e,c,35388);for(let B=0;B<s.uniformCount;++B){let k=t.getActiveUniform(e,c[B]);if(!k)throw new Error(\"activeInfo\");let V=F4(d[B]);s.uniforms.push({name:k.name,format:V,type:d[B],arrayLength:m[B],byteOffset:b[B],byteStride:C[B]})}r.push(s)}return r.sort((o,s)=>o.location-s.location),r}function zbe(t){if(t[t.length-1]!==\"]\")return{name:t,length:1,isArray:!1};let n=/([^[]*)(\\[[0-9]+\\])?/.exec(t);if(!n||n.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:n[1],length:n[2]?1:0,isArray:!!n[2]}}var XJ=Kt(()=>{lr();hk()});function YJ(t,e,n,r){let i=t,o=r;o===!0&&(o=1),o===!1&&(o=0);let s=typeof o==\"number\"?[o]:o;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof r!=\"number\")throw new Error(\"samplers must be set to integers\");return t.uniform1i(e,r);case 5126:return t.uniform1fv(e,s);case 35664:return t.uniform2fv(e,s);case 35665:return t.uniform3fv(e,s);case 35666:return t.uniform4fv(e,s);case 5124:return t.uniform1iv(e,s);case 35667:return t.uniform2iv(e,s);case 35668:return t.uniform3iv(e,s);case 35669:return t.uniform4iv(e,s);case 35670:return t.uniform1iv(e,s);case 35671:return t.uniform2iv(e,s);case 35672:return t.uniform3iv(e,s);case 35673:return t.uniform4iv(e,s);case 5125:return i.uniform1uiv(e,s,1);case 36294:return i.uniform2uiv(e,s,2);case 36295:return i.uniform3uiv(e,s,3);case 36296:return i.uniform4uiv(e,s,4);case 35674:return t.uniformMatrix2fv(e,!1,s);case 35675:return t.uniformMatrix3fv(e,!1,s);case 35676:return t.uniformMatrix4fv(e,!1,s);case 35685:return i.uniformMatrix2x3fv(e,!1,s);case 35686:return i.uniformMatrix2x4fv(e,!1,s);case 35687:return i.uniformMatrix3x2fv(e,!1,s);case 35688:return i.uniformMatrix3x4fv(e,!1,s);case 35689:return i.uniformMatrix4x2fv(e,!1,s);case 35690:return i.uniformMatrix4x3fv(e,!1,s)}throw new Error(\"Illegal uniform\")}var ZJ=Kt(()=>{});function qJ(t){switch(t){case\"point-list\":return 0;case\"line-list\":return 1;case\"line-strip\":return 3;case\"triangle-list\":return 4;case\"triangle-strip\":return 5;default:throw new Error(t)}}function QJ(t){switch(t){case\"point-list\":return 0;case\"line-list\":return 1;case\"line-strip\":return 1;case\"triangle-list\":return 4;case\"triangle-strip\":return 4;default:throw new Error(t)}}var fk=Kt(()=>{});function Ube(t,e){let n={...t,attributes:t.attributes.map(r=>({...r}))};for(let r of e?.attributes||[]){let i=n.attributes.find(o=>o.name===r.name);i?(i.type=r.type||i.type,i.stepMode=r.stepMode||i.stepMode):St.warn(`shader layout attribute ${r.name} not present in shader`)}return n}var KJ,k4,JJ=Kt(()=>{lr();XJ();sk();ZJ();M4();S4();O4();uk();fk();KJ=4,k4=class extends Xh{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};get[Symbol.toStringTag](){return\"WEBGLRenderPipeline\"}constructor(e,n){super(e,n),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:{id:this.props.id}}),this.vs=n.vs,this.fs=n.fs;let{varyings:r,bufferMode:i=35981}=n;r&&r.length>0&&(this.varyings=r,this.device.gl.transformFeedbackVaryings(this.handle,r,i)),this._linkShaders(),St.time(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=jJ(this.device.gl,this.handle),St.timeEnd(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=n.shaderLayout?Ube(this.introspectedLayout,n.shaderLayout):this.introspectedLayout}destroy(){this.handle&&(this.device.gl.useProgram(null),this.device.gl.deleteProgram(this.handle),this.destroyed=!0,this.handle.destroyed=!0,this.handle=null)}setBindings(e,n){for(let[r,i]of Object.entries(e)){let o=this.shaderLayout.bindings.find(s=>s.name===r)||this.shaderLayout.bindings.find(s=>s.name===`${r}Uniforms`);if(!o){let s=this.shaderLayout.bindings.map(c=>`\"${c.name}\"`).join(\", \");n?.disableWarnings||St.warn(`No binding \"${r}\" in render pipeline \"${this.id}\", expected one of ${s}`,i)();continue}switch(i||St.warn(`Unsetting binding \"${r}\" in render pipeline \"${this.id}\"`)(),o.type){case\"uniform\":if(!(i instanceof of)&&!(i.buffer instanceof of))throw new Error(\"buffer value\");break;case\"texture\":if(!(i instanceof ad||i instanceof ld||i instanceof sd))throw new Error(`${this} Bad texture binding for ${r}`);break;case\"sampler\":St.warn(`Ignoring sampler ${r}`)();break;default:throw new Error(o.type)}this.bindings[r]=i}}draw(e){let{renderPass:n,parameters:r=this.props.parameters,topology:i=this.props.topology,vertexArray:o,vertexCount:s,instanceCount:c,isInstanced:d=!1,firstVertex:m=0,transformFeedback:b}=e,C=qJ(i),B=!!o.indexBuffer,k=o.indexBuffer?.glIndexType;if(this.linkStatus!==\"success\")return St.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return St.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),o.bindBeforeRender(n),b&&b.begin(this.props.topology),this._applyBindings(),this._applyUniforms();let V=n;return NJ(this.device,r,V.glParameters,()=>{B&&d?this.device.gl.drawElementsInstanced(C,s||0,k,m,c||0):B?this.device.gl.drawElements(C,s||0,k,m):d?this.device.gl.drawArraysInstanced(C,m,s||0,c||0):this.device.gl.drawArrays(C,m,s||0),b&&b.end()}),o.unbindAfterRender(n),!0}async _linkShaders(){let{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),St.time(KJ,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),St.timeEnd(KJ,`linkProgram for ${this.id}`)(),St.level,!this.device.features.has(\"compilation-status-async-webgl\")){let r=this._getLinkStatus();this._reportLinkStatus(r);return}St.once(1,\"RenderPipeline linking is asynchronous\")(),await this._waitForLinkComplete(),St.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();let n=this._getLinkStatus();this._reportLinkStatus(n)}async _reportLinkStatus(e){switch(e){case\"success\":return;default:let n=e===\"link-error\"?\"Link error\":\"Validation error\";switch(this.vs.compilationStatus){case\"error\":throw this.vs.debugShader(),new Error(`${this} ${n} during compilation of ${this.vs}`);case\"pending\":await this.vs.asyncCompilationStatus,this.vs.debugShader();break;case\"success\":break}switch(this.fs?.compilationStatus){case\"error\":throw this.fs.debugShader(),new Error(`${this} ${n} during compilation of ${this.fs}`);case\"pending\":await this.fs.asyncCompilationStatus,this.fs.debugShader();break;case\"success\":break}let r=this.device.gl.getProgramInfoLog(this.handle);this.device.reportError(new Error(`${n} during ${e}: ${r}`),this)(),this.device.debug()}}_getLinkStatus(){let{gl:e}=this.device;return e.getProgramParameter(this.handle,35714)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,35715)?(this.linkStatus=\"success\",\"success\"):(this.linkStatus=\"error\",\"validation-error\")):(this.linkStatus=\"error\",\"link-error\")}async _waitForLinkComplete(){let e=async i=>await new Promise(o=>setTimeout(o,i));if(!this.device.features.has(\"compilation-status-async-webgl\")){await e(10);return}let{gl:r}=this.device;for(;;){if(r.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(let n of this.shaderLayout.bindings)!this.bindings[n.name]&&!this.bindings[n.name.replace(/Uniforms$/,\"\")]&&(St.warn(`Binding ${n.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if(this.linkStatus!==\"success\")return;let{gl:e}=this.device;e.useProgram(this.handle);let n=0,r=0;for(let i of this.shaderLayout.bindings){let o=this.bindings[i.name]||this.bindings[i.name.replace(/Uniforms$/,\"\")];if(!o)throw new Error(`No value for binding ${i.name} in ${this.id}`);switch(i.type){case\"uniform\":let{name:s}=i,c=e.getUniformBlockIndex(this.handle,s);if(c===4294967295)throw new Error(`Invalid uniform block name ${s}`);e.uniformBlockBinding(this.handle,r,c),o instanceof of?e.bindBufferBase(35345,r,o.handle):e.bindBufferRange(35345,r,o.buffer.handle,o.offset||0,o.size||o.buffer.byteLength-o.offset),r+=1;break;case\"texture\":if(!(o instanceof ad||o instanceof ld||o instanceof sd))throw new Error(\"texture\");let d;if(o instanceof ad)d=o.texture;else if(o instanceof ld)d=o;else if(o instanceof sd&&o.colorAttachments[0]instanceof ad)St.warn(\"Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead\")(),d=o.colorAttachments[0].texture;else throw new Error(\"No texture\");e.activeTexture(33984+n),e.bindTexture(d.glTarget,d.handle),n+=1;break;case\"sampler\":break;case\"storage\":case\"read-only-storage\":throw new Error(`binding type '${i.type}' not supported in WebGL`)}}}_applyUniforms(){for(let e of this.shaderLayout.uniforms||[]){let{name:n,location:r,type:i,textureUnit:o}=e,s=this.uniforms[n]??o;s!==void 0&&YJ(this.device.gl,r,i,s)}}}});function Vbe(t,e){let n=e.sourceBuffer,r=e.destinationBuffer;t.gl.bindBuffer(36662,n.handle),t.gl.bindBuffer(36663,r.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function Gbe(t,e){throw new Error(\"Not implemented\")}function Hbe(t,e){let{sourceTexture:n,mipLevel:r=0,aspect:i=\"all\",width:o=e.sourceTexture.width,height:s=e.sourceTexture.height,depthOrArrayLayers:c=0,origin:d=[0,0],destinationBuffer:m,byteOffset:b=0,bytesPerRow:C,rowsPerImage:B}=e;if(i!==\"all\")throw new Error(\"aspect not supported in WebGL\");if(r!==0||c!==0||C||B)throw new Error(\"not implemented\");let{framebuffer:k,destroyFramebuffer:V}=$J(n),q;try{let K=m,Y=o||k.width,ee=s||k.height,J=w4(k.colorAttachments[0].texture.props.format),se=J.format,xe=J.type;t.gl.bindBuffer(35051,K.handle),q=t.gl.bindFramebuffer(36160,k.handle),t.gl.readPixels(d[0],d[1],Y,ee,se,xe,b)}finally{t.gl.bindBuffer(35051,null),q!==void 0&&t.gl.bindFramebuffer(36160,q),V&&k.destroy()}}function Wbe(t,e){let{sourceTexture:n,destinationMipLevel:r=0,origin:i=[0,0],destinationOrigin:o=[0,0],destinationTexture:s}=e,{width:c=e.destinationTexture.width,height:d=e.destinationTexture.height}=e,{framebuffer:m,destroyFramebuffer:b}=$J(n),[C,B]=i,[k,V,q]=o,K=t.gl.bindFramebuffer(36160,m.handle),Y,ee;if(s instanceof ld)Y=s,c=Number.isFinite(c)?c:Y.width,d=Number.isFinite(d)?d:Y.height,Y._bind(0),ee=Y.glTarget;else throw new Error(\"invalid destination\");switch(ee){case 3553:case 34067:t.gl.copyTexSubImage2D(ee,r,k,V,C,B,c,d);break;case 35866:case 32879:t.gl.copyTexSubImage3D(ee,r,k,V,q,C,B,c,d);break;default:}Y&&Y._unbind(),t.gl.bindFramebuffer(36160,K),b&&m.destroy()}function $J(t){if(t instanceof jo){let{width:e,height:n,id:r}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${r}`,width:e,height:n,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}var N4,e$=Kt(()=>{lr();O4();Jy();N4=class extends Eb{device;handle=null;commands=[];constructor(e){super(e,{}),this.device=e}_executeCommands(e=this.commands){for(let n of e)switch(n.name){case\"copy-buffer-to-buffer\":Vbe(this.device,n.options);break;case\"copy-buffer-to-texture\":Gbe(this.device,n.options);break;case\"copy-texture-to-buffer\":Hbe(this.device,n.options);break;case\"copy-texture-to-texture\":Wbe(this.device,n.options);break;default:throw new Error(n.name)}}}});var jbe,z4,t$=Kt(()=>{lr();L4();qy();jbe=[1,2,4,8],z4=class extends wb{device;handle=null;glParameters={};constructor(e,n){super(e,n),this.device=e;let r;if(!n?.parameters?.viewport)if(n?.framebuffer){let{width:o,height:s}=n.framebuffer;r=[0,0,o,s]}else{let[o,s]=e.getDefaultCanvasContext().getDrawingBufferSize();r=[0,0,o,s]}this.device.pushState(),this.setParameters({viewport:r,...this.props.parameters});let i=this.props.framebuffer;if(this.props.framebuffer&&i?.handle){let o=this.props.framebuffer.colorAttachments.map((s,c)=>36064+c);this.device.gl.drawBuffers(o)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){let n={...this.glParameters};n.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(n.depthMask=!this.props.depthReadOnly),n.stencilMask=this.props.stencilReadOnly?0:1,n[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(n.viewport=e.viewport.slice(0,4),n.depthRange=[e.viewport[4],e.viewport[5]]):n.viewport=e.viewport),e.scissorRect&&(n.scissorTest=!0,n.scissor=e.scissorRect),e.blendConstant&&(n.blendColor=e.blendConstant),e.stencilReference&&(console.warn(\"RenderPassParameters.stencilReference not yet implemented in WebGL\"),n[2967]=e.stencilReference),\"colorMask\"in e&&(n.colorMask=jbe.map(r=>!!(r&e.colorMask))),this.glParameters=n,nf(this.device.gl,n)}beginOcclusionQuery(e){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){let e={...this.glParameters},n=0;this.props.clearColors&&this.props.clearColors.forEach((r,i)=>{r&&this.clearColorBuffer(i,r)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(n|=16384,e.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(n|=256,e.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(n|=1024,e.clearStencil=this.props.clearStencil),n!==0&&NA(this.device.gl,e,()=>{this.device.gl.clear(n)})}clearColorBuffer(e=0,n=[0,0,0,0]){NA(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(n.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,n);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,n);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,n);break;default:throw new Error(\"clearColorBuffer: color must be typed array\")}})}}});var Pw,n$=Kt(()=>{lr();e$();t$();Pw=class extends Tb{device;handle=null;commandBuffer;constructor(e,n){super(e,n),this.device=e,this.commandBuffer=new N4(e)}destroy(){}finish(){return this.commandBuffer}beginRenderPass(e){return new z4(this.device,e)}beginComputePass(e){throw new Error(\"ComputePass not supported in WebGL\")}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:\"copy-buffer-to-buffer\",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:\"copy-buffer-to-texture\",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:\"copy-texture-to-buffer\",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:\"copy-texture-to-texture\",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,n,r){}}});function r$(t){let{target:e,source:n,start:r=0,count:i=1}=t,o=n.length,s=i*o,c=0;for(let d=r;c<o;c++)e[d++]=n[c];for(;c<s;)c<s-c?(e.copyWithin(r+c,r,r+c),c*=2):(e.copyWithin(r+c,r,r+s-c),c=s);return t.target}var i$=Kt(()=>{});function Xbe(t){return Array.isArray(t)?new Float32Array(t):t}function Ybe(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}var U4,o$=Kt(()=>{lr();yA();nk();i$();U4=class t extends Cb{get[Symbol.toStringTag](){return\"VertexArray\"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return PL()===\"Chrome\"}constructor(e,n){super(e,n),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){let n=e;if(n&&n.glTarget!==34963)throw new Error(\"Use .setBuffer()\");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,n?n.handle:null),this.indexBuffer=n,this.device.gl.bindVertexArray(null)}setBuffer(e,n){let r=n;if(r.glTarget===34963)throw new Error(\"Use .setIndexBuffer()\");let{size:i,type:o,stride:s,offset:c,normalized:d,integer:m,divisor:b}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,r.handle),m?this.device.gl.vertexAttribIPointer(e,i,o,s,c):this.device.gl.vertexAttribPointer(e,i,o,d,s,c),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,b||0),this.attributes[e]=r,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,n){this._enable(e,!1),this.attributes[e]=n}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){let n=this.attributes[e];ArrayBuffer.isView(n)&&this.device.setConstantAttributeWebGL(e,n)}}_getAccessor(e){let n=this.attributeInfos[e];if(!n)throw new Error(`Unknown attribute location ${e}`);let r=v4(n.bufferDataType);return{size:n.bufferComponents,type:r,stride:n.byteStride,offset:n.byteOffset,normalized:n.normalized,integer:n.integer,divisor:n.stepMode===\"instance\"?1:0}}_enable(e,n=!0){let i=t.isConstantAttributeZeroSupported(this.device)||e!==0;(n||i)&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),n?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,n){let r=Xbe(n),i=r.byteLength*e,o=r.length*e;if(this.buffer&&i!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${i} !== ${this.buffer.byteLength}.`);let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:i}),s||=!Ybe(r,this.bufferValue),s){let c=ZO(n.constructor,o);r$({target:c,source:r,start:0,count:o}),this.buffer.write(c),this.bufferValue=n}return this.buffer}}});function s$(t){return typeof t==\"number\"?Number.isInteger(t):/^\\d+$/.test(t)}var V4,a$=Kt(()=>{lr();G4();fk();V4=class extends Mb{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,n){super(e,n),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,n.buffers&&this.setBuffers(n.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e=\"point-list\"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(QJ(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(let n in e)this.setBuffer(n,e[n])})}setBuffer(e,n){let r=this._getVaryingIndex(e),{buffer:i,byteLength:o,byteOffset:s}=this._getBufferRange(n);if(r<0){this.unusedBuffers[e]=i,St.warn(`${this.id} unusedBuffers varying buffer ${e}`)();return}this.buffers[r]={buffer:i,byteLength:o,byteOffset:s},this.bindOnUse||this._bindBuffer(r,i,s,o)}getBuffer(e){if(s$(e))return this.buffers[e]||null;let n=this._getVaryingIndex(e);return n>=0?this.buffers[n]:null}bind(e=this.handle){if(typeof e!=\"function\")return this.gl.bindTransformFeedback(36386,e),this;let n;return this._bound?n=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,n=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),n}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof of)return{buffer:e,byteOffset:0,byteLength:e.byteLength};let{buffer:n,byteOffset:r=0,byteLength:i=e.buffer.byteLength}=e;return{buffer:n,byteOffset:r,byteLength:i}}_getVaryingIndex(e){if(s$(e))return Number(e);for(let n of this.layout.varyings||[])if(e===n.name)return n.location;return-1}_bindBuffers(){for(let e in this.buffers){let{buffer:n,byteLength:r,byteOffset:i}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),n,i,r)}}_unbindBuffers(){for(let e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,n,r=0,i){let o=n&&n.handle;!o||i===void 0?this.gl.bindBufferBase(35982,e,o):this.gl.bindBufferRange(35982,e,o,r,i)}}});var H4,l$=Kt(()=>{lr();H4=class extends Ib{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return\"Query\"}constructor(e,n){if(super(e,n),this.device=e,n.count>1)throw new Error(\"WebGL QuerySet can only have one value\");let r=this.device.gl.createQuery();if(!r)throw new Error(\"WebGL query not supported\");this.handle=r,Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;let e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{let o=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i(\"Timed out\"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}}});function dk(t){switch(t){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function c$(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}var u$=Kt(()=>{});function h$(t){return Zbe[t]}var Zbe,f$=Kt(()=>{Zbe={5124:\"sint32\",5125:\"uint32\",5122:\"sint16\",5123:\"uint16\",5120:\"sint8\",5121:\"uint8\",5126:\"float32\",5131:\"float16\",33635:\"uint16\",32819:\"uint16\",32820:\"uint16\",33640:\"uint32\",35899:\"uint32\",35902:\"uint32\",34042:\"uint32\",36269:\"uint32\"}});function d$(t,e){let{sourceX:n=0,sourceY:r=0,sourceAttachment:i=0}=e||{},{target:o=null,sourceWidth:s,sourceHeight:c,sourceDepth:d,sourceFormat:m,sourceType:b}=e||{},{framebuffer:C,deleteFramebuffer:B}=A$(t),{gl:k,handle:V}=C;s||=C.width,c||=C.height;let q=C.colorAttachments[i]?.texture;if(!q)throw new Error(`Invalid framebuffer attachment ${i}`);d=q?.depth||1,m||=q?.glFormat||6408,b||=q?.glType||5121,o=Qbe(o,b,m,s,c,d);let K=Mm(o);b=b||VJ(K);let Y=k.bindFramebuffer(36160,V);return k.readBuffer(36064+i),k.readPixels(n,r,s,c,m,b,o),k.readBuffer(36064),k.bindFramebuffer(36160,Y||null),B&&C.destroy(),o}function p$(t,e){let{target:n,sourceX:r=0,sourceY:i=0,sourceFormat:o=6408,targetByteOffset:s=0}=e||{},{sourceWidth:c,sourceHeight:d,sourceType:m}=e||{},{framebuffer:b,deleteFramebuffer:C}=A$(t);c=c||b.width,d=d||b.height;let B=b;m=m||5121;let k=n;if(!k){let q=dk(o),K=c$(m),Y=s+c*d*q*K;k=B.device.createBuffer({byteLength:Y})}let V=t.device.createCommandEncoder();return V.copyTextureToBuffer({sourceTexture:t,width:c,height:d,origin:[r,i],destinationBuffer:k,byteOffset:s}),V.destroy(),C&&b.destroy(),k}function A$(t){return t instanceof Bm?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:qbe(t),deleteFramebuffer:!0}}function qbe(t,e){let{device:n,width:r,height:i,id:o}=t;return n.createFramebuffer({...e,id:`framebuffer-for-${o}`,width:r,height:i,colorAttachments:[t]})}function Qbe(t,e,n,r,i,o){if(t)return t;e||=5121;let s=h$(e),c=Im(s),d=dk(n);return new c(r*i*d)}var g$=Kt(()=>{lr();hk();u$();f$()});var pk={};Aa(pk,{WebGLDevice:()=>$m});function Kbe(t,e,n){switch(n.length){case 1:t.gl.vertexAttrib1fv(e,n);break;case 2:t.gl.vertexAttrib2fv(e,n);break;case 3:t.gl.vertexAttrib3fv(e,n);break;case 4:t.gl.vertexAttrib4fv(e,n);break;default:}}function Jbe(t,e,n){t.gl.vertexAttribI4iv(e,n)}function $be(t,e,n){t.gl.vertexAttribI4uiv(e,n)}function ewe(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}var $m,W4=Kt(()=>{lr();tk();mJ();xJ();MJ();IJ();PJ();qF();QF();Jy();BJ();M4();FJ();zJ();O4();S4();JJ();n$();o$();a$();l$();g$();qy();L4();Cw();$m=class extends Wh{type=\"webgl\";handle;features;limits;info;canvasContext;preferredColorFormat=\"rgba8unorm\";preferredDepthFormat=\"depth24plus\";commandEncoder;lost;_resolveContextLost;gl;_constants;_extensions={};_polyfilled=!1;spectorJS;get[Symbol.toStringTag](){return\"WebGLDevice\"}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}isVertexFormatSupported(e){switch(e){case\"unorm8x4-bgra\":return!1;default:return!0}}constructor(e){super({...e,id:e.id||RJ(\"webgl-device\")});let n=Wh._getCanvasContextProps(e);if(!n)throw new Error(\"WebGLDevice requires props.createCanvasContext to be set\");let r=n.canvas?.gl?.device;if(r)throw new Error(`WebGL context already attached to device ${r.id}`);this.canvasContext=new C4(this,n),this.lost=new Promise(b=>{this._resolveContextLost=b});let i={...e.webgl};n.alphaMode===\"premultiplied\"&&(i.premultipliedAlpha=!0),e.powerPreference!==void 0&&(i.powerPreference=e.powerPreference);let s=this.props._handle||gJ(this.canvasContext.canvas,{onContextLost:b=>this._resolveContextLost?.({reason:\"destroyed\",message:\"Entered sleep mode, or too many apps or browser tabs are using the GPU.\"}),onContextRestored:b=>console.log(\"WebGL context restored\")},i);if(!s)throw new Error(\"WebGL context creation failed\");if(r=s.device,r){if(e._reuseDevices)return St.log(1,`Not creating a new Device, instead returning a reference to Device ${r.id} already attached to WebGL context`,r)(),r._reused=!0,r;throw new Error(`WebGL context already attached to device ${r.id}`)}this.handle=s,this.gl=s,this.spectorJS=tJ({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=_J(this.gl,this._extensions),this.limits=new E4(this.gl),this.features=new T4(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),new rf(this.gl,{log:(...b)=>St.log(1,...b)()}).trackState(this.gl,{copyState:!1});let d=e.debugWebGL||e.debug,m=e.debugWebGL;d&&(this.gl=oJ(this.gl,{debugWebGL:d,traceWebGL:m}),St.warn(\"WebGL debug mode activated. Performance reduced.\")(),e.debugWebGL&&(St.level=Math.max(St.level,1))),this.commandEncoder=new Pw(this,{id:`${this}-command-encoder`})}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}getTextureByteAlignment(){return 4}createCanvasContext(e){throw new Error(\"WebGL only supports a single canvas\")}createBuffer(e){let n=this._normalizeBufferProps(e);return new of(this,n)}createTexture(e){return new ld(this,e)}createExternalTexture(e){throw new Error(\"createExternalTexture() not implemented\")}createSampler(e){return new D4(this,e)}createShader(e){return new I4(this,e)}createFramebuffer(e){return new sd(this,e)}createVertexArray(e){return new U4(this,e)}createTransformFeedback(e){return new V4(this,e)}createQuerySet(e){return new H4(this,e)}createRenderPipeline(e){return new k4(this,e)}createComputePipeline(e){throw new Error(\"ComputePipeline not supported in WebGL\")}createCommandEncoder(e={}){return new Pw(this,e)}submit(e){e||(e=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:`${this.id}-default-encoder`})),e._executeCommands()}readPixelsToArrayWebGL(e,n){return d$(e,n)}readPixelsToBufferWebGL(e,n){return p$(e,n)}setParametersWebGL(e){nf(this.gl,e)}getParametersWebGL(e){return x4(this.gl,e)}withParametersWebGL(e,n){return NA(this.gl,e,n)}resetWebGL(){St.warn(\"WebGLDevice.resetWebGL is deprecated, use only for debugging\")(),hJ(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return EJ(this.gl,e,this._extensions)}loseDevice(){let e=!1,r=this.getExtension(\"WEBGL_lose_context\").WEBGL_lose_context;return r&&(e=!0,r.loseContext()),this._resolveContextLost?.({reason:\"destroyed\",message:\"Application triggered context loss\"}),e}pushState(){rf.get(this.gl).push()}popState(){rf.get(this.gl).pop()}getGLKey(e,n){let r=Number(e);for(let i in this.gl)if(this.gl[i]===r)return`GL.${i}`;return n?.emptyIfUnknown?\"\":String(e)}getGLKeys(e){let n={emptyIfUnknown:!0};return Object.entries(e).reduce((r,[i,o])=>(r[`${i}:${this.getGLKey(i,n)}`]=`${o}:${this.getGLKey(o,n)}`,r),{})}setConstantAttributeWebGL(e,n){let r=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(r).fill(null);let i=this._constants[e];switch(i&&ewe(i,n)&&St.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=n,n.constructor){case Float32Array:Kbe(this,e,n);break;case Int32Array:Jbe(this,e,n);break;case Uint32Array:$be(this,e,n);break;default:throw new Error(\"constant\")}}getExtension(e){return od(this.gl,e,this._extensions),this._extensions}_setWebGLDebugMetadata(e,n,r){e.luma=n;let i={props:r.spector,id:r.spector.id};e.__SPECTOR_Metadata=i}}});function twe(t){return typeof WebGL2RenderingContext<\"u\"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}var j4,Ak,Rw,m$=Kt(()=>{lr();JK();qF();QF();j4=1,Ak=class extends bb{type=\"webgl\";constructor(){super(),Wh.defaultProps={...Wh.defaultProps,...y4}}enforceWebGL2(e){KK(e)}isSupported(){return typeof WebGL2RenderingContext<\"u\"}isDeviceHandle(e){return typeof WebGL2RenderingContext<\"u\"&&e instanceof WebGL2RenderingContext?!0:(typeof WebGLRenderingContext<\"u\"&&e instanceof WebGLRenderingContext&&St.warn(\"WebGL1 is not supported\",e)(),!1)}async attach(e,n={}){let{WebGLDevice:r}=await Promise.resolve().then(()=>(W4(),pk));if(e instanceof r)return e;if(e?.device instanceof r)return e.device;if(!twe(e))throw new Error(\"Invalid WebGL2RenderingContext\");let i=n.createCanvasContext===!0?{}:n.createCanvasContext;return new r({...n,_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1,...i}})}async create(e={}){let{WebGLDevice:n}=await Promise.resolve().then(()=>(W4(),pk));St.groupCollapsed(j4,\"WebGLDevice created\")();try{let r=[];(e.debugWebGL||e.debug)&&r.push(iJ()),e.debugSpectorJS&&r.push(eJ(e));let i=await Promise.allSettled(r);for(let c of i)c.status===\"rejected\"&&St.error(`Failed to initialize debug libraries ${c.reason}`)();let o=new n(e),s=`${o._reused?\"Reusing\":\"Created\"} device with WebGL2 ${o.props.debug?\"debug \":\"\"}context: ${o.info.vendor}, ${o.info.renderer} for canvas: ${o.canvasContext.id}`;return St.probe(j4,s)(),St.table(j4,o.info)(),o}finally{St.groupEnd(j4)()}}};Rw=new Ak});var G4=Kt(()=>{m$();W4();M4()});var Kee=Fs((Kot,Fk)=>{\"use strict\";Fk.exports=AI;Fk.exports.default=AI;function AI(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,o=Zee(t,0,i,n,!0),s=[];if(!o||o.next===o.prev)return s;var c,d,m,b,C,B,k;if(r&&(o=iTe(t,e,o,n)),t.length>80*n){c=m=t[0],d=b=t[1];for(var V=n;V<i;V+=n)C=t[V],B=t[V+1],C<c&&(c=C),B<d&&(d=B),C>m&&(m=C),B>b&&(b=B);k=Math.max(m-c,b-d),k=k!==0?32767/k:0}return m3(o,s,n,c,d,k,0),s}function Zee(t,e,n,r,i){var o,s;if(i===Ok(t,e,n,r)>0)for(o=e;o<n;o+=r)s=Yee(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=Yee(o,t[o],t[o+1],s);return s&&gI(s,s.next)&&(y3(s),s=s.next),s}function r_(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(gI(n,n.next)||Yo(n.prev,n,n.next)===0)){if(y3(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function m3(t,e,n,r,i,o,s){if(t){!s&&o&&cTe(t,r,i,o);for(var c=t,d,m;t.prev!==t.next;){if(d=t.prev,m=t.next,o?tTe(t,r,i,o):eTe(t)){e.push(d.i/n|0),e.push(t.i/n|0),e.push(m.i/n|0),y3(t),t=m.next,c=m.next;continue}if(t=m,t===c){s?s===1?(t=nTe(r_(t),e,n),m3(t,e,n,r,i,o,2)):s===2&&rTe(t,e,n,r,i,o):m3(r_(t),e,n,r,i,o,1);break}}}}function eTe(t){var e=t.prev,n=t,r=t.next;if(Yo(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,s=r.x,c=e.y,d=n.y,m=r.y,b=i<o?i<s?i:s:o<s?o:s,C=c<d?c<m?c:m:d<m?d:m,B=i>o?i>s?i:s:o>s?o:s,k=c>d?c>m?c:m:d>m?d:m,V=r.next;V!==e;){if(V.x>=b&&V.x<=B&&V.y>=C&&V.y<=k&&o2(i,c,o,d,s,m,V.x,V.y)&&Yo(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function tTe(t,e,n,r){var i=t.prev,o=t,s=t.next;if(Yo(i,o,s)>=0)return!1;for(var c=i.x,d=o.x,m=s.x,b=i.y,C=o.y,B=s.y,k=c<d?c<m?c:m:d<m?d:m,V=b<C?b<B?b:B:C<B?C:B,q=c>d?c>m?c:m:d>m?d:m,K=b>C?b>B?b:B:C>B?C:B,Y=Dk(k,V,e,n,r),ee=Dk(q,K,e,n,r),J=t.prevZ,se=t.nextZ;J&&J.z>=Y&&se&&se.z<=ee;){if(J.x>=k&&J.x<=q&&J.y>=V&&J.y<=K&&J!==i&&J!==s&&o2(c,b,d,C,m,B,J.x,J.y)&&Yo(J.prev,J,J.next)>=0||(J=J.prevZ,se.x>=k&&se.x<=q&&se.y>=V&&se.y<=K&&se!==i&&se!==s&&o2(c,b,d,C,m,B,se.x,se.y)&&Yo(se.prev,se,se.next)>=0))return!1;se=se.nextZ}for(;J&&J.z>=Y;){if(J.x>=k&&J.x<=q&&J.y>=V&&J.y<=K&&J!==i&&J!==s&&o2(c,b,d,C,m,B,J.x,J.y)&&Yo(J.prev,J,J.next)>=0)return!1;J=J.prevZ}for(;se&&se.z<=ee;){if(se.x>=k&&se.x<=q&&se.y>=V&&se.y<=K&&se!==i&&se!==s&&o2(c,b,d,C,m,B,se.x,se.y)&&Yo(se.prev,se,se.next)>=0)return!1;se=se.nextZ}return!0}function nTe(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!gI(i,o)&&qee(i,r,r.next,o)&&_3(i,o)&&_3(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),y3(r),y3(r.next),r=t=o),r=r.next}while(r!==t);return r_(r)}function rTe(t,e,n,r,i,o){var s=t;do{for(var c=s.next.next;c!==s.prev;){if(s.i!==c.i&&fTe(s,c)){var d=Qee(s,c);s=r_(s,s.next),d=r_(d,d.next),m3(s,e,n,r,i,o,0),m3(d,e,n,r,i,o,0);return}c=c.next}s=s.next}while(s!==t)}function iTe(t,e,n,r){var i=[],o,s,c,d,m;for(o=0,s=e.length;o<s;o++)c=e[o]*r,d=o<s-1?e[o+1]*r:t.length,m=Zee(t,c,d,r,!1),m===m.next&&(m.steiner=!0),i.push(hTe(m));for(i.sort(oTe),o=0;o<i.length;o++)n=sTe(i[o],n);return n}function oTe(t,e){return t.x-e.x}function sTe(t,e){var n=aTe(t,e);if(!n)return e;var r=Qee(n,t);return r_(r,r.next),r_(n,n.next)}function aTe(t,e){var n=e,r=t.x,i=t.y,o=-1/0,s;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var c=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(c<=r&&c>o&&(o=c,s=n.x<n.next.x?n:n.next,c===r))return s}n=n.next}while(n!==e);if(!s)return null;var d=s,m=s.x,b=s.y,C=1/0,B;n=s;do r>=n.x&&n.x>=m&&r!==n.x&&o2(i<b?r:o,i,m,b,i<b?o:r,i,n.x,n.y)&&(B=Math.abs(i-n.y)/(r-n.x),_3(n,t)&&(B<C||B===C&&(n.x>s.x||n.x===s.x&&lTe(s,n)))&&(s=n,C=B)),n=n.next;while(n!==d);return s}function lTe(t,e){return Yo(t.prev,t,e.prev)<0&&Yo(e.next,t,t.next)<0}function cTe(t,e,n,r){var i=t;do i.z===0&&(i.z=Dk(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,uTe(i)}function uTe(t){var e,n,r,i,o,s,c,d,m=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,c=0,e=0;e<m&&(c++,r=r.nextZ,!!r);e++);for(d=m;c>0||d>0&&r;)c!==0&&(d===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,c--):(i=r,r=r.nextZ,d--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,m*=2}while(s>1);return t}function Dk(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function hTe(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function o2(t,e,n,r,i,o,s,c){return(i-s)*(e-c)>=(t-s)*(o-c)&&(t-s)*(r-c)>=(n-s)*(e-c)&&(n-s)*(o-c)>=(i-s)*(r-c)}function fTe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!dTe(t,e)&&(_3(t,e)&&_3(e,t)&&pTe(t,e)&&(Yo(t.prev,t,e.prev)||Yo(t,e.prev,e))||gI(t,e)&&Yo(t.prev,t,t.next)>0&&Yo(e.prev,e,e.next)>0)}function Yo(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function gI(t,e){return t.x===e.x&&t.y===e.y}function qee(t,e,n,r){var i=pI(Yo(t,e,n)),o=pI(Yo(t,e,r)),s=pI(Yo(n,r,t)),c=pI(Yo(n,r,e));return!!(i!==o&&s!==c||i===0&&dI(t,n,e)||o===0&&dI(t,r,e)||s===0&&dI(n,t,r)||c===0&&dI(n,e,r))}function dI(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function pI(t){return t>0?1:t<0?-1:0}function dTe(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&qee(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function _3(t,e){return Yo(t.prev,t,t.next)<0?Yo(t,e,t.next)>=0&&Yo(t,t.prev,e)>=0:Yo(t,e,t.prev)<0||Yo(t,t.next,e)<0}function pTe(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function Qee(t,e){var n=new Lk(t.i,t.x,t.y),r=new Lk(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Yee(t,e,n,r){var i=new Lk(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function y3(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Lk(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}AI.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,s=Math.abs(Ok(t,0,o,n));if(i)for(var c=0,d=e.length;c<d;c++){var m=e[c]*n,b=c<d-1?e[c+1]*n:t.length;s-=Math.abs(Ok(t,m,b,n))}var C=0;for(c=0;c<r.length;c+=3){var B=r[c]*n,k=r[c+1]*n,V=r[c+2]*n;C+=Math.abs((t[B]-t[V])*(t[k+1]-t[B+1])-(t[B]-t[k])*(t[V+1]-t[B+1]))}return s===0&&C===0?0:Math.abs((C-s)/s)};function Ok(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}AI.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}});var Hk=Fs((fne,L3)=>{(function(t,e){typeof zV==\"function\"&&typeof L3==\"object\"&&L3&&L3.exports?L3.exports=e():(t.dcodeIO=t.dcodeIO||{}).Long=e()})(fne,function(){\"use strict\";function t(be,ge,Qe){this.low=be|0,this.high=ge|0,this.unsigned=!!Qe}t.prototype.__isLong__,Object.defineProperty(t.prototype,\"__isLong__\",{value:!0,enumerable:!1,configurable:!1});function e(be){return(be&&be.__isLong__)===!0}t.isLong=e;var n={},r={};function i(be,ge){var Qe,Ct,Mt;return ge?(be>>>=0,(Mt=0<=be&&be<256)&&(Ct=r[be],Ct)?Ct:(Qe=s(be,(be|0)<0?-1:0,!0),Mt&&(r[be]=Qe),Qe)):(be|=0,(Mt=-128<=be&&be<128)&&(Ct=n[be],Ct)?Ct:(Qe=s(be,be<0?-1:0,!1),Mt&&(n[be]=Qe),Qe))}t.fromInt=i;function o(be,ge){if(isNaN(be)||!isFinite(be))return ge?Y:K;if(ge){if(be<0)return Y;if(be>=k)return Ee}else{if(be<=-V)return Xe;if(be+1>=V)return xe}return be<0?o(-be,ge).neg():s(be%B|0,be/B|0,ge)}t.fromNumber=o;function s(be,ge,Qe){return new t(be,ge,Qe)}t.fromBits=s;var c=Math.pow;function d(be,ge,Qe){if(be.length===0)throw Error(\"empty string\");if(be===\"NaN\"||be===\"Infinity\"||be===\"+Infinity\"||be===\"-Infinity\")return K;if(typeof ge==\"number\"?(Qe=ge,ge=!1):ge=!!ge,Qe=Qe||10,Qe<2||36<Qe)throw RangeError(\"radix\");var Ct;if((Ct=be.indexOf(\"-\"))>0)throw Error(\"interior hyphen\");if(Ct===0)return d(be.substring(1),ge,Qe).neg();for(var Mt=o(c(Qe,8)),mt=K,jt=0;jt<be.length;jt+=8){var Mn=Math.min(8,be.length-jt),rn=parseInt(be.substring(jt,jt+Mn),Qe);if(Mn<8){var In=o(c(Qe,Mn));mt=mt.mul(In).add(o(rn))}else mt=mt.mul(Mt),mt=mt.add(o(rn))}return mt.unsigned=ge,mt}t.fromString=d;function m(be){return be instanceof t?be:typeof be==\"number\"?o(be):typeof be==\"string\"?d(be):s(be.low,be.high,be.unsigned)}t.fromValue=m;var b=65536,C=1<<24,B=b*b,k=B*B,V=k/2,q=i(C),K=i(0);t.ZERO=K;var Y=i(0,!0);t.UZERO=Y;var ee=i(1);t.ONE=ee;var J=i(1,!0);t.UONE=J;var se=i(-1);t.NEG_ONE=se;var xe=s(-1,2147483647,!1);t.MAX_VALUE=xe;var Ee=s(-1,-1,!0);t.MAX_UNSIGNED_VALUE=Ee;var Xe=s(0,-2147483648,!1);t.MIN_VALUE=Xe;var Ne=t.prototype;return Ne.toInt=function(){return this.unsigned?this.low>>>0:this.low},Ne.toNumber=function(){return this.unsigned?(this.high>>>0)*B+(this.low>>>0):this.high*B+(this.low>>>0)},Ne.toString=function(ge){if(ge=ge||10,ge<2||36<ge)throw RangeError(\"radix\");if(this.isZero())return\"0\";if(this.isNegative())if(this.eq(Xe)){var Qe=o(ge),Ct=this.div(Qe),Mt=Ct.mul(Qe).sub(this);return Ct.toString(ge)+Mt.toInt().toString(ge)}else return\"-\"+this.neg().toString(ge);for(var mt=o(c(ge,6),this.unsigned),jt=this,Mn=\"\";;){var rn=jt.div(mt),In=jt.sub(rn.mul(mt)).toInt()>>>0,On=In.toString(ge);if(jt=rn,jt.isZero())return On+Mn;for(;On.length<6;)On=\"0\"+On;Mn=\"\"+On+Mn}},Ne.getHighBits=function(){return this.high},Ne.getHighBitsUnsigned=function(){return this.high>>>0},Ne.getLowBits=function(){return this.low},Ne.getLowBitsUnsigned=function(){return this.low>>>0},Ne.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Xe)?64:this.neg().getNumBitsAbs();for(var ge=this.high!=0?this.high:this.low,Qe=31;Qe>0&&(ge&1<<Qe)==0;Qe--);return this.high!=0?Qe+33:Qe+1},Ne.isZero=function(){return this.high===0&&this.low===0},Ne.isNegative=function(){return!this.unsigned&&this.high<0},Ne.isPositive=function(){return this.unsigned||this.high>=0},Ne.isOdd=function(){return(this.low&1)===1},Ne.isEven=function(){return(this.low&1)===0},Ne.equals=function(ge){return e(ge)||(ge=m(ge)),this.unsigned!==ge.unsigned&&this.high>>>31===1&&ge.high>>>31===1?!1:this.high===ge.high&&this.low===ge.low},Ne.eq=Ne.equals,Ne.notEquals=function(ge){return!this.eq(ge)},Ne.neq=Ne.notEquals,Ne.lessThan=function(ge){return this.comp(ge)<0},Ne.lt=Ne.lessThan,Ne.lessThanOrEqual=function(ge){return this.comp(ge)<=0},Ne.lte=Ne.lessThanOrEqual,Ne.greaterThan=function(ge){return this.comp(ge)>0},Ne.gt=Ne.greaterThan,Ne.greaterThanOrEqual=function(ge){return this.comp(ge)>=0},Ne.gte=Ne.greaterThanOrEqual,Ne.compare=function(ge){if(e(ge)||(ge=m(ge)),this.eq(ge))return 0;var Qe=this.isNegative(),Ct=ge.isNegative();return Qe&&!Ct?-1:!Qe&&Ct?1:this.unsigned?ge.high>>>0>this.high>>>0||ge.high===this.high&&ge.low>>>0>this.low>>>0?-1:1:this.sub(ge).isNegative()?-1:1},Ne.comp=Ne.compare,Ne.negate=function(){return!this.unsigned&&this.eq(Xe)?Xe:this.not().add(ee)},Ne.neg=Ne.negate,Ne.add=function(ge){e(ge)||(ge=m(ge));var Qe=this.high>>>16,Ct=this.high&65535,Mt=this.low>>>16,mt=this.low&65535,jt=ge.high>>>16,Mn=ge.high&65535,rn=ge.low>>>16,In=ge.low&65535,On=0,Pn=0,_n=0,tr=0;return tr+=mt+In,_n+=tr>>>16,tr&=65535,_n+=Mt+rn,Pn+=_n>>>16,_n&=65535,Pn+=Ct+Mn,On+=Pn>>>16,Pn&=65535,On+=Qe+jt,On&=65535,s(_n<<16|tr,On<<16|Pn,this.unsigned)},Ne.subtract=function(ge){return e(ge)||(ge=m(ge)),this.add(ge.neg())},Ne.sub=Ne.subtract,Ne.multiply=function(ge){if(this.isZero()||(e(ge)||(ge=m(ge)),ge.isZero()))return K;if(this.eq(Xe))return ge.isOdd()?Xe:K;if(ge.eq(Xe))return this.isOdd()?Xe:K;if(this.isNegative())return ge.isNegative()?this.neg().mul(ge.neg()):this.neg().mul(ge).neg();if(ge.isNegative())return this.mul(ge.neg()).neg();if(this.lt(q)&&ge.lt(q))return o(this.toNumber()*ge.toNumber(),this.unsigned);var Qe=this.high>>>16,Ct=this.high&65535,Mt=this.low>>>16,mt=this.low&65535,jt=ge.high>>>16,Mn=ge.high&65535,rn=ge.low>>>16,In=ge.low&65535,On=0,Pn=0,_n=0,tr=0;return tr+=mt*In,_n+=tr>>>16,tr&=65535,_n+=Mt*In,Pn+=_n>>>16,_n&=65535,_n+=mt*rn,Pn+=_n>>>16,_n&=65535,Pn+=Ct*In,On+=Pn>>>16,Pn&=65535,Pn+=Mt*rn,On+=Pn>>>16,Pn&=65535,Pn+=mt*Mn,On+=Pn>>>16,Pn&=65535,On+=Qe*In+Ct*rn+Mt*Mn+mt*jt,On&=65535,s(_n<<16|tr,On<<16|Pn,this.unsigned)},Ne.mul=Ne.multiply,Ne.divide=function(ge){if(e(ge)||(ge=m(ge)),ge.isZero())throw Error(\"division by zero\");if(this.isZero())return this.unsigned?Y:K;var Qe,Ct,Mt;if(this.unsigned){if(ge.unsigned||(ge=ge.toUnsigned()),ge.gt(this))return Y;if(ge.gt(this.shru(1)))return J;Mt=Y}else{if(this.eq(Xe)){if(ge.eq(ee)||ge.eq(se))return Xe;if(ge.eq(Xe))return ee;var mt=this.shr(1);return Qe=mt.div(ge).shl(1),Qe.eq(K)?ge.isNegative()?ee:se:(Ct=this.sub(ge.mul(Qe)),Mt=Qe.add(Ct.div(ge)),Mt)}else if(ge.eq(Xe))return this.unsigned?Y:K;if(this.isNegative())return ge.isNegative()?this.neg().div(ge.neg()):this.neg().div(ge).neg();if(ge.isNegative())return this.div(ge.neg()).neg();Mt=K}for(Ct=this;Ct.gte(ge);){Qe=Math.max(1,Math.floor(Ct.toNumber()/ge.toNumber()));for(var jt=Math.ceil(Math.log(Qe)/Math.LN2),Mn=jt<=48?1:c(2,jt-48),rn=o(Qe),In=rn.mul(ge);In.isNegative()||In.gt(Ct);)Qe-=Mn,rn=o(Qe,this.unsigned),In=rn.mul(ge);rn.isZero()&&(rn=ee),Mt=Mt.add(rn),Ct=Ct.sub(In)}return Mt},Ne.div=Ne.divide,Ne.modulo=function(ge){return e(ge)||(ge=m(ge)),this.sub(this.div(ge).mul(ge))},Ne.mod=Ne.modulo,Ne.not=function(){return s(~this.low,~this.high,this.unsigned)},Ne.and=function(ge){return e(ge)||(ge=m(ge)),s(this.low&ge.low,this.high&ge.high,this.unsigned)},Ne.or=function(ge){return e(ge)||(ge=m(ge)),s(this.low|ge.low,this.high|ge.high,this.unsigned)},Ne.xor=function(ge){return e(ge)||(ge=m(ge)),s(this.low^ge.low,this.high^ge.high,this.unsigned)},Ne.shiftLeft=function(ge){return e(ge)&&(ge=ge.toInt()),(ge&=63)===0?this:ge<32?s(this.low<<ge,this.high<<ge|this.low>>>32-ge,this.unsigned):s(0,this.low<<ge-32,this.unsigned)},Ne.shl=Ne.shiftLeft,Ne.shiftRight=function(ge){return e(ge)&&(ge=ge.toInt()),(ge&=63)===0?this:ge<32?s(this.low>>>ge|this.high<<32-ge,this.high>>ge,this.unsigned):s(this.high>>ge-32,this.high>=0?0:-1,this.unsigned)},Ne.shr=Ne.shiftRight,Ne.shiftRightUnsigned=function(ge){if(e(ge)&&(ge=ge.toInt()),ge&=63,ge===0)return this;var Qe=this.high;if(ge<32){var Ct=this.low;return s(Ct>>>ge|Qe<<32-ge,Qe>>>ge,this.unsigned)}else return ge===32?s(Qe,0,this.unsigned):s(Qe>>>ge-32,0,this.unsigned)},Ne.shru=Ne.shiftRightUnsigned,Ne.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},Ne.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},Ne.toBytes=function(be){return be?this.toBytesLE():this.toBytesBE()},Ne.toBytesLE=function(){var be=this.high,ge=this.low;return[ge&255,ge>>>8&255,ge>>>16&255,ge>>>24&255,be&255,be>>>8&255,be>>>16&255,be>>>24&255]},Ne.toBytesBE=function(){var be=this.high,ge=this.low;return[be>>>24&255,be>>>16&255,be>>>8&255,be&255,ge>>>24&255,ge>>>16&255,ge>>>8&255,ge&255]},t})});var Loe=Fs(Iz=>{Iz.read=function(t,e,n,r,i){var o,s,c=i*8-r-1,d=(1<<c)-1,m=d>>1,b=-7,C=n?i-1:0,B=n?-1:1,k=t[e+C];for(C+=B,o=k&(1<<-b)-1,k>>=-b,b+=c;b>0;o=o*256+t[e+C],C+=B,b-=8);for(s=o&(1<<-b)-1,o>>=-b,b+=r;b>0;s=s*256+t[e+C],C+=B,b-=8);if(o===0)o=1-m;else{if(o===d)return s?NaN:(k?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-m}return(k?-1:1)*s*Math.pow(2,o-r)};Iz.write=function(t,e,n,r,i,o){var s,c,d,m=o*8-i-1,b=(1<<m)-1,C=b>>1,B=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=r?0:o-1,V=r?1:-1,q=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,s=b):(s=Math.floor(Math.log(e)/Math.LN2),e*(d=Math.pow(2,-s))<1&&(s--,d*=2),s+C>=1?e+=B/d:e+=B*Math.pow(2,1-C),e*d>=2&&(s++,d/=2),s+C>=b?(c=0,s=b):s+C>=1?(c=(e*d-1)*Math.pow(2,i),s=s+C):(c=e*Math.pow(2,C-1)*Math.pow(2,i),s=0));i>=8;t[n+k]=c&255,k+=V,c/=256,i-=8);for(s=s<<i|c,m+=i;m>0;t[n+k]=s&255,k+=V,s/=256,m-=8);t[n+k-V]|=q*128}});var Uoe=Fs((n_t,zoe)=>{\"use strict\";zoe.exports=Ii;var XP=Loe();function Ii(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Ii.Varint=0;Ii.Fixed64=1;Ii.Bytes=2;Ii.Fixed32=5;var Pz=65536*65536,Ooe=1/Pz,qPe=12,Noe=typeof TextDecoder>\"u\"?null:new TextDecoder(\"utf-8\");Ii.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=r&7,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=YP(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=koe(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=YP(this.buf,this.pos)+YP(this.buf,this.pos+4)*Pz;return this.pos+=8,t},readSFixed64:function(){var t=YP(this.buf,this.pos)+koe(this.buf,this.pos+4)*Pz;return this.pos+=8,t},readFloat:function(){var t=XP.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=XP.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,n,r;return r=e[this.pos++],n=r&127,r<128||(r=e[this.pos++],n|=(r&127)<<7,r<128)||(r=e[this.pos++],n|=(r&127)<<14,r<128)||(r=e[this.pos++],n|=(r&127)<<21,r<128)?n:(r=e[this.pos],n|=(r&15)<<28,QPe(n,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=qPe&&Noe?uRe(this.buf,e,t):cRe(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Ii.Bytes)return t.push(this.readVarint(e));var n=Kp(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Ii.Bytes)return t.push(this.readSVarint());var e=Kp(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ii.Bytes)return t.push(this.readBoolean());var e=Kp(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ii.Bytes)return t.push(this.readFloat());var e=Kp(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ii.Bytes)return t.push(this.readDouble());var e=Kp(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ii.Bytes)return t.push(this.readFixed32());var e=Kp(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ii.Bytes)return t.push(this.readSFixed32());var e=Kp(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ii.Bytes)return t.push(this.readFixed64());var e=Kp(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ii.Bytes)return t.push(this.readSFixed64());var e=Kp(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===Ii.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ii.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ii.Fixed32)this.pos+=4;else if(e===Ii.Fixed64)this.pos+=8;else throw new Error(\"Unimplemented type: \"+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),F2(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),F2(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),F2(this.buf,t&-1,this.pos),F2(this.buf,Math.floor(t*Ooe),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),F2(this.buf,t&-1,this.pos),F2(this.buf,Math.floor(t*Ooe),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){KPe(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=hRe(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Foe(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),XP.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),XP.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&Foe(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,Ii.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,eRe,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,tRe,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,iRe,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,nRe,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,rRe,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,oRe,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,sRe,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,aRe,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,lRe,e)},writeBytesField:function(t,e){this.writeTag(t,Ii.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ii.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ii.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ii.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ii.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ii.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ii.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ii.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ii.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ii.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};function QPe(t,e,n){var r=n.buf,i,o;if(o=r[n.pos++],i=(o&112)>>4,o<128||(o=r[n.pos++],i|=(o&127)<<3,o<128)||(o=r[n.pos++],i|=(o&127)<<10,o<128)||(o=r[n.pos++],i|=(o&127)<<17,o<128)||(o=r[n.pos++],i|=(o&127)<<24,o<128)||(o=r[n.pos++],i|=(o&1)<<31,o<128))return O2(t,i,e);throw new Error(\"Expected varint not more than 10 bytes\")}function Kp(t){return t.type===Ii.Bytes?t.readVarint()+t.pos:t.pos+1}function O2(t,e,n){return n?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function KPe(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(n=~(-t%4294967296),r=~(-t/4294967296),n^4294967295?n=n+1|0:(n=0,r=r+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error(\"Given varint doesn't fit into 10 bytes\");e.realloc(10),JPe(n,r,e),$Pe(r,e)}function JPe(t,e,n){n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos]=t&127}function $Pe(t,e){var n=(t&7)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function Foe(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function eRe(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function tRe(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function nRe(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function rRe(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function iRe(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function oRe(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function sRe(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function aRe(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function lRe(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function YP(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function F2(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function koe(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function cRe(t,e,n){for(var r=\"\",i=e;i<n;){var o=t[i],s=null,c=o>239?4:o>223?3:o>191?2:1;if(i+c>n)break;var d,m,b;c===1?o<128&&(s=o):c===2?(d=t[i+1],(d&192)===128&&(s=(o&31)<<6|d&63,s<=127&&(s=null))):c===3?(d=t[i+1],m=t[i+2],(d&192)===128&&(m&192)===128&&(s=(o&15)<<12|(d&63)<<6|m&63,(s<=2047||s>=55296&&s<=57343)&&(s=null))):c===4&&(d=t[i+1],m=t[i+2],b=t[i+3],(d&192)===128&&(m&192)===128&&(b&192)===128&&(s=(o&15)<<18|(d&63)<<12|(m&63)<<6|b&63,(s<=65535||s>=1114112)&&(s=null))),s===null?(s=65533,c=1):s>65535&&(s-=65536,r+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),r+=String.fromCharCode(s),i+=c}return r}function uRe(t,e,n){return Noe.decode(t.subarray(e,n))}function hRe(t,e,n){for(var r=0,i,o;r<e.length;r++){if(i=e.charCodeAt(r),i>55295&&i<57344)if(o)if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||r+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):o=i;continue}else o&&(t[n++]=239,t[n++]=191,t[n++]=189,o=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=i&63|128)}return n}});var sse=Fs((fT,JP)=>{(function(t){\"use strict\";var e=\"Compound\",n=\"Identifier\",r=\"MemberExpression\",i=\"Literal\",o=\"ThisExpression\",s=\"CallExpression\",c=\"UnaryExpression\",d=\"BinaryExpression\",m=\"LogicalExpression\",b=\"ConditionalExpression\",C=\"ArrayExpression\",B=46,k=44,V=39,q=34,K=40,Y=41,ee=91,J=93,se=63,xe=59,Ee=58,Xe=function(on,Pt){var Mr=new Error(on+\" at character \"+Pt);throw Mr.index=Pt,Mr.description=on,Mr},Ne=!0,be={\"-\":Ne,\"!\":Ne,\"~\":Ne,\"+\":Ne},ge={\"||\":1,\"&&\":2,\"|\":3,\"^\":4,\"&\":5,\"==\":6,\"!=\":6,\"===\":6,\"!==\":6,\"<\":7,\">\":7,\"<=\":7,\">=\":7,\"<<\":8,\">>\":8,\">>>\":8,\"+\":9,\"-\":9,\"*\":10,\"/\":10,\"%\":10},Qe=function(on){var Pt=0,Mr;for(var Fn in on)(Mr=Fn.length)>Pt&&on.hasOwnProperty(Fn)&&(Pt=Mr);return Pt},Ct=Qe(be),Mt=Qe(ge),mt={true:!0,false:!1,null:null},jt=\"this\",Mn=function(on){return ge[on]||0},rn=function(on,Pt,Mr){var Fn=on===\"||\"||on===\"&&\"?m:d;return{type:Fn,operator:on,left:Pt,right:Mr}},In=function(on){return on>=48&&on<=57},On=function(on){return on===36||on===95||on>=65&&on<=90||on>=97&&on<=122||on>=128&&!ge[String.fromCharCode(on)]},Pn=function(on){return on===36||on===95||on>=65&&on<=90||on>=97&&on<=122||on>=48&&on<=57||on>=128&&!ge[String.fromCharCode(on)]},_n=function(on){for(var Pt=0,Mr=on.charAt,Fn=on.charCodeAt,Br=function($t){return Mr.call(on,$t)},nr=function($t){return Fn.call(on,$t)},lo=on.length,oi=function(){for(var $t=nr(Pt);$t===32||$t===9||$t===10||$t===13;)$t=nr(++Pt)},cs=function(){var $t=Ro(),en,Sn;if(oi(),nr(Pt)===se){if(Pt++,en=cs(),en||Xe(\"Expected expression\",Pt),oi(),nr(Pt)===Ee)return Pt++,Sn=cs(),Sn||Xe(\"Expected expression\",Pt),{type:b,test:$t,consequent:en,alternate:Sn};Xe(\"Expected :\",Pt)}else return $t},yi=function(){oi();for(var $t,en=on.substr(Pt,Mt),Sn=en.length;Sn>0;){if(ge.hasOwnProperty(en)&&(!On(nr(Pt))||Pt+en.length<on.length&&!Pn(nr(Pt+en.length))))return Pt+=Sn,en;en=en.substr(0,--Sn)}return!1},Ro=function(){var $t,en,Sn,Ze,ae,he,pe,ze,He,ot;if(pe=co(),Sn=yi(),!Sn)return pe;for(he={value:Sn,prec:Mn(Sn)},ze=co(),ze||Xe(\"Expected expression after \"+Sn,Pt),ae=[pe,he,ze];(Sn=yi())&&(Ze=Mn(Sn),Ze!==0);){for(he={value:Sn,prec:Ze},ot=Sn;ae.length>2&&Ze<=ae[ae.length-2].prec;)ze=ae.pop(),Sn=ae.pop().value,pe=ae.pop(),en=rn(Sn,pe,ze),ae.push(en);en=co(),en||Xe(\"Expected expression after \"+ot,Pt),ae.push(he,en)}for(He=ae.length-1,en=ae[He];He>1;)en=rn(ae[He-1].value,ae[He-2],en),He-=2;return en},co=function(){var $t,en,Sn;if(oi(),$t=nr(Pt),In($t)||$t===B)return mr();if($t===V||$t===q)return Yr();if($t===ee)return Zr();for(en=on.substr(Pt,Ct),Sn=en.length;Sn>0;){if(be.hasOwnProperty(en)&&(!On(nr(Pt))||Pt+en.length<on.length&&!Pn(nr(Pt+en.length))))return Pt+=Sn,{type:c,operator:en,argument:co(),prefix:!0};en=en.substr(0,--Sn)}return On($t)||$t===K?Hi():!1},mr=function(){for(var $t=\"\",en,Sn;In(nr(Pt));)$t+=Br(Pt++);if(nr(Pt)===B)for($t+=Br(Pt++);In(nr(Pt));)$t+=Br(Pt++);if(en=Br(Pt),en===\"e\"||en===\"E\"){for($t+=Br(Pt++),en=Br(Pt),(en===\"+\"||en===\"-\")&&($t+=Br(Pt++));In(nr(Pt));)$t+=Br(Pt++);In(nr(Pt-1))||Xe(\"Expected exponent (\"+$t+Br(Pt)+\")\",Pt)}return Sn=nr(Pt),On(Sn)?Xe(\"Variable names cannot start with a number (\"+$t+Br(Pt)+\")\",Pt):Sn===B&&Xe(\"Unexpected period\",Pt),{type:i,value:parseFloat($t),raw:$t}},Yr=function(){for(var $t=\"\",en=Br(Pt++),Sn=!1,Ze;Pt<lo;)if(Ze=Br(Pt++),Ze===en){Sn=!0;break}else if(Ze===\"\\\\\")switch(Ze=Br(Pt++),Ze){case\"n\":$t+=`\n`;break;case\"r\":$t+=\"\\r\";break;case\"t\":$t+=\"\t\";break;case\"b\":$t+=\"\\b\";break;case\"f\":$t+=\"\\f\";break;case\"v\":$t+=\"\\v\";break;default:$t+=Ze}else $t+=Ze;return Sn||Xe('Unclosed quote after \"'+$t+'\"',Pt),{type:i,value:$t,raw:en+$t+en}},Xs=function(){var $t=nr(Pt),en=Pt,Sn;for(On($t)?Pt++:Xe(\"Unexpected \"+Br(Pt),Pt);Pt<lo&&($t=nr(Pt),Pn($t));)Pt++;return Sn=on.slice(en,Pt),mt.hasOwnProperty(Sn)?{type:i,value:mt[Sn],raw:Sn}:Sn===jt?{type:o}:{type:n,name:Sn}},Ys=function($t){for(var en,Sn=[],Ze,ae=!1,he=0;Pt<lo;)if(oi(),en=nr(Pt),en===$t){ae=!0,Pt++,$t===Y&&he&&he>=Sn.length&&Xe(\"Unexpected token \"+String.fromCharCode($t),Pt);break}else if(en===k){if(Pt++,he++,he!==Sn.length){if($t===Y)Xe(\"Unexpected token ,\",Pt);else if($t===J)for(var pe=Sn.length;pe<he;pe++)Sn.push(null)}}else Ze=cs(),(!Ze||Ze.type===e)&&Xe(\"Expected comma\",Pt),Sn.push(Ze);return ae||Xe(\"Expected \"+String.fromCharCode($t),Pt),Sn},Hi=function(){var $t,en;for($t=nr(Pt),$t===K?en=us():en=Xs(),oi(),$t=nr(Pt);$t===B||$t===ee||$t===K;)Pt++,$t===B?(oi(),en={type:r,computed:!1,object:en,property:Xs()}):$t===ee?(en={type:r,computed:!0,object:en,property:cs()},oi(),$t=nr(Pt),$t!==J&&Xe(\"Unclosed [\",Pt),Pt++):$t===K&&(en={type:s,arguments:Ys(Y),callee:en}),oi(),$t=nr(Pt);return en},us=function(){Pt++;var $t=cs();if(oi(),nr(Pt)===Y)return Pt++,$t;Xe(\"Unclosed (\",Pt)},Zr=function(){return Pt++,{type:C,elements:Ys(J)}},Oi=[],Fr,eo;Pt<lo;)Fr=nr(Pt),Fr===xe||Fr===k?Pt++:(eo=cs())?Oi.push(eo):Pt<lo&&Xe('Unexpected \"'+Br(Pt)+'\"',Pt);return Oi.length===1?Oi[0]:{type:e,body:Oi}};if(_n.version=\"0.3.5\",_n.toString=function(){return\"JavaScript Expression Parser (JSEP) v\"+_n.version},_n.addUnaryOp=function(on){return Ct=Math.max(on.length,Ct),be[on]=Ne,this},_n.addBinaryOp=function(on,Pt){return Mt=Math.max(on.length,Mt),ge[on]=Pt,this},_n.addLiteral=function(on,Pt){return mt[on]=Pt,this},_n.removeUnaryOp=function(on){return delete be[on],on.length===Ct&&(Ct=Qe(be)),this},_n.removeAllUnaryOps=function(){return be={},Ct=0,this},_n.removeBinaryOp=function(on){return delete ge[on],on.length===Mt&&(Mt=Qe(ge)),this},_n.removeAllBinaryOps=function(){return ge={},Mt=0,this},_n.removeLiteral=function(on){return delete mt[on],this},_n.removeAllLiterals=function(){return mt={},this},typeof fT>\"u\"){var tr=t.jsep;t.jsep=_n,_n.noConflict=function(){return t.jsep===_n&&(t.jsep=tr),_n}}else typeof JP<\"u\"&&JP.exports?fT=JP.exports=_n:fT.parse=_n})(fT)});var Zle=Fs(t5=>{\"use strict\";var ple=Jr(),U5e=Jg();function Dn(t){var e=\"https://react.dev/errors/\"+t;if(1<arguments.length){e+=\"?args[]=\"+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+=\"&args[]=\"+encodeURIComponent(arguments[n])}return\"Minified React error #\"+t+\"; visit \"+e+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var Ale=Symbol.for(\"react.transitional.element\"),gle=Symbol.for(\"react.portal\"),mle=Symbol.for(\"react.fragment\"),_le=Symbol.for(\"react.strict_mode\"),yle=Symbol.for(\"react.profiler\"),xle=Symbol.for(\"react.consumer\"),ZR=Symbol.for(\"react.context\"),b9=Symbol.for(\"react.forward_ref\"),qR=Symbol.for(\"react.suspense\"),w9=Symbol.for(\"react.suspense_list\"),T9=Symbol.for(\"react.memo\"),QR=Symbol.for(\"react.lazy\"),V5e=Symbol.for(\"react.scope\"),vle=Symbol.for(\"react.activity\"),G5e=Symbol.for(\"react.legacy_hidden\"),H5e=Symbol.for(\"react.memo_cache_sentinel\"),W5e=Symbol.for(\"react.view_transition\"),zae=Symbol.iterator;function ble(t){return t===null||typeof t!=\"object\"?null:(t=zae&&t[zae]||t[\"@@iterator\"],typeof t==\"function\"?t:null)}var FR=Array.isArray;function Uae(t,e){var n=t.length&3,r=t.length-n,i=e;for(e=0;e<r;){var o=t.charCodeAt(e)&255|(t.charCodeAt(++e)&255)<<8|(t.charCodeAt(++e)&255)<<16|(t.charCodeAt(++e)&255)<<24;++e,o=3432918353*(o&65535)+((3432918353*(o>>>16)&65535)<<16)&4294967295,o=o<<15|o>>>17,o=461845907*(o&65535)+((461845907*(o>>>16)&65535)<<16)&4294967295,i^=o,i=i<<13|i>>>19,i=5*(i&65535)+((5*(i>>>16)&65535)<<16)&4294967295,i=(i&65535)+27492+(((i>>>16)+58964&65535)<<16)}switch(o=0,n){case 3:o^=(t.charCodeAt(e+2)&255)<<16;case 2:o^=(t.charCodeAt(e+1)&255)<<8;case 1:o^=t.charCodeAt(e)&255,o=3432918353*(o&65535)+((3432918353*(o>>>16)&65535)<<16)&4294967295,o=o<<15|o>>>17,i^=461845907*(o&65535)+((461845907*(o>>>16)&65535)<<16)&4294967295}return i^=t.length,i^=i>>>16,i=2246822507*(i&65535)+((2246822507*(i>>>16)&65535)<<16)&4294967295,i^=i>>>13,i=3266489909*(i&65535)+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^i>>>16)>>>0}var Mc=Object.assign,zo=Object.prototype.hasOwnProperty,j5e=RegExp(\"^[:A-Z_a-z\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD][:A-Z_a-z\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD\\\\-.0-9\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040]*$\"),Vae={},Gae={};function E9(t){return zo.call(Gae,t)?!0:zo.call(Vae,t)?!1:j5e.test(t)?Gae[t]=!0:(Vae[t]=!0,!1)}var X5e=new Set(\"animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp\".split(\" \")),Y5e=new Map([[\"acceptCharset\",\"accept-charset\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"],[\"crossOrigin\",\"crossorigin\"],[\"accentHeight\",\"accent-height\"],[\"alignmentBaseline\",\"alignment-baseline\"],[\"arabicForm\",\"arabic-form\"],[\"baselineShift\",\"baseline-shift\"],[\"capHeight\",\"cap-height\"],[\"clipPath\",\"clip-path\"],[\"clipRule\",\"clip-rule\"],[\"colorInterpolation\",\"color-interpolation\"],[\"colorInterpolationFilters\",\"color-interpolation-filters\"],[\"colorProfile\",\"color-profile\"],[\"colorRendering\",\"color-rendering\"],[\"dominantBaseline\",\"dominant-baseline\"],[\"enableBackground\",\"enable-background\"],[\"fillOpacity\",\"fill-opacity\"],[\"fillRule\",\"fill-rule\"],[\"floodColor\",\"flood-color\"],[\"floodOpacity\",\"flood-opacity\"],[\"fontFamily\",\"font-family\"],[\"fontSize\",\"font-size\"],[\"fontSizeAdjust\",\"font-size-adjust\"],[\"fontStretch\",\"font-stretch\"],[\"fontStyle\",\"font-style\"],[\"fontVariant\",\"font-variant\"],[\"fontWeight\",\"font-weight\"],[\"glyphName\",\"glyph-name\"],[\"glyphOrientationHorizontal\",\"glyph-orientation-horizontal\"],[\"glyphOrientationVertical\",\"glyph-orientation-vertical\"],[\"horizAdvX\",\"horiz-adv-x\"],[\"horizOriginX\",\"horiz-origin-x\"],[\"imageRendering\",\"image-rendering\"],[\"letterSpacing\",\"letter-spacing\"],[\"lightingColor\",\"lighting-color\"],[\"markerEnd\",\"marker-end\"],[\"markerMid\",\"marker-mid\"],[\"markerStart\",\"marker-start\"],[\"overlinePosition\",\"overline-position\"],[\"overlineThickness\",\"overline-thickness\"],[\"paintOrder\",\"paint-order\"],[\"panose-1\",\"panose-1\"],[\"pointerEvents\",\"pointer-events\"],[\"renderingIntent\",\"rendering-intent\"],[\"shapeRendering\",\"shape-rendering\"],[\"stopColor\",\"stop-color\"],[\"stopOpacity\",\"stop-opacity\"],[\"strikethroughPosition\",\"strikethrough-position\"],[\"strikethroughThickness\",\"strikethrough-thickness\"],[\"strokeDasharray\",\"stroke-dasharray\"],[\"strokeDashoffset\",\"stroke-dashoffset\"],[\"strokeLinecap\",\"stroke-linecap\"],[\"strokeLinejoin\",\"stroke-linejoin\"],[\"strokeMiterlimit\",\"stroke-miterlimit\"],[\"strokeOpacity\",\"stroke-opacity\"],[\"strokeWidth\",\"stroke-width\"],[\"textAnchor\",\"text-anchor\"],[\"textDecoration\",\"text-decoration\"],[\"textRendering\",\"text-rendering\"],[\"transformOrigin\",\"transform-origin\"],[\"underlinePosition\",\"underline-position\"],[\"underlineThickness\",\"underline-thickness\"],[\"unicodeBidi\",\"unicode-bidi\"],[\"unicodeRange\",\"unicode-range\"],[\"unitsPerEm\",\"units-per-em\"],[\"vAlphabetic\",\"v-alphabetic\"],[\"vHanging\",\"v-hanging\"],[\"vIdeographic\",\"v-ideographic\"],[\"vMathematical\",\"v-mathematical\"],[\"vectorEffect\",\"vector-effect\"],[\"vertAdvY\",\"vert-adv-y\"],[\"vertOriginX\",\"vert-origin-x\"],[\"vertOriginY\",\"vert-origin-y\"],[\"wordSpacing\",\"word-spacing\"],[\"writingMode\",\"writing-mode\"],[\"xmlnsXlink\",\"xmlns:xlink\"],[\"xHeight\",\"x-height\"]]),Z5e=/[\"'&<>]/;function Hr(t){if(typeof t==\"boolean\"||typeof t==\"number\"||typeof t==\"bigint\")return\"\"+t;t=\"\"+t;var e=Z5e.exec(t);if(e){var n=\"\",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e=\"&quot;\";break;case 38:e=\"&amp;\";break;case 39:e=\"&#x27;\";break;case 60:e=\"&lt;\";break;case 62:e=\"&gt;\";break;default:continue}i!==r&&(n+=t.slice(i,r)),i=r+1,n+=e}t=i!==r?n+t.slice(i,r):n}return t}var q5e=/([A-Z])/g,Q5e=/^ms-/,K5e=/^[\\u0000-\\u001F ]*j[\\r\\n\\t]*a[\\r\\n\\t]*v[\\r\\n\\t]*a[\\r\\n\\t]*s[\\r\\n\\t]*c[\\r\\n\\t]*r[\\r\\n\\t]*i[\\r\\n\\t]*p[\\r\\n\\t]*t[\\r\\n\\t]*:/i;function ET(t){return K5e.test(\"\"+t)?\"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')\":t}var $2=ple.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,wle=U5e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J5e={pending:!1,data:null,method:null,action:null},$p=wle.d;wle.d={f:$p.f,r:$p.r,D:gBe,C:mBe,L:_Be,m:yBe,X:vBe,S:xBe,M:bBe};var ah=[],ix=null,Tle=/(<\\/|<)(s)(cript)/gi;function Ele(t,e,n,r){return\"\"+e+(n===\"s\"?\"\\\\u0073\":\"\\\\u0053\")+r}function $5e(t,e,n,r,i){return{idPrefix:t===void 0?\"\":t,nextFormID:0,streamingFormat:0,bootstrapScriptContent:n,bootstrapScripts:r,bootstrapModules:i,instructions:0,hasBody:!1,hasHtml:!1,unknownResources:{},dnsResources:{},connectResources:{default:{},anonymous:{},credentials:{}},imageResources:{},styleResources:{},scriptResources:{},moduleUnknownResources:{},moduleScriptResources:{}}}function qa(t,e,n,r){return{insertionMode:t,selectedValue:e,tagScope:n,viewTransition:r}}function Hae(t,e,n){var r=t.tagScope&-25;switch(e){case\"noscript\":return qa(2,null,r|1,null);case\"select\":return qa(2,n.value!=null?n.value:n.defaultValue,r,null);case\"svg\":return qa(4,null,r,null);case\"picture\":return qa(2,null,r|2,null);case\"math\":return qa(5,null,r,null);case\"foreignObject\":return qa(2,null,r,null);case\"table\":return qa(6,null,r,null);case\"thead\":case\"tbody\":case\"tfoot\":return qa(7,null,r,null);case\"colgroup\":return qa(9,null,r,null);case\"tr\":return qa(8,null,r,null);case\"head\":if(2>t.insertionMode)return qa(3,null,r,null);break;case\"html\":if(t.insertionMode===0)return qa(1,null,r,null)}return 6<=t.insertionMode||2>t.insertionMode?qa(2,null,r,null):t.tagScope!==r?qa(t.insertionMode,t.selectedValue,r,null):t}function Sle(t){return t===null?null:{update:t.update,enter:\"none\",exit:\"none\",share:t.update,name:t.autoName,autoName:t.autoName,nameIdx:0}}function u9(t,e){return e.tagScope&32&&(t.instructions|=128),qa(e.insertionMode,e.selectedValue,e.tagScope|12,Sle(e.viewTransition))}function IR(t,e){t=Sle(e.viewTransition);var n=e.tagScope|16;return t!==null&&t.share!==\"none\"&&(n|=64),qa(e.insertionMode,e.selectedValue,n,t)}var Wae=new Map;function Cle(t,e){if(typeof e!=\"object\")throw Error(Dn(62));var n=!0,r;for(r in e)if(zo.call(e,r)){var i=e[r];if(i!=null&&typeof i!=\"boolean\"&&i!==\"\"){if(r.indexOf(\"--\")===0){var o=Hr(r);i=Hr((\"\"+i).trim())}else o=Wae.get(r),o===void 0&&(o=Hr(r.replace(q5e,\"-$1\").toLowerCase().replace(Q5e,\"-ms-\")),Wae.set(r,o)),i=typeof i==\"number\"?i===0||X5e.has(r)?\"\"+i:i+\"px\":Hr((\"\"+i).trim());n?(n=!1,t.push(' style=\"',o,\":\",i)):t.push(\";\",o,\":\",i)}}n||t.push('\"')}function h9(t,e,n){n&&typeof n!=\"function\"&&typeof n!=\"symbol\"&&t.push(\" \",e,'=\"\"')}function xl(t,e,n){typeof n!=\"function\"&&typeof n!=\"symbol\"&&typeof n!=\"boolean\"&&t.push(\" \",e,'=\"',Hr(n),'\"')}var Mle=Hr(\"javascript:throw new Error('React form unexpectedly submitted.')\");function i9(t,e){this.push('<input type=\"hidden\"'),Ile(t),xl(this,\"name\",e),xl(this,\"value\",t),this.push(\"/>\")}function Ile(t){if(typeof t!=\"string\")throw Error(Dn(480))}function Ple(t,e){if(typeof e.$$FORM_ACTION==\"function\"){var n=t.nextFormID++;t=t.idPrefix+n;try{var r=e.$$FORM_ACTION(t);if(r){var i=r.data;i?.forEach(Ile)}return r}catch(o){if(typeof o==\"object\"&&o!==null&&typeof o.then==\"function\")throw o}}return null}function jae(t,e,n,r,i,o,s,c){var d=null;if(typeof r==\"function\"){var m=Ple(e,r);m!==null?(c=m.name,r=m.action||\"\",i=m.encType,o=m.method,s=m.target,d=m.data):(t.push(\" \",\"formAction\",'=\"',Mle,'\"'),s=o=i=r=c=null,Rle(e,n))}return c!=null&&Vi(t,\"name\",c),r!=null&&Vi(t,\"formAction\",r),i!=null&&Vi(t,\"formEncType\",i),o!=null&&Vi(t,\"formMethod\",o),s!=null&&Vi(t,\"formTarget\",s),d}function Vi(t,e,n){switch(e){case\"className\":xl(t,\"class\",n);break;case\"tabIndex\":xl(t,\"tabindex\",n);break;case\"dir\":case\"role\":case\"viewBox\":case\"width\":case\"height\":xl(t,e,n);break;case\"style\":Cle(t,n);break;case\"src\":case\"href\":if(n===\"\")break;case\"action\":case\"formAction\":if(n==null||typeof n==\"function\"||typeof n==\"symbol\"||typeof n==\"boolean\")break;n=ET(\"\"+n),t.push(\" \",e,'=\"',Hr(n),'\"');break;case\"defaultValue\":case\"defaultChecked\":case\"innerHTML\":case\"suppressContentEditableWarning\":case\"suppressHydrationWarning\":case\"ref\":break;case\"autoFocus\":case\"multiple\":case\"muted\":h9(t,e.toLowerCase(),n);break;case\"xlinkHref\":if(typeof n==\"function\"||typeof n==\"symbol\"||typeof n==\"boolean\")break;n=ET(\"\"+n),t.push(\" \",\"xlink:href\",'=\"',Hr(n),'\"');break;case\"contentEditable\":case\"spellCheck\":case\"draggable\":case\"value\":case\"autoReverse\":case\"externalResourcesRequired\":case\"focusable\":case\"preserveAlpha\":typeof n!=\"function\"&&typeof n!=\"symbol\"&&t.push(\" \",e,'=\"',Hr(n),'\"');break;case\"inert\":case\"allowFullScreen\":case\"async\":case\"autoPlay\":case\"controls\":case\"default\":case\"defer\":case\"disabled\":case\"disablePictureInPicture\":case\"disableRemotePlayback\":case\"formNoValidate\":case\"hidden\":case\"loop\":case\"noModule\":case\"noValidate\":case\"open\":case\"playsInline\":case\"readOnly\":case\"required\":case\"reversed\":case\"scoped\":case\"seamless\":case\"itemScope\":n&&typeof n!=\"function\"&&typeof n!=\"symbol\"&&t.push(\" \",e,'=\"\"');break;case\"capture\":case\"download\":n===!0?t.push(\" \",e,'=\"\"'):n!==!1&&typeof n!=\"function\"&&typeof n!=\"symbol\"&&t.push(\" \",e,'=\"',Hr(n),'\"');break;case\"cols\":case\"rows\":case\"size\":case\"span\":typeof n!=\"function\"&&typeof n!=\"symbol\"&&!isNaN(n)&&1<=n&&t.push(\" \",e,'=\"',Hr(n),'\"');break;case\"rowSpan\":case\"start\":typeof n==\"function\"||typeof n==\"symbol\"||isNaN(n)||t.push(\" \",e,'=\"',Hr(n),'\"');break;case\"xlinkActuate\":xl(t,\"xlink:actuate\",n);break;case\"xlinkArcrole\":xl(t,\"xlink:arcrole\",n);break;case\"xlinkRole\":xl(t,\"xlink:role\",n);break;case\"xlinkShow\":xl(t,\"xlink:show\",n);break;case\"xlinkTitle\":xl(t,\"xlink:title\",n);break;case\"xlinkType\":xl(t,\"xlink:type\",n);break;case\"xmlBase\":xl(t,\"xml:base\",n);break;case\"xmlLang\":xl(t,\"xml:lang\",n);break;case\"xmlSpace\":xl(t,\"xml:space\",n);break;default:if((!(2<e.length)||e[0]!==\"o\"&&e[0]!==\"O\"||e[1]!==\"n\"&&e[1]!==\"N\")&&(e=Y5e.get(e)||e,E9(e))){switch(typeof n){case\"function\":case\"symbol\":return;case\"boolean\":var r=e.toLowerCase().slice(0,5);if(r!==\"data-\"&&r!==\"aria-\")return}t.push(\" \",e,'=\"',Hr(n),'\"')}}}function hu(t,e,n){if(e!=null){if(n!=null)throw Error(Dn(60));if(typeof e!=\"object\"||!(\"__html\"in e))throw Error(Dn(61));e=e.__html,e!=null&&t.push(\"\"+e)}}function eBe(t){var e=\"\";return ple.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}function Rle(t,e){if((t.instructions&16)===0){t.instructions|=16;var n=e.preamble,r=e.bootstrapChunks;(n.htmlChunks||n.headChunks)&&r.length===0?(r.push(e.startInlineScript),PR(r,t),r.push(\">\",`addEventListener(\"submit\",function(a){if(!a.defaultPrevented){var c=a.target,d=a.submitter,e=c.action,b=d;if(d){var f=d.getAttribute(\"formAction\");null!=f&&(e=f,b=null)}\"javascript:throw new Error('React form unexpectedly submitted.')\"===e&&(a.preventDefault(),b?(a=document.createElement(\"input\"),a.name=b.name,a.value=b.value,b.parentNode.insertBefore(a,b),b=new FormData(c),a.parentNode.removeChild(a)):b=new FormData(c),a=c.ownerDocument||c,(a.$$reactFormReplay=a.$$reactFormReplay||[]).push(c,d,b))}});`,\"<\\/script>\")):r.unshift(e.startInlineScript,\">\",`addEventListener(\"submit\",function(a){if(!a.defaultPrevented){var c=a.target,d=a.submitter,e=c.action,b=d;if(d){var f=d.getAttribute(\"formAction\");null!=f&&(e=f,b=null)}\"javascript:throw new Error('React form unexpectedly submitted.')\"===e&&(a.preventDefault(),b?(a=document.createElement(\"input\"),a.name=b.name,a.value=b.value,b.parentNode.insertBefore(a,b),b=new FormData(c),a.parentNode.removeChild(a)):b=new FormData(c),a=c.ownerDocument||c,(a.$$reactFormReplay=a.$$reactFormReplay||[]).push(c,d,b))}});`,\"<\\/script>\")}}function vl(t,e){t.push(na(\"link\"));for(var n in e)if(zo.call(e,n)){var r=e[n];if(r!=null)switch(n){case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Dn(399,\"link\"));default:Vi(t,n,r)}}return t.push(\"/>\"),null}var Xae=/(<\\/|<)(s)(tyle)/gi;function Yae(t,e,n,r){return\"\"+e+(n===\"s\"?\"\\\\73 \":\"\\\\53 \")+r}function ex(t,e,n){t.push(na(n));for(var r in e)if(zo.call(e,r)){var i=e[r];if(i!=null)switch(r){case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Dn(399,n));default:Vi(t,r,i)}}return t.push(\"/>\"),null}function Zae(t,e){t.push(na(\"title\"));var n=null,r=null,i;for(i in e)if(zo.call(e,i)){var o=e[i];if(o!=null)switch(i){case\"children\":n=o;break;case\"dangerouslySetInnerHTML\":r=o;break;default:Vi(t,i,o)}}return t.push(\">\"),e=Array.isArray(n)?2>n.length?n[0]:null:n,typeof e!=\"function\"&&typeof e!=\"symbol\"&&e!==null&&e!==void 0&&t.push(Hr(\"\"+e)),hu(t,r,n),t.push(b_(\"title\")),null}function kR(t,e){t.push(na(\"script\"));var n=null,r=null,i;for(i in e)if(zo.call(e,i)){var o=e[i];if(o!=null)switch(i){case\"children\":n=o;break;case\"dangerouslySetInnerHTML\":r=o;break;default:Vi(t,i,o)}}return t.push(\">\"),hu(t,r,n),typeof n==\"string\"&&t.push((\"\"+n).replace(Tle,Ele)),t.push(b_(\"script\")),null}function o9(t,e,n){t.push(na(n));var r=n=null,i;for(i in e)if(zo.call(e,i)){var o=e[i];if(o!=null)switch(i){case\"children\":n=o;break;case\"dangerouslySetInnerHTML\":r=o;break;default:Vi(t,i,o)}}return t.push(\">\"),hu(t,r,n),n}function SR(t,e,n){t.push(na(n));var r=n=null,i;for(i in e)if(zo.call(e,i)){var o=e[i];if(o!=null)switch(i){case\"children\":n=o;break;case\"dangerouslySetInnerHTML\":r=o;break;default:Vi(t,i,o)}}return t.push(\">\"),hu(t,r,n),typeof n==\"string\"?(t.push(Hr(n)),null):n}var tBe=/^[a-zA-Z][a-zA-Z:_\\.\\-\\d]*$/,qae=new Map;function na(t){var e=qae.get(t);if(e===void 0){if(!tBe.test(t))throw Error(Dn(65,t));e=\"<\"+t,qae.set(t,e)}return e}function nBe(t,e,n,r,i,o,s,c,d){switch(e){case\"div\":case\"span\":case\"svg\":case\"path\":break;case\"a\":t.push(na(\"a\"));var m=null,b=null,C;for(C in n)if(zo.call(n,C)){var B=n[C];if(B!=null)switch(C){case\"children\":m=B;break;case\"dangerouslySetInnerHTML\":b=B;break;case\"href\":B===\"\"?xl(t,\"href\",\"\"):Vi(t,C,B);break;default:Vi(t,C,B)}}if(t.push(\">\"),hu(t,b,m),typeof m==\"string\"){t.push(Hr(m));var k=null}else k=m;return k;case\"g\":case\"p\":case\"li\":break;case\"select\":t.push(na(\"select\"));var V=null,q=null,K;for(K in n)if(zo.call(n,K)){var Y=n[K];if(Y!=null)switch(K){case\"children\":V=Y;break;case\"dangerouslySetInnerHTML\":q=Y;break;case\"defaultValue\":case\"value\":break;default:Vi(t,K,Y)}}return t.push(\">\"),hu(t,q,V),V;case\"option\":var ee=c.selectedValue;t.push(na(\"option\"));var J=null,se=null,xe=null,Ee=null,Xe;for(Xe in n)if(zo.call(n,Xe)){var Ne=n[Xe];if(Ne!=null)switch(Xe){case\"children\":J=Ne;break;case\"selected\":xe=Ne;break;case\"dangerouslySetInnerHTML\":Ee=Ne;break;case\"value\":se=Ne;default:Vi(t,Xe,Ne)}}if(ee!=null){var be=se!==null?\"\"+se:eBe(J);if(FR(ee)){for(var ge=0;ge<ee.length;ge++)if(\"\"+ee[ge]===be){t.push(' selected=\"\"');break}}else\"\"+ee===be&&t.push(' selected=\"\"')}else xe&&t.push(' selected=\"\"');return t.push(\">\"),hu(t,Ee,J),J;case\"textarea\":t.push(na(\"textarea\"));var Qe=null,Ct=null,Mt=null,mt;for(mt in n)if(zo.call(n,mt)){var jt=n[mt];if(jt!=null)switch(mt){case\"children\":Mt=jt;break;case\"value\":Qe=jt;break;case\"defaultValue\":Ct=jt;break;case\"dangerouslySetInnerHTML\":throw Error(Dn(91));default:Vi(t,mt,jt)}}if(Qe===null&&Ct!==null&&(Qe=Ct),t.push(\">\"),Mt!=null){if(Qe!=null)throw Error(Dn(92));if(FR(Mt)){if(1<Mt.length)throw Error(Dn(93));Qe=\"\"+Mt[0]}Qe=\"\"+Mt}return typeof Qe==\"string\"&&Qe[0]===`\n`&&t.push(`\n`),Qe!==null&&t.push(Hr(\"\"+Qe)),null;case\"input\":t.push(na(\"input\"));var Mn=null,rn=null,In=null,On=null,Pn=null,_n=null,tr=null,on=null,Pt=null,Mr;for(Mr in n)if(zo.call(n,Mr)){var Fn=n[Mr];if(Fn!=null)switch(Mr){case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Dn(399,\"input\"));case\"name\":Mn=Fn;break;case\"formAction\":rn=Fn;break;case\"formEncType\":In=Fn;break;case\"formMethod\":On=Fn;break;case\"formTarget\":Pn=Fn;break;case\"defaultChecked\":Pt=Fn;break;case\"defaultValue\":tr=Fn;break;case\"checked\":on=Fn;break;case\"value\":_n=Fn;break;default:Vi(t,Mr,Fn)}}var Br=jae(t,r,i,rn,In,On,Pn,Mn);return on!==null?h9(t,\"checked\",on):Pt!==null&&h9(t,\"checked\",Pt),_n!==null?Vi(t,\"value\",_n):tr!==null&&Vi(t,\"value\",tr),t.push(\"/>\"),Br?.forEach(i9,t),null;case\"button\":t.push(na(\"button\"));var nr=null,lo=null,oi=null,cs=null,yi=null,Ro=null,co=null,mr;for(mr in n)if(zo.call(n,mr)){var Yr=n[mr];if(Yr!=null)switch(mr){case\"children\":nr=Yr;break;case\"dangerouslySetInnerHTML\":lo=Yr;break;case\"name\":oi=Yr;break;case\"formAction\":cs=Yr;break;case\"formEncType\":yi=Yr;break;case\"formMethod\":Ro=Yr;break;case\"formTarget\":co=Yr;break;default:Vi(t,mr,Yr)}}var Xs=jae(t,r,i,cs,yi,Ro,co,oi);if(t.push(\">\"),Xs?.forEach(i9,t),hu(t,lo,nr),typeof nr==\"string\"){t.push(Hr(nr));var Ys=null}else Ys=nr;return Ys;case\"form\":t.push(na(\"form\"));var Hi=null,us=null,Zr=null,Oi=null,Fr=null,eo=null,$t;for($t in n)if(zo.call(n,$t)){var en=n[$t];if(en!=null)switch($t){case\"children\":Hi=en;break;case\"dangerouslySetInnerHTML\":us=en;break;case\"action\":Zr=en;break;case\"encType\":Oi=en;break;case\"method\":Fr=en;break;case\"target\":eo=en;break;default:Vi(t,$t,en)}}var Sn=null,Ze=null;if(typeof Zr==\"function\"){var ae=Ple(r,Zr);ae!==null?(Zr=ae.action||\"\",Oi=ae.encType,Fr=ae.method,eo=ae.target,Sn=ae.data,Ze=ae.name):(t.push(\" \",\"action\",'=\"',Mle,'\"'),eo=Fr=Oi=Zr=null,Rle(r,i))}if(Zr!=null&&Vi(t,\"action\",Zr),Oi!=null&&Vi(t,\"encType\",Oi),Fr!=null&&Vi(t,\"method\",Fr),eo!=null&&Vi(t,\"target\",eo),t.push(\">\"),Ze!==null&&(t.push('<input type=\"hidden\"'),xl(t,\"name\",Ze),t.push(\"/>\"),Sn?.forEach(i9,t)),hu(t,us,Hi),typeof Hi==\"string\"){t.push(Hr(Hi));var he=null}else he=Hi;return he;case\"menuitem\":t.push(na(\"menuitem\"));for(var pe in n)if(zo.call(n,pe)){var ze=n[pe];if(ze!=null)switch(pe){case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Dn(400));default:Vi(t,pe,ze)}}return t.push(\">\"),null;case\"object\":t.push(na(\"object\"));var He=null,ot=null,tt;for(tt in n)if(zo.call(n,tt)){var Je=n[tt];if(Je!=null)switch(tt){case\"children\":He=Je;break;case\"dangerouslySetInnerHTML\":ot=Je;break;case\"data\":var nt=ET(\"\"+Je);if(nt===\"\")break;t.push(\" \",\"data\",'=\"',Hr(nt),'\"');break;default:Vi(t,tt,Je)}}if(t.push(\">\"),hu(t,ot,He),typeof He==\"string\"){t.push(Hr(He));var Dt=null}else Dt=He;return Dt;case\"title\":var vt=c.tagScope&1,Vt=c.tagScope&4;if(c.insertionMode===4||vt||n.itemProp!=null)var Ke=Zae(t,n);else Vt?Ke=null:(Zae(i.hoistableChunks,n),Ke=void 0);return Ke;case\"link\":var zn=c.tagScope&1,Wr=c.tagScope&4,fn=n.rel,ln=n.href,Nn=n.precedence;if(c.insertionMode===4||zn||n.itemProp!=null||typeof fn!=\"string\"||typeof ln!=\"string\"||ln===\"\"){vl(t,n);var Ir=null}else if(n.rel===\"stylesheet\")if(typeof Nn!=\"string\"||n.disabled!=null||n.onLoad||n.onError)Ir=vl(t,n);else{var Et=i.styles.get(Nn),di=r.styleResources.hasOwnProperty(ln)?r.styleResources[ln]:void 0;if(di!==null){r.styleResources[ln]=null,Et||(Et={precedence:Hr(Nn),rules:[],hrefs:[],sheets:new Map},i.styles.set(Nn,Et));var pi={state:0,props:Mc({},n,{\"data-precedence\":n.precedence,precedence:null})};if(di){di.length===2&&ST(pi.props,di);var ti=i.preloads.stylesheets.get(ln);ti&&0<ti.length?ti.length=0:pi.state=1}Et.sheets.set(ln,pi),s&&s.stylesheets.add(pi)}else if(Et){var Wi=Et.sheets.get(ln);Wi&&s&&s.stylesheets.add(Wi)}d&&t.push(\"<!-- -->\"),Ir=null}else n.onLoad||n.onError?Ir=vl(t,n):(d&&t.push(\"<!-- -->\"),Ir=Wr?null:vl(i.hoistableChunks,n));return Ir;case\"script\":var Lt=c.tagScope&1,Ai=n.async;if(typeof n.src!=\"string\"||!n.src||!Ai||typeof Ai==\"function\"||typeof Ai==\"symbol\"||n.onLoad||n.onError||c.insertionMode===4||Lt||n.itemProp!=null)var Vo=kR(t,n);else{var Es=n.src;if(n.type===\"module\")var qr=r.moduleScriptResources,Yt=i.preloads.moduleScripts;else qr=r.scriptResources,Yt=i.preloads.scripts;var kn=qr.hasOwnProperty(Es)?qr[Es]:void 0;if(kn!==null){qr[Es]=null;var Hn=n;if(kn){kn.length===2&&(Hn=Mc({},n),ST(Hn,kn));var Qo=Yt.get(Es);Qo&&(Qo.length=0)}var Pc=[];i.scripts.add(Pc),kR(Pc,Hn)}d&&t.push(\"<!-- -->\"),Vo=null}return Vo;case\"style\":var $a=c.tagScope&1,Un=n.precedence,Ko=n.href,mu=n.nonce;if(c.insertionMode===4||$a||n.itemProp!=null||typeof Un!=\"string\"||typeof Ko!=\"string\"||Ko===\"\"){t.push(na(\"style\"));var hs=null,Ml=null,Ss;for(Ss in n)if(zo.call(n,Ss)){var Zs=n[Ss];if(Zs!=null)switch(Ss){case\"children\":hs=Zs;break;case\"dangerouslySetInnerHTML\":Ml=Zs;break;default:Vi(t,Ss,Zs)}}t.push(\">\");var Cs=Array.isArray(hs)?2>hs.length?hs[0]:null:hs;typeof Cs!=\"function\"&&typeof Cs!=\"symbol\"&&Cs!==null&&Cs!==void 0&&t.push((\"\"+Cs).replace(Xae,Yae)),hu(t,Ml,hs),t.push(b_(\"style\"));var Bo=null}else{var rr=i.styles.get(Un);if((r.styleResources.hasOwnProperty(Ko)?r.styleResources[Ko]:void 0)!==null){r.styleResources[Ko]=null,rr||(rr={precedence:Hr(Un),rules:[],hrefs:[],sheets:new Map},i.styles.set(Un,rr));var Rc=i.nonce.style;if(!Rc||Rc===mu){rr.hrefs.push(Hr(Ko));var Il=rr.rules,Jo=null,el=null,Do;for(Do in n)if(zo.call(n,Do)){var Bc=n[Do];if(Bc!=null)switch(Do){case\"children\":Jo=Bc;break;case\"dangerouslySetInnerHTML\":el=Bc}}var $o=Array.isArray(Jo)?2>Jo.length?Jo[0]:null:Jo;typeof $o!=\"function\"&&typeof $o!=\"symbol\"&&$o!==null&&$o!==void 0&&Il.push((\"\"+$o).replace(Xae,Yae)),hu(Il,el,Jo)}}rr&&s&&s.styles.add(rr),d&&t.push(\"<!-- -->\"),Bo=void 0}return Bo;case\"meta\":var ph=c.tagScope&1,xi=c.tagScope&4;if(c.insertionMode===4||ph||n.itemProp!=null)var Ah=ex(t,n,\"meta\");else d&&t.push(\"<!-- -->\"),Ah=xi?null:typeof n.charSet==\"string\"?ex(i.charsetChunks,n,\"meta\"):n.name===\"viewport\"?ex(i.viewportChunks,n,\"meta\"):ex(i.hoistableChunks,n,\"meta\");return Ah;case\"listing\":case\"pre\":t.push(na(e));var Ia=null,Ms=null,Pa;for(Pa in n)if(zo.call(n,Pa)){var Pl=n[Pa];if(Pl!=null)switch(Pa){case\"children\":Ia=Pl;break;case\"dangerouslySetInnerHTML\":Ms=Pl;break;default:Vi(t,Pa,Pl)}}if(t.push(\">\"),Ms!=null){if(Ia!=null)throw Error(Dn(60));if(typeof Ms!=\"object\"||!(\"__html\"in Ms))throw Error(Dn(61));var fs=Ms.__html;fs!=null&&(typeof fs==\"string\"&&0<fs.length&&fs[0]===`\n`?t.push(`\n`,fs):t.push(\"\"+fs))}return typeof Ia==\"string\"&&Ia[0]===`\n`&&t.push(`\n`),Ia;case\"img\":var gh=c.tagScope&3,wr=n.src,_r=n.srcSet;if(!(n.loading===\"lazy\"||!wr&&!_r||typeof wr!=\"string\"&&wr!=null||typeof _r!=\"string\"&&_r!=null||n.fetchPriority===\"low\"||gh)&&(typeof wr!=\"string\"||wr[4]!==\":\"||wr[0]!==\"d\"&&wr[0]!==\"D\"||wr[1]!==\"a\"&&wr[1]!==\"A\"||wr[2]!==\"t\"&&wr[2]!==\"T\"||wr[3]!==\"a\"&&wr[3]!==\"A\")&&(typeof _r!=\"string\"||_r[4]!==\":\"||_r[0]!==\"d\"&&_r[0]!==\"D\"||_r[1]!==\"a\"&&_r[1]!==\"A\"||_r[2]!==\"t\"&&_r[2]!==\"T\"||_r[3]!==\"a\"&&_r[3]!==\"A\")){s!==null&&c.tagScope&64&&(s.suspenseyImages=!0);var _u=typeof n.sizes==\"string\"?n.sizes:void 0,Is=_r?_r+`\n`+(_u||\"\"):wr,yu=i.preloads.images,Lo=yu.get(Is);if(Lo)(n.fetchPriority===\"high\"||10>i.highImagePreloads.size)&&(yu.delete(Is),i.highImagePreloads.add(Lo));else if(!r.imageResources.hasOwnProperty(Is)){r.imageResources[Is]=ah;var Rl=n.crossOrigin,mh=typeof Rl==\"string\"?Rl===\"use-credentials\"?Rl:\"\":void 0,xo=i.headers,oc;xo&&0<xo.remainingCapacity&&typeof n.srcSet!=\"string\"&&(n.fetchPriority===\"high\"||500>xo.highImagePreloads.length)&&(oc=zR(wr,\"image\",{imageSrcSet:n.srcSet,imageSizes:n.sizes,crossOrigin:mh,integrity:n.integrity,nonce:n.nonce,type:n.type,fetchPriority:n.fetchPriority,referrerPolicy:n.refererPolicy}),0<=(xo.remainingCapacity-=oc.length+2))?(i.resets.image[Is]=ah,xo.highImagePreloads&&(xo.highImagePreloads+=\", \"),xo.highImagePreloads+=oc):(Lo=[],vl(Lo,{rel:\"preload\",as:\"image\",href:_r?void 0:wr,imageSrcSet:_r,imageSizes:_u,crossOrigin:mh,integrity:n.integrity,type:n.type,fetchPriority:n.fetchPriority,referrerPolicy:n.referrerPolicy}),n.fetchPriority===\"high\"||10>i.highImagePreloads.size?i.highImagePreloads.add(Lo):(i.bulkPreloads.add(Lo),yu.set(Is,Lo)))}}return ex(t,n,\"img\");case\"base\":case\"area\":case\"br\":case\"col\":case\"embed\":case\"hr\":case\"keygen\":case\"param\":case\"source\":case\"track\":case\"wbr\":return ex(t,n,e);case\"annotation-xml\":case\"color-profile\":case\"font-face\":case\"font-face-src\":case\"font-face-uri\":case\"font-face-format\":case\"font-face-name\":case\"missing-glyph\":break;case\"head\":if(2>c.insertionMode){var tl=o||i.preamble;if(tl.headChunks)throw Error(Dn(545,\"`<head>`\"));o!==null&&t.push(\"<!--head-->\"),tl.headChunks=[];var Ra=o9(tl.headChunks,n,\"head\")}else Ra=SR(t,n,\"head\");return Ra;case\"body\":if(2>c.insertionMode){var Ba=o||i.preamble;if(Ba.bodyChunks)throw Error(Dn(545,\"`<body>`\"));o!==null&&t.push(\"<!--body-->\"),Ba.bodyChunks=[];var Zn=o9(Ba.bodyChunks,n,\"body\")}else Zn=SR(t,n,\"body\");return Zn;case\"html\":if(c.insertionMode===0){var sc=o||i.preamble;if(sc.htmlChunks)throw Error(Dn(545,\"`<html>`\"));o!==null&&t.push(\"<!--html-->\"),sc.htmlChunks=[\"\"];var df=o9(sc.htmlChunks,n,\"html\")}else df=SR(t,n,\"html\");return df;default:if(e.indexOf(\"-\")!==-1){t.push(na(e));var ac=null,Go=null,si;for(si in n)if(zo.call(n,si)){var Kn=n[si];if(Kn!=null){var Bn=si;switch(si){case\"children\":ac=Kn;break;case\"dangerouslySetInnerHTML\":Go=Kn;break;case\"style\":Cle(t,Kn);break;case\"suppressContentEditableWarning\":case\"suppressHydrationWarning\":case\"ref\":break;case\"className\":Bn=\"class\";default:if(E9(si)&&typeof Kn!=\"function\"&&typeof Kn!=\"symbol\"&&Kn!==!1){if(Kn===!0)Kn=\"\";else if(typeof Kn==\"object\")continue;t.push(\" \",Bn,'=\"',Hr(Kn),'\"')}}}}return t.push(\">\"),hu(t,Go,ac),ac}}return SR(t,n,e)}var Qae=new Map;function b_(t){var e=Qae.get(t);return e===void 0&&(e=\"</\"+t+\">\",Qae.set(t,e)),e}function Kae(t,e){t=t.preamble,t.htmlChunks===null&&e.htmlChunks&&(t.htmlChunks=e.htmlChunks),t.headChunks===null&&e.headChunks&&(t.headChunks=e.headChunks),t.bodyChunks===null&&e.bodyChunks&&(t.bodyChunks=e.bodyChunks)}function Ble(t,e){e=e.bootstrapChunks;for(var n=0;n<e.length-1;n++)t.push(e[n]);return n<e.length?(n=e[n],e.length=0,t.push(n)):!0}function Jae(t,e,n){if(t.push('<!--$?--><template id=\"'),n===null)throw Error(Dn(395));return t.push(e.boundaryPrefix),e=n.toString(16),t.push(e),t.push('\"></template>')}function rBe(t,e,n,r){switch(n.insertionMode){case 0:case 1:case 3:case 2:return t.push('<div hidden id=\"'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('\">');case 4:return t.push('<svg aria-hidden=\"true\" style=\"display:none\" id=\"'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('\">');case 5:return t.push('<math aria-hidden=\"true\" style=\"display:none\" id=\"'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('\">');case 6:return t.push('<table hidden id=\"'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('\">');case 7:return t.push('<table hidden><tbody id=\"'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('\">');case 8:return t.push('<table hidden><tr id=\"'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('\">');case 9:return t.push('<table hidden><colgroup id=\"'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('\">');default:throw Error(Dn(397))}}function iBe(t,e){switch(e.insertionMode){case 0:case 1:case 3:case 2:return t.push(\"</div>\");case 4:return t.push(\"</svg>\");case 5:return t.push(\"</math>\");case 6:return t.push(\"</table>\");case 7:return t.push(\"</tbody></table>\");case 8:return t.push(\"</tr></table>\");case 9:return t.push(\"</colgroup></table>\");default:throw Error(Dn(397))}}var oBe=/[<\\u2028\\u2029]/g;function sBe(t){return JSON.stringify(t).replace(oBe,function(e){switch(e){case\"<\":return\"\\\\u003c\";case\"\\u2028\":return\"\\\\u2028\";case\"\\u2029\":return\"\\\\u2029\";default:throw Error(\"escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React\")}})}var aBe=/[&><\\u2028\\u2029]/g;function wT(t){return JSON.stringify(t).replace(aBe,function(e){switch(e){case\"&\":return\"\\\\u0026\";case\">\":return\"\\\\u003e\";case\"<\":return\"\\\\u003c\";case\"\\u2028\":return\"\\\\u2028\";case\"\\u2029\":return\"\\\\u2029\";default:throw Error(\"escapeJSObjectForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React\")}})}var NR=!1,f9=!0;function lBe(t){var e=t.rules,n=t.hrefs,r=0;if(n.length){for(this.push(ix.startInlineStyle),this.push(' media=\"not all\" data-precedence=\"'),this.push(t.precedence),this.push('\" data-href=\"');r<n.length-1;r++)this.push(n[r]),this.push(\" \");for(this.push(n[r]),this.push('\">'),r=0;r<e.length;r++)this.push(e[r]);f9=this.push(\"</style>\"),NR=!0,e.length=0,n.length=0}}function cBe(t){return t.state!==2?NR=!0:!1}function Dle(t,e,n){return NR=!1,f9=!0,ix=n,e.styles.forEach(lBe,t),ix=null,e.stylesheets.forEach(cBe),NR&&(n.stylesToHoist=!0),f9}function uf(t){for(var e=0;e<t.length;e++)this.push(t[e]);t.length=0}var og=[];function uBe(t){vl(og,t.props);for(var e=0;e<og.length;e++)this.push(og[e]);og.length=0,t.state=2}function hBe(t){var e=0<t.sheets.size;t.sheets.forEach(uBe,this),t.sheets.clear();var n=t.rules,r=t.hrefs;if(!e||r.length){if(this.push(ix.startInlineStyle),this.push(' data-precedence=\"'),this.push(t.precedence),t=0,r.length){for(this.push('\" data-href=\"');t<r.length-1;t++)this.push(r[t]),this.push(\" \");this.push(r[t])}for(this.push('\">'),t=0;t<n.length;t++)this.push(n[t]);this.push(\"</style>\"),n.length=0,r.length=0}}function fBe(t){if(t.state===0){t.state=1;var e=t.props;for(vl(og,{rel:\"preload\",as:\"style\",href:t.props.href,crossOrigin:e.crossOrigin,fetchPriority:e.fetchPriority,integrity:e.integrity,media:e.media,hrefLang:e.hrefLang,referrerPolicy:e.referrerPolicy}),t=0;t<og.length;t++)this.push(og[t]);og.length=0}}function dBe(t){t.sheets.forEach(fBe,this),t.sheets.clear()}function PR(t,e){(e.instructions&32)===0&&(e.instructions|=32,t.push(' id=\"',Hr(\"_\"+e.idPrefix+\"R_\"),'\"'))}function pBe(t,e){t.push(\"[\");var n=\"[\";e.stylesheets.forEach(function(r){if(r.state!==2)if(r.state===3)t.push(n),r=wT(\"\"+r.props.href),t.push(r),t.push(\"]\"),n=\",[\";else{t.push(n);var i=r.props[\"data-precedence\"],o=r.props,s=ET(\"\"+r.props.href);s=wT(s),t.push(s),i=\"\"+i,t.push(\",\"),i=wT(i),t.push(i);for(var c in o)if(zo.call(o,c)&&(i=o[c],i!=null))switch(c){case\"href\":case\"rel\":case\"precedence\":case\"data-precedence\":break;case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Dn(399,\"link\"));default:ABe(t,c,i)}t.push(\"]\"),n=\",[\",r.state=3}}),t.push(\"]\")}function ABe(t,e,n){var r=e.toLowerCase();switch(typeof n){case\"function\":case\"symbol\":return}switch(e){case\"innerHTML\":case\"dangerouslySetInnerHTML\":case\"suppressContentEditableWarning\":case\"suppressHydrationWarning\":case\"style\":case\"ref\":return;case\"className\":r=\"class\",e=\"\"+n;break;case\"hidden\":if(n===!1)return;e=\"\";break;case\"src\":case\"href\":n=ET(n),e=\"\"+n;break;default:if(2<e.length&&(e[0]===\"o\"||e[0]===\"O\")&&(e[1]===\"n\"||e[1]===\"N\")||!E9(e))return;e=\"\"+n}t.push(\",\"),r=wT(r),t.push(r),t.push(\",\"),r=wT(e),t.push(r)}function d9(){return{styles:new Set,stylesheets:new Set,suspenseyImages:!1}}function gBe(t){var e=Qa||null;if(e){var n=e.resumableState,r=e.renderState;if(typeof t==\"string\"&&t){if(!n.dnsResources.hasOwnProperty(t)){n.dnsResources[t]=null,n=r.headers;var i,o;(o=n&&0<n.remainingCapacity)&&(o=(i=\"<\"+(\"\"+t).replace(S9,C9)+\">; rel=dns-prefetch\",0<=(n.remainingCapacity-=i.length+2))),o?(r.resets.dns[t]=null,n.preconnects&&(n.preconnects+=\", \"),n.preconnects+=i):(i=[],vl(i,{href:t,rel:\"dns-prefetch\"}),r.preconnects.add(i))}T_(e)}}else $p.D(t)}function mBe(t,e){var n=Qa||null;if(n){var r=n.resumableState,i=n.renderState;if(typeof t==\"string\"&&t){var o=e===\"use-credentials\"?\"credentials\":typeof e==\"string\"?\"anonymous\":\"default\";if(!r.connectResources[o].hasOwnProperty(t)){r.connectResources[o][t]=null,r=i.headers;var s,c;if(c=r&&0<r.remainingCapacity){if(c=\"<\"+(\"\"+t).replace(S9,C9)+\">; rel=preconnect\",typeof e==\"string\"){var d=(\"\"+e).replace(p9,A9);c+='; crossorigin=\"'+d+'\"'}c=(s=c,0<=(r.remainingCapacity-=s.length+2))}c?(i.resets.connect[o][t]=null,r.preconnects&&(r.preconnects+=\", \"),r.preconnects+=s):(o=[],vl(o,{rel:\"preconnect\",href:t,crossOrigin:e}),i.preconnects.add(o))}T_(n)}}else $p.C(t,e)}function _Be(t,e,n){var r=Qa||null;if(r){var i=r.resumableState,o=r.renderState;if(e&&t){switch(e){case\"image\":if(n)var s=n.imageSrcSet,c=n.imageSizes,d=n.fetchPriority;var m=s?s+`\n`+(c||\"\"):t;if(i.imageResources.hasOwnProperty(m))return;i.imageResources[m]=ah,i=o.headers;var b;i&&0<i.remainingCapacity&&typeof s!=\"string\"&&d===\"high\"&&(b=zR(t,e,n),0<=(i.remainingCapacity-=b.length+2))?(o.resets.image[m]=ah,i.highImagePreloads&&(i.highImagePreloads+=\", \"),i.highImagePreloads+=b):(i=[],vl(i,Mc({rel:\"preload\",href:s?void 0:t,as:e},n)),d===\"high\"?o.highImagePreloads.add(i):(o.bulkPreloads.add(i),o.preloads.images.set(m,i)));break;case\"style\":if(i.styleResources.hasOwnProperty(t))return;s=[],vl(s,Mc({rel:\"preload\",href:t,as:e},n)),i.styleResources[t]=!n||typeof n.crossOrigin!=\"string\"&&typeof n.integrity!=\"string\"?ah:[n.crossOrigin,n.integrity],o.preloads.stylesheets.set(t,s),o.bulkPreloads.add(s);break;case\"script\":if(i.scriptResources.hasOwnProperty(t))return;s=[],o.preloads.scripts.set(t,s),o.bulkPreloads.add(s),vl(s,Mc({rel:\"preload\",href:t,as:e},n)),i.scriptResources[t]=!n||typeof n.crossOrigin!=\"string\"&&typeof n.integrity!=\"string\"?ah:[n.crossOrigin,n.integrity];break;default:if(i.unknownResources.hasOwnProperty(e)){if(s=i.unknownResources[e],s.hasOwnProperty(t))return}else s={},i.unknownResources[e]=s;if(s[t]=ah,(i=o.headers)&&0<i.remainingCapacity&&e===\"font\"&&(m=zR(t,e,n),0<=(i.remainingCapacity-=m.length+2)))o.resets.font[t]=ah,i.fontPreloads&&(i.fontPreloads+=\", \"),i.fontPreloads+=m;else switch(i=[],t=Mc({rel:\"preload\",href:t,as:e},n),vl(i,t),e){case\"font\":o.fontPreloads.add(i);break;default:o.bulkPreloads.add(i)}}T_(r)}}else $p.L(t,e,n)}function yBe(t,e){var n=Qa||null;if(n){var r=n.resumableState,i=n.renderState;if(t){var o=e&&typeof e.as==\"string\"?e.as:\"script\";switch(o){case\"script\":if(r.moduleScriptResources.hasOwnProperty(t))return;o=[],r.moduleScriptResources[t]=!e||typeof e.crossOrigin!=\"string\"&&typeof e.integrity!=\"string\"?ah:[e.crossOrigin,e.integrity],i.preloads.moduleScripts.set(t,o);break;default:if(r.moduleUnknownResources.hasOwnProperty(o)){var s=r.unknownResources[o];if(s.hasOwnProperty(t))return}else s={},r.moduleUnknownResources[o]=s;o=[],s[t]=ah}vl(o,Mc({rel:\"modulepreload\",href:t},e)),i.bulkPreloads.add(o),T_(n)}}else $p.m(t,e)}function xBe(t,e,n){var r=Qa||null;if(r){var i=r.resumableState,o=r.renderState;if(t){e=e||\"default\";var s=o.styles.get(e),c=i.styleResources.hasOwnProperty(t)?i.styleResources[t]:void 0;c!==null&&(i.styleResources[t]=null,s||(s={precedence:Hr(e),rules:[],hrefs:[],sheets:new Map},o.styles.set(e,s)),e={state:0,props:Mc({rel:\"stylesheet\",href:t,\"data-precedence\":e},n)},c&&(c.length===2&&ST(e.props,c),(o=o.preloads.stylesheets.get(t))&&0<o.length?o.length=0:e.state=1),s.sheets.set(t,e),T_(r))}}else $p.S(t,e,n)}function vBe(t,e){var n=Qa||null;if(n){var r=n.resumableState,i=n.renderState;if(t){var o=r.scriptResources.hasOwnProperty(t)?r.scriptResources[t]:void 0;o!==null&&(r.scriptResources[t]=null,e=Mc({src:t,async:!0},e),o&&(o.length===2&&ST(e,o),t=i.preloads.scripts.get(t))&&(t.length=0),t=[],i.scripts.add(t),kR(t,e),T_(n))}}else $p.X(t,e)}function bBe(t,e){var n=Qa||null;if(n){var r=n.resumableState,i=n.renderState;if(t){var o=r.moduleScriptResources.hasOwnProperty(t)?r.moduleScriptResources[t]:void 0;o!==null&&(r.moduleScriptResources[t]=null,e=Mc({src:t,type:\"module\",async:!0},e),o&&(o.length===2&&ST(e,o),t=i.preloads.moduleScripts.get(t))&&(t.length=0),t=[],i.scripts.add(t),kR(t,e),T_(n))}}else $p.M(t,e)}function ST(t,e){t.crossOrigin==null&&(t.crossOrigin=e[0]),t.integrity==null&&(t.integrity=e[1])}function zR(t,e,n){t=(\"\"+t).replace(S9,C9),e=(\"\"+e).replace(p9,A9),e=\"<\"+t+'>; rel=preload; as=\"'+e+'\"';for(var r in n)zo.call(n,r)&&(t=n[r],typeof t==\"string\"&&(e+=\"; \"+r.toLowerCase()+'=\"'+(\"\"+t).replace(p9,A9)+'\"'));return e}var S9=/[<>\\r\\n]/g;function C9(t){switch(t){case\"<\":return\"%3C\";case\">\":return\"%3E\";case`\n`:return\"%0A\";case\"\\r\":return\"%0D\";default:throw Error(\"escapeLinkHrefForHeaderContextReplacer encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React\")}}var p9=/[\"';,\\r\\n]/g;function A9(t){switch(t){case'\"':return\"%22\";case\"'\":return\"%27\";case\";\":return\"%3B\";case\",\":return\"%2C\";case`\n`:return\"%0A\";case\"\\r\":return\"%0D\";default:throw Error(\"escapeStringForLinkHeaderQuotedParamValueContextReplacer encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React\")}}function wBe(t){this.styles.add(t)}function TBe(t){this.stylesheets.add(t)}function ox(t,e){e.styles.forEach(wBe,t),e.stylesheets.forEach(TBe,t),e.suspenseyImages&&(t.suspenseyImages=!0)}function EBe(t,e){var n=t.idPrefix,r=[],i=t.bootstrapScriptContent,o=t.bootstrapScripts,s=t.bootstrapModules;i!==void 0&&(r.push(\"<script\"),PR(r,t),r.push(\">\",(\"\"+i).replace(Tle,Ele),\"<\\/script>\")),i=n+\"P:\";var c=n+\"S:\";n+=\"B:\";var d=new Set,m=new Set,b=new Set,C=new Map,B=new Set,k=new Set,V=new Set,q={images:new Map,stylesheets:new Map,scripts:new Map,moduleScripts:new Map};if(o!==void 0)for(var K=0;K<o.length;K++){var Y=o[K],ee,J=void 0,se=void 0,xe={rel:\"preload\",as:\"script\",fetchPriority:\"low\",nonce:void 0};typeof Y==\"string\"?xe.href=ee=Y:(xe.href=ee=Y.src,xe.integrity=se=typeof Y.integrity==\"string\"?Y.integrity:void 0,xe.crossOrigin=J=typeof Y==\"string\"||Y.crossOrigin==null?void 0:Y.crossOrigin===\"use-credentials\"?\"use-credentials\":\"\"),Y=t;var Ee=ee;Y.scriptResources[Ee]=null,Y.moduleScriptResources[Ee]=null,Y=[],vl(Y,xe),B.add(Y),r.push('<script src=\"',Hr(ee),'\"'),typeof se==\"string\"&&r.push(' integrity=\"',Hr(se),'\"'),typeof J==\"string\"&&r.push(' crossorigin=\"',Hr(J),'\"'),PR(r,t),r.push(' async=\"\"><\\/script>')}if(s!==void 0)for(o=0;o<s.length;o++)xe=s[o],J=ee=void 0,se={rel:\"modulepreload\",fetchPriority:\"low\",nonce:void 0},typeof xe==\"string\"?se.href=K=xe:(se.href=K=xe.src,se.integrity=J=typeof xe.integrity==\"string\"?xe.integrity:void 0,se.crossOrigin=ee=typeof xe==\"string\"||xe.crossOrigin==null?void 0:xe.crossOrigin===\"use-credentials\"?\"use-credentials\":\"\"),xe=t,Y=K,xe.scriptResources[Y]=null,xe.moduleScriptResources[Y]=null,xe=[],vl(xe,se),B.add(xe),r.push('<script type=\"module\" src=\"',Hr(K),'\"'),typeof J==\"string\"&&r.push(' integrity=\"',Hr(J),'\"'),typeof ee==\"string\"&&r.push(' crossorigin=\"',Hr(ee),'\"'),PR(r,t),r.push(' async=\"\"><\\/script>');return{placeholderPrefix:i,segmentPrefix:c,boundaryPrefix:n,startInlineScript:\"<script\",startInlineStyle:\"<style\",preamble:{htmlChunks:null,headChunks:null,bodyChunks:null},externalRuntimeScript:null,bootstrapChunks:r,importMapChunks:[],onHeaders:void 0,headers:null,resets:{font:{},dns:{},connect:{default:{},anonymous:{},credentials:{}},image:{},style:{}},charsetChunks:[],viewportChunks:[],hoistableChunks:[],preconnects:d,fontPreloads:m,highImagePreloads:b,styles:C,bootstrapScripts:B,scripts:k,bulkPreloads:V,preloads:q,nonce:{script:void 0,style:void 0},stylesToHoist:!1,generateStaticMarkup:e}}function $ae(t,e,n,r){return n.generateStaticMarkup?(t.push(Hr(e)),!1):(e===\"\"?t=r:(r&&t.push(\"<!-- -->\"),t.push(Hr(e)),t=!0),t)}function TT(t,e,n,r){e.generateStaticMarkup||n&&r&&t.push(\"<!-- -->\")}var SBe=Function.prototype.bind,CBe=Symbol.for(\"react.client.reference\");function UR(t){if(t==null)return null;if(typeof t==\"function\")return t.$$typeof===CBe?null:t.displayName||t.name||null;if(typeof t==\"string\")return t;switch(t){case mle:return\"Fragment\";case yle:return\"Profiler\";case _le:return\"StrictMode\";case qR:return\"Suspense\";case w9:return\"SuspenseList\";case vle:return\"Activity\"}if(typeof t==\"object\")switch(t.$$typeof){case gle:return\"Portal\";case ZR:return t.displayName||\"Context\";case xle:return(t._context.displayName||\"Context\")+\".Consumer\";case b9:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||\"\",t=t!==\"\"?\"ForwardRef(\"+t+\")\":\"ForwardRef\"),t;case T9:return e=t.displayName||null,e!==null?e:UR(t.type)||\"Memo\";case QR:e=t._payload,t=t._init;try{return UR(t(e))}catch{}}return null}var ele={},x_=null;function KR(t,e){if(t!==e){t.context._currentValue2=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(Dn(401))}else{if(n===null)throw Error(Dn(401));KR(t,n)}e.context._currentValue2=e.value}}function Lle(t){t.context._currentValue2=t.parentValue,t=t.parent,t!==null&&Lle(t)}function Ole(t){var e=t.parent;e!==null&&Ole(e),t.context._currentValue2=t.value}function Fle(t,e){if(t.context._currentValue2=t.parentValue,t=t.parent,t===null)throw Error(Dn(402));t.depth===e.depth?KR(t,e):Fle(t,e)}function kle(t,e){var n=e.parent;if(n===null)throw Error(Dn(402));t.depth===n.depth?KR(t,n):kle(t,n),e.context._currentValue2=e.value}function ig(t){var e=x_;e!==t&&(e===null?Ole(t):t===null?Lle(e):e.depth===t.depth?KR(e,t):e.depth>t.depth?Fle(e,t):kle(e,t),x_=t)}var tle={enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}},MBe={id:1,overflow:\"\"};function v_(t,e,n){var r=t.id;t=t.overflow;var i=32-RR(r)-1;r&=~(1<<i),n+=1;var o=32-RR(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-RR(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var RR=Math.clz32?Math.clz32:RBe,IBe=Math.log,PBe=Math.LN2;function RBe(t){return t>>>=0,t===0?32:31-(IBe(t)/PBe|0)|0}function nc(){}var fu=Error(Dn(460));function BBe(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then(nc,nc),e=n),e.status){case\"fulfilled\":return e.value;case\"rejected\":throw e.reason;default:switch(typeof e.status==\"string\"?e.then(nc,nc):(t=e,t.status=\"pending\",t.then(function(r){if(e.status===\"pending\"){var i=e;i.status=\"fulfilled\",i.value=r}},function(r){if(e.status===\"pending\"){var i=e;i.status=\"rejected\",i.reason=r}})),e.status){case\"fulfilled\":return e.value;case\"rejected\":throw e.reason}throw BR=e,fu}}var BR=null;function VR(){if(BR===null)throw Error(Dn(459));var t=BR;return BR=null,t}function DBe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var LBe=typeof Object.is==\"function\"?Object.is:DBe,e0=null,M9=null,I9=null,P9=null,DR=null,_o=null,vT=!1,GR=!1,CT=0,MT=0,IT=-1,HR=0,rx=null,sg=null,JR=0;function Jp(){if(e0===null)throw Error(Dn(321));return e0}function nle(){if(0<JR)throw Error(Dn(312));return{memoizedState:null,queue:null,next:null}}function R9(){return _o===null?DR===null?(vT=!1,DR=_o=nle()):(vT=!0,_o=DR):_o.next===null?(vT=!1,_o=_o.next=nle()):(vT=!0,_o=_o.next),_o}function nx(){var t=rx;return rx=null,t}function PT(){P9=I9=M9=e0=null,GR=!1,DR=null,JR=0,_o=sg=null}function Nle(t,e){return typeof e==\"function\"?e(t):e}function rle(t,e,n){if(e0=Jp(),_o=R9(),vT){var r=_o.queue;if(e=r.dispatch,sg!==null&&(n=sg.get(r),n!==void 0)){sg.delete(r),r=_o.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return _o.memoizedState=r,[r,e]}return[_o.memoizedState,e]}return t=t===Nle?typeof e==\"function\"?e():e:n!==void 0?n(e):e,_o.memoizedState=t,t=_o.queue={last:null,dispatch:null},t=t.dispatch=OBe.bind(null,e0,t),[_o.memoizedState,t]}function ile(t,e){if(e0=Jp(),_o=R9(),e=e===void 0?null:e,_o!==null){var n=_o.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!LBe(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),_o.memoizedState=[t,e],t}function OBe(t,e,n){if(25<=JR)throw Error(Dn(301));if(t===e0)if(GR=!0,t={action:n,next:null},sg===null&&(sg=new Map),n=sg.get(e),n===void 0)sg.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function FBe(){throw Error(Dn(440))}function kBe(){throw Error(Dn(394))}function NBe(){throw Error(Dn(479))}function ole(t,e,n){Jp();var r=MT++,i=I9;if(typeof t.$$FORM_ACTION==\"function\"){var o=null,s=P9;i=i.formState;var c=t.$$IS_SIGNATURE_EQUAL;if(i!==null&&typeof c==\"function\"){var d=i[1];c.call(t,i[2],i[3])&&(o=n!==void 0?\"p\"+n:\"k\"+Uae(JSON.stringify([s,null,r]),0),d===o&&(IT=r,e=i[0]))}var m=t.bind(null,e);return t=function(C){m(C)},typeof m.$$FORM_ACTION==\"function\"&&(t.$$FORM_ACTION=function(C){C=m.$$FORM_ACTION(C),n!==void 0&&(n+=\"\",C.action=n);var B=C.data;return B&&(o===null&&(o=n!==void 0?\"p\"+n:\"k\"+Uae(JSON.stringify([s,null,r]),0)),B.append(\"$ACTION_KEY\",o)),C}),[e,t,!1]}var b=t.bind(null,e);return[e,function(C){b(C)},!1]}function zle(t){var e=HR;return HR+=1,rx===null&&(rx=[]),BBe(rx,t,e)}function zBe(){throw Error(Dn(393))}var sle={readContext:function(t){return t._currentValue2},use:function(t){if(t!==null&&typeof t==\"object\"){if(typeof t.then==\"function\")return zle(t);if(t.$$typeof===ZR)return t._currentValue2}throw Error(Dn(438,String(t)))},useContext:function(t){return Jp(),t._currentValue2},useMemo:ile,useReducer:rle,useRef:function(t){e0=Jp(),_o=R9();var e=_o.memoizedState;return e===null?(t={current:t},_o.memoizedState=t):e},useState:function(t){return rle(Nle,t)},useInsertionEffect:nc,useLayoutEffect:nc,useCallback:function(t,e){return ile(function(){return t},e)},useImperativeHandle:nc,useEffect:nc,useDebugValue:nc,useDeferredValue:function(t,e){return Jp(),e!==void 0?e:t},useTransition:function(){return Jp(),[!1,kBe]},useId:function(){var t=M9.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-RR(t)-1)).toString(32)+e;var n=LR;if(n===null)throw Error(Dn(404));return e=CT++,t=\"_\"+n.idPrefix+\"R_\"+t,0<e&&(t+=\"H\"+e.toString(32)),t+\"_\"},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(Dn(407));return n()},useOptimistic:function(t){return Jp(),[t,NBe]},useActionState:ole,useFormState:ole,useHostTransitionStatus:function(){return Jp(),J5e},useMemoCache:function(t){for(var e=Array(t),n=0;n<t;n++)e[n]=H5e;return e},useCacheRefresh:function(){return zBe},useEffectEvent:function(){return FBe}},LR=null,UBe={getCacheForType:function(){throw Error(Dn(248))},cacheSignal:function(){throw Error(Dn(248))}},s9,ale;function tx(t){if(s9===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\\n( *(at )?)/);s9=e&&e[1]||\"\",ale=-1<n.stack.indexOf(`\n    at`)?\" (<anonymous>)\":-1<n.stack.indexOf(\"@\")?\"@unknown:0:0\":\"\"}return`\n`+s9+t+ale}var a9=!1;function CR(t,e){if(!t||a9)return\"\";a9=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(e){var C=function(){throw Error()};if(Object.defineProperty(C.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(C,[])}catch(k){var B=k}Reflect.construct(t,[],C)}else{try{C.call()}catch(k){B=k}t.call(C.prototype)}}else{try{throw Error()}catch(k){B=k}(C=t())&&typeof C.catch==\"function\"&&C.catch(function(){})}}catch(k){if(k&&B&&typeof k.stack==\"string\")return[k.stack,B.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName=\"DetermineComponentFrameRoot\";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,\"name\");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,\"name\",{value:\"DetermineComponentFrameRoot\"});var o=r.DetermineComponentFrameRoot(),s=o[0],c=o[1];if(s&&c){var d=s.split(`\n`),m=c.split(`\n`);for(i=r=0;r<d.length&&!d[r].includes(\"DetermineComponentFrameRoot\");)r++;for(;i<m.length&&!m[i].includes(\"DetermineComponentFrameRoot\");)i++;if(r===d.length||i===m.length)for(r=d.length-1,i=m.length-1;1<=r&&0<=i&&d[r]!==m[i];)i--;for(;1<=r&&0<=i;r--,i--)if(d[r]!==m[i]){if(r!==1||i!==1)do if(r--,i--,0>i||d[r]!==m[i]){var b=`\n`+d[r].replace(\" at new \",\" at \");return t.displayName&&b.includes(\"<anonymous>\")&&(b=b.replace(\"<anonymous>\",t.displayName)),b}while(1<=r&&0<=i);break}}}finally{a9=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:\"\")?tx(n):\"\"}function Ule(t){if(typeof t==\"string\")return tx(t);if(typeof t==\"function\")return t.prototype&&t.prototype.isReactComponent?CR(t,!0):CR(t,!1);if(typeof t==\"object\"&&t!==null){switch(t.$$typeof){case b9:return CR(t.render,!1);case T9:return CR(t.type,!1);case QR:var e=t,n=e._payload;e=e._init;try{t=e(n)}catch{return tx(\"Lazy\")}return Ule(t)}if(typeof t.name==\"string\"){e:{n=t.name,e=t.env;var r=t.debugLocation;if(r!=null&&(t=Error.prepareStackTrace,Error.prepareStackTrace=void 0,r=r.stack,Error.prepareStackTrace=t,r.startsWith(`Error: react-stack-top-frame\n`)&&(r=r.slice(29)),t=r.indexOf(`\n`),t!==-1&&(r=r.slice(t+1)),t=r.indexOf(\"react_stack_bottom_frame\"),t!==-1&&(t=r.lastIndexOf(`\n`,t)),t=t!==-1?r=r.slice(0,t):\"\",r=t.lastIndexOf(`\n`),t=r===-1?t:t.slice(r+1),t.indexOf(n)!==-1)){n=`\n`+t;break e}n=tx(n+(e?\" [\"+e+\"]\":\"\"))}return n}}switch(t){case w9:return tx(\"SuspenseList\");case qR:return tx(\"Suspense\")}return\"\"}function sx(t,e){return(500<e.byteSize||!1)&&e.contentPreamble===null}function VBe(t){if(typeof t==\"object\"&&t!==null&&typeof t.environmentName==\"string\"){var e=t.environmentName;t=[t].slice(0),typeof t[0]==\"string\"?t.splice(0,1,\"[%s] \"+t[0],\" \"+e+\" \"):t.splice(0,0,\"[%s]\",\" \"+e+\" \"),t.unshift(console),e=SBe.apply(console.error,t),e()}else console.error(t);return null}function GBe(t,e,n,r,i,o,s,c,d,m,b){var C=new Set;this.destination=null,this.flushScheduled=!1,this.resumableState=t,this.renderState=e,this.rootFormatContext=n,this.progressiveChunkSize=r===void 0?12800:r,this.status=10,this.fatalError=null,this.pendingRootTasks=this.allPendingTasks=this.nextSegmentId=0,this.completedPreambleSegments=this.completedRootSegment=null,this.byteSize=0,this.abortableTasks=C,this.pingedTasks=[],this.clientRenderedBoundaries=[],this.completedBoundaries=[],this.partialBoundaries=[],this.trackedPostpones=null,this.onError=i===void 0?VBe:i,this.onPostpone=m===void 0?nc:m,this.onAllReady=o===void 0?nc:o,this.onShellReady=s===void 0?nc:s,this.onShellError=c===void 0?nc:c,this.onFatalError=d===void 0?nc:d,this.formState=b===void 0?null:b}function HBe(t,e,n,r,i,o,s,c,d,m,b,C){return e=new GBe(e,n,r,i,o,s,c,d,m,b,C),n=w_(e,0,null,r,!1,!1),n.parentFlushed=!0,t=WR(e,null,t,-1,null,n,null,null,e.abortableTasks,null,r,null,MBe,null,null),RT(t),e.pingedTasks.push(t),e}var Qa=null;function Vle(t,e){t.pingedTasks.push(e),t.pingedTasks.length===1&&(t.flushScheduled=t.destination!==null,Wle(t))}function B9(t,e,n,r,i){return n={status:0,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,row:e,completedSegments:[],byteSize:0,fallbackAbortableTasks:n,errorDigest:null,contentState:d9(),fallbackState:d9(),contentPreamble:r,fallbackPreamble:i,trackedContentKeyPath:null,trackedFallbackNode:null},e!==null&&(e.pendingTasks++,r=e.boundaries,r!==null&&(t.allPendingTasks++,n.pendingTasks++,r.push(n)),t=e.inheritedHoistables,t!==null&&ox(n.contentState,t)),n}function WR(t,e,n,r,i,o,s,c,d,m,b,C,B,k,V){t.allPendingTasks++,i===null?t.pendingRootTasks++:i.pendingTasks++,k!==null&&k.pendingTasks++;var q={replay:null,node:n,childIndex:r,ping:function(){return Vle(t,q)},blockedBoundary:i,blockedSegment:o,blockedPreamble:s,hoistableState:c,abortSet:d,keyPath:m,formatContext:b,context:C,treeContext:B,row:k,componentStack:V,thenableState:e};return d.add(q),q}function Gle(t,e,n,r,i,o,s,c,d,m,b,C,B,k){t.allPendingTasks++,o===null?t.pendingRootTasks++:o.pendingTasks++,B!==null&&B.pendingTasks++,n.pendingTasks++;var V={replay:n,node:r,childIndex:i,ping:function(){return Vle(t,V)},blockedBoundary:o,blockedSegment:null,blockedPreamble:null,hoistableState:s,abortSet:c,keyPath:d,formatContext:m,context:b,treeContext:C,row:B,componentStack:k,thenableState:e};return c.add(V),V}function w_(t,e,n,r,i,o){return{status:0,parentFlushed:!1,id:-1,index:e,chunks:[],children:[],preambleChildren:[],parentFormatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function RT(t){var e=t.node;if(typeof e==\"object\"&&e!==null)switch(e.$$typeof){case Ale:t.componentStack={parent:t.componentStack,type:e.type}}}function g9(t){return t===null?null:{parent:t.parent,type:\"Suspense Fallback\"}}function ag(t){var e={};return t&&Object.defineProperty(e,\"componentStack\",{configurable:!0,enumerable:!0,get:function(){try{var n=\"\",r=t;do n+=Ule(r.type),r=r.parent;while(r);var i=n}catch(o){i=`\nError generating stack: `+o.message+`\n`+o.stack}return Object.defineProperty(e,\"componentStack\",{value:i}),i}}),e}function bl(t,e,n){if(t=t.onError,e=t(e,n),e==null||typeof e==\"string\")return e}function BT(t,e){var n=t.onShellError,r=t.onFatalError;n(e),r(e),t.destination!==null?(t.status=14,t.destination.destroy(e)):(t.status=13,t.fatalError=e)}function wl(t,e){D9(t,e.next,e.hoistables)}function D9(t,e,n){for(;e!==null;){n!==null&&(ox(e.hoistables,n),e.inheritedHoistables=n);var r=e.boundaries;if(r!==null){e.boundaries=null;for(var i=0;i<r.length;i++){var o=r[i];n!==null&&ox(o.contentState,n),lg(t,o,null,null)}}if(e.pendingTasks--,0<e.pendingTasks)break;n=e.hoistables,e=e.next}}function m9(t,e){var n=e.boundaries;if(n!==null&&e.pendingTasks===n.length){for(var r=!0,i=0;i<n.length;i++){var o=n[i];if(o.pendingTasks!==1||o.parentFlushed||sx(t,o)){r=!1;break}}r&&D9(t,e,e.hoistables)}}function bT(t){var e={pendingTasks:1,boundaries:null,hoistables:d9(),inheritedHoistables:null,together:!1,next:null};return t!==null&&0<t.pendingTasks&&(e.pendingTasks++,e.boundaries=[],t.next=e),e}function lle(t,e,n,r,i){var o=e.keyPath,s=e.treeContext,c=e.row;e.keyPath=n,n=r.length;var d=null;if(e.replay!==null){var m=e.replay.slots;if(m!==null&&typeof m==\"object\")for(var b=0;b<n;b++){var C=i!==\"backwards\"&&i!==\"unstable_legacy-backwards\"?b:n-1-b,B=r[C];e.row=d=bT(d),e.treeContext=v_(s,n,C);var k=m[C];typeof k==\"number\"?($R(t,e,k,B,C),delete m[C]):Ca(t,e,B,C),--d.pendingTasks===0&&wl(t,d)}else for(m=0;m<n;m++)b=i!==\"backwards\"&&i!==\"unstable_legacy-backwards\"?m:n-1-m,C=r[b],e.row=d=bT(d),e.treeContext=v_(s,n,b),Ca(t,e,C,b),--d.pendingTasks===0&&wl(t,d)}else if(i!==\"backwards\"&&i!==\"unstable_legacy-backwards\")for(i=0;i<n;i++)m=r[i],e.row=d=bT(d),e.treeContext=v_(s,n,i),Ca(t,e,m,i),--d.pendingTasks===0&&wl(t,d);else{for(i=e.blockedSegment,m=i.children.length,b=i.chunks.length,C=n-1;0<=C;C--){B=r[C],e.row=d=bT(d),e.treeContext=v_(s,n,C),k=w_(t,b,null,e.formatContext,C===0?i.lastPushedText:!0,!0),i.children.splice(m,0,k),e.blockedSegment=k;try{Ca(t,e,B,C),TT(k.chunks,t.renderState,k.lastPushedText,k.textEmbedded),k.status=1,--d.pendingTasks===0&&wl(t,d)}catch(V){throw k.status=t.status===12?3:4,V}}e.blockedSegment=i,i.lastPushedText=!1}c!==null&&d!==null&&0<d.pendingTasks&&(c.pendingTasks++,d.next=c),e.treeContext=s,e.row=c,e.keyPath=o}function cle(t,e,n,r,i,o){var s=e.thenableState;for(e.thenableState=null,e0={},M9=e,I9=t,P9=n,MT=CT=0,IT=-1,HR=0,rx=s,t=r(i,o);GR;)GR=!1,MT=CT=0,IT=-1,HR=0,JR+=1,_o=null,t=r(i,o);return PT(),t}function ule(t,e,n,r,i,o,s){var c=!1;if(o!==0&&t.formState!==null){var d=e.blockedSegment;if(d!==null){c=!0,d=d.chunks;for(var m=0;m<o;m++)m===s?d.push(\"<!--F!-->\"):d.push(\"<!--F-->\")}}o=e.keyPath,e.keyPath=n,i?(n=e.treeContext,e.treeContext=v_(n,1,0),Ca(t,e,r,-1),e.treeContext=n):c?Ca(t,e,r,-1):lh(t,e,r,-1),e.keyPath=o}function jR(t,e,n,r,i,o){if(typeof r==\"function\")if(r.prototype&&r.prototype.isReactComponent){var s=i;if(\"ref\"in i){s={};for(var c in i)c!==\"ref\"&&(s[c]=i[c])}var d=r.defaultProps;if(d){s===i&&(s=Mc({},s,i));for(var m in d)s[m]===void 0&&(s[m]=d[m])}i=s,s=ele,d=r.contextType,typeof d==\"object\"&&d!==null&&(s=d._currentValue2),s=new r(i,s);var b=s.state!==void 0?s.state:null;if(s.updater=tle,s.props=i,s.state=b,d={queue:[],replace:!1},s._reactInternals=d,o=r.contextType,s.context=typeof o==\"object\"&&o!==null?o._currentValue2:ele,o=r.getDerivedStateFromProps,typeof o==\"function\"&&(o=o(i,b),b=o==null?b:Mc({},b,o),s.state=b),typeof r.getDerivedStateFromProps!=\"function\"&&typeof s.getSnapshotBeforeUpdate!=\"function\"&&(typeof s.UNSAFE_componentWillMount==\"function\"||typeof s.componentWillMount==\"function\"))if(r=s.state,typeof s.componentWillMount==\"function\"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount==\"function\"&&s.UNSAFE_componentWillMount(),r!==s.state&&tle.enqueueReplaceState(s,s.state,null),d.queue!==null&&0<d.queue.length)if(r=d.queue,o=d.replace,d.queue=null,d.replace=!1,o&&r.length===1)s.state=r[0];else{for(d=o?r[0]:s.state,b=!0,o=o?1:0;o<r.length;o++)m=r[o],m=typeof m==\"function\"?m.call(s,d,i,void 0):m,m!=null&&(b?(b=!1,d=Mc({},d,m)):Mc(d,m));s.state=d}else d.queue=null;if(r=s.render(),t.status===12)throw null;i=e.keyPath,e.keyPath=n,lh(t,e,r,-1),e.keyPath=i}else{if(r=cle(t,e,n,r,i,void 0),t.status===12)throw null;ule(t,e,n,r,CT!==0,MT,IT)}else if(typeof r==\"string\")if(s=e.blockedSegment,s===null)s=i.children,d=e.formatContext,b=e.keyPath,e.formatContext=Hae(d,r,i),e.keyPath=n,Ca(t,e,s,-1),e.formatContext=d,e.keyPath=b;else{if(b=nBe(s.chunks,r,i,t.resumableState,t.renderState,e.blockedPreamble,e.hoistableState,e.formatContext,s.lastPushedText),s.lastPushedText=!1,d=e.formatContext,o=e.keyPath,e.keyPath=n,(e.formatContext=Hae(d,r,i)).insertionMode===3){n=w_(t,0,null,e.formatContext,!1,!1),s.preambleChildren.push(n),e.blockedSegment=n;try{n.status=6,Ca(t,e,b,-1),TT(n.chunks,t.renderState,n.lastPushedText,n.textEmbedded),n.status=1}finally{e.blockedSegment=s}}else Ca(t,e,b,-1);e.formatContext=d,e.keyPath=o;e:{switch(e=s.chunks,t=t.resumableState,r){case\"title\":case\"style\":case\"script\":case\"area\":case\"base\":case\"br\":case\"col\":case\"embed\":case\"hr\":case\"img\":case\"input\":case\"keygen\":case\"link\":case\"meta\":case\"param\":case\"source\":case\"track\":case\"wbr\":break e;case\"body\":if(1>=d.insertionMode){t.hasBody=!0;break e}break;case\"html\":if(d.insertionMode===0){t.hasHtml=!0;break e}break;case\"head\":if(1>=d.insertionMode)break e}e.push(b_(r))}s.lastPushedText=!1}else{switch(r){case G5e:case _le:case yle:case mle:r=e.keyPath,e.keyPath=n,lh(t,e,i.children,-1),e.keyPath=r;return;case vle:r=e.blockedSegment,r===null?i.mode!==\"hidden\"&&(r=e.keyPath,e.keyPath=n,Ca(t,e,i.children,-1),e.keyPath=r):i.mode!==\"hidden\"&&(t.renderState.generateStaticMarkup||r.chunks.push(\"<!--&-->\"),r.lastPushedText=!1,s=e.keyPath,e.keyPath=n,Ca(t,e,i.children,-1),e.keyPath=s,t.renderState.generateStaticMarkup||r.chunks.push(\"<!--/&-->\"),r.lastPushedText=!1);return;case w9:e:{if(r=i.children,i=i.revealOrder,i===\"forwards\"||i===\"backwards\"||i===\"unstable_legacy-backwards\"){if(FR(r)){lle(t,e,n,r,i);break e}if((s=ble(r))&&(s=s.call(r))){if(d=s.next(),!d.done){do d=s.next();while(!d.done);lle(t,e,n,r,i)}break e}}i===\"together\"?(i=e.keyPath,s=e.row,d=e.row=bT(null),d.boundaries=[],d.together=!0,e.keyPath=n,lh(t,e,r,-1),--d.pendingTasks===0&&wl(t,d),e.keyPath=i,e.row=s,s!==null&&0<d.pendingTasks&&(s.pendingTasks++,d.next=s)):(i=e.keyPath,e.keyPath=n,lh(t,e,r,-1),e.keyPath=i)}return;case W5e:case V5e:throw Error(Dn(343));case qR:e:if(e.replay!==null){r=e.keyPath,s=e.formatContext,d=e.row,e.keyPath=n,e.formatContext=IR(t.resumableState,s),e.row=null,n=i.children;try{Ca(t,e,n,-1)}finally{e.keyPath=r,e.formatContext=s,e.row=d}}else{r=e.keyPath,o=e.formatContext;var C=e.row,B=e.blockedBoundary;m=e.blockedPreamble;var k=e.hoistableState;c=e.blockedSegment;var V=i.fallback;i=i.children;var q=new Set,K=B9(t,e.row,q,null,null);t.trackedPostpones!==null&&(K.trackedContentKeyPath=n);var Y=w_(t,c.chunks.length,K,e.formatContext,!1,!1);c.children.push(Y),c.lastPushedText=!1;var ee=w_(t,0,null,e.formatContext,!1,!1);if(ee.parentFlushed=!0,t.trackedPostpones!==null){s=e.componentStack,d=[n[0],\"Suspense Fallback\",n[2]],b=[d[1],d[2],[],null],t.trackedPostpones.workingMap.set(d,b),K.trackedFallbackNode=b,e.blockedSegment=Y,e.blockedPreamble=K.fallbackPreamble,e.keyPath=d,e.formatContext=u9(t.resumableState,o),e.componentStack=g9(s),Y.status=6;try{Ca(t,e,V,-1),TT(Y.chunks,t.renderState,Y.lastPushedText,Y.textEmbedded),Y.status=1}catch(J){throw Y.status=t.status===12?3:4,J}finally{e.blockedSegment=c,e.blockedPreamble=m,e.keyPath=r,e.formatContext=o}e=WR(t,null,i,-1,K,ee,K.contentPreamble,K.contentState,e.abortSet,n,IR(t.resumableState,e.formatContext),e.context,e.treeContext,null,s),RT(e),t.pingedTasks.push(e)}else{e.blockedBoundary=K,e.blockedPreamble=K.contentPreamble,e.hoistableState=K.contentState,e.blockedSegment=ee,e.keyPath=n,e.formatContext=IR(t.resumableState,o),e.row=null,ee.status=6;try{if(Ca(t,e,i,-1),TT(ee.chunks,t.renderState,ee.lastPushedText,ee.textEmbedded),ee.status=1,DT(K,ee),K.pendingTasks===0&&K.status===0){if(K.status=1,!sx(t,K)){C!==null&&--C.pendingTasks===0&&wl(t,C),t.pendingRootTasks===0&&e.blockedPreamble&&kT(t);break e}}else C!==null&&C.together&&m9(t,C)}catch(J){K.status=4,t.status===12?(ee.status=3,s=t.fatalError):(ee.status=4,s=J),d=ag(e.componentStack),b=bl(t,s,d),K.errorDigest=b,L9(t,K)}finally{e.blockedBoundary=B,e.blockedPreamble=m,e.hoistableState=k,e.blockedSegment=c,e.keyPath=r,e.formatContext=o,e.row=C}e=WR(t,null,V,-1,B,Y,K.fallbackPreamble,K.fallbackState,q,[n[0],\"Suspense Fallback\",n[2]],u9(t.resumableState,e.formatContext),e.context,e.treeContext,e.row,g9(e.componentStack)),RT(e),t.pingedTasks.push(e)}}return}if(typeof r==\"object\"&&r!==null)switch(r.$$typeof){case b9:if(\"ref\"in i)for(V in s={},i)V!==\"ref\"&&(s[V]=i[V]);else s=i;r=cle(t,e,n,r.render,s,o),ule(t,e,n,r,CT!==0,MT,IT);return;case T9:jR(t,e,n,r.type,i,o);return;case ZR:if(d=i.children,s=e.keyPath,i=i.value,b=r._currentValue2,r._currentValue2=i,o=x_,x_=r={parent:o,depth:o===null?0:o.depth+1,context:r,parentValue:b,value:i},e.context=r,e.keyPath=n,lh(t,e,d,-1),t=x_,t===null)throw Error(Dn(403));t.context._currentValue2=t.parentValue,t=x_=t.parent,e.context=t,e.keyPath=s;return;case xle:i=i.children,r=i(r._context._currentValue2),i=e.keyPath,e.keyPath=n,lh(t,e,r,-1),e.keyPath=i;return;case QR:if(s=r._init,r=s(r._payload),t.status===12)throw null;jR(t,e,n,r,i,o);return}throw Error(Dn(130,r==null?r:typeof r,\"\"))}}function $R(t,e,n,r,i){var o=e.replay,s=e.blockedBoundary,c=w_(t,0,null,e.formatContext,!1,!1);c.id=n,c.parentFlushed=!0;try{e.replay=null,e.blockedSegment=c,Ca(t,e,r,i),c.status=1,s===null?t.completedRootSegment=c:(DT(s,c),s.parentFlushed&&t.partialBoundaries.push(s))}finally{e.replay=o,e.blockedSegment=null}}function lh(t,e,n,r){e.replay!==null&&typeof e.replay.slots==\"number\"?$R(t,e,e.replay.slots,n,r):(e.node=n,e.childIndex=r,n=e.componentStack,RT(e),_9(t,e),e.componentStack=n)}function _9(t,e){var n=e.node,r=e.childIndex;if(n!==null){if(typeof n==\"object\"){switch(n.$$typeof){case Ale:var i=n.type,o=n.key,s=n.props;n=s.ref;var c=n!==void 0?n:null,d=UR(i),m=o??(r===-1?0:r);if(o=[e.keyPath,d,m],e.replay!==null)e:{var b=e.replay;for(r=b.nodes,n=0;n<r.length;n++){var C=r[n];if(m===C[1]){if(C.length===4){if(d!==null&&d!==C[0])throw Error(Dn(490,C[0],d));var B=C[2];d=C[3],m=e.node,e.replay={nodes:B,slots:d,pendingTasks:1};try{if(jR(t,e,o,i,s,c),e.replay.pendingTasks===1&&0<e.replay.nodes.length)throw Error(Dn(488));e.replay.pendingTasks--}catch(Ee){if(typeof Ee==\"object\"&&Ee!==null&&(Ee===fu||typeof Ee.then==\"function\"))throw e.node===m?e.replay=b:r.splice(n,1),Ee;e.replay.pendingTasks--,s=ag(e.componentStack),o=t,t=e.blockedBoundary,i=Ee,s=bl(o,i,s),FT(o,t,B,d,i,s)}e.replay=b}else{if(i!==qR)throw Error(Dn(490,\"Suspense\",UR(i)||\"Unknown\"));t:{b=void 0,i=C[5],c=C[2],d=C[3],m=C[4]===null?[]:C[4][2],C=C[4]===null?null:C[4][3];var k=e.keyPath,V=e.formatContext,q=e.row,K=e.replay,Y=e.blockedBoundary,ee=e.hoistableState,J=s.children,se=s.fallback,xe=new Set;s=B9(t,e.row,xe,null,null),s.parentFlushed=!0,s.rootSegmentID=i,e.blockedBoundary=s,e.hoistableState=s.contentState,e.keyPath=o,e.formatContext=IR(t.resumableState,V),e.row=null,e.replay={nodes:c,slots:d,pendingTasks:1};try{if(Ca(t,e,J,-1),e.replay.pendingTasks===1&&0<e.replay.nodes.length)throw Error(Dn(488));if(e.replay.pendingTasks--,s.pendingTasks===0&&s.status===0){s.status=1,t.completedBoundaries.push(s);break t}}catch(Ee){s.status=4,B=ag(e.componentStack),b=bl(t,Ee,B),s.errorDigest=b,e.replay.pendingTasks--,t.clientRenderedBoundaries.push(s)}finally{e.blockedBoundary=Y,e.hoistableState=ee,e.replay=K,e.keyPath=k,e.formatContext=V,e.row=q}B=Gle(t,null,{nodes:m,slots:C,pendingTasks:0},se,-1,Y,s.fallbackState,xe,[o[0],\"Suspense Fallback\",o[2]],u9(t.resumableState,e.formatContext),e.context,e.treeContext,e.row,g9(e.componentStack)),RT(B),t.pingedTasks.push(B)}}r.splice(n,1);break e}}}else jR(t,e,o,i,s,c);return;case gle:throw Error(Dn(257));case QR:if(B=n._init,n=B(n._payload),t.status===12)throw null;lh(t,e,n,r);return}if(FR(n)){y9(t,e,n,r);return}if((B=ble(n))&&(B=B.call(n))){if(n=B.next(),!n.done){s=[];do s.push(n.value),n=B.next();while(!n.done);y9(t,e,s,r)}return}if(typeof n.then==\"function\")return e.thenableState=null,lh(t,e,zle(n),r);if(n.$$typeof===ZR)return lh(t,e,n._currentValue2,r);throw r=Object.prototype.toString.call(n),Error(Dn(31,r===\"[object Object]\"?\"object with keys {\"+Object.keys(n).join(\", \")+\"}\":r))}typeof n==\"string\"?(r=e.blockedSegment,r!==null&&(r.lastPushedText=$ae(r.chunks,n,t.renderState,r.lastPushedText))):(typeof n==\"number\"||typeof n==\"bigint\")&&(r=e.blockedSegment,r!==null&&(r.lastPushedText=$ae(r.chunks,\"\"+n,t.renderState,r.lastPushedText)))}}function y9(t,e,n,r){var i=e.keyPath;if(r!==-1&&(e.keyPath=[e.keyPath,\"Fragment\",r],e.replay!==null)){for(var o=e.replay,s=o.nodes,c=0;c<s.length;c++){var d=s[c];if(d[1]===r){r=d[2],d=d[3],e.replay={nodes:r,slots:d,pendingTasks:1};try{if(y9(t,e,n,-1),e.replay.pendingTasks===1&&0<e.replay.nodes.length)throw Error(Dn(488));e.replay.pendingTasks--}catch(C){if(typeof C==\"object\"&&C!==null&&(C===fu||typeof C.then==\"function\"))throw C;e.replay.pendingTasks--,n=ag(e.componentStack);var m=e.blockedBoundary,b=C;n=bl(t,b,n),FT(t,m,r,d,b,n)}e.replay=o,s.splice(c,1);break}}e.keyPath=i;return}if(o=e.treeContext,s=n.length,e.replay!==null&&(c=e.replay.slots,c!==null&&typeof c==\"object\")){for(r=0;r<s;r++)d=n[r],e.treeContext=v_(o,s,r),m=c[r],typeof m==\"number\"?($R(t,e,m,d,r),delete c[r]):Ca(t,e,d,r);e.treeContext=o,e.keyPath=i;return}for(c=0;c<s;c++)r=n[c],e.treeContext=v_(o,s,c),Ca(t,e,r,c);e.treeContext=o,e.keyPath=i}function Hle(t,e,n){if(n.status=5,n.rootSegmentID=t.nextSegmentId++,t=n.trackedContentKeyPath,t===null)throw Error(Dn(486));var r=n.trackedFallbackNode,i=[],o=e.workingMap.get(t);return o===void 0?(n=[t[1],t[2],i,null,r,n.rootSegmentID],e.workingMap.set(t,n),YR(n,t[0],e),n):(o[4]=r,o[5]=n.rootSegmentID,o)}function x9(t,e,n,r){r.status=5;var i=n.keyPath,o=n.blockedBoundary;if(o===null)r.id=t.nextSegmentId++,e.rootSlots=r.id,t.completedRootSegment!==null&&(t.completedRootSegment.status=5);else{if(o!==null&&o.status===0){var s=Hle(t,e,o);if(o.trackedContentKeyPath===i&&n.childIndex===-1){r.id===-1&&(r.id=r.parentFlushed?o.rootSegmentID:t.nextSegmentId++),s[3]=r.id;return}}if(r.id===-1&&(r.id=r.parentFlushed&&o!==null?o.rootSegmentID:t.nextSegmentId++),n.childIndex===-1)i===null?e.rootSlots=r.id:(n=e.workingMap.get(i),n===void 0?(n=[i[1],i[2],[],r.id],YR(n,i[0],e)):n[3]=r.id);else{if(i===null){if(t=e.rootSlots,t===null)t=e.rootSlots={};else if(typeof t==\"number\")throw Error(Dn(491))}else if(o=e.workingMap,s=o.get(i),s===void 0)t={},s=[i[1],i[2],[],t],o.set(i,s),YR(s,i[0],e);else if(t=s[3],t===null)t=s[3]={};else if(typeof t==\"number\")throw Error(Dn(491));t[n.childIndex]=r.id}}}function L9(t,e){t=t.trackedPostpones,t!==null&&(e=e.trackedContentKeyPath,e!==null&&(e=t.workingMap.get(e),e!==void 0&&(e.length=4,e[2]=[],e[3]=null)))}function hle(t,e,n){return Gle(t,n,e.replay,e.node,e.childIndex,e.blockedBoundary,e.hoistableState,e.abortSet,e.keyPath,e.formatContext,e.context,e.treeContext,e.row,e.componentStack)}function fle(t,e,n){var r=e.blockedSegment,i=w_(t,r.chunks.length,null,e.formatContext,r.lastPushedText,!0);return r.children.push(i),r.lastPushedText=!1,WR(t,n,e.node,e.childIndex,e.blockedBoundary,i,e.blockedPreamble,e.hoistableState,e.abortSet,e.keyPath,e.formatContext,e.context,e.treeContext,e.row,e.componentStack)}function Ca(t,e,n,r){var i=e.formatContext,o=e.context,s=e.keyPath,c=e.treeContext,d=e.componentStack,m=e.blockedSegment;if(m===null){m=e.replay;try{return lh(t,e,n,r)}catch(B){if(PT(),n=B===fu?VR():B,t.status!==12&&typeof n==\"object\"&&n!==null){if(typeof n.then==\"function\"){r=B===fu?nx():null,t=hle(t,e,r).ping,n.then(t,t),e.formatContext=i,e.context=o,e.keyPath=s,e.treeContext=c,e.componentStack=d,e.replay=m,ig(o);return}if(n.message===\"Maximum call stack size exceeded\"){n=B===fu?nx():null,n=hle(t,e,n),t.pingedTasks.push(n),e.formatContext=i,e.context=o,e.keyPath=s,e.treeContext=c,e.componentStack=d,e.replay=m,ig(o);return}}}}else{var b=m.children.length,C=m.chunks.length;try{return lh(t,e,n,r)}catch(B){if(PT(),m.children.length=b,m.chunks.length=C,n=B===fu?VR():B,t.status!==12&&typeof n==\"object\"&&n!==null){if(typeof n.then==\"function\"){m=n,n=B===fu?nx():null,t=fle(t,e,n).ping,m.then(t,t),e.formatContext=i,e.context=o,e.keyPath=s,e.treeContext=c,e.componentStack=d,ig(o);return}if(n.message===\"Maximum call stack size exceeded\"){m=B===fu?nx():null,m=fle(t,e,m),t.pingedTasks.push(m),e.formatContext=i,e.context=o,e.keyPath=s,e.treeContext=c,e.componentStack=d,ig(o);return}}}}throw e.formatContext=i,e.context=o,e.keyPath=s,e.treeContext=c,ig(o),n}function WBe(t){var e=t.blockedBoundary,n=t.blockedSegment;n!==null&&(n.status=3,lg(this,e,t.row,n))}function FT(t,e,n,r,i,o){for(var s=0;s<n.length;s++){var c=n[s];if(c.length===4)FT(t,e,c[2],c[3],i,o);else{c=c[5];var d=t,m=o,b=B9(d,null,new Set,null,null);b.parentFlushed=!0,b.rootSegmentID=c,b.status=4,b.errorDigest=m,b.parentFlushed&&d.clientRenderedBoundaries.push(b)}}if(n.length=0,r!==null){if(e===null)throw Error(Dn(487));if(e.status!==4&&(e.status=4,e.errorDigest=o,e.parentFlushed&&t.clientRenderedBoundaries.push(e)),typeof r==\"object\")for(var C in r)delete r[C]}}function v9(t,e,n){var r=t.blockedBoundary,i=t.blockedSegment;if(i!==null){if(i.status===6)return;i.status=3}var o=ag(t.componentStack);if(r===null){if(e.status!==13&&e.status!==14){if(r=t.replay,r===null){e.trackedPostpones!==null&&i!==null?(r=e.trackedPostpones,bl(e,n,o),x9(e,r,t,i),lg(e,null,t.row,i)):(bl(e,n,o),BT(e,n));return}r.pendingTasks--,r.pendingTasks===0&&0<r.nodes.length&&(i=bl(e,n,o),FT(e,null,r.nodes,r.slots,n,i)),e.pendingRootTasks--,e.pendingRootTasks===0&&F9(e)}}else{var s=e.trackedPostpones;if(r.status!==4){if(s!==null&&i!==null)return bl(e,n,o),x9(e,s,t,i),r.fallbackAbortableTasks.forEach(function(c){return v9(c,e,n)}),r.fallbackAbortableTasks.clear(),lg(e,r,t.row,i);r.status=4,i=bl(e,n,o),r.status=4,r.errorDigest=i,L9(e,r),r.parentFlushed&&e.clientRenderedBoundaries.push(r)}r.pendingTasks--,i=r.row,i!==null&&--i.pendingTasks===0&&wl(e,i),r.fallbackAbortableTasks.forEach(function(c){return v9(c,e,n)}),r.fallbackAbortableTasks.clear()}t=t.row,t!==null&&--t.pendingTasks===0&&wl(e,t),e.allPendingTasks--,e.allPendingTasks===0&&XR(e)}function O9(t,e){try{var n=t.renderState,r=n.onHeaders;if(r){var i=n.headers;if(i){n.headers=null;var o=i.preconnects;if(i.fontPreloads&&(o&&(o+=\", \"),o+=i.fontPreloads),i.highImagePreloads&&(o&&(o+=\", \"),o+=i.highImagePreloads),!e){var s=n.styles.values(),c=s.next();e:for(;0<i.remainingCapacity&&!c.done;c=s.next())for(var d=c.value.sheets.values(),m=d.next();0<i.remainingCapacity&&!m.done;m=d.next()){var b=m.value,C=b.props,B=C.href,k=b.props,V=zR(k.href,\"style\",{crossOrigin:k.crossOrigin,integrity:k.integrity,nonce:k.nonce,type:k.type,fetchPriority:k.fetchPriority,referrerPolicy:k.referrerPolicy,media:k.media});if(0<=(i.remainingCapacity-=V.length+2))n.resets.style[B]=ah,o&&(o+=\", \"),o+=V,n.resets.style[B]=typeof C.crossOrigin==\"string\"||typeof C.integrity==\"string\"?[C.crossOrigin,C.integrity]:ah;else break e}}r(o?{Link:o}:{})}}}catch(q){bl(t,q,{})}}function F9(t){t.trackedPostpones===null&&O9(t,!0),t.trackedPostpones===null&&kT(t),t.onShellError=nc,t=t.onShellReady,t()}function XR(t){O9(t,t.trackedPostpones===null?!0:t.completedRootSegment===null||t.completedRootSegment.status!==5),kT(t),t=t.onAllReady,t()}function DT(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null&&e.children[0].id===-1){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status!==1&&n.status!==3&&n.status!==4||DT(t,n)}else t.completedSegments.push(e)}function lg(t,e,n,r){if(n!==null&&(--n.pendingTasks===0?wl(t,n):n.together&&m9(t,n)),t.allPendingTasks--,e===null){if(r!==null&&r.parentFlushed){if(t.completedRootSegment!==null)throw Error(Dn(389));t.completedRootSegment=r}t.pendingRootTasks--,t.pendingRootTasks===0&&F9(t)}else if(e.pendingTasks--,e.status!==4)if(e.pendingTasks===0){if(e.status===0&&(e.status=1),r!==null&&r.parentFlushed&&(r.status===1||r.status===3)&&DT(e,r),e.parentFlushed&&t.completedBoundaries.push(e),e.status===1)n=e.row,n!==null&&ox(n.hoistables,e.contentState),sx(t,e)||(e.fallbackAbortableTasks.forEach(WBe,t),e.fallbackAbortableTasks.clear(),n!==null&&--n.pendingTasks===0&&wl(t,n)),t.pendingRootTasks===0&&t.trackedPostpones===null&&e.contentPreamble!==null&&kT(t);else if(e.status===5&&(e=e.row,e!==null)){if(t.trackedPostpones!==null){n=t.trackedPostpones;var i=e.next;if(i!==null&&(r=i.boundaries,r!==null))for(i.boundaries=null,i=0;i<r.length;i++){var o=r[i];Hle(t,n,o),lg(t,o,null,null)}}--e.pendingTasks===0&&wl(t,e)}}else r===null||!r.parentFlushed||r.status!==1&&r.status!==3||(DT(e,r),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)),e=e.row,e!==null&&e.together&&m9(t,e);t.allPendingTasks===0&&XR(t)}function Wle(t){if(t.status!==14&&t.status!==13){var e=x_,n=$2.H;$2.H=sle;var r=$2.A;$2.A=UBe;var i=Qa;Qa=t;var o=LR;LR=t.resumableState;try{var s=t.pingedTasks,c;for(c=0;c<s.length;c++){var d=s[c],m=t,b=d.blockedSegment;if(b===null){var C=m;if(d.replay.pendingTasks!==0){ig(d.context);try{if(typeof d.replay.slots==\"number\"?$R(C,d,d.replay.slots,d.node,d.childIndex):_9(C,d),d.replay.pendingTasks===1&&0<d.replay.nodes.length)throw Error(Dn(488));d.replay.pendingTasks--,d.abortSet.delete(d),lg(C,d.blockedBoundary,d.row,null)}catch(mt){PT();var B=mt===fu?VR():mt;if(typeof B==\"object\"&&B!==null&&typeof B.then==\"function\"){var k=d.ping;B.then(k,k),d.thenableState=mt===fu?nx():null}else{d.replay.pendingTasks--,d.abortSet.delete(d);var V=ag(d.componentStack);m=void 0;var q=C,K=d.blockedBoundary,Y=C.status===12?C.fatalError:B,ee=d.replay.nodes,J=d.replay.slots;m=bl(q,Y,V),FT(q,K,ee,J,Y,m),C.pendingRootTasks--,C.pendingRootTasks===0&&F9(C),C.allPendingTasks--,C.allPendingTasks===0&&XR(C)}}finally{}}}else if(C=void 0,q=b,q.status===0){q.status=6,ig(d.context);var se=q.children.length,xe=q.chunks.length;try{_9(m,d),TT(q.chunks,m.renderState,q.lastPushedText,q.textEmbedded),d.abortSet.delete(d),q.status=1,lg(m,d.blockedBoundary,d.row,q)}catch(mt){PT(),q.children.length=se,q.chunks.length=xe;var Ee=mt===fu?VR():m.status===12?m.fatalError:mt;if(m.status===12&&m.trackedPostpones!==null){var Xe=m.trackedPostpones,Ne=ag(d.componentStack);d.abortSet.delete(d),bl(m,Ee,Ne),x9(m,Xe,d,q),lg(m,d.blockedBoundary,d.row,q)}else if(typeof Ee==\"object\"&&Ee!==null&&typeof Ee.then==\"function\"){q.status=0,d.thenableState=mt===fu?nx():null;var be=d.ping;Ee.then(be,be)}else{var ge=ag(d.componentStack);d.abortSet.delete(d),q.status=4;var Qe=d.blockedBoundary,Ct=d.row;if(Ct!==null&&--Ct.pendingTasks===0&&wl(m,Ct),m.allPendingTasks--,C=bl(m,Ee,ge),Qe===null)BT(m,Ee);else if(Qe.pendingTasks--,Qe.status!==4){Qe.status=4,Qe.errorDigest=C,L9(m,Qe);var Mt=Qe.row;Mt!==null&&--Mt.pendingTasks===0&&wl(m,Mt),Qe.parentFlushed&&m.clientRenderedBoundaries.push(Qe),m.pendingRootTasks===0&&m.trackedPostpones===null&&Qe.contentPreamble!==null&&kT(m)}m.allPendingTasks===0&&XR(m)}}finally{}}}s.splice(0,c),t.destination!==null&&e5(t,t.destination)}catch(mt){bl(t,mt,{}),BT(t,mt)}finally{LR=o,$2.H=n,$2.A=r,n===sle&&ig(e),Qa=i}}}function l9(t,e,n){e.preambleChildren.length&&n.push(e.preambleChildren);for(var r=!1,i=0;i<e.children.length;i++)r=jle(t,e.children[i],n)||r;return r}function jle(t,e,n){var r=e.boundary;if(r===null)return l9(t,e,n);var i=r.contentPreamble,o=r.fallbackPreamble;if(i===null||o===null)return!1;switch(r.status){case 1:if(Kae(t.renderState,i),t.byteSize+=r.byteSize,e=r.completedSegments[0],!e)throw Error(Dn(391));return l9(t,e,n);case 5:if(t.trackedPostpones!==null)return!0;case 4:if(e.status===1)return Kae(t.renderState,o),l9(t,e,n);default:return!0}}function kT(t){if(t.completedRootSegment&&t.completedPreambleSegments===null){var e=[],n=t.byteSize,r=jle(t,t.completedRootSegment,e),i=t.renderState.preamble;r===!1||i.headChunks&&i.bodyChunks?t.completedPreambleSegments=e:t.byteSize=n}}function MR(t,e,n,r){switch(n.parentFlushed=!0,n.status){case 0:n.id=t.nextSegmentId++;case 5:return r=n.id,n.lastPushedText=!1,n.textEmbedded=!1,t=t.renderState,e.push('<template id=\"'),e.push(t.placeholderPrefix),t=r.toString(16),e.push(t),e.push('\"></template>');case 1:n.status=2;var i=!0,o=n.chunks,s=0;n=n.children;for(var c=0;c<n.length;c++){for(i=n[c];s<i.index;s++)e.push(o[s]);i=OT(t,e,i,r)}for(;s<o.length-1;s++)e.push(o[s]);return s<o.length&&(i=e.push(o[s])),i;case 3:return!0;default:throw Error(Dn(390))}}var LT=0;function OT(t,e,n,r){var i=n.boundary;if(i===null)return MR(t,e,n,r);if(i.parentFlushed=!0,i.status===4){var o=i.row;return o!==null&&--o.pendingTasks===0&&wl(t,o),t.renderState.generateStaticMarkup||(i=i.errorDigest,e.push(\"<!--$!-->\"),e.push(\"<template\"),i&&(e.push(' data-dgst=\"'),i=Hr(i),e.push(i),e.push('\"')),e.push(\"></template>\")),MR(t,e,n,r),t=t.renderState.generateStaticMarkup?!0:e.push(\"<!--/$-->\"),t}if(i.status!==1)return i.status===0&&(i.rootSegmentID=t.nextSegmentId++),0<i.completedSegments.length&&t.partialBoundaries.push(i),Jae(e,t.renderState,i.rootSegmentID),r&&ox(r,i.fallbackState),MR(t,e,n,r),e.push(\"<!--/$-->\");if(!OR&&sx(t,i)&&LT+i.byteSize>t.progressiveChunkSize)return i.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(i),Jae(e,t.renderState,i.rootSegmentID),MR(t,e,n,r),e.push(\"<!--/$-->\");if(LT+=i.byteSize,r&&ox(r,i.contentState),n=i.row,n!==null&&sx(t,i)&&--n.pendingTasks===0&&wl(t,n),t.renderState.generateStaticMarkup||e.push(\"<!--$-->\"),n=i.completedSegments,n.length!==1)throw Error(Dn(391));return OT(t,e,n[0],r),t=t.renderState.generateStaticMarkup?!0:e.push(\"<!--/$-->\"),t}function c9(t,e,n,r){return rBe(e,t.renderState,n.parentFormatContext,n.id),OT(t,e,n,r),iBe(e,n.parentFormatContext)}function dle(t,e,n){LT=n.byteSize;for(var r=n.completedSegments,i=0;i<r.length;i++)Xle(t,e,n,r[i]);r.length=0,r=n.row,r!==null&&sx(t,n)&&--r.pendingTasks===0&&wl(t,r),Dle(e,n.contentState,t.renderState),r=t.resumableState,t=t.renderState,i=n.rootSegmentID,n=n.contentState;var o=t.stylesToHoist;return t.stylesToHoist=!1,e.push(t.startInlineScript),e.push(\">\"),o?((r.instructions&4)===0&&(r.instructions|=4,e.push('$RX=function(b,c,d,e,f){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data=\"$!\",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),f&&(a.cstck=f),b._reactRetry&&b._reactRetry())};')),(r.instructions&2)===0&&(r.instructions|=2,e.push(`$RB=[];$RV=function(a){$RT=performance.now();for(var b=0;b<a.length;b+=2){var c=a[b],e=a[b+1];null!==e.parentNode&&e.parentNode.removeChild(e);var f=c.parentNode;if(f){var g=c.previousSibling,h=0;do{if(c&&8===c.nodeType){var d=c.data;if(\"/$\"===d||\"/&\"===d)if(0===h)break;else h--;else\"$\"!==d&&\"$?\"!==d&&\"$~\"!==d&&\"$!\"!==d&&\"&\"!==d||h++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;e.firstChild;)f.insertBefore(e.firstChild,c);g.data=\"$\";g._reactRetry&&requestAnimationFrame(g._reactRetry)}}a.length=0};\n$RC=function(a,b){if(b=document.getElementById(b))(a=document.getElementById(a))?(a.previousSibling.data=\"$~\",$RB.push(a,b),2===$RB.length&&(\"number\"!==typeof $RT?requestAnimationFrame($RV.bind(null,$RB)):(a=performance.now(),setTimeout($RV.bind(null,$RB),2300>a&&2E3<a?2300-a:$RT+300-a)))):b.parentNode.removeChild(b)};`)),(r.instructions&8)===0?(r.instructions|=8,e.push(`$RM=new Map;$RR=function(n,w,p){function u(q){this._p=null;q()}for(var r=new Map,t=document,h,b,e=t.querySelectorAll(\"link[data-precedence],style[data-precedence]\"),v=[],k=0;b=e[k++];)\"not all\"===b.getAttribute(\"media\")?v.push(b):(\"LINK\"===b.tagName&&$RM.set(b.getAttribute(\"href\"),b),r.set(b.dataset.precedence,h=b));e=0;b=[];var l,a;for(k=!0;;){if(k){var f=p[e++];if(!f){k=!1;e=0;continue}var c=!1,m=0;var d=f[m++];if(a=$RM.get(d)){var g=a._p;c=!0}else{a=t.createElement(\"link\");a.href=d;a.rel=\n\"stylesheet\";for(a.dataset.precedence=l=f[m++];g=f[m++];)a.setAttribute(g,f[m++]);g=a._p=new Promise(function(q,x){a.onload=u.bind(a,q);a.onerror=u.bind(a,x)});$RM.set(d,a)}d=a.getAttribute(\"media\");!g||d&&!matchMedia(d).matches||b.push(g);if(c)continue}else{a=v[e++];if(!a)break;l=a.getAttribute(\"data-precedence\");a.removeAttribute(\"media\")}c=r.get(l)||h;c===h&&(h=a);r.set(l,a);c?c.parentNode.insertBefore(a,c.nextSibling):(c=t.head,c.insertBefore(a,c.firstChild))}if(p=document.getElementById(n))p.previousSibling.data=\n\"$~\";Promise.all(b).then($RC.bind(null,n,w),$RX.bind(null,n,\"CSS failed to load\"))};$RR(\"`)):e.push('$RR(\"')):((r.instructions&2)===0&&(r.instructions|=2,e.push(`$RB=[];$RV=function(a){$RT=performance.now();for(var b=0;b<a.length;b+=2){var c=a[b],e=a[b+1];null!==e.parentNode&&e.parentNode.removeChild(e);var f=c.parentNode;if(f){var g=c.previousSibling,h=0;do{if(c&&8===c.nodeType){var d=c.data;if(\"/$\"===d||\"/&\"===d)if(0===h)break;else h--;else\"$\"!==d&&\"$?\"!==d&&\"$~\"!==d&&\"$!\"!==d&&\"&\"!==d||h++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;e.firstChild;)f.insertBefore(e.firstChild,c);g.data=\"$\";g._reactRetry&&requestAnimationFrame(g._reactRetry)}}a.length=0};\n$RC=function(a,b){if(b=document.getElementById(b))(a=document.getElementById(a))?(a.previousSibling.data=\"$~\",$RB.push(a,b),2===$RB.length&&(\"number\"!==typeof $RT?requestAnimationFrame($RV.bind(null,$RB)):(a=performance.now(),setTimeout($RV.bind(null,$RB),2300>a&&2E3<a?2300-a:$RT+300-a)))):b.parentNode.removeChild(b)};`)),e.push('$RC(\"')),r=i.toString(16),e.push(t.boundaryPrefix),e.push(r),e.push('\",\"'),e.push(t.segmentPrefix),e.push(r),o?(e.push('\",'),pBe(e,n)):e.push('\"'),n=e.push(\")<\\/script>\"),Ble(e,t)&&n}function Xle(t,e,n,r){if(r.status===2)return!0;var i=n.contentState,o=r.id;if(o===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Dn(392));return c9(t,e,r,i)}return o===n.rootSegmentID?c9(t,e,r,i):(c9(t,e,r,i),n=t.resumableState,t=t.renderState,e.push(t.startInlineScript),e.push(\">\"),(n.instructions&1)===0?(n.instructions|=1,e.push('$RS=function(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS(\"')):e.push('$RS(\"'),e.push(t.segmentPrefix),o=o.toString(16),e.push(o),e.push('\",\"'),e.push(t.placeholderPrefix),e.push(o),e=e.push('\")<\\/script>'),e)}var OR=!1;function e5(t,e){try{if(!(0<t.pendingRootTasks)){var n,r=t.completedRootSegment;if(r!==null){if(r.status===5)return;var i=t.completedPreambleSegments;if(i===null)return;LT=t.byteSize;var o=t.resumableState,s=t.renderState,c=s.preamble,d=c.htmlChunks,m=c.headChunks,b;if(d){for(b=0;b<d.length;b++)e.push(d[b]);if(m)for(b=0;b<m.length;b++)e.push(m[b]);else{var C=na(\"head\");e.push(C),e.push(\">\")}}else if(m)for(b=0;b<m.length;b++)e.push(m[b]);var B=s.charsetChunks;for(b=0;b<B.length;b++)e.push(B[b]);B.length=0,s.preconnects.forEach(uf,e),s.preconnects.clear();var k=s.viewportChunks;for(b=0;b<k.length;b++)e.push(k[b]);k.length=0,s.fontPreloads.forEach(uf,e),s.fontPreloads.clear(),s.highImagePreloads.forEach(uf,e),s.highImagePreloads.clear(),ix=s,s.styles.forEach(hBe,e),ix=null;var V=s.importMapChunks;for(b=0;b<V.length;b++)e.push(V[b]);V.length=0,s.bootstrapScripts.forEach(uf,e),s.scripts.forEach(uf,e),s.scripts.clear(),s.bulkPreloads.forEach(uf,e),s.bulkPreloads.clear(),o.instructions|=32;var q=s.hoistableChunks;for(b=0;b<q.length;b++)e.push(q[b]);for(o=q.length=0;o<i.length;o++){var K=i[o];for(s=0;s<K.length;s++)OT(t,e,K[s],null)}var Y=t.renderState.preamble,ee=Y.headChunks;if(Y.htmlChunks||ee){var J=b_(\"head\");e.push(J)}var se=Y.bodyChunks;if(se)for(i=0;i<se.length;i++)e.push(se[i]);OT(t,e,r,null),t.completedRootSegment=null;var xe=t.renderState;if(t.allPendingTasks!==0||t.clientRenderedBoundaries.length!==0||t.completedBoundaries.length!==0||t.trackedPostpones!==null&&(t.trackedPostpones.rootNodes.length!==0||t.trackedPostpones.rootSlots!==null)){var Ee=t.resumableState;if((Ee.instructions&64)===0){if(Ee.instructions|=64,e.push(xe.startInlineScript),(Ee.instructions&32)===0){Ee.instructions|=32;var Xe=\"_\"+Ee.idPrefix+\"R_\";e.push(' id=\"');var Ne=Hr(Xe);e.push(Ne),e.push('\"')}e.push(\">\"),e.push(\"requestAnimationFrame(function(){$RT=performance.now()});\"),e.push(\"<\\/script>\")}}Ble(e,xe)}var be=t.renderState;r=0;var ge=be.viewportChunks;for(r=0;r<ge.length;r++)e.push(ge[r]);ge.length=0,be.preconnects.forEach(uf,e),be.preconnects.clear(),be.fontPreloads.forEach(uf,e),be.fontPreloads.clear(),be.highImagePreloads.forEach(uf,e),be.highImagePreloads.clear(),be.styles.forEach(dBe,e),be.scripts.forEach(uf,e),be.scripts.clear(),be.bulkPreloads.forEach(uf,e),be.bulkPreloads.clear();var Qe=be.hoistableChunks;for(r=0;r<Qe.length;r++)e.push(Qe[r]);Qe.length=0;var Ct=t.clientRenderedBoundaries;for(n=0;n<Ct.length;n++){var Mt=Ct[n];be=e;var mt=t.resumableState,jt=t.renderState,Mn=Mt.rootSegmentID,rn=Mt.errorDigest;be.push(jt.startInlineScript),be.push(\">\"),(mt.instructions&4)===0?(mt.instructions|=4,be.push('$RX=function(b,c,d,e,f){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data=\"$!\",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),f&&(a.cstck=f),b._reactRetry&&b._reactRetry())};;$RX(\"')):be.push('$RX(\"'),be.push(jt.boundaryPrefix);var In=Mn.toString(16);if(be.push(In),be.push('\"'),rn){be.push(\",\");var On=sBe(rn||\"\");be.push(On)}var Pn=be.push(\")<\\/script>\");if(!Pn){t.destination=null,n++,Ct.splice(0,n);return}}Ct.splice(0,n);var _n=t.completedBoundaries;for(n=0;n<_n.length;n++)if(!dle(t,e,_n[n])){t.destination=null,n++,_n.splice(0,n);return}_n.splice(0,n),OR=!0;var tr=t.partialBoundaries;for(n=0;n<tr.length;n++){var on=tr[n];e:{Ct=t,Mt=e,LT=on.byteSize;var Pt=on.completedSegments;for(Pn=0;Pn<Pt.length;Pn++)if(!Xle(Ct,Mt,on,Pt[Pn])){Pn++,Pt.splice(0,Pn);var Mr=!1;break e}Pt.splice(0,Pn);var Fn=on.row;Fn!==null&&Fn.together&&on.pendingTasks===1&&(Fn.pendingTasks===1?D9(Ct,Fn,Fn.hoistables):Fn.pendingTasks--),Mr=Dle(Mt,on.contentState,Ct.renderState)}if(!Mr){t.destination=null,n++,tr.splice(0,n);return}}tr.splice(0,n),OR=!1;var Br=t.completedBoundaries;for(n=0;n<Br.length;n++)if(!dle(t,e,Br[n])){t.destination=null,n++,Br.splice(0,n);return}Br.splice(0,n)}}finally{OR=!1,t.allPendingTasks===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&(t.flushScheduled=!1,n=t.resumableState,n.hasBody&&(tr=b_(\"body\"),e.push(tr)),n.hasHtml&&(n=b_(\"html\"),e.push(n)),t.status=14,e.push(null),t.destination=null)}}function T_(t){if(t.flushScheduled===!1&&t.pingedTasks.length===0&&t.destination!==null){t.flushScheduled=!0;var e=t.destination;e?e5(t,e):t.flushScheduled=!1}}function jBe(t,e){if(t.status===13)t.status=14,e.destroy(t.fatalError);else if(t.status!==14&&t.destination===null){t.destination=e;try{e5(t,e)}catch(n){bl(t,n,{}),BT(t,n)}}}function XBe(t,e){(t.status===11||t.status===10)&&(t.status=12);try{var n=t.abortableTasks;if(0<n.size){var r=e===void 0?Error(Dn(432)):typeof e==\"object\"&&e!==null&&typeof e.then==\"function\"?Error(Dn(530)):e;t.fatalError=r,n.forEach(function(i){return v9(i,t,r)}),n.clear()}t.destination!==null&&e5(t,t.destination)}catch(i){bl(t,i,{}),BT(t,i)}}function YR(t,e,n){if(e===null)n.rootNodes.push(t);else{var r=n.workingMap,i=r.get(e);i===void 0&&(i=[e[1],e[2],[],null],r.set(e,i),YR(i,e[0],n)),i[2].push(t)}}function YBe(){}function Yle(t,e,n,r){var i=!1,o=null,s=\"\",c=!1;if(e=$5e(e?e.identifierPrefix:void 0),t=HBe(t,e,EBe(e,n),qa(0,null,0,null),1/0,YBe,void 0,function(){c=!0},void 0,void 0,void 0),t.flushScheduled=t.destination!==null,Wle(t),t.status===10&&(t.status=11),t.trackedPostpones===null&&O9(t,t.pendingRootTasks===0),XBe(t,r),jBe(t,{push:function(d){return d!==null&&(s+=d),!0},destroy:function(d){i=!0,o=d}}),i&&o!==r)throw o;if(!c)throw Error(Dn(426));return s}t5.renderToStaticMarkup=function(t,e){return Yle(t,e,!0,'The server used \"renderToStaticMarkup\" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to \"renderToReadableStream\" which supports Suspense on the server')};t5.renderToString=function(t,e){return Yle(t,e,!1,'The server used \"renderToString\" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to \"renderToReadableStream\" which supports Suspense on the server')};t5.version=\"19.2.4\"});var wue=Fs(gx=>{\"use strict\";var h7=Jr(),ZBe=Jg();function Ln(t){var e=\"https://react.dev/errors/\"+t;if(1<arguments.length){e+=\"?args[]=\"+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+=\"&args[]=\"+encodeURIComponent(arguments[n])}return\"Minified React error #\"+t+\"; visit \"+e+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var Dce=Symbol.for(\"react.transitional.element\"),Lce=Symbol.for(\"react.portal\"),Oce=Symbol.for(\"react.fragment\"),Fce=Symbol.for(\"react.strict_mode\"),kce=Symbol.for(\"react.profiler\"),Nce=Symbol.for(\"react.consumer\"),T5=Symbol.for(\"react.context\"),f7=Symbol.for(\"react.forward_ref\"),E5=Symbol.for(\"react.suspense\"),d7=Symbol.for(\"react.suspense_list\"),p7=Symbol.for(\"react.memo\"),S5=Symbol.for(\"react.lazy\"),qBe=Symbol.for(\"react.scope\"),zce=Symbol.for(\"react.activity\"),QBe=Symbol.for(\"react.legacy_hidden\"),KBe=Symbol.for(\"react.memo_cache_sentinel\"),JBe=Symbol.for(\"react.view_transition\"),qle=Symbol.iterator;function Uce(t){return t===null||typeof t!=\"object\"?null:(t=qle&&t[qle]||t[\"@@iterator\"],typeof t==\"function\"?t:null)}var f5=Array.isArray;function Qle(t,e){var n=t.length&3,r=t.length-n,i=e;for(e=0;e<r;){var o=t.charCodeAt(e)&255|(t.charCodeAt(++e)&255)<<8|(t.charCodeAt(++e)&255)<<16|(t.charCodeAt(++e)&255)<<24;++e,o=3432918353*(o&65535)+((3432918353*(o>>>16)&65535)<<16)&4294967295,o=o<<15|o>>>17,o=461845907*(o&65535)+((461845907*(o>>>16)&65535)<<16)&4294967295,i^=o,i=i<<13|i>>>19,i=5*(i&65535)+((5*(i>>>16)&65535)<<16)&4294967295,i=(i&65535)+27492+(((i>>>16)+58964&65535)<<16)}switch(o=0,n){case 3:o^=(t.charCodeAt(e+2)&255)<<16;case 2:o^=(t.charCodeAt(e+1)&255)<<8;case 1:o^=t.charCodeAt(e)&255,o=3432918353*(o&65535)+((3432918353*(o>>>16)&65535)<<16)&4294967295,o=o<<15|o>>>17,i^=461845907*(o&65535)+((461845907*(o>>>16)&65535)<<16)&4294967295}return i^=t.length,i^=i>>>16,i=2246822507*(i&65535)+((2246822507*(i>>>16)&65535)<<16)&4294967295,i^=i>>>13,i=3266489909*(i&65535)+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^i>>>16)>>>0}var Vce=new MessageChannel,Gce=[];Vce.port1.onmessage=function(){var t=Gce.shift();t&&t()};function A7(t){Gce.push(t),Vce.port2.postMessage(null)}function $Be(t){setTimeout(function(){throw t})}var e6e=Promise,Hce=typeof queueMicrotask==\"function\"?queueMicrotask:function(t){e6e.resolve(null).then(t).catch($Be)},pu=null,Au=0;function Ft(t,e){if(e.byteLength!==0)if(2048<e.byteLength)0<Au&&(t.enqueue(new Uint8Array(pu.buffer,0,Au)),pu=new Uint8Array(2048),Au=0),t.enqueue(e);else{var n=pu.length-Au;n<e.byteLength&&(n===0?t.enqueue(pu):(pu.set(e.subarray(0,n),Au),t.enqueue(pu),e=e.subarray(n)),pu=new Uint8Array(2048),Au=0),pu.set(e,Au),Au+=e.byteLength}}function ao(t,e){return Ft(t,e),!0}function k9(t){pu&&0<Au&&(t.enqueue(new Uint8Array(pu.buffer,0,Au)),pu=null,Au=0)}var Wce=new TextEncoder;function gn(t){return Wce.encode(t)}function kt(t){return Wce.encode(t)}function t6e(t){return t.byteLength}function jce(t,e){typeof t.error==\"function\"?t.error(e):t.close()}var Ic=Object.assign,Uo=Object.prototype.hasOwnProperty,n6e=RegExp(\"^[:A-Z_a-z\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD][:A-Z_a-z\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD\\\\-.0-9\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040]*$\"),Kle={},Jle={};function g7(t){return Uo.call(Jle,t)?!0:Uo.call(Kle,t)?!1:n6e.test(t)?Jle[t]=!0:(Kle[t]=!0,!1)}var r6e=new Set(\"animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp\".split(\" \")),i6e=new Map([[\"acceptCharset\",\"accept-charset\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"],[\"crossOrigin\",\"crossorigin\"],[\"accentHeight\",\"accent-height\"],[\"alignmentBaseline\",\"alignment-baseline\"],[\"arabicForm\",\"arabic-form\"],[\"baselineShift\",\"baseline-shift\"],[\"capHeight\",\"cap-height\"],[\"clipPath\",\"clip-path\"],[\"clipRule\",\"clip-rule\"],[\"colorInterpolation\",\"color-interpolation\"],[\"colorInterpolationFilters\",\"color-interpolation-filters\"],[\"colorProfile\",\"color-profile\"],[\"colorRendering\",\"color-rendering\"],[\"dominantBaseline\",\"dominant-baseline\"],[\"enableBackground\",\"enable-background\"],[\"fillOpacity\",\"fill-opacity\"],[\"fillRule\",\"fill-rule\"],[\"floodColor\",\"flood-color\"],[\"floodOpacity\",\"flood-opacity\"],[\"fontFamily\",\"font-family\"],[\"fontSize\",\"font-size\"],[\"fontSizeAdjust\",\"font-size-adjust\"],[\"fontStretch\",\"font-stretch\"],[\"fontStyle\",\"font-style\"],[\"fontVariant\",\"font-variant\"],[\"fontWeight\",\"font-weight\"],[\"glyphName\",\"glyph-name\"],[\"glyphOrientationHorizontal\",\"glyph-orientation-horizontal\"],[\"glyphOrientationVertical\",\"glyph-orientation-vertical\"],[\"horizAdvX\",\"horiz-adv-x\"],[\"horizOriginX\",\"horiz-origin-x\"],[\"imageRendering\",\"image-rendering\"],[\"letterSpacing\",\"letter-spacing\"],[\"lightingColor\",\"lighting-color\"],[\"markerEnd\",\"marker-end\"],[\"markerMid\",\"marker-mid\"],[\"markerStart\",\"marker-start\"],[\"overlinePosition\",\"overline-position\"],[\"overlineThickness\",\"overline-thickness\"],[\"paintOrder\",\"paint-order\"],[\"panose-1\",\"panose-1\"],[\"pointerEvents\",\"pointer-events\"],[\"renderingIntent\",\"rendering-intent\"],[\"shapeRendering\",\"shape-rendering\"],[\"stopColor\",\"stop-color\"],[\"stopOpacity\",\"stop-opacity\"],[\"strikethroughPosition\",\"strikethrough-position\"],[\"strikethroughThickness\",\"strikethrough-thickness\"],[\"strokeDasharray\",\"stroke-dasharray\"],[\"strokeDashoffset\",\"stroke-dashoffset\"],[\"strokeLinecap\",\"stroke-linecap\"],[\"strokeLinejoin\",\"stroke-linejoin\"],[\"strokeMiterlimit\",\"stroke-miterlimit\"],[\"strokeOpacity\",\"stroke-opacity\"],[\"strokeWidth\",\"stroke-width\"],[\"textAnchor\",\"text-anchor\"],[\"textDecoration\",\"text-decoration\"],[\"textRendering\",\"text-rendering\"],[\"transformOrigin\",\"transform-origin\"],[\"underlinePosition\",\"underline-position\"],[\"underlineThickness\",\"underline-thickness\"],[\"unicodeBidi\",\"unicode-bidi\"],[\"unicodeRange\",\"unicode-range\"],[\"unitsPerEm\",\"units-per-em\"],[\"vAlphabetic\",\"v-alphabetic\"],[\"vHanging\",\"v-hanging\"],[\"vIdeographic\",\"v-ideographic\"],[\"vMathematical\",\"v-mathematical\"],[\"vectorEffect\",\"vector-effect\"],[\"vertAdvY\",\"vert-adv-y\"],[\"vertOriginX\",\"vert-origin-x\"],[\"vertOriginY\",\"vert-origin-y\"],[\"wordSpacing\",\"word-spacing\"],[\"writingMode\",\"writing-mode\"],[\"xmlnsXlink\",\"xmlns:xlink\"],[\"xHeight\",\"x-height\"]]),o6e=/[\"'&<>]/;function Cr(t){if(typeof t==\"boolean\"||typeof t==\"number\"||typeof t==\"bigint\")return\"\"+t;t=\"\"+t;var e=o6e.exec(t);if(e){var n=\"\",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e=\"&quot;\";break;case 38:e=\"&amp;\";break;case 39:e=\"&#x27;\";break;case 60:e=\"&lt;\";break;case 62:e=\"&gt;\";break;default:continue}i!==r&&(n+=t.slice(i,r)),i=r+1,n+=e}t=i!==r?n+t.slice(i,r):n}return t}var s6e=/([A-Z])/g,a6e=/^ms-/,l6e=/^[\\u0000-\\u001F ]*j[\\r\\n\\t]*a[\\r\\n\\t]*v[\\r\\n\\t]*a[\\r\\n\\t]*s[\\r\\n\\t]*c[\\r\\n\\t]*r[\\r\\n\\t]*i[\\r\\n\\t]*p[\\r\\n\\t]*t[\\r\\n\\t]*:/i;function VT(t){return l6e.test(\"\"+t)?\"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')\":t}var ax=h7.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Xce=ZBe.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,c6e={pending:!1,data:null,method:null,action:null},n0=Xce.d;Xce.d={f:n0.f,r:n0.r,D:XDe,C:YDe,L:ZDe,m:qDe,X:KDe,S:QDe,M:JDe};var uh=[],dx=null;kt('\"></template>');var u6e=kt(\"<script\"),d5=kt(\"<\\/script>\"),h6e=kt('<script src=\"'),f6e=kt('<script type=\"module\" src=\"'),$le=kt(' nonce=\"'),ece=kt(' integrity=\"'),tce=kt(' crossorigin=\"'),nce=kt(' async=\"\"><\\/script>'),d6e=kt(\"<style\"),Y9=/(<\\/|<)(s)(cript)/gi;function Z9(t,e,n,r){return\"\"+e+(n===\"s\"?\"\\\\u0073\":\"\\\\u0053\")+r}var p6e=kt('<script type=\"importmap\">'),A6e=kt(\"<\\/script>\");function C5(t,e,n,r,i,o){n=typeof e==\"string\"?e:e&&e.script;var s=n===void 0?u6e:kt('<script nonce=\"'+Cr(n)+'\"'),c=typeof e==\"string\"?void 0:e&&e.style,d=c===void 0?d6e:kt('<style nonce=\"'+Cr(c)+'\"'),m=t.idPrefix,b=[],C=t.bootstrapScriptContent,B=t.bootstrapScripts,k=t.bootstrapModules;if(C!==void 0&&(b.push(s),s5(b,t),b.push(Zo,gn((\"\"+C).replace(Y9,Z9)),d5)),C=[],r!==void 0&&(C.push(p6e),C.push(gn((\"\"+JSON.stringify(r)).replace(Y9,Z9))),C.push(A6e)),r=i?{preconnects:\"\",fontPreloads:\"\",highImagePreloads:\"\",remainingCapacity:2+(typeof o==\"number\"?o:2e3)}:null,i={placeholderPrefix:kt(m+\"P:\"),segmentPrefix:kt(m+\"S:\"),boundaryPrefix:kt(m+\"B:\"),startInlineScript:s,startInlineStyle:d,preamble:GT(),externalRuntimeScript:null,bootstrapChunks:b,importMapChunks:C,onHeaders:i,headers:r,resets:{font:{},dns:{},connect:{default:{},anonymous:{},credentials:{}},image:{},style:{}},charsetChunks:[],viewportChunks:[],hoistableChunks:[],preconnects:new Set,fontPreloads:new Set,highImagePreloads:new Set,styles:new Map,bootstrapScripts:new Set,scripts:new Set,bulkPreloads:new Set,preloads:{images:new Map,stylesheets:new Map,scripts:new Map,moduleScripts:new Map},nonce:{script:n,style:c},hoistableState:null,stylesToHoist:!1},B!==void 0)for(r=0;r<B.length;r++)m=B[r],c=s=void 0,d={rel:\"preload\",as:\"script\",fetchPriority:\"low\",nonce:e},typeof m==\"string\"?d.href=o=m:(d.href=o=m.src,d.integrity=c=typeof m.integrity==\"string\"?m.integrity:void 0,d.crossOrigin=s=typeof m==\"string\"||m.crossOrigin==null?void 0:m.crossOrigin===\"use-credentials\"?\"use-credentials\":\"\"),m=t,C=o,m.scriptResources[C]=null,m.moduleScriptResources[C]=null,m=[],El(m,d),i.bootstrapScripts.add(m),b.push(h6e,gn(Cr(o)),qo),n&&b.push($le,gn(Cr(n)),qo),typeof c==\"string\"&&b.push(ece,gn(Cr(c)),qo),typeof s==\"string\"&&b.push(tce,gn(Cr(s)),qo),s5(b,t),b.push(nce);if(k!==void 0)for(e=0;e<k.length;e++)c=k[e],o=r=void 0,s={rel:\"modulepreload\",fetchPriority:\"low\",nonce:n},typeof c==\"string\"?s.href=B=c:(s.href=B=c.src,s.integrity=o=typeof c.integrity==\"string\"?c.integrity:void 0,s.crossOrigin=r=typeof c==\"string\"||c.crossOrigin==null?void 0:c.crossOrigin===\"use-credentials\"?\"use-credentials\":\"\"),c=t,d=B,c.scriptResources[d]=null,c.moduleScriptResources[d]=null,c=[],El(c,s),i.bootstrapScripts.add(c),b.push(f6e,gn(Cr(B)),qo),n&&b.push($le,gn(Cr(n)),qo),typeof o==\"string\"&&b.push(ece,gn(Cr(o)),qo),typeof r==\"string\"&&b.push(tce,gn(Cr(r)),qo),s5(b,t),b.push(nce);return i}function Yce(t,e,n,r,i){return{idPrefix:t===void 0?\"\":t,nextFormID:0,streamingFormat:0,bootstrapScriptContent:n,bootstrapScripts:r,bootstrapModules:i,instructions:0,hasBody:!1,hasHtml:!1,unknownResources:{},dnsResources:{},connectResources:{default:{},anonymous:{},credentials:{}},imageResources:{},styleResources:{},scriptResources:{},moduleUnknownResources:{},moduleScriptResources:{}}}function GT(){return{htmlChunks:null,headChunks:null,bodyChunks:null}}function Ka(t,e,n,r){return{insertionMode:t,selectedValue:e,tagScope:n,viewTransition:r}}function Zce(t){return Ka(t===\"http://www.w3.org/2000/svg\"?4:t===\"http://www.w3.org/1998/Math/MathML\"?5:0,null,0,null)}function rce(t,e,n){var r=t.tagScope&-25;switch(e){case\"noscript\":return Ka(2,null,r|1,null);case\"select\":return Ka(2,n.value!=null?n.value:n.defaultValue,r,null);case\"svg\":return Ka(4,null,r,null);case\"picture\":return Ka(2,null,r|2,null);case\"math\":return Ka(5,null,r,null);case\"foreignObject\":return Ka(2,null,r,null);case\"table\":return Ka(6,null,r,null);case\"thead\":case\"tbody\":case\"tfoot\":return Ka(7,null,r,null);case\"colgroup\":return Ka(9,null,r,null);case\"tr\":return Ka(8,null,r,null);case\"head\":if(2>t.insertionMode)return Ka(3,null,r,null);break;case\"html\":if(t.insertionMode===0)return Ka(1,null,r,null)}return 6<=t.insertionMode||2>t.insertionMode?Ka(2,null,r,null):t.tagScope!==r?Ka(t.insertionMode,t.selectedValue,r,null):t}function qce(t){return t===null?null:{update:t.update,enter:\"none\",exit:\"none\",share:t.update,name:t.autoName,autoName:t.autoName,nameIdx:0}}function q9(t,e){return e.tagScope&32&&(t.instructions|=128),Ka(e.insertionMode,e.selectedValue,e.tagScope|12,qce(e.viewTransition))}function o5(t,e){t=qce(e.viewTransition);var n=e.tagScope|16;return t!==null&&t.share!==\"none\"&&(n|=64),Ka(e.insertionMode,e.selectedValue,n,t)}var ff=kt(\"<!-- -->\");function ice(t,e,n,r){return e===\"\"?r:(r&&t.push(ff),t.push(gn(Cr(e))),!0)}var oce=new Map,g6e=kt(' style=\"'),sce=kt(\":\"),m6e=kt(\";\");function Qce(t,e){if(typeof e!=\"object\")throw Error(Ln(62));var n=!0,r;for(r in e)if(Uo.call(e,r)){var i=e[r];if(i!=null&&typeof i!=\"boolean\"&&i!==\"\"){if(r.indexOf(\"--\")===0){var o=gn(Cr(r));i=gn(Cr((\"\"+i).trim()))}else o=oce.get(r),o===void 0&&(o=kt(Cr(r.replace(s6e,\"-$1\").toLowerCase().replace(a6e,\"-ms-\"))),oce.set(r,o)),i=typeof i==\"number\"?i===0||r6e.has(r)?gn(\"\"+i):gn(i+\"px\"):gn(Cr((\"\"+i).trim()));n?(n=!1,t.push(g6e,o,sce,i)):t.push(m6e,o,sce,i)}}n||t.push(qo)}var rc=kt(\" \"),ch=kt('=\"'),qo=kt('\"'),Q9=kt('=\"\"');function K9(t,e,n){n&&typeof n!=\"function\"&&typeof n!=\"symbol\"&&t.push(rc,gn(e),Q9)}function Tl(t,e,n){typeof n!=\"function\"&&typeof n!=\"symbol\"&&typeof n!=\"boolean\"&&t.push(rc,gn(e),ch,gn(Cr(n)),qo)}var Kce=kt(Cr(\"javascript:throw new Error('React form unexpectedly submitted.')\")),Jce=kt('<input type=\"hidden\"');function N9(t,e){this.push(Jce),$ce(t),Tl(this,\"name\",e),Tl(this,\"value\",t),this.push(HT)}function $ce(t){if(typeof t!=\"string\")throw Error(Ln(480))}function eue(t,e){if(typeof e.$$FORM_ACTION==\"function\"){var n=t.nextFormID++;t=t.idPrefix+n;try{var r=e.$$FORM_ACTION(t);if(r){var i=r.data;i?.forEach($ce)}return r}catch(o){if(typeof o==\"object\"&&o!==null&&typeof o.then==\"function\")throw o}}return null}function ace(t,e,n,r,i,o,s,c){var d=null;if(typeof r==\"function\"){var m=eue(e,r);m!==null?(c=m.name,r=m.action||\"\",i=m.encType,o=m.method,s=m.target,d=m.data):(t.push(rc,gn(\"formAction\"),ch,Kce,qo),s=o=i=r=c=null,tue(e,n))}return c!=null&&Gi(t,\"name\",c),r!=null&&Gi(t,\"formAction\",r),i!=null&&Gi(t,\"formEncType\",i),o!=null&&Gi(t,\"formMethod\",o),s!=null&&Gi(t,\"formTarget\",s),d}function Gi(t,e,n){switch(e){case\"className\":Tl(t,\"class\",n);break;case\"tabIndex\":Tl(t,\"tabindex\",n);break;case\"dir\":case\"role\":case\"viewBox\":case\"width\":case\"height\":Tl(t,e,n);break;case\"style\":Qce(t,n);break;case\"src\":case\"href\":if(n===\"\")break;case\"action\":case\"formAction\":if(n==null||typeof n==\"function\"||typeof n==\"symbol\"||typeof n==\"boolean\")break;n=VT(\"\"+n),t.push(rc,gn(e),ch,gn(Cr(n)),qo);break;case\"defaultValue\":case\"defaultChecked\":case\"innerHTML\":case\"suppressContentEditableWarning\":case\"suppressHydrationWarning\":case\"ref\":break;case\"autoFocus\":case\"multiple\":case\"muted\":K9(t,e.toLowerCase(),n);break;case\"xlinkHref\":if(typeof n==\"function\"||typeof n==\"symbol\"||typeof n==\"boolean\")break;n=VT(\"\"+n),t.push(rc,gn(\"xlink:href\"),ch,gn(Cr(n)),qo);break;case\"contentEditable\":case\"spellCheck\":case\"draggable\":case\"value\":case\"autoReverse\":case\"externalResourcesRequired\":case\"focusable\":case\"preserveAlpha\":typeof n!=\"function\"&&typeof n!=\"symbol\"&&t.push(rc,gn(e),ch,gn(Cr(n)),qo);break;case\"inert\":case\"allowFullScreen\":case\"async\":case\"autoPlay\":case\"controls\":case\"default\":case\"defer\":case\"disabled\":case\"disablePictureInPicture\":case\"disableRemotePlayback\":case\"formNoValidate\":case\"hidden\":case\"loop\":case\"noModule\":case\"noValidate\":case\"open\":case\"playsInline\":case\"readOnly\":case\"required\":case\"reversed\":case\"scoped\":case\"seamless\":case\"itemScope\":n&&typeof n!=\"function\"&&typeof n!=\"symbol\"&&t.push(rc,gn(e),Q9);break;case\"capture\":case\"download\":n===!0?t.push(rc,gn(e),Q9):n!==!1&&typeof n!=\"function\"&&typeof n!=\"symbol\"&&t.push(rc,gn(e),ch,gn(Cr(n)),qo);break;case\"cols\":case\"rows\":case\"size\":case\"span\":typeof n!=\"function\"&&typeof n!=\"symbol\"&&!isNaN(n)&&1<=n&&t.push(rc,gn(e),ch,gn(Cr(n)),qo);break;case\"rowSpan\":case\"start\":typeof n==\"function\"||typeof n==\"symbol\"||isNaN(n)||t.push(rc,gn(e),ch,gn(Cr(n)),qo);break;case\"xlinkActuate\":Tl(t,\"xlink:actuate\",n);break;case\"xlinkArcrole\":Tl(t,\"xlink:arcrole\",n);break;case\"xlinkRole\":Tl(t,\"xlink:role\",n);break;case\"xlinkShow\":Tl(t,\"xlink:show\",n);break;case\"xlinkTitle\":Tl(t,\"xlink:title\",n);break;case\"xlinkType\":Tl(t,\"xlink:type\",n);break;case\"xmlBase\":Tl(t,\"xml:base\",n);break;case\"xmlLang\":Tl(t,\"xml:lang\",n);break;case\"xmlSpace\":Tl(t,\"xml:space\",n);break;default:if((!(2<e.length)||e[0]!==\"o\"&&e[0]!==\"O\"||e[1]!==\"n\"&&e[1]!==\"N\")&&(e=i6e.get(e)||e,g7(e))){switch(typeof n){case\"function\":case\"symbol\":return;case\"boolean\":var r=e.toLowerCase().slice(0,5);if(r!==\"data-\"&&r!==\"aria-\")return}t.push(rc,gn(e),ch,gn(Cr(n)),qo)}}}var Zo=kt(\">\"),HT=kt(\"/>\");function du(t,e,n){if(e!=null){if(n!=null)throw Error(Ln(60));if(typeof e!=\"object\"||!(\"__html\"in e))throw Error(Ln(61));e=e.__html,e!=null&&t.push(gn(\"\"+e))}}function _6e(t){var e=\"\";return h7.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}var z9=kt(' selected=\"\"'),lce=kt(`addEventListener(\"submit\",function(a){if(!a.defaultPrevented){var c=a.target,d=a.submitter,e=c.action,b=d;if(d){var f=d.getAttribute(\"formAction\");null!=f&&(e=f,b=null)}\"javascript:throw new Error('React form unexpectedly submitted.')\"===e&&(a.preventDefault(),b?(a=document.createElement(\"input\"),a.name=b.name,a.value=b.value,b.parentNode.insertBefore(a,b),b=new FormData(c),a.parentNode.removeChild(a)):b=new FormData(c),a=c.ownerDocument||c,(a.$$reactFormReplay=a.$$reactFormReplay||[]).push(c,d,b))}});`);function tue(t,e){if((t.instructions&16)===0){t.instructions|=16;var n=e.preamble,r=e.bootstrapChunks;(n.htmlChunks||n.headChunks)&&r.length===0?(r.push(e.startInlineScript),s5(r,t),r.push(Zo,lce,d5)):r.unshift(e.startInlineScript,Zo,lce,d5)}}var y6e=kt(\"<!--F!-->\"),x6e=kt(\"<!--F-->\");function El(t,e){t.push(ra(\"link\"));for(var n in e)if(Uo.call(e,n)){var r=e[n];if(r!=null)switch(n){case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Ln(399,\"link\"));default:Gi(t,n,r)}}return t.push(HT),null}var cce=/(<\\/|<)(s)(tyle)/gi;function uce(t,e,n,r){return\"\"+e+(n===\"s\"?\"\\\\73 \":\"\\\\53 \")+r}function lx(t,e,n){t.push(ra(n));for(var r in e)if(Uo.call(e,r)){var i=e[r];if(i!=null)switch(r){case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Ln(399,n));default:Gi(t,r,i)}}return t.push(HT),null}function hce(t,e){t.push(ra(\"title\"));var n=null,r=null,i;for(i in e)if(Uo.call(e,i)){var o=e[i];if(o!=null)switch(i){case\"children\":n=o;break;case\"dangerouslySetInnerHTML\":r=o;break;default:Gi(t,i,o)}}return t.push(Zo),e=Array.isArray(n)?2>n.length?n[0]:null:n,typeof e!=\"function\"&&typeof e!=\"symbol\"&&e!==null&&e!==void 0&&t.push(gn(Cr(\"\"+e))),du(t,r,n),t.push(C_(\"title\")),null}var v6e=kt(\"<!--head-->\"),b6e=kt(\"<!--body-->\"),w6e=kt(\"<!--html-->\");function p5(t,e){t.push(ra(\"script\"));var n=null,r=null,i;for(i in e)if(Uo.call(e,i)){var o=e[i];if(o!=null)switch(i){case\"children\":n=o;break;case\"dangerouslySetInnerHTML\":r=o;break;default:Gi(t,i,o)}}return t.push(Zo),du(t,r,n),typeof n==\"string\"&&t.push(gn((\"\"+n).replace(Y9,Z9))),t.push(C_(\"script\")),null}function U9(t,e,n){t.push(ra(n));var r=n=null,i;for(i in e)if(Uo.call(e,i)){var o=e[i];if(o!=null)switch(i){case\"children\":n=o;break;case\"dangerouslySetInnerHTML\":r=o;break;default:Gi(t,i,o)}}return t.push(Zo),du(t,r,n),n}function n5(t,e,n){t.push(ra(n));var r=n=null,i;for(i in e)if(Uo.call(e,i)){var o=e[i];if(o!=null)switch(i){case\"children\":n=o;break;case\"dangerouslySetInnerHTML\":r=o;break;default:Gi(t,i,o)}}return t.push(Zo),du(t,r,n),typeof n==\"string\"?(t.push(gn(Cr(n))),null):n}var V9=kt(`\n`),T6e=/^[a-zA-Z][a-zA-Z:_\\.\\-\\d]*$/,fce=new Map;function ra(t){var e=fce.get(t);if(e===void 0){if(!T6e.test(t))throw Error(Ln(65,t));e=kt(\"<\"+t),fce.set(t,e)}return e}var E6e=kt(\"<!DOCTYPE html>\");function S6e(t,e,n,r,i,o,s,c,d){switch(e){case\"div\":case\"span\":case\"svg\":case\"path\":break;case\"a\":t.push(ra(\"a\"));var m=null,b=null,C;for(C in n)if(Uo.call(n,C)){var B=n[C];if(B!=null)switch(C){case\"children\":m=B;break;case\"dangerouslySetInnerHTML\":b=B;break;case\"href\":B===\"\"?Tl(t,\"href\",\"\"):Gi(t,C,B);break;default:Gi(t,C,B)}}if(t.push(Zo),du(t,b,m),typeof m==\"string\"){t.push(gn(Cr(m)));var k=null}else k=m;return k;case\"g\":case\"p\":case\"li\":break;case\"select\":t.push(ra(\"select\"));var V=null,q=null,K;for(K in n)if(Uo.call(n,K)){var Y=n[K];if(Y!=null)switch(K){case\"children\":V=Y;break;case\"dangerouslySetInnerHTML\":q=Y;break;case\"defaultValue\":case\"value\":break;default:Gi(t,K,Y)}}return t.push(Zo),du(t,q,V),V;case\"option\":var ee=c.selectedValue;t.push(ra(\"option\"));var J=null,se=null,xe=null,Ee=null,Xe;for(Xe in n)if(Uo.call(n,Xe)){var Ne=n[Xe];if(Ne!=null)switch(Xe){case\"children\":J=Ne;break;case\"selected\":xe=Ne;break;case\"dangerouslySetInnerHTML\":Ee=Ne;break;case\"value\":se=Ne;default:Gi(t,Xe,Ne)}}if(ee!=null){var be=se!==null?\"\"+se:_6e(J);if(f5(ee)){for(var ge=0;ge<ee.length;ge++)if(\"\"+ee[ge]===be){t.push(z9);break}}else\"\"+ee===be&&t.push(z9)}else xe&&t.push(z9);return t.push(Zo),du(t,Ee,J),J;case\"textarea\":t.push(ra(\"textarea\"));var Qe=null,Ct=null,Mt=null,mt;for(mt in n)if(Uo.call(n,mt)){var jt=n[mt];if(jt!=null)switch(mt){case\"children\":Mt=jt;break;case\"value\":Qe=jt;break;case\"defaultValue\":Ct=jt;break;case\"dangerouslySetInnerHTML\":throw Error(Ln(91));default:Gi(t,mt,jt)}}if(Qe===null&&Ct!==null&&(Qe=Ct),t.push(Zo),Mt!=null){if(Qe!=null)throw Error(Ln(92));if(f5(Mt)){if(1<Mt.length)throw Error(Ln(93));Qe=\"\"+Mt[0]}Qe=\"\"+Mt}return typeof Qe==\"string\"&&Qe[0]===`\n`&&t.push(V9),Qe!==null&&t.push(gn(Cr(\"\"+Qe))),null;case\"input\":t.push(ra(\"input\"));var Mn=null,rn=null,In=null,On=null,Pn=null,_n=null,tr=null,on=null,Pt=null,Mr;for(Mr in n)if(Uo.call(n,Mr)){var Fn=n[Mr];if(Fn!=null)switch(Mr){case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Ln(399,\"input\"));case\"name\":Mn=Fn;break;case\"formAction\":rn=Fn;break;case\"formEncType\":In=Fn;break;case\"formMethod\":On=Fn;break;case\"formTarget\":Pn=Fn;break;case\"defaultChecked\":Pt=Fn;break;case\"defaultValue\":tr=Fn;break;case\"checked\":on=Fn;break;case\"value\":_n=Fn;break;default:Gi(t,Mr,Fn)}}var Br=ace(t,r,i,rn,In,On,Pn,Mn);return on!==null?K9(t,\"checked\",on):Pt!==null&&K9(t,\"checked\",Pt),_n!==null?Gi(t,\"value\",_n):tr!==null&&Gi(t,\"value\",tr),t.push(HT),Br?.forEach(N9,t),null;case\"button\":t.push(ra(\"button\"));var nr=null,lo=null,oi=null,cs=null,yi=null,Ro=null,co=null,mr;for(mr in n)if(Uo.call(n,mr)){var Yr=n[mr];if(Yr!=null)switch(mr){case\"children\":nr=Yr;break;case\"dangerouslySetInnerHTML\":lo=Yr;break;case\"name\":oi=Yr;break;case\"formAction\":cs=Yr;break;case\"formEncType\":yi=Yr;break;case\"formMethod\":Ro=Yr;break;case\"formTarget\":co=Yr;break;default:Gi(t,mr,Yr)}}var Xs=ace(t,r,i,cs,yi,Ro,co,oi);if(t.push(Zo),Xs?.forEach(N9,t),du(t,lo,nr),typeof nr==\"string\"){t.push(gn(Cr(nr)));var Ys=null}else Ys=nr;return Ys;case\"form\":t.push(ra(\"form\"));var Hi=null,us=null,Zr=null,Oi=null,Fr=null,eo=null,$t;for($t in n)if(Uo.call(n,$t)){var en=n[$t];if(en!=null)switch($t){case\"children\":Hi=en;break;case\"dangerouslySetInnerHTML\":us=en;break;case\"action\":Zr=en;break;case\"encType\":Oi=en;break;case\"method\":Fr=en;break;case\"target\":eo=en;break;default:Gi(t,$t,en)}}var Sn=null,Ze=null;if(typeof Zr==\"function\"){var ae=eue(r,Zr);ae!==null?(Zr=ae.action||\"\",Oi=ae.encType,Fr=ae.method,eo=ae.target,Sn=ae.data,Ze=ae.name):(t.push(rc,gn(\"action\"),ch,Kce,qo),eo=Fr=Oi=Zr=null,tue(r,i))}if(Zr!=null&&Gi(t,\"action\",Zr),Oi!=null&&Gi(t,\"encType\",Oi),Fr!=null&&Gi(t,\"method\",Fr),eo!=null&&Gi(t,\"target\",eo),t.push(Zo),Ze!==null&&(t.push(Jce),Tl(t,\"name\",Ze),t.push(HT),Sn?.forEach(N9,t)),du(t,us,Hi),typeof Hi==\"string\"){t.push(gn(Cr(Hi)));var he=null}else he=Hi;return he;case\"menuitem\":t.push(ra(\"menuitem\"));for(var pe in n)if(Uo.call(n,pe)){var ze=n[pe];if(ze!=null)switch(pe){case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Ln(400));default:Gi(t,pe,ze)}}return t.push(Zo),null;case\"object\":t.push(ra(\"object\"));var He=null,ot=null,tt;for(tt in n)if(Uo.call(n,tt)){var Je=n[tt];if(Je!=null)switch(tt){case\"children\":He=Je;break;case\"dangerouslySetInnerHTML\":ot=Je;break;case\"data\":var nt=VT(\"\"+Je);if(nt===\"\")break;t.push(rc,gn(\"data\"),ch,gn(Cr(nt)),qo);break;default:Gi(t,tt,Je)}}if(t.push(Zo),du(t,ot,He),typeof He==\"string\"){t.push(gn(Cr(He)));var Dt=null}else Dt=He;return Dt;case\"title\":var vt=c.tagScope&1,Vt=c.tagScope&4;if(c.insertionMode===4||vt||n.itemProp!=null)var Ke=hce(t,n);else Vt?Ke=null:(hce(i.hoistableChunks,n),Ke=void 0);return Ke;case\"link\":var zn=c.tagScope&1,Wr=c.tagScope&4,fn=n.rel,ln=n.href,Nn=n.precedence;if(c.insertionMode===4||zn||n.itemProp!=null||typeof fn!=\"string\"||typeof ln!=\"string\"||ln===\"\"){El(t,n);var Ir=null}else if(n.rel===\"stylesheet\")if(typeof Nn!=\"string\"||n.disabled!=null||n.onLoad||n.onError)Ir=El(t,n);else{var Et=i.styles.get(Nn),di=r.styleResources.hasOwnProperty(ln)?r.styleResources[ln]:void 0;if(di!==null){r.styleResources[ln]=null,Et||(Et={precedence:gn(Cr(Nn)),rules:[],hrefs:[],sheets:new Map},i.styles.set(Nn,Et));var pi={state:0,props:Ic({},n,{\"data-precedence\":n.precedence,precedence:null})};if(di){di.length===2&&WT(pi.props,di);var ti=i.preloads.stylesheets.get(ln);ti&&0<ti.length?ti.length=0:pi.state=1}Et.sheets.set(ln,pi),s&&s.stylesheets.add(pi)}else if(Et){var Wi=Et.sheets.get(ln);Wi&&s&&s.stylesheets.add(Wi)}d&&t.push(ff),Ir=null}else n.onLoad||n.onError?Ir=El(t,n):(d&&t.push(ff),Ir=Wr?null:El(i.hoistableChunks,n));return Ir;case\"script\":var Lt=c.tagScope&1,Ai=n.async;if(typeof n.src!=\"string\"||!n.src||!Ai||typeof Ai==\"function\"||typeof Ai==\"symbol\"||n.onLoad||n.onError||c.insertionMode===4||Lt||n.itemProp!=null)var Vo=p5(t,n);else{var Es=n.src;if(n.type===\"module\")var qr=r.moduleScriptResources,Yt=i.preloads.moduleScripts;else qr=r.scriptResources,Yt=i.preloads.scripts;var kn=qr.hasOwnProperty(Es)?qr[Es]:void 0;if(kn!==null){qr[Es]=null;var Hn=n;if(kn){kn.length===2&&(Hn=Ic({},n),WT(Hn,kn));var Qo=Yt.get(Es);Qo&&(Qo.length=0)}var Pc=[];i.scripts.add(Pc),p5(Pc,Hn)}d&&t.push(ff),Vo=null}return Vo;case\"style\":var $a=c.tagScope&1,Un=n.precedence,Ko=n.href,mu=n.nonce;if(c.insertionMode===4||$a||n.itemProp!=null||typeof Un!=\"string\"||typeof Ko!=\"string\"||Ko===\"\"){t.push(ra(\"style\"));var hs=null,Ml=null,Ss;for(Ss in n)if(Uo.call(n,Ss)){var Zs=n[Ss];if(Zs!=null)switch(Ss){case\"children\":hs=Zs;break;case\"dangerouslySetInnerHTML\":Ml=Zs;break;default:Gi(t,Ss,Zs)}}t.push(Zo);var Cs=Array.isArray(hs)?2>hs.length?hs[0]:null:hs;typeof Cs!=\"function\"&&typeof Cs!=\"symbol\"&&Cs!==null&&Cs!==void 0&&t.push(gn((\"\"+Cs).replace(cce,uce))),du(t,Ml,hs),t.push(C_(\"style\"));var Bo=null}else{var rr=i.styles.get(Un);if((r.styleResources.hasOwnProperty(Ko)?r.styleResources[Ko]:void 0)!==null){r.styleResources[Ko]=null,rr||(rr={precedence:gn(Cr(Un)),rules:[],hrefs:[],sheets:new Map},i.styles.set(Un,rr));var Rc=i.nonce.style;if(!Rc||Rc===mu){rr.hrefs.push(gn(Cr(Ko)));var Il=rr.rules,Jo=null,el=null,Do;for(Do in n)if(Uo.call(n,Do)){var Bc=n[Do];if(Bc!=null)switch(Do){case\"children\":Jo=Bc;break;case\"dangerouslySetInnerHTML\":el=Bc}}var $o=Array.isArray(Jo)?2>Jo.length?Jo[0]:null:Jo;typeof $o!=\"function\"&&typeof $o!=\"symbol\"&&$o!==null&&$o!==void 0&&Il.push(gn((\"\"+$o).replace(cce,uce))),du(Il,el,Jo)}}rr&&s&&s.styles.add(rr),d&&t.push(ff),Bo=void 0}return Bo;case\"meta\":var ph=c.tagScope&1,xi=c.tagScope&4;if(c.insertionMode===4||ph||n.itemProp!=null)var Ah=lx(t,n,\"meta\");else d&&t.push(ff),Ah=xi?null:typeof n.charSet==\"string\"?lx(i.charsetChunks,n,\"meta\"):n.name===\"viewport\"?lx(i.viewportChunks,n,\"meta\"):lx(i.hoistableChunks,n,\"meta\");return Ah;case\"listing\":case\"pre\":t.push(ra(e));var Ia=null,Ms=null,Pa;for(Pa in n)if(Uo.call(n,Pa)){var Pl=n[Pa];if(Pl!=null)switch(Pa){case\"children\":Ia=Pl;break;case\"dangerouslySetInnerHTML\":Ms=Pl;break;default:Gi(t,Pa,Pl)}}if(t.push(Zo),Ms!=null){if(Ia!=null)throw Error(Ln(60));if(typeof Ms!=\"object\"||!(\"__html\"in Ms))throw Error(Ln(61));var fs=Ms.__html;fs!=null&&(typeof fs==\"string\"&&0<fs.length&&fs[0]===`\n`?t.push(V9,gn(fs)):t.push(gn(\"\"+fs)))}return typeof Ia==\"string\"&&Ia[0]===`\n`&&t.push(V9),Ia;case\"img\":var gh=c.tagScope&3,wr=n.src,_r=n.srcSet;if(!(n.loading===\"lazy\"||!wr&&!_r||typeof wr!=\"string\"&&wr!=null||typeof _r!=\"string\"&&_r!=null||n.fetchPriority===\"low\"||gh)&&(typeof wr!=\"string\"||wr[4]!==\":\"||wr[0]!==\"d\"&&wr[0]!==\"D\"||wr[1]!==\"a\"&&wr[1]!==\"A\"||wr[2]!==\"t\"&&wr[2]!==\"T\"||wr[3]!==\"a\"&&wr[3]!==\"A\")&&(typeof _r!=\"string\"||_r[4]!==\":\"||_r[0]!==\"d\"&&_r[0]!==\"D\"||_r[1]!==\"a\"&&_r[1]!==\"A\"||_r[2]!==\"t\"&&_r[2]!==\"T\"||_r[3]!==\"a\"&&_r[3]!==\"A\")){s!==null&&c.tagScope&64&&(s.suspenseyImages=!0);var _u=typeof n.sizes==\"string\"?n.sizes:void 0,Is=_r?_r+`\n`+(_u||\"\"):wr,yu=i.preloads.images,Lo=yu.get(Is);if(Lo)(n.fetchPriority===\"high\"||10>i.highImagePreloads.size)&&(yu.delete(Is),i.highImagePreloads.add(Lo));else if(!r.imageResources.hasOwnProperty(Is)){r.imageResources[Is]=uh;var Rl=n.crossOrigin,mh=typeof Rl==\"string\"?Rl===\"use-credentials\"?Rl:\"\":void 0,xo=i.headers,oc;xo&&0<xo.remainingCapacity&&typeof n.srcSet!=\"string\"&&(n.fetchPriority===\"high\"||500>xo.highImagePreloads.length)&&(oc=g5(wr,\"image\",{imageSrcSet:n.srcSet,imageSizes:n.sizes,crossOrigin:mh,integrity:n.integrity,nonce:n.nonce,type:n.type,fetchPriority:n.fetchPriority,referrerPolicy:n.refererPolicy}),0<=(xo.remainingCapacity-=oc.length+2))?(i.resets.image[Is]=uh,xo.highImagePreloads&&(xo.highImagePreloads+=\", \"),xo.highImagePreloads+=oc):(Lo=[],El(Lo,{rel:\"preload\",as:\"image\",href:_r?void 0:wr,imageSrcSet:_r,imageSizes:_u,crossOrigin:mh,integrity:n.integrity,type:n.type,fetchPriority:n.fetchPriority,referrerPolicy:n.referrerPolicy}),n.fetchPriority===\"high\"||10>i.highImagePreloads.size?i.highImagePreloads.add(Lo):(i.bulkPreloads.add(Lo),yu.set(Is,Lo)))}}return lx(t,n,\"img\");case\"base\":case\"area\":case\"br\":case\"col\":case\"embed\":case\"hr\":case\"keygen\":case\"param\":case\"source\":case\"track\":case\"wbr\":return lx(t,n,e);case\"annotation-xml\":case\"color-profile\":case\"font-face\":case\"font-face-src\":case\"font-face-uri\":case\"font-face-format\":case\"font-face-name\":case\"missing-glyph\":break;case\"head\":if(2>c.insertionMode){var tl=o||i.preamble;if(tl.headChunks)throw Error(Ln(545,\"`<head>`\"));o!==null&&t.push(v6e),tl.headChunks=[];var Ra=U9(tl.headChunks,n,\"head\")}else Ra=n5(t,n,\"head\");return Ra;case\"body\":if(2>c.insertionMode){var Ba=o||i.preamble;if(Ba.bodyChunks)throw Error(Ln(545,\"`<body>`\"));o!==null&&t.push(b6e),Ba.bodyChunks=[];var Zn=U9(Ba.bodyChunks,n,\"body\")}else Zn=n5(t,n,\"body\");return Zn;case\"html\":if(c.insertionMode===0){var sc=o||i.preamble;if(sc.htmlChunks)throw Error(Ln(545,\"`<html>`\"));o!==null&&t.push(w6e),sc.htmlChunks=[E6e];var df=U9(sc.htmlChunks,n,\"html\")}else df=n5(t,n,\"html\");return df;default:if(e.indexOf(\"-\")!==-1){t.push(ra(e));var ac=null,Go=null,si;for(si in n)if(Uo.call(n,si)){var Kn=n[si];if(Kn!=null){var Bn=si;switch(si){case\"children\":ac=Kn;break;case\"dangerouslySetInnerHTML\":Go=Kn;break;case\"style\":Qce(t,Kn);break;case\"suppressContentEditableWarning\":case\"suppressHydrationWarning\":case\"ref\":break;case\"className\":Bn=\"class\";default:if(g7(si)&&typeof Kn!=\"function\"&&typeof Kn!=\"symbol\"&&Kn!==!1){if(Kn===!0)Kn=\"\";else if(typeof Kn==\"object\")continue;t.push(rc,gn(Bn),ch,gn(Cr(Kn)),qo)}}}}return t.push(Zo),du(t,Go,ac),ac}}return n5(t,n,e)}var dce=new Map;function C_(t){var e=dce.get(t);return e===void 0&&(e=kt(\"</\"+t+\">\"),dce.set(t,e)),e}function pce(t,e){t=t.preamble,t.htmlChunks===null&&e.htmlChunks&&(t.htmlChunks=e.htmlChunks),t.headChunks===null&&e.headChunks&&(t.headChunks=e.headChunks),t.bodyChunks===null&&e.bodyChunks&&(t.bodyChunks=e.bodyChunks)}function nue(t,e){e=e.bootstrapChunks;for(var n=0;n<e.length-1;n++)Ft(t,e[n]);return n<e.length?(n=e[n],e.length=0,ao(t,n)):!0}var C6e=kt(\"requestAnimationFrame(function(){$RT=performance.now()});\"),M6e=kt('<template id=\"'),I6e=kt('\"></template>'),P6e=kt(\"<!--&-->\"),R6e=kt(\"<!--/&-->\"),B6e=kt(\"<!--$-->\"),D6e=kt('<!--$?--><template id=\"'),L6e=kt('\"></template>'),O6e=kt(\"<!--$!-->\"),F6e=kt(\"<!--/$-->\"),k6e=kt(\"<template\"),N6e=kt('\"'),z6e=kt(' data-dgst=\"');kt(' data-msg=\"');kt(' data-stck=\"');kt(' data-cstck=\"');var U6e=kt(\"></template>\");function Ace(t,e,n){if(Ft(t,D6e),n===null)throw Error(Ln(395));return Ft(t,e.boundaryPrefix),Ft(t,gn(n.toString(16))),ao(t,L6e)}var V6e=kt('<div hidden id=\"'),G6e=kt('\">'),H6e=kt(\"</div>\"),W6e=kt('<svg aria-hidden=\"true\" style=\"display:none\" id=\"'),j6e=kt('\">'),X6e=kt(\"</svg>\"),Y6e=kt('<math aria-hidden=\"true\" style=\"display:none\" id=\"'),Z6e=kt('\">'),q6e=kt(\"</math>\"),Q6e=kt('<table hidden id=\"'),K6e=kt('\">'),J6e=kt(\"</table>\"),$6e=kt('<table hidden><tbody id=\"'),eDe=kt('\">'),tDe=kt(\"</tbody></table>\"),nDe=kt('<table hidden><tr id=\"'),rDe=kt('\">'),iDe=kt(\"</tr></table>\"),oDe=kt('<table hidden><colgroup id=\"'),sDe=kt('\">'),aDe=kt(\"</colgroup></table>\");function lDe(t,e,n,r){switch(n.insertionMode){case 0:case 1:case 3:case 2:return Ft(t,V6e),Ft(t,e.segmentPrefix),Ft(t,gn(r.toString(16))),ao(t,G6e);case 4:return Ft(t,W6e),Ft(t,e.segmentPrefix),Ft(t,gn(r.toString(16))),ao(t,j6e);case 5:return Ft(t,Y6e),Ft(t,e.segmentPrefix),Ft(t,gn(r.toString(16))),ao(t,Z6e);case 6:return Ft(t,Q6e),Ft(t,e.segmentPrefix),Ft(t,gn(r.toString(16))),ao(t,K6e);case 7:return Ft(t,$6e),Ft(t,e.segmentPrefix),Ft(t,gn(r.toString(16))),ao(t,eDe);case 8:return Ft(t,nDe),Ft(t,e.segmentPrefix),Ft(t,gn(r.toString(16))),ao(t,rDe);case 9:return Ft(t,oDe),Ft(t,e.segmentPrefix),Ft(t,gn(r.toString(16))),ao(t,sDe);default:throw Error(Ln(397))}}function cDe(t,e){switch(e.insertionMode){case 0:case 1:case 3:case 2:return ao(t,H6e);case 4:return ao(t,X6e);case 5:return ao(t,q6e);case 6:return ao(t,J6e);case 7:return ao(t,tDe);case 8:return ao(t,iDe);case 9:return ao(t,aDe);default:throw Error(Ln(397))}}var uDe=kt('$RS=function(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS(\"'),hDe=kt('$RS(\"'),fDe=kt('\",\"'),dDe=kt('\")<\\/script>');kt('<template data-rsi=\"\" data-sid=\"');kt('\" data-pid=\"');var gce=kt(`$RB=[];$RV=function(a){$RT=performance.now();for(var b=0;b<a.length;b+=2){var c=a[b],e=a[b+1];null!==e.parentNode&&e.parentNode.removeChild(e);var f=c.parentNode;if(f){var g=c.previousSibling,h=0;do{if(c&&8===c.nodeType){var d=c.data;if(\"/$\"===d||\"/&\"===d)if(0===h)break;else h--;else\"$\"!==d&&\"$?\"!==d&&\"$~\"!==d&&\"$!\"!==d&&\"&\"!==d||h++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;e.firstChild;)f.insertBefore(e.firstChild,c);g.data=\"$\";g._reactRetry&&requestAnimationFrame(g._reactRetry)}}a.length=0};\n$RC=function(a,b){if(b=document.getElementById(b))(a=document.getElementById(a))?(a.previousSibling.data=\"$~\",$RB.push(a,b),2===$RB.length&&(\"number\"!==typeof $RT?requestAnimationFrame($RV.bind(null,$RB)):(a=performance.now(),setTimeout($RV.bind(null,$RB),2300>a&&2E3<a?2300-a:$RT+300-a)))):b.parentNode.removeChild(b)};`);gn(`$RV=function(A,g){function k(a,b){var e=a.getAttribute(b);e&&(b=a.style,l.push(a,b.viewTransitionName,b.viewTransitionClass),\"auto\"!==e&&(b.viewTransitionClass=e),(a=a.getAttribute(\"vt-name\"))||(a=\"_T_\"+K++ +\"_\"),b.viewTransitionName=a,B=!0)}var B=!1,K=0,l=[];try{var f=document.__reactViewTransition;if(f){f.finished.finally($RV.bind(null,g));return}var m=new Map;for(f=1;f<g.length;f+=2)for(var h=g[f].querySelectorAll(\"[vt-share]\"),d=0;d<h.length;d++){var c=h[d];m.set(c.getAttribute(\"vt-name\"),c)}var u=[];for(h=0;h<g.length;h+=2){var C=g[h],x=C.parentNode;if(x){var v=x.getBoundingClientRect();if(v.left||v.top||v.width||v.height){c=C;for(f=0;c;){if(8===c.nodeType){var r=c.data;if(\"/$\"===r)if(0===f)break;else f--;else\"$\"!==r&&\"$?\"!==r&&\"$~\"!==r&&\"$!\"!==r||f++}else if(1===c.nodeType){d=c;var D=d.getAttribute(\"vt-name\"),y=m.get(D);k(d,y?\"vt-share\":\"vt-exit\");y&&(k(y,\"vt-share\"),m.set(D,null));var E=d.querySelectorAll(\"[vt-share]\");for(d=0;d<E.length;d++){var F=E[d],G=F.getAttribute(\"vt-name\"),\nH=m.get(G);H&&(k(F,\"vt-share\"),k(H,\"vt-share\"),m.set(G,null))}}c=c.nextSibling}for(var I=g[h+1],t=I.firstElementChild;t;)null!==m.get(t.getAttribute(\"vt-name\"))&&k(t,\"vt-enter\"),t=t.nextElementSibling;c=x;do for(var n=c.firstElementChild;n;){var J=n.getAttribute(\"vt-update\");J&&\"none\"!==J&&!l.includes(n)&&k(n,\"vt-update\");n=n.nextElementSibling}while((c=c.parentNode)&&1===c.nodeType&&\"none\"!==c.getAttribute(\"vt-update\"));u.push.apply(u,I.querySelectorAll('img[src]:not([loading=\"lazy\"])'))}}}if(B){var z=\ndocument.__reactViewTransition=document.startViewTransition({update:function(){A(g);for(var a=[document.documentElement.clientHeight,document.fonts.ready],b={},e=0;e<u.length;b={g:b.g},e++)if(b.g=u[e],!b.g.complete){var p=b.g.getBoundingClientRect();0<p.bottom&&0<p.right&&p.top<window.innerHeight&&p.left<window.innerWidth&&(p=new Promise(function(w){return function(q){w.g.addEventListener(\"load\",q);w.g.addEventListener(\"error\",q)}}(b)),a.push(p))}return Promise.race([Promise.all(a),new Promise(function(w){var q=\nperformance.now();setTimeout(w,2300>q&&2E3<q?2300-q:500)})])},types:[]});z.ready.finally(function(){for(var a=l.length-3;0<=a;a-=3){var b=l[a],e=b.style;e.viewTransitionName=l[a+1];e.viewTransitionClass=l[a+1];\"\"===b.getAttribute(\"style\")&&b.removeAttribute(\"style\")}});z.finished.finally(function(){document.__reactViewTransition===z&&(document.__reactViewTransition=null)});$RB=[];return}}catch(a){}A(g)}.bind(null,$RV);`);var pDe=kt('$RC(\"'),ADe=kt(`$RM=new Map;$RR=function(n,w,p){function u(q){this._p=null;q()}for(var r=new Map,t=document,h,b,e=t.querySelectorAll(\"link[data-precedence],style[data-precedence]\"),v=[],k=0;b=e[k++];)\"not all\"===b.getAttribute(\"media\")?v.push(b):(\"LINK\"===b.tagName&&$RM.set(b.getAttribute(\"href\"),b),r.set(b.dataset.precedence,h=b));e=0;b=[];var l,a;for(k=!0;;){if(k){var f=p[e++];if(!f){k=!1;e=0;continue}var c=!1,m=0;var d=f[m++];if(a=$RM.get(d)){var g=a._p;c=!0}else{a=t.createElement(\"link\");a.href=d;a.rel=\n\"stylesheet\";for(a.dataset.precedence=l=f[m++];g=f[m++];)a.setAttribute(g,f[m++]);g=a._p=new Promise(function(q,x){a.onload=u.bind(a,q);a.onerror=u.bind(a,x)});$RM.set(d,a)}d=a.getAttribute(\"media\");!g||d&&!matchMedia(d).matches||b.push(g);if(c)continue}else{a=v[e++];if(!a)break;l=a.getAttribute(\"data-precedence\");a.removeAttribute(\"media\")}c=r.get(l)||h;c===h&&(h=a);r.set(l,a);c?c.parentNode.insertBefore(a,c.nextSibling):(c=t.head,c.insertBefore(a,c.firstChild))}if(p=document.getElementById(n))p.previousSibling.data=\n\"$~\";Promise.all(b).then($RC.bind(null,n,w),$RX.bind(null,n,\"CSS failed to load\"))};$RR(\"`),gDe=kt('$RR(\"'),mDe=kt('\",\"'),_De=kt('\",'),yDe=kt('\"'),xDe=kt(\")<\\/script>\");kt('<template data-rci=\"\" data-bid=\"');kt('<template data-rri=\"\" data-bid=\"');kt('\" data-sid=\"');kt('\" data-sty=\"');var vDe=kt('$RX=function(b,c,d,e,f){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data=\"$!\",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),f&&(a.cstck=f),b._reactRetry&&b._reactRetry())};'),bDe=kt('$RX=function(b,c,d,e,f){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data=\"$!\",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),f&&(a.cstck=f),b._reactRetry&&b._reactRetry())};;$RX(\"'),wDe=kt('$RX(\"'),TDe=kt('\"'),EDe=kt(\",\"),SDe=kt(\")<\\/script>\");kt('<template data-rxi=\"\" data-bid=\"');kt('\" data-dgst=\"');kt('\" data-msg=\"');kt('\" data-stck=\"');kt('\" data-cstck=\"');var CDe=/[<\\u2028\\u2029]/g;function MDe(t){return JSON.stringify(t).replace(CDe,function(e){switch(e){case\"<\":return\"\\\\u003c\";case\"\\u2028\":return\"\\\\u2028\";case\"\\u2029\":return\"\\\\u2029\";default:throw Error(\"escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React\")}})}var IDe=/[&><\\u2028\\u2029]/g;function UT(t){return JSON.stringify(t).replace(IDe,function(e){switch(e){case\"&\":return\"\\\\u0026\";case\">\":return\"\\\\u003e\";case\"<\":return\"\\\\u003c\";case\"\\u2028\":return\"\\\\u2028\";case\"\\u2029\":return\"\\\\u2029\";default:throw Error(\"escapeJSObjectForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React\")}})}var PDe=kt(' media=\"not all\" data-precedence=\"'),RDe=kt('\" data-href=\"'),BDe=kt('\">'),DDe=kt(\"</style>\"),A5=!1,J9=!0;function LDe(t){var e=t.rules,n=t.hrefs,r=0;if(n.length){for(Ft(this,dx.startInlineStyle),Ft(this,PDe),Ft(this,t.precedence),Ft(this,RDe);r<n.length-1;r++)Ft(this,n[r]),Ft(this,iue);for(Ft(this,n[r]),Ft(this,BDe),r=0;r<e.length;r++)Ft(this,e[r]);J9=ao(this,DDe),A5=!0,e.length=0,n.length=0}}function ODe(t){return t.state!==2?A5=!0:!1}function rue(t,e,n){return A5=!1,J9=!0,dx=n,e.styles.forEach(LDe,t),dx=null,e.stylesheets.forEach(ODe),A5&&(n.stylesToHoist=!0),J9}function hf(t){for(var e=0;e<t.length;e++)Ft(this,t[e]);t.length=0}var ug=[];function FDe(t){El(ug,t.props);for(var e=0;e<ug.length;e++)Ft(this,ug[e]);ug.length=0,t.state=2}var kDe=kt(' data-precedence=\"'),NDe=kt('\" data-href=\"'),iue=kt(\" \"),zDe=kt('\">'),UDe=kt(\"</style>\");function VDe(t){var e=0<t.sheets.size;t.sheets.forEach(FDe,this),t.sheets.clear();var n=t.rules,r=t.hrefs;if(!e||r.length){if(Ft(this,dx.startInlineStyle),Ft(this,kDe),Ft(this,t.precedence),t=0,r.length){for(Ft(this,NDe);t<r.length-1;t++)Ft(this,r[t]),Ft(this,iue);Ft(this,r[t])}for(Ft(this,zDe),t=0;t<n.length;t++)Ft(this,n[t]);Ft(this,UDe),n.length=0,r.length=0}}function GDe(t){if(t.state===0){t.state=1;var e=t.props;for(El(ug,{rel:\"preload\",as:\"style\",href:t.props.href,crossOrigin:e.crossOrigin,fetchPriority:e.fetchPriority,integrity:e.integrity,media:e.media,hrefLang:e.hrefLang,referrerPolicy:e.referrerPolicy}),t=0;t<ug.length;t++)Ft(this,ug[t]);ug.length=0}}function HDe(t){t.sheets.forEach(GDe,this),t.sheets.clear()}kt('<link rel=\"expect\" href=\"#');kt('\" blocking=\"render\"/>');var oue=kt(' id=\"');function s5(t,e){(e.instructions&32)===0&&(e.instructions|=32,t.push(oue,gn(Cr(\"_\"+e.idPrefix+\"R_\")),qo))}var mce=kt(\"[\"),_ce=kt(\",[\"),$9=kt(\",\"),G9=kt(\"]\");function WDe(t,e){Ft(t,mce);var n=mce;e.stylesheets.forEach(function(r){if(r.state!==2)if(r.state===3)Ft(t,n),Ft(t,gn(UT(\"\"+r.props.href))),Ft(t,G9),n=_ce;else{Ft(t,n);var i=r.props[\"data-precedence\"],o=r.props,s=VT(\"\"+r.props.href);Ft(t,gn(UT(s))),i=\"\"+i,Ft(t,$9),Ft(t,gn(UT(i)));for(var c in o)if(Uo.call(o,c)&&(i=o[c],i!=null))switch(c){case\"href\":case\"rel\":case\"precedence\":case\"data-precedence\":break;case\"children\":case\"dangerouslySetInnerHTML\":throw Error(Ln(399,\"link\"));default:jDe(t,c,i)}Ft(t,G9),n=_ce,r.state=3}}),Ft(t,G9)}function jDe(t,e,n){var r=e.toLowerCase();switch(typeof n){case\"function\":case\"symbol\":return}switch(e){case\"innerHTML\":case\"dangerouslySetInnerHTML\":case\"suppressContentEditableWarning\":case\"suppressHydrationWarning\":case\"style\":case\"ref\":return;case\"className\":r=\"class\",e=\"\"+n;break;case\"hidden\":if(n===!1)return;e=\"\";break;case\"src\":case\"href\":n=VT(n),e=\"\"+n;break;default:if(2<e.length&&(e[0]===\"o\"||e[0]===\"O\")&&(e[1]===\"n\"||e[1]===\"N\")||!g7(e))return;e=\"\"+n}Ft(t,$9),Ft(t,gn(UT(r))),Ft(t,$9),Ft(t,gn(UT(e)))}function e7(){return{styles:new Set,stylesheets:new Set,suspenseyImages:!1}}function XDe(t){var e=Ja||null;if(e){var n=e.resumableState,r=e.renderState;if(typeof t==\"string\"&&t){if(!n.dnsResources.hasOwnProperty(t)){n.dnsResources[t]=null,n=r.headers;var i,o;(o=n&&0<n.remainingCapacity)&&(o=(i=\"<\"+(\"\"+t).replace(m7,_7)+\">; rel=dns-prefetch\",0<=(n.remainingCapacity-=i.length+2))),o?(r.resets.dns[t]=null,n.preconnects&&(n.preconnects+=\", \"),n.preconnects+=i):(i=[],El(i,{href:t,rel:\"dns-prefetch\"}),r.preconnects.add(i))}I_(e)}}else n0.D(t)}function YDe(t,e){var n=Ja||null;if(n){var r=n.resumableState,i=n.renderState;if(typeof t==\"string\"&&t){var o=e===\"use-credentials\"?\"credentials\":typeof e==\"string\"?\"anonymous\":\"default\";if(!r.connectResources[o].hasOwnProperty(t)){r.connectResources[o][t]=null,r=i.headers;var s,c;if(c=r&&0<r.remainingCapacity){if(c=\"<\"+(\"\"+t).replace(m7,_7)+\">; rel=preconnect\",typeof e==\"string\"){var d=(\"\"+e).replace(t7,n7);c+='; crossorigin=\"'+d+'\"'}c=(s=c,0<=(r.remainingCapacity-=s.length+2))}c?(i.resets.connect[o][t]=null,r.preconnects&&(r.preconnects+=\", \"),r.preconnects+=s):(o=[],El(o,{rel:\"preconnect\",href:t,crossOrigin:e}),i.preconnects.add(o))}I_(n)}}else n0.C(t,e)}function ZDe(t,e,n){var r=Ja||null;if(r){var i=r.resumableState,o=r.renderState;if(e&&t){switch(e){case\"image\":if(n)var s=n.imageSrcSet,c=n.imageSizes,d=n.fetchPriority;var m=s?s+`\n`+(c||\"\"):t;if(i.imageResources.hasOwnProperty(m))return;i.imageResources[m]=uh,i=o.headers;var b;i&&0<i.remainingCapacity&&typeof s!=\"string\"&&d===\"high\"&&(b=g5(t,e,n),0<=(i.remainingCapacity-=b.length+2))?(o.resets.image[m]=uh,i.highImagePreloads&&(i.highImagePreloads+=\", \"),i.highImagePreloads+=b):(i=[],El(i,Ic({rel:\"preload\",href:s?void 0:t,as:e},n)),d===\"high\"?o.highImagePreloads.add(i):(o.bulkPreloads.add(i),o.preloads.images.set(m,i)));break;case\"style\":if(i.styleResources.hasOwnProperty(t))return;s=[],El(s,Ic({rel:\"preload\",href:t,as:e},n)),i.styleResources[t]=!n||typeof n.crossOrigin!=\"string\"&&typeof n.integrity!=\"string\"?uh:[n.crossOrigin,n.integrity],o.preloads.stylesheets.set(t,s),o.bulkPreloads.add(s);break;case\"script\":if(i.scriptResources.hasOwnProperty(t))return;s=[],o.preloads.scripts.set(t,s),o.bulkPreloads.add(s),El(s,Ic({rel:\"preload\",href:t,as:e},n)),i.scriptResources[t]=!n||typeof n.crossOrigin!=\"string\"&&typeof n.integrity!=\"string\"?uh:[n.crossOrigin,n.integrity];break;default:if(i.unknownResources.hasOwnProperty(e)){if(s=i.unknownResources[e],s.hasOwnProperty(t))return}else s={},i.unknownResources[e]=s;if(s[t]=uh,(i=o.headers)&&0<i.remainingCapacity&&e===\"font\"&&(m=g5(t,e,n),0<=(i.remainingCapacity-=m.length+2)))o.resets.font[t]=uh,i.fontPreloads&&(i.fontPreloads+=\", \"),i.fontPreloads+=m;else switch(i=[],t=Ic({rel:\"preload\",href:t,as:e},n),El(i,t),e){case\"font\":o.fontPreloads.add(i);break;default:o.bulkPreloads.add(i)}}I_(r)}}else n0.L(t,e,n)}function qDe(t,e){var n=Ja||null;if(n){var r=n.resumableState,i=n.renderState;if(t){var o=e&&typeof e.as==\"string\"?e.as:\"script\";switch(o){case\"script\":if(r.moduleScriptResources.hasOwnProperty(t))return;o=[],r.moduleScriptResources[t]=!e||typeof e.crossOrigin!=\"string\"&&typeof e.integrity!=\"string\"?uh:[e.crossOrigin,e.integrity],i.preloads.moduleScripts.set(t,o);break;default:if(r.moduleUnknownResources.hasOwnProperty(o)){var s=r.unknownResources[o];if(s.hasOwnProperty(t))return}else s={},r.moduleUnknownResources[o]=s;o=[],s[t]=uh}El(o,Ic({rel:\"modulepreload\",href:t},e)),i.bulkPreloads.add(o),I_(n)}}else n0.m(t,e)}function QDe(t,e,n){var r=Ja||null;if(r){var i=r.resumableState,o=r.renderState;if(t){e=e||\"default\";var s=o.styles.get(e),c=i.styleResources.hasOwnProperty(t)?i.styleResources[t]:void 0;c!==null&&(i.styleResources[t]=null,s||(s={precedence:gn(Cr(e)),rules:[],hrefs:[],sheets:new Map},o.styles.set(e,s)),e={state:0,props:Ic({rel:\"stylesheet\",href:t,\"data-precedence\":e},n)},c&&(c.length===2&&WT(e.props,c),(o=o.preloads.stylesheets.get(t))&&0<o.length?o.length=0:e.state=1),s.sheets.set(t,e),I_(r))}}else n0.S(t,e,n)}function KDe(t,e){var n=Ja||null;if(n){var r=n.resumableState,i=n.renderState;if(t){var o=r.scriptResources.hasOwnProperty(t)?r.scriptResources[t]:void 0;o!==null&&(r.scriptResources[t]=null,e=Ic({src:t,async:!0},e),o&&(o.length===2&&WT(e,o),t=i.preloads.scripts.get(t))&&(t.length=0),t=[],i.scripts.add(t),p5(t,e),I_(n))}}else n0.X(t,e)}function JDe(t,e){var n=Ja||null;if(n){var r=n.resumableState,i=n.renderState;if(t){var o=r.moduleScriptResources.hasOwnProperty(t)?r.moduleScriptResources[t]:void 0;o!==null&&(r.moduleScriptResources[t]=null,e=Ic({src:t,type:\"module\",async:!0},e),o&&(o.length===2&&WT(e,o),t=i.preloads.moduleScripts.get(t))&&(t.length=0),t=[],i.scripts.add(t),p5(t,e),I_(n))}}else n0.M(t,e)}function WT(t,e){t.crossOrigin==null&&(t.crossOrigin=e[0]),t.integrity==null&&(t.integrity=e[1])}function g5(t,e,n){t=(\"\"+t).replace(m7,_7),e=(\"\"+e).replace(t7,n7),e=\"<\"+t+'>; rel=preload; as=\"'+e+'\"';for(var r in n)Uo.call(n,r)&&(t=n[r],typeof t==\"string\"&&(e+=\"; \"+r.toLowerCase()+'=\"'+(\"\"+t).replace(t7,n7)+'\"'));return e}var m7=/[<>\\r\\n]/g;function _7(t){switch(t){case\"<\":return\"%3C\";case\">\":return\"%3E\";case`\n`:return\"%0A\";case\"\\r\":return\"%0D\";default:throw Error(\"escapeLinkHrefForHeaderContextReplacer encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React\")}}var t7=/[\"';,\\r\\n]/g;function n7(t){switch(t){case'\"':return\"%22\";case\"'\":return\"%27\";case\";\":return\"%3B\";case\",\":return\"%2C\";case`\n`:return\"%0A\";case\"\\r\":return\"%0D\";default:throw Error(\"escapeStringForLinkHeaderQuotedParamValueContextReplacer encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React\")}}function $De(t){this.styles.add(t)}function eLe(t){this.stylesheets.add(t)}function px(t,e){e.styles.forEach($De,t),e.stylesheets.forEach(eLe,t),e.suspenseyImages&&(t.suspenseyImages=!0)}function sue(t){return 0<t.stylesheets.size||t.suspenseyImages}var tLe=Function.prototype.bind,nLe=Symbol.for(\"react.client.reference\");function m5(t){if(t==null)return null;if(typeof t==\"function\")return t.$$typeof===nLe?null:t.displayName||t.name||null;if(typeof t==\"string\")return t;switch(t){case Oce:return\"Fragment\";case kce:return\"Profiler\";case Fce:return\"StrictMode\";case E5:return\"Suspense\";case d7:return\"SuspenseList\";case zce:return\"Activity\"}if(typeof t==\"object\")switch(t.$$typeof){case Lce:return\"Portal\";case T5:return t.displayName||\"Context\";case Nce:return(t._context.displayName||\"Context\")+\".Consumer\";case f7:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||\"\",t=t!==\"\"?\"ForwardRef(\"+t+\")\":\"ForwardRef\"),t;case p7:return e=t.displayName||null,e!==null?e:m5(t.type)||\"Memo\";case S5:e=t._payload,t=t._init;try{return m5(t(e))}catch{}}return null}var yce={},E_=null;function M5(t,e){if(t!==e){t.context._currentValue=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(Ln(401))}else{if(n===null)throw Error(Ln(401));M5(t,n)}e.context._currentValue=e.value}}function aue(t){t.context._currentValue=t.parentValue,t=t.parent,t!==null&&aue(t)}function lue(t){var e=t.parent;e!==null&&lue(e),t.context._currentValue=t.value}function cue(t,e){if(t.context._currentValue=t.parentValue,t=t.parent,t===null)throw Error(Ln(402));t.depth===e.depth?M5(t,e):cue(t,e)}function uue(t,e){var n=e.parent;if(n===null)throw Error(Ln(402));t.depth===n.depth?M5(t,n):uue(t,n),e.context._currentValue=e.value}function cg(t){var e=E_;e!==t&&(e===null?lue(t):t===null?aue(e):e.depth===t.depth?M5(e,t):e.depth>t.depth?cue(e,t):uue(e,t),E_=t)}var xce={enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}},r7={id:1,overflow:\"\"};function S_(t,e,n){var r=t.id;t=t.overflow;var i=32-a5(r)-1;r&=~(1<<i),n+=1;var o=32-a5(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-a5(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var a5=Math.clz32?Math.clz32:oLe,rLe=Math.log,iLe=Math.LN2;function oLe(t){return t>>>=0,t===0?32:31-(rLe(t)/iLe|0)|0}function ic(){}var gu=Error(Ln(460));function sLe(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then(ic,ic),e=n),e.status){case\"fulfilled\":return e.value;case\"rejected\":throw e.reason;default:switch(typeof e.status==\"string\"?e.then(ic,ic):(t=e,t.status=\"pending\",t.then(function(r){if(e.status===\"pending\"){var i=e;i.status=\"fulfilled\",i.value=r}},function(r){if(e.status===\"pending\"){var i=e;i.status=\"rejected\",i.reason=r}})),e.status){case\"fulfilled\":return e.value;case\"rejected\":throw e.reason}throw l5=e,gu}}var l5=null;function _5(){if(l5===null)throw Error(Ln(459));var t=l5;return l5=null,t}function aLe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lLe=typeof Object.is==\"function\"?Object.is:aLe,r0=null,y7=null,x7=null,v7=null,c5=null,yo=null,NT=!1,y5=!1,jT=0,XT=0,YT=-1,x5=0,hx=null,hg=null,I5=0;function t0(){if(r0===null)throw Error(Ln(321));return r0}function vce(){if(0<I5)throw Error(Ln(312));return{memoizedState:null,queue:null,next:null}}function b7(){return yo===null?c5===null?(NT=!1,c5=yo=vce()):(NT=!0,yo=c5):yo.next===null?(NT=!1,yo=yo.next=vce()):(NT=!0,yo=yo.next),yo}function ux(){var t=hx;return hx=null,t}function ZT(){v7=x7=y7=r0=null,y5=!1,c5=null,I5=0,yo=hg=null}function hue(t,e){return typeof e==\"function\"?e(t):e}function bce(t,e,n){if(r0=t0(),yo=b7(),NT){var r=yo.queue;if(e=r.dispatch,hg!==null&&(n=hg.get(r),n!==void 0)){hg.delete(r),r=yo.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return yo.memoizedState=r,[r,e]}return[yo.memoizedState,e]}return t=t===hue?typeof e==\"function\"?e():e:n!==void 0?n(e):e,yo.memoizedState=t,t=yo.queue={last:null,dispatch:null},t=t.dispatch=cLe.bind(null,r0,t),[yo.memoizedState,t]}function wce(t,e){if(r0=t0(),yo=b7(),e=e===void 0?null:e,yo!==null){var n=yo.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!lLe(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),yo.memoizedState=[t,e],t}function cLe(t,e,n){if(25<=I5)throw Error(Ln(301));if(t===r0)if(y5=!0,t={action:n,next:null},hg===null&&(hg=new Map),n=hg.get(e),n===void 0)hg.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function uLe(){throw Error(Ln(440))}function hLe(){throw Error(Ln(394))}function fLe(){throw Error(Ln(479))}function Tce(t,e,n){t0();var r=XT++,i=x7;if(typeof t.$$FORM_ACTION==\"function\"){var o=null,s=v7;i=i.formState;var c=t.$$IS_SIGNATURE_EQUAL;if(i!==null&&typeof c==\"function\"){var d=i[1];c.call(t,i[2],i[3])&&(o=n!==void 0?\"p\"+n:\"k\"+Qle(JSON.stringify([s,null,r]),0),d===o&&(YT=r,e=i[0]))}var m=t.bind(null,e);return t=function(C){m(C)},typeof m.$$FORM_ACTION==\"function\"&&(t.$$FORM_ACTION=function(C){C=m.$$FORM_ACTION(C),n!==void 0&&(n+=\"\",C.action=n);var B=C.data;return B&&(o===null&&(o=n!==void 0?\"p\"+n:\"k\"+Qle(JSON.stringify([s,null,r]),0)),B.append(\"$ACTION_KEY\",o)),C}),[e,t,!1]}var b=t.bind(null,e);return[e,function(C){b(C)},!1]}function fue(t){var e=x5;return x5+=1,hx===null&&(hx=[]),sLe(hx,t,e)}function dLe(){throw Error(Ln(393))}var Ece={readContext:function(t){return t._currentValue},use:function(t){if(t!==null&&typeof t==\"object\"){if(typeof t.then==\"function\")return fue(t);if(t.$$typeof===T5)return t._currentValue}throw Error(Ln(438,String(t)))},useContext:function(t){return t0(),t._currentValue},useMemo:wce,useReducer:bce,useRef:function(t){r0=t0(),yo=b7();var e=yo.memoizedState;return e===null?(t={current:t},yo.memoizedState=t):e},useState:function(t){return bce(hue,t)},useInsertionEffect:ic,useLayoutEffect:ic,useCallback:function(t,e){return wce(function(){return t},e)},useImperativeHandle:ic,useEffect:ic,useDebugValue:ic,useDeferredValue:function(t,e){return t0(),e!==void 0?e:t},useTransition:function(){return t0(),[!1,hLe]},useId:function(){var t=y7.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-a5(t)-1)).toString(32)+e;var n=u5;if(n===null)throw Error(Ln(404));return e=jT++,t=\"_\"+n.idPrefix+\"R_\"+t,0<e&&(t+=\"H\"+e.toString(32)),t+\"_\"},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(Ln(407));return n()},useOptimistic:function(t){return t0(),[t,fLe]},useActionState:Tce,useFormState:Tce,useHostTransitionStatus:function(){return t0(),c6e},useMemoCache:function(t){for(var e=Array(t),n=0;n<t;n++)e[n]=KBe;return e},useCacheRefresh:function(){return dLe},useEffectEvent:function(){return uLe}},u5=null,pLe={getCacheForType:function(){throw Error(Ln(248))},cacheSignal:function(){throw Error(Ln(248))}},H9,Sce;function cx(t){if(H9===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\\n( *(at )?)/);H9=e&&e[1]||\"\",Sce=-1<n.stack.indexOf(`\n    at`)?\" (<anonymous>)\":-1<n.stack.indexOf(\"@\")?\"@unknown:0:0\":\"\"}return`\n`+H9+t+Sce}var W9=!1;function r5(t,e){if(!t||W9)return\"\";W9=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(e){var C=function(){throw Error()};if(Object.defineProperty(C.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(C,[])}catch(k){var B=k}Reflect.construct(t,[],C)}else{try{C.call()}catch(k){B=k}t.call(C.prototype)}}else{try{throw Error()}catch(k){B=k}(C=t())&&typeof C.catch==\"function\"&&C.catch(function(){})}}catch(k){if(k&&B&&typeof k.stack==\"string\")return[k.stack,B.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName=\"DetermineComponentFrameRoot\";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,\"name\");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,\"name\",{value:\"DetermineComponentFrameRoot\"});var o=r.DetermineComponentFrameRoot(),s=o[0],c=o[1];if(s&&c){var d=s.split(`\n`),m=c.split(`\n`);for(i=r=0;r<d.length&&!d[r].includes(\"DetermineComponentFrameRoot\");)r++;for(;i<m.length&&!m[i].includes(\"DetermineComponentFrameRoot\");)i++;if(r===d.length||i===m.length)for(r=d.length-1,i=m.length-1;1<=r&&0<=i&&d[r]!==m[i];)i--;for(;1<=r&&0<=i;r--,i--)if(d[r]!==m[i]){if(r!==1||i!==1)do if(r--,i--,0>i||d[r]!==m[i]){var b=`\n`+d[r].replace(\" at new \",\" at \");return t.displayName&&b.includes(\"<anonymous>\")&&(b=b.replace(\"<anonymous>\",t.displayName)),b}while(1<=r&&0<=i);break}}}finally{W9=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:\"\")?cx(n):\"\"}function due(t){if(typeof t==\"string\")return cx(t);if(typeof t==\"function\")return t.prototype&&t.prototype.isReactComponent?r5(t,!0):r5(t,!1);if(typeof t==\"object\"&&t!==null){switch(t.$$typeof){case f7:return r5(t.render,!1);case p7:return r5(t.type,!1);case S5:var e=t,n=e._payload;e=e._init;try{t=e(n)}catch{return cx(\"Lazy\")}return due(t)}if(typeof t.name==\"string\"){e:{n=t.name,e=t.env;var r=t.debugLocation;if(r!=null&&(t=Error.prepareStackTrace,Error.prepareStackTrace=void 0,r=r.stack,Error.prepareStackTrace=t,r.startsWith(`Error: react-stack-top-frame\n`)&&(r=r.slice(29)),t=r.indexOf(`\n`),t!==-1&&(r=r.slice(t+1)),t=r.indexOf(\"react_stack_bottom_frame\"),t!==-1&&(t=r.lastIndexOf(`\n`,t)),t=t!==-1?r=r.slice(0,t):\"\",r=t.lastIndexOf(`\n`),t=r===-1?t:t.slice(r+1),t.indexOf(n)!==-1)){n=`\n`+t;break e}n=cx(n+(e?\" [\"+e+\"]\":\"\"))}return n}}switch(t){case d7:return cx(\"SuspenseList\");case E5:return cx(\"Suspense\")}return\"\"}function Ax(t,e){return(500<e.byteSize||sue(e.contentState))&&e.contentPreamble===null}function ALe(t){if(typeof t==\"object\"&&t!==null&&typeof t.environmentName==\"string\"){var e=t.environmentName;t=[t].slice(0),typeof t[0]==\"string\"?t.splice(0,1,\"%c%s%c \"+t[0],\"background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px\",\" \"+e+\" \",\"\"):t.splice(0,0,\"%c%s%c\",\"background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px\",\" \"+e+\" \",\"\"),t.unshift(console),e=tLe.apply(console.error,t),e()}else console.error(t);return null}function pue(t,e,n,r,i,o,s,c,d,m,b){var C=new Set;this.destination=null,this.flushScheduled=!1,this.resumableState=t,this.renderState=e,this.rootFormatContext=n,this.progressiveChunkSize=r===void 0?12800:r,this.status=10,this.fatalError=null,this.pendingRootTasks=this.allPendingTasks=this.nextSegmentId=0,this.completedPreambleSegments=this.completedRootSegment=null,this.byteSize=0,this.abortableTasks=C,this.pingedTasks=[],this.clientRenderedBoundaries=[],this.completedBoundaries=[],this.partialBoundaries=[],this.trackedPostpones=null,this.onError=i===void 0?ALe:i,this.onPostpone=m===void 0?ic:m,this.onAllReady=o===void 0?ic:o,this.onShellReady=s===void 0?ic:s,this.onShellError=c===void 0?ic:c,this.onFatalError=d===void 0?ic:d,this.formState=b===void 0?null:b}function Aue(t,e,n,r,i,o,s,c,d,m,b,C){return e=new pue(e,n,r,i,o,s,c,d,m,b,C),n=fg(e,0,null,r,!1,!1),n.parentFlushed=!0,t=QT(e,null,t,-1,null,n,null,null,e.abortableTasks,null,r,null,r7,null,null),M_(t),e.pingedTasks.push(t),e}function gLe(t,e,n,r,i,o,s,c,d,m,b){return t=Aue(t,e,n,r,i,o,s,c,d,m,b,void 0),t.trackedPostpones={workingMap:new Map,rootNodes:[],rootSlots:null},t}function gue(t,e,n,r,i,o,s,c,d){return n=new pue(e.resumableState,n,e.rootFormatContext,e.progressiveChunkSize,r,i,o,s,c,d,null),n.nextSegmentId=e.nextSegmentId,typeof e.replaySlots==\"number\"?(r=fg(n,0,null,e.rootFormatContext,!1,!1),r.parentFlushed=!0,t=QT(n,null,t,-1,null,r,null,null,n.abortableTasks,null,e.rootFormatContext,null,r7,null,null),M_(t),n.pingedTasks.push(t),n):(t=w7(n,null,{nodes:e.replayNodes,slots:e.replaySlots,pendingTasks:0},t,-1,null,null,n.abortableTasks,null,e.rootFormatContext,null,r7,null,null),M_(t),n.pingedTasks.push(t),n)}function mLe(t,e,n,r,i,o,s,c,d){return t=gue(t,e,n,r,i,o,s,c,d),t.trackedPostpones={workingMap:new Map,rootNodes:[],rootSlots:null},t}var Ja=null;function mue(t,e){t.pingedTasks.push(e),t.pingedTasks.length===1&&(t.flushScheduled=t.destination!==null,t.trackedPostpones!==null||t.status===10?Hce(function(){return u7(t)}):A7(function(){return u7(t)}))}function qT(t,e,n,r,i){return n={status:0,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,row:e,completedSegments:[],byteSize:0,fallbackAbortableTasks:n,errorDigest:null,contentState:e7(),fallbackState:e7(),contentPreamble:r,fallbackPreamble:i,trackedContentKeyPath:null,trackedFallbackNode:null},e!==null&&(e.pendingTasks++,r=e.boundaries,r!==null&&(t.allPendingTasks++,n.pendingTasks++,r.push(n)),t=e.inheritedHoistables,t!==null&&px(n.contentState,t)),n}function QT(t,e,n,r,i,o,s,c,d,m,b,C,B,k,V){t.allPendingTasks++,i===null?t.pendingRootTasks++:i.pendingTasks++,k!==null&&k.pendingTasks++;var q={replay:null,node:n,childIndex:r,ping:function(){return mue(t,q)},blockedBoundary:i,blockedSegment:o,blockedPreamble:s,hoistableState:c,abortSet:d,keyPath:m,formatContext:b,context:C,treeContext:B,row:k,componentStack:V,thenableState:e};return d.add(q),q}function w7(t,e,n,r,i,o,s,c,d,m,b,C,B,k){t.allPendingTasks++,o===null?t.pendingRootTasks++:o.pendingTasks++,B!==null&&B.pendingTasks++,n.pendingTasks++;var V={replay:n,node:r,childIndex:i,ping:function(){return mue(t,V)},blockedBoundary:o,blockedSegment:null,blockedPreamble:null,hoistableState:s,abortSet:c,keyPath:d,formatContext:m,context:b,treeContext:C,row:B,componentStack:k,thenableState:e};return c.add(V),V}function fg(t,e,n,r,i,o){return{status:0,parentFlushed:!1,id:-1,index:e,chunks:[],children:[],preambleChildren:[],parentFormatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function M_(t){var e=t.node;if(typeof e==\"object\"&&e!==null)switch(e.$$typeof){case Dce:t.componentStack={parent:t.componentStack,type:e.type}}}function i7(t){return t===null?null:{parent:t.parent,type:\"Suspense Fallback\"}}function dg(t){var e={};return t&&Object.defineProperty(e,\"componentStack\",{configurable:!0,enumerable:!0,get:function(){try{var n=\"\",r=t;do n+=due(r.type),r=r.parent;while(r);var i=n}catch(o){i=`\nError generating stack: `+o.message+`\n`+o.stack}return Object.defineProperty(e,\"componentStack\",{value:i}),i}}),e}function Sl(t,e,n){if(t=t.onError,e=t(e,n),e==null||typeof e==\"string\")return e}function KT(t,e){var n=t.onShellError,r=t.onFatalError;n(e),r(e),t.destination!==null?(t.status=14,jce(t.destination,e)):(t.status=13,t.fatalError=e)}function Cl(t,e){T7(t,e.next,e.hoistables)}function T7(t,e,n){for(;e!==null;){n!==null&&(px(e.hoistables,n),e.inheritedHoistables=n);var r=e.boundaries;if(r!==null){e.boundaries=null;for(var i=0;i<r.length;i++){var o=r[i];n!==null&&px(o.contentState,n),pg(t,o,null,null)}}if(e.pendingTasks--,0<e.pendingTasks)break;n=e.hoistables,e=e.next}}function o7(t,e){var n=e.boundaries;if(n!==null&&e.pendingTasks===n.length){for(var r=!0,i=0;i<n.length;i++){var o=n[i];if(o.pendingTasks!==1||o.parentFlushed||Ax(t,o)){r=!1;break}}r&&T7(t,e,e.hoistables)}}function zT(t){var e={pendingTasks:1,boundaries:null,hoistables:e7(),inheritedHoistables:null,together:!1,next:null};return t!==null&&0<t.pendingTasks&&(e.pendingTasks++,e.boundaries=[],t.next=e),e}function Cce(t,e,n,r,i){var o=e.keyPath,s=e.treeContext,c=e.row;e.keyPath=n,n=r.length;var d=null;if(e.replay!==null){var m=e.replay.slots;if(m!==null&&typeof m==\"object\")for(var b=0;b<n;b++){var C=i!==\"backwards\"&&i!==\"unstable_legacy-backwards\"?b:n-1-b,B=r[C];e.row=d=zT(d),e.treeContext=S_(s,n,C);var k=m[C];typeof k==\"number\"?(P5(t,e,k,B,C),delete m[C]):Ma(t,e,B,C),--d.pendingTasks===0&&Cl(t,d)}else for(m=0;m<n;m++)b=i!==\"backwards\"&&i!==\"unstable_legacy-backwards\"?m:n-1-m,C=r[b],e.row=d=zT(d),e.treeContext=S_(s,n,b),Ma(t,e,C,b),--d.pendingTasks===0&&Cl(t,d)}else if(i!==\"backwards\"&&i!==\"unstable_legacy-backwards\")for(i=0;i<n;i++)m=r[i],e.row=d=zT(d),e.treeContext=S_(s,n,i),Ma(t,e,m,i),--d.pendingTasks===0&&Cl(t,d);else{for(i=e.blockedSegment,m=i.children.length,b=i.chunks.length,C=n-1;0<=C;C--){B=r[C],e.row=d=zT(d),e.treeContext=S_(s,n,C),k=fg(t,b,null,e.formatContext,C===0?i.lastPushedText:!0,!0),i.children.splice(m,0,k),e.blockedSegment=k;try{Ma(t,e,B,C),k.lastPushedText&&k.textEmbedded&&k.chunks.push(ff),k.status=1,fx(t,e.blockedBoundary,k),--d.pendingTasks===0&&Cl(t,d)}catch(V){throw k.status=t.status===12?3:4,V}}e.blockedSegment=i,i.lastPushedText=!1}c!==null&&d!==null&&0<d.pendingTasks&&(c.pendingTasks++,d.next=c),e.treeContext=s,e.row=c,e.keyPath=o}function Mce(t,e,n,r,i,o){var s=e.thenableState;for(e.thenableState=null,r0={},y7=e,x7=t,v7=n,XT=jT=0,YT=-1,x5=0,hx=s,t=r(i,o);y5;)y5=!1,XT=jT=0,YT=-1,x5=0,I5+=1,yo=null,t=r(i,o);return ZT(),t}function Ice(t,e,n,r,i,o,s){var c=!1;if(o!==0&&t.formState!==null){var d=e.blockedSegment;if(d!==null){c=!0,d=d.chunks;for(var m=0;m<o;m++)m===s?d.push(y6e):d.push(x6e)}}o=e.keyPath,e.keyPath=n,i?(n=e.treeContext,e.treeContext=S_(n,1,0),Ma(t,e,r,-1),e.treeContext=n):c?Ma(t,e,r,-1):hh(t,e,r,-1),e.keyPath=o}function v5(t,e,n,r,i,o){if(typeof r==\"function\")if(r.prototype&&r.prototype.isReactComponent){var s=i;if(\"ref\"in i){s={};for(var c in i)c!==\"ref\"&&(s[c]=i[c])}var d=r.defaultProps;if(d){s===i&&(s=Ic({},s,i));for(var m in d)s[m]===void 0&&(s[m]=d[m])}i=s,s=yce,d=r.contextType,typeof d==\"object\"&&d!==null&&(s=d._currentValue),s=new r(i,s);var b=s.state!==void 0?s.state:null;if(s.updater=xce,s.props=i,s.state=b,d={queue:[],replace:!1},s._reactInternals=d,o=r.contextType,s.context=typeof o==\"object\"&&o!==null?o._currentValue:yce,o=r.getDerivedStateFromProps,typeof o==\"function\"&&(o=o(i,b),b=o==null?b:Ic({},b,o),s.state=b),typeof r.getDerivedStateFromProps!=\"function\"&&typeof s.getSnapshotBeforeUpdate!=\"function\"&&(typeof s.UNSAFE_componentWillMount==\"function\"||typeof s.componentWillMount==\"function\"))if(r=s.state,typeof s.componentWillMount==\"function\"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount==\"function\"&&s.UNSAFE_componentWillMount(),r!==s.state&&xce.enqueueReplaceState(s,s.state,null),d.queue!==null&&0<d.queue.length)if(r=d.queue,o=d.replace,d.queue=null,d.replace=!1,o&&r.length===1)s.state=r[0];else{for(d=o?r[0]:s.state,b=!0,o=o?1:0;o<r.length;o++)m=r[o],m=typeof m==\"function\"?m.call(s,d,i,void 0):m,m!=null&&(b?(b=!1,d=Ic({},d,m)):Ic(d,m));s.state=d}else d.queue=null;if(r=s.render(),t.status===12)throw null;i=e.keyPath,e.keyPath=n,hh(t,e,r,-1),e.keyPath=i}else{if(r=Mce(t,e,n,r,i,void 0),t.status===12)throw null;Ice(t,e,n,r,jT!==0,XT,YT)}else if(typeof r==\"string\")if(s=e.blockedSegment,s===null)s=i.children,d=e.formatContext,b=e.keyPath,e.formatContext=rce(d,r,i),e.keyPath=n,Ma(t,e,s,-1),e.formatContext=d,e.keyPath=b;else{if(b=S6e(s.chunks,r,i,t.resumableState,t.renderState,e.blockedPreamble,e.hoistableState,e.formatContext,s.lastPushedText),s.lastPushedText=!1,d=e.formatContext,o=e.keyPath,e.keyPath=n,(e.formatContext=rce(d,r,i)).insertionMode===3){n=fg(t,0,null,e.formatContext,!1,!1),s.preambleChildren.push(n),e.blockedSegment=n;try{n.status=6,Ma(t,e,b,-1),n.lastPushedText&&n.textEmbedded&&n.chunks.push(ff),n.status=1,fx(t,e.blockedBoundary,n)}finally{e.blockedSegment=s}}else Ma(t,e,b,-1);e.formatContext=d,e.keyPath=o;e:{switch(e=s.chunks,t=t.resumableState,r){case\"title\":case\"style\":case\"script\":case\"area\":case\"base\":case\"br\":case\"col\":case\"embed\":case\"hr\":case\"img\":case\"input\":case\"keygen\":case\"link\":case\"meta\":case\"param\":case\"source\":case\"track\":case\"wbr\":break e;case\"body\":if(1>=d.insertionMode){t.hasBody=!0;break e}break;case\"html\":if(d.insertionMode===0){t.hasHtml=!0;break e}break;case\"head\":if(1>=d.insertionMode)break e}e.push(C_(r))}s.lastPushedText=!1}else{switch(r){case QBe:case Fce:case kce:case Oce:r=e.keyPath,e.keyPath=n,hh(t,e,i.children,-1),e.keyPath=r;return;case zce:r=e.blockedSegment,r===null?i.mode!==\"hidden\"&&(r=e.keyPath,e.keyPath=n,Ma(t,e,i.children,-1),e.keyPath=r):i.mode!==\"hidden\"&&(r.chunks.push(P6e),r.lastPushedText=!1,s=e.keyPath,e.keyPath=n,Ma(t,e,i.children,-1),e.keyPath=s,r.chunks.push(R6e),r.lastPushedText=!1);return;case d7:e:{if(r=i.children,i=i.revealOrder,i===\"forwards\"||i===\"backwards\"||i===\"unstable_legacy-backwards\"){if(f5(r)){Cce(t,e,n,r,i);break e}if((s=Uce(r))&&(s=s.call(r))){if(d=s.next(),!d.done){do d=s.next();while(!d.done);Cce(t,e,n,r,i)}break e}}i===\"together\"?(i=e.keyPath,s=e.row,d=e.row=zT(null),d.boundaries=[],d.together=!0,e.keyPath=n,hh(t,e,r,-1),--d.pendingTasks===0&&Cl(t,d),e.keyPath=i,e.row=s,s!==null&&0<d.pendingTasks&&(s.pendingTasks++,d.next=s)):(i=e.keyPath,e.keyPath=n,hh(t,e,r,-1),e.keyPath=i)}return;case JBe:case qBe:throw Error(Ln(343));case E5:e:if(e.replay!==null){r=e.keyPath,s=e.formatContext,d=e.row,e.keyPath=n,e.formatContext=o5(t.resumableState,s),e.row=null,n=i.children;try{Ma(t,e,n,-1)}finally{e.keyPath=r,e.formatContext=s,e.row=d}}else{r=e.keyPath,o=e.formatContext;var C=e.row;m=e.blockedBoundary,c=e.blockedPreamble;var B=e.hoistableState,k=e.blockedSegment,V=i.fallback;i=i.children;var q=new Set,K=2>e.formatContext.insertionMode?qT(t,e.row,q,GT(),GT()):qT(t,e.row,q,null,null);t.trackedPostpones!==null&&(K.trackedContentKeyPath=n);var Y=fg(t,k.chunks.length,K,e.formatContext,!1,!1);k.children.push(Y),k.lastPushedText=!1;var ee=fg(t,0,null,e.formatContext,!1,!1);if(ee.parentFlushed=!0,t.trackedPostpones!==null){s=e.componentStack,d=[n[0],\"Suspense Fallback\",n[2]],b=[d[1],d[2],[],null],t.trackedPostpones.workingMap.set(d,b),K.trackedFallbackNode=b,e.blockedSegment=Y,e.blockedPreamble=K.fallbackPreamble,e.keyPath=d,e.formatContext=q9(t.resumableState,o),e.componentStack=i7(s),Y.status=6;try{Ma(t,e,V,-1),Y.lastPushedText&&Y.textEmbedded&&Y.chunks.push(ff),Y.status=1,fx(t,m,Y)}catch(J){throw Y.status=t.status===12?3:4,J}finally{e.blockedSegment=k,e.blockedPreamble=c,e.keyPath=r,e.formatContext=o}e=QT(t,null,i,-1,K,ee,K.contentPreamble,K.contentState,e.abortSet,n,o5(t.resumableState,e.formatContext),e.context,e.treeContext,null,s),M_(e),t.pingedTasks.push(e)}else{e.blockedBoundary=K,e.blockedPreamble=K.contentPreamble,e.hoistableState=K.contentState,e.blockedSegment=ee,e.keyPath=n,e.formatContext=o5(t.resumableState,o),e.row=null,ee.status=6;try{if(Ma(t,e,i,-1),ee.lastPushedText&&ee.textEmbedded&&ee.chunks.push(ff),ee.status=1,fx(t,K,ee),JT(K,ee),K.pendingTasks===0&&K.status===0){if(K.status=1,!Ax(t,K)){C!==null&&--C.pendingTasks===0&&Cl(t,C),t.pendingRootTasks===0&&e.blockedPreamble&&nE(t);break e}}else C!==null&&C.together&&o7(t,C)}catch(J){K.status=4,t.status===12?(ee.status=3,s=t.fatalError):(ee.status=4,s=J),d=dg(e.componentStack),b=Sl(t,s,d),K.errorDigest=b,E7(t,K)}finally{e.blockedBoundary=m,e.blockedPreamble=c,e.hoistableState=B,e.blockedSegment=k,e.keyPath=r,e.formatContext=o,e.row=C}e=QT(t,null,V,-1,m,Y,K.fallbackPreamble,K.fallbackState,q,[n[0],\"Suspense Fallback\",n[2]],q9(t.resumableState,e.formatContext),e.context,e.treeContext,e.row,i7(e.componentStack)),M_(e),t.pingedTasks.push(e)}}return}if(typeof r==\"object\"&&r!==null)switch(r.$$typeof){case f7:if(\"ref\"in i)for(k in s={},i)k!==\"ref\"&&(s[k]=i[k]);else s=i;r=Mce(t,e,n,r.render,s,o),Ice(t,e,n,r,jT!==0,XT,YT);return;case p7:v5(t,e,n,r.type,i,o);return;case T5:if(d=i.children,s=e.keyPath,i=i.value,b=r._currentValue,r._currentValue=i,o=E_,E_=r={parent:o,depth:o===null?0:o.depth+1,context:r,parentValue:b,value:i},e.context=r,e.keyPath=n,hh(t,e,d,-1),t=E_,t===null)throw Error(Ln(403));t.context._currentValue=t.parentValue,t=E_=t.parent,e.context=t,e.keyPath=s;return;case Nce:i=i.children,r=i(r._context._currentValue),i=e.keyPath,e.keyPath=n,hh(t,e,r,-1),e.keyPath=i;return;case S5:if(s=r._init,r=s(r._payload),t.status===12)throw null;v5(t,e,n,r,i,o);return}throw Error(Ln(130,r==null?r:typeof r,\"\"))}}function P5(t,e,n,r,i){var o=e.replay,s=e.blockedBoundary,c=fg(t,0,null,e.formatContext,!1,!1);c.id=n,c.parentFlushed=!0;try{e.replay=null,e.blockedSegment=c,Ma(t,e,r,i),c.status=1,fx(t,s,c),s===null?t.completedRootSegment=c:(JT(s,c),s.parentFlushed&&t.partialBoundaries.push(s))}finally{e.replay=o,e.blockedSegment=null}}function hh(t,e,n,r){e.replay!==null&&typeof e.replay.slots==\"number\"?P5(t,e,e.replay.slots,n,r):(e.node=n,e.childIndex=r,n=e.componentStack,M_(e),s7(t,e),e.componentStack=n)}function s7(t,e){var n=e.node,r=e.childIndex;if(n!==null){if(typeof n==\"object\"){switch(n.$$typeof){case Dce:var i=n.type,o=n.key,s=n.props;n=s.ref;var c=n!==void 0?n:null,d=m5(i),m=o??(r===-1?0:r);if(o=[e.keyPath,d,m],e.replay!==null)e:{var b=e.replay;for(r=b.nodes,n=0;n<r.length;n++){var C=r[n];if(m===C[1]){if(C.length===4){if(d!==null&&d!==C[0])throw Error(Ln(490,C[0],d));var B=C[2];d=C[3],m=e.node,e.replay={nodes:B,slots:d,pendingTasks:1};try{if(v5(t,e,o,i,s,c),e.replay.pendingTasks===1&&0<e.replay.nodes.length)throw Error(Ln(488));e.replay.pendingTasks--}catch(Ee){if(typeof Ee==\"object\"&&Ee!==null&&(Ee===gu||typeof Ee.then==\"function\"))throw e.node===m?e.replay=b:r.splice(n,1),Ee;e.replay.pendingTasks--,s=dg(e.componentStack),o=t,t=e.blockedBoundary,i=Ee,s=Sl(o,i,s),tE(o,t,B,d,i,s)}e.replay=b}else{if(i!==E5)throw Error(Ln(490,\"Suspense\",m5(i)||\"Unknown\"));t:{b=void 0,i=C[5],c=C[2],d=C[3],m=C[4]===null?[]:C[4][2],C=C[4]===null?null:C[4][3];var k=e.keyPath,V=e.formatContext,q=e.row,K=e.replay,Y=e.blockedBoundary,ee=e.hoistableState,J=s.children,se=s.fallback,xe=new Set;s=2>e.formatContext.insertionMode?qT(t,e.row,xe,GT(),GT()):qT(t,e.row,xe,null,null),s.parentFlushed=!0,s.rootSegmentID=i,e.blockedBoundary=s,e.hoistableState=s.contentState,e.keyPath=o,e.formatContext=o5(t.resumableState,V),e.row=null,e.replay={nodes:c,slots:d,pendingTasks:1};try{if(Ma(t,e,J,-1),e.replay.pendingTasks===1&&0<e.replay.nodes.length)throw Error(Ln(488));if(e.replay.pendingTasks--,s.pendingTasks===0&&s.status===0){s.status=1,t.completedBoundaries.push(s);break t}}catch(Ee){s.status=4,B=dg(e.componentStack),b=Sl(t,Ee,B),s.errorDigest=b,e.replay.pendingTasks--,t.clientRenderedBoundaries.push(s)}finally{e.blockedBoundary=Y,e.hoistableState=ee,e.replay=K,e.keyPath=k,e.formatContext=V,e.row=q}B=w7(t,null,{nodes:m,slots:C,pendingTasks:0},se,-1,Y,s.fallbackState,xe,[o[0],\"Suspense Fallback\",o[2]],q9(t.resumableState,e.formatContext),e.context,e.treeContext,e.row,i7(e.componentStack)),M_(B),t.pingedTasks.push(B)}}r.splice(n,1);break e}}}else v5(t,e,o,i,s,c);return;case Lce:throw Error(Ln(257));case S5:if(B=n._init,n=B(n._payload),t.status===12)throw null;hh(t,e,n,r);return}if(f5(n)){a7(t,e,n,r);return}if((B=Uce(n))&&(B=B.call(n))){if(n=B.next(),!n.done){s=[];do s.push(n.value),n=B.next();while(!n.done);a7(t,e,s,r)}return}if(typeof n.then==\"function\")return e.thenableState=null,hh(t,e,fue(n),r);if(n.$$typeof===T5)return hh(t,e,n._currentValue,r);throw r=Object.prototype.toString.call(n),Error(Ln(31,r===\"[object Object]\"?\"object with keys {\"+Object.keys(n).join(\", \")+\"}\":r))}typeof n==\"string\"?(r=e.blockedSegment,r!==null&&(r.lastPushedText=ice(r.chunks,n,t.renderState,r.lastPushedText))):(typeof n==\"number\"||typeof n==\"bigint\")&&(r=e.blockedSegment,r!==null&&(r.lastPushedText=ice(r.chunks,\"\"+n,t.renderState,r.lastPushedText)))}}function a7(t,e,n,r){var i=e.keyPath;if(r!==-1&&(e.keyPath=[e.keyPath,\"Fragment\",r],e.replay!==null)){for(var o=e.replay,s=o.nodes,c=0;c<s.length;c++){var d=s[c];if(d[1]===r){r=d[2],d=d[3],e.replay={nodes:r,slots:d,pendingTasks:1};try{if(a7(t,e,n,-1),e.replay.pendingTasks===1&&0<e.replay.nodes.length)throw Error(Ln(488));e.replay.pendingTasks--}catch(C){if(typeof C==\"object\"&&C!==null&&(C===gu||typeof C.then==\"function\"))throw C;e.replay.pendingTasks--,n=dg(e.componentStack);var m=e.blockedBoundary,b=C;n=Sl(t,b,n),tE(t,m,r,d,b,n)}e.replay=o,s.splice(c,1);break}}e.keyPath=i;return}if(o=e.treeContext,s=n.length,e.replay!==null&&(c=e.replay.slots,c!==null&&typeof c==\"object\")){for(r=0;r<s;r++)d=n[r],e.treeContext=S_(o,s,r),m=c[r],typeof m==\"number\"?(P5(t,e,m,d,r),delete c[r]):Ma(t,e,d,r);e.treeContext=o,e.keyPath=i;return}for(c=0;c<s;c++)r=n[c],e.treeContext=S_(o,s,c),Ma(t,e,r,c);e.treeContext=o,e.keyPath=i}function _ue(t,e,n){if(n.status=5,n.rootSegmentID=t.nextSegmentId++,t=n.trackedContentKeyPath,t===null)throw Error(Ln(486));var r=n.trackedFallbackNode,i=[],o=e.workingMap.get(t);return o===void 0?(n=[t[1],t[2],i,null,r,n.rootSegmentID],e.workingMap.set(t,n),w5(n,t[0],e),n):(o[4]=r,o[5]=n.rootSegmentID,o)}function l7(t,e,n,r){r.status=5;var i=n.keyPath,o=n.blockedBoundary;if(o===null)r.id=t.nextSegmentId++,e.rootSlots=r.id,t.completedRootSegment!==null&&(t.completedRootSegment.status=5);else{if(o!==null&&o.status===0){var s=_ue(t,e,o);if(o.trackedContentKeyPath===i&&n.childIndex===-1){r.id===-1&&(r.id=r.parentFlushed?o.rootSegmentID:t.nextSegmentId++),s[3]=r.id;return}}if(r.id===-1&&(r.id=r.parentFlushed&&o!==null?o.rootSegmentID:t.nextSegmentId++),n.childIndex===-1)i===null?e.rootSlots=r.id:(n=e.workingMap.get(i),n===void 0?(n=[i[1],i[2],[],r.id],w5(n,i[0],e)):n[3]=r.id);else{if(i===null){if(t=e.rootSlots,t===null)t=e.rootSlots={};else if(typeof t==\"number\")throw Error(Ln(491))}else if(o=e.workingMap,s=o.get(i),s===void 0)t={},s=[i[1],i[2],[],t],o.set(i,s),w5(s,i[0],e);else if(t=s[3],t===null)t=s[3]={};else if(typeof t==\"number\")throw Error(Ln(491));t[n.childIndex]=r.id}}}function E7(t,e){t=t.trackedPostpones,t!==null&&(e=e.trackedContentKeyPath,e!==null&&(e=t.workingMap.get(e),e!==void 0&&(e.length=4,e[2]=[],e[3]=null)))}function Pce(t,e,n){return w7(t,n,e.replay,e.node,e.childIndex,e.blockedBoundary,e.hoistableState,e.abortSet,e.keyPath,e.formatContext,e.context,e.treeContext,e.row,e.componentStack)}function Rce(t,e,n){var r=e.blockedSegment,i=fg(t,r.chunks.length,null,e.formatContext,r.lastPushedText,!0);return r.children.push(i),r.lastPushedText=!1,QT(t,n,e.node,e.childIndex,e.blockedBoundary,i,e.blockedPreamble,e.hoistableState,e.abortSet,e.keyPath,e.formatContext,e.context,e.treeContext,e.row,e.componentStack)}function Ma(t,e,n,r){var i=e.formatContext,o=e.context,s=e.keyPath,c=e.treeContext,d=e.componentStack,m=e.blockedSegment;if(m===null){m=e.replay;try{return hh(t,e,n,r)}catch(B){if(ZT(),n=B===gu?_5():B,t.status!==12&&typeof n==\"object\"&&n!==null){if(typeof n.then==\"function\"){r=B===gu?ux():null,t=Pce(t,e,r).ping,n.then(t,t),e.formatContext=i,e.context=o,e.keyPath=s,e.treeContext=c,e.componentStack=d,e.replay=m,cg(o);return}if(n.message===\"Maximum call stack size exceeded\"){n=B===gu?ux():null,n=Pce(t,e,n),t.pingedTasks.push(n),e.formatContext=i,e.context=o,e.keyPath=s,e.treeContext=c,e.componentStack=d,e.replay=m,cg(o);return}}}}else{var b=m.children.length,C=m.chunks.length;try{return hh(t,e,n,r)}catch(B){if(ZT(),m.children.length=b,m.chunks.length=C,n=B===gu?_5():B,t.status!==12&&typeof n==\"object\"&&n!==null){if(typeof n.then==\"function\"){m=n,n=B===gu?ux():null,t=Rce(t,e,n).ping,m.then(t,t),e.formatContext=i,e.context=o,e.keyPath=s,e.treeContext=c,e.componentStack=d,cg(o);return}if(n.message===\"Maximum call stack size exceeded\"){m=B===gu?ux():null,m=Rce(t,e,m),t.pingedTasks.push(m),e.formatContext=i,e.context=o,e.keyPath=s,e.treeContext=c,e.componentStack=d,cg(o);return}}}}throw e.formatContext=i,e.context=o,e.keyPath=s,e.treeContext=c,cg(o),n}function _Le(t){var e=t.blockedBoundary,n=t.blockedSegment;n!==null&&(n.status=3,pg(this,e,t.row,n))}function tE(t,e,n,r,i,o){for(var s=0;s<n.length;s++){var c=n[s];if(c.length===4)tE(t,e,c[2],c[3],i,o);else{c=c[5];var d=t,m=o,b=qT(d,null,new Set,null,null);b.parentFlushed=!0,b.rootSegmentID=c,b.status=4,b.errorDigest=m,b.parentFlushed&&d.clientRenderedBoundaries.push(b)}}if(n.length=0,r!==null){if(e===null)throw Error(Ln(487));if(e.status!==4&&(e.status=4,e.errorDigest=o,e.parentFlushed&&t.clientRenderedBoundaries.push(e)),typeof r==\"object\")for(var C in r)delete r[C]}}function c7(t,e,n){var r=t.blockedBoundary,i=t.blockedSegment;if(i!==null){if(i.status===6)return;i.status=3}var o=dg(t.componentStack);if(r===null){if(e.status!==13&&e.status!==14){if(r=t.replay,r===null){e.trackedPostpones!==null&&i!==null?(r=e.trackedPostpones,Sl(e,n,o),l7(e,r,t,i),pg(e,null,t.row,i)):(Sl(e,n,o),KT(e,n));return}r.pendingTasks--,r.pendingTasks===0&&0<r.nodes.length&&(i=Sl(e,n,o),tE(e,null,r.nodes,r.slots,n,i)),e.pendingRootTasks--,e.pendingRootTasks===0&&C7(e)}}else{var s=e.trackedPostpones;if(r.status!==4){if(s!==null&&i!==null)return Sl(e,n,o),l7(e,s,t,i),r.fallbackAbortableTasks.forEach(function(c){return c7(c,e,n)}),r.fallbackAbortableTasks.clear(),pg(e,r,t.row,i);r.status=4,i=Sl(e,n,o),r.status=4,r.errorDigest=i,E7(e,r),r.parentFlushed&&e.clientRenderedBoundaries.push(r)}r.pendingTasks--,i=r.row,i!==null&&--i.pendingTasks===0&&Cl(e,i),r.fallbackAbortableTasks.forEach(function(c){return c7(c,e,n)}),r.fallbackAbortableTasks.clear()}t=t.row,t!==null&&--t.pendingTasks===0&&Cl(e,t),e.allPendingTasks--,e.allPendingTasks===0&&b5(e)}function S7(t,e){try{var n=t.renderState,r=n.onHeaders;if(r){var i=n.headers;if(i){n.headers=null;var o=i.preconnects;if(i.fontPreloads&&(o&&(o+=\", \"),o+=i.fontPreloads),i.highImagePreloads&&(o&&(o+=\", \"),o+=i.highImagePreloads),!e){var s=n.styles.values(),c=s.next();e:for(;0<i.remainingCapacity&&!c.done;c=s.next())for(var d=c.value.sheets.values(),m=d.next();0<i.remainingCapacity&&!m.done;m=d.next()){var b=m.value,C=b.props,B=C.href,k=b.props,V=g5(k.href,\"style\",{crossOrigin:k.crossOrigin,integrity:k.integrity,nonce:k.nonce,type:k.type,fetchPriority:k.fetchPriority,referrerPolicy:k.referrerPolicy,media:k.media});if(0<=(i.remainingCapacity-=V.length+2))n.resets.style[B]=uh,o&&(o+=\", \"),o+=V,n.resets.style[B]=typeof C.crossOrigin==\"string\"||typeof C.integrity==\"string\"?[C.crossOrigin,C.integrity]:uh;else break e}}r(o?{Link:o}:{})}}}catch(q){Sl(t,q,{})}}function C7(t){t.trackedPostpones===null&&S7(t,!0),t.trackedPostpones===null&&nE(t),t.onShellError=ic,t=t.onShellReady,t()}function b5(t){S7(t,t.trackedPostpones===null?!0:t.completedRootSegment===null||t.completedRootSegment.status!==5),nE(t),t=t.onAllReady,t()}function JT(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null&&e.children[0].id===-1){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status!==1&&n.status!==3&&n.status!==4||JT(t,n)}else t.completedSegments.push(e)}function fx(t,e,n){if(t6e!==null){n=n.chunks;for(var r=0,i=0;i<n.length;i++)r+=n[i].byteLength;e===null?t.byteSize+=r:e.byteSize+=r}}function pg(t,e,n,r){if(n!==null&&(--n.pendingTasks===0?Cl(t,n):n.together&&o7(t,n)),t.allPendingTasks--,e===null){if(r!==null&&r.parentFlushed){if(t.completedRootSegment!==null)throw Error(Ln(389));t.completedRootSegment=r}t.pendingRootTasks--,t.pendingRootTasks===0&&C7(t)}else if(e.pendingTasks--,e.status!==4)if(e.pendingTasks===0){if(e.status===0&&(e.status=1),r!==null&&r.parentFlushed&&(r.status===1||r.status===3)&&JT(e,r),e.parentFlushed&&t.completedBoundaries.push(e),e.status===1)n=e.row,n!==null&&px(n.hoistables,e.contentState),Ax(t,e)||(e.fallbackAbortableTasks.forEach(_Le,t),e.fallbackAbortableTasks.clear(),n!==null&&--n.pendingTasks===0&&Cl(t,n)),t.pendingRootTasks===0&&t.trackedPostpones===null&&e.contentPreamble!==null&&nE(t);else if(e.status===5&&(e=e.row,e!==null)){if(t.trackedPostpones!==null){n=t.trackedPostpones;var i=e.next;if(i!==null&&(r=i.boundaries,r!==null))for(i.boundaries=null,i=0;i<r.length;i++){var o=r[i];_ue(t,n,o),pg(t,o,null,null)}}--e.pendingTasks===0&&Cl(t,e)}}else r===null||!r.parentFlushed||r.status!==1&&r.status!==3||(JT(e,r),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)),e=e.row,e!==null&&e.together&&o7(t,e);t.allPendingTasks===0&&b5(t)}function u7(t){if(t.status!==14&&t.status!==13){var e=E_,n=ax.H;ax.H=Ece;var r=ax.A;ax.A=pLe;var i=Ja;Ja=t;var o=u5;u5=t.resumableState;try{var s=t.pingedTasks,c;for(c=0;c<s.length;c++){var d=s[c],m=t,b=d.blockedSegment;if(b===null){var C=m;if(d.replay.pendingTasks!==0){cg(d.context);try{if(typeof d.replay.slots==\"number\"?P5(C,d,d.replay.slots,d.node,d.childIndex):s7(C,d),d.replay.pendingTasks===1&&0<d.replay.nodes.length)throw Error(Ln(488));d.replay.pendingTasks--,d.abortSet.delete(d),pg(C,d.blockedBoundary,d.row,null)}catch(mt){ZT();var B=mt===gu?_5():mt;if(typeof B==\"object\"&&B!==null&&typeof B.then==\"function\"){var k=d.ping;B.then(k,k),d.thenableState=mt===gu?ux():null}else{d.replay.pendingTasks--,d.abortSet.delete(d);var V=dg(d.componentStack);m=void 0;var q=C,K=d.blockedBoundary,Y=C.status===12?C.fatalError:B,ee=d.replay.nodes,J=d.replay.slots;m=Sl(q,Y,V),tE(q,K,ee,J,Y,m),C.pendingRootTasks--,C.pendingRootTasks===0&&C7(C),C.allPendingTasks--,C.allPendingTasks===0&&b5(C)}}finally{}}}else if(C=void 0,q=b,q.status===0){q.status=6,cg(d.context);var se=q.children.length,xe=q.chunks.length;try{s7(m,d),q.lastPushedText&&q.textEmbedded&&q.chunks.push(ff),d.abortSet.delete(d),q.status=1,fx(m,d.blockedBoundary,q),pg(m,d.blockedBoundary,d.row,q)}catch(mt){ZT(),q.children.length=se,q.chunks.length=xe;var Ee=mt===gu?_5():m.status===12?m.fatalError:mt;if(m.status===12&&m.trackedPostpones!==null){var Xe=m.trackedPostpones,Ne=dg(d.componentStack);d.abortSet.delete(d),Sl(m,Ee,Ne),l7(m,Xe,d,q),pg(m,d.blockedBoundary,d.row,q)}else if(typeof Ee==\"object\"&&Ee!==null&&typeof Ee.then==\"function\"){q.status=0,d.thenableState=mt===gu?ux():null;var be=d.ping;Ee.then(be,be)}else{var ge=dg(d.componentStack);d.abortSet.delete(d),q.status=4;var Qe=d.blockedBoundary,Ct=d.row;if(Ct!==null&&--Ct.pendingTasks===0&&Cl(m,Ct),m.allPendingTasks--,C=Sl(m,Ee,ge),Qe===null)KT(m,Ee);else if(Qe.pendingTasks--,Qe.status!==4){Qe.status=4,Qe.errorDigest=C,E7(m,Qe);var Mt=Qe.row;Mt!==null&&--Mt.pendingTasks===0&&Cl(m,Mt),Qe.parentFlushed&&m.clientRenderedBoundaries.push(Qe),m.pendingRootTasks===0&&m.trackedPostpones===null&&Qe.contentPreamble!==null&&nE(m)}m.allPendingTasks===0&&b5(m)}}finally{}}}s.splice(0,c),t.destination!==null&&R5(t,t.destination)}catch(mt){Sl(t,mt,{}),KT(t,mt)}finally{u5=o,ax.H=n,ax.A=r,n===Ece&&cg(e),Ja=i}}}function j9(t,e,n){e.preambleChildren.length&&n.push(e.preambleChildren);for(var r=!1,i=0;i<e.children.length;i++)r=yue(t,e.children[i],n)||r;return r}function yue(t,e,n){var r=e.boundary;if(r===null)return j9(t,e,n);var i=r.contentPreamble,o=r.fallbackPreamble;if(i===null||o===null)return!1;switch(r.status){case 1:if(pce(t.renderState,i),t.byteSize+=r.byteSize,e=r.completedSegments[0],!e)throw Error(Ln(391));return j9(t,e,n);case 5:if(t.trackedPostpones!==null)return!0;case 4:if(e.status===1)return pce(t.renderState,o),j9(t,e,n);default:return!0}}function nE(t){if(t.completedRootSegment&&t.completedPreambleSegments===null){var e=[],n=t.byteSize,r=yue(t,t.completedRootSegment,e),i=t.renderState.preamble;r===!1||i.headChunks&&i.bodyChunks?t.completedPreambleSegments=e:t.byteSize=n}}function i5(t,e,n,r){switch(n.parentFlushed=!0,n.status){case 0:n.id=t.nextSegmentId++;case 5:return r=n.id,n.lastPushedText=!1,n.textEmbedded=!1,t=t.renderState,Ft(e,M6e),Ft(e,t.placeholderPrefix),t=gn(r.toString(16)),Ft(e,t),ao(e,I6e);case 1:n.status=2;var i=!0,o=n.chunks,s=0;n=n.children;for(var c=0;c<n.length;c++){for(i=n[c];s<i.index;s++)Ft(e,o[s]);i=eE(t,e,i,r)}for(;s<o.length-1;s++)Ft(e,o[s]);return s<o.length&&(i=ao(e,o[s])),i;case 3:return!0;default:throw Error(Ln(390))}}var $T=0;function eE(t,e,n,r){var i=n.boundary;if(i===null)return i5(t,e,n,r);if(i.parentFlushed=!0,i.status===4){var o=i.row;o!==null&&--o.pendingTasks===0&&Cl(t,o),i=i.errorDigest,ao(e,O6e),Ft(e,k6e),i&&(Ft(e,z6e),Ft(e,gn(Cr(i))),Ft(e,N6e)),ao(e,U6e),i5(t,e,n,r)}else if(i.status!==1)i.status===0&&(i.rootSegmentID=t.nextSegmentId++),0<i.completedSegments.length&&t.partialBoundaries.push(i),Ace(e,t.renderState,i.rootSegmentID),r&&px(r,i.fallbackState),i5(t,e,n,r);else if(!h5&&Ax(t,i)&&($T+i.byteSize>t.progressiveChunkSize||sue(i.contentState)))i.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(i),Ace(e,t.renderState,i.rootSegmentID),i5(t,e,n,r);else{if($T+=i.byteSize,r&&px(r,i.contentState),n=i.row,n!==null&&Ax(t,i)&&--n.pendingTasks===0&&Cl(t,n),ao(e,B6e),n=i.completedSegments,n.length!==1)throw Error(Ln(391));eE(t,e,n[0],r)}return ao(e,F6e)}function X9(t,e,n,r){return lDe(e,t.renderState,n.parentFormatContext,n.id),eE(t,e,n,r),cDe(e,n.parentFormatContext)}function Bce(t,e,n){$T=n.byteSize;for(var r=n.completedSegments,i=0;i<r.length;i++)xue(t,e,n,r[i]);r.length=0,r=n.row,r!==null&&Ax(t,n)&&--r.pendingTasks===0&&Cl(t,r),rue(e,n.contentState,t.renderState),r=t.resumableState,t=t.renderState,i=n.rootSegmentID,n=n.contentState;var o=t.stylesToHoist;return t.stylesToHoist=!1,Ft(e,t.startInlineScript),Ft(e,Zo),o?((r.instructions&4)===0&&(r.instructions|=4,Ft(e,vDe)),(r.instructions&2)===0&&(r.instructions|=2,Ft(e,gce)),(r.instructions&8)===0?(r.instructions|=8,Ft(e,ADe)):Ft(e,gDe)):((r.instructions&2)===0&&(r.instructions|=2,Ft(e,gce)),Ft(e,pDe)),r=gn(i.toString(16)),Ft(e,t.boundaryPrefix),Ft(e,r),Ft(e,mDe),Ft(e,t.segmentPrefix),Ft(e,r),o?(Ft(e,_De),WDe(e,n)):Ft(e,yDe),n=ao(e,xDe),nue(e,t)&&n}function xue(t,e,n,r){if(r.status===2)return!0;var i=n.contentState,o=r.id;if(o===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Ln(392));return X9(t,e,r,i)}return o===n.rootSegmentID?X9(t,e,r,i):(X9(t,e,r,i),n=t.resumableState,t=t.renderState,Ft(e,t.startInlineScript),Ft(e,Zo),(n.instructions&1)===0?(n.instructions|=1,Ft(e,uDe)):Ft(e,hDe),Ft(e,t.segmentPrefix),o=gn(o.toString(16)),Ft(e,o),Ft(e,fDe),Ft(e,t.placeholderPrefix),Ft(e,o),e=ao(e,dDe),e)}var h5=!1;function R5(t,e){pu=new Uint8Array(2048),Au=0;try{if(!(0<t.pendingRootTasks)){var n,r=t.completedRootSegment;if(r!==null){if(r.status===5)return;var i=t.completedPreambleSegments;if(i===null)return;$T=t.byteSize;var o=t.resumableState,s=t.renderState,c=s.preamble,d=c.htmlChunks,m=c.headChunks,b;if(d){for(b=0;b<d.length;b++)Ft(e,d[b]);if(m)for(b=0;b<m.length;b++)Ft(e,m[b]);else Ft(e,ra(\"head\")),Ft(e,Zo)}else if(m)for(b=0;b<m.length;b++)Ft(e,m[b]);var C=s.charsetChunks;for(b=0;b<C.length;b++)Ft(e,C[b]);C.length=0,s.preconnects.forEach(hf,e),s.preconnects.clear();var B=s.viewportChunks;for(b=0;b<B.length;b++)Ft(e,B[b]);B.length=0,s.fontPreloads.forEach(hf,e),s.fontPreloads.clear(),s.highImagePreloads.forEach(hf,e),s.highImagePreloads.clear(),dx=s,s.styles.forEach(VDe,e),dx=null;var k=s.importMapChunks;for(b=0;b<k.length;b++)Ft(e,k[b]);k.length=0,s.bootstrapScripts.forEach(hf,e),s.scripts.forEach(hf,e),s.scripts.clear(),s.bulkPreloads.forEach(hf,e),s.bulkPreloads.clear(),d||m||(o.instructions|=32);var V=s.hoistableChunks;for(b=0;b<V.length;b++)Ft(e,V[b]);for(o=V.length=0;o<i.length;o++){var q=i[o];for(s=0;s<q.length;s++)eE(t,e,q[s],null)}var K=t.renderState.preamble,Y=K.headChunks;(K.htmlChunks||Y)&&Ft(e,C_(\"head\"));var ee=K.bodyChunks;if(ee)for(i=0;i<ee.length;i++)Ft(e,ee[i]);eE(t,e,r,null),t.completedRootSegment=null;var J=t.renderState;if(t.allPendingTasks!==0||t.clientRenderedBoundaries.length!==0||t.completedBoundaries.length!==0||t.trackedPostpones!==null&&(t.trackedPostpones.rootNodes.length!==0||t.trackedPostpones.rootSlots!==null)){var se=t.resumableState;if((se.instructions&64)===0){if(se.instructions|=64,Ft(e,J.startInlineScript),(se.instructions&32)===0){se.instructions|=32;var xe=\"_\"+se.idPrefix+\"R_\";Ft(e,oue),Ft(e,gn(Cr(xe))),Ft(e,qo)}Ft(e,Zo),Ft(e,C6e),ao(e,d5)}}nue(e,J)}var Ee=t.renderState;r=0;var Xe=Ee.viewportChunks;for(r=0;r<Xe.length;r++)Ft(e,Xe[r]);Xe.length=0,Ee.preconnects.forEach(hf,e),Ee.preconnects.clear(),Ee.fontPreloads.forEach(hf,e),Ee.fontPreloads.clear(),Ee.highImagePreloads.forEach(hf,e),Ee.highImagePreloads.clear(),Ee.styles.forEach(HDe,e),Ee.scripts.forEach(hf,e),Ee.scripts.clear(),Ee.bulkPreloads.forEach(hf,e),Ee.bulkPreloads.clear();var Ne=Ee.hoistableChunks;for(r=0;r<Ne.length;r++)Ft(e,Ne[r]);Ne.length=0;var be=t.clientRenderedBoundaries;for(n=0;n<be.length;n++){var ge=be[n];Ee=e;var Qe=t.resumableState,Ct=t.renderState,Mt=ge.rootSegmentID,mt=ge.errorDigest;Ft(Ee,Ct.startInlineScript),Ft(Ee,Zo),(Qe.instructions&4)===0?(Qe.instructions|=4,Ft(Ee,bDe)):Ft(Ee,wDe),Ft(Ee,Ct.boundaryPrefix),Ft(Ee,gn(Mt.toString(16))),Ft(Ee,TDe),mt&&(Ft(Ee,EDe),Ft(Ee,gn(MDe(mt||\"\"))));var jt=ao(Ee,SDe);if(!jt){t.destination=null,n++,be.splice(0,n);return}}be.splice(0,n);var Mn=t.completedBoundaries;for(n=0;n<Mn.length;n++)if(!Bce(t,e,Mn[n])){t.destination=null,n++,Mn.splice(0,n);return}Mn.splice(0,n),k9(e),pu=new Uint8Array(2048),Au=0,h5=!0;var rn=t.partialBoundaries;for(n=0;n<rn.length;n++){var In=rn[n];e:{be=t,ge=e,$T=In.byteSize;var On=In.completedSegments;for(jt=0;jt<On.length;jt++)if(!xue(be,ge,In,On[jt])){jt++,On.splice(0,jt);var Pn=!1;break e}On.splice(0,jt);var _n=In.row;_n!==null&&_n.together&&In.pendingTasks===1&&(_n.pendingTasks===1?T7(be,_n,_n.hoistables):_n.pendingTasks--),Pn=rue(ge,In.contentState,be.renderState)}if(!Pn){t.destination=null,n++,rn.splice(0,n);return}}rn.splice(0,n),h5=!1;var tr=t.completedBoundaries;for(n=0;n<tr.length;n++)if(!Bce(t,e,tr[n])){t.destination=null,n++,tr.splice(0,n);return}tr.splice(0,n)}}finally{h5=!1,t.allPendingTasks===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0?(t.flushScheduled=!1,n=t.resumableState,n.hasBody&&Ft(e,C_(\"body\")),n.hasHtml&&Ft(e,C_(\"html\")),k9(e),t.status=14,e.close(),t.destination=null):k9(e)}}function B5(t){t.flushScheduled=t.destination!==null,Hce(function(){return u7(t)}),A7(function(){t.status===10&&(t.status=11),t.trackedPostpones===null&&S7(t,t.pendingRootTasks===0)})}function I_(t){t.flushScheduled===!1&&t.pingedTasks.length===0&&t.destination!==null&&(t.flushScheduled=!0,A7(function(){var e=t.destination;e?R5(t,e):t.flushScheduled=!1}))}function D5(t,e){if(t.status===13)t.status=14,jce(e,t.fatalError);else if(t.status!==14&&t.destination===null){t.destination=e;try{R5(t,e)}catch(n){Sl(t,n,{}),KT(t,n)}}}function fh(t,e){(t.status===11||t.status===10)&&(t.status=12);try{var n=t.abortableTasks;if(0<n.size){var r=e===void 0?Error(Ln(432)):typeof e==\"object\"&&e!==null&&typeof e.then==\"function\"?Error(Ln(530)):e;t.fatalError=r,n.forEach(function(i){return c7(i,t,r)}),n.clear()}t.destination!==null&&R5(t,t.destination)}catch(i){Sl(t,i,{}),KT(t,i)}}function w5(t,e,n){if(e===null)n.rootNodes.push(t);else{var r=n.workingMap,i=r.get(e);i===void 0&&(i=[e[1],e[2],[],null],r.set(e,i),w5(i,e[0],n)),i[2].push(t)}}function vue(t){var e=t.trackedPostpones;if(e===null||e.rootNodes.length===0&&e.rootSlots===null)return t.trackedPostpones=null;if(t.completedRootSegment===null||t.completedRootSegment.status!==5&&t.completedPreambleSegments!==null){var n=t.nextSegmentId,r=e.rootSlots,i=t.resumableState;i.bootstrapScriptContent=void 0,i.bootstrapScripts=void 0,i.bootstrapModules=void 0}else{n=0,r=-1,i=t.resumableState;var o=t.renderState;i.nextFormID=0,i.hasBody=!1,i.hasHtml=!1,i.unknownResources={font:o.resets.font},i.dnsResources=o.resets.dns,i.connectResources=o.resets.connect,i.imageResources=o.resets.image,i.styleResources=o.resets.style,i.scriptResources={},i.moduleUnknownResources={},i.moduleScriptResources={},i.instructions=0}return{nextSegmentId:n,rootFormatContext:t.rootFormatContext,progressiveChunkSize:t.progressiveChunkSize,resumableState:t.resumableState,replayNodes:e.rootNodes,replaySlots:r}}function bue(){var t=h7.version;if(t!==\"19.2.4\")throw Error(Ln(527,t,\"19.2.4\"))}bue();bue();gx.prerender=function(t,e){return new Promise(function(n,r){var i=e?e.onHeaders:void 0,o;i&&(o=function(b){i(new Headers(b))});var s=Yce(e?e.identifierPrefix:void 0,e?e.unstable_externalRuntimeSrc:void 0,e?e.bootstrapScriptContent:void 0,e?e.bootstrapScripts:void 0,e?e.bootstrapModules:void 0),c=gLe(t,s,C5(s,void 0,e?e.unstable_externalRuntimeSrc:void 0,e?e.importMap:void 0,o,e?e.maxHeadersLength:void 0),Zce(e?e.namespaceURI:void 0),e?e.progressiveChunkSize:void 0,e?e.onError:void 0,function(){var b=new ReadableStream({type:\"bytes\",pull:function(C){D5(c,C)},cancel:function(C){c.destination=null,fh(c,C)}},{highWaterMark:0});b={postponed:vue(c),prelude:b},n(b)},void 0,void 0,r,e?e.onPostpone:void 0);if(e&&e.signal){var d=e.signal;if(d.aborted)fh(c,d.reason);else{var m=function(){fh(c,d.reason),d.removeEventListener(\"abort\",m)};d.addEventListener(\"abort\",m)}}B5(c)})};gx.renderToReadableStream=function(t,e){return new Promise(function(n,r){var i,o,s=new Promise(function(k,V){o=k,i=V}),c=e?e.onHeaders:void 0,d;c&&(d=function(k){c(new Headers(k))});var m=Yce(e?e.identifierPrefix:void 0,e?e.unstable_externalRuntimeSrc:void 0,e?e.bootstrapScriptContent:void 0,e?e.bootstrapScripts:void 0,e?e.bootstrapModules:void 0),b=Aue(t,m,C5(m,e?e.nonce:void 0,e?e.unstable_externalRuntimeSrc:void 0,e?e.importMap:void 0,d,e?e.maxHeadersLength:void 0),Zce(e?e.namespaceURI:void 0),e?e.progressiveChunkSize:void 0,e?e.onError:void 0,o,function(){var k=new ReadableStream({type:\"bytes\",pull:function(V){D5(b,V)},cancel:function(V){b.destination=null,fh(b,V)}},{highWaterMark:0});k.allReady=s,n(k)},function(k){s.catch(function(){}),r(k)},i,e?e.onPostpone:void 0,e?e.formState:void 0);if(e&&e.signal){var C=e.signal;if(C.aborted)fh(b,C.reason);else{var B=function(){fh(b,C.reason),C.removeEventListener(\"abort\",B)};C.addEventListener(\"abort\",B)}}B5(b)})};gx.resume=function(t,e,n){return new Promise(function(r,i){var o,s,c=new Promise(function(C,B){s=C,o=B}),d=gue(t,e,C5(e.resumableState,n?n.nonce:void 0,void 0,void 0,void 0,void 0),n?n.onError:void 0,s,function(){var C=new ReadableStream({type:\"bytes\",pull:function(B){D5(d,B)},cancel:function(B){d.destination=null,fh(d,B)}},{highWaterMark:0});C.allReady=c,r(C)},function(C){c.catch(function(){}),i(C)},o,n?n.onPostpone:void 0);if(n&&n.signal){var m=n.signal;if(m.aborted)fh(d,m.reason);else{var b=function(){fh(d,m.reason),m.removeEventListener(\"abort\",b)};m.addEventListener(\"abort\",b)}}B5(d)})};gx.resumeAndPrerender=function(t,e,n){return new Promise(function(r,i){var o=mLe(t,e,C5(e.resumableState,void 0,void 0,void 0,void 0,void 0),n?n.onError:void 0,function(){var d=new ReadableStream({type:\"bytes\",pull:function(m){D5(o,m)},cancel:function(m){o.destination=null,fh(o,m)}},{highWaterMark:0});d={postponed:vue(o),prelude:d},r(d)},void 0,void 0,i,n?n.onPostpone:void 0);if(n&&n.signal){var s=n.signal;if(s.aborted)fh(o,s.reason);else{var c=function(){fh(o,s.reason),s.removeEventListener(\"abort\",c)};s.addEventListener(\"abort\",c)}}B5(o)})};gx.version=\"19.2.4\"});var Tue=Fs(mx=>{\"use strict\";var L5,M7;L5=Zle(),M7=wue();mx.version=L5.version;mx.renderToString=L5.renderToString;mx.renderToStaticMarkup=L5.renderToStaticMarkup;mx.renderToReadableStream=M7.renderToReadableStream;mx.resume=M7.resume});var Sue=Fs((wxt,Eue)=>{\"use strict\";var yLe=\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\";Eue.exports=yLe});var Pue=Fs((Txt,Iue)=>{\"use strict\";var xLe=Sue();function Cue(){}function Mue(){}Mue.resetWarningCache=Cue;Iue.exports=function(){function t(r,i,o,s,c,d){if(d!==xLe){var m=new Error(\"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types\");throw m.name=\"Invariant Violation\",m}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Mue,resetWarningCache:Cue};return n.PropTypes=n,n}});var Bue=Fs((Cxt,Rue)=>{Rue.exports=Pue()();var Ext,Sxt});var Ad=xr(Jr(),1);var yc=xr(Jr(),1),IX=xr(MX(),1),PX=yc.createContext(null);function uAe(){let t=yc.useContext(PX);if(!t)throw new Error(\"RenderContext not found\");return t}function hAe(){return uAe().model}function mA(t){let e=hAe(),n=yc.useSyncExternalStore(i=>(e.on(`change:${t}`,i),()=>e.off(`change:${t}`,i)),()=>e.get(t)),r=yc.useCallback(i=>{e.set(t,typeof i==\"function\"?i(e.get(t)):i),e.save_changes()},[e,t]);return[n,r]}function RX(t){return({el:e,model:n,experimental:r})=>{let i=IX.createRoot(e);return i.render(yc.createElement(yc.StrictMode,null,yc.createElement(PX.Provider,{value:{model:n,experimental:r}},yc.createElement(t)))),()=>i.unmount()}}var _A=xr(Jr(),1),$c=xr(Jr(),1);var mL=xr(Jr(),1),sC=xr(Jr(),1);var BX=mL.createContext(null);function DX(t,e){let n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===o}function jl(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!jl(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t==\"object\"&&typeof e==\"object\"){let n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(let i of n)if(!e.hasOwnProperty(i)||!jl(t[i],e[i]))return!1;return!0}return!1}function _L(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function yL(t,e){let n=e.viewState||e,r={};if(\"longitude\"in n&&\"latitude\"in n&&(n.longitude!==t.center.lng||n.latitude!==t.center.lat)){let i=t.center.constructor;r.center=new i(n.longitude,n.latitude)}return\"zoom\"in n&&n.zoom!==t.zoom&&(r.zoom=n.zoom),\"bearing\"in n&&n.bearing!==t.bearing&&(r.bearing=n.bearing),\"pitch\"in n&&n.pitch!==t.pitch&&(r.pitch=n.pitch),n.padding&&t.padding&&!jl(n.padding,t.padding)&&(r.padding=n.padding),r}var fAe=[\"type\",\"source\",\"source-layer\",\"minzoom\",\"maxzoom\",\"filter\",\"layout\"];function xL(t){if(!t)return null;if(typeof t==\"string\"||(\"toJS\"in t&&(t=t.toJS()),!t.layers))return t;let e={};for(let r of t.layers)e[r.id]=r;let n=t.layers.map(r=>{let i=null;\"interactive\"in r&&(i=Object.assign({},r),delete i.interactive);let o=e[r.ref];if(o){i=i||Object.assign({},r),delete i.ref;for(let s of fAe)s in o&&(i[s]=o[s])}return i||r});return{...t,layers:n}}var LX={version:8,sources:{},layers:[]},OX={mousedown:\"onMouseDown\",mouseup:\"onMouseUp\",mouseover:\"onMouseOver\",mousemove:\"onMouseMove\",click:\"onClick\",dblclick:\"onDblClick\",mouseenter:\"onMouseEnter\",mouseleave:\"onMouseLeave\",mouseout:\"onMouseOut\",contextmenu:\"onContextMenu\",touchstart:\"onTouchStart\",touchend:\"onTouchEnd\",touchmove:\"onTouchMove\",touchcancel:\"onTouchCancel\"},FX={movestart:\"onMoveStart\",move:\"onMove\",moveend:\"onMoveEnd\",dragstart:\"onDragStart\",drag:\"onDrag\",dragend:\"onDragEnd\",zoomstart:\"onZoomStart\",zoom:\"onZoom\",zoomend:\"onZoomEnd\",rotatestart:\"onRotateStart\",rotate:\"onRotate\",rotateend:\"onRotateEnd\",pitchstart:\"onPitchStart\",pitch:\"onPitch\",pitchend:\"onPitchEnd\"},kX={wheel:\"onWheel\",boxzoomstart:\"onBoxZoomStart\",boxzoomend:\"onBoxZoomEnd\",boxzoomcancel:\"onBoxZoomCancel\",resize:\"onResize\",load:\"onLoad\",render:\"onRender\",idle:\"onIdle\",remove:\"onRemove\",data:\"onData\",styledata:\"onStyleData\",sourcedata:\"onSourceData\",error:\"onError\"},dAe=[\"minZoom\",\"maxZoom\",\"minPitch\",\"maxPitch\",\"maxBounds\",\"projection\",\"renderWorldCopies\"],pAe=[\"scrollZoom\",\"boxZoom\",\"dragRotate\",\"dragPan\",\"keyboard\",\"doubleClickZoom\",\"touchZoomRotate\",\"touchPitch\"],aC=class t{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=i=>{let o=this.props[kX[i.type]];o?o(i):i.type===\"error\"&&console.error(i.error)},this._onCameraEvent=i=>{if(this._internalUpdate)return;i.viewState=this._propsedCameraUpdate||_L(this._map.transform);let o=this.props[FX[i.type]];o&&o(i)},this._onCameraUpdate=i=>this._internalUpdate?i:(this._propsedCameraUpdate=_L(i),yL(i,this.props)),this._onPointerEvent=i=>{(i.type===\"mousemove\"||i.type===\"mouseout\")&&this._updateHover(i);let o=this.props[OX[i.type]];o&&(this.props.interactiveLayerIds&&i.type!==\"mouseover\"&&i.type!==\"mouseout\"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),o(i),delete i.features)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}setProps(e){let n=this.props;this.props=e;let r=this._updateSettings(e,n),i=this._updateSize(e),o=this._updateViewState(e);this._updateStyle(e,n),this._updateStyleComponents(e),this._updateHandlers(e,n),(r||i||o&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){let r=t.savedMaps.pop();if(!r)return null;let i=r.map,o=i.getContainer();for(n.className=o.className;o.childNodes.length>0;)n.appendChild(o.childNodes[0]);i._container=n;let s=i._resizeObserver;s&&(s.disconnect(),s.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();let{initialViewState:c}=e;return c&&(c.bounds?i.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):r._updateViewState(c)),i.isStyleLoaded()?i.fire(\"load\"):i.once(\"style.load\",()=>i.fire(\"load\")),i._update(),r}_initialize(e){let{props:n}=this,{mapStyle:r=LX}=n,i={...n,...n.initialViewState,container:e,style:xL(r)},o=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[o.longitude||0,o.latitude||0],zoom:o.zoom||0,pitch:o.pitch||0,bearing:o.bearing||0}),n.gl){let c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,n.gl)}let s=new this._MapClass(i);o.padding&&s.setPadding(o.padding),n.cursor&&(s.getCanvas().style.cursor=n.cursor),s.transformCameraUpdate=this._onCameraUpdate,s.on(\"style.load\",()=>{this._styleComponents={light:s.getLight(),sky:s.getSky(),projection:s.getProjection?.(),terrain:s.getTerrain()},this._updateStyleComponents(this.props)}),s.on(\"sourcedata\",()=>{this._updateStyleComponents(this.props)});for(let c in OX)s.on(c,this._onPointerEvent);for(let c in FX)s.on(c,this._onCameraEvent);for(let c in kX)s.on(c,this._onEvent);this._map=s}recycle(){this.map.getContainer().querySelector(\"[mapboxgl-children]\")?.remove(),t.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){let e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_updateSize(e){let{viewState:n}=e;if(n){let r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e){let n=this._map,r=n.transform;if(!n.isMoving()){let o=yL(r,e);if(Object.keys(o).length>0)return this._internalUpdate=!0,n.jumpTo(o),this._internalUpdate=!1,!0}return!1}_updateSettings(e,n){let r=this._map,i=!1;for(let o of dAe)o in e&&!jl(e[o],n[o])&&(i=!0,r[`set${o[0].toUpperCase()}${o.slice(1)}`]?.call(r,e[o]));return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||\"\"),e.mapStyle!==n.mapStyle){let{mapStyle:r=LX,styleDiffing:i=!0}=e,o={diff:i};\"localIdeographFontFamily\"in e&&(o.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(xL(r),o)}}_updateStyleComponents({light:e,projection:n,sky:r,terrain:i}){let o=this._map,s=this._styleComponents;o.style._loaded&&(e&&!jl(e,s.light)&&(s.light=e,o.setLight(e)),n&&!jl(n,s.projection)&&n!==s.projection?.type&&(s.projection=typeof n==\"string\"?{type:n}:n,o.setProjection?.(s.projection)),r&&!jl(r,s.sky)&&(s.sky=r,o.setSky(r)),i!==void 0&&!jl(i,s.terrain)&&(!i||o.getSource(i.source))&&(s.terrain=i,o.setTerrain(i)))}_updateHandlers(e,n){let r=this._map;for(let i of pAe){let o=e[i]??!0,s=n[i]??!0;jl(o,s)||(o?r[i].enable(o):r[i].disable())}}_queryRenderedFeatures(e){let n=this._map,{interactiveLayerIds:r=[]}=this.props;try{return n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(e){let{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){let i=e.type,o=this._hoveredFeatures?.length>0,s=this._queryRenderedFeatures(e.point),c=s.length>0;!c&&o&&(e.type=\"mouseleave\",this._onPointerEvent(e)),this._hoveredFeatures=s,c&&!o&&(e.type=\"mouseenter\",this._onPointerEvent(e)),e.type=i}else this._hoveredFeatures=null}};aC.savedMaps=[];var vL=aC;var AAe=[\"setMaxBounds\",\"setMinZoom\",\"setMaxZoom\",\"setMinPitch\",\"setMaxPitch\",\"setRenderWorldCopies\",\"setProjection\",\"setStyle\",\"addSource\",\"removeSource\",\"addLayer\",\"removeLayer\",\"setLayerZoomRange\",\"setFilter\",\"setPaintProperty\",\"setLayoutProperty\",\"setLight\",\"setTerrain\",\"setFog\",\"remove\"];function bL(t){if(!t)return null;let e=t.map,n={getMap:()=>e};for(let r of gAe(e))!(r in n)&&!AAe.includes(r)&&(n[r]=e[r].bind(e));return n}function gAe(t){let e=new Set,n=t;for(;n;){for(let r of Object.getOwnPropertyNames(n))r[0]!==\"_\"&&typeof t[r]==\"function\"&&r!==\"fire\"&&r!==\"setEventedParent\"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}var lC=xr(Jr(),1),mAe=typeof document<\"u\"?lC.useLayoutEffect:lC.useEffect,NX=mAe;function wL(t,e){let{RTLTextPlugin:n,maxParallelImageRequests:r,workerCount:i,workerUrl:o}=e;if(n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()===\"unavailable\"){let{pluginUrl:s,lazy:c=!0}=typeof n==\"string\"?{pluginUrl:n}:n;t.setRTLTextPlugin(s,d=>{d&&console.error(d)},c)}r!==void 0&&t.setMaxParallelImageRequests(r),i!==void 0&&t.setWorkerCount(i),o!==void 0&&t.setWorkerUrl(o)}var Gf=_A.createContext(null);function _Ae(t,e){let n=(0,$c.useContext)(BX),[r,i]=(0,$c.useState)(null),o=(0,$c.useRef)(),{current:s}=(0,$c.useRef)({mapLib:null,map:null});(0,$c.useEffect)(()=>{let m=t.mapLib,b=!0,C;return Promise.resolve(m||Promise.resolve().then(()=>xr(UX(),1))).then(B=>{if(!b)return;if(!B)throw new Error(\"Invalid mapLib\");let k=\"Map\"in B?B:B.default;if(!k.Map)throw new Error(\"Invalid mapLib\");wL(k,t),t.reuseMaps&&(C=vL.reuse(t,o.current)),C||(C=new vL(k.Map,t,o.current)),s.map=bL(C),s.mapLib=k,i(C),n?.onMapMount(s.map,t.id)}).catch(B=>{let{onError:k}=t;k?k({type:\"error\",target:null,originalEvent:null,error:B}):console.error(B)}),()=>{b=!1,C&&(n?.onMapUnmount(t.id),t.reuseMaps?C.recycle():C.destroy())}},[]),NX(()=>{r&&r.setProps(t)}),(0,$c.useImperativeHandle)(e,()=>s.map,[r]);let c=(0,$c.useMemo)(()=>({position:\"relative\",width:\"100%\",height:\"100%\",...t.style}),[t.style]),d={height:\"100%\"};return _A.createElement(\"div\",{id:t.id,ref:o,style:c},r&&_A.createElement(Gf.Provider,{value:s},_A.createElement(\"div\",{\"mapboxgl-children\":\"\",style:d},t.children)))}var cC=_A.forwardRef(_Ae);var GX=xr(Jr(),1),HX=xr(Jg(),1),Xl=xr(Jr(),1);var yAe=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function ya(t,e){if(!t||!e)return;let n=t.style;for(let r in e){let i=e[r];Number.isFinite(i)&&!yAe.test(r)?n[r]=`${i}px`:n[r]=i}}function uC(t,e){if(t===e)return null;let n=VX(t),r=VX(e),i=[];for(let o of r)n.has(o)||i.push(o);for(let o of n)r.has(o)||i.push(o);return i.length===0?null:i}function VX(t){return new Set(t?t.trim().split(/\\s+/):[])}var xAe=(0,Xl.memo)((0,Xl.forwardRef)((t,e)=>{let{map:n,mapLib:r}=(0,Xl.useContext)(Gf),i=(0,Xl.useRef)({props:t}),o=(0,Xl.useMemo)(()=>{let Y=!1;GX.Children.forEach(t.children,se=>{se&&(Y=!0)});let ee={...t,element:Y?document.createElement(\"div\"):void 0},J=new r.Marker(ee);return J.setLngLat([t.longitude,t.latitude]),J.getElement().addEventListener(\"click\",se=>{i.current.props.onClick?.({type:\"click\",target:J,originalEvent:se})}),J.on(\"dragstart\",se=>{let xe=se;xe.lngLat=o.getLngLat(),i.current.props.onDragStart?.(xe)}),J.on(\"drag\",se=>{let xe=se;xe.lngLat=o.getLngLat(),i.current.props.onDrag?.(xe)}),J.on(\"dragend\",se=>{let xe=se;xe.lngLat=o.getLngLat(),i.current.props.onDragEnd?.(xe)}),J},[]);(0,Xl.useEffect)(()=>(o.addTo(n.getMap()),()=>{o.remove()}),[]);let{longitude:s,latitude:c,offset:d,style:m,draggable:b=!1,popup:C=null,rotation:B=0,rotationAlignment:k=\"auto\",pitchAlignment:V=\"auto\"}=t;(0,Xl.useEffect)(()=>{ya(o.getElement(),m)},[m]),(0,Xl.useImperativeHandle)(e,()=>o,[]);let q=i.current.props;(o.getLngLat().lng!==s||o.getLngLat().lat!==c)&&o.setLngLat([s,c]),d&&!DX(o.getOffset(),d)&&o.setOffset(d),o.isDraggable()!==b&&o.setDraggable(b),o.getRotation()!==B&&o.setRotation(B),o.getRotationAlignment()!==k&&o.setRotationAlignment(k),o.getPitchAlignment()!==V&&o.setPitchAlignment(V),o.getPopup()!==C&&o.setPopup(C);let K=uC(q.className,t.className);if(K)for(let Y of K)o.toggleClassName(Y);return i.current.props=t,(0,HX.createPortal)(t.children,o.getElement())}));var WX=xr(Jg(),1),ul=xr(Jr(),1);var vAe=(0,ul.memo)((0,ul.forwardRef)((t,e)=>{let{map:n,mapLib:r}=(0,ul.useContext)(Gf),i=(0,ul.useMemo)(()=>document.createElement(\"div\"),[]),o=(0,ul.useRef)({props:t}),s=(0,ul.useMemo)(()=>{let c={...t},d=new r.Popup(c);return d.setLngLat([t.longitude,t.latitude]),d.once(\"open\",m=>{o.current.props.onOpen?.(m)}),d},[]);if((0,ul.useEffect)(()=>{let c=d=>{o.current.props.onClose?.(d)};return s.on(\"close\",c),s.setDOMContent(i).addTo(n.getMap()),()=>{s.off(\"close\",c),s.isOpen()&&s.remove()}},[]),(0,ul.useEffect)(()=>{ya(s.getElement(),t.style)},[t.style]),(0,ul.useImperativeHandle)(e,()=>s,[]),s.isOpen()){let c=o.current.props;(s.getLngLat().lng!==t.longitude||s.getLngLat().lat!==t.latitude)&&s.setLngLat([t.longitude,t.latitude]),t.offset&&!jl(c.offset,t.offset)&&s.setOffset(t.offset),(c.anchor!==t.anchor||c.maxWidth!==t.maxWidth)&&(s.options.anchor=t.anchor,s.setMaxWidth(t.maxWidth));let d=uC(c.className,t.className);if(d)for(let m of d)s.toggleClassName(m);o.current.props=t}return(0,WX.createPortal)(t.children,i)}));var hC=xr(Jr(),1);var sy=xr(Jr(),1);function Yl(t,e,n,r){let i=(0,sy.useContext)(Gf),o=(0,sy.useMemo)(()=>t(i),[]);return(0,sy.useEffect)(()=>{let s=r||n||e,c=typeof e==\"function\"&&typeof n==\"function\"?e:null,d=typeof n==\"function\"?n:typeof e==\"function\"?e:null,{map:m}=i;return m.hasControl(o)||(m.addControl(o,s?.position),c&&c(i)),()=>{d&&d(i),m.hasControl(o)&&m.removeControl(o)}},[]),o}function bAe(t){let e=Yl(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return(0,hC.useEffect)(()=>{ya(e._container,t.style)},[t.style]),null}var SL=(0,hC.memo)(bAe);var fC=xr(Jr(),1);function wAe(t){let e=Yl(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return(0,fC.useEffect)(()=>{ya(e._controlContainer,t.style)},[t.style]),null}var TAe=(0,fC.memo)(wAe);var Hf=xr(Jr(),1);function EAe(t,e){let n=(0,Hf.useRef)({props:t}),r=Yl(({mapLib:i})=>{let o=new i.GeolocateControl(t),s=o._setupUI;return o._setupUI=()=>{o._container.hasChildNodes()||s()},o.on(\"geolocate\",c=>{n.current.props.onGeolocate?.(c)}),o.on(\"error\",c=>{n.current.props.onError?.(c)}),o.on(\"outofmaxbounds\",c=>{n.current.props.onOutOfMaxBounds?.(c)}),o.on(\"trackuserlocationstart\",c=>{n.current.props.onTrackUserLocationStart?.(c)}),o.on(\"trackuserlocationend\",c=>{n.current.props.onTrackUserLocationEnd?.(c)}),o},{position:t.position});return n.current.props=t,(0,Hf.useImperativeHandle)(e,()=>r,[]),(0,Hf.useEffect)(()=>{ya(r._container,t.style)},[t.style]),null}var SAe=(0,Hf.memo)((0,Hf.forwardRef)(EAe));var dC=xr(Jr(),1);function CAe(t){let e=Yl(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return(0,dC.useEffect)(()=>{ya(e._container,t.style)},[t.style]),null}var MAe=(0,dC.memo)(CAe);var ay=xr(Jr(),1);function IAe(t){let e=Yl(({mapLib:o})=>new o.ScaleControl(t),{position:t.position}),n=(0,ay.useRef)(t),r=n.current;n.current=t;let{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),(0,ay.useEffect)(()=>{ya(e._container,i)},[i]),null}var PAe=(0,ay.memo)(IAe);var pC=xr(Jr(),1);function RAe(t){let e=Yl(({mapLib:n})=>new n.TerrainControl(t),{position:t.position});return(0,pC.useEffect)(()=>{ya(e._container,t.style)},[t.style]),null}var BAe=(0,pC.memo)(RAe);var AC=xr(Jr(),1);function DAe(t){let e=Yl(({mapLib:n})=>new n.LogoControl(t),{position:t.position});return(0,AC.useEffect)(()=>{ya(e._container,t.style)},[t.style]),null}var LAe=(0,AC.memo)(DAe);var FAe=xr(Jr(),1),ly=xr(Jr(),1);var Zv=xr(Jr(),1);async function eu(t,e,n,r){return r._parse(t,e,n,r)}function Rr(t,e){if(!t)throw new Error(e||\"loader assertion failed.\")}var Wf={self:typeof self<\"u\"&&self,window:typeof window<\"u\"&&window,global:typeof global<\"u\"&&global,document:typeof document<\"u\"&&document},kAe=Wf.self||Wf.window||Wf.global||{},NAe=Wf.window||Wf.self||Wf.global||{},zAe=Wf.global||Wf.self||Wf.window||{},UAe=Wf.document||{};var bp=!!(typeof process!=\"object\"||String(process)!==\"[object process]\"||process.browser);var jX=typeof process<\"u\"&&process.version&&/v([0-9]*)/.exec(process.version),VAe=jX&&parseFloat(jX[1])||0;hy();var LL=\"4.3.3\",QAe=LL[0]>=\"0\"&&LL[0]<=\"9\"?`v${LL}`:\"\";function KAe(){let t=new xc({id:\"loaders.gl\"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=QAe,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}var Qv=KAe();function OL(t,e){return uY(t||{},e)}function uY(t,e,n=0){if(n>3)return e;let r={...t};for(let[i,o]of Object.entries(e))o&&typeof o==\"object\"&&!Array.isArray(o)?r[i]=uY(r[i]||{},e[i],n+1):r[i]=e[i];return r}function FL(t){globalThis.loaders||={},globalThis.loaders.modules||={},Object.assign(globalThis.loaders.modules,t)}function kL(t){return globalThis.loaders?.modules?.[t]||null}var hY=\"latest\";function JAe(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version=\"4.3.3\"),globalThis._loadersgl_.version}var Kv=JAe();function ja(t,e){if(!t)throw new Error(e||\"loaders.gl assertion failed.\")}var jf={self:typeof self<\"u\"&&self,window:typeof window<\"u\"&&window,global:typeof global<\"u\"&&global,document:typeof document<\"u\"&&document},WFe=jf.self||jf.window||jf.global||{},jFe=jf.window||jf.self||jf.global||{},XFe=jf.global||jf.self||jf.window||{},YFe=jf.document||{};var xa=typeof process!=\"object\"||String(process)!==\"[object process]\"||process.browser,Jv=typeof importScripts==\"function\",dY=typeof window<\"u\"&&typeof window.orientation<\"u\",fY=typeof process<\"u\"&&process.version&&/v([0-9]*)/.exec(process.version),ZFe=fY&&parseFloat(fY[1])||0;var $v=class{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,n){this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:\"loaders.gl\",type:e,payload:n})}done(e){ja(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ja(this.isRunning),this.isRunning=!1,this._reject(e)}};var fy=class{terminate(){}};var NL=new Map;function pY(t){ja(t.source&&!t.url||!t.source&&t.url);let e=NL.get(t.source||t.url);return e||(t.url&&(e=$Ae(t.url),NL.set(t.url,e)),t.source&&(e=AY(t.source),NL.set(t.source,e))),ja(e),e}function $Ae(t){if(!t.startsWith(\"http\"))return t;let e=ege(t);return AY(e)}function AY(t){let e=new Blob([t],{type:\"application/javascript\"});return URL.createObjectURL(e)}function ege(t){return`try {\n  importScripts('${t}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}function zL(t,e=!0,n){let r=n||new Set;if(t){if(gY(t))r.add(t);else if(gY(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t==\"object\")for(let i in t)zL(t[i],e,r)}}return n===void 0?Array.from(r):[]}function gY(t){return t?t instanceof ArrayBuffer||typeof MessagePort<\"u\"&&t instanceof MessagePort||typeof ImageBitmap<\"u\"&&t instanceof ImageBitmap||typeof OffscreenCanvas<\"u\"&&t instanceof OffscreenCanvas:!1}var UL=()=>{},xA=class{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL=\"\";static isSupported(){return typeof Worker<\"u\"&&xa||typeof fy<\"u\"&&!xa}constructor(e){let{name:n,source:r,url:i}=e;ja(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=UL,this.onError=o=>console.log(o),this.worker=xa?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=UL,this.onError=UL,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||zL(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n=\"Failed to load \";return n+=`worker ${this.name} from ${this.url}. `,e.message&&(n+=`${e.message} in `),e.lineno&&(n+=`:${e.lineno}:${e.colno}`),new Error(n)}_createBrowserWorker(){this._loadableURL=pY({source:this.source,url:this.url});let e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error(\"No data received\"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){let r=this.url.includes(\":/\")||this.url.startsWith(\"/\")?this.url:`./${this.url}`;e=new fy(r,{eval:!1})}else if(this.source)e=new fy(this.source,{eval:!0});else throw new Error(\"no worker\");return e.on(\"message\",n=>{this.onMessage(n)}),e.on(\"error\",n=>{this.onError(n)}),e.on(\"exit\",n=>{}),e}};var eb=class{name=\"unnamed\";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return xA.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(i,o,s)=>i.done(s),r=(i,o)=>i.error(o)){let i=new Promise(o=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:o}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;let e=this._getAvailableWorker();if(!e)return;let n=this.jobQueue.shift();if(n){this.onDebug({message:\"Starting job\",name:n.name,workerThread:e,backlog:this.jobQueue.length});let r=new $v(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!xa||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;let e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new xA({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return dY?this.maxMobileConcurrency:this.maxConcurrency}};var tge={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},xm=class t{props;workerPools=new Map;static _workerFarm;static isSupported(){return xA.isSupported()}static getWorkerFarm(e={}){return t._workerFarm=t._workerFarm||new t({}),t._workerFarm.setProps(e),t._workerFarm}constructor(e){this.props={...tge},this.setProps(e),this.workerPools=new Map}destroy(){for(let e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(let n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){let{name:n,source:r,url:i}=e,o=this.workerPools.get(n);return o||(o=new eb({name:n,source:r,url:i}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};function VL(t,e={}){let n=e[t.id]||{},r=xa?`${t.id}-worker.js`:`${t.id}-worker-node.js`,i=n.workerUrl;if(!i&&t.id===\"compression\"&&(i=e.workerUrl),e._workerType===\"test\"&&(xa?i=`modules/${t.module}/dist/${r}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let o=t.version;o===\"latest\"&&(o=hY);let s=o?`@${o}`:\"\";i=`https://unpkg.com/@loaders.gl/${t.module}${s}/dist/${r}`}return ja(i),i}function HL(t,e=Kv){ja(t,\"no worker provided\");let n=t.version;return!(!e||!n)}var WL={};async function Xf(t,e=null,n={},r=null){return e&&(t=mY(t,e,n,r)),WL[t]=WL[t]||nge(t),await WL[t]}function mY(t,e,n={},r=null){if(!n.useLocalLibraries&&t.startsWith(\"http\"))return t;r=r||t;let i=n.modules||{};return i[r]?i[r]:xa?n.CDN?(ja(n.CDN.startsWith(\"http\")),`${n.CDN}/${e}@${Kv}/dist/libs/${r}`):Jv?`../src/libs/${r}`:`modules/${e}/src/libs/${r}`:`modules/${e}/dist/libs/${r}`}async function nge(t){if(t.endsWith(\"wasm\"))return await ige(t);if(!xa)try{let{requireFromFile:n}=globalThis.loaders||{};return await n?.(t)}catch(n){return console.error(n),null}if(Jv)return importScripts(t);let e=await oge(t);return rge(e,t)}function rge(t,e){if(!xa){let{requireFromString:r}=globalThis.loaders||{};return r?.(t,e)}if(Jv)return eval.call(globalThis,t),null;let n=document.createElement(\"script\");n.id=e;try{n.appendChild(document.createTextNode(t))}catch{n.text=t}return document.body.appendChild(n),null}async function ige(t){let{readFileAsArrayBuffer:e}=globalThis.loaders||{};return xa||!e||t.startsWith(\"http\")?await(await fetch(t)).arrayBuffer():await e(t)}async function oge(t){let{readFileAsText:e}=globalThis.loaders||{};return xa||!e||t.startsWith(\"http\")?await(await fetch(t)).text():await e(t)}function jL(t,e){return!xm.isSupported()||!xa&&!e?._nodeWorkers?!1:t.worker&&e?.worker}async function XL(t,e,n,r,i){let o=t.id,s=VL(t,n),d=xm.getWorkerFarm(n).getWorkerPool({name:o,url:s});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));let m=await d.startJob(\"process-on-worker\",sge.bind(null,i));return m.postMessage(\"process\",{input:e,options:n,context:r}),await(await m.result).result}async function sge(t,e,n,r){switch(n){case\"done\":e.done(r);break;case\"error\":e.error(new Error(r.error));break;case\"process\":let{id:i,input:o,options:s}=r;try{let c=await t(o,s);e.postMessage(\"done\",{id:i,result:c})}catch(c){let d=c instanceof Error?c.message:\"unknown error\";e.postMessage(\"error\",{id:i,error:d})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}function yY(t,e=5){return typeof t==\"string\"?t.slice(0,e):ArrayBuffer.isView(t)?_Y(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?_Y(t,0,e):\"\"}function _Y(t,e,n){if(t.byteLength<=e+n)return\"\";let r=new DataView(t),i=\"\";for(let o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}function YL(t){try{return JSON.parse(t)}catch{throw new Error(`Failed to parse JSON from data starting with \"${yY(t)}\"`)}}function ZL(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;let r=new Uint8Array(t),i=new Uint8Array(e);for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}function qL(...t){return xY(t)}function xY(t){let e=t.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),n=e.reduce((o,s)=>o+s.byteLength,0),r=new Uint8Array(n),i=0;for(let o of e)r.set(o,i),i+=o.byteLength;return r.buffer}function tb(...t){let e=t,n=e&&e.length>1&&e[0].constructor||null;if(!n)throw new Error('\"concatenateTypedArrays\" - incorrect quantity of arguments or arguments have incompatible data types');let r=e.reduce((s,c)=>s+c.length,0),i=new n(r),o=0;for(let s of e)i.set(s,o),o+=s.length;return i}function vm(t,e,n){let r=n!==void 0?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function vA(t,e){return Rr(t>=0),Rr(e>0),t+(e-1)&~(e-1)}function QL(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{let i=t.byteOffset,o=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,i,o)}return e.set(r,n),n+vA(r.byteLength,4)}async function KL(t){let e=[];for await(let n of t)e.push(n);return qL(...e)}wm();var age=\"Queued Requests\",lge=\"Active Requests\",cge=\"Cancelled Requests\",uge=\"Queued Requests Ever\",hge=\"Active Requests Ever\",fge={id:\"request-scheduler\",throttleRequests:!0,maxRequests:6,debounceTime:0},bA=class{props;stats;activeRequestCount=0;requestQueue=[];requestMap=new Map;updateTimer=null;constructor(e={}){this.props={...fge,...e},this.stats=new hl({id:this.props.id}),this.stats.get(age),this.stats.get(lge),this.stats.get(cge),this.stats.get(uge),this.stats.get(hge)}scheduleRequest(e,n=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);let r={handle:e,priority:0,getPriority:n},i=new Promise(o=>(r.resolve=o,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){let{handle:n,resolve:r}=e,i=!1,o=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:o}):Promise.resolve({done:o})}_issueNewRequests(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>this._issueNewRequestsAsync(),this.props.debounceTime)}_issueNewRequestsAsync(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=null;let e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){let r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){let e=this.requestQueue;for(let n=0;n<e.length;++n){let r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}};var dge=\"\",bY={};function eO(t){for(let e in bY)if(t.startsWith(e)){let n=bY[e];t=t.replace(e,n)}return!t.startsWith(\"http://\")&&!t.startsWith(\"https://\")&&(t=`${dge}${t}`),t}function wY(t){return t&&typeof t==\"object\"&&t.isBuffer}function vC(t){if(wY(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t==\"string\"){let e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t==\"object\"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error(\"toArrayBuffer\")}var tu={};Aa(tu,{dirname:()=>Age,filename:()=>pge,join:()=>gge,resolve:()=>mge});function TY(){if(typeof process<\"u\"&&typeof process.cwd<\"u\")return process.cwd();let t=window.location?.pathname;return t?.slice(0,t.lastIndexOf(\"/\")+1)||\"\"}function pge(t){let e=t?t.lastIndexOf(\"/\"):-1;return e>=0?t.substr(e+1):\"\"}function Age(t){let e=t?t.lastIndexOf(\"/\"):-1;return e>=0?t.substr(0,e):\"\"}function gge(...t){return t=t.map((n,r)=>(r&&(n=n.replace(new RegExp(\"^/\"),\"\")),r!==t.length-1&&(n=n.replace(new RegExp(\"/$\"),\"\")),n)),t.join(\"/\")}function mge(...t){let e=[];for(let o=0;o<t.length;o++)e[o]=t[o];let n=\"\",r=!1,i;for(let o=e.length-1;o>=-1&&!r;o--){let s;o>=0?s=e[o]:(i===void 0&&(i=TY()),s=i),s.length!==0&&(n=`${s}/${n}`,r=s.charCodeAt(0)===rb)}return n=_ge(n,!r),r?`/${n}`:n.length>0?n:\".\"}var rb=47,tO=46;function _ge(t,e){let n=\"\",r=-1,i=0,o,s=!1;for(let c=0;c<=t.length;++c){if(c<t.length)o=t.charCodeAt(c);else{if(o===rb)break;o=rb}if(o===rb){if(!(r===c-1||i===1))if(r!==c-1&&i===2){if(n.length<2||!s||n.charCodeAt(n.length-1)!==tO||n.charCodeAt(n.length-2)!==tO){if(n.length>2){let d=n.length-1,m=d;for(;m>=0&&n.charCodeAt(m)!==rb;--m);if(m!==d){n=m===-1?\"\":n.slice(0,m),r=c,i=0,s=!1;continue}}else if(n.length===2||n.length===1){n=\"\",r=c,i=0,s=!1;continue}}e&&(n.length>0?n+=\"/..\":n=\"..\",s=!0)}else{let d=t.slice(r+1,c);n.length>0?n+=`/${d}`:n=d,s=!1}r=c,i=0}else o===tO&&i!==-1?++i:i=-1}return n}var yge=t=>typeof t==\"boolean\",ib=t=>typeof t==\"function\",Tm=t=>t!==null&&typeof t==\"object\",nO=t=>Tm(t)&&t.constructor==={}.constructor;var EY=t=>!!t&&typeof t[Symbol.iterator]==\"function\",SY=t=>t&&typeof t[Symbol.asyncIterator]==\"function\";var Hu=t=>typeof Response<\"u\"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json;var Wu=t=>typeof Blob<\"u\"&&t instanceof Blob,CY=t=>t&&typeof t==\"object\"&&t.isBuffer;var xge=t=>typeof ReadableStream<\"u\"&&t instanceof ReadableStream||Tm(t)&&ib(t.tee)&&ib(t.cancel)&&ib(t.getReader);var vge=t=>Tm(t)&&ib(t.read)&&ib(t.pipe)&&yge(t.readable),bC=t=>xge(t)||vge(t);var wC=class extends Error{constructor(e,n){super(e),this.reason=n.reason,this.url=n.url,this.response=n.response}reason;url;response};var bge=/^data:([-\\w.]+\\/[-\\w.+]+)(;|,)/,wge=/^([-\\w.]+\\/[-\\w.+]+)/;function rO(t,e){return t.toLowerCase()===e.toLowerCase()}function MY(t){let e=wge.exec(t);return e?e[1]:t}function iO(t){let e=bge.exec(t);return e?e[1]:\"\"}var IY=/\\?.*/;function PY(t){let e=t.match(IY);return e&&e[0]}function dy(t){return t.replace(IY,\"\")}function RY(t){if(t.length<50)return t;let e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function Em(t){return Hu(t)?t.url:Wu(t)?t.name||\"\":typeof t==\"string\"?t:\"\"}function ob(t){if(Hu(t)){let e=t,n=e.headers.get(\"content-type\")||\"\",r=dy(e.url);return MY(n)||iO(r)}return Wu(t)?t.type||\"\":typeof t==\"string\"?iO(t):\"\"}function BY(t){return Hu(t)?t.headers[\"content-length\"]||-1:Wu(t)?t.size:typeof t==\"string\"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function TC(t){if(Hu(t))return t;let e={},n=BY(t);n>=0&&(e[\"content-length\"]=String(n));let r=Em(t),i=ob(t);i&&(e[\"content-type\"]=i);let o=await Ege(t);o&&(e[\"x-first-bytes\"]=o),typeof t==\"string\"&&(t=new TextEncoder().encode(t));let s=new Response(t,{headers:e});return Object.defineProperty(s,\"url\",{value:r}),s}async function DY(t){if(!t.ok)throw await Tge(t)}async function Tge(t){let e=RY(t.url),n=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;n=n.length>100?`${n.slice(0,100)}...`:n;let r={reason:t.statusText,url:t.url,response:t};try{let i=t.headers.get(\"Content-Type\");r.reason=!t.bodyUsed&&i?.includes(\"application/json\")?await t.json():await t.text()}catch{}return new wC(n,r)}async function Ege(t){if(typeof t==\"string\")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){let n=t.slice(0,5);return await new Promise(r=>{let i=new FileReader;i.onload=o=>r(o?.target?.result),i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){let n=t.slice(0,5);return`data:base64,${Sge(n)}`}return null}function Sge(t){let e=\"\",n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function Cge(t){return!Mge(t)&&!Ige(t)}function Mge(t){return t.startsWith(\"http:\")||t.startsWith(\"https:\")}function Ige(t){return t.startsWith(\"data:\")}async function oO(t,e){if(typeof t==\"string\"){let n=eO(t);return Cge(n)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(n,e):await fetch(n,e)}return await TC(t)}hy();var sO=new xc({id:\"loaders.gl\"}),EC=class{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}},SC=class{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}};var aO={fetch:null,mimeType:void 0,nothrow:!1,log:new SC,useLocalLibraries:!1,CDN:\"https://unpkg.com/@loaders.gl\",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:bp,_nodeWorkers:!1,_workerType:\"\",limit:0,_limitMB:0,batchSize:\"auto\",batchDebounceMs:0,metadata:!1,transforms:[]},LY={throws:\"nothrow\",dataType:\"(no longer used)\",uri:\"baseUri\",method:\"fetch.method\",headers:\"fetch.headers\",body:\"fetch.body\",mode:\"fetch.mode\",credentials:\"fetch.credentials\",cache:\"fetch.cache\",redirect:\"fetch.redirect\",referrer:\"fetch.referrer\",referrerPolicy:\"fetch.referrerPolicy\",integrity:\"fetch.integrity\",keepalive:\"fetch.keepalive\",signal:\"fetch.signal\"};function lO(){globalThis.loaders=globalThis.loaders||{};let{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function cO(){let t=lO();return t.globalOptions=t.globalOptions||{...aO},t.globalOptions}function kY(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],Pge(t,n),Bge(e,t,r)}function Pge(t,e){OY(t,null,aO,LY,e);for(let n of e){let r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};OY(r,n.id,i,o,e)}}function OY(t,e,n,r,i){let o=e||\"Top level\",s=e?`${e}.`:\"\";for(let c in t){let d=!e&&Tm(t[c]),m=c===\"baseUri\"&&!e,b=c===\"workerUrl\"&&e;if(!(c in n)&&!m&&!b){if(c in r)sO.warn(`${o} loader option '${s}${c}' no longer supported, use '${r[c]}'`)();else if(!d){let C=Rge(c,i);sO.warn(`${o} loader option '${s}${c}' not recognized. ${C}`)()}}}}function Rge(t,e){let n=t.toLowerCase(),r=\"\";for(let i of e)for(let o in i.options){if(t===o)return`Did you mean '${i.id}.${o}'?`;let s=o.toLowerCase();(n.startsWith(s)||s.startsWith(n))&&(r=r||`Did you mean '${i.id}.${o}'?`)}return r}function Bge(t,e,n){let i={...t.options||{}};return Dge(i,n),i.log===null&&(i.log=new EC),FY(i,cO()),FY(i,e),i}function FY(t,e){for(let n in e)if(n in e){let r=e[n];nO(r)&&nO(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function Dge(t,e){e&&!(\"baseUri\"in t)&&(t.baseUri=e)}function sb(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t?.extensions)):!1}function ab(t){Rr(t,\"null loader\"),Rr(sb(t),\"invalid loader\");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t?.parseTextSync||t?.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}var NY=()=>{let t=lO();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function uO(t){let e=NY();t=Array.isArray(t)?t:[t];for(let n of t){let r=ab(n);e.find(i=>r===i)||e.unshift(r)}}function zY(){return NY()}var Lge=/\\.([^.]+)$/;async function GY(t,e=[],n,r){if(!HY(t))return null;let i=UY(t,e,{...n,nothrow:!0},r);if(i)return i;if(Wu(t)&&(t=await t.slice(0,10).arrayBuffer(),i=UY(t,e,n,r)),!i&&!n?.nothrow)throw new Error(WY(t));return i}function UY(t,e=[],n,r){if(!HY(t))return null;if(e&&!Array.isArray(e))return ab(e);let i=[];e&&(i=i.concat(e)),n?.ignoreRegisteredLoaders||i.push(...zY()),Fge(i);let o=Oge(t,i,n,r);if(!o&&!n?.nothrow)throw new Error(WY(t));return o}function Oge(t,e,n,r){let i=Em(t),o=ob(t),s=dy(i)||r?.url,c=null,d=\"\";return n?.mimeType&&(c=hO(e,n?.mimeType),d=`match forced by supplied MIME type ${n?.mimeType}`),c=c||kge(e,s),d=d||(c?`matched url ${s}`:\"\"),c=c||hO(e,o),d=d||(c?`matched MIME type ${o}`:\"\"),c=c||zge(e,t),d=d||(c?`matched initial data ${jY(t)}`:\"\"),n?.fallbackMimeType&&(c=c||hO(e,n?.fallbackMimeType),d=d||(c?`matched fallback MIME type ${o}`:\"\")),d&&Qv.log(1,`selectLoader selected ${c?.name}: ${d}.`),c}function HY(t){return!(t instanceof Response&&t.status===204)}function WY(t){let e=Em(t),n=ob(t),r=\"No valid loader found (\";r+=e?`${tu.filename(e)}, `:\"no url provided, \",r+=`MIME type: ${n?`\"${n}\"`:\"not provided\"}, `;let i=t?jY(t):\"\";return r+=i?` first bytes: \"${i}\"`:\"first bytes: not available\",r+=\")\",r}function Fge(t){for(let e of t)ab(e)}function kge(t,e){let n=e&&Lge.exec(e),r=n&&n[1];return r?Nge(t,r):null}function Nge(t,e){e=e.toLowerCase();for(let n of t)for(let r of n.extensions)if(r.toLowerCase()===e)return n;return null}function hO(t,e){for(let n of t)if(n.mimeTypes?.some(r=>rO(e,r))||rO(e,`application/x.${n.id}`))return n;return null}function zge(t,e){if(!e)return null;for(let n of t)if(typeof e==\"string\"){if(Uge(e,n))return n}else if(ArrayBuffer.isView(e)){if(VY(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&VY(e,0,n))return n;return null}function Uge(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function VY(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>Vge(t,e,n,i))}function Vge(t,e,n,r){if(r instanceof ArrayBuffer)return ZL(r,t,r.byteLength);switch(typeof r){case\"function\":return r(t);case\"string\":let i=fO(t,e,r.length);return r===i;default:return!1}}function jY(t,e=5){return typeof t==\"string\"?t.slice(0,e):ArrayBuffer.isView(t)?fO(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?fO(t,0,e):\"\"}function fO(t,e,n){if(t.byteLength<e+n)return\"\";let r=new DataView(t),i=\"\";for(let o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}function*XY(t,e){let n=e?.chunkSize||262144,r=0,i=new TextEncoder;for(;r<t.length;){let o=Math.min(t.length-r,n),s=t.slice(r,r+o);r+=o,yield i.encode(s)}}function*YY(t,e={}){let{chunkSize:n=262144}=e,r=0;for(;r<t.byteLength;){let i=Math.min(t.byteLength-r,n),o=new ArrayBuffer(i),s=new Uint8Array(t,r,i);new Uint8Array(o).set(s),r+=i,yield o}}async function*ZY(t,e){let n=e?.chunkSize||1048576,r=0;for(;r<t.size;){let i=r+n,o=await t.slice(r,i).arrayBuffer();r=i,yield o}}function dO(t,e){return bp?Gge(t,e):Hge(t,e)}async function*Gge(t,e){let n=t.getReader(),r;try{for(;;){let i=r||n.read();e?._streamReadAhead&&(r=n.read());let{done:o,value:s}=await i;if(o)return;yield vC(s)}}catch{n.releaseLock()}}async function*Hge(t,e){for await(let n of t)yield vC(n)}function qY(t,e){if(typeof t==\"string\")return XY(t,e);if(t instanceof ArrayBuffer)return YY(t,e);if(Wu(t))return ZY(t,e);if(bC(t))return dO(t,e);if(Hu(t))return dO(t.body,e);throw new Error(\"makeIterator\")}var QY=\"Cannot convert supplied data type\";function Wge(t,e,n){if(e.text&&typeof t==\"string\")return t;if(CY(t)&&(t=t.buffer),t instanceof ArrayBuffer){let r=t;return e.text&&!e.binary?new TextDecoder(\"utf8\").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder(\"utf8\").decode(t);let r=t.buffer,i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(QY)}async function KY(t,e,n){let r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t==\"string\"||r)return Wge(t,e,n);if(Wu(t)&&(t=await TC(t)),Hu(t)){let i=t;return await DY(i),e.binary?await i.arrayBuffer():await i.text()}if(bC(t)&&(t=qY(t,n)),EY(t)||SY(t))return KL(t);throw new Error(QY)}function CC(t,e){let n=cO(),r=t||n;return typeof r.fetch==\"function\"?r.fetch:Tm(r.fetch)?i=>oO(i,r.fetch):e?.fetch?e?.fetch:oO}function JY(t,e,n){if(n)return n;let r={fetch:CC(e,t),...t};if(r.url){let i=dy(r.url);r.baseUrl=i,r.queryString=PY(r.url),r.filename=tu.filename(i),r.baseUrl=tu.dirname(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function $Y(t,e){if(t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){let r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:void 0}async function lb(t,e,n,r){e&&!Array.isArray(e)&&!sb(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};let i=Em(t),s=$Y(e,r),c=await GY(t,s,n);return c?(n=kY(n,c,s,i),r=JY({url:i,_parse:lb,loaders:s},n,r||null),await jge(c,t,n,r)):null}async function jge(t,e,n,r){if(HL(t),n=OL(t.options,n),Hu(e)){let o=e,{ok:s,redirected:c,status:d,statusText:m,type:b,url:C}=o,B=Object.fromEntries(o.headers.entries());r.response={headers:B,ok:s,redirected:c,status:d,statusText:m,type:b,url:C}}e=await KY(e,t,n);let i=t;if(i.parseTextSync&&typeof e==\"string\")return i.parseTextSync(e,n,r);if(jL(t,n))return await XL(t,e,n,r,lb);if(i.parseText&&typeof e==\"string\")return await i.parseText(e,n,r);if(i.parse)return await i.parse(e,n,r);throw ja(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}function eZ(t){switch(t.constructor){case Int8Array:return\"int8\";case Uint8Array:case Uint8ClampedArray:return\"uint8\";case Int16Array:return\"int16\";case Uint16Array:return\"uint16\";case Int32Array:return\"int32\";case Uint32Array:return\"uint32\";case Float32Array:return\"float32\";case Float64Array:return\"float64\";default:return\"null\"}}function wp(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0,c=t.POSITION?t.POSITION.value:[],d=c&&c.length;for(let m=0;m<d;m+=3){let b=c[m],C=c[m+1],B=c[m+2];e=b<e?b:e,n=C<n?C:n,r=B<r?B:r,i=b>i?b:i,o=C>o?C:o,s=B>s?B:s}return[[e,n,r],[i,o,s]]}function pO(t,e,n){let r=eZ(e.value),i=n||tZ(e);return{name:t,type:{type:\"fixed-size-list\",listSize:e.size,children:[{name:\"value\",type:r}]},nullable:!1,metadata:i}}function tZ(t){let e={};return\"byteOffset\"in t&&(e.byteOffset=t.byteOffset.toString(10)),\"byteStride\"in t&&(e.byteStride=t.byteStride.toString(10)),\"normalized\"in t&&(e.normalized=t.normalized.toString()),e}async function va(t,e,n,r){let i,o;!Array.isArray(e)&&!sb(e)?(i=[],o=e,r=void 0):(i=e,o=n);let s=CC(o),c=t;return typeof t==\"string\"&&(c=await s(t)),Wu(t)&&(c=await s(t)),Array.isArray(i)?await lb(c,i,o):await lb(c,i,o)}var nZ=\"4.3.3\";var Xge=globalThis.loaders?.parseImageNode,AO=typeof Image<\"u\",gO=typeof ImageBitmap<\"u\",Yge=!!Xge,mO=bp?!0:Yge;function rZ(t){switch(t){case\"auto\":return gO||AO||mO;case\"imagebitmap\":return gO;case\"image\":return AO;case\"data\":return mO;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function iZ(){if(gO)return\"imagebitmap\";if(AO)return\"image\";if(mO)return\"data\";throw new Error(\"Install '@loaders.gl/polyfills' to parse images under Node.js\")}function oZ(t){let e=Zge(t);if(!e)throw new Error(\"Not an image\");return e}function cb(t){switch(oZ(t)){case\"data\":return t;case\"image\":case\"imagebitmap\":let e=document.createElement(\"canvas\"),n=e.getContext(\"2d\");if(!n)throw new Error(\"getImageData\");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error(\"getImageData\")}}function Zge(t){return typeof ImageBitmap<\"u\"&&t instanceof ImageBitmap?\"imagebitmap\":typeof Image<\"u\"&&t instanceof Image?\"image\":t&&typeof t==\"object\"&&t.data&&t.width&&t.height?\"data\":null}var qge=/^data:image\\/svg\\+xml/,Qge=/\\.svg((\\?|#).*)?$/;function MC(t){return t&&(qge.test(t)||Qge.test(t))}function sZ(t,e){if(MC(e)){let r=new TextDecoder().decode(t);try{typeof unescape==\"function\"&&typeof encodeURIComponent==\"function\"&&(r=unescape(encodeURIComponent(r)))}catch(o){throw new Error(o.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return _O(t,e)}function _O(t,e){if(MC(e))throw new Error(\"SVG cannot be parsed directly to imagebitmap\");return new Blob([new Uint8Array(t)])}async function IC(t,e,n){let r=sZ(t,n),i=self.URL||self.webkitURL,o=typeof r!=\"string\"&&i.createObjectURL(r);try{return await Kge(o||r,e)}finally{o&&i.revokeObjectURL(o)}}async function Kge(t,e){let n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=o=>{let s=o instanceof Error?o.message:\"error\";i(new Error(s))}}catch(o){i(o)}})}var Jge={},aZ=!0;async function lZ(t,e,n){let r;MC(n)?r=await IC(t,e,n):r=_O(t,n);let i=e&&e.imagebitmap;return await $ge(r,i)}async function $ge(t,e=null){if((eme(e)||!aZ)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),aZ=!1}return await createImageBitmap(t)}function eme(t){for(let e in t||Jge)return!1;return!0}function cZ(t){return!ime(t,\"ftyp\",4)||(t[8]&96)===0?null:tme(t)}function tme(t){switch(nme(t,8,12).replace(\"\\0\",\" \").trim()){case\"avif\":case\"avis\":return{extension:\"avif\",mimeType:\"image/avif\"};default:return null}}function nme(t,e,n){return String.fromCharCode(...t.slice(e,n))}function rme(t){return[...t].map(e=>e.charCodeAt(0))}function ime(t,e,n=0){let r=rme(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}var Yf=!1,ub=!0;function Sm(t){let e=hb(t);return sme(e)||cme(e)||ame(e)||lme(e)||ome(e)}function ome(t){let e=new Uint8Array(t instanceof DataView?t.buffer:t),n=cZ(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function sme(t){let e=hb(t);return e.byteLength>=24&&e.getUint32(0,Yf)===2303741511?{mimeType:\"image/png\",width:e.getUint32(16,Yf),height:e.getUint32(20,Yf)}:null}function ame(t){let e=hb(t);return e.byteLength>=10&&e.getUint32(0,Yf)===1195984440?{mimeType:\"image/gif\",width:e.getUint16(6,ub),height:e.getUint16(8,ub)}:null}function lme(t){let e=hb(t);return e.byteLength>=14&&e.getUint16(0,Yf)===16973&&e.getUint32(2,ub)===e.byteLength?{mimeType:\"image/bmp\",width:e.getUint32(18,ub),height:e.getUint32(22,ub)}:null}function cme(t){let e=hb(t);if(!(e.byteLength>=3&&e.getUint16(0,Yf)===65496&&e.getUint8(2)===255))return null;let{tableMarkers:r,sofMarkers:i}=ume(),o=2;for(;o+9<e.byteLength;){let s=e.getUint16(o,Yf);if(i.has(s))return{mimeType:\"image/jpeg\",height:e.getUint16(o+5,Yf),width:e.getUint16(o+7,Yf)};if(!r.has(s))return null;o+=2,o+=e.getUint16(o,Yf)}return null}function ume(){let t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function hb(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error(\"toDataView\")}async function uZ(t,e){let{mimeType:n}=Sm(t)||{},r=globalThis.loaders?.parseImageNode;return Rr(r),await r(t,n)}async function hZ(t,e,n){e=e||{};let i=(e.image||{}).type||\"auto\",{url:o}=n||{},s=hme(i),c;switch(s){case\"imagebitmap\":c=await lZ(t,e,o);break;case\"image\":c=await IC(t,e,o);break;case\"data\":c=await uZ(t,e);break;default:Rr(!1)}return i===\"data\"&&(c=cb(c)),c}function hme(t){switch(t){case\"auto\":case\"data\":return iZ();default:return rZ(t),t}}var fme=[\"png\",\"jpg\",\"jpeg\",\"gif\",\"webp\",\"bmp\",\"ico\",\"svg\",\"avif\"],dme=[\"image/png\",\"image/jpeg\",\"image/gif\",\"image/webp\",\"image/avif\",\"image/bmp\",\"image/vnd.microsoft.icon\",\"image/svg+xml\"],pme={image:{type:\"auto\",decode:!0}},fb={dataType:null,batchType:null,id:\"image\",module:\"images\",name:\"Images\",version:nZ,mimeTypes:dme,extensions:fme,parse:hZ,tests:[t=>!!Sm(new DataView(t))],options:pme};var yO={};function xO(t){if(yO[t]===void 0){let e=bp?gme(t):Ame(t);yO[t]=e}return yO[t]}function Ame(t){let e=[\"image/png\",\"image/jpeg\",\"image/gif\"],n=globalThis.loaders?.imageFormatsNode||e;return!!globalThis.loaders?.parseImageNode&&n.includes(t)}function gme(t){switch(t){case\"image/avif\":case\"image/webp\":return mme(t);default:return!0}}function mme(t){try{return document.createElement(\"canvas\").toDataURL(t).indexOf(`data:${t}`)===0}catch{return!1}}hy();var _me=new xc({id:\"deck\"}),hn=_me;var vO={};function fZ(t){vO=t}function ss(t,e,n,r){hn.level>0&&vO[t]&&vO[t].call(null,e,n,r)}function yme(t){let e=t[0],n=t[t.length-1];return e===\"{\"&&n===\"}\"||e===\"[\"&&n===\"]\"}var dZ={dataType:null,batchType:null,id:\"JSON\",name:\"JSON\",module:\"\",version:\"\",options:{},extensions:[\"json\",\"geojson\"],mimeTypes:[\"application/json\",\"application/geo+json\"],testText:yme,parseTextSync:JSON.parse};function xme(){let t=\"9.2.6\",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(hn.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:hn,_registerLoggers:fZ},uO([dZ,[fb,{imagebitmap:{premultiplyAlpha:\"none\"}}]])),t}var pZ=xme();function PC(t,e){if(!t)throw new Error(e||\"shadertools: assertion failed.\")}var bO={number:{type:\"number\",validate(t,e){return Number.isFinite(t)&&typeof e==\"object\"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:\"array\",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function gZ(t){let e={};for(let[n,r]of Object.entries(t))e[n]=vme(r);return e}function vme(t){let e=AZ(t);if(e!==\"object\")return{value:t,...bO[e],type:e};if(typeof t==\"object\")return t?t.type!==void 0?{...t,...bO[t.type],type:t.type}:t.value===void 0?{type:\"object\",value:t}:(e=AZ(t.value),{...t,...bO[e],type:e}):{type:\"object\",value:null};throw new Error(\"props\")}function AZ(t){return Array.isArray(t)||ArrayBuffer.isView(t)?\"array\":typeof t}var mZ=`#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n`,_Z=`#ifdef MODULE_MATERIAL\n  fragColor = material_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  fragColor = lighting_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_FOG\n  fragColor = fog_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  fragColor = picking_filterHighlightColor(fragColor);\n  fragColor = picking_filterPickingColor(fragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n`;var bme={vertex:mZ,fragment:_Z},yZ=/void\\s+main\\s*\\([^)]*\\)\\s*\\{\\n?/,xZ=/}\\n?[^{}]*$/,wO=[],db=\"__LUMA_INJECT_DECLARATIONS__\";function vZ(t){let e={vertex:{},fragment:{}};for(let n in t){let r=t[n],i=wme(n);typeof r==\"string\"&&(r={order:0,injection:r}),e[i][n]=r}return e}function wme(t){let e=t.slice(0,2);switch(e){case\"vs\":return\"vertex\";case\"fs\":return\"fragment\";default:throw new Error(e)}}function pb(t,e,n,r=!1){let i=e===\"vertex\";for(let o in n){let s=n[o];s.sort((d,m)=>d.order-m.order),wO.length=s.length;for(let d=0,m=s.length;d<m;++d)wO[d]=s[d].injection;let c=`${wO.join(`\n`)}\n`;switch(o){case\"vs:#decl\":i&&(t=t.replace(db,c));break;case\"vs:#main-start\":i&&(t=t.replace(yZ,d=>d+c));break;case\"vs:#main-end\":i&&(t=t.replace(xZ,d=>c+d));break;case\"fs:#decl\":i||(t=t.replace(db,c));break;case\"fs:#main-start\":i||(t=t.replace(yZ,d=>d+c));break;case\"fs:#main-end\":i||(t=t.replace(xZ,d=>c+d));break;default:t=t.replace(o,d=>d+c)}}return t=t.replace(db,\"\"),r&&(t=t.replace(/\\}\\s*$/,o=>o+bme[e])),t}function py(t){t.map(e=>Tme(e))}function Tme(t){if(t.instance)return;py(t.dependencies||[]);let{propTypes:e={},deprecations:n=[],inject:r={}}=t,i={normalizedInjections:vZ(r),parsedDeprecations:Eme(n)};e&&(i.propValidators=gZ(e)),t.instance=i;let o={};e&&(o=Object.entries(e).reduce((s,[c,d])=>{let m=d?.value;return m&&(s[c]=m),s},{})),t.defaultUniforms={...t.defaultUniforms,...o}}function TO(t,e,n){t.deprecations?.forEach(r=>{r.regex?.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}function Eme(t){return t.forEach(e=>{switch(e.type){case\"function\":e.regex=new RegExp(`\\\\b${e.old}\\\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),t}function Ay(t){py(t);let e={},n={};bZ({modules:t,level:0,moduleMap:e,moduleDepth:n});let r=Object.keys(n).sort((i,o)=>n[o]-n[i]).map(i=>e[i]);return py(r),r}function bZ(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error(\"Possible loop in shader dependency graph\");for(let o of e)r[o.name]=o,(i[o.name]===void 0||i[o.name]<n)&&(i[o.name]=n);for(let o of e)o.dependencies&&bZ({modules:o.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function wZ(t){switch(t?.gpu.toLowerCase()){case\"apple\":return`#define APPLE_GPU\n// Apple optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n`;case\"nvidia\":return`#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n`;case\"intel\":return`#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n`;case\"amd\":return`#define AMD_GPU\n`;default:return`#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Headless Chrome's software shader 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// If the GPU doesn't have full 32 bits precision, will causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n`}}function EZ(t,e){if(Number(t.match(/^#version[ \\t]+(\\d+)/m)?.[1]||100)!==300)throw new Error(\"luma.gl v9 only supports GLSL 3.00 shader sources\");switch(e){case\"vertex\":return t=TZ(t,Sme),t;case\"fragment\":return t=TZ(t,Cme),t;default:throw new Error(e)}}var SZ=[[/^(#version[ \\t]+(100|300[ \\t]+es))?[ \\t]*\\n/,`#version 300 es\n`],[/\\btexture(2D|2DProj|Cube)Lod(EXT)?\\(/g,\"textureLod(\"],[/\\btexture(2D|2DProj|Cube)(EXT)?\\(/g,\"texture(\"]],Sme=[...SZ,[EO(\"attribute\"),\"in $1\"],[EO(\"varying\"),\"out $1\"]],Cme=[...SZ,[EO(\"varying\"),\"in $1\"]];function TZ(t,e){for(let[n,r]of e)t=t.replace(n,r);return t}function EO(t){return new RegExp(`\\\\b${t}[ \\\\t]+(\\\\w+[ \\\\t]+\\\\w+(\\\\[\\\\w+\\\\])?;)`,\"g\")}function SO(t,e){let n=\"\";for(let r in t){let i=t[r];if(n+=`void ${i.signature} {\n`,i.header&&(n+=`  ${i.header}`),e[r]){let o=e[r];o.sort((s,c)=>s.order-c.order);for(let s of o)n+=`  ${s.injection}\n`}i.footer&&(n+=`  ${i.footer}`),n+=`}\n`}return n}function CO(t){let e={vertex:{},fragment:{}};for(let n of t){let r,i;typeof n!=\"string\"?(r=n,i=r.hook):(r={},i=n),i=i.trim();let[o,s]=i.split(\":\"),c=i.replace(/\\(.+/,\"\"),d=Object.assign(r,{signature:s});switch(o){case\"vs\":e.vertex[c]=d;break;case\"fs\":e.fragment[c]=d;break;default:throw new Error(o)}}return e}function CZ(t,e){return{name:Mme(t,e),language:\"glsl\",version:Ime(t)}}function Mme(t,e=\"unnamed\"){let r=/#define[^\\S\\r\\n]*SHADER_NAME[^\\S\\r\\n]*([A-Za-z0-9_-]+)\\s*/.exec(t);return r?r[1]:e}function Ime(t){let e=100,n=t.match(/[^\\s]+/g);if(n&&n.length>=2&&n[0]===\"#version\"){let r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}var IZ=`\n\n${db}\n`,Pme=`precision highp float;\n`;function PZ(t){let e=Ay(t.modules||[]);return{source:Rme(t.platformInfo,{...t,source:t.source,stage:\"vertex\",modules:e}),getUniforms:BZ(e)}}function RZ(t){let{vs:e,fs:n}=t,r=Ay(t.modules||[]);return{vs:MZ(t.platformInfo,{...t,source:e,stage:\"vertex\",modules:r}),fs:MZ(t.platformInfo,{...t,source:n,stage:\"fragment\",modules:r}),getUniforms:BZ(r)}}function Rme(t,e){let{source:n,stage:r,modules:i,hookFunctions:o=[],inject:s={},log:c}=e;PC(typeof n==\"string\",\"shader source must be a string\");let d=n,m=\"\",b=CO(o),C={},B={},k={};for(let q in s){let K=typeof s[q]==\"string\"?{injection:s[q],order:0}:s[q],Y=/^(v|f)s:(#)?([\\w-]+)$/.exec(q);if(Y){let ee=Y[2],J=Y[3];ee?J===\"decl\"?B[q]=[K]:k[q]=[K]:C[q]=[K]}else k[q]=[K]}let V=i;for(let q of V){c&&TO(q,d,c);let K=DZ(q,\"wgsl\");m+=K;let Y=q.injections?.[r]||{};for(let ee in Y){let J=/^(v|f)s:#([\\w-]+)$/.exec(ee);if(J){let xe=J[2]===\"decl\"?B:k;xe[ee]=xe[ee]||[],xe[ee].push(Y[ee])}else C[ee]=C[ee]||[],C[ee].push(Y[ee])}}return m+=IZ,m=pb(m,r,B),m+=SO(b[r],C),m+=d,m=pb(m,r,k),m}function MZ(t,e){let{source:n,stage:r,language:i=\"glsl\",modules:o,defines:s={},hookFunctions:c=[],inject:d={},prologue:m=!0,log:b}=e;PC(typeof n==\"string\",\"shader source must be a string\");let C=i===\"glsl\"?CZ(n).version:-1,B=t.shaderLanguageVersion,k=C===100?\"#version 100\":\"#version 300 es\",q=n.split(`\n`).slice(1).join(`\n`),K={};o.forEach(Ee=>{Object.assign(K,Ee.defines)}),Object.assign(K,s);let Y=\"\";switch(i){case\"wgsl\":break;case\"glsl\":Y=m?`${k}\n\n// ----- PROLOGUE -------------------------\n${`#define SHADER_TYPE_${r.toUpperCase()}`}\n\n${wZ(t)}\n${r===\"fragment\"?Pme:\"\"}\n\n// ----- APPLICATION DEFINES -------------------------\n\n${Bme(K)}\n\n`:`${k}\n`;break}let ee=CO(c),J={},se={},xe={};for(let Ee in d){let Xe=typeof d[Ee]==\"string\"?{injection:d[Ee],order:0}:d[Ee],Ne=/^(v|f)s:(#)?([\\w-]+)$/.exec(Ee);if(Ne){let be=Ne[2],ge=Ne[3];be?ge===\"decl\"?se[Ee]=[Xe]:xe[Ee]=[Xe]:J[Ee]=[Xe]}else xe[Ee]=[Xe]}for(let Ee of o){b&&TO(Ee,q,b);let Xe=DZ(Ee,r);Y+=Xe;let Ne=Ee.instance?.normalizedInjections[r]||{};for(let be in Ne){let ge=/^(v|f)s:#([\\w-]+)$/.exec(be);if(ge){let Ct=ge[2]===\"decl\"?se:xe;Ct[be]=Ct[be]||[],Ct[be].push(Ne[be])}else J[be]=J[be]||[],J[be].push(Ne[be])}}return Y+=\"// ----- MAIN SHADER SOURCE -------------------------\",Y+=IZ,Y=pb(Y,r,se),Y+=SO(ee[r],J),Y+=q,Y=pb(Y,r,xe),i===\"glsl\"&&C!==B&&(Y=EZ(Y,r)),Y.trim()}function BZ(t){return function(n){let r={};for(let i of t){let o=i.getUniforms?.(n,r);Object.assign(r,o)}return r}}function Bme(t={}){let e=\"\";for(let n in t){let r=t[n];(r||Number.isFinite(r))&&(e+=`#define ${n.toUpperCase()} ${t[n]}\n`)}return e}function DZ(t,e){let n;switch(e){case\"vertex\":n=t.vs||\"\";break;case\"fragment\":n=t.fs||\"\";break;case\"wgsl\":n=t.source||\"\";break;default:PC(!1)}if(!t.name)throw new Error(\"Shader module must have a name\");let r=t.name.toUpperCase().replace(/[^0-9a-z]/gi,\"_\"),i=`// ----- MODULE ${t.name} ---------------\n\n`;return e!==\"wgsl\"&&(i+=`#define MODULE_${r}\n`),i+=`${n}\n`,i}var Dme=/^\\s*\\#\\s*ifdef\\s*([a-zA-Z_]+)\\s*$/,Lme=/^\\s*\\#\\s*endif\\s*$/;function LZ(t,e){let n=t.split(`\n`),r=[],i=!0,o=null;for(let s of n){let c=s.match(Dme),d=s.match(Lme);c?(o=c[1],i=!!e?.defines?.[o]):d?i=!0:i&&r.push(s)}return r.join(`\n`)}var Cm=class t{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return t.defaultShaderAssembler=t.defaultShaderAssembler||new t,t.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(n=>n.name===(typeof e==\"string\"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){let n=typeof e==\"string\"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n)}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){let n=this._getModuleList(e.modules),r=this._hookFunctions,{source:i,getUniforms:o}=PZ({...e,source:e.source,modules:n,hookFunctions:r});return{source:e.platformInfo.shaderLanguage===\"wgsl\"?LZ(i):i,getUniforms:o,modules:n}}assembleGLSLShaderPair(e){let n=this._getModuleList(e.modules),r=this._hookFunctions;return{...RZ({...e,vs:e.vs,fs:e.fs,modules:n,hookFunctions:r}),modules:n}}_getModuleList(e=[]){let n=new Array(this._defaultModules.length+e.length),r={},i=0;for(let o=0,s=this._defaultModules.length;o<s;++o){let c=this._defaultModules[o],d=c.name;n[i++]=c,r[d]=!0}for(let o=0,s=e.length;o<s;++o){let c=e[o],d=c.name;r[d]||(n[i++]=c,r[d]=!0)}return n.length=i,py(n),n}};var Ome=`out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}`,Fme=`#version 300 es\n${Ome}`;function Ab(t){let{input:e,inputChannels:n,output:r}=t||{};if(!e)return Fme;if(!n)throw new Error(\"inputChannels\");let i=kme(n),o=OZ(e,n);return`#version 300 es\nin ${i} ${e};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${o};\n}`}function kme(t){switch(t){case 1:return\"float\";case 2:return\"vec2\";case 3:return\"vec3\";case 4:return\"vec4\";default:throw new Error(`invalid channels: ${t}`)}}function OZ(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}lr();var vc=class{constructor(e,n){this.name=e,this.attributes=n,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}},WC=class{constructor(e,n,r){this.name=e,this.type=n,this.attributes=r,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},qf=class extends vc{constructor(e,n){super(e,n),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}},Qf=class extends vc{constructor(e,n){super(e,n),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}},Bb=class extends vc{constructor(e,n,r){super(e,r),this.format=n}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}},Cp=class extends vc{constructor(e,n,r,i){super(e,r),this.format=n,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e===\"vec2\"||e===\"vec3\"||e===\"vec4\"||e===\"mat2x2\"||e===\"mat2x3\"||e===\"mat2x4\"||e===\"mat3x2\"||e===\"mat3x3\"||e===\"mat3x4\"||e===\"mat4x2\"||e===\"mat4x3\"||e===\"mat4x4\"){if(this.format.name===\"f32\")return e+=\"f\",e;if(this.format.name===\"i32\")return e+=\"i\",e;if(this.format.name===\"u32\")return e+=\"u\",e;if(this.format.name===\"bool\")return e+=\"b\",e;if(this.format.name===\"f16\")return e+=\"h\",e}e+=`<${this.format.name}>`}else if(e===\"vec2\"||e===\"vec3\"||e===\"vec4\")return e;return e}},TA;(t=>{t[t.Uniform=0]=\"Uniform\",t[t.Storage=1]=\"Storage\",t[t.Texture=2]=\"Texture\",t[t.Sampler=3]=\"Sampler\",t[t.StorageTexture=4]=\"StorageTexture\"})(TA||(TA={}));var vy=class{constructor(e,n,r,i,o,s,c){this.name=e,this.type=n,this.group=r,this.binding=i,this.attributes=o,this.resourceType=s,this.access=c}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},$O=class{constructor(e,n){this.name=e,this.type=n}},e8=class{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i,this.interpolation=null}},jC=class{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i}},t8=class{constructor(e,n,r,i){this.name=e,this.type=n,this.attributes=r,this.id=i}},n8=class{constructor(e,n,r){this.name=e,this.type=n,this.attributes=r}},r8=class{constructor(e,n=null,r){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=n,this.attributes=r}},i8=class{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}};function x_e(t){var e=(32768&t)>>15,n=(31744&t)>>10,r=1023&t;return n==0?(e?-1:1)*Math.pow(2,-14)*(r/Math.pow(2,10)):n==31?r?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,n-15)*(1+r/Math.pow(2,10))}var bq=new Float32Array(1),v_e=new Int32Array(bq.buffer),dl=new Uint16Array(1);function b_e(t){bq[0]=t;let e=v_e[0],n=e>>31&1,r=e>>23&255,i=8388607&e;if(r===255)return dl[0]=n<<15|31744|(i!==0?512:0),dl[0];if(r===0){if(i===0)return dl[0]=n<<15,dl[0];i|=8388608;let o=113;for(;!(8388608&i);)i<<=1,o--;return r=127-o,i&=8388607,r>0?(i=(i>>126-r)+(i>>127-r&1),dl[0]=n<<15|r<<10|i>>13,dl[0]):(dl[0]=n<<15,dl[0])}return r=r-127+15,r>=31?(dl[0]=n<<15|31744,dl[0]):r<=0?r<-10?(dl[0]=n<<15,dl[0]):(i=(8388608|i)>>1-r,dl[0]=n<<15|i>>13,dl[0]):(i>>=13,dl[0]=n<<15|r<<10|i,dl[0])}var y8=new Uint32Array(1),wq=new Float32Array(y8.buffer,0,1);function xq(t){let e=112+(t>>6&31)<<23|(63&t)<<17;return y8[0]=e,wq[0]}function w_e(t,e,n,r,i,o,s,c,d){let m=r*(s>>=i)*(o>>=i)+n*s+e*c;switch(d){case\"r8unorm\":return[Ci(t,m,\"8unorm\",1)[0]];case\"r8snorm\":return[Ci(t,m,\"8snorm\",1)[0]];case\"r8uint\":return[Ci(t,m,\"8uint\",1)[0]];case\"r8sint\":return[Ci(t,m,\"8sint\",1)[0]];case\"rg8unorm\":{let b=Ci(t,m,\"8unorm\",2);return[b[0],b[1]]}case\"rg8snorm\":{let b=Ci(t,m,\"8snorm\",2);return[b[0],b[1]]}case\"rg8uint\":{let b=Ci(t,m,\"8uint\",2);return[b[0],b[1]]}case\"rg8sint\":{let b=Ci(t,m,\"8sint\",2);return[b[0],b[1]]}case\"rgba8unorm-srgb\":case\"rgba8unorm\":{let b=Ci(t,m,\"8unorm\",4);return[b[0],b[1],b[2],b[3]]}case\"rgba8snorm\":{let b=Ci(t,m,\"8snorm\",4);return[b[0],b[1],b[2],b[3]]}case\"rgba8uint\":{let b=Ci(t,m,\"8uint\",4);return[b[0],b[1],b[2],b[3]]}case\"rgba8sint\":{let b=Ci(t,m,\"8sint\",4);return[b[0],b[1],b[2],b[3]]}case\"bgra8unorm-srgb\":case\"bgra8unorm\":{let b=Ci(t,m,\"8unorm\",4);return[b[2],b[1],b[0],b[3]]}case\"r16uint\":return[Ci(t,m,\"16uint\",1)[0]];case\"r16sint\":return[Ci(t,m,\"16sint\",1)[0]];case\"r16float\":return[Ci(t,m,\"16float\",1)[0]];case\"rg16uint\":{let b=Ci(t,m,\"16uint\",2);return[b[0],b[1]]}case\"rg16sint\":{let b=Ci(t,m,\"16sint\",2);return[b[0],b[1]]}case\"rg16float\":{let b=Ci(t,m,\"16float\",2);return[b[0],b[1]]}case\"rgba16uint\":{let b=Ci(t,m,\"16uint\",4);return[b[0],b[1],b[2],b[3]]}case\"rgba16sint\":{let b=Ci(t,m,\"16sint\",4);return[b[0],b[1],b[2],b[3]]}case\"rgba16float\":{let b=Ci(t,m,\"16float\",4);return[b[0],b[1],b[2],b[3]]}case\"r32uint\":return[Ci(t,m,\"32uint\",1)[0]];case\"r32sint\":return[Ci(t,m,\"32sint\",1)[0]];case\"depth16unorm\":case\"depth24plus\":case\"depth24plus-stencil8\":case\"depth32float\":case\"depth32float-stencil8\":case\"r32float\":return[Ci(t,m,\"32float\",1)[0]];case\"rg32uint\":{let b=Ci(t,m,\"32uint\",2);return[b[0],b[1]]}case\"rg32sint\":{let b=Ci(t,m,\"32sint\",2);return[b[0],b[1]]}case\"rg32float\":{let b=Ci(t,m,\"32float\",2);return[b[0],b[1]]}case\"rgba32uint\":{let b=Ci(t,m,\"32uint\",4);return[b[0],b[1],b[2],b[3]]}case\"rgba32sint\":{let b=Ci(t,m,\"32sint\",4);return[b[0],b[1],b[2],b[3]]}case\"rgba32float\":{let b=Ci(t,m,\"32float\",4);return[b[0],b[1],b[2],b[3]]}case\"rg11b10ufloat\":{let b=new Uint32Array(t.buffer,m,1)[0],C=(4192256&b)>>11,B=(4290772992&b)>>22;return[xq(2047&b),xq(C),(function(k){let V=112+(k>>5&31)<<23|(31&k)<<18;return y8[0]=V,wq[0]})(B),1]}}return null}function Ci(t,e,n,r){let i=[0,0,0,0];for(let o=0;o<r;++o)switch(n){case\"8unorm\":i[o]=t[e]/255,e++;break;case\"8snorm\":i[o]=t[e]/255*2-1,e++;break;case\"8uint\":i[o]=t[e],e++;break;case\"8sint\":i[o]=t[e]-127,e++;break;case\"16uint\":i[o]=t[e]|t[e+1]<<8,e+=2;break;case\"16sint\":i[o]=(t[e]|t[e+1]<<8)-32768,e+=2;break;case\"16float\":i[o]=x_e(t[e]|t[e+1]<<8),e+=2;break;case\"32uint\":case\"32sint\":i[o]=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,e+=4;break;case\"32float\":i[o]=new Float32Array(t.buffer,e,1)[0],e+=4}return i}function Bi(t,e,n,r,i){for(let o=0;o<r;++o)switch(n){case\"8unorm\":t[e]=255*i[o],e++;break;case\"8snorm\":t[e]=.5*(i[o]+1)*255,e++;break;case\"8uint\":t[e]=i[o],e++;break;case\"8sint\":t[e]=i[o]+127,e++;break;case\"16uint\":new Uint16Array(t.buffer,e,1)[0]=i[o],e+=2;break;case\"16sint\":new Int16Array(t.buffer,e,1)[0]=i[o],e+=2;break;case\"16float\":{let s=b_e(i[o]);new Uint16Array(t.buffer,e,1)[0]=s,e+=2;break}case\"32uint\":new Uint32Array(t.buffer,e,1)[0]=i[o],e+=4;break;case\"32sint\":new Int32Array(t.buffer,e,1)[0]=i[o],e+=4;break;case\"32float\":new Float32Array(t.buffer,e,1)[0]=i[o],e+=4}return i}var KO={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},\"rgba8unorm-srgb\":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},\"bgra8unorm-srgb\":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:\"depth32float\",channels:1},\"depth24plus-stencil8\":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:\"depth32float\",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},\"depth32float-stencil8\":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:\"depth32float\",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},\"bc1-rgba-unorm\":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"bc1-rgba-unorm-srgb\":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"bc2-rgba-unorm\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"bc2-rgba-unorm-srgb\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"bc3-rgba-unorm\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"bc3-rgba-unorm-srgb\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"bc4-r-unorm\":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},\"bc4-r-snorm\":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},\"bc5-rg-unorm\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},\"bc5-rg-snorm\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},\"bc6h-rgb-ufloat\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"bc6h-rgb-float\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"bc7-rgba-unorm\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"bc7-rgba-unorm-srgb\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"etc2-rgb8unorm\":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"etc2-rgb8unorm-srgb\":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"etc2-rgb8a1unorm\":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"etc2-rgb8a1unorm-srgb\":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"etc2-rgba8unorm\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"etc2-rgba8unorm-srgb\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"eac-r11unorm\":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},\"eac-r11snorm\":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},\"eac-rg11unorm\":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},\"eac-rg11snorm\":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},\"astc-4x4-unorm\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"astc-4x4-unorm-srgb\":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},\"astc-5x4-unorm\":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},\"astc-5x4-unorm-srgb\":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},\"astc-5x5-unorm\":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},\"astc-5x5-unorm-srgb\":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},\"astc-6x5-unorm\":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},\"astc-6x5-unorm-srgb\":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},\"astc-6x6-unorm\":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},\"astc-6x6-unorm-srgb\":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},\"astc-8x5-unorm\":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},\"astc-8x5-unorm-srgb\":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},\"astc-8x6-unorm\":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},\"astc-8x6-unorm-srgb\":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},\"astc-8x8-unorm\":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},\"astc-8x8-unorm-srgb\":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},\"astc-10x5-unorm\":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},\"astc-10x5-unorm-srgb\":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},\"astc-10x6-unorm\":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},\"astc-10x6-unorm-srgb\":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},\"astc-10x8-unorm\":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},\"astc-10x8-unorm-srgb\":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},\"astc-10x10-unorm\":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},\"astc-10x10-unorm-srgb\":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},\"astc-12x10-unorm\":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},\"astc-12x10-unorm-srgb\":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},\"astc-12x12-unorm\":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},\"astc-12x12-unorm-srgb\":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}},Xu=class t{constructor(){this.id=t._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return\"\"}search(e){e(this)}searchBlock(e,n){if(e){n(My.instance);for(let r of e)r instanceof Array?this.searchBlock(r,n):r.search(n);n(Iy.instance)}}constEvaluate(e,n){throw new Error(\"Cannot evaluate node\")}constEvaluateString(e){return this.constEvaluate(e).toString()}};Xu._id=0;var My=class extends Xu{};My.instance=new My;var Iy=class extends Xu{};Iy.instance=new Iy;var Tq=new Set([\"all\",\"all\",\"any\",\"select\",\"arrayLength\",\"abs\",\"acos\",\"acosh\",\"asin\",\"asinh\",\"atan\",\"atanh\",\"atan2\",\"ceil\",\"clamp\",\"cos\",\"cosh\",\"countLeadingZeros\",\"countOneBits\",\"countTrailingZeros\",\"cross\",\"degrees\",\"determinant\",\"distance\",\"dot\",\"dot4U8Packed\",\"dot4I8Packed\",\"exp\",\"exp2\",\"extractBits\",\"faceForward\",\"firstLeadingBit\",\"firstTrailingBit\",\"floor\",\"fma\",\"fract\",\"frexp\",\"insertBits\",\"inverseSqrt\",\"ldexp\",\"length\",\"log\",\"log2\",\"max\",\"min\",\"mix\",\"modf\",\"normalize\",\"pow\",\"quantizeToF16\",\"radians\",\"reflect\",\"refract\",\"reverseBits\",\"round\",\"saturate\",\"sign\",\"sin\",\"sinh\",\"smoothStep\",\"sqrt\",\"step\",\"tan\",\"tanh\",\"transpose\",\"trunc\",\"dpdx\",\"dpdxCoarse\",\"dpdxFine\",\"dpdy\",\"dpdyCoarse\",\"dpdyFine\",\"fwidth\",\"fwidthCoarse\",\"fwidthFine\",\"textureDimensions\",\"textureGather\",\"textureGatherCompare\",\"textureLoad\",\"textureNumLayers\",\"textureNumLevels\",\"textureNumSamples\",\"textureSample\",\"textureSampleBias\",\"textureSampleCompare\",\"textureSampleCompareLevel\",\"textureSampleGrad\",\"textureSampleLevel\",\"textureSampleBaseClampToEdge\",\"textureStore\",\"atomicLoad\",\"atomicStore\",\"atomicAdd\",\"atomicSub\",\"atomicMax\",\"atomicMin\",\"atomicAnd\",\"atomicOr\",\"atomicXor\",\"atomicExchange\",\"atomicCompareExchangeWeak\",\"pack4x8snorm\",\"pack4x8unorm\",\"pack4xI8\",\"pack4xU8\",\"pack4x8Clamp\",\"pack4xU8Clamp\",\"pack2x16snorm\",\"pack2x16unorm\",\"pack2x16float\",\"unpack4x8snorm\",\"unpack4x8unorm\",\"unpack4xI8\",\"unpack4xU8\",\"unpack2x16snorm\",\"unpack2x16unorm\",\"unpack2x16float\",\"storageBarrier\",\"textureBarrier\",\"workgroupBarrier\",\"workgroupUniformLoad\",\"subgroupAdd\",\"subgroupExclusiveAdd\",\"subgroupInclusiveAdd\",\"subgroupAll\",\"subgroupAnd\",\"subgroupAny\",\"subgroupBallot\",\"subgroupBroadcast\",\"subgroupBroadcastFirst\",\"subgroupElect\",\"subgroupMax\",\"subgroupMin\",\"subgroupMul\",\"subgroupExclusiveMul\",\"subgroupInclusiveMul\",\"subgroupOr\",\"subgroupShuffle\",\"subgroupShuffleDown\",\"subgroupShuffleUp\",\"subgroupShuffleXor\",\"subgroupXor\",\"quadBroadcast\",\"quadSwapDiagonal\",\"quadSwapX\",\"quadSwapY\"]),mo=class extends Xu{constructor(){super()}},km=class extends mo{constructor(e,n,r,i,o,s){super(),this.calls=new Set,this.name=e,this.args=n,this.returnType=r,this.body=i,this.startLine=o,this.endLine=s}get astNodeType(){return\"function\"}search(e){if(this.attributes)for(let n of this.attributes)e(n);e(this);for(let n of this.args)e(n);this.searchBlock(this.body,e)}},o8=class extends mo{constructor(e){super(),this.expression=e}get astNodeType(){return\"staticAssert\"}search(e){this.expression.search(e)}},XC=class extends mo{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return\"while\"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}},Db=class extends mo{constructor(e,n){super(),this.body=e,this.loopId=n}get astNodeType(){return\"continuing\"}search(e){this.searchBlock(this.body,e)}},YC=class extends mo{constructor(e,n,r,i){super(),this.init=e,this.condition=n,this.increment=r,this.body=i}get astNodeType(){return\"for\"}search(e){var n,r,i;(n=this.init)===null||n===void 0||n.search(e),(r=this.condition)===null||r===void 0||r.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}},Zh=class extends mo{constructor(e,n,r,i,o){super(),this.attributes=null,this.name=e,this.type=n,this.storage=r,this.access=i,this.value=o}get astNodeType(){return\"var\"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}},Lb=class extends mo{constructor(e,n,r){super(),this.attributes=null,this.name=e,this.type=n,this.value=r}get astNodeType(){return\"override\"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}},Lm=class extends mo{constructor(e,n,r,i,o){super(),this.attributes=null,this.name=e,this.type=n,this.storage=r,this.access=i,this.value=o}get astNodeType(){return\"let\"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}},Ty=class extends mo{constructor(e,n,r,i,o){super(),this.attributes=null,this.name=e,this.type=n,this.storage=r,this.access=i,this.value=o}get astNodeType(){return\"const\"}constEvaluate(e,n){return this.value.constEvaluate(e,n)}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}},by,Rb,gt,it;(t=>{t.increment=\"++\",t.decrement=\"--\"})(by||(by={})),(t=>{t.parse=function(e){let n=e;if(n==\"parse\")throw new Error(\"Invalid value for IncrementOperator\");return t[n]}})(by||(by={}));var ZC=class extends mo{constructor(e,n){super(),this.operator=e,this.variable=n}get astNodeType(){return\"increment\"}search(e){this.variable.search(e)}};(t=>{t.assign=\"=\",t.addAssign=\"+=\",t.subtractAssin=\"-=\",t.multiplyAssign=\"*=\",t.divideAssign=\"/=\",t.moduloAssign=\"%=\",t.andAssign=\"&=\",t.orAssign=\"|=\",t.xorAssign=\"^=\",t.shiftLeftAssign=\"<<=\",t.shiftRightAssign=\">>=\"})(Rb||(Rb={})),(t=>{t.parse=function(e){let n=e;if(n==\"parse\")throw new Error(\"Invalid value for AssignOperator\");return n}})(Rb||(Rb={}));var qC=class extends mo{constructor(e,n,r){super(),this.operator=e,this.variable=n,this.value=r}get astNodeType(){return\"assign\"}search(e){this.variable.search(e),this.value.search(e)}},Ob=class extends mo{constructor(e,n){super(),this.name=e,this.args=n}get astNodeType(){return\"call\"}isBuiltin(){return Tq.has(this.name)}search(e){for(let n of this.args)n.search(e);e(this)}},QC=class extends mo{constructor(e,n){super(),this.body=e,this.continuing=n}get astNodeType(){return\"loop\"}search(e){var n;this.searchBlock(this.body,e),(n=this.continuing)===null||n===void 0||n.search(e)}},KC=class extends mo{constructor(e,n){super(),this.condition=e,this.cases=n}get astNodeType(){return\"switch\"}search(e){e(this);for(let n of this.cases)n.search(e)}},JC=class extends mo{constructor(e,n,r,i){super(),this.condition=e,this.body=n,this.elseif=r,this.else=i}get astNodeType(){return\"if\"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}},$C=class extends mo{constructor(e){super(),this.value=e}get astNodeType(){return\"return\"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}},s8=class extends mo{constructor(e){super(),this.name=e}get astNodeType(){return\"enable\"}},a8=class extends mo{constructor(e){super(),this.extensions=e}get astNodeType(){return\"requires\"}},eM=class extends mo{constructor(e,n){super(),this.severity=e,this.rule=n}get astNodeType(){return\"diagnostic\"}},Fb=class extends mo{constructor(e,n){super(),this.name=e,this.type=n}get astNodeType(){return\"alias\"}},l8=class extends mo{constructor(){super()}get astNodeType(){return\"discard\"}},tM=class extends mo{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return\"break\"}},nM=class extends mo{constructor(){super(),this.loopId=-1}get astNodeType(){return\"continue\"}},Wt=class t extends mo{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return\"type\"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let n=e[0];if(n.name===\"f32\")return n;for(let r=1;r<e.length;++r){let i=t._priority.get(n.name);t._priority.get(e[r].name)<i&&(n=e[r])}return n.name===\"x32\"?t.i32:n}getTypeName(){return this.name}};Wt.x32=new Wt(\"x32\"),Wt.f32=new Wt(\"f32\"),Wt.i32=new Wt(\"i32\"),Wt.u32=new Wt(\"u32\"),Wt.f16=new Wt(\"f16\"),Wt.bool=new Wt(\"bool\"),Wt.void=new Wt(\"void\"),Wt._priority=new Map([[\"f32\",0],[\"f16\",1],[\"u32\",2],[\"i32\",3],[\"x32\",3]]);var rM=class extends Wt{constructor(e){super(e)}},Yh=class extends Wt{constructor(e,n,r,i){super(e),this.members=n,this.startLine=r,this.endLine=i}get astNodeType(){return\"struct\"}get isStruct(){return!0}getMemberIndex(e){for(let n=0;n<this.members.length;n++)if(this.members[n].name==e)return n;return-1}search(e){for(let n of this.members)e(n)}},ut=class extends Wt{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return\"template\"}getTypeName(){let e=this.name;if(this.format!==null){if(e===\"vec2\"||e===\"vec3\"||e===\"vec4\"||e===\"mat2x2\"||e===\"mat2x3\"||e===\"mat2x4\"||e===\"mat3x2\"||e===\"mat3x3\"||e===\"mat3x4\"||e===\"mat4x2\"||e===\"mat4x3\"||e===\"mat4x4\"){if(this.format.name===\"f32\")return e+=\"f\",e;if(this.format.name===\"i32\")return e+=\"i\",e;if(this.format.name===\"u32\")return e+=\"u\",e;if(this.format.name===\"bool\")return e+=\"b\",e;if(this.format.name===\"f16\")return e+=\"h\",e}e+=`<${this.format.name}>`}else if(e===\"vec2\"||e===\"vec3\"||e===\"vec4\")return e;return e}};ut.vec2f=new ut(\"vec2\",Wt.f32,null),ut.vec3f=new ut(\"vec3\",Wt.f32,null),ut.vec4f=new ut(\"vec4\",Wt.f32,null),ut.vec2i=new ut(\"vec2\",Wt.i32,null),ut.vec3i=new ut(\"vec3\",Wt.i32,null),ut.vec4i=new ut(\"vec4\",Wt.i32,null),ut.vec2u=new ut(\"vec2\",Wt.u32,null),ut.vec3u=new ut(\"vec3\",Wt.u32,null),ut.vec4u=new ut(\"vec4\",Wt.u32,null),ut.vec2h=new ut(\"vec2\",Wt.f16,null),ut.vec3h=new ut(\"vec3\",Wt.f16,null),ut.vec4h=new ut(\"vec4\",Wt.f16,null),ut.vec2b=new ut(\"vec2\",Wt.bool,null),ut.vec3b=new ut(\"vec3\",Wt.bool,null),ut.vec4b=new ut(\"vec4\",Wt.bool,null),ut.mat2x2f=new ut(\"mat2x2\",Wt.f32,null),ut.mat2x3f=new ut(\"mat2x3\",Wt.f32,null),ut.mat2x4f=new ut(\"mat2x4\",Wt.f32,null),ut.mat3x2f=new ut(\"mat3x2\",Wt.f32,null),ut.mat3x3f=new ut(\"mat3x3\",Wt.f32,null),ut.mat3x4f=new ut(\"mat3x4\",Wt.f32,null),ut.mat4x2f=new ut(\"mat4x2\",Wt.f32,null),ut.mat4x3f=new ut(\"mat4x3\",Wt.f32,null),ut.mat4x4f=new ut(\"mat4x4\",Wt.f32,null),ut.mat2x2h=new ut(\"mat2x2\",Wt.f16,null),ut.mat2x3h=new ut(\"mat2x3\",Wt.f16,null),ut.mat2x4h=new ut(\"mat2x4\",Wt.f16,null),ut.mat3x2h=new ut(\"mat3x2\",Wt.f16,null),ut.mat3x3h=new ut(\"mat3x3\",Wt.f16,null),ut.mat3x4h=new ut(\"mat3x4\",Wt.f16,null),ut.mat4x2h=new ut(\"mat4x2\",Wt.f16,null),ut.mat4x3h=new ut(\"mat4x3\",Wt.f16,null),ut.mat4x4h=new ut(\"mat4x4\",Wt.f16,null),ut.mat2x2i=new ut(\"mat2x2\",Wt.i32,null),ut.mat2x3i=new ut(\"mat2x3\",Wt.i32,null),ut.mat2x4i=new ut(\"mat2x4\",Wt.i32,null),ut.mat3x2i=new ut(\"mat3x2\",Wt.i32,null),ut.mat3x3i=new ut(\"mat3x3\",Wt.i32,null),ut.mat3x4i=new ut(\"mat3x4\",Wt.i32,null),ut.mat4x2i=new ut(\"mat4x2\",Wt.i32,null),ut.mat4x3i=new ut(\"mat4x3\",Wt.i32,null),ut.mat4x4i=new ut(\"mat4x4\",Wt.i32,null),ut.mat2x2u=new ut(\"mat2x2\",Wt.u32,null),ut.mat2x3u=new ut(\"mat2x3\",Wt.u32,null),ut.mat2x4u=new ut(\"mat2x4\",Wt.u32,null),ut.mat3x2u=new ut(\"mat3x2\",Wt.u32,null),ut.mat3x3u=new ut(\"mat3x3\",Wt.u32,null),ut.mat3x4u=new ut(\"mat3x4\",Wt.u32,null),ut.mat4x2u=new ut(\"mat4x2\",Wt.u32,null),ut.mat4x3u=new ut(\"mat4x3\",Wt.u32,null),ut.mat4x4u=new ut(\"mat4x4\",Wt.u32,null);var Ey=class extends Wt{constructor(e,n,r,i){super(e),this.storage=n,this.type=r,this.access=i}get astNodeType(){return\"pointer\"}},Om=class extends Wt{constructor(e,n,r,i){super(e),this.attributes=n,this.format=r,this.count=i}get astNodeType(){return\"array\"}get isArray(){return!0}},Dm=class extends Wt{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return\"sampler\"}},ru=class extends Xu{constructor(){super(),this.postfix=null}},Mp=class extends ru{constructor(e){super(),this.value=e}get astNodeType(){return\"stringExpr\"}toString(){return this.value}constEvaluateString(){return this.value}},ju=class extends ru{constructor(e,n){super(),this.type=e,this.args=n}get astNodeType(){return\"createExpr\"}search(e){if(e(this),this.args)for(let n of this.args)n.search(e)}constEvaluate(e,n){return n&&(n[0]=this.type),e.evalExpression(this,e.context)}},kb=class extends ru{constructor(e,n){super(),this.cachedReturnValue=null,this.name=e,this.args=n}get astNodeType(){return\"callExpr\"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return Tq.has(this.name)}constEvaluate(e,n){return e.evalExpression(this,e.context)}search(e){for(let n of this.args)n.search(e);e(this)}},Kl=class extends ru{constructor(e){super(),this.name=e}get astNodeType(){return\"varExpr\"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,n){return e.evalExpression(this,e.context)}},iM=class extends ru{constructor(e,n){super(),this.name=e,this.initializer=n}get astNodeType(){return\"constExpr\"}constEvaluate(e,n){if(this.initializer){let r=e.evalExpression(this.initializer,e.context);return r!==null&&this.postfix?r.getSubData(e,this.postfix,e.context):r}return null}search(e){this.initializer.search(e)}},ms=class extends ru{constructor(e,n){super(),this.value=e,this.type=n}get astNodeType(){return\"literalExpr\"}constEvaluate(e,n){return n!==void 0&&(n[0]=this.type),this.value}get isScalar(){return this.value instanceof st}get isVector(){return this.value instanceof Ue||this.value instanceof or}get scalarValue(){return this.value instanceof st?this.value.value:(console.error(\"Value is not scalar.\"),0)}get vectorValue(){return this.value instanceof Ue||this.value instanceof or?this.value.data:(console.error(\"Value is not a vector or matrix.\"),new Float32Array(0))}},oM=class extends ru{constructor(e,n){super(),this.type=e,this.value=n}get astNodeType(){return\"bitcastExpr\"}search(e){this.value.search(e)}};var SA=class extends ru{constructor(e){super(),this.index=e}search(e){this.index.search(e)}},sM=class extends ru{constructor(){super()}},as=class extends sM{constructor(e,n){super(),this.operator=e,this.right=n}get astNodeType(){return\"unaryOp\"}constEvaluate(e,n){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}},nu=class extends sM{constructor(e,n,r){super(),this.operator=e,this.left=n,this.right=r}get astNodeType(){return\"binaryOp\"}_getPromotedType(e,n){return e.name===n.name?e:e.name===\"f32\"||n.name===\"f32\"?Wt.f32:e.name===\"u32\"||n.name===\"u32\"?Wt.u32:Wt.i32}constEvaluate(e,n){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}},aM=class extends Xu{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}},Sy=class extends ru{constructor(){super()}get astNodeType(){return\"default\"}},lM=class extends aM{constructor(e,n){super(n),this.selectors=e}get astNodeType(){return\"case\"}search(e){this.searchBlock(this.body,e)}},cM=class extends aM{constructor(e){super(e)}get astNodeType(){return\"default\"}search(e){this.searchBlock(this.body,e)}},uM=class extends Xu{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return\"argument\"}},c8=class extends Xu{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return\"elseif\"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}},hM=class extends Xu{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return\"member\"}},fM=class extends Xu{constructor(e,n){super(),this.name=e,this.value=n}get astNodeType(){return\"attribute\"}},Yu=class t{constructor(e,n){this.parent=null,this.typeInfo=e,this.parent=n,this.id=t._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,n,r,i){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,n,r){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}};Yu._id=0;var Nb=class extends Yu{constructor(){super(new vc(\"void\",null),null)}toString(){return\"void\"}};Nb.void=new Nb;var EA=class extends Yu{constructor(e){super(new Bb(\"pointer\",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,n,r,i){this.reference.setDataValue(e,n,r,i)}getSubData(e,n,r){return n?this.reference.getSubData(e,n,r):this}toString(){return`&${this.reference.toString()}`}},st=class t extends Yu{constructor(e,n,r=null){super(n,r),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name===\"x32\"?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name===\"i32\"||this.typeInfo.name===\"bool\"?this.data=new Int32Array([e]):this.typeInfo.name===\"u32\"?this.data=new Uint32Array([e]):this.typeInfo.name===\"f32\"||this.typeInfo.name===\"f16\"?this.data=new Float32Array([e]):console.error(\"ScalarData2: Invalid type\",n)}clone(){if(this.data instanceof Float32Array)return new t(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new t(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new t(new Uint32Array(this.data),this.typeInfo,null);throw\"ScalarData: Invalid data type\"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,n,r,i){if(r)return void console.error(\"SetDataValue: Scalar data does not support postfix\",r);if(!(n instanceof t))return void console.error(\"SetDataValue: Invalid value\",n);let o=n.data[0];this.typeInfo.name===\"i32\"||this.typeInfo.name===\"u32\"?o=Math.floor(o):this.typeInfo.name===\"bool\"&&(o=o?1:0),this.data[0]=o}getSubData(e,n,r){return n?(console.error(\"getSubData: Scalar data does not support postfix\",n),null):this}toString(){return`${this.value}`}};function T_e(t,e,n){let r=e.length;return r===2?n===\"f32\"?new Ue(new Float32Array(e),t.getTypeInfo(\"vec2f\")):n===\"i32\"||n===\"bool\"?new Ue(new Int32Array(e),t.getTypeInfo(\"vec2i\")):n===\"u32\"?new Ue(new Uint32Array(e),t.getTypeInfo(\"vec2u\")):n===\"f16\"?new Ue(new Float32Array(e),t.getTypeInfo(\"vec2h\")):(console.error(`getSubData: Unknown format ${n}`),null):r===3?n===\"f32\"?new Ue(new Float32Array(e),t.getTypeInfo(\"vec3f\")):n===\"i32\"||n===\"bool\"?new Ue(new Int32Array(e),t.getTypeInfo(\"vec3i\")):n===\"u32\"?new Ue(new Uint32Array(e),t.getTypeInfo(\"vec3u\")):n===\"f16\"?new Ue(new Float32Array(e),t.getTypeInfo(\"vec3h\")):(console.error(`getSubData: Unknown format ${n}`),null):r===4?n===\"f32\"?new Ue(new Float32Array(e),t.getTypeInfo(\"vec4f\")):n===\"i32\"||n===\"bool\"?new Ue(new Int32Array(e),t.getTypeInfo(\"vec4i\")):n===\"u32\"?new Ue(new Uint32Array(e),t.getTypeInfo(\"vec4u\")):n===\"f16\"?new Ue(new Float32Array(e),t.getTypeInfo(\"vec4h\")):(console.error(`getSubData: Unknown format ${n}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}var Ue=class t extends Yu{constructor(e,n,r=null){if(super(n,r),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{let i=this.typeInfo.name;i===\"vec2f\"||i===\"vec3f\"||i===\"vec4f\"?this.data=new Float32Array(e):i===\"vec2i\"||i===\"vec3i\"||i===\"vec4i\"?this.data=new Int32Array(e):i===\"vec2u\"||i===\"vec3u\"||i===\"vec4u\"?this.data=new Uint32Array(e):i===\"vec2h\"||i===\"vec3h\"||i===\"vec4h\"?this.data=new Float32Array(e):i===\"vec2b\"||i===\"vec3b\"||i===\"vec4b\"?this.data=new Int32Array(e):i===\"vec2\"||i===\"vec3\"||i===\"vec4\"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${i}`)}}clone(){if(this.data instanceof Float32Array)return new t(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new t(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new t(new Uint32Array(this.data),this.typeInfo,null);throw\"VectorData: Invalid data type\"}setDataValue(e,n,r,i){r instanceof Mp?console.error(\"TODO: Set vector postfix\"):n instanceof t?this.data=n.data:console.error(\"SetDataValue: Invalid value\",n)}getSubData(e,n,r){if(n===null)return this;let i=e.getTypeInfo(\"f32\");if(this.typeInfo instanceof Cp)i=this.typeInfo.format||i;else{let s=this.typeInfo.name;s===\"vec2f\"||s===\"vec3f\"||s===\"vec4f\"?i=e.getTypeInfo(\"f32\"):s===\"vec2i\"||s===\"vec3i\"||s===\"vec4i\"?i=e.getTypeInfo(\"i32\"):s===\"vec2b\"||s===\"vec3b\"||s===\"vec4b\"?i=e.getTypeInfo(\"bool\"):s===\"vec2u\"||s===\"vec3u\"||s===\"vec4u\"?i=e.getTypeInfo(\"u32\"):s===\"vec2h\"||s===\"vec3h\"||s===\"vec4h\"?i=e.getTypeInfo(\"f16\"):console.error(`GetSubData: Unknown type ${s}`)}let o=this;for(;n!==null&&o!==null;){if(n instanceof SA){let s=n.index,c=-1;if(s instanceof ms){if(!(s.value instanceof st))return console.error(`GetSubData: Invalid array index ${s.value}`),null;c=s.value.value}else{let d=e.evalExpression(s,r);if(!(d instanceof st))return console.error(\"GetSubData: Unknown index type\",s),null;c=d.value}if(c<0||c>=o.data.length)return console.error(\"GetSubData: Index out of range\",c),null;if(o.data instanceof Float32Array){let d=new Float32Array(o.data.buffer,o.data.byteOffset+4*c,1);return new st(d,i)}if(o.data instanceof Int32Array){let d=new Int32Array(o.data.buffer,o.data.byteOffset+4*c,1);return new st(d,i)}if(o.data instanceof Uint32Array){let d=new Uint32Array(o.data.buffer,o.data.byteOffset+4*c,1);return new st(d,i)}throw\"GetSubData: Invalid data type\"}if(!(n instanceof Mp))return console.error(\"GetSubData: Unknown postfix\",n),null;{let s=n.value.toLowerCase();if(s.length===1){let d=0;if(s===\"x\"||s===\"r\")d=0;else if(s===\"y\"||s===\"g\")d=1;else if(s===\"z\"||s===\"b\")d=2;else{if(s!==\"w\"&&s!==\"a\")return console.error(`GetSubData: Unknown member ${s}`),null;d=3}if(this.data instanceof Float32Array){let m=new Float32Array(this.data.buffer,this.data.byteOffset+4*d,1);return new st(m,i,this)}if(this.data instanceof Int32Array){let m=new Int32Array(this.data.buffer,this.data.byteOffset+4*d,1);return new st(m,i,this)}if(this.data instanceof Uint32Array){let m=new Uint32Array(this.data.buffer,this.data.byteOffset+4*d,1);return new st(m,i,this)}}let c=[];for(let d of s)d===\"x\"||d===\"r\"?c.push(this.data[0]):d===\"y\"||d===\"g\"?c.push(this.data[1]):d===\"z\"||d===\"b\"?c.push(this.data[2]):d===\"w\"||d===\"a\"?c.push(this.data[3]):console.error(`GetDataValue: Unknown member ${d}`);o=T_e(e,c,i.name)}n=n.postfix}return o}toString(){let e=`${this.data[0]}`;for(let n=1;n<this.data.length;++n)e+=`, ${this.data[n]}`;return e}},or=class t extends Yu{constructor(e,n,r=null){super(n,r),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new t(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,n,r,i){r instanceof Mp?console.error(\"TODO: Set matrix postfix\"):n instanceof t?this.data=n.data:console.error(\"SetDataValue: Invalid value\",n)}getSubData(e,n,r){if(n===null)return this;let i=this.typeInfo.name;if(e.getTypeInfo(\"f32\"),this.typeInfo instanceof Cp)this.typeInfo.format;else if(i.endsWith(\"f\"))e.getTypeInfo(\"f32\");else if(i.endsWith(\"i\"))e.getTypeInfo(\"i32\");else if(i.endsWith(\"u\"))e.getTypeInfo(\"u32\");else{if(!i.endsWith(\"h\"))return console.error(`GetDataValue: Unknown type ${i}`),null;e.getTypeInfo(\"f16\")}if(n instanceof SA){let o=n.index,s=-1;if(o instanceof ms){if(!(o.value instanceof st))return console.error(`GetDataValue: Invalid array index ${o.value}`),null;s=o.value.value}else{let m=e.evalExpression(o,r);if(!(m instanceof st))return console.error(\"GetDataValue: Unknown index type\",o),null;s=m.value}if(s<0||s>=this.data.length)return console.error(\"GetDataValue: Index out of range\",s),null;let c=i.endsWith(\"h\")?\"h\":\"f\",d;if(i===\"mat2x2\"||i===\"mat2x2f\"||i===\"mat2x2h\"||i===\"mat3x2\"||i===\"mat3x2f\"||i===\"mat3x2h\"||i===\"mat4x2\"||i===\"mat4x2f\"||i===\"mat4x2h\")d=new Ue(new Float32Array(this.data.buffer,this.data.byteOffset+2*s*4,2),e.getTypeInfo(`vec2${c}`));else if(i===\"mat2x3\"||i===\"mat2x3f\"||i===\"mat2x3h\"||i===\"mat3x3\"||i===\"mat3x3f\"||i===\"mat3x3h\"||i===\"mat4x3\"||i===\"mat4x3f\"||i===\"mat4x3h\")d=new Ue(new Float32Array(this.data.buffer,this.data.byteOffset+3*s*4,3),e.getTypeInfo(`vec3${c}`));else{if(i!==\"mat2x4\"&&i!==\"mat2x4f\"&&i!==\"mat2x4h\"&&i!==\"mat3x4\"&&i!==\"mat3x4f\"&&i!==\"mat3x4h\"&&i!==\"mat4x4\"&&i!==\"mat4x4f\"&&i!==\"mat4x4h\")return console.error(`GetDataValue: Unknown type ${i}`),null;d=new Ue(new Float32Array(this.data.buffer,this.data.byteOffset+4*s*4,4),e.getTypeInfo(`vec4${c}`))}return n.postfix?d.getSubData(e,n.postfix,r):d}return console.error(\"GetDataValue: Invalid postfix\",n),null}toString(){let e=`${this.data[0]}`;for(let n=1;n<this.data.length;++n)e+=`, ${this.data[n]}`;return e}},Vs=class t extends Yu{constructor(e,n,r=0,i=null){super(n,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=r}clone(){let e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new t(e.buffer,this.typeInfo,0,null)}setDataValue(e,n,r,i){if(n===null)return void console.log(\"setDataValue: NULL data.\");let o=this.offset,s=this.typeInfo;for(;r;){if(r instanceof SA)if(s instanceof Qf){let c=r.index;if(c instanceof ms){if(!(c.value instanceof st))return void console.error(`SetDataValue: Invalid index type ${c.value}`);o+=c.value.value*s.stride}else{let d=e.evalExpression(c,i);if(!(d instanceof st))return void console.error(\"SetDataValue: Unknown index type\",c);o+=d.value*s.stride}s=s.format}else console.error(`SetDataValue: Type ${s.getTypeName()} is not an array`);else{if(!(r instanceof Mp))return void console.error(\"SetDataValue: Unknown postfix type\",r);{let c=r.value;if(s instanceof qf){let d=!1;for(let m of s.members)if(m.name===c){o+=m.offset,s=m.type,d=!0;break}if(!d)return void console.error(`SetDataValue: Member ${c} not found`)}else if(s instanceof vc){let d=s.getTypeName(),m=0;if(c===\"x\"||c===\"r\")m=0;else if(c===\"y\"||c===\"g\")m=1;else if(c===\"z\"||c===\"b\")m=2;else{if(c!==\"w\"&&c!==\"a\")return void console.error(`SetDataValue: Unknown member ${c}`);m=3}if(!(n instanceof st))return void console.error(\"SetDataValue: Invalid value\",n);let b=n.value;return d===\"vec2f\"?void(new Float32Array(this.buffer,o,2)[m]=b):d===\"vec3f\"?void(new Float32Array(this.buffer,o,3)[m]=b):d===\"vec4f\"?void(new Float32Array(this.buffer,o,4)[m]=b):d===\"vec2i\"?void(new Int32Array(this.buffer,o,2)[m]=b):d===\"vec3i\"?void(new Int32Array(this.buffer,o,3)[m]=b):d===\"vec4i\"?void(new Int32Array(this.buffer,o,4)[m]=b):d===\"vec2u\"?void(new Uint32Array(this.buffer,o,2)[m]=b):d===\"vec3u\"?void(new Uint32Array(this.buffer,o,3)[m]=b):d===\"vec4u\"?void(new Uint32Array(this.buffer,o,4)[m]=b):void console.error(`SetDataValue: Type ${d} is not a struct`)}}}r=r.postfix}this.setData(e,n,s,o,i)}setData(e,n,r,i,o){let s=r.getTypeName();if(s!==\"f32\"&&s!==\"f16\")if(s!==\"i32\"&&s!==\"atomic<i32>\"&&s!==\"x32\")if(s!==\"u32\"&&s!==\"atomic<u32>\")if(s!==\"bool\"){if(s===\"vec2f\"||s===\"vec2h\"){let c=new Float32Array(this.buffer,i,2);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1]):(c[0]=n[0],c[1]=n[1]))}if(s===\"vec3f\"||s===\"vec3h\"){let c=new Float32Array(this.buffer,i,3);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2]):(c[0]=n[0],c[1]=n[1],c[2]=n[2]))}if(s===\"vec4f\"||s===\"vec4h\"){let c=new Float32Array(this.buffer,i,4);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3]))}if(s===\"vec2i\"){let c=new Int32Array(this.buffer,i,2);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1]):(c[0]=n[0],c[1]=n[1]))}if(s===\"vec3i\"){let c=new Int32Array(this.buffer,i,3);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2]):(c[0]=n[0],c[1]=n[1],c[2]=n[2]))}if(s===\"vec4i\"){let c=new Int32Array(this.buffer,i,4);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3]))}if(s===\"vec2u\"){let c=new Uint32Array(this.buffer,i,2);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1]):(c[0]=n[0],c[1]=n[1]))}if(s===\"vec3u\"){let c=new Uint32Array(this.buffer,i,3);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2]):(c[0]=n[0],c[1]=n[1],c[2]=n[2]))}if(s===\"vec4u\"){let c=new Uint32Array(this.buffer,i,4);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3]))}if(s===\"vec2b\"){let c=new Uint32Array(this.buffer,i,2);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1]):(c[0]=n[0],c[1]=n[1]))}if(s===\"vec3b\"){let c=new Uint32Array(this.buffer,i,3);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2]):(c[0]=n[0],c[1]=n[1],c[2]=n[2]))}if(s===\"vec4b\"){let c=new Uint32Array(this.buffer,i,4);return void(n instanceof Ue?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3]))}if(s===\"mat2x2f\"||s===\"mat2x2h\"){let c=new Float32Array(this.buffer,i,4);return void(n instanceof or?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3]))}if(s===\"mat2x3f\"||s===\"mat2x3h\"){let c=new Float32Array(this.buffer,i,6);return void(n instanceof or?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3],c[4]=n.data[4],c[5]=n.data[5]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3],c[4]=n[4],c[5]=n[5]))}if(s===\"mat2x4f\"||s===\"mat2x4h\"){let c=new Float32Array(this.buffer,i,8);return void(n instanceof or?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3],c[4]=n.data[4],c[5]=n.data[5],c[6]=n.data[6],c[7]=n.data[7]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3],c[4]=n[4],c[5]=n[5],c[6]=n[6],c[7]=n[7]))}if(s===\"mat3x2f\"||s===\"mat3x2h\"){let c=new Float32Array(this.buffer,i,6);return void(n instanceof or?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3],c[4]=n.data[4],c[5]=n.data[5]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3],c[4]=n[4],c[5]=n[5]))}if(s===\"mat3x3f\"||s===\"mat3x3h\"){let c=new Float32Array(this.buffer,i,9);return void(n instanceof or?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3],c[4]=n.data[4],c[5]=n.data[5],c[6]=n.data[6],c[7]=n.data[7],c[8]=n.data[8]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3],c[4]=n[4],c[5]=n[5],c[6]=n[6],c[7]=n[7],c[8]=n[8]))}if(s===\"mat3x4f\"||s===\"mat3x4h\"){let c=new Float32Array(this.buffer,i,12);return void(n instanceof or?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3],c[4]=n.data[4],c[5]=n.data[5],c[6]=n.data[6],c[7]=n.data[7],c[8]=n.data[8],c[9]=n.data[9],c[10]=n.data[10],c[11]=n.data[11]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3],c[4]=n[4],c[5]=n[5],c[6]=n[6],c[7]=n[7],c[8]=n[8],c[9]=n[9],c[10]=n[10],c[11]=n[11]))}if(s===\"mat4x2f\"||s===\"mat4x2h\"){let c=new Float32Array(this.buffer,i,8);return void(n instanceof or?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3],c[4]=n.data[4],c[5]=n.data[5],c[6]=n.data[6],c[7]=n.data[7]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3],c[4]=n[4],c[5]=n[5],c[6]=n[6],c[7]=n[7]))}if(s===\"mat4x3f\"||s===\"mat4x3h\"){let c=new Float32Array(this.buffer,i,12);return void(n instanceof or?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3],c[4]=n.data[4],c[5]=n.data[5],c[6]=n.data[6],c[7]=n.data[7],c[8]=n.data[8],c[9]=n.data[9],c[10]=n.data[10],c[11]=n.data[11]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3],c[4]=n[4],c[5]=n[5],c[6]=n[6],c[7]=n[7],c[8]=n[8],c[9]=n[9],c[10]=n[10],c[11]=n[11]))}if(s===\"mat4x4f\"||s===\"mat4x4h\"){let c=new Float32Array(this.buffer,i,16);return void(n instanceof or?(c[0]=n.data[0],c[1]=n.data[1],c[2]=n.data[2],c[3]=n.data[3],c[4]=n.data[4],c[5]=n.data[5],c[6]=n.data[6],c[7]=n.data[7],c[8]=n.data[8],c[9]=n.data[9],c[10]=n.data[10],c[11]=n.data[11],c[12]=n.data[12],c[13]=n.data[13],c[14]=n.data[14],c[15]=n.data[15]):(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3],c[4]=n[4],c[5]=n[5],c[6]=n[6],c[7]=n[7],c[8]=n[8],c[9]=n[9],c[10]=n[10],c[11]=n[11],c[12]=n[12],c[13]=n[13],c[14]=n[14],c[15]=n[15]))}if(n instanceof t){if(r===n.typeInfo)return void new Uint8Array(this.buffer,i,n.buffer.byteLength).set(new Uint8Array(n.buffer));console.error(\"SetDataValue: Type mismatch\",s,n.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${s}`)}else n instanceof st&&(new Int32Array(this.buffer,i,1)[0]=n.value);else n instanceof st&&(new Uint32Array(this.buffer,i,1)[0]=n.value);else n instanceof st&&(new Int32Array(this.buffer,i,1)[0]=n.value);else n instanceof st&&(new Float32Array(this.buffer,i,1)[0]=n.value)}getSubData(e,n,r){var i,o,s;if(n===null)return this;let c=this.offset,d=this.typeInfo;for(;n;){if(n instanceof SA){let b=n.index,C=b instanceof ru?e.evalExpression(b,r):b,B=0;if(C instanceof st?B=C.value:typeof C==\"number\"?B=C:console.error(\"GetDataValue: Invalid index type\",b),d instanceof Qf)c+=B*d.stride,d=d.format;else{let k=d.getTypeName();k===\"mat4x4\"||k===\"mat4x4f\"||k===\"mat4x4h\"?(c+=16*B,d=e.getTypeInfo(\"vec4f\")):console.error(`getDataValue: Type ${d.getTypeName()} is not an array`)}}else{if(!(n instanceof Mp))return console.error(\"GetDataValue: Unknown postfix type\",n),null;{let b=n.value;if(d instanceof qf){let C=!1;for(let B of d.members)if(B.name===b){c+=B.offset,d=B.type,C=!0;break}if(!C)return console.error(`GetDataValue: Member ${b} not found`),null}else if(d instanceof vc){let C=d.getTypeName();if(C===\"vec2f\"||C===\"vec3f\"||C===\"vec4f\"||C===\"vec2i\"||C===\"vec3i\"||C===\"vec4i\"||C===\"vec2u\"||C===\"vec3u\"||C===\"vec4u\"||C===\"vec2b\"||C===\"vec3b\"||C===\"vec4b\"||C===\"vec2h\"||C===\"vec3h\"||C===\"vec4h\"||C===\"vec2\"||C===\"vec3\"||C===\"vec4\"){if(b.length>0&&b.length<5){let B=\"f\",k=[];for(let V=0;V<b.length;++V){let q=b[V].toLowerCase(),K=0;if(q===\"x\"||q===\"r\")K=0;else if(q===\"y\"||q===\"g\")K=1;else if(q===\"z\"||q===\"b\")K=2;else{if(q!==\"w\"&&q!==\"a\")return console.error(`Unknown member ${b}`),null;K=3}if(b.length===1){if(C.endsWith(\"f\"))return this.buffer.byteLength<c+4*K+4?(console.log(\"Insufficient buffer data\"),null):new st(new Float32Array(this.buffer,c+4*K,1),e.getTypeInfo(\"f32\"),this);if(C.endsWith(\"h\"))return new st(new Float32Array(this.buffer,c+4*K,1),e.getTypeInfo(\"f16\"),this);if(C.endsWith(\"i\"))return new st(new Int32Array(this.buffer,c+4*K,1),e.getTypeInfo(\"i32\"),this);if(C.endsWith(\"b\"))return new st(new Int32Array(this.buffer,c+4*K,1),e.getTypeInfo(\"bool\"),this);if(C.endsWith(\"u\"))return new st(new Uint32Array(this.buffer,c+4*K,1),e.getTypeInfo(\"i32\"),this)}if(C===\"vec2f\")k.push(new Float32Array(this.buffer,c,2)[K]);else if(C===\"vec3f\"){if(c+12>=this.buffer.byteLength)return console.log(\"Insufficient buffer data\"),null;let Y=new Float32Array(this.buffer,c,3);k.push(Y[K])}else if(C===\"vec4f\")k.push(new Float32Array(this.buffer,c,4)[K]);else if(C===\"vec2i\")B=\"i\",k.push(new Int32Array(this.buffer,c,2)[K]);else if(C===\"vec3i\")B=\"i\",k.push(new Int32Array(this.buffer,c,3)[K]);else if(C===\"vec4i\")B=\"i\",k.push(new Int32Array(this.buffer,c,4)[K]);else if(C===\"vec2u\"){B=\"u\";let Y=new Uint32Array(this.buffer,c,2);k.push(Y[K])}else C===\"vec3u\"?(B=\"u\",k.push(new Uint32Array(this.buffer,c,3)[K])):C===\"vec4u\"&&(B=\"u\",k.push(new Uint32Array(this.buffer,c,4)[K]))}return k.length===2?d=e.getTypeInfo(`vec2${B}`):k.length===3?d=e.getTypeInfo(`vec3${B}`):k.length===4?d=e.getTypeInfo(`vec4${B}`):console.error(`GetDataValue: Invalid vector length ${k.length}`),new Ue(k,d,null)}return console.error(`GetDataValue: Unknown member ${b}`),null}return console.error(`GetDataValue: Type ${C} is not a struct`),null}}}n=n.postfix}let m=d.getTypeName();return m===\"f32\"?new st(new Float32Array(this.buffer,c,1),d,this):m===\"i32\"?new st(new Int32Array(this.buffer,c,1),d,this):m===\"u32\"?new st(new Uint32Array(this.buffer,c,1),d,this):m===\"vec2f\"?new Ue(new Float32Array(this.buffer,c,2),d,this):m===\"vec3f\"?new Ue(new Float32Array(this.buffer,c,3),d,this):m===\"vec4f\"?new Ue(new Float32Array(this.buffer,c,4),d,this):m===\"vec2i\"?new Ue(new Int32Array(this.buffer,c,2),d,this):m===\"vec3i\"?new Ue(new Int32Array(this.buffer,c,3),d,this):m===\"vec4i\"?new Ue(new Int32Array(this.buffer,c,4),d,this):m===\"vec2u\"?new Ue(new Uint32Array(this.buffer,c,2),d,this):m===\"vec3u\"?new Ue(new Uint32Array(this.buffer,c,3),d,this):m===\"vec4u\"?new Ue(new Uint32Array(this.buffer,c,4),d,this):d instanceof Cp&&d.name===\"atomic\"?((i=d.format)===null||i===void 0?void 0:i.name)===\"u32\"?new st(new Uint32Array(this.buffer,c,1)[0],d.format,this):((o=d.format)===null||o===void 0?void 0:o.name)===\"i32\"?new st(new Int32Array(this.buffer,c,1)[0],d.format,this):(console.error(`GetDataValue: Invalid atomic format ${(s=d.format)===null||s===void 0?void 0:s.name}`),null):new t(this.buffer,d,c,this)}toString(){let e=\"\";if(this.typeInfo instanceof Qf)if(this.typeInfo.format.name===\"f32\"){let n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}`;for(let r=1;r<n.length;++r)e+=`, ${n[r]}`}else if(this.typeInfo.format.name===\"i32\"){let n=new Int32Array(this.buffer,this.offset);e=`[${n[0]}`;for(let r=1;r<n.length;++r)e+=`, ${n[r]}`}else if(this.typeInfo.format.name===\"u32\"){let n=new Uint32Array(this.buffer,this.offset);e=`[${n[0]}`;for(let r=1;r<n.length;++r)e+=`, ${n[r]}`}else if(this.typeInfo.format.name===\"vec2f\"){let n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}, ${n[1]}]`;for(let r=1;r<n.length/2;++r)e+=`, [${n[2*r]}, ${n[2*r+1]}]`}else if(this.typeInfo.format.name===\"vec3f\"){let n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}, ${n[1]}, ${n[2]}]`;for(let r=4;r<n.length;r+=4)e+=`, [${n[r]}, ${n[r+1]}, ${n[r+2]}]`}else if(this.typeInfo.format.name===\"vec4f\"){let n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}, ${n[1]}, ${n[2]}, ${n[3]}]`;for(let r=4;r<n.length;r+=4)e+=`, [${n[r]}, ${n[r+1]}, ${n[r+2]}, ${n[r+3]}]`}else e=\"[...]\";else this.typeInfo instanceof qf?e+=\"{...}\":e=\"[...]\";return e}},Sp=class t extends Yu{constructor(e,n,r,i){super(n,null),this.data=e,this.descriptor=r,this.view=i}clone(){return new t(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,n;let r=this.descriptor.size;return r instanceof Array&&r.length>0?(e=r[0])!==null&&e!==void 0?e:0:r instanceof Object&&(n=r.width)!==null&&n!==void 0?n:0}get height(){var e,n;let r=this.descriptor.size;return r instanceof Array&&r.length>1?(e=r[1])!==null&&e!==void 0?e:0:r instanceof Object&&(n=r.height)!==null&&n!==void 0?n:0}get depthOrArrayLayers(){var e,n;let r=this.descriptor.size;return r instanceof Array&&r.length>2?(e=r[2])!==null&&e!==void 0?e:0:r instanceof Object&&(n=r.depthOrArrayLayers)!==null&&n!==void 0?n:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:\"rgba8unorm\"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:\"2d\"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];let n=[this.width,this.height,this.depthOrArrayLayers];for(let r=0;r<n.length;++r)n[r]=Math.max(1,n[r]>>e);return n}get texelByteSize(){let e=this.format,n=KO[e];return n?n.isDepthStencil?4:n.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){let e=this.format,n=KO[e];return!!n&&n.isDepthStencil}getGpuSize(){let e=this.format,n=KO[e],r=this.width;if(!e||r<=0||!n)return-1;let i=this.height,o=this.depthOrArrayLayers,s=this.dimension;return r/n.blockWidth*(s===\"1d\"?1:i/n.blockHeight)*n.bytesPerBlock*o}getPixel(e,n,r=0,i=0){let o=this.texelByteSize,s=this.bytesPerRow,c=this.height,d=this.data[i];return w_e(new Uint8Array(d),e,n,r,i,c,s,o,this.format)}setPixel(e,n,r,i,o){let s=this.texelByteSize,c=this.bytesPerRow,d=this.height,m=this.data[i];(function(b,C,B,k,V,q,K,Y,ee,J){let se=k*(K>>=V)*(q>>=V)+B*K+C*Y;switch(ee){case\"r8unorm\":return void Bi(b,se,\"8unorm\",1,J);case\"r8snorm\":return void Bi(b,se,\"8snorm\",1,J);case\"r8uint\":return void Bi(b,se,\"8uint\",1,J);case\"r8sint\":return void Bi(b,se,\"8sint\",1,J);case\"rg8unorm\":return void Bi(b,se,\"8unorm\",2,J);case\"rg8snorm\":return void Bi(b,se,\"8snorm\",2,J);case\"rg8uint\":return void Bi(b,se,\"8uint\",2,J);case\"rg8sint\":return void Bi(b,se,\"8sint\",2,J);case\"rgba8unorm-srgb\":case\"rgba8unorm\":case\"bgra8unorm-srgb\":case\"bgra8unorm\":return void Bi(b,se,\"8unorm\",4,J);case\"rgba8snorm\":return void Bi(b,se,\"8snorm\",4,J);case\"rgba8uint\":return void Bi(b,se,\"8uint\",4,J);case\"rgba8sint\":return void Bi(b,se,\"8sint\",4,J);case\"r16uint\":return void Bi(b,se,\"16uint\",1,J);case\"r16sint\":return void Bi(b,se,\"16sint\",1,J);case\"r16float\":return void Bi(b,se,\"16float\",1,J);case\"rg16uint\":return void Bi(b,se,\"16uint\",2,J);case\"rg16sint\":return void Bi(b,se,\"16sint\",2,J);case\"rg16float\":return void Bi(b,se,\"16float\",2,J);case\"rgba16uint\":return void Bi(b,se,\"16uint\",4,J);case\"rgba16sint\":return void Bi(b,se,\"16sint\",4,J);case\"rgba16float\":return void Bi(b,se,\"16float\",4,J);case\"r32uint\":return void Bi(b,se,\"32uint\",1,J);case\"r32sint\":return void Bi(b,se,\"32sint\",1,J);case\"depth16unorm\":case\"depth24plus\":case\"depth24plus-stencil8\":case\"depth32float\":case\"depth32float-stencil8\":case\"r32float\":return void Bi(b,se,\"32float\",1,J);case\"rg32uint\":return void Bi(b,se,\"32uint\",2,J);case\"rg32sint\":return void Bi(b,se,\"32sint\",2,J);case\"rg32float\":return void Bi(b,se,\"32float\",2,J);case\"rgba32uint\":return void Bi(b,se,\"32uint\",4,J);case\"rgba32sint\":return void Bi(b,se,\"32sint\",4,J);case\"rgba32float\":return void Bi(b,se,\"32float\",4,J);case\"rg11b10ufloat\":console.error(\"TODO: rg11b10ufloat not supported for writing\")}})(new Uint8Array(m),e,n,r,i,d,c,s,this.format,o)}};(t=>{t[t.token=0]=\"token\",t[t.keyword=1]=\"keyword\",t[t.reserved=2]=\"reserved\"})(it||(it={}));var rt=class{constructor(e,n,r){this.name=e,this.type=n,this.rule=r}toString(){return this.name}},Re=class{};gt=Re,Re.none=new rt(\"\",it.reserved,\"\"),Re.eof=new rt(\"EOF\",it.token,\"\"),Re.reserved={asm:new rt(\"asm\",it.reserved,\"asm\"),bf16:new rt(\"bf16\",it.reserved,\"bf16\"),do:new rt(\"do\",it.reserved,\"do\"),enum:new rt(\"enum\",it.reserved,\"enum\"),f16:new rt(\"f16\",it.reserved,\"f16\"),f64:new rt(\"f64\",it.reserved,\"f64\"),handle:new rt(\"handle\",it.reserved,\"handle\"),i8:new rt(\"i8\",it.reserved,\"i8\"),i16:new rt(\"i16\",it.reserved,\"i16\"),i64:new rt(\"i64\",it.reserved,\"i64\"),mat:new rt(\"mat\",it.reserved,\"mat\"),premerge:new rt(\"premerge\",it.reserved,\"premerge\"),regardless:new rt(\"regardless\",it.reserved,\"regardless\"),typedef:new rt(\"typedef\",it.reserved,\"typedef\"),u8:new rt(\"u8\",it.reserved,\"u8\"),u16:new rt(\"u16\",it.reserved,\"u16\"),u64:new rt(\"u64\",it.reserved,\"u64\"),unless:new rt(\"unless\",it.reserved,\"unless\"),using:new rt(\"using\",it.reserved,\"using\"),vec:new rt(\"vec\",it.reserved,\"vec\"),void:new rt(\"void\",it.reserved,\"void\")},Re.keywords={array:new rt(\"array\",it.keyword,\"array\"),atomic:new rt(\"atomic\",it.keyword,\"atomic\"),bool:new rt(\"bool\",it.keyword,\"bool\"),f32:new rt(\"f32\",it.keyword,\"f32\"),i32:new rt(\"i32\",it.keyword,\"i32\"),mat2x2:new rt(\"mat2x2\",it.keyword,\"mat2x2\"),mat2x3:new rt(\"mat2x3\",it.keyword,\"mat2x3\"),mat2x4:new rt(\"mat2x4\",it.keyword,\"mat2x4\"),mat3x2:new rt(\"mat3x2\",it.keyword,\"mat3x2\"),mat3x3:new rt(\"mat3x3\",it.keyword,\"mat3x3\"),mat3x4:new rt(\"mat3x4\",it.keyword,\"mat3x4\"),mat4x2:new rt(\"mat4x2\",it.keyword,\"mat4x2\"),mat4x3:new rt(\"mat4x3\",it.keyword,\"mat4x3\"),mat4x4:new rt(\"mat4x4\",it.keyword,\"mat4x4\"),ptr:new rt(\"ptr\",it.keyword,\"ptr\"),sampler:new rt(\"sampler\",it.keyword,\"sampler\"),sampler_comparison:new rt(\"sampler_comparison\",it.keyword,\"sampler_comparison\"),struct:new rt(\"struct\",it.keyword,\"struct\"),texture_1d:new rt(\"texture_1d\",it.keyword,\"texture_1d\"),texture_2d:new rt(\"texture_2d\",it.keyword,\"texture_2d\"),texture_2d_array:new rt(\"texture_2d_array\",it.keyword,\"texture_2d_array\"),texture_3d:new rt(\"texture_3d\",it.keyword,\"texture_3d\"),texture_cube:new rt(\"texture_cube\",it.keyword,\"texture_cube\"),texture_cube_array:new rt(\"texture_cube_array\",it.keyword,\"texture_cube_array\"),texture_multisampled_2d:new rt(\"texture_multisampled_2d\",it.keyword,\"texture_multisampled_2d\"),texture_storage_1d:new rt(\"texture_storage_1d\",it.keyword,\"texture_storage_1d\"),texture_storage_2d:new rt(\"texture_storage_2d\",it.keyword,\"texture_storage_2d\"),texture_storage_2d_array:new rt(\"texture_storage_2d_array\",it.keyword,\"texture_storage_2d_array\"),texture_storage_3d:new rt(\"texture_storage_3d\",it.keyword,\"texture_storage_3d\"),texture_depth_2d:new rt(\"texture_depth_2d\",it.keyword,\"texture_depth_2d\"),texture_depth_2d_array:new rt(\"texture_depth_2d_array\",it.keyword,\"texture_depth_2d_array\"),texture_depth_cube:new rt(\"texture_depth_cube\",it.keyword,\"texture_depth_cube\"),texture_depth_cube_array:new rt(\"texture_depth_cube_array\",it.keyword,\"texture_depth_cube_array\"),texture_depth_multisampled_2d:new rt(\"texture_depth_multisampled_2d\",it.keyword,\"texture_depth_multisampled_2d\"),texture_external:new rt(\"texture_external\",it.keyword,\"texture_external\"),u32:new rt(\"u32\",it.keyword,\"u32\"),vec2:new rt(\"vec2\",it.keyword,\"vec2\"),vec3:new rt(\"vec3\",it.keyword,\"vec3\"),vec4:new rt(\"vec4\",it.keyword,\"vec4\"),bitcast:new rt(\"bitcast\",it.keyword,\"bitcast\"),block:new rt(\"block\",it.keyword,\"block\"),break:new rt(\"break\",it.keyword,\"break\"),case:new rt(\"case\",it.keyword,\"case\"),continue:new rt(\"continue\",it.keyword,\"continue\"),continuing:new rt(\"continuing\",it.keyword,\"continuing\"),default:new rt(\"default\",it.keyword,\"default\"),diagnostic:new rt(\"diagnostic\",it.keyword,\"diagnostic\"),discard:new rt(\"discard\",it.keyword,\"discard\"),else:new rt(\"else\",it.keyword,\"else\"),enable:new rt(\"enable\",it.keyword,\"enable\"),fallthrough:new rt(\"fallthrough\",it.keyword,\"fallthrough\"),false:new rt(\"false\",it.keyword,\"false\"),fn:new rt(\"fn\",it.keyword,\"fn\"),for:new rt(\"for\",it.keyword,\"for\"),function:new rt(\"function\",it.keyword,\"function\"),if:new rt(\"if\",it.keyword,\"if\"),let:new rt(\"let\",it.keyword,\"let\"),const:new rt(\"const\",it.keyword,\"const\"),loop:new rt(\"loop\",it.keyword,\"loop\"),while:new rt(\"while\",it.keyword,\"while\"),private:new rt(\"private\",it.keyword,\"private\"),read:new rt(\"read\",it.keyword,\"read\"),read_write:new rt(\"read_write\",it.keyword,\"read_write\"),return:new rt(\"return\",it.keyword,\"return\"),requires:new rt(\"requires\",it.keyword,\"requires\"),storage:new rt(\"storage\",it.keyword,\"storage\"),switch:new rt(\"switch\",it.keyword,\"switch\"),true:new rt(\"true\",it.keyword,\"true\"),alias:new rt(\"alias\",it.keyword,\"alias\"),type:new rt(\"type\",it.keyword,\"type\"),uniform:new rt(\"uniform\",it.keyword,\"uniform\"),var:new rt(\"var\",it.keyword,\"var\"),override:new rt(\"override\",it.keyword,\"override\"),workgroup:new rt(\"workgroup\",it.keyword,\"workgroup\"),write:new rt(\"write\",it.keyword,\"write\"),r8unorm:new rt(\"r8unorm\",it.keyword,\"r8unorm\"),r8snorm:new rt(\"r8snorm\",it.keyword,\"r8snorm\"),r8uint:new rt(\"r8uint\",it.keyword,\"r8uint\"),r8sint:new rt(\"r8sint\",it.keyword,\"r8sint\"),r16uint:new rt(\"r16uint\",it.keyword,\"r16uint\"),r16sint:new rt(\"r16sint\",it.keyword,\"r16sint\"),r16float:new rt(\"r16float\",it.keyword,\"r16float\"),rg8unorm:new rt(\"rg8unorm\",it.keyword,\"rg8unorm\"),rg8snorm:new rt(\"rg8snorm\",it.keyword,\"rg8snorm\"),rg8uint:new rt(\"rg8uint\",it.keyword,\"rg8uint\"),rg8sint:new rt(\"rg8sint\",it.keyword,\"rg8sint\"),r32uint:new rt(\"r32uint\",it.keyword,\"r32uint\"),r32sint:new rt(\"r32sint\",it.keyword,\"r32sint\"),r32float:new rt(\"r32float\",it.keyword,\"r32float\"),rg16uint:new rt(\"rg16uint\",it.keyword,\"rg16uint\"),rg16sint:new rt(\"rg16sint\",it.keyword,\"rg16sint\"),rg16float:new rt(\"rg16float\",it.keyword,\"rg16float\"),rgba8unorm:new rt(\"rgba8unorm\",it.keyword,\"rgba8unorm\"),rgba8unorm_srgb:new rt(\"rgba8unorm_srgb\",it.keyword,\"rgba8unorm_srgb\"),rgba8snorm:new rt(\"rgba8snorm\",it.keyword,\"rgba8snorm\"),rgba8uint:new rt(\"rgba8uint\",it.keyword,\"rgba8uint\"),rgba8sint:new rt(\"rgba8sint\",it.keyword,\"rgba8sint\"),bgra8unorm:new rt(\"bgra8unorm\",it.keyword,\"bgra8unorm\"),bgra8unorm_srgb:new rt(\"bgra8unorm_srgb\",it.keyword,\"bgra8unorm_srgb\"),rgb10a2unorm:new rt(\"rgb10a2unorm\",it.keyword,\"rgb10a2unorm\"),rg11b10float:new rt(\"rg11b10float\",it.keyword,\"rg11b10float\"),rg32uint:new rt(\"rg32uint\",it.keyword,\"rg32uint\"),rg32sint:new rt(\"rg32sint\",it.keyword,\"rg32sint\"),rg32float:new rt(\"rg32float\",it.keyword,\"rg32float\"),rgba16uint:new rt(\"rgba16uint\",it.keyword,\"rgba16uint\"),rgba16sint:new rt(\"rgba16sint\",it.keyword,\"rgba16sint\"),rgba16float:new rt(\"rgba16float\",it.keyword,\"rgba16float\"),rgba32uint:new rt(\"rgba32uint\",it.keyword,\"rgba32uint\"),rgba32sint:new rt(\"rgba32sint\",it.keyword,\"rgba32sint\"),rgba32float:new rt(\"rgba32float\",it.keyword,\"rgba32float\"),static_assert:new rt(\"static_assert\",it.keyword,\"static_assert\")},Re.tokens={decimal_float_literal:new rt(\"decimal_float_literal\",it.token,/((-?[0-9]*\\.[0-9]+|-?[0-9]+\\.[0-9]*)((e|E)(\\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new rt(\"hex_float_literal\",it.token,/-?0x((([0-9a-fA-F]*\\.[0-9a-fA-F]+|[0-9a-fA-F]+\\.[0-9a-fA-F]*)((p|P)(\\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\\+|-)?[0-9]+[fh]?))/),int_literal:new rt(\"int_literal\",it.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new rt(\"uint_literal\",it.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new rt(\"name\",it.token,/([_\\p{XID_Start}][\\p{XID_Continue}]+)|([\\p{XID_Start}])/u),ident:new rt(\"ident\",it.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new rt(\"and\",it.token,\"&\"),and_and:new rt(\"and_and\",it.token,\"&&\"),arrow:new rt(\"arrow \",it.token,\"->\"),attr:new rt(\"attr\",it.token,\"@\"),forward_slash:new rt(\"forward_slash\",it.token,\"/\"),bang:new rt(\"bang\",it.token,\"!\"),bracket_left:new rt(\"bracket_left\",it.token,\"[\"),bracket_right:new rt(\"bracket_right\",it.token,\"]\"),brace_left:new rt(\"brace_left\",it.token,\"{\"),brace_right:new rt(\"brace_right\",it.token,\"}\"),colon:new rt(\"colon\",it.token,\":\"),comma:new rt(\"comma\",it.token,\",\"),equal:new rt(\"equal\",it.token,\"=\"),equal_equal:new rt(\"equal_equal\",it.token,\"==\"),not_equal:new rt(\"not_equal\",it.token,\"!=\"),greater_than:new rt(\"greater_than\",it.token,\">\"),greater_than_equal:new rt(\"greater_than_equal\",it.token,\">=\"),shift_right:new rt(\"shift_right\",it.token,\">>\"),less_than:new rt(\"less_than\",it.token,\"<\"),less_than_equal:new rt(\"less_than_equal\",it.token,\"<=\"),shift_left:new rt(\"shift_left\",it.token,\"<<\"),modulo:new rt(\"modulo\",it.token,\"%\"),minus:new rt(\"minus\",it.token,\"-\"),minus_minus:new rt(\"minus_minus\",it.token,\"--\"),period:new rt(\"period\",it.token,\".\"),plus:new rt(\"plus\",it.token,\"+\"),plus_plus:new rt(\"plus_plus\",it.token,\"++\"),or:new rt(\"or\",it.token,\"|\"),or_or:new rt(\"or_or\",it.token,\"||\"),paren_left:new rt(\"paren_left\",it.token,\"(\"),paren_right:new rt(\"paren_right\",it.token,\")\"),semicolon:new rt(\"semicolon\",it.token,\";\"),star:new rt(\"star\",it.token,\"*\"),tilde:new rt(\"tilde\",it.token,\"~\"),underscore:new rt(\"underscore\",it.token,\"_\"),xor:new rt(\"xor\",it.token,\"^\"),plus_equal:new rt(\"plus_equal\",it.token,\"+=\"),minus_equal:new rt(\"minus_equal\",it.token,\"-=\"),times_equal:new rt(\"times_equal\",it.token,\"*=\"),division_equal:new rt(\"division_equal\",it.token,\"/=\"),modulo_equal:new rt(\"modulo_equal\",it.token,\"%=\"),and_equal:new rt(\"and_equal\",it.token,\"&=\"),or_equal:new rt(\"or_equal\",it.token,\"|=\"),xor_equal:new rt(\"xor_equal\",it.token,\"^=\"),shift_right_equal:new rt(\"shift_right_equal\",it.token,\">>=\"),shift_left_equal:new rt(\"shift_left_equal\",it.token,\"<<=\")},Re.simpleTokens={\"@\":gt.tokens.attr,\"{\":gt.tokens.brace_left,\"}\":gt.tokens.brace_right,\":\":gt.tokens.colon,\",\":gt.tokens.comma,\"(\":gt.tokens.paren_left,\")\":gt.tokens.paren_right,\";\":gt.tokens.semicolon},Re.literalTokens={\"&\":gt.tokens.and,\"&&\":gt.tokens.and_and,\"->\":gt.tokens.arrow,\"/\":gt.tokens.forward_slash,\"!\":gt.tokens.bang,\"[\":gt.tokens.bracket_left,\"]\":gt.tokens.bracket_right,\"=\":gt.tokens.equal,\"==\":gt.tokens.equal_equal,\"!=\":gt.tokens.not_equal,\">\":gt.tokens.greater_than,\">=\":gt.tokens.greater_than_equal,\">>\":gt.tokens.shift_right,\"<\":gt.tokens.less_than,\"<=\":gt.tokens.less_than_equal,\"<<\":gt.tokens.shift_left,\"%\":gt.tokens.modulo,\"-\":gt.tokens.minus,\"--\":gt.tokens.minus_minus,\".\":gt.tokens.period,\"+\":gt.tokens.plus,\"++\":gt.tokens.plus_plus,\"|\":gt.tokens.or,\"||\":gt.tokens.or_or,\"*\":gt.tokens.star,\"~\":gt.tokens.tilde,_:gt.tokens.underscore,\"^\":gt.tokens.xor,\"+=\":gt.tokens.plus_equal,\"-=\":gt.tokens.minus_equal,\"*=\":gt.tokens.times_equal,\"/=\":gt.tokens.division_equal,\"%=\":gt.tokens.modulo_equal,\"&=\":gt.tokens.and_equal,\"|=\":gt.tokens.or_equal,\"^=\":gt.tokens.xor_equal,\">>=\":gt.tokens.shift_right_equal,\"<<=\":gt.tokens.shift_left_equal},Re.regexTokens={decimal_float_literal:gt.tokens.decimal_float_literal,hex_float_literal:gt.tokens.hex_float_literal,int_literal:gt.tokens.int_literal,uint_literal:gt.tokens.uint_literal,ident:gt.tokens.ident},Re.storage_class=[gt.keywords.function,gt.keywords.private,gt.keywords.workgroup,gt.keywords.uniform,gt.keywords.storage],Re.access_mode=[gt.keywords.read,gt.keywords.write,gt.keywords.read_write],Re.sampler_type=[gt.keywords.sampler,gt.keywords.sampler_comparison],Re.sampled_texture_type=[gt.keywords.texture_1d,gt.keywords.texture_2d,gt.keywords.texture_2d_array,gt.keywords.texture_3d,gt.keywords.texture_cube,gt.keywords.texture_cube_array],Re.multisampled_texture_type=[gt.keywords.texture_multisampled_2d],Re.storage_texture_type=[gt.keywords.texture_storage_1d,gt.keywords.texture_storage_2d,gt.keywords.texture_storage_2d_array,gt.keywords.texture_storage_3d],Re.depth_texture_type=[gt.keywords.texture_depth_2d,gt.keywords.texture_depth_2d_array,gt.keywords.texture_depth_cube,gt.keywords.texture_depth_cube_array,gt.keywords.texture_depth_multisampled_2d],Re.texture_external_type=[gt.keywords.texture_external],Re.any_texture_type=[...gt.sampled_texture_type,...gt.multisampled_texture_type,...gt.storage_texture_type,...gt.depth_texture_type,...gt.texture_external_type],Re.texel_format=[gt.keywords.r8unorm,gt.keywords.r8snorm,gt.keywords.r8uint,gt.keywords.r8sint,gt.keywords.r16uint,gt.keywords.r16sint,gt.keywords.r16float,gt.keywords.rg8unorm,gt.keywords.rg8snorm,gt.keywords.rg8uint,gt.keywords.rg8sint,gt.keywords.r32uint,gt.keywords.r32sint,gt.keywords.r32float,gt.keywords.rg16uint,gt.keywords.rg16sint,gt.keywords.rg16float,gt.keywords.rgba8unorm,gt.keywords.rgba8unorm_srgb,gt.keywords.rgba8snorm,gt.keywords.rgba8uint,gt.keywords.rgba8sint,gt.keywords.bgra8unorm,gt.keywords.bgra8unorm_srgb,gt.keywords.rgb10a2unorm,gt.keywords.rg11b10float,gt.keywords.rg32uint,gt.keywords.rg32sint,gt.keywords.rg32float,gt.keywords.rgba16uint,gt.keywords.rgba16sint,gt.keywords.rgba16float,gt.keywords.rgba32uint,gt.keywords.rgba32sint,gt.keywords.rgba32float],Re.const_literal=[gt.tokens.int_literal,gt.tokens.uint_literal,gt.tokens.decimal_float_literal,gt.tokens.hex_float_literal,gt.keywords.true,gt.keywords.false],Re.literal_or_ident=[gt.tokens.ident,gt.tokens.int_literal,gt.tokens.uint_literal,gt.tokens.decimal_float_literal,gt.tokens.hex_float_literal,gt.tokens.name],Re.element_count_expression=[gt.tokens.int_literal,gt.tokens.uint_literal,gt.tokens.ident],Re.template_types=[gt.keywords.vec2,gt.keywords.vec3,gt.keywords.vec4,gt.keywords.mat2x2,gt.keywords.mat2x3,gt.keywords.mat2x4,gt.keywords.mat3x2,gt.keywords.mat3x3,gt.keywords.mat3x4,gt.keywords.mat4x2,gt.keywords.mat4x3,gt.keywords.mat4x4,gt.keywords.atomic,gt.keywords.bitcast,...gt.any_texture_type],Re.attribute_name=[gt.tokens.ident,gt.keywords.block,gt.keywords.diagnostic],Re.assignment_operators=[gt.tokens.equal,gt.tokens.plus_equal,gt.tokens.minus_equal,gt.tokens.times_equal,gt.tokens.division_equal,gt.tokens.modulo_equal,gt.tokens.and_equal,gt.tokens.or_equal,gt.tokens.xor_equal,gt.tokens.shift_right_equal,gt.tokens.shift_left_equal],Re.increment_operators=[gt.tokens.plus_plus,gt.tokens.minus_minus];var dM=class{constructor(e,n,r,i,o){this.type=e,this.lexeme=n,this.line=r,this.start=i,this.end=o}toString(){return this.lexeme}isTemplateType(){return Re.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==Re.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}},u8=class{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??\"\"}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new dM(Re.eof,\"\",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`\n`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e==\"/\"){if(this._peekAhead()==\"/\"){for(;e!=`\n`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()==\"*\"){this._advance();let s=1;for(;s>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`\n`)this._line++;else if(e==\"*\"){if(this._peekAhead()==\"/\"&&(this._advance(),s--,s==0))return!0}else e==\"/\"&&this._peekAhead()==\"*\"&&(this._advance(),s++)}return!0}}let n=Re.simpleTokens[e];if(n)return this._addToken(n),!0;let r=Re.none,i=this._isAlpha(e),o=e===\"_\";if(this._isAlphaNumeric(e)){let s=this._peekAhead();for(;this._isAlphaNumeric(s);)e+=this._advance(),s=this._peekAhead()}if(i){let s=Re.keywords[e];if(s)return this._addToken(s),!0}if(i||o)return this._addToken(Re.tokens.ident),!0;for(;;){let s=this._findType(e),c=this._peekAhead();if(e==\"-\"&&this._tokens.length>0){if(c==\"=\")return this._current++,e+=c,this._addToken(Re.tokens.minus_equal),!0;if(c==\"-\")return this._current++,e+=c,this._addToken(Re.tokens.minus_minus),!0;let d=this._tokens.length-1;if((Re.literal_or_ident.indexOf(this._tokens[d].type)!=-1||this._tokens[d].type==Re.tokens.paren_right)&&c!=\">\")return this._addToken(s),!0}if(e==\">\"&&(c==\">\"||c==\"=\")){let d=!1,m=this._tokens.length-1;for(let b=0;b<5&&m>=0&&Re.assignment_operators.indexOf(this._tokens[m].type)===-1;++b,--m)if(this._tokens[m].type===Re.tokens.less_than){m>0&&this._tokens[m-1].isArrayOrTemplateType()&&(d=!0);break}if(d)return this._addToken(s),!0}if(s===Re.none){let d=e,m=0,b=2;for(let C=0;C<b;++C)if(d+=this._peekAhead(C),s=this._findType(d),s!==Re.none){m=C;break}if(s===Re.none)return r!==Re.none&&(this._current--,this._addToken(r),!0);e=d,this._current+=m+1}if(r=s,this._isAtEnd())break;e+=this._advance()}return r!==Re.none&&(this._addToken(r),!0)}_findType(e){for(let r in Re.regexTokens){let i=Re.regexTokens[r];if(this._match(e,i.rule))return i}return Re.literalTokens[e]||Re.none}_match(e,n){let r=n.exec(e);return r&&r.index==0&&r[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!==\"_\"&&e!==\".\"&&e!==\"(\"&&e!==\")\"&&e!==\"[\"&&e!==\"]\"&&e!==\"{\"&&e!==\"}\"&&e!==\",\"&&e!==\";\"&&e!==\":\"&&e!==\"=\"&&e!==\"!\"&&e!==\"<\"&&e!==\">\"&&e!==\"+\"&&e!==\"-\"&&e!==\"*\"&&e!==\"/\"&&e!==\"%\"&&e!==\"&\"&&e!==\"|\"&&e!==\"^\"&&e!==\"~\"&&e!==\"@\"&&e!==\"#\"&&e!==\"?\"&&e!==\"'\"&&e!==\"`\"&&e!=='\"'&&e!==\"\\\\\"&&e!==`\n`&&e!==\"\\r\"&&e!==\"\t\"&&e!==\"\\0\"}_isNumeric(e){return e>=\"0\"&&e<=\"9\"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e===\"_\"}_isWhitespace(e){return e==\" \"||e==\"\t\"||e==\"\\r\"}_advance(e=0){let n=this._source[this._current];return e=e||0,e++,this._current+=e,n}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?\"\\0\":this._source[this._current+e]}_addToken(e){let n=this._source.substring(this._start,this._current);this._tokens.push(new dM(e,n,this._line,this._start,this._current))}};function mn(t){return Array.isArray(t)||t?.buffer instanceof ArrayBuffer}var pM=new Float32Array(1),E_e=new Uint32Array(pM.buffer),S_e=new Uint32Array(pM.buffer),AM=new Int32Array(1),C_e=new Float32Array(AM.buffer),M_e=new Uint32Array(AM.buffer),gM=new Uint32Array(1),I_e=new Float32Array(gM.buffer),P_e=new Int32Array(gM.buffer);function vq(t,e,n){if(e===n)return t;if(e===\"f32\"){if(n===\"i32\"||n===\"x32\")return pM[0]=t,E_e[0];if(n===\"u32\")return pM[0]=t,S_e[0]}else if(e===\"i32\"||e===\"x32\"){if(n===\"f32\")return AM[0]=t,C_e[0];if(n===\"u32\")return AM[0]=t,M_e[0]}else if(e===\"u32\"){if(n===\"f32\")return gM[0]=t,I_e[0];if(n===\"i32\"||n===\"x32\")return gM[0]=t,P_e[0]}return console.error(`Unsupported cast from ${e} to ${n}`),t}var h8=class{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}},wy=class{constructor(e,n){this.align=e,this.size=n}},Fm=class t{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new i8,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name==\"texture_storage_1d\"||e.name==\"texture_storage_2d\"||e.name==\"texture_storage_2d_array\"||e.name==\"texture_storage_3d\"}updateAST(e){for(let n of e)n instanceof km&&this._functions.set(n.name,new h8(n));for(let n of e)if(n instanceof Yh){let r=this.getTypeInfo(n,null);r instanceof qf&&this.structs.push(r)}for(let n of e)if(n instanceof Fb)this.aliases.push(this._getAliasInfo(n));else{if(n instanceof Lb){let r=n,i=this._getAttributeNum(r.attributes,\"id\",0),o=r.type!=null?this.getTypeInfo(r.type,r.attributes):null;this.overrides.push(new t8(r.name,o,r.attributes,i));continue}if(this._isUniformVar(n)){let r=n,i=this._getAttributeNum(r.attributes,\"group\",0),o=this._getAttributeNum(r.attributes,\"binding\",0),s=this.getTypeInfo(r.type,r.attributes),c=new vy(r.name,s,i,o,r.attributes,TA.Uniform,r.access);c.access||(c.access=\"read\"),this.uniforms.push(c);continue}if(this._isStorageVar(n)){let r=n,i=this._getAttributeNum(r.attributes,\"group\",0),o=this._getAttributeNum(r.attributes,\"binding\",0),s=this.getTypeInfo(r.type,r.attributes),c=this._isStorageTexture(s),d=new vy(r.name,s,i,o,r.attributes,c?TA.StorageTexture:TA.Storage,r.access);d.access||(d.access=\"read\"),this.storage.push(d);continue}if(this._isTextureVar(n)){let r=n,i=this._getAttributeNum(r.attributes,\"group\",0),o=this._getAttributeNum(r.attributes,\"binding\",0),s=this.getTypeInfo(r.type,r.attributes),c=this._isStorageTexture(s),d=new vy(r.name,s,i,o,r.attributes,c?TA.StorageTexture:TA.Texture,r.access);d.access||(d.access=\"read\"),c?this.storage.push(d):this.textures.push(d);continue}if(this._isSamplerVar(n)){let r=n,i=this._getAttributeNum(r.attributes,\"group\",0),o=this._getAttributeNum(r.attributes,\"binding\",0),s=this.getTypeInfo(r.type,r.attributes),c=new vy(r.name,s,i,o,r.attributes,TA.Sampler,r.access);this.samplers.push(c);continue}}for(let n of e)if(n instanceof km){let r=this._getAttribute(n,\"vertex\"),i=this._getAttribute(n,\"fragment\"),o=this._getAttribute(n,\"compute\"),s=r||i||o,c=new r8(n.name,s?.name,n.attributes);c.attributes=n.attributes,c.startLine=n.startLine,c.endLine=n.endLine,this.functions.push(c),this._functions.get(n.name).info=c,s&&(this._functions.get(n.name).inUse=!0,c.inUse=!0,c.resources=this._findResources(n,!!s),c.inputs=this._getInputs(n.args),c.outputs=this._getOutputs(n.returnType),this.entry[s.name].push(c)),c.arguments=n.args.map(d=>new n8(d.name,this.getTypeInfo(d.type,d.attributes),d.attributes)),c.returnType=n.returnType?this.getTypeInfo(n.returnType,n.attributes):null;continue}for(let n of this._functions.values())n.info&&(n.info.inUse=n.inUse,this._addCalls(n.node,n.info.calls));for(let n of this._functions.values())n.node.search(r=>{var i,o,s;if(r instanceof fM){if(r.value)if(mn(r.value))for(let c of r.value)for(let d of this.overrides)c===d.name&&((i=n.info)===null||i===void 0||i.overrides.push(d));else for(let c of this.overrides)r.value===c.name&&((o=n.info)===null||o===void 0||o.overrides.push(c))}else if(r instanceof Kl)for(let c of this.overrides)r.name===c.name&&((s=n.info)===null||s===void 0||s.overrides.push(c))});for(let n of this.uniforms)this._markStructsInUse(n.type);for(let n of this.storage)this._markStructsInUse(n.type)}getFunctionInfo(e){for(let n of this.functions)if(n.name==e)return n;return null}getStructInfo(e){for(let n of this.structs)if(n.name==e)return n;return null}getOverrideInfo(e){for(let n of this.overrides)if(n.name==e)return n;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(let n of e.members)this._markStructsInUse(n.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{let n=this._getAlias(e.name);n&&this._markStructsInUse(n)}}_addCalls(e,n){var r;for(let i of e.calls){let o=(r=this._functions.get(i.name))===null||r===void 0?void 0:r.info;o&&n.add(o)}}findResource(e,n,r){if(r){for(let i of this.entry.compute)if(i.name===r){for(let o of i.resources)if(o.group==e&&o.binding==n)return o}for(let i of this.entry.vertex)if(i.name===r){for(let o of i.resources)if(o.group==e&&o.binding==n)return o}for(let i of this.entry.fragment)if(i.name===r){for(let o of i.resources)if(o.group==e&&o.binding==n)return o}}for(let i of this.uniforms)if(i.group==e&&i.binding==n)return i;for(let i of this.storage)if(i.group==e&&i.binding==n)return i;for(let i of this.textures)if(i.group==e&&i.binding==n)return i;for(let i of this.samplers)if(i.group==e&&i.binding==n)return i;return null}_findResource(e){for(let n of this.uniforms)if(n.name==e)return n;for(let n of this.storage)if(n.name==e)return n;for(let n of this.textures)if(n.name==e)return n;for(let n of this.samplers)if(n.name==e)return n;return null}_markStructsFromAST(e){let n=this.getTypeInfo(e,null);this._markStructsInUse(n)}_findResources(e,n){let r=[],i=this,o=[];return e.search(s=>{if(s instanceof My)o.push({});else if(s instanceof Iy)o.pop();else if(s instanceof Zh){let c=s;n&&c.type!==null&&this._markStructsFromAST(c.type),o.length>0&&(o[o.length-1][c.name]=c)}else if(s instanceof ju){let c=s;n&&c.type!==null&&this._markStructsFromAST(c.type)}else if(s instanceof Lm){let c=s;n&&c.type!==null&&this._markStructsFromAST(c.type),o.length>0&&(o[o.length-1][c.name]=c)}else if(s instanceof Kl){let c=s;if(o.length>0&&o[o.length-1][c.name])return;let d=i._findResource(c.name);d&&r.push(d)}else if(s instanceof kb){let c=s,d=i._functions.get(c.name);d&&(n&&(d.inUse=!0),e.calls.add(d.node),d.resources===null&&(d.resources=i._findResources(d.node,n)),r.push(...d.resources))}else if(s instanceof Ob){let c=s,d=i._functions.get(c.name);d&&(n&&(d.inUse=!0),e.calls.add(d.node),d.resources===null&&(d.resources=i._findResources(d.node,n)),r.push(...d.resources))}}),[...new Map(r.map(s=>[s.name,s])).values()]}getBindGroups(){let e=[];function n(r,i){r>=e.length&&(e.length=r+1),e[r]===void 0&&(e[r]=[]),i>=e[r].length&&(e[r].length=i+1)}for(let r of this.uniforms)n(r.group,r.binding),e[r.group][r.binding]=r;for(let r of this.storage)n(r.group,r.binding),e[r.group][r.binding]=r;for(let r of this.textures)n(r.group,r.binding),e[r.group][r.binding]=r;for(let r of this.samplers)n(r.group,r.binding),e[r.group][r.binding]=r;return e}_getOutputs(e,n=void 0){if(n===void 0&&(n=[]),e instanceof Yh)this._getStructOutputs(e,n);else{let r=this._getOutputInfo(e);r!==null&&n.push(r)}return n}_getStructOutputs(e,n){for(let r of e.members)if(r.type instanceof Yh)this._getStructOutputs(r.type,n);else{let i=this._getAttribute(r,\"location\")||this._getAttribute(r,\"builtin\");if(i!==null){let o=this.getTypeInfo(r.type,r.type.attributes),s=this._parseInt(i.value),c=new jC(r.name,o,i.name,s);n.push(c)}}}_getOutputInfo(e){let n=this._getAttribute(e,\"location\")||this._getAttribute(e,\"builtin\");if(n!==null){let r=this.getTypeInfo(e,e.attributes),i=this._parseInt(n.value);return new jC(\"\",r,n.name,i)}return null}_getInputs(e,n=void 0){n===void 0&&(n=[]);for(let r of e)if(r.type instanceof Yh)this._getStructInputs(r.type,n);else{let i=this._getInputInfo(r);i!==null&&n.push(i)}return n}_getStructInputs(e,n){for(let r of e.members)if(r.type instanceof Yh)this._getStructInputs(r.type,n);else{let i=this._getInputInfo(r);i!==null&&n.push(i)}}_getInputInfo(e){let n=this._getAttribute(e,\"location\")||this._getAttribute(e,\"builtin\");if(n!==null){let r=this._getAttribute(e,\"interpolation\"),i=this.getTypeInfo(e.type,e.attributes),o=this._parseInt(n.value),s=new e8(e.name,i,n.name,o);return r!==null&&(s.interpolation=this._parseString(r.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);let n=parseInt(e);return isNaN(n)?e:n}_getAlias(e){for(let n of this.aliases)if(n.name==e)return n.type;return null}_getAliasInfo(e){return new $O(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(let n of this.structs)if(n.name==e)return n;for(let n of this.aliases)if(n.name==e)return n.type;return null}getTypeInfo(e,n=null){if(this._types.has(e))return this._types.get(e);if(e instanceof Ey){let i=e.type?this.getTypeInfo(e.type,e.attributes):null,o=new Bb(e.name,i,n);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof Om){let i=e,o=i.format?this.getTypeInfo(i.format,i.attributes):null,s=new Qf(i.name,n);return s.format=o,s.count=i.count,this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof Yh){let i=e,o=new qf(i.name,n);o.startLine=i.startLine,o.endLine=i.endLine;for(let s of i.members){let c=this.getTypeInfo(s.type,s.attributes);o.members.push(new WC(s.name,c,s.attributes))}return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof Dm){let i=e,o=i.format instanceof Wt,s=i.format?o?this.getTypeInfo(i.format,null):new vc(i.format,null):null,c=new Cp(i.name,s,n,i.access);return this._types.set(e,c),this._updateTypeInfo(c),c}if(e instanceof ut){let i=e,o=i.format?this.getTypeInfo(i.format,null):null,s=new Cp(i.name,o,n,i.access);return this._types.set(e,s),this._updateTypeInfo(s),s}let r=new vc(e.name,n);return this._types.set(e,r),this._updateTypeInfo(r),r}_updateTypeInfo(e){var n,r,i;let o=this._getTypeSize(e);if(e.size=(n=o?.size)!==null&&n!==void 0?n:0,e instanceof Qf&&e.format){let s=this._getTypeSize(e.format);e.stride=Math.max((r=s?.size)!==null&&r!==void 0?r:0,(i=s?.align)!==null&&i!==void 0?i:0),this._updateTypeInfo(e.format)}e instanceof Bb&&this._updateTypeInfo(e.format),e instanceof qf&&this._updateStructInfo(e)}_updateStructInfo(e){var n;let r=0,i=0,o=0,s=0;for(let c=0,d=e.members.length;c<d;++c){let m=e.members[c],b=this._getTypeSize(m);if(!b)continue;(n=this._getAlias(m.type.name))!==null&&n!==void 0||m.type;let C=b.align,B=b.size;r=this._roundUp(C,r+i),i=B,o=r,s=Math.max(s,C),m.offset=r,m.size=B,this._updateTypeInfo(m.type)}e.size=this._roundUp(s,o+i),e.align=s}_getTypeSize(e){var n,r;if(e==null)return null;let i=this._getAttributeNum(e.attributes,\"size\",0),o=this._getAttributeNum(e.attributes,\"align\",0);if(e instanceof WC&&(e=e.type),e instanceof vc){let s=this._getAlias(e.name);s!==null&&(e=s)}{let s=t._typeInfo[e.name];if(s!==void 0){let c=((n=e.format)===null||n===void 0?void 0:n.name)===\"f16\"?2:1;return new wy(Math.max(o,s.align/c),Math.max(i,s.size/c))}}{let s=t._typeInfo[e.name.substring(0,e.name.length-1)];if(s){let c=e.name[e.name.length-1]===\"h\"?2:1;return new wy(Math.max(o,s.align/c),Math.max(i,s.size/c))}}if(e instanceof Qf){let s=e,c=8,d=8,m=this._getTypeSize(s.format);return m!==null&&(d=m.size,c=m.align),d=s.count*this._getAttributeNum((r=e?.attributes)!==null&&r!==void 0?r:null,\"stride\",this._roundUp(c,d)),i&&(d=i),new wy(Math.max(o,c),Math.max(i,d))}if(e instanceof qf){let s=0,c=0,d=0,m=0,b=0;for(let C of e.members){let B=this._getTypeSize(C.type);B!==null&&(s=Math.max(B.align,s),d=this._roundUp(B.align,d+m),m=B.size,b=d)}return c=this._roundUp(s,b+m),new wy(Math.max(o,s),Math.max(i,c))}return null}_isUniformVar(e){return e instanceof Zh&&e.storage==\"uniform\"}_isStorageVar(e){return e instanceof Zh&&e.storage==\"storage\"}_isTextureVar(e){return e instanceof Zh&&e.type!==null&&t._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof Zh&&e.type!==null&&t._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,n){let r=e;if(!r||!r.attributes)return null;let i=r.attributes;for(let o of i)if(o.name==n)return o;return null}_getAttributeNum(e,n,r){if(e===null)return r;for(let i of e)if(i.name==n){let o=i!==null&&i.value!==null?i.value:r;return o instanceof Array&&(o=o[0]),typeof o==\"number\"?o:typeof o==\"string\"?parseInt(o):r}return r}_roundUp(e,n){return Math.ceil(n/e)*e}};Fm._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Fm._textureTypes=Re.any_texture_type.map(t=>t.name),Fm._samplerTypes=Re.sampler_type.map(t=>t.name);var x8=0,f8=class t{constructor(e,n,r){this.id=x8++,this.name=e,this.value=n,this.node=r}clone(){return new t(this.name,this.value,this.node)}},d8=class t{constructor(e){this.id=x8++,this.name=e.name,this.node=e}clone(){return new t(this.node)}},p8=class t{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName=\"\",this.id=x8++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var n;return this.variables.has(e)?(n=this.variables.get(e))!==null&&n!==void 0?n:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var n;return this.functions.has(e)?(n=this.functions.get(e))!==null&&n!==void 0?n:null:this.parent?this.parent.getFunction(e):null}createVariable(e,n,r){this.variables.set(e,new f8(e,n,r??null))}setVariable(e,n,r){let i=this.getVariable(e);i!==null?i.value=n:this.createVariable(e,n,r)}getVariableValue(e){var n;let r=this.getVariable(e);return(n=r?.value)!==null&&n!==void 0?n:null}clone(){return new t(this)}},A8=class{evalExpression(e,n){return null}getTypeInfo(e){return null}getVariableName(e,n){return\"\"}},g8=class{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,n){let r=this.exec.evalExpression(e.args[0],n),i=!0;if(r instanceof Ue)return r.data.forEach(o=>{o||(i=!1)}),new st(i?1:0,this.getTypeInfo(\"bool\"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue){let i=r.data.some(o=>o);return new st(i?1:0,this.getTypeInfo(\"bool\"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,n){let r=this.exec.evalExpression(e.args[2],n);if(!(r instanceof st))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return r.value?this.exec.evalExpression(e.args[1],n):this.exec.evalExpression(e.args[0],n)}ArrayLength(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.evalExpression(r,n);if(i instanceof Vs&&i.typeInfo.size===0){let o=i.typeInfo,s=i.buffer.byteLength/o.stride;return new st(s,this.getTypeInfo(\"u32\"))}return new st(i.typeInfo.size,this.getTypeInfo(\"u32\"))}Abs(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.abs(o)),r.typeInfo);let i=r;return new st(Math.abs(i.value),i.typeInfo)}Acos(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.acos(o)),r.typeInfo);let i=r;return new st(Math.acos(i.value),r.typeInfo)}Acosh(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.acosh(o)),r.typeInfo);let i=r;return new st(Math.acosh(i.value),r.typeInfo)}Asin(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.asin(o)),r.typeInfo);let i=r;return new st(Math.asin(i.value),r.typeInfo)}Asinh(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.asinh(o)),r.typeInfo);let i=r;return new st(Math.asinh(i.value),r.typeInfo)}Atan(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.atan(o)),r.typeInfo);let i=r;return new st(Math.atan(i.value),r.typeInfo)}Atanh(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.atanh(o)),r.typeInfo);let i=r;return new st(Math.atanh(i.value),r.typeInfo)}Atan2(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof Ue&&i instanceof Ue)return new Ue(r.data.map((c,d)=>Math.atan2(c,i.data[d])),r.typeInfo);let o=r,s=i;return new st(Math.atan2(o.value,s.value),r.typeInfo)}Ceil(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.ceil(o)),r.typeInfo);let i=r;return new st(Math.ceil(i.value),r.typeInfo)}_clamp(e,n,r){return Math.min(Math.max(e,n),r)}Clamp(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),o=this.exec.evalExpression(e.args[2],n);if(r instanceof Ue&&i instanceof Ue&&o instanceof Ue)return new Ue(r.data.map((m,b)=>this._clamp(m,i.data[b],o.data[b])),r.typeInfo);let s=r,c=i,d=o;return new st(this._clamp(s.value,c.value,d.value),r.typeInfo)}Cos(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.cos(o)),r.typeInfo);let i=r;return new st(Math.cos(i.value),r.typeInfo)}Cosh(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.cosh(o)),r.typeInfo);let i=r;return new st(Math.cos(i.value),r.typeInfo)}CountLeadingZeros(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.clz32(o)),r.typeInfo);let i=r;return new st(Math.clz32(i.value),r.typeInfo)}_countOneBits(e){let n=0;for(;e!==0;)1&e&&n++,e>>=1;return n}CountOneBits(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>this._countOneBits(o)),r.typeInfo);let i=r;return new st(this._countOneBits(i.value),r.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let n=0;for(;!(1&e);)e>>=1,n++;return n}CountTrailingZeros(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>this._countTrailingZeros(o)),r.typeInfo);let i=r;return new st(this._countTrailingZeros(i.value),r.typeInfo)}Cross(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof Ue&&i instanceof Ue){if(r.data.length!==3||i.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;let o=r.data,s=i.data;return new Ue([o[1]*s[2]-s[1]*o[2],o[2]*s[0]-s[2]*o[0],o[0]*s[1]-s[0]*o[1]],r.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,n){let r=this.exec.evalExpression(e.args[0],n),i=180/Math.PI;return r instanceof Ue?new Ue(r.data.map(o=>o*i),r.typeInfo):new st(r.value*i,this.getTypeInfo(\"f32\"))}Determinant(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof or){let i=r.data,o=r.typeInfo.getTypeName(),s=o.endsWith(\"h\")?this.getTypeInfo(\"f16\"):this.getTypeInfo(\"f32\");if(o===\"mat2x2\"||o===\"mat2x2f\"||o===\"mat2x2h\")return new st(i[0]*i[3]-i[1]*i[2],s);if(o===\"mat2x3\"||o===\"mat2x3f\"||o===\"mat2x3h\")return new st(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);if(o===\"mat2x4\"||o===\"mat2x4f\"||o===\"mat2x4h\")console.error(`TODO: Determinant for ${o}`);else if(o===\"mat3x2\"||o===\"mat3x2f\"||o===\"mat3x2h\")console.error(`TODO: Determinant for ${o}`);else{if(o===\"mat3x3\"||o===\"mat3x3f\"||o===\"mat3x3h\")return new st(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);o===\"mat3x4\"||o===\"mat3x4f\"||o===\"mat3x4h\"||o===\"mat4x2\"||o===\"mat4x2f\"||o===\"mat4x2h\"||o===\"mat4x3\"||o===\"mat4x3f\"||o===\"mat4x3h\"?console.error(`TODO: Determinant for ${o}`):o!==\"mat4x4\"&&o!==\"mat4x4f\"&&o!==\"mat4x4h\"||console.error(`TODO: Determinant for ${o}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof Ue&&i instanceof Ue){let c=0;for(let d=0;d<r.data.length;++d)c+=(r.data[d]-i.data[d])*(r.data[d]-i.data[d]);return new st(Math.sqrt(c),this.getTypeInfo(\"f32\"))}let o=r,s=i;return new st(Math.abs(o.value-s.value),r.typeInfo)}_dot(e,n){let r=0;for(let i=0;i<e.length;++i)r+=n[i]*e[i];return r}Dot(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);return r instanceof Ue&&i instanceof Ue?new st(this._dot(r.data,i.data),this.getTypeInfo(\"f32\")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,n){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,n){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.exp(o)),r.typeInfo);let i=r;return new st(Math.exp(i.value),r.typeInfo)}Exp2(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.pow(2,o)),r.typeInfo);let i=r;return new st(Math.pow(2,i.value),r.typeInfo)}ExtractBits(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),o=this.exec.evalExpression(e.args[2],n);if(i.typeInfo.name!==\"u32\"&&i.typeInfo.name!==\"x32\")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(o.typeInfo.name!==\"u32\"&&o.typeInfo.name!==\"x32\")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;let s=i.value,c=o.value;if(r instanceof Ue)return new Ue(r.data.map(m=>m>>s&(1<<c)-1),r.typeInfo);if(r.typeInfo.name!==\"i32\"&&r.typeInfo.name!==\"x32\")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;let d=r.value;return new st(d>>s&(1<<c)-1,this.getTypeInfo(\"i32\"))}FaceForward(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),o=this.exec.evalExpression(e.args[2],n);if(r instanceof Ue&&i instanceof Ue&&o instanceof Ue){let s=this._dot(i.data,o.data);return new Ue(s<0?Array.from(r.data):r.data.map(c=>-c),r.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>this._firstLeadingBit(o)),r.typeInfo);let i=r;return new st(this._firstLeadingBit(i.value),r.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>this._firstTrailingBit(o)),r.typeInfo);let i=r;return new st(this._firstTrailingBit(i.value),r.typeInfo)}Floor(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.floor(o)),r.typeInfo);let i=r;return new st(Math.floor(i.value),r.typeInfo)}Fma(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),o=this.exec.evalExpression(e.args[2],n);if(r instanceof Ue&&i instanceof Ue&&o instanceof Ue)return r.data.length!==i.data.length||r.data.length!==o.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new Ue(r.data.map((m,b)=>m*i.data[b]+o.data[b]),r.typeInfo);let s=r,c=i,d=o;return new st(s.value*c.value+d.value,s.typeInfo)}Fract(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>o-Math.floor(o)),r.typeInfo);let i=r;return new st(i.value-Math.floor(i.value),r.typeInfo)}Frexp(e,n){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),o=this.exec.evalExpression(e.args[2],n),s=this.exec.evalExpression(e.args[3],n);if(o.typeInfo.name!==\"u32\"&&o.typeInfo.name!==\"x32\")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;let c=o.value,d=(1<<s.value)-1<<c,m=~d;if(r instanceof Ue&&i instanceof Ue)return new Ue(r.data.map((B,k)=>B&m|i.data[k]<<c&d),r.typeInfo);let b=r.value,C=i.value;return new st(b&m|C<<c&d,r.typeInfo)}InverseSqrt(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>1/Math.sqrt(o)),r.typeInfo);let i=r;return new st(1/Math.sqrt(i.value),r.typeInfo)}Ldexp(e,n){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue){let o=0;return r.data.forEach(s=>{o+=s*s}),new st(Math.sqrt(o),this.getTypeInfo(\"f32\"))}let i=r;return new st(Math.abs(i.value),r.typeInfo)}Log(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.log(o)),r.typeInfo);let i=r;return new st(Math.log(i.value),r.typeInfo)}Log2(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.log2(o)),r.typeInfo);let i=r;return new st(Math.log2(i.value),r.typeInfo)}Max(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof Ue&&i instanceof Ue)return new Ue(r.data.map((c,d)=>Math.max(c,i.data[d])),r.typeInfo);let o=r,s=i;return new st(Math.max(o.value,s.value),r.typeInfo)}Min(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof Ue&&i instanceof Ue)return new Ue(r.data.map((c,d)=>Math.min(c,i.data[d])),r.typeInfo);let o=r,s=i;return new st(Math.min(o.value,s.value),r.typeInfo)}Mix(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),o=this.exec.evalExpression(e.args[2],n);if(r instanceof Ue&&i instanceof Ue&&o instanceof Ue)return new Ue(r.data.map((d,m)=>r.data[m]*(1-o.data[m])+i.data[m]*o.data[m]),r.typeInfo);let s=i,c=o;return new st(r.value*(1-c.value)+s.value*c.value,r.typeInfo)}Modf(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof Ue&&i instanceof Ue)return new Ue(r.data.map((s,c)=>s%i.data[c]),r.typeInfo);let o=i;return new st(r.value%o.value,r.typeInfo)}Normalize(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue){let i=this.Length(e,n).value;return new Ue(r.data.map(o=>o/i),r.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof Ue&&i instanceof Ue)return new Ue(r.data.map((c,d)=>Math.pow(c,i.data[d])),r.typeInfo);let o=r,s=i;return new st(Math.pow(o.value,s.value),r.typeInfo)}QuantizeToF16(e,n){let r=this.exec.evalExpression(e.args[0],n);return r instanceof Ue?new Ue(r.data.map(i=>i),r.typeInfo):new st(r.value,r.typeInfo)}Radians(e,n){let r=this.exec.evalExpression(e.args[0],n);return r instanceof Ue?new Ue(r.data.map(i=>i*Math.PI/180),r.typeInfo):new st(r.value*Math.PI/180,this.getTypeInfo(\"f32\"))}Reflect(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof Ue&&i instanceof Ue){let o=this._dot(r.data,i.data);return new Ue(r.data.map((s,c)=>s-2*o*i.data[c]),r.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),o=this.exec.evalExpression(e.args[2],n);if(r instanceof Ue&&i instanceof Ue&&o instanceof st){let s=this._dot(i.data,r.data);return new Ue(r.data.map((c,d)=>{let m=1-o.value*o.value*(1-s*s);if(m<0)return 0;let b=Math.sqrt(m);return o.value*c-(o.value*s+b)*i.data[d]}),r.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,n){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.round(o)),r.typeInfo);let i=r;return new st(Math.round(i.value),r.typeInfo)}Saturate(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.min(Math.max(o,0),1)),r.typeInfo);let i=r;return new st(Math.min(Math.max(i.value,0),1),r.typeInfo)}Sign(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.sign(o)),r.typeInfo);let i=r;return new st(Math.sign(i.value),r.typeInfo)}Sin(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.sin(o)),r.typeInfo);let i=r;return new st(Math.sin(i.value),r.typeInfo)}Sinh(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.sinh(o)),r.typeInfo);let i=r;return new st(Math.sinh(i.value),r.typeInfo)}_smoothstep(e,n,r){let i=Math.min(Math.max((r-e)/(n-e),0),1);return i*i*(3-2*i)}SmoothStep(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),o=this.exec.evalExpression(e.args[2],n);if(o instanceof Ue&&r instanceof Ue&&i instanceof Ue)return new Ue(o.data.map((m,b)=>this._smoothstep(r.data[b],i.data[b],m)),o.typeInfo);let s=r,c=i,d=o;return new st(this._smoothstep(s.value,c.value,d.value),o.typeInfo)}Sqrt(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.sqrt(o)),r.typeInfo);let i=r;return new st(Math.sqrt(i.value),r.typeInfo)}Step(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(i instanceof Ue&&r instanceof Ue)return new Ue(i.data.map((s,c)=>s<r.data[c]?0:1),i.typeInfo);let o=r;return new st(i.value<o.value?0:1,o.typeInfo)}Tan(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.tan(o)),r.typeInfo);let i=r;return new st(Math.tan(i.value),r.typeInfo)}Tanh(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.tanh(o)),r.typeInfo);let i=r;return new st(Math.tanh(i.value),r.typeInfo)}_getTransposeType(e){let n=e.getTypeName();return n===\"mat2x2f\"||n===\"mat2x2h\"?e:n===\"mat2x3f\"?this.getTypeInfo(\"mat3x2f\"):n===\"mat2x3h\"?this.getTypeInfo(\"mat3x2h\"):n===\"mat2x4f\"?this.getTypeInfo(\"mat4x2f\"):n===\"mat2x4h\"?this.getTypeInfo(\"mat4x2h\"):n===\"mat3x2f\"?this.getTypeInfo(\"mat2x3f\"):n===\"mat3x2h\"?this.getTypeInfo(\"mat2x3h\"):n===\"mat3x3f\"||n===\"mat3x3h\"?e:n===\"mat3x4f\"?this.getTypeInfo(\"mat4x3f\"):n===\"mat3x4h\"?this.getTypeInfo(\"mat4x3h\"):n===\"mat4x2f\"?this.getTypeInfo(\"mat2x4f\"):n===\"mat4x2h\"?this.getTypeInfo(\"mat2x4h\"):n===\"mat4x3f\"?this.getTypeInfo(\"mat3x4f\"):n===\"mat4x3h\"?this.getTypeInfo(\"mat3x4h\"):(n===\"mat4x4f\"||n===\"mat4x4h\"||console.error(`Invalid matrix type ${n}`),e)}Transpose(e,n){let r=this.exec.evalExpression(e.args[0],n);if(!(r instanceof or))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;let i=this._getTransposeType(r.typeInfo);if(r.typeInfo.name===\"mat2x2\"||r.typeInfo.name===\"mat2x2f\"||r.typeInfo.name===\"mat2x2h\"){let o=r.data;return new or([o[0],o[2],o[1],o[3]],i)}if(r.typeInfo.name===\"mat2x3\"||r.typeInfo.name===\"mat2x3f\"||r.typeInfo.name===\"mat2x3h\"){let o=r.data;return new or([o[0],o[3],o[6],o[1],o[4],o[7]],i)}if(r.typeInfo.name===\"mat2x4\"||r.typeInfo.name===\"mat2x4f\"||r.typeInfo.name===\"mat2x4h\"){let o=r.data;return new or([o[0],o[4],o[8],o[12],o[1],o[5],o[9],o[13]],i)}if(r.typeInfo.name===\"mat3x2\"||r.typeInfo.name===\"mat3x2f\"||r.typeInfo.name===\"mat3x2h\"){let o=r.data;return new or([o[0],o[3],o[1],o[4],o[2],o[5]],i)}if(r.typeInfo.name===\"mat3x3\"||r.typeInfo.name===\"mat3x3f\"||r.typeInfo.name===\"mat3x3h\"){let o=r.data;return new or([o[0],o[3],o[6],o[1],o[4],o[7],o[2],o[5],o[8]],i)}if(r.typeInfo.name===\"mat3x4\"||r.typeInfo.name===\"mat3x4f\"||r.typeInfo.name===\"mat3x4h\"){let o=r.data;return new or([o[0],o[4],o[8],o[12],o[1],o[5],o[9],o[13],o[2],o[6],o[10],o[14]],i)}if(r.typeInfo.name===\"mat4x2\"||r.typeInfo.name===\"mat4x2f\"||r.typeInfo.name===\"mat4x2h\"){let o=r.data;return new or([o[0],o[4],o[1],o[5],o[2],o[6]],i)}if(r.typeInfo.name===\"mat4x3\"||r.typeInfo.name===\"mat4x3f\"||r.typeInfo.name===\"mat4x3h\"){let o=r.data;return new or([o[0],o[4],o[8],o[1],o[5],o[9],o[2],o[6],o[10]],i)}if(r.typeInfo.name===\"mat4x4\"||r.typeInfo.name===\"mat4x4f\"||r.typeInfo.name===\"mat4x4h\"){let o=r.data;return new or([o[0],o[4],o[8],o[12],o[1],o[5],o[9],o[13],o[2],o[6],o[10],o[14],o[3],o[7],o[11],o[15]],i)}return console.error(`Invalid matrix type ${r.typeInfo.name}`),null}Trunc(e,n){let r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ue)return new Ue(r.data.map(o=>Math.trunc(o)),r.typeInfo);let i=r;return new st(Math.trunc(i.value),r.typeInfo)}Dpdx(e,n){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,n){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,n){return console.error(\"TODO: dpdxFine\"),null}Dpdy(e,n){return console.error(\"TODO: dpdy\"),null}DpdyCoarse(e,n){return console.error(\"TODO: dpdyCoarse\"),null}DpdyFine(e,n){return console.error(\"TODO: dpdyFine\"),null}Fwidth(e,n){return console.error(\"TODO: fwidth\"),null}FwidthCoarse(e,n){return console.error(\"TODO: fwidthCoarse\"),null}FwidthFine(e,n){return console.error(\"TODO: fwidthFine\"),null}TextureDimensions(e,n){let r=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],n).value:0;if(r instanceof Kl){let o=r.name,s=n.getVariableValue(o);if(s instanceof Sp){if(i<0||i>=s.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;let c=s.getMipLevelSize(i),d=s.dimension;return d===\"1d\"?new st(c[0],this.getTypeInfo(\"u32\")):d===\"3d\"?new Ue(c,this.getTypeInfo(\"vec3u\")):d===\"2d\"?new Ue(c.slice(0,2),this.getTypeInfo(\"vec2u\")):(console.error(`Invalid texture dimension ${d} not found. Line ${e.line}`),null)}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,n){return console.error(\"TODO: textureGather\"),null}TextureGatherCompare(e,n){return console.error(\"TODO: textureGatherCompare\"),null}TextureLoad(e,n){let r=e.args[0],i=this.exec.evalExpression(e.args[1],n),o=e.args.length>2?this.exec.evalExpression(e.args[2],n).value:0;if(!(i instanceof Ue)||i.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(r instanceof Kl){let s=r.name,c=n.getVariableValue(s);if(c instanceof Sp){let d=Math.floor(i.data[0]),m=Math.floor(i.data[1]);if(d<0||d>=c.width||m<0||m>=c.height)return console.error(`Texture ${s} out of bounds. Line ${e.line}`),null;let b=c.getPixel(d,m,0,o);return b===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new Ue(b,this.getTypeInfo(\"vec4f\"))}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,n){let r=e.args[0];if(r instanceof Kl){let i=r.name,o=n.getVariableValue(i);return o instanceof Sp?new st(o.depthOrArrayLayers,this.getTypeInfo(\"u32\")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,n){let r=e.args[0];if(r instanceof Kl){let i=r.name,o=n.getVariableValue(i);return o instanceof Sp?new st(o.mipLevelCount,this.getTypeInfo(\"u32\")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,n){let r=e.args[0];if(r instanceof Kl){let i=r.name,o=n.getVariableValue(i);return o instanceof Sp?new st(o.sampleCount,this.getTypeInfo(\"u32\")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,n){return console.error(\"TODO: textureSample\"),null}TextureSampleBias(e,n){return console.error(\"TODO: textureSampleBias\"),null}TextureSampleCompare(e,n){return console.error(\"TODO: textureSampleCompare\"),null}TextureSampleCompareLevel(e,n){return console.error(\"TODO: textureSampleCompareLevel\"),null}TextureSampleGrad(e,n){return console.error(\"TODO: textureSampleGrad\"),null}TextureSampleLevel(e,n){return console.error(\"TODO: textureSampleLevel\"),null}TextureSampleBaseClampToEdge(e,n){return console.error(\"TODO: textureSampleBaseClampToEdge\"),null}TextureStore(e,n){let r=e.args[0],i=this.exec.evalExpression(e.args[1],n),o=e.args.length===4?this.exec.evalExpression(e.args[2],n).value:0,s=e.args.length===4?this.exec.evalExpression(e.args[3],n).data:this.exec.evalExpression(e.args[2],n).data;if(s.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(i instanceof Ue)||i.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(r instanceof Kl){let c=r.name,d=n.getVariableValue(c);if(d instanceof Sp){let m=d.getMipLevelSize(0),b=Math.floor(i.data[0]),C=Math.floor(i.data[1]);return b<0||b>=m[0]||C<0||C>=m[1]?(console.error(`Texture ${c} out of bounds. Line ${e.line}`),null):(d.setPixel(b,C,0,o,Array.from(s)),null)}return console.error(`Texture ${c} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.getVariableName(r,n);return n.getVariable(i).value.getSubData(this.exec,r.postfix,n)}AtomicStore(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.getVariableName(r,n),o=n.getVariable(i),s=e.args[1],c=this.exec.evalExpression(s,n),d=o.value.getSubData(this.exec,r.postfix,n);return d instanceof st&&c instanceof st&&(d.value=c.value),o.value instanceof Vs&&o.value.setDataValue(this.exec,d,r.postfix,n),null}AtomicAdd(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.getVariableName(r,n),o=n.getVariable(i),s=e.args[1],c=this.exec.evalExpression(s,n),d=o.value.getSubData(this.exec,r.postfix,n),m=new st(d.value,d.typeInfo);return d instanceof st&&c instanceof st&&(d.value+=c.value),o.value instanceof Vs&&o.value.setDataValue(this.exec,d,r.postfix,n),m}AtomicSub(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.getVariableName(r,n),o=n.getVariable(i),s=e.args[1],c=this.exec.evalExpression(s,n),d=o.value.getSubData(this.exec,r.postfix,n),m=new st(d.value,d.typeInfo);return d instanceof st&&c instanceof st&&(d.value-=c.value),o.value instanceof Vs&&o.value.setDataValue(this.exec,d,r.postfix,n),m}AtomicMax(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.getVariableName(r,n),o=n.getVariable(i),s=e.args[1],c=this.exec.evalExpression(s,n),d=o.value.getSubData(this.exec,r.postfix,n),m=new st(d.value,d.typeInfo);return d instanceof st&&c instanceof st&&(d.value=Math.max(d.value,c.value)),o.value instanceof Vs&&o.value.setDataValue(this.exec,d,r.postfix,n),m}AtomicMin(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.getVariableName(r,n),o=n.getVariable(i),s=e.args[1],c=this.exec.evalExpression(s,n),d=o.value.getSubData(this.exec,r.postfix,n),m=new st(d.value,d.typeInfo);return d instanceof st&&c instanceof st&&(d.value=Math.min(d.value,c.value)),o.value instanceof Vs&&o.value.setDataValue(this.exec,d,r.postfix,n),m}AtomicAnd(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.getVariableName(r,n),o=n.getVariable(i),s=e.args[1],c=this.exec.evalExpression(s,n),d=o.value.getSubData(this.exec,r.postfix,n),m=new st(d.value,d.typeInfo);return d instanceof st&&c instanceof st&&(d.value=d.value&c.value),o.value instanceof Vs&&o.value.setDataValue(this.exec,d,r.postfix,n),m}AtomicOr(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.getVariableName(r,n),o=n.getVariable(i),s=e.args[1],c=this.exec.evalExpression(s,n),d=o.value.getSubData(this.exec,r.postfix,n),m=new st(d.value,d.typeInfo);return d instanceof st&&c instanceof st&&(d.value=d.value|c.value),o.value instanceof Vs&&o.value.setDataValue(this.exec,d,r.postfix,n),m}AtomicXor(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.getVariableName(r,n),o=n.getVariable(i),s=e.args[1],c=this.exec.evalExpression(s,n),d=o.value.getSubData(this.exec,r.postfix,n),m=new st(d.value,d.typeInfo);return d instanceof st&&c instanceof st&&(d.value=d.value^c.value),o.value instanceof Vs&&o.value.setDataValue(this.exec,d,r.postfix,n),m}AtomicExchange(e,n){let r=e.args[0];r instanceof as&&(r=r.right);let i=this.exec.getVariableName(r,n),o=n.getVariable(i),s=e.args[1],c=this.exec.evalExpression(s,n),d=o.value.getSubData(this.exec,r.postfix,n),m=new st(d.value,d.typeInfo);return d instanceof st&&c instanceof st&&(d.value=c.value),o.value instanceof Vs&&o.value.setDataValue(this.exec,d,r.postfix,n),m}AtomicCompareExchangeWeak(e,n){return console.error(\"TODO: atomicCompareExchangeWeak\"),null}Pack4x8snorm(e,n){return console.error(\"TODO: pack4x8snorm\"),null}Pack4x8unorm(e,n){return console.error(\"TODO: pack4x8unorm\"),null}Pack4xI8(e,n){return console.error(\"TODO: pack4xI8\"),null}Pack4xU8(e,n){return console.error(\"TODO: pack4xU8\"),null}Pack4x8Clamp(e,n){return console.error(\"TODO: pack4x8Clamp\"),null}Pack4xU8Clamp(e,n){return console.error(\"TODO: pack4xU8Clamp\"),null}Pack2x16snorm(e,n){return console.error(\"TODO: pack2x16snorm\"),null}Pack2x16unorm(e,n){return console.error(\"TODO: pack2x16unorm\"),null}Pack2x16float(e,n){return console.error(\"TODO: pack2x16float\"),null}Unpack4x8snorm(e,n){return console.error(\"TODO: unpack4x8snorm\"),null}Unpack4x8unorm(e,n){return console.error(\"TODO: unpack4x8unorm\"),null}Unpack4xI8(e,n){return console.error(\"TODO: unpack4xI8\"),null}Unpack4xU8(e,n){return console.error(\"TODO: unpack4xU8\"),null}Unpack2x16snorm(e,n){return console.error(\"TODO: unpack2x16snorm\"),null}Unpack2x16unorm(e,n){return console.error(\"TODO: unpack2x16unorm\"),null}Unpack2x16float(e,n){return console.error(\"TODO: unpack2x16float\"),null}StorageBarrier(e,n){return null}TextureBarrier(e,n){return null}WorkgroupBarrier(e,n){return null}WorkgroupUniformLoad(e,n){return null}SubgroupAdd(e,n){return console.error(\"TODO: subgroupAdd\"),null}SubgroupExclusiveAdd(e,n){return console.error(\"TODO: subgroupExclusiveAdd\"),null}SubgroupInclusiveAdd(e,n){return console.error(\"TODO: subgroupInclusiveAdd\"),null}SubgroupAll(e,n){return console.error(\"TODO: subgroupAll\"),null}SubgroupAnd(e,n){return console.error(\"TODO: subgroupAnd\"),null}SubgroupAny(e,n){return console.error(\"TODO: subgroupAny\"),null}SubgroupBallot(e,n){return console.error(\"TODO: subgroupBallot\"),null}SubgroupBroadcast(e,n){return console.error(\"TODO: subgroupBroadcast\"),null}SubgroupBroadcastFirst(e,n){return console.error(\"TODO: subgroupBroadcastFirst\"),null}SubgroupElect(e,n){return console.error(\"TODO: subgroupElect\"),null}SubgroupMax(e,n){return console.error(\"TODO: subgroupMax\"),null}SubgroupMin(e,n){return console.error(\"TODO: subgroupMin\"),null}SubgroupMul(e,n){return console.error(\"TODO: subgroupMul\"),null}SubgroupExclusiveMul(e,n){return console.error(\"TODO: subgroupExclusiveMul\"),null}SubgroupInclusiveMul(e,n){return console.error(\"TODO: subgroupInclusiveMul\"),null}SubgroupOr(e,n){return console.error(\"TODO: subgroupOr\"),null}SubgroupShuffle(e,n){return console.error(\"TODO: subgroupShuffle\"),null}SubgroupShuffleDown(e,n){return console.error(\"TODO: subgroupShuffleDown\"),null}SubgroupShuffleUp(e,n){return console.error(\"TODO: subgroupShuffleUp\"),null}SubgroupShuffleXor(e,n){return console.error(\"TODO: subgroupShuffleXor\"),null}SubgroupXor(e,n){return console.error(\"TODO: subgroupXor\"),null}QuadBroadcast(e,n){return console.error(\"TODO: quadBroadcast\"),null}QuadSwapDiagonal(e,n){return console.error(\"TODO: quadSwapDiagonal\"),null}QuadSwapX(e,n){return console.error(\"TODO: quadSwapX\"),null}QuadSwapY(e,n){return console.error(\"TODO: quadSwapY\"),null}},JO={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},Ql={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]},Cy=class t extends A8{constructor(e,n){var r;super(),this.ast=e??[],this.reflection=new Fm,this.reflection.updateAST(this.ast),this.context=(r=n?.clone())!==null&&r!==void 0?r:new p8,this.builtins=new g8(this),this.typeInfo={bool:this.getTypeInfo(Wt.bool),i32:this.getTypeInfo(Wt.i32),u32:this.getTypeInfo(Wt.u32),f32:this.getTypeInfo(Wt.f32),f16:this.getTypeInfo(Wt.f16),vec2f:this.getTypeInfo(ut.vec2f),vec2u:this.getTypeInfo(ut.vec2u),vec2i:this.getTypeInfo(ut.vec2i),vec2h:this.getTypeInfo(ut.vec2h),vec3f:this.getTypeInfo(ut.vec3f),vec3u:this.getTypeInfo(ut.vec3u),vec3i:this.getTypeInfo(ut.vec3i),vec3h:this.getTypeInfo(ut.vec3h),vec4f:this.getTypeInfo(ut.vec4f),vec4u:this.getTypeInfo(ut.vec4u),vec4i:this.getTypeInfo(ut.vec4i),vec4h:this.getTypeInfo(ut.vec4h),mat2x2f:this.getTypeInfo(ut.mat2x2f),mat2x3f:this.getTypeInfo(ut.mat2x3f),mat2x4f:this.getTypeInfo(ut.mat2x4f),mat3x2f:this.getTypeInfo(ut.mat3x2f),mat3x3f:this.getTypeInfo(ut.mat3x3f),mat3x4f:this.getTypeInfo(ut.mat3x4f),mat4x2f:this.getTypeInfo(ut.mat4x2f),mat4x3f:this.getTypeInfo(ut.mat4x3f),mat4x4f:this.getTypeInfo(ut.mat4x4f)}}getVariableValue(e){var n,r;let i=(r=(n=this.context.getVariable(e))===null||n===void 0?void 0:n.value)!==null&&r!==void 0?r:null;if(i===null)return null;if(i instanceof st)return i.value;if(i instanceof Ue||i instanceof or)return Array.from(i.data);if(i instanceof Vs&&i.typeInfo instanceof Qf){if(i.typeInfo.format.name===\"u32\")return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name===\"i32\")return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name===\"f32\")return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return console.error(`Unsupported return variable type ${i.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,n,r,i){let o=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,o),this._execStatements(this.ast,o);let s=o.getFunction(e);if(!s)return void console.error(`Function ${e} not found`);if(typeof n==\"number\")n=[n,1,1];else{if(n.length===0)return void console.error(\"Invalid dispatch count\");n.length===1?n=[n[0],1,1]:n.length===2?n=[n[0],n[1],1]:n.length>3&&(n=[n[0],n[1],n[2]])}let c=n[0],d=n[1],m=n[2],b=this.getTypeInfo(\"vec3u\");o.setVariable(\"@num_workgroups\",new Ue(n,b));let C=this.reflection.getFunctionInfo(e);C===null&&console.error(`Function ${e} not found in reflection data`);for(let B in r)for(let k in r[B]){let V=r[B][k];o.variables.forEach(q=>{var K;let Y=q.node;if(Y?.attributes){let ee=null,J=null;for(let se of Y.attributes)se.name===\"binding\"?ee=se.value:se.name===\"group\"&&(J=se.value);if(k==ee&&B==J){let se=!1;for(let xe of C.resources)if(xe.name===q.name&&xe.group===parseInt(B)&&xe.binding===parseInt(k)){se=!0;break}if(se)if(V.texture!==void 0&&V.descriptor!==void 0){let xe=new Sp(V.texture,this.getTypeInfo(Y.type),V.descriptor,(K=V.texture.view)!==null&&K!==void 0?K:null);q.value=xe}else V.uniform!==void 0?q.value=new Vs(V.uniform,this.getTypeInfo(Y.type)):q.value=new Vs(V,this.getTypeInfo(Y.type))}}})}for(let B=0;B<m;++B)for(let k=0;k<d;++k)for(let V=0;V<c;++V)o.setVariable(\"@workgroup_id\",new Ue([V,k,B],this.getTypeInfo(\"vec3u\"))),this._dispatchWorkgroup(s,[V,k,B],o)}execStatement(e,n){if(e instanceof $C)return this.evalExpression(e.value,n);if(e instanceof tM){if(e.condition){let r=this.evalExpression(e.condition,n);if(!(r instanceof st))throw new Error(\"Invalid break-if condition\");if(!r.value)return null}return t._breakObj}if(e instanceof nM)return t._continueObj;if(e instanceof Lm)this._let(e,n);else if(e instanceof Zh)this._var(e,n);else if(e instanceof Ty)this._const(e,n);else if(e instanceof km)this._function(e,n);else{if(e instanceof JC)return this._if(e,n);if(e instanceof KC)return this._switch(e,n);if(e instanceof YC)return this._for(e,n);if(e instanceof XC)return this._while(e,n);if(e instanceof QC)return this._loop(e,n);if(e instanceof Db){let r=n.clone();return r.currentFunctionName=n.currentFunctionName,this._execStatements(e.body,r)}if(e instanceof qC)this._assign(e,n);else if(e instanceof ZC)this._increment(e,n);else{if(e instanceof Yh)return null;if(e instanceof Lb){let r=e.name;n.getVariable(r)===null&&n.setVariable(r,new st(0,this.getTypeInfo(\"u32\")))}else if(e instanceof Ob)this._call(e,n);else{if(e instanceof eM||e instanceof Fb)return null;console.error(\"Invalid statement type.\",e,`Line ${e.line}`)}}}return null}evalExpression(e,n){return e instanceof nu?this._evalBinaryOp(e,n):e instanceof ms?this._evalLiteral(e,n):e instanceof Kl?this._evalVariable(e,n):e instanceof kb?this._evalCall(e,n):e instanceof ju?this._evalCreate(e,n):e instanceof iM?this._evalConst(e,n):e instanceof oM?this._evalBitcast(e,n):e instanceof as?this._evalUnaryOp(e,n):(console.error(\"Invalid expression type\",e,`Line ${e.line}`),null)}getTypeInfo(e){var n;if(e instanceof Wt){let i=this.reflection.getTypeInfo(e);if(i!==null)return i}let r=(n=this.typeInfo[e])!==null&&n!==void 0?n:null;return r!==null||(r=this.reflection.getTypeInfoByName(e)),r}_setOverrides(e,n){for(let r in e){let i=e[r],o=this.reflection.getOverrideInfo(r);o!==null?(o.type===null&&(o.type=this.getTypeInfo(\"u32\")),o.type.name===\"u32\"||o.type.name===\"i32\"||o.type.name===\"f32\"||o.type.name===\"f16\"?n.setVariable(r,new st(i,o.type)):o.type.name===\"bool\"?n.setVariable(r,new st(i?1:0,o.type)):o.type.name===\"vec2\"||o.type.name===\"vec3\"||o.type.name===\"vec4\"||o.type.name===\"vec2f\"||o.type.name===\"vec3f\"||o.type.name===\"vec4f\"||o.type.name===\"vec2i\"||o.type.name===\"vec3i\"||o.type.name===\"vec4i\"||o.type.name===\"vec2u\"||o.type.name===\"vec3u\"||o.type.name===\"vec4u\"||o.type.name===\"vec2h\"||o.type.name===\"vec3h\"||o.type.name===\"vec4h\"?n.setVariable(r,new Ue(i,o.type)):console.error(`Invalid constant type for ${r}`)):console.error(`Override ${r} does not exist in the shader.`)}}_dispatchWorkgroup(e,n,r){let i=[1,1,1];for(let b of e.node.attributes)if(b.name===\"workgroup_size\"){if(b.value.length>0){let C=r.getVariableValue(b.value[0]);i[0]=C instanceof st?C.value:parseInt(b.value[0])}if(b.value.length>1){let C=r.getVariableValue(b.value[1]);i[1]=C instanceof st?C.value:parseInt(b.value[1])}if(b.value.length>2){let C=r.getVariableValue(b.value[2]);i[2]=C instanceof st?C.value:parseInt(b.value[2])}}let o=this.getTypeInfo(\"vec3u\"),s=this.getTypeInfo(\"u32\");r.setVariable(\"@workgroup_size\",new Ue(i,o));let c=i[0],d=i[1],m=i[2];for(let b=0,C=0;b<m;++b)for(let B=0;B<d;++B)for(let k=0;k<c;++k,++C){let V=[k,B,b],q=[k+n[0]*i[0],B+n[1]*i[1],b+n[2]*i[2]];r.setVariable(\"@local_invocation_id\",new Ue(V,o)),r.setVariable(\"@global_invocation_id\",new Ue(q,o)),r.setVariable(\"@local_invocation_index\",new st(C,s)),this._dispatchExec(e,r)}}_dispatchExec(e,n){for(let r of e.node.args)for(let i of r.attributes)if(i.name===\"builtin\"){let o=`@${i.value}`,s=n.getVariable(o);s!==void 0&&n.variables.set(r.name,s)}this._execStatements(e.node.body,n)}getVariableName(e,n){for(;e instanceof as;)e=e.right;return e instanceof Kl?e.name:(console.error(\"Unknown variable type\",e,\"Line\",e.line),null)}_execStatements(e,n){for(let r of e){if(r instanceof Array){let o=n.clone(),s=this._execStatements(r,o);if(s)return s;continue}let i=this.execStatement(r,n);if(i)return i}return null}_call(e,n){let r=n.clone();r.currentFunctionName=e.name;let i=n.getFunction(e.name);if(i){for(let o=0;o<i.node.args.length;++o){let s=i.node.args[o],c=this.evalExpression(e.args[o],r);r.setVariable(s.name,c,s)}this._execStatements(i.node.body,r)}else e.isBuiltin?this._callBuiltinFunction(e,r):this.getTypeInfo(e.name)&&this._evalCreate(e,n)}_increment(e,n){let r=this.getVariableName(e.variable,n),i=n.getVariable(r);i?e.operator===\"++\"?i.value instanceof st?i.value.value++:console.error(`Variable ${r} is not a scalar. Line ${e.line}`):e.operator===\"--\"?i.value instanceof st?i.value.value--:console.error(`Variable ${r} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${r} not found. Line ${e.line}`)}_getVariableData(e,n){if(e instanceof Kl){let r=this.getVariableName(e,n),i=n.getVariable(r);return i===null?(console.error(`Variable ${r} not found. Line ${e.line}`),null):i.value.getSubData(this,e.postfix,n)}if(e instanceof as){if(e.operator===\"*\"){let r=this._getVariableData(e.right,n);return r instanceof EA?r.reference.getSubData(this,e.postfix,n):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator===\"&\"){let r=this._getVariableData(e.right,n);return new EA(r)}}return null}_assign(e,n){let r=null,i=\"<var>\",o=null;if(e.variable instanceof as){let d=this._getVariableData(e.variable,n),m=this.evalExpression(e.value,n),b=e.operator;if(b===\"=\"){if(d instanceof st||d instanceof Ue||d instanceof or){if(m instanceof st||m instanceof Ue||m instanceof or&&d.data.length===m.data.length)return void d.data.set(m.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(d instanceof Vs&&m instanceof Vs&&d.buffer.byteLength-d.offset>=m.buffer.byteLength-m.offset)return void(d.buffer.byteLength%4==0?new Uint32Array(d.buffer,d.offset,d.typeInfo.size/4).set(new Uint32Array(m.buffer,m.offset,m.typeInfo.size/4)):new Uint8Array(d.buffer,d.offset,d.typeInfo.size).set(new Uint8Array(m.buffer,m.offset,m.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(b===\"+=\")return d instanceof st||d instanceof Ue||d instanceof or?m instanceof st||m instanceof Ue||m instanceof or?void d.data.set(m.data.map((C,B)=>d.data[B]+C)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(b===\"-=\")return(d instanceof st||d instanceof Ue||d instanceof or)&&(m instanceof st||m instanceof Ue||m instanceof or)?void d.data.set(m.data.map((C,B)=>d.data[B]-C)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof as){if(e.variable.operator===\"*\"){i=this.getVariableName(e.variable.right,n);let d=n.getVariable(i);if(!(d&&d.value instanceof EA))return void console.error(`Variable ${i} is not a pointer. Line ${e.line}`);r=d.value.reference;let m=e.variable.postfix;if(!m){let b=e.variable.right;for(;b instanceof as;){if(b.postfix){m=b.postfix;break}b=b.right}}m&&(r=r.getSubData(this,m,n))}}else{o=e.variable.postfix,i=this.getVariableName(e.variable,n);let d=n.getVariable(i);if(d===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);r=d.value}if(r instanceof EA&&(r=r.reference),r===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);let s=this.evalExpression(e.value,n),c=e.operator;if(c!==\"=\"){let d=r.getSubData(this,o,n);if(d instanceof Ue&&s instanceof st){let m=d.data,b=s.value;if(c===\"+=\")for(let C=0;C<m.length;++C)m[C]+=b;else if(c===\"-=\")for(let C=0;C<m.length;++C)m[C]-=b;else if(c===\"*=\")for(let C=0;C<m.length;++C)m[C]*=b;else if(c===\"/=\")for(let C=0;C<m.length;++C)m[C]/=b;else if(c===\"%=\")for(let C=0;C<m.length;++C)m[C]%=b;else if(c===\"&=\")for(let C=0;C<m.length;++C)m[C]&=b;else if(c===\"|=\")for(let C=0;C<m.length;++C)m[C]|=b;else if(c===\"^=\")for(let C=0;C<m.length;++C)m[C]^=b;else if(c===\"<<=\")for(let C=0;C<m.length;++C)m[C]<<=b;else if(c===\">>=\")for(let C=0;C<m.length;++C)m[C]>>=b;else console.error(`Invalid operator ${c}. Line ${e.line}`)}else if(d instanceof Ue&&s instanceof Ue){let m=d.data,b=s.data;if(m.length!==b.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(c===\"+=\")for(let C=0;C<m.length;++C)m[C]+=b[C];else if(c===\"-=\")for(let C=0;C<m.length;++C)m[C]-=b[C];else if(c===\"*=\")for(let C=0;C<m.length;++C)m[C]*=b[C];else if(c===\"/=\")for(let C=0;C<m.length;++C)m[C]/=b[C];else if(c===\"%=\")for(let C=0;C<m.length;++C)m[C]%=b[C];else if(c===\"&=\")for(let C=0;C<m.length;++C)m[C]&=b[C];else if(c===\"|=\")for(let C=0;C<m.length;++C)m[C]|=b[C];else if(c===\"^=\")for(let C=0;C<m.length;++C)m[C]^=b[C];else if(c===\"<<=\")for(let C=0;C<m.length;++C)m[C]<<=b[C];else if(c===\">>=\")for(let C=0;C<m.length;++C)m[C]>>=b[C];else console.error(`Invalid operator ${c}. Line ${e.line}`)}else{if(!(d instanceof st&&s instanceof st))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);c===\"+=\"?d.value+=s.value:c===\"-=\"?d.value-=s.value:c===\"*=\"?d.value*=s.value:c===\"/=\"?d.value/=s.value:c===\"%=\"?d.value%=s.value:c===\"&=\"?d.value&=s.value:c===\"|=\"?d.value|=s.value:c===\"^=\"?d.value^=s.value:c===\"<<=\"?d.value<<=s.value:c===\">>=\"?d.value>>=s.value:console.error(`Invalid operator ${c}. Line ${e.line}`)}return void(r instanceof Vs&&r.setDataValue(this,d,o,n))}if(r instanceof Vs)r.setDataValue(this,s,o,n);else if(o){if(!(r instanceof Ue||r instanceof or))return void console.error(`Variable ${i} is not a vector or matrix. Line ${e.line}`);if(o instanceof SA){let d=this.evalExpression(o.index,n).value;if(r instanceof Ue){if(!(s instanceof st))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[d]=s.value}else{if(!(r instanceof or))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{let m=this.evalExpression(o.index,n).value;if(m<0)return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(s instanceof Ue))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{let b=r.typeInfo.getTypeName();if(b===\"mat2x2\"||b===\"mat2x2f\"||b===\"mat2x2h\"){if(!(m<2&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*m]=s.data[0],r.data[2*m+1]=s.data[1]}else if(b===\"mat2x3\"||b===\"mat2x3f\"||b===\"mat2x3h\"){if(!(m<2&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*m]=s.data[0],r.data[3*m+1]=s.data[1],r.data[3*m+2]=s.data[2]}else if(b===\"mat2x4\"||b===\"mat2x4f\"||b===\"mat2x4h\"){if(!(m<2&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*m]=s.data[0],r.data[4*m+1]=s.data[1],r.data[4*m+2]=s.data[2],r.data[4*m+3]=s.data[3]}else if(b===\"mat3x2\"||b===\"mat3x2f\"||b===\"mat3x2h\"){if(!(m<3&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*m]=s.data[0],r.data[2*m+1]=s.data[1]}else if(b===\"mat3x3\"||b===\"mat3x3f\"||b===\"mat3x3h\"){if(!(m<3&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*m]=s.data[0],r.data[3*m+1]=s.data[1],r.data[3*m+2]=s.data[2]}else if(b===\"mat3x4\"||b===\"mat3x4f\"||b===\"mat3x4h\"){if(!(m<3&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*m]=s.data[0],r.data[4*m+1]=s.data[1],r.data[4*m+2]=s.data[2],r.data[4*m+3]=s.data[3]}else if(b===\"mat4x2\"||b===\"mat4x2f\"||b===\"mat4x2h\"){if(!(m<4&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*m]=s.data[0],r.data[2*m+1]=s.data[1]}else if(b===\"mat4x3\"||b===\"mat4x3f\"||b===\"mat4x3h\"){if(!(m<4&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*m]=s.data[0],r.data[3*m+1]=s.data[1],r.data[3*m+2]=s.data[2]}else{if(b!==\"mat4x4\"&&b!==\"mat4x4f\"&&b!==\"mat4x4h\")return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(m<4&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*m]=s.data[0],r.data[4*m+1]=s.data[1],r.data[4*m+2]=s.data[2],r.data[4*m+3]=s.data[3]}}}}}else if(o instanceof Mp){let d=o.value;if(!(r instanceof Ue))return void console.error(`Invalid assignment to ${d}. Variable ${i} is not a vector. Line ${e.line}`);if(s instanceof st){if(d.length>1)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);if(d===\"x\")r.data[0]=s.value;else if(d===\"y\"){if(r.data.length<2)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);r.data[1]=s.value}else if(d===\"z\"){if(r.data.length<3)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);r.data[2]=s.value}else if(d===\"w\"){if(r.data.length<4)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);r.data[3]=s.value}}else{if(!(s instanceof Ue))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(d.length!==s.data.length)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);for(let m=0;m<d.length;++m){let b=d[m];if(b===\"x\"||b===\"r\")r.data[0]=s.data[m];else if(b===\"y\"||b===\"g\"){if(s.data.length<2)return void console.error(`Invalid assignment to ${b} for variable ${i}. Line ${e.line}`);r.data[1]=s.data[m]}else if(b===\"z\"||b===\"b\"){if(s.data.length<3)return void console.error(`Invalid assignment to ${b} for variable ${i}. Line ${e.line}`);r.data[2]=s.data[m]}else{if(b!==\"w\"&&b!==\"a\")return void console.error(`Invalid assignment to ${b} for variable ${i}. Line ${e.line}`);if(s.data.length<4)return void console.error(`Invalid assignment to ${b} for variable ${i}. Line ${e.line}`);r.data[3]=s.data[m]}}}}}else r instanceof st&&s instanceof st?r.value=s.value:r instanceof Ue&&s instanceof Ue||r instanceof or&&s instanceof or?r.data.set(s.data):console.error(`Invalid assignment to ${i}. Line ${e.line}`)}_function(e,n){let r=new d8(e);n.functions.set(e.name,r)}_const(e,n){let r=null;e.value!==null&&(r=this.evalExpression(e.value,n)),n.createVariable(e.name,r,e)}_let(e,n){let r=null;if(e.value!==null){if(r=this.evalExpression(e.value,n),r===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof as||(r=r.clone())}else{let i=e.type.name;if(i===\"f32\"||i===\"i32\"||i===\"u32\"||i===\"bool\"||i===\"f16\"||i===\"vec2\"||i===\"vec3\"||i===\"vec4\"||i===\"vec2f\"||i===\"vec3f\"||i===\"vec4f\"||i===\"vec2i\"||i===\"vec3i\"||i===\"vec4i\"||i===\"vec2u\"||i===\"vec3u\"||i===\"vec4u\"||i===\"vec2h\"||i===\"vec3h\"||i===\"vec4h\"||i===\"vec2b\"||i===\"vec3b\"||i===\"vec4b\"||i===\"mat2x2\"||i===\"mat2x3\"||i===\"mat2x4\"||i===\"mat3x2\"||i===\"mat3x3\"||i===\"mat3x4\"||i===\"mat4x2\"||i===\"mat4x3\"||i===\"mat4x4\"||i===\"mat2x2f\"||i===\"mat2x3f\"||i===\"mat2x4f\"||i===\"mat3x2f\"||i===\"mat3x3f\"||i===\"mat3x4f\"||i===\"mat4x2f\"||i===\"mat4x3f\"||i===\"mat4x4f\"||i===\"mat2x2h\"||i===\"mat2x3h\"||i===\"mat2x4h\"||i===\"mat3x2h\"||i===\"mat3x3h\"||i===\"mat3x4h\"||i===\"mat4x2h\"||i===\"mat4x3h\"||i===\"mat4x4h\"||i===\"array\"){let o=new ju(e.type,[]);r=this._evalCreate(o,n)}}n.createVariable(e.name,r,e)}_var(e,n){let r=null;if(e.value!==null){if(r=this.evalExpression(e.value,n),r===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof as||(r=r.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);let i=e.type.name;if(i===\"f32\"||i===\"i32\"||i===\"u32\"||i===\"bool\"||i===\"f16\"||i===\"vec2\"||i===\"vec3\"||i===\"vec4\"||i===\"vec2f\"||i===\"vec3f\"||i===\"vec4f\"||i===\"vec2i\"||i===\"vec3i\"||i===\"vec4i\"||i===\"vec2u\"||i===\"vec3u\"||i===\"vec4u\"||i===\"vec2h\"||i===\"vec3h\"||i===\"vec4h\"||i===\"vec2b\"||i===\"vec3b\"||i===\"vec4b\"||i===\"mat2x2\"||i===\"mat2x3\"||i===\"mat2x4\"||i===\"mat3x2\"||i===\"mat3x3\"||i===\"mat3x4\"||i===\"mat4x2\"||i===\"mat4x3\"||i===\"mat4x4\"||i===\"mat2x2f\"||i===\"mat2x3f\"||i===\"mat2x4f\"||i===\"mat3x2f\"||i===\"mat3x3f\"||i===\"mat3x4f\"||i===\"mat4x2f\"||i===\"mat4x3f\"||i===\"mat4x4f\"||i===\"mat2x2h\"||i===\"mat2x3h\"||i===\"mat2x4h\"||i===\"mat3x2h\"||i===\"mat3x3h\"||i===\"mat3x4h\"||i===\"mat4x2h\"||i===\"mat4x3h\"||i===\"mat4x4h\"||e.type instanceof Om||e.type instanceof Yh||e.type instanceof ut){let o=new ju(e.type,[]);r=this._evalCreate(o,n)}}n.createVariable(e.name,r,e)}_switch(e,n){n=n.clone();let r=this.evalExpression(e.condition,n);if(!(r instanceof st))return console.error(`Invalid if condition. Line ${e.line}`),null;let i=null;for(let o of e.cases)if(o instanceof lM)for(let s of o.selectors){if(s instanceof Sy){i=o;continue}let c=this.evalExpression(s,n);if(!(c instanceof st))return console.error(`Invalid case selector. Line ${e.line}`),null;if(c.value===r.value)return this._execStatements(o.body,n)}else o instanceof cM&&(i=o);return i?this._execStatements(i.body,n):null}_if(e,n){n=n.clone();let r=this.evalExpression(e.condition,n);if(!(r instanceof st))return console.error(`Invalid if condition. Line ${e.line}`),null;if(r.value)return this._execStatements(e.body,n);for(let i of e.elseif){let o=this.evalExpression(i.condition,n);if(!(o instanceof st))return console.error(`Invalid if condition. Line ${e.line}`),null;if(o.value)return this._execStatements(i.body,n)}return e.else?this._execStatements(e.else,n):null}_getScalarValue(e){return e instanceof st?e.value:(console.error(\"Expected scalar value.\",e),0)}_for(e,n){for(n=n.clone(),this.execStatement(e.init,n);this._getScalarValue(this.evalExpression(e.condition,n));){let r=this._execStatements(e.body,n);if(r===t._breakObj)break;if(r!==null&&r!==t._continueObj)return r;this.execStatement(e.increment,n)}return null}_loop(e,n){for(n=n.clone();;){let r=this._execStatements(e.body,n);if(r===t._breakObj)break;if(r===t._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,n)===t._breakObj)break}else if(r!==null)return r}return null}_while(e,n){for(n=n.clone();this._getScalarValue(this.evalExpression(e.condition,n));){let r=this._execStatements(e.body,n);if(r===t._breakObj)break;if(r!==t._continueObj&&r!==null)return r}return null}_evalBitcast(e,n){let r=this.evalExpression(e.value,n),i=e.type;if(r instanceof st){let o=vq(r.value,r.typeInfo.name,i.name);return new st(o,this.getTypeInfo(i))}if(r instanceof Ue){let o=r.typeInfo.getTypeName(),s=\"\";if(o.endsWith(\"f\"))s=\"f32\";else if(o.endsWith(\"i\"))s=\"i32\";else if(o.endsWith(\"u\"))s=\"u32\";else if(o.endsWith(\"b\"))s=\"bool\";else{if(!o.endsWith(\"h\"))return console.error(`Unknown vector type ${o}. Line ${e.line}`),null;s=\"f16\"}let c=i.getTypeName(),d=\"\";if(c.endsWith(\"f\"))d=\"f32\";else if(c.endsWith(\"i\"))d=\"i32\";else if(c.endsWith(\"u\"))d=\"u32\";else if(c.endsWith(\"b\"))d=\"bool\";else{if(!c.endsWith(\"h\"))return console.error(`Unknown vector type ${d}. Line ${e.line}`),null;d=\"f16\"}let m=(function(b,C,B){if(C===B)return b;let k=new Array(b.length);for(let V=0;V<b.length;V++)k[V]=vq(b[V],C,B);return k})(Array.from(r.data),s,d);return new Ue(m,this.getTypeInfo(i))}return console.error(`TODO: bitcast for ${r.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,n){return n.getVariableValue(e.name).clone().getSubData(this,e.postfix,n)}_evalCreate(e,n){var r;if(e instanceof ju){if(e.type===null)return Nb.void;switch(e.type.getTypeName()){case\"bool\":case\"i32\":case\"u32\":case\"f32\":case\"f16\":return this._callConstructorValue(e,n);case\"vec2\":case\"vec3\":case\"vec4\":case\"vec2f\":case\"vec3f\":case\"vec4f\":case\"vec2h\":case\"vec3h\":case\"vec4h\":case\"vec2i\":case\"vec3i\":case\"vec4i\":case\"vec2u\":case\"vec3u\":case\"vec4u\":case\"vec2b\":case\"vec3b\":case\"vec4b\":return this._callConstructorVec(e,n);case\"mat2x2\":case\"mat2x2f\":case\"mat2x2h\":case\"mat2x3\":case\"mat2x3f\":case\"mat2x3h\":case\"mat2x4\":case\"mat2x4f\":case\"mat2x4h\":case\"mat3x2\":case\"mat3x2f\":case\"mat3x2h\":case\"mat3x3\":case\"mat3x3f\":case\"mat3x3h\":case\"mat3x4\":case\"mat3x4f\":case\"mat3x4h\":case\"mat4x2\":case\"mat4x2f\":case\"mat4x2h\":case\"mat4x3\":case\"mat4x3f\":case\"mat4x3h\":case\"mat4x4\":case\"mat4x4f\":case\"mat4x4h\":return this._callConstructorMatrix(e,n)}}let i=e instanceof ju?e.type.name:e.name,o=e instanceof ju?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(o===null)return console.error(`Unknown type ${i}. Line ${e.line}`),null;if(o.size===0)return null;let s=new Vs(new ArrayBuffer(o.size),o,0);if(o instanceof qf){if(e.args)for(let c=0;c<e.args.length;++c){let d=o.members[c],m=e.args[c],b=this.evalExpression(m,n);s.setData(this,b,d.type,d.offset,n)}}else if(o instanceof Qf){let c=0;if(e.args)for(let d=0;d<e.args.length;++d){let m=e.args[d],b=this.evalExpression(m,n);o.format===null&&(((r=b.typeInfo)===null||r===void 0?void 0:r.name)===\"x32\"?o.format=this.getTypeInfo(\"i32\"):o.format=b.typeInfo),s.setData(this,b,o.format,c,n),c+=o.stride}}else console.error(`Unknown type \"${i}\". Line ${e.line}`);return e instanceof ju?s.getSubData(this,e.postfix,n):s}_evalLiteral(e,n){let r=this.getTypeInfo(e.type),i=r.name;return i===\"x32\"||i===\"u32\"||i===\"f32\"||i===\"f16\"||i===\"i32\"||i===\"bool\"?new st(e.scalarValue,r):i===\"vec2\"||i===\"vec3\"||i===\"vec4\"||i===\"vec2f\"||i===\"vec3f\"||i===\"vec4f\"||i===\"vec2h\"||i===\"vec3h\"||i===\"vec4h\"||i===\"vec2i\"||i===\"vec3i\"||i===\"vec4i\"||i===\"vec2u\"||i===\"vec3u\"||i===\"vec4u\"?this._callConstructorVec(e,n):i===\"mat2x2\"||i===\"mat2x3\"||i===\"mat2x4\"||i===\"mat3x2\"||i===\"mat3x3\"||i===\"mat3x4\"||i===\"mat4x2\"||i===\"mat4x3\"||i===\"mat4x4\"||i===\"mat2x2f\"||i===\"mat2x3f\"||i===\"mat2x4f\"||i===\"mat3x2f\"||i===\"mat3x3f\"||i===\"mat3x4f\"||i===\"mat4x2f\"||i===\"mat4x3f\"||i===\"mat4x4f\"||i===\"mat2x2h\"||i===\"mat2x3h\"||i===\"mat2x4h\"||i===\"mat3x2h\"||i===\"mat3x3h\"||i===\"mat3x4h\"||i===\"mat4x2h\"||i===\"mat4x3h\"||i===\"mat4x4h\"?this._callConstructorMatrix(e,n):e.value}_evalVariable(e,n){let r=n.getVariableValue(e.name);return r===null?r:r.getSubData(this,e.postfix,n)}_maxFormatTypeInfo(e){let n=e[0];if(n.name===\"f32\")return n;for(let r=1;r<e.length;++r){let i=t._priority.get(n.name);t._priority.get(e[r].name)<i&&(n=e[r])}return n.name===\"x32\"?this.getTypeInfo(\"i32\"):n}_evalUnaryOp(e,n){let r=this.evalExpression(e.right,n);if(e.operator===\"&\")return new EA(r);if(e.operator===\"*\")return r instanceof EA?r.reference.getSubData(this,e.postfix,n):(console.error(`Invalid dereference. Line ${e.line}`),null);let i=r instanceof st?r.value:r instanceof Ue?Array.from(r.data):null;switch(e.operator){case\"+\":{if(mn(i)){let c=i.map((d,m)=>+d);return new Ue(c,r.typeInfo)}let o=i,s=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new st(+o,s)}case\"-\":{if(mn(i)){let c=i.map((d,m)=>-d);return new Ue(c,r.typeInfo)}let o=i,s=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new st(-o,s)}case\"!\":{if(mn(i)){let c=i.map((d,m)=>d?0:1);return new Ue(c,r.typeInfo)}let o=i,s=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new st(o?0:1,s)}case\"~\":{if(mn(i)){let c=i.map((d,m)=>~d);return new Ue(c,r.typeInfo)}let o=i,s=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new st(~o,s)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,n){let r=this.evalExpression(e.left,n),i=this.evalExpression(e.right,n),o=r instanceof st?r.value:r instanceof Ue||r instanceof or?Array.from(r.data):null,s=i instanceof st?i.value:i instanceof Ue||i instanceof or?Array.from(i.data):null;switch(e.operator){case\"+\":{if(mn(o)&&mn(s)){let b=o,C=s;if(b.length!==C.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let B=b.map((k,V)=>k+C[V]);return new Ue(B,r.typeInfo)}if(mn(o)){let b=s,C=o.map((B,k)=>B+b);return new Ue(C,r.typeInfo)}if(mn(s)){let b=o,C=s.map((B,k)=>b+B);return new Ue(C,i.typeInfo)}let c=o,d=s,m=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new st(c+d,m)}case\"-\":{if(mn(o)&&mn(s)){let b=o,C=s;if(b.length!==C.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let B=b.map((k,V)=>k-C[V]);return new Ue(B,r.typeInfo)}if(mn(o)){let b=s,C=o.map((B,k)=>B-b);return new Ue(C,r.typeInfo)}if(mn(s)){let b=o,C=s.map((B,k)=>b-B);return new Ue(C,i.typeInfo)}let c=o,d=s,m=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new st(c-d,m)}case\"*\":{if(mn(o)&&mn(s)){let b=o,C=s;if(r instanceof or&&i instanceof or){let B=(function(K,Y,ee,J){if(Ql[Y.name]===void 0||Ql[J.name]===void 0)return null;let se=Ql[Y.name][0],xe=Ql[Y.name][1],Ee=Ql[J.name][0];if(se!==Ql[J.name][1])return null;let Xe=new Array(Ee*xe);for(let Ne=0;Ne<xe;Ne++)for(let be=0;be<Ee;be++){let ge=0;for(let Qe=0;Qe<se;Qe++)ge+=K[Qe*xe+Ne]*ee[be*se+Qe];Xe[Ne*Ee+be]=ge}return Xe})(b,r.typeInfo,C,i.typeInfo);if(B===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;let k=Ql[i.typeInfo.name][0],V=Ql[r.typeInfo.name][1],q=this.getTypeInfo(`mat${k}x${V}f`);return new or(B,q)}if(r instanceof or&&i instanceof Ue){let B=(function(k,V,q,K){if(Ql[V.name]===void 0||JO[K.name]===void 0)return null;let Y=Ql[V.name][0],ee=Ql[V.name][1];if(Y!==q.length)return null;let J=new Array(ee);for(let se=0;se<ee;se++){let xe=0;for(let Ee=0;Ee<Y;Ee++)xe+=k[Ee*ee+se]*q[Ee];J[se]=xe}return J})(b,r.typeInfo,C,i.typeInfo);return B===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Ue(B,i.typeInfo)}if(r instanceof Ue&&i instanceof or){let B=(function(k,V,q,K){if(JO[V.name]===void 0||Ql[K.name]===void 0)return null;let Y=Ql[K.name][0],ee=Ql[K.name][1];if(ee!==k.length)return null;let J=[];for(let se=0;se<Y;se++){let xe=0;for(let Ee=0;Ee<ee;Ee++)xe+=k[Ee]*q[Ee*Y+se];J[se]=xe}return J})(b,r.typeInfo,C,i.typeInfo);return B===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Ue(B,r.typeInfo)}{if(b.length!==C.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let B=b.map((k,V)=>k*C[V]);return new Ue(B,r.typeInfo)}}if(mn(o)){let b=s,C=o.map((B,k)=>B*b);return r instanceof or?new or(C,r.typeInfo):new Ue(C,r.typeInfo)}if(mn(s)){let b=o,C=s.map((B,k)=>b*B);return i instanceof or?new or(C,i.typeInfo):new Ue(C,i.typeInfo)}let c=o,d=s,m=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new st(c*d,m)}case\"%\":{if(mn(o)&&mn(s)){let b=o,C=s;if(b.length!==C.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let B=b.map((k,V)=>k%C[V]);return new Ue(B,r.typeInfo)}if(mn(o)){let b=s,C=o.map((B,k)=>B%b);return new Ue(C,r.typeInfo)}if(mn(s)){let b=o,C=s.map((B,k)=>b%B);return new Ue(C,i.typeInfo)}let c=o,d=s,m=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new st(c%d,m)}case\"/\":{if(mn(o)&&mn(s)){let b=o,C=s;if(b.length!==C.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let B=b.map((k,V)=>k/C[V]);return new Ue(B,r.typeInfo)}if(mn(o)){let b=s,C=o.map((B,k)=>B/b);return new Ue(C,r.typeInfo)}if(mn(s)){let b=o,C=s.map((B,k)=>b/B);return new Ue(C,i.typeInfo)}let c=o,d=s,m=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new st(c/d,m)}case\"&\":{if(mn(o)&&mn(s)){let b=o,C=s;if(b.length!==C.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let B=b.map((k,V)=>k&C[V]);return new Ue(B,r.typeInfo)}if(mn(o)){let b=s,C=o.map((B,k)=>B&b);return new Ue(C,r.typeInfo)}if(mn(s)){let b=o,C=s.map((B,k)=>b&B);return new Ue(C,i.typeInfo)}let c=o,d=s,m=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new st(c&d,m)}case\"|\":{if(mn(o)&&mn(s)){let b=o,C=s;if(b.length!==C.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let B=b.map((k,V)=>k|C[V]);return new Ue(B,r.typeInfo)}if(mn(o)){let b=s,C=o.map((B,k)=>B|b);return new Ue(C,r.typeInfo)}if(mn(s)){let b=o,C=s.map((B,k)=>b|B);return new Ue(C,i.typeInfo)}let c=o,d=s,m=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new st(c|d,m)}case\"^\":{if(mn(o)&&mn(s)){let b=o,C=s;if(b.length!==C.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let B=b.map((k,V)=>k^C[V]);return new Ue(B,r.typeInfo)}if(mn(o)){let b=s,C=o.map((B,k)=>B^b);return new Ue(C,r.typeInfo)}if(mn(s)){let b=o,C=s.map((B,k)=>b^B);return new Ue(C,i.typeInfo)}let c=o,d=s,m=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new st(c^d,m)}case\"<<\":{if(mn(o)&&mn(s)){let b=o,C=s;if(b.length!==C.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let B=b.map((k,V)=>k<<C[V]);return new Ue(B,r.typeInfo)}if(mn(o)){let b=s,C=o.map((B,k)=>B<<b);return new Ue(C,r.typeInfo)}if(mn(s)){let b=o,C=s.map((B,k)=>b<<B);return new Ue(C,i.typeInfo)}let c=o,d=s,m=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new st(c<<d,m)}case\">>\":{if(mn(o)&&mn(s)){let b=o,C=s;if(b.length!==C.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let B=b.map((k,V)=>k>>C[V]);return new Ue(B,r.typeInfo)}if(mn(o)){let b=s,C=o.map((B,k)=>B>>b);return new Ue(C,r.typeInfo)}if(mn(s)){let b=o,C=s.map((B,k)=>b>>B);return new Ue(C,i.typeInfo)}let c=o,d=s,m=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new st(c>>d,m)}case\">\":if(mn(o)&&mn(s)){let c=o,d=s;if(c.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let m=c.map((b,C)=>b>d[C]?1:0);return new Ue(m,r.typeInfo)}if(mn(o)){let c=s,d=o.map((m,b)=>m>c?1:0);return new Ue(d,r.typeInfo)}if(mn(s)){let c=o,d=s.map((m,b)=>c>m?1:0);return new Ue(d,i.typeInfo)}return new st(o>s?1:0,this.getTypeInfo(\"bool\"));case\"<\":if(mn(o)&&mn(s)){let c=o,d=s;if(c.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let m=c.map((b,C)=>b<d[C]?1:0);return new Ue(m,r.typeInfo)}if(mn(o)){let c=s,d=o.map((m,b)=>m<c?1:0);return new Ue(d,r.typeInfo)}if(mn(s)){let c=o,d=s.map((m,b)=>c<m?1:0);return new Ue(d,i.typeInfo)}return new st(o<s?1:0,this.getTypeInfo(\"bool\"));case\"==\":if(mn(o)&&mn(s)){let c=o,d=s;if(c.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let m=c.map((b,C)=>b===d[C]?1:0);return new Ue(m,r.typeInfo)}if(mn(o)){let c=s,d=o.map((m,b)=>m==c?1:0);return new Ue(d,r.typeInfo)}if(mn(s)){let c=o,d=s.map((m,b)=>c==m?1:0);return new Ue(d,i.typeInfo)}return new st(o===s?1:0,this.getTypeInfo(\"bool\"));case\"!=\":if(mn(o)&&mn(s)){let c=o,d=s;if(c.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let m=c.map((b,C)=>b!==d[C]?1:0);return new Ue(m,r.typeInfo)}if(mn(o)){let c=s,d=o.map((m,b)=>m!==c?1:0);return new Ue(d,r.typeInfo)}if(mn(s)){let c=o,d=s.map((m,b)=>c!==m?1:0);return new Ue(d,i.typeInfo)}return new st(o!==s?1:0,this.getTypeInfo(\"bool\"));case\">=\":if(mn(o)&&mn(s)){let c=o,d=s;if(c.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let m=c.map((b,C)=>b>=d[C]?1:0);return new Ue(m,r.typeInfo)}if(mn(o)){let c=s,d=o.map((m,b)=>m>=c?1:0);return new Ue(d,r.typeInfo)}if(mn(s)){let c=o,d=s.map((m,b)=>c>=m?1:0);return new Ue(d,i.typeInfo)}return new st(o>=s?1:0,this.getTypeInfo(\"bool\"));case\"<=\":if(mn(o)&&mn(s)){let c=o,d=s;if(c.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let m=c.map((b,C)=>b<=d[C]?1:0);return new Ue(m,r.typeInfo)}if(mn(o)){let c=s,d=o.map((m,b)=>m<=c?1:0);return new Ue(d,r.typeInfo)}if(mn(s)){let c=o,d=s.map((m,b)=>c<=m?1:0);return new Ue(d,i.typeInfo)}return new st(o<=s?1:0,this.getTypeInfo(\"bool\"));case\"&&\":if(mn(o)&&mn(s)){let c=o,d=s;if(c.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let m=c.map((b,C)=>b&&d[C]?1:0);return new Ue(m,r.typeInfo)}if(mn(o)){let c=s,d=o.map((m,b)=>m&&c?1:0);return new Ue(d,r.typeInfo)}if(mn(s)){let c=o,d=s.map((m,b)=>c&&m?1:0);return new Ue(d,i.typeInfo)}return new st(o&&s?1:0,this.getTypeInfo(\"bool\"));case\"||\":if(mn(o)&&mn(s)){let c=o,d=s;if(c.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let m=c.map((b,C)=>b||d[C]?1:0);return new Ue(m,r.typeInfo)}if(mn(o)){let c=s,d=o.map((m,b)=>m||c?1:0);return new Ue(d,r.typeInfo)}if(mn(s)){let c=o,d=s.map((m,b)=>c||m?1:0);return new Ue(d,i.typeInfo)}return new st(o||s?1:0,this.getTypeInfo(\"bool\"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,n){if(e.cachedReturnValue!==null)return e.cachedReturnValue;let r=n.clone();r.currentFunctionName=e.name;let i=n.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,r):this.getTypeInfo(e.name)?this._evalCreate(e,n):(console.error(`Unknown function \"${e.name}\". Line ${e.line}`),null);for(let o=0;o<i.node.args.length;++o){let s=i.node.args[o],c=this.evalExpression(e.args[o],r);r.createVariable(s.name,c,s)}return this._execStatements(i.node.body,r)}_callBuiltinFunction(e,n){switch(e.name){case\"all\":return this.builtins.All(e,n);case\"any\":return this.builtins.Any(e,n);case\"select\":return this.builtins.Select(e,n);case\"arrayLength\":return this.builtins.ArrayLength(e,n);case\"abs\":return this.builtins.Abs(e,n);case\"acos\":return this.builtins.Acos(e,n);case\"acosh\":return this.builtins.Acosh(e,n);case\"asin\":return this.builtins.Asin(e,n);case\"asinh\":return this.builtins.Asinh(e,n);case\"atan\":return this.builtins.Atan(e,n);case\"atanh\":return this.builtins.Atanh(e,n);case\"atan2\":return this.builtins.Atan2(e,n);case\"ceil\":return this.builtins.Ceil(e,n);case\"clamp\":return this.builtins.Clamp(e,n);case\"cos\":return this.builtins.Cos(e,n);case\"cosh\":return this.builtins.Cosh(e,n);case\"countLeadingZeros\":return this.builtins.CountLeadingZeros(e,n);case\"countOneBits\":return this.builtins.CountOneBits(e,n);case\"countTrailingZeros\":return this.builtins.CountTrailingZeros(e,n);case\"cross\":return this.builtins.Cross(e,n);case\"degrees\":return this.builtins.Degrees(e,n);case\"determinant\":return this.builtins.Determinant(e,n);case\"distance\":return this.builtins.Distance(e,n);case\"dot\":return this.builtins.Dot(e,n);case\"dot4U8Packed\":return this.builtins.Dot4U8Packed(e,n);case\"dot4I8Packed\":return this.builtins.Dot4I8Packed(e,n);case\"exp\":return this.builtins.Exp(e,n);case\"exp2\":return this.builtins.Exp2(e,n);case\"extractBits\":return this.builtins.ExtractBits(e,n);case\"faceForward\":return this.builtins.FaceForward(e,n);case\"firstLeadingBit\":return this.builtins.FirstLeadingBit(e,n);case\"firstTrailingBit\":return this.builtins.FirstTrailingBit(e,n);case\"floor\":return this.builtins.Floor(e,n);case\"fma\":return this.builtins.Fma(e,n);case\"fract\":return this.builtins.Fract(e,n);case\"frexp\":return this.builtins.Frexp(e,n);case\"insertBits\":return this.builtins.InsertBits(e,n);case\"inverseSqrt\":return this.builtins.InverseSqrt(e,n);case\"ldexp\":return this.builtins.Ldexp(e,n);case\"length\":return this.builtins.Length(e,n);case\"log\":return this.builtins.Log(e,n);case\"log2\":return this.builtins.Log2(e,n);case\"max\":return this.builtins.Max(e,n);case\"min\":return this.builtins.Min(e,n);case\"mix\":return this.builtins.Mix(e,n);case\"modf\":return this.builtins.Modf(e,n);case\"normalize\":return this.builtins.Normalize(e,n);case\"pow\":return this.builtins.Pow(e,n);case\"quantizeToF16\":return this.builtins.QuantizeToF16(e,n);case\"radians\":return this.builtins.Radians(e,n);case\"reflect\":return this.builtins.Reflect(e,n);case\"refract\":return this.builtins.Refract(e,n);case\"reverseBits\":return this.builtins.ReverseBits(e,n);case\"round\":return this.builtins.Round(e,n);case\"saturate\":return this.builtins.Saturate(e,n);case\"sign\":return this.builtins.Sign(e,n);case\"sin\":return this.builtins.Sin(e,n);case\"sinh\":return this.builtins.Sinh(e,n);case\"smoothstep\":return this.builtins.SmoothStep(e,n);case\"sqrt\":return this.builtins.Sqrt(e,n);case\"step\":return this.builtins.Step(e,n);case\"tan\":return this.builtins.Tan(e,n);case\"tanh\":return this.builtins.Tanh(e,n);case\"transpose\":return this.builtins.Transpose(e,n);case\"trunc\":return this.builtins.Trunc(e,n);case\"dpdx\":return this.builtins.Dpdx(e,n);case\"dpdxCoarse\":return this.builtins.DpdxCoarse(e,n);case\"dpdxFine\":return this.builtins.DpdxFine(e,n);case\"dpdy\":return this.builtins.Dpdy(e,n);case\"dpdyCoarse\":return this.builtins.DpdyCoarse(e,n);case\"dpdyFine\":return this.builtins.DpdyFine(e,n);case\"fwidth\":return this.builtins.Fwidth(e,n);case\"fwidthCoarse\":return this.builtins.FwidthCoarse(e,n);case\"fwidthFine\":return this.builtins.FwidthFine(e,n);case\"textureDimensions\":return this.builtins.TextureDimensions(e,n);case\"textureGather\":return this.builtins.TextureGather(e,n);case\"textureGatherCompare\":return this.builtins.TextureGatherCompare(e,n);case\"textureLoad\":return this.builtins.TextureLoad(e,n);case\"textureNumLayers\":return this.builtins.TextureNumLayers(e,n);case\"textureNumLevels\":return this.builtins.TextureNumLevels(e,n);case\"textureNumSamples\":return this.builtins.TextureNumSamples(e,n);case\"textureSample\":return this.builtins.TextureSample(e,n);case\"textureSampleBias\":return this.builtins.TextureSampleBias(e,n);case\"textureSampleCompare\":return this.builtins.TextureSampleCompare(e,n);case\"textureSampleCompareLevel\":return this.builtins.TextureSampleCompareLevel(e,n);case\"textureSampleGrad\":return this.builtins.TextureSampleGrad(e,n);case\"textureSampleLevel\":return this.builtins.TextureSampleLevel(e,n);case\"textureSampleBaseClampToEdge\":return this.builtins.TextureSampleBaseClampToEdge(e,n);case\"textureStore\":return this.builtins.TextureStore(e,n);case\"atomicLoad\":return this.builtins.AtomicLoad(e,n);case\"atomicStore\":return this.builtins.AtomicStore(e,n);case\"atomicAdd\":return this.builtins.AtomicAdd(e,n);case\"atomicSub\":return this.builtins.AtomicSub(e,n);case\"atomicMax\":return this.builtins.AtomicMax(e,n);case\"atomicMin\":return this.builtins.AtomicMin(e,n);case\"atomicAnd\":return this.builtins.AtomicAnd(e,n);case\"atomicOr\":return this.builtins.AtomicOr(e,n);case\"atomicXor\":return this.builtins.AtomicXor(e,n);case\"atomicExchange\":return this.builtins.AtomicExchange(e,n);case\"atomicCompareExchangeWeak\":return this.builtins.AtomicCompareExchangeWeak(e,n);case\"pack4x8snorm\":return this.builtins.Pack4x8snorm(e,n);case\"pack4x8unorm\":return this.builtins.Pack4x8unorm(e,n);case\"pack4xI8\":return this.builtins.Pack4xI8(e,n);case\"pack4xU8\":return this.builtins.Pack4xU8(e,n);case\"pack4x8Clamp\":return this.builtins.Pack4x8Clamp(e,n);case\"pack4xU8Clamp\":return this.builtins.Pack4xU8Clamp(e,n);case\"pack2x16snorm\":return this.builtins.Pack2x16snorm(e,n);case\"pack2x16unorm\":return this.builtins.Pack2x16unorm(e,n);case\"pack2x16float\":return this.builtins.Pack2x16float(e,n);case\"unpack4x8snorm\":return this.builtins.Unpack4x8snorm(e,n);case\"unpack4x8unorm\":return this.builtins.Unpack4x8unorm(e,n);case\"unpack4xI8\":return this.builtins.Unpack4xI8(e,n);case\"unpack4xU8\":return this.builtins.Unpack4xU8(e,n);case\"unpack2x16snorm\":return this.builtins.Unpack2x16snorm(e,n);case\"unpack2x16unorm\":return this.builtins.Unpack2x16unorm(e,n);case\"unpack2x16float\":return this.builtins.Unpack2x16float(e,n);case\"storageBarrier\":return this.builtins.StorageBarrier(e,n);case\"textureBarrier\":return this.builtins.TextureBarrier(e,n);case\"workgroupBarrier\":return this.builtins.WorkgroupBarrier(e,n);case\"workgroupUniformLoad\":return this.builtins.WorkgroupUniformLoad(e,n);case\"subgroupAdd\":return this.builtins.SubgroupAdd(e,n);case\"subgroupExclusiveAdd\":return this.builtins.SubgroupExclusiveAdd(e,n);case\"subgroupInclusiveAdd\":return this.builtins.SubgroupInclusiveAdd(e,n);case\"subgroupAll\":return this.builtins.SubgroupAll(e,n);case\"subgroupAnd\":return this.builtins.SubgroupAnd(e,n);case\"subgroupAny\":return this.builtins.SubgroupAny(e,n);case\"subgroupBallot\":return this.builtins.SubgroupBallot(e,n);case\"subgroupBroadcast\":return this.builtins.SubgroupBroadcast(e,n);case\"subgroupBroadcastFirst\":return this.builtins.SubgroupBroadcastFirst(e,n);case\"subgroupElect\":return this.builtins.SubgroupElect(e,n);case\"subgroupMax\":return this.builtins.SubgroupMax(e,n);case\"subgroupMin\":return this.builtins.SubgroupMin(e,n);case\"subgroupMul\":return this.builtins.SubgroupMul(e,n);case\"subgroupExclusiveMul\":return this.builtins.SubgroupExclusiveMul(e,n);case\"subgroupInclusiveMul\":return this.builtins.SubgroupInclusiveMul(e,n);case\"subgroupOr\":return this.builtins.SubgroupOr(e,n);case\"subgroupShuffle\":return this.builtins.SubgroupShuffle(e,n);case\"subgroupShuffleDown\":return this.builtins.SubgroupShuffleDown(e,n);case\"subgroupShuffleUp\":return this.builtins.SubgroupShuffleUp(e,n);case\"subgroupShuffleXor\":return this.builtins.SubgroupShuffleXor(e,n);case\"subgroupXor\":return this.builtins.SubgroupXor(e,n);case\"quadBroadcast\":return this.builtins.QuadBroadcast(e,n);case\"quadSwapDiagonal\":return this.builtins.QuadSwapDiagonal(e,n);case\"quadSwapX\":return this.builtins.QuadSwapX(e,n);case\"quadSwapY\":return this.builtins.QuadSwapY(e,n)}let r=n.getFunction(e.name);if(r){let i=n.clone();for(let o=0;o<r.node.args.length;++o){let s=r.node.args[o],c=this.evalExpression(e.args[o],i);i.setVariable(s.name,c,s)}return this._execStatements(r.node.body,i)}return null}_callConstructorValue(e,n){if(!e.args||e.args.length===0)return new st(0,this.getTypeInfo(e.type));let r=this.evalExpression(e.args[0],n);return r.typeInfo=this.getTypeInfo(e.type),r.getSubData(this,e.postfix,n).clone()}_callConstructorVec(e,n){let r=this.getTypeInfo(e.type),i=e.type.getTypeName(),o=JO[i];if(o===void 0)return console.error(`Invalid vec constructor ${i}. Line ${e.line}`),null;let s=[];if(e instanceof ms)if(e.isVector){let c=e.vectorValue;for(let d of c)s.push(d)}else s.push(e.scalarValue);else if(e.args)for(let c of e.args){let d=this.evalExpression(c,n);if(d instanceof Ue){let m=d.data;for(let b=0;b<m.length;++b){let C=m[b];s.push(C)}}else if(d instanceof st){let m=d.value;s.push(m)}}if(e.type instanceof ut&&e.type.format===null&&(e.type.format=ut.f32),s.length===0){let c=new Array(o).fill(0);return new Ue(c,r).getSubData(this,e.postfix,n)}if(s.length===1)for(;s.length<o;)s.push(s[0]);return s.length<o?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new Ue(s.length>o?s.slice(0,o):s,r).getSubData(this,e.postfix,n)}_callConstructorMatrix(e,n){let r=this.getTypeInfo(e.type),i=e.type.getTypeName(),o=Ql[i];if(o===void 0)return console.error(`Invalid matrix constructor ${i}. Line ${e.line}`),null;let s=[];if(e instanceof ms)if(e.isVector){let c=e.vectorValue;for(let d of c)s.push(d)}else s.push(e.scalarValue);else if(e.args)for(let c of e.args){let d=this.evalExpression(c,n);d instanceof Ue?s.push(...d.data):d instanceof st?s.push(d.value):d instanceof or&&s.push(...d.data)}if(r instanceof Cp&&r.format===null&&(r.format=this.getTypeInfo(\"f32\")),s.length===0){let c=new Array(o[2]).fill(0);return new or(c,r).getSubData(this,e.postfix,n)}return s.length!==o[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new or(s,r).getSubData(this,e.postfix,n)}};Cy._breakObj=new Yu(new vc(\"BREAK\",null),null),Cy._continueObj=new Yu(new vc(\"CONTINUE\",null),null),Cy._priority=new Map([[\"f32\",0],[\"f16\",1],[\"u32\",2],[\"i32\",3],[\"x32\",3]]);var m8=class{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}},_8=class{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new m8,this._exec=new Cy,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;let n=[];for(;!this._isAtEnd();){let r=this._global_decl_or_directive();if(!r)break;n.push(r)}if(this._deferArrayCountEval.length>0){for(let r of this._deferArrayCountEval){let i=r.arrayType,o=r.countNode;if(o instanceof Kl){let s=o.name,c=this._context.constants.get(s);if(c)try{let d=c.constEvaluate(this._exec);i.count=d}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(let r of n)r.search(i=>{i instanceof hM||i instanceof Ey?i.type=this._forwardType(i.type):i instanceof Om?i.format=this._forwardType(i.format):i instanceof Zh||i instanceof Lm||i instanceof Ty?i.type=this._forwardType(i.type):i instanceof km?i.returnType=this._forwardType(i.returnType):i instanceof uM&&(i.type=this._forwardType(i.type))});return n}_forwardType(e){if(e instanceof rM){let n=this._getType(e.name);if(n)return n}else e instanceof Ey?e.type=this._forwardType(e.type):e instanceof Om&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e==\"string\"){let n=new u8(e);this._tokens=n.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,n){return e.line=n??this._currentLine,e}_error(e,n){return{token:e,message:n,toString:()=>`${n}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==Re.eof}_match(e){if(e instanceof rt)return!!this._check(e)&&(this._advance(),!0);for(let n=0,r=e.length;n<r;++n){let i=e[n];if(this._check(i))return this._advance(),!0}return!1}_consume(e,n){if(this._check(e))return this._advance();throw this._error(this._peek(),`${n}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;let n=this._peek();if(e instanceof Array){let r=n.type,i=!1;for(let o of e){if(r===o)return!0;o===Re.tokens.name&&(i=!0)}if(i){let o=Re.tokens.name.rule.exec(n.lexeme);if(o&&o.index==0&&o[0]==n.lexeme)return!0}return!1}if(n.type===e)return!0;if(e===Re.tokens.name){let r=Re.tokens.name.rule.exec(n.lexeme);return r&&r.index==0&&r[0]==n.lexeme}return!1}_advance(){var e,n;return this._currentLine=(n=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&n!==void 0?n:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(Re.tokens.semicolon)&&!this._isAtEnd(););if(this._match(Re.keywords.alias)){let n=this._type_alias();return this._consume(Re.tokens.semicolon,\"Expected ';'\"),this._exec.reflection.updateAST([n]),n}if(this._match(Re.keywords.diagnostic)){let n=this._diagnostic();return this._consume(Re.tokens.semicolon,\"Expected ';'\"),this._exec.reflection.updateAST([n]),n}if(this._match(Re.keywords.requires)){let n=this._requires_directive();return this._consume(Re.tokens.semicolon,\"Expected ';'\"),this._exec.reflection.updateAST([n]),n}if(this._match(Re.keywords.enable)){let n=this._enable_directive();return this._consume(Re.tokens.semicolon,\"Expected ';'\"),this._exec.reflection.updateAST([n]),n}let e=this._attribute();if(this._check(Re.keywords.var)){let n=this._global_variable_decl();return n!=null&&(n.attributes=e),this._consume(Re.tokens.semicolon,\"Expected ';'.\"),this._exec.reflection.updateAST([n]),n}if(this._check(Re.keywords.override)){let n=this._override_variable_decl();return n!=null&&(n.attributes=e),this._consume(Re.tokens.semicolon,\"Expected ';'.\"),this._exec.reflection.updateAST([n]),n}if(this._check(Re.keywords.let)){let n=this._global_let_decl();return n!=null&&(n.attributes=e),this._consume(Re.tokens.semicolon,\"Expected ';'.\"),this._exec.reflection.updateAST([n]),n}if(this._check(Re.keywords.const)){let n=this._global_const_decl();return n!=null&&(n.attributes=e),this._consume(Re.tokens.semicolon,\"Expected ';'.\"),this._exec.reflection.updateAST([n]),n}if(this._check(Re.keywords.struct)){let n=this._struct_decl();return n!=null&&(n.attributes=e),this._exec.reflection.updateAST([n]),n}if(this._check(Re.keywords.fn)){let n=this._function_decl();return n!=null&&(n.attributes=e),this._exec.reflection.updateAST([n]),n}return null}_function_decl(){if(!this._match(Re.keywords.fn))return null;let e=this._currentLine,n=this._consume(Re.tokens.ident,\"Expected function name.\").toString();this._consume(Re.tokens.paren_left,\"Expected '(' for function arguments.\");let r=[];if(!this._check(Re.tokens.paren_right))do{if(this._check(Re.tokens.paren_right))break;let c=this._attribute(),d=this._consume(Re.tokens.name,\"Expected argument name.\").toString();this._consume(Re.tokens.colon,\"Expected ':' for argument type.\");let m=this._attribute(),b=this._type_decl();b!=null&&(b.attributes=m,r.push(this._updateNode(new uM(d,b,c))))}while(this._match(Re.tokens.comma));this._consume(Re.tokens.paren_right,\"Expected ')' after function arguments.\");let i=null;if(this._match(Re.tokens.arrow)){let c=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=c)}let o=this._compound_statement(),s=this._currentLine;return this._updateNode(new km(n,r,i,o,e,s),e)}_compound_statement(){let e=[];for(this._consume(Re.tokens.brace_left,\"Expected '{' for block.\");!this._check(Re.tokens.brace_right);){let n=this._statement();n!==null&&e.push(n)}return this._consume(Re.tokens.brace_right,\"Expected '}' for block.\"),e}_statement(){for(;this._match(Re.tokens.semicolon)&&!this._isAtEnd(););if(this._check(Re.tokens.attr)&&this._attribute(),this._check(Re.keywords.if))return this._if_statement();if(this._check(Re.keywords.switch))return this._switch_statement();if(this._check(Re.keywords.loop))return this._loop_statement();if(this._check(Re.keywords.for))return this._for_statement();if(this._check(Re.keywords.while))return this._while_statement();if(this._check(Re.keywords.continuing))return this._continuing_statement();if(this._check(Re.keywords.static_assert))return this._static_assert_statement();if(this._check(Re.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(Re.keywords.return))e=this._return_statement();else if(this._check([Re.keywords.var,Re.keywords.let,Re.keywords.const]))e=this._variable_statement();else if(this._match(Re.keywords.discard))e=this._updateNode(new l8);else if(this._match(Re.keywords.break)){let n=this._updateNode(new tM);if(this._currentLoop.length>0){let r=this._currentLoop[this._currentLoop.length-1];n.loopId=r.id}e=n,this._check(Re.keywords.if)&&(this._advance(),n.condition=this._optional_paren_expression())}else if(this._match(Re.keywords.continue)){let n=this._updateNode(new nM);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${n.line}`);{let r=this._currentLoop[this._currentLoop.length-1];n.loopId=r.id}e=n}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(Re.tokens.semicolon,\"Expected ';' after statement.\"),e}_static_assert_statement(){if(!this._match(Re.keywords.static_assert))return null;let e=this._currentLine,n=this._optional_paren_expression();return this._updateNode(new o8(n),e)}_while_statement(){if(!this._match(Re.keywords.while))return null;let e=this._updateNode(new XC(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(Re.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){let e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(Re.keywords.continuing))return null;let n=this._currentLine,r=this._compound_statement();return this._updateNode(new Db(r,e),n)}_for_statement(){if(!this._match(Re.keywords.for))return null;this._consume(Re.tokens.paren_left,\"Expected '('.\");let e=this._updateNode(new YC(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(Re.tokens.semicolon)?null:this._for_init(),this._consume(Re.tokens.semicolon,\"Expected ';'.\"),e.condition=this._check(Re.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(Re.tokens.semicolon,\"Expected ';'.\"),e.increment=this._check(Re.tokens.paren_right)?null:this._for_increment(),this._consume(Re.tokens.paren_right,\"Expected ')'.\"),this._check(Re.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(Re.keywords.var)){let e=this._variable_decl();if(e===null)throw this._error(this._peek(),\"Variable declaration expected.\");let n=null;return this._match(Re.tokens.equal)&&(n=this._short_circuit_or_expression()),this._updateNode(new Zh(e.name,e.type,e.storage,e.access,n),e.line)}if(this._match(Re.keywords.let)){let e=this._currentLine,n=this._consume(Re.tokens.name,\"Expected name for let.\").toString(),r=null;if(this._match(Re.tokens.colon)){let o=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=o)}this._consume(Re.tokens.equal,\"Expected '=' for let.\");let i=this._short_circuit_or_expression();return this._updateNode(new Lm(n,r,null,null,i),e)}if(this._match(Re.keywords.const)){let e=this._currentLine,n=this._consume(Re.tokens.name,\"Expected name for const.\").toString(),r=null;if(this._match(Re.tokens.colon)){let o=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=o)}this._consume(Re.tokens.equal,\"Expected '=' for const.\");let i=this._short_circuit_or_expression();return r===null&&i instanceof ms&&(r=i.type),this._updateNode(new Ty(n,r,null,null,i),e)}return null}_increment_decrement_statement(){let e=this._current,n=this._unary_expression();if(n==null)return null;if(!this._check(Re.increment_operators))return this._current=e,null;let r=this._consume(Re.increment_operators,\"Expected increment operator\");return this._updateNode(new ZC(r.type===Re.tokens.plus_plus?by.increment:by.decrement,n))}_assignment_statement(){let e=null,n=this._currentLine;if(this._check(Re.tokens.brace_right))return null;let r=this._match(Re.tokens.underscore);if(r||(e=this._unary_expression()),!r&&e==null)return null;let i=this._consume(Re.assignment_operators,\"Expected assignment operator.\"),o=this._short_circuit_or_expression();return this._updateNode(new qC(Rb.parse(i.lexeme),e,o),n)}_func_call_statement(){if(!this._check(Re.tokens.ident))return null;let e=this._currentLine,n=this._current,r=this._consume(Re.tokens.ident,\"Expected function name.\"),i=this._argument_expression_list();return i===null?(this._current=n,null):this._updateNode(new Ob(r.lexeme,i),e)}_loop_statement(){if(!this._match(Re.keywords.loop))return null;this._check(Re.tokens.attr)&&this._attribute(),this._consume(Re.tokens.brace_left,\"Expected '{' for loop.\");let e=this._updateNode(new QC([],null));this._currentLoop.push(e);let n=this._statement();for(;n!==null;){if(Array.isArray(n))for(let r of n)e.body.push(r);else e.body.push(n);if(n instanceof Db){e.continuing=n;break}n=this._statement()}return this._currentLoop.pop(),this._consume(Re.tokens.brace_right,\"Expected '}' for loop.\"),e}_switch_statement(){if(!this._match(Re.keywords.switch))return null;let e=this._updateNode(new KC(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(Re.tokens.attr)&&this._attribute(),this._consume(Re.tokens.brace_left,\"Expected '{' for switch.\"),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),\"Expected 'case' or 'default'.\");return this._consume(Re.tokens.brace_right,\"Expected '}' for switch.\"),this._currentLoop.pop(),e}_switch_body(){let e=[],n=!1;for(;this._check([Re.keywords.default,Re.keywords.case]);){if(this._match(Re.keywords.case)){let r=this._case_selectors();for(let o of r)if(o instanceof Sy){if(n)throw this._error(this._previous(),\"Multiple default cases in switch statement.\");n=!0;break}this._match(Re.tokens.colon),this._check(Re.tokens.attr)&&this._attribute(),this._consume(Re.tokens.brace_left,\"Exected '{' for switch case.\");let i=this._case_body();this._consume(Re.tokens.brace_right,\"Exected '}' for switch case.\"),e.push(this._updateNode(new lM(r,i)))}if(this._match(Re.keywords.default)){if(n)throw this._error(this._previous(),\"Multiple default cases in switch statement.\");this._match(Re.tokens.colon),this._check(Re.tokens.attr)&&this._attribute(),this._consume(Re.tokens.brace_left,\"Exected '{' for switch default.\");let r=this._case_body();this._consume(Re.tokens.brace_right,\"Exected '}' for switch default.\"),e.push(this._updateNode(new cM(r)))}}return e}_case_selectors(){let e=[];for(this._match(Re.keywords.default)?e.push(this._updateNode(new Sy)):e.push(this._shift_expression());this._match(Re.tokens.comma);)this._match(Re.keywords.default)?e.push(this._updateNode(new Sy)):e.push(this._shift_expression());return e}_case_body(){if(this._match(Re.keywords.fallthrough))return this._consume(Re.tokens.semicolon,\"Expected ';'\"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);let n=this._case_body();return n.length==0?e:[...e,n[0]]}_if_statement(){if(!this._match(Re.keywords.if))return null;let e=this._currentLine,n=this._optional_paren_expression();this._check(Re.tokens.attr)&&this._attribute();let r=this._compound_statement(),i=[];this._match_elseif()&&(this._check(Re.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let o=null;return this._match(Re.keywords.else)&&(this._check(Re.tokens.attr)&&this._attribute(),o=this._compound_statement()),this._updateNode(new JC(n,r,i,o),e)}_match_elseif(){return this._tokens[this._current].type===Re.keywords.else&&this._tokens[this._current+1].type===Re.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){let n=this._optional_paren_expression(),r=this._compound_statement();return e.push(this._updateNode(new c8(n,r))),this._match_elseif()&&(this._check(Re.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(Re.keywords.return))return null;let e=this._short_circuit_or_expression();return this._updateNode(new $C(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(Re.tokens.or_or);)e=this._updateNode(new nu(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(Re.tokens.and_and);)e=this._updateNode(new nu(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(Re.tokens.or);)e=this._updateNode(new nu(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(Re.tokens.xor);)e=this._updateNode(new nu(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(Re.tokens.and);)e=this._updateNode(new nu(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){let e=this._relational_expression();return this._match([Re.tokens.equal_equal,Re.tokens.not_equal])?this._updateNode(new nu(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([Re.tokens.less_than,Re.tokens.greater_than,Re.tokens.less_than_equal,Re.tokens.greater_than_equal]);)e=this._updateNode(new nu(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([Re.tokens.shift_left,Re.tokens.shift_right]);)e=this._updateNode(new nu(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([Re.tokens.plus,Re.tokens.minus]);)e=this._updateNode(new nu(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([Re.tokens.star,Re.tokens.forward_slash,Re.tokens.modulo]);)e=this._updateNode(new nu(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([Re.tokens.minus,Re.tokens.bang,Re.tokens.tilde,Re.tokens.star,Re.tokens.and])?this._updateNode(new as(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){let e=this._primary_expression(),n=this._postfix_expression();return n&&(e.postfix=n),e}_postfix_expression(){if(this._match(Re.tokens.bracket_left)){let e=this._short_circuit_or_expression();this._consume(Re.tokens.bracket_right,\"Expected ']'.\");let n=this._updateNode(new SA(e)),r=this._postfix_expression();return r&&(n.postfix=r),n}if(this._match(Re.tokens.period)){let e=this._consume(Re.tokens.name,\"Expected member name.\"),n=this._postfix_expression(),r=this._updateNode(new Mp(e.lexeme));return n&&(r.postfix=n),r}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){let n=this._getStruct(e);if(n!==null)return n;switch(e){case\"void\":return Wt.void;case\"bool\":return Wt.bool;case\"i32\":return Wt.i32;case\"u32\":return Wt.u32;case\"f32\":return Wt.f32;case\"f16\":return Wt.f16;case\"vec2f\":return ut.vec2f;case\"vec3f\":return ut.vec3f;case\"vec4f\":return ut.vec4f;case\"vec2i\":return ut.vec2i;case\"vec3i\":return ut.vec3i;case\"vec4i\":return ut.vec4i;case\"vec2u\":return ut.vec2u;case\"vec3u\":return ut.vec3u;case\"vec4u\":return ut.vec4u;case\"vec2h\":return ut.vec2h;case\"vec3h\":return ut.vec3h;case\"vec4h\":return ut.vec4h;case\"mat2x2f\":return ut.mat2x2f;case\"mat2x3f\":return ut.mat2x3f;case\"mat2x4f\":return ut.mat2x4f;case\"mat3x2f\":return ut.mat3x2f;case\"mat3x3f\":return ut.mat3x3f;case\"mat3x4f\":return ut.mat3x4f;case\"mat4x2f\":return ut.mat4x2f;case\"mat4x3f\":return ut.mat4x3f;case\"mat4x4f\":return ut.mat4x4f;case\"mat2x2h\":return ut.mat2x2h;case\"mat2x3h\":return ut.mat2x3h;case\"mat2x4h\":return ut.mat2x4h;case\"mat3x2h\":return ut.mat3x2h;case\"mat3x3h\":return ut.mat3x3h;case\"mat3x4h\":return ut.mat3x4h;case\"mat4x2h\":return ut.mat4x2h;case\"mat4x3h\":return ut.mat4x3h;case\"mat4x4h\":return ut.mat4x4h;case\"mat2x2i\":return ut.mat2x2i;case\"mat2x3i\":return ut.mat2x3i;case\"mat2x4i\":return ut.mat2x4i;case\"mat3x2i\":return ut.mat3x2i;case\"mat3x3i\":return ut.mat3x3i;case\"mat3x4i\":return ut.mat3x4i;case\"mat4x2i\":return ut.mat4x2i;case\"mat4x3i\":return ut.mat4x3i;case\"mat4x4i\":return ut.mat4x4i;case\"mat2x2u\":return ut.mat2x2u;case\"mat2x3u\":return ut.mat2x3u;case\"mat2x4u\":return ut.mat2x4u;case\"mat3x2u\":return ut.mat3x2u;case\"mat3x3u\":return ut.mat3x3u;case\"mat3x4u\":return ut.mat3x4u;case\"mat4x2u\":return ut.mat4x2u;case\"mat4x3u\":return ut.mat4x3u;case\"mat4x4u\":return ut.mat4x4u}return null}_validateTypeRange(e,n){if(n.name===\"i32\"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(n.name===\"u32\"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(Re.tokens.ident)){let r=this._previous().toString();if(this._check(Re.tokens.paren_left)){let i=this._argument_expression_list(),o=this._getType(r);return o!==null?this._updateNode(new ju(o,i)):this._updateNode(new kb(r,i))}if(this._context.constants.has(r)){let i=this._context.constants.get(r);return this._updateNode(new iM(r,i.value))}return this._updateNode(new Kl(r))}if(this._match(Re.tokens.int_literal)){let r=this._previous().toString(),i=r.endsWith(\"i\")||r.endsWith(\"i\")?Wt.i32:r.endsWith(\"u\")||r.endsWith(\"U\")?Wt.u32:Wt.x32,o=parseInt(r);return this._validateTypeRange(o,i),this._updateNode(new ms(new st(o,this._exec.getTypeInfo(i)),i))}if(this._match(Re.tokens.uint_literal)){let r=parseInt(this._previous().toString());return this._validateTypeRange(r,Wt.u32),this._updateNode(new ms(new st(r,this._exec.getTypeInfo(Wt.u32)),Wt.u32))}if(this._match([Re.tokens.decimal_float_literal,Re.tokens.hex_float_literal])){let r=this._previous().toString(),i=r.endsWith(\"h\");i&&(r=r.substring(0,r.length-1));let o=parseFloat(r);this._validateTypeRange(o,i?Wt.f16:Wt.f32);let s=i?Wt.f16:Wt.f32;return this._updateNode(new ms(new st(o,this._exec.getTypeInfo(s)),s))}if(this._match([Re.keywords.true,Re.keywords.false])){let r=this._previous().toString()===Re.keywords.true.rule;return this._updateNode(new ms(new st(r?1:0,this._exec.getTypeInfo(Wt.bool)),Wt.bool))}if(this._check(Re.tokens.paren_left))return this._paren_expression();if(this._match(Re.keywords.bitcast)){this._consume(Re.tokens.less_than,\"Expected '<'.\");let r=this._type_decl();this._consume(Re.tokens.greater_than,\"Expected '>'.\");let i=this._paren_expression();return this._updateNode(new oM(r,i))}let e=this._type_decl(),n=this._argument_expression_list();return this._updateNode(new ju(e,n))}_argument_expression_list(){if(!this._match(Re.tokens.paren_left))return null;let e=[];do{if(this._check(Re.tokens.paren_right))break;let n=this._short_circuit_or_expression();e.push(n)}while(this._match(Re.tokens.comma));return this._consume(Re.tokens.paren_right,\"Expected ')' for agument list\"),e}_optional_paren_expression(){this._match(Re.tokens.paren_left);let e=this._short_circuit_or_expression();return this._match(Re.tokens.paren_right),e}_paren_expression(){this._consume(Re.tokens.paren_left,\"Expected '('.\");let e=this._short_circuit_or_expression();return this._consume(Re.tokens.paren_right,\"Expected ')'.\"),e}_struct_decl(){if(!this._match(Re.keywords.struct))return null;let e=this._currentLine,n=this._consume(Re.tokens.ident,\"Expected name for struct.\").toString();this._consume(Re.tokens.brace_left,\"Expected '{' for struct body.\");let r=[];for(;!this._check(Re.tokens.brace_right);){let s=this._attribute(),c=this._consume(Re.tokens.name,\"Expected variable name.\").toString();this._consume(Re.tokens.colon,\"Expected ':' for struct member type.\");let d=this._attribute(),m=this._type_decl();m!=null&&(m.attributes=d),this._check(Re.tokens.brace_right)?this._match(Re.tokens.comma):this._consume(Re.tokens.comma,\"Expected ',' for struct member.\"),r.push(this._updateNode(new hM(c,m,s)))}this._consume(Re.tokens.brace_right,\"Expected '}' after struct body.\");let i=this._currentLine,o=this._updateNode(new Yh(n,r,e,i),e);return this._context.structs.set(n,o),o}_global_variable_decl(){let e=this._variable_decl();if(!e)return null;if(this._match(Re.tokens.equal)){let n=this._const_expression();e.value=n}if(e.type!==null&&e.value instanceof ms){if(e.value.type.name!==\"x32\"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof ms&&(e.type=e.value.type.name===\"x32\"?Wt.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){let e=this._override_decl();return e&&this._match(Re.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(Re.keywords.const))return null;let n=this._consume(Re.tokens.name,\"Expected variable name\"),r=this._currentLine,i=null;if(this._match(Re.tokens.colon)){let d=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=d)}let o=null;this._consume(Re.tokens.equal,\"const declarations require an assignment\");let s=this._short_circuit_or_expression();try{let d=[Wt.f32],m=s.constEvaluate(this._exec,d);m instanceof st&&this._validateTypeRange(m.value,d[0]),d[0]instanceof ut&&d[0].format===null&&m.typeInfo instanceof Cp&&m.typeInfo.format!==null&&(m.typeInfo.format.name===\"f16\"?d[0].format=Wt.f16:m.typeInfo.format.name===\"f32\"?d[0].format=Wt.f32:m.typeInfo.format.name===\"i32\"?d[0].format=Wt.i32:m.typeInfo.format.name===\"u32\"?d[0].format=Wt.u32:m.typeInfo.format.name===\"bool\"?d[0].format=Wt.bool:console.error(`TODO: impelement template format type ${m.typeInfo.format.name}`)),o=this._updateNode(new ms(m,d[0])),this._exec.context.setVariable(n.toString(),m)}catch{o=s}if(i!==null&&o instanceof ms){if(o.type.name!==\"x32\"&&i.getTypeName()!==o.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${o.type.name} to ${i.name}. Line:${this._currentLine}`);o.type=i,o.isScalar&&this._validateTypeRange(o.scalarValue,o.type)}else i===null&&o instanceof ms&&(i=(e=o?.type)!==null&&e!==void 0?e:Wt.f32,i===Wt.x32&&(i=Wt.i32));let c=this._updateNode(new Ty(n.toString(),i,\"\",\"\",o),r);return this._context.constants.set(c.name,c),c}_global_let_decl(){if(!this._match(Re.keywords.let))return null;let e=this._currentLine,n=this._consume(Re.tokens.name,\"Expected variable name\"),r=null;if(this._match(Re.tokens.colon)){let o=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=o)}let i=null;if(this._match(Re.tokens.equal)&&(i=this._const_expression()),r!==null&&i instanceof ms){if(i.type.name!==\"x32\"&&r.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${r.name}. Line:${this._currentLine}`);i.type=r}else r===null&&i instanceof ms&&(r=i.type.name===\"x32\"?Wt.i32:i.type);return i instanceof ms&&i.isScalar&&this._validateTypeRange(i.scalarValue,r),this._updateNode(new Lm(n.toString(),r,\"\",\"\",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(Re.keywords.var))return null;let e=this._currentLine,n=\"\",r=\"\";this._match(Re.tokens.less_than)&&(n=this._consume(Re.storage_class,\"Expected storage_class.\").toString(),this._match(Re.tokens.comma)&&(r=this._consume(Re.access_mode,\"Expected access_mode.\").toString()),this._consume(Re.tokens.greater_than,\"Expected '>'.\"));let i=this._consume(Re.tokens.name,\"Expected variable name\"),o=null;if(this._match(Re.tokens.colon)){let s=this._attribute();o=this._type_decl(),o!=null&&(o.attributes=s)}return this._updateNode(new Zh(i.toString(),o,n,r,null),e)}_override_decl(){if(!this._match(Re.keywords.override))return null;let e=this._consume(Re.tokens.name,\"Expected variable name\"),n=null;if(this._match(Re.tokens.colon)){let r=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=r)}return this._updateNode(new Lb(e.toString(),n,null))}_diagnostic(){this._consume(Re.tokens.paren_left,\"Expected '('\");let e=this._consume(Re.tokens.ident,\"Expected severity control name.\");this._consume(Re.tokens.comma,\"Expected ','\");let n=this._consume(Re.tokens.ident,\"Expected diagnostic rule name.\").toString();return this._match(Re.tokens.period)&&(n+=`.${this._consume(Re.tokens.ident,\"Expected diagnostic message.\").toString()}`),this._consume(Re.tokens.paren_right,\"Expected ')'\"),this._updateNode(new eM(e.toString(),n))}_enable_directive(){let e=this._consume(Re.tokens.ident,\"identity expected.\");return this._updateNode(new s8(e.toString()))}_requires_directive(){let e=[this._consume(Re.tokens.ident,\"identity expected.\").toString()];for(;this._match(Re.tokens.comma);){let n=this._consume(Re.tokens.ident,\"identity expected.\");e.push(n.toString())}return this._updateNode(new a8(e))}_type_alias(){let e=this._consume(Re.tokens.ident,\"identity expected.\");this._consume(Re.tokens.equal,\"Expected '=' for type alias.\");let n=this._type_decl();if(n===null)throw this._error(this._peek(),\"Expected Type for Alias.\");this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);let r=this._updateNode(new Fb(e.toString(),n));return this._context.aliases.set(r.name,r),r}_type_decl(){if(this._check([Re.tokens.ident,...Re.texel_format,Re.keywords.bool,Re.keywords.f32,Re.keywords.i32,Re.keywords.u32])){let r=this._advance().toString();if(this._context.structs.has(r))return this._context.structs.get(r);if(this._context.aliases.has(r))return this._context.aliases.get(r).type;if(!this._getType(r)){let i=this._updateNode(new rM(r));return this._forwardTypeCount++,i}return this._updateNode(new Wt(r))}let e=this._texture_sampler_types();if(e)return e;if(this._check(Re.template_types)){let r=this._advance().toString(),i=null,o=null;return this._match(Re.tokens.less_than)&&(i=this._type_decl(),o=null,this._match(Re.tokens.comma)&&(o=this._consume(Re.access_mode,\"Expected access_mode for pointer\").toString()),this._consume(Re.tokens.greater_than,\"Expected '>' for type.\")),this._updateNode(new ut(r,i,o))}if(this._match(Re.keywords.ptr)){let r=this._previous().toString();this._consume(Re.tokens.less_than,\"Expected '<' for pointer.\");let i=this._consume(Re.storage_class,\"Expected storage_class for pointer\");this._consume(Re.tokens.comma,\"Expected ',' for pointer.\");let o=this._type_decl(),s=null;return this._match(Re.tokens.comma)&&(s=this._consume(Re.access_mode,\"Expected access_mode for pointer\").toString()),this._consume(Re.tokens.greater_than,\"Expected '>' for pointer.\"),this._updateNode(new Ey(r,i.toString(),o,s))}let n=this._attribute();if(this._match(Re.keywords.array)){let r=null,i=-1,o=this._previous(),s=null;if(this._match(Re.tokens.less_than)){r=this._type_decl(),this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let d=\"\";if(this._match(Re.tokens.comma)){s=this._shift_expression();try{d=s.constEvaluate(this._exec).toString(),s=null}catch{d=\"1\"}}this._consume(Re.tokens.greater_than,\"Expected '>' for array.\"),i=d?parseInt(d):0}let c=this._updateNode(new Om(o.toString(),n,r,i));return s&&this._deferArrayCountEval.push({arrayType:c,countNode:s}),c}return null}_texture_sampler_types(){if(this._match(Re.sampler_type))return this._updateNode(new Dm(this._previous().toString(),null,null));if(this._match(Re.depth_texture_type))return this._updateNode(new Dm(this._previous().toString(),null,null));if(this._match(Re.sampled_texture_type)||this._match(Re.multisampled_texture_type)){let e=this._previous();this._consume(Re.tokens.less_than,\"Expected '<' for sampler type.\");let n=this._type_decl();return this._consume(Re.tokens.greater_than,\"Expected '>' for sampler type.\"),this._updateNode(new Dm(e.toString(),n,null))}if(this._match(Re.storage_texture_type)){let e=this._previous();this._consume(Re.tokens.less_than,\"Expected '<' for sampler type.\");let n=this._consume(Re.texel_format,\"Invalid texel format.\").toString();this._consume(Re.tokens.comma,\"Expected ',' after texel format.\");let r=this._consume(Re.access_mode,\"Expected access mode for storage texture type.\").toString();return this._consume(Re.tokens.greater_than,\"Expected '>' for sampler type.\"),this._updateNode(new Dm(e.toString(),n,r))}return null}_attribute(){let e=[];for(;this._match(Re.tokens.attr);){let n=this._consume(Re.attribute_name,\"Expected attribute name\"),r=this._updateNode(new fM(n.toString(),null));if(this._match(Re.tokens.paren_left)){if(r.value=this._consume(Re.literal_or_ident,\"Expected attribute value\").toString(),this._check(Re.tokens.comma)){this._advance();do{let i=this._consume(Re.literal_or_ident,\"Expected attribute value\").toString();r.value instanceof Array||(r.value=[r.value]),r.value.push(i)}while(this._match(Re.tokens.comma))}this._consume(Re.tokens.paren_right,\"Expected ')'\")}e.push(r)}return e.length==0?null:e}},mM=class extends Fm{constructor(e){super(),e&&this.update(e)}update(e){let n=new _8().parse(e);this.updateAST(n)}};function v8(t){let e={attributes:[],bindings:[]},n;try{n=R_e(t)}catch(o){return St.error(o.message)(),e}for(let o of n.uniforms){let s=[];for(let c of o.type?.members||[])s.push({name:c.name,type:Eq(c.type)});e.bindings.push({type:\"uniform\",name:o.name,group:o.group,location:o.binding,members:s})}for(let o of n.textures)e.bindings.push({type:\"texture\",name:o.name,group:o.group,location:o.binding});for(let o of n.samplers)e.bindings.push({type:\"sampler\",name:o.name,group:o.group,location:o.binding});let r=n.entry.vertex[0],i=r?.inputs.length||0;for(let o=0;o<i;o++){let s=r.inputs[o];if(s.locationType===\"location\"){let c=Eq(s.type);e.attributes.push({name:s.name,location:Number(s.location),type:c})}}return e}function Eq(t){return t?.format?`${t.name}<${t.format.name}>`:t.name}function R_e(t){try{return new mM(t)}catch(e){if(e instanceof Error)throw e;let n=\"WGSL parse error\";throw typeof e==\"object\"&&e?.message&&(n+=`: ${e.message} `),typeof e==\"object\"&&e?.token&&(n+=e.token.line||\"\"),new Error(n,{cause:e})}}var B_e=1/Math.PI*180,D_e=1/180*Math.PI,L_e={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...L_e}};var oo=globalThis.mathgl.config;function b8(t,{precision:e=oo.precision}={}){return t=O_e(t),`${parseFloat(t.toPrecision(e))}`}function iu(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function w8(t){return Sq(t)}function T8(t){return ou(t)}function Sq(t,e){return E8(t,n=>n*D_e,e)}function ou(t,e){return E8(t,n=>n*B_e,e)}function Jl(t,e,n){return E8(t,r=>Math.max(e,Math.min(n,r)))}function Xa(t,e,n){return iu(t)?t.map((r,i)=>Xa(r,e[i],n)):n*e+(1-n)*t}function Gs(t,e,n){let r=oo.EPSILON;n&&(oo.EPSILON=n);try{if(t===e)return!0;if(iu(t)&&iu(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Gs(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t==\"number\"&&typeof e==\"number\"?Math.abs(t-e)<=oo.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{oo.EPSILON=r}}function O_e(t){return Math.round(t/oo.EPSILON)*oo.EPSILON}function F_e(t){return t.clone?t.clone():new Array(t.length)}function E8(t,e,n){if(iu(t)){let r=t;n=n||F_e(r);for(let i=0;i<n.length&&i<r.length;++i){let o=typeof t==\"number\"?t:t[i];n[i]=e(o,i,n)}return n}return e(t)}var CA=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:iu(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(oo)}formatString(e){let n=\"\";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?\", \":\"\")+b8(this[r],e);return`${e.printTypes?this.constructor.name:\"\"}[${n}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Gs(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){let o=e[i],s=typeof n==\"number\"?n:n[i];this[i]=o+r*(s-o)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(let n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(let n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e==\"number\")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(oo.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}};function k_e(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Gr(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function MA(t,e,n=\"\"){if(oo.debug&&!k_e(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}function ba(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}var IA=class extends CA{get x(){return this[0]}set x(e){this[0]=Gr(e)}get y(){return this[1]}set y(e){this[1]=Gr(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){let i=this[r]-e[r];n+=i*i}return Gr(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Gr(n)}normalize(){let e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(let n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(let n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return ba(e>=0&&e<this.ELEMENTS,\"index is out of range\"),Gr(this[e])}setComponent(e,n){return ba(e>=0&&e<this.ELEMENTS,\"index is out of range\"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}};var Jf={};Aa(Jf,{add:()=>G_e,angle:()=>i1e,ceil:()=>H_e,clone:()=>N_e,copy:()=>U_e,create:()=>Cq,cross:()=>e1e,dist:()=>d1e,distance:()=>Rq,div:()=>f1e,divide:()=>Pq,dot:()=>$_e,equals:()=>l1e,exactEquals:()=>a1e,floor:()=>W_e,forEach:()=>g1e,fromValues:()=>z_e,inverse:()=>K_e,len:()=>c1e,length:()=>Dq,lerp:()=>t1e,max:()=>X_e,min:()=>j_e,mul:()=>h1e,multiply:()=>Iq,negate:()=>Q_e,normalize:()=>J_e,random:()=>n1e,rotate:()=>r1e,round:()=>Y_e,scale:()=>Z_e,scaleAndAdd:()=>q_e,set:()=>V_e,sqrDist:()=>p1e,sqrLen:()=>A1e,squaredDistance:()=>Bq,squaredLength:()=>Lq,str:()=>s1e,sub:()=>u1e,subtract:()=>Mq,transformMat2:()=>S8,transformMat2d:()=>C8,transformMat3:()=>zb,transformMat4:()=>Ub,zero:()=>o1e});var Ji=typeof Float32Array<\"u\"?Float32Array:Array,Kf=Math.random;function Zu(t){return t>=0?Math.round(t):t%.5===0?Math.floor(t):Math.round(t)}var aGe=Math.PI/180;function Cq(){let t=new Ji(2);return Ji!=Float32Array&&(t[0]=0,t[1]=0),t}function N_e(t){let e=new Ji(2);return e[0]=t[0],e[1]=t[1],e}function z_e(t,e){let n=new Ji(2);return n[0]=t,n[1]=e,n}function U_e(t,e){return t[0]=e[0],t[1]=e[1],t}function V_e(t,e,n){return t[0]=e,t[1]=n,t}function G_e(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Mq(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Iq(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function Pq(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function H_e(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function W_e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function j_e(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function X_e(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function Y_e(t,e){return t[0]=Zu(e[0]),t[1]=Zu(e[1]),t}function Z_e(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function q_e(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function Rq(t,e){let n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function Bq(t,e){let n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function Dq(t){let e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function Lq(t){let e=t[0],n=t[1];return e*e+n*n}function Q_e(t,e){return t[0]=-e[0],t[1]=-e[1],t}function K_e(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function J_e(t,e){let n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function $_e(t,e){return t[0]*e[0]+t[1]*e[1]}function e1e(t,e,n){let r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function t1e(t,e,n,r){let i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function n1e(t,e){e=e===void 0?1:e;let n=Kf()*2*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function S8(t,e,n){let r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function C8(t,e,n){let r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function zb(t,e,n){let r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function Ub(t,e,n){let r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function r1e(t,e,n,r){let i=e[0]-n[0],o=e[1]-n[1],s=Math.sin(r),c=Math.cos(r);return t[0]=i*c-o*s+n[0],t[1]=i*s+o*c+n[1],t}function i1e(t,e){let n=t[0],r=t[1],i=e[0],o=e[1],s=Math.sqrt((n*n+r*r)*(i*i+o*o)),c=s&&(n*i+r*o)/s;return Math.acos(Math.min(Math.max(c,-1),1))}function o1e(t){return t[0]=0,t[1]=0,t}function s1e(t){return`vec2(${t[0]}, ${t[1]})`}function a1e(t,e){return t[0]===e[0]&&t[1]===e[1]}function l1e(t,e){let n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=1e-6*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=1e-6*Math.max(1,Math.abs(r),Math.abs(o))}var c1e=Dq,u1e=Mq,h1e=Iq,f1e=Pq,d1e=Rq,p1e=Bq,A1e=Lq,g1e=(function(){let t=Cq();return function(e,n,r,i,o,s){let c,d;for(n||(n=2),r||(r=0),i?d=Math.min(i*n+r,e.length):d=e.length,c=r;c<d;c+=n)t[0]=e[c],t[1]=e[c+1],o(t,t,s),e[c]=t[0],e[c+1]=t[1];return e}})();function _M(t,e,n){let r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function yM(t,e,n){let r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/s,t[1]=(n[1]*r+n[5]*i+n[9]*o)/s,t[2]=(n[2]*r+n[6]*i+n[10]*o)/s,t}function Oq(t,e,n){let r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function Fq(t,e,n){let r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function xM(t,e,n){let r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*o,t[1]=n[1]*r+n[4]*i+n[7]*o,t[2]=n[2]*r+n[5]*i+n[8]*o,t[3]=e[3],t}var Nm=class extends IA{constructor(e=0,n=0){super(2),iu(e)&&arguments.length===1?this.copy(e):(oo.debug&&(Gr(e),Gr(n)),this[0]=e,this[1]=n)}set(e,n){return this[0]=e,this[1]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return oo.debug&&(Gr(e.x),Gr(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Ub(this,this,e),this.check()}transformAsVector(e){return _M(this,this,e),this.check()}transformByMatrix3(e){return zb(this,this,e),this.check()}transformByMatrix2x3(e){return C8(this,this,e),this.check()}transformByMatrix2(e){return S8(this,this,e),this.check()}};var Ya={};Aa(Ya,{add:()=>x1e,angle:()=>B8,bezier:()=>D1e,ceil:()=>v1e,clone:()=>m1e,copy:()=>_1e,create:()=>vM,cross:()=>zm,dist:()=>G1e,distance:()=>Vq,div:()=>V1e,divide:()=>Uq,dot:()=>Vb,equals:()=>N1e,exactEquals:()=>k1e,floor:()=>b1e,forEach:()=>j1e,fromValues:()=>bM,hermite:()=>B1e,inverse:()=>I1e,len:()=>D8,length:()=>kq,lerp:()=>P1e,max:()=>T1e,min:()=>w1e,mul:()=>U1e,multiply:()=>zq,negate:()=>M1e,normalize:()=>M8,random:()=>L1e,rotateX:()=>I8,rotateY:()=>P8,rotateZ:()=>R8,round:()=>E1e,scale:()=>S1e,scaleAndAdd:()=>C1e,set:()=>y1e,slerp:()=>R1e,sqrDist:()=>H1e,sqrLen:()=>W1e,squaredDistance:()=>Gq,squaredLength:()=>Hq,str:()=>F1e,sub:()=>z1e,subtract:()=>Nq,transformMat3:()=>Gb,transformMat4:()=>Um,transformQuat:()=>Hb,zero:()=>O1e});function vM(){let t=new Ji(3);return Ji!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function m1e(t){let e=new Ji(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function kq(t){let e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function bM(t,e,n){let r=new Ji(3);return r[0]=t,r[1]=e,r[2]=n,r}function _1e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function y1e(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function x1e(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Nq(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function zq(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Uq(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function v1e(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function b1e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function w1e(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function T1e(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function E1e(t,e){return t[0]=Zu(e[0]),t[1]=Zu(e[1]),t[2]=Zu(e[2]),t}function S1e(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function C1e(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Vq(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function Gq(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function Hq(t){let e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function M1e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function I1e(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function M8(t,e){let n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function Vb(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function zm(t,e,n){let r=e[0],i=e[1],o=e[2],s=n[0],c=n[1],d=n[2];return t[0]=i*d-o*c,t[1]=o*s-r*d,t[2]=r*c-i*s,t}function P1e(t,e,n,r){let i=e[0],o=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t}function R1e(t,e,n,r){let i=Math.acos(Math.min(Math.max(Vb(e,n),-1),1)),o=Math.sin(i),s=Math.sin((1-r)*i)/o,c=Math.sin(r*i)/o;return t[0]=s*e[0]+c*n[0],t[1]=s*e[1]+c*n[1],t[2]=s*e[2]+c*n[2],t}function B1e(t,e,n,r,i,o){let s=o*o,c=s*(2*o-3)+1,d=s*(o-2)+o,m=s*(o-1),b=s*(3-2*o);return t[0]=e[0]*c+n[0]*d+r[0]*m+i[0]*b,t[1]=e[1]*c+n[1]*d+r[1]*m+i[1]*b,t[2]=e[2]*c+n[2]*d+r[2]*m+i[2]*b,t}function D1e(t,e,n,r,i,o){let s=1-o,c=s*s,d=o*o,m=c*s,b=3*o*c,C=3*d*s,B=d*o;return t[0]=e[0]*m+n[0]*b+r[0]*C+i[0]*B,t[1]=e[1]*m+n[1]*b+r[1]*C+i[1]*B,t[2]=e[2]*m+n[2]*b+r[2]*C+i[2]*B,t}function L1e(t,e){e=e===void 0?1:e;let n=Kf()*2*Math.PI,r=Kf()*2-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function Um(t,e,n){let r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t}function Gb(t,e,n){let r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function Hb(t,e,n){let r=n[0],i=n[1],o=n[2],s=n[3],c=e[0],d=e[1],m=e[2],b=i*m-o*d,C=o*c-r*m,B=r*d-i*c,k=i*B-o*C,V=o*b-r*B,q=r*C-i*b,K=s*2;return b*=K,C*=K,B*=K,k*=2,V*=2,q*=2,t[0]=c+b+k,t[1]=d+C+V,t[2]=m+B+q,t}function I8(t,e,n,r){let i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function P8(t,e,n,r){let i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function R8(t,e,n,r){let i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function B8(t,e){let n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],c=e[2],d=Math.sqrt((n*n+r*r+i*i)*(o*o+s*s+c*c)),m=d&&Vb(t,e)/d;return Math.acos(Math.min(Math.max(m,-1),1))}function O1e(t){return t[0]=0,t[1]=0,t[2]=0,t}function F1e(t){return`vec3(${t[0]}, ${t[1]}, ${t[2]})`}function k1e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function N1e(t,e){let n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],c=e[2];return Math.abs(n-o)<=1e-6*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=1e-6*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-c)<=1e-6*Math.max(1,Math.abs(i),Math.abs(c))}var z1e=Nq,U1e=zq,V1e=Uq,G1e=Vq,H1e=Gq,D8=kq,W1e=Hq,j1e=(function(){let t=vM();return function(e,n,r,i,o,s){let c,d;for(n||(n=3),r||(r=0),i?d=Math.min(i*n+r,e.length):d=e.length,c=r;c<d;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],o(t,t,s),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2];return e}})();var L8=[0,0,0],wM,$e=class t extends IA{static get ZERO(){return wM||(wM=new t(0,0,0),Object.freeze(wM)),wM}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&iu(e)?this.copy(e):(oo.debug&&(Gr(e),Gr(n),Gr(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return oo.debug&&(Gr(e.x),Gr(e.y),Gr(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Gr(e)}angle(e){return B8(this,e)}cross(e){return zm(this,this,e),this.check()}rotateX({radians:e,origin:n=L8}){return I8(this,this,n,e),this.check()}rotateY({radians:e,origin:n=L8}){return P8(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=L8}){return R8(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Um(this,this,e),this.check()}transformAsVector(e){return yM(this,this,e),this.check()}transformByMatrix3(e){return Gb(this,this,e),this.check()}transformByMatrix2(e){return Oq(this,this,e),this.check()}transformByQuaternion(e){return Hb(this,this,e),this.check()}};var TM,EM=class t extends IA{static get ZERO(){return TM||(TM=new t(0,0,0,0),Object.freeze(TM)),TM}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),iu(e)&&arguments.length===1?this.copy(e):(oo.debug&&(Gr(e),Gr(n),Gr(r),Gr(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return oo.debug&&(Gr(e.x),Gr(e.y),Gr(e.z),Gr(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Gr(e)}get w(){return this[3]}set w(e){this[3]=Gr(e)}transform(e){return Um(this,this,e),this.check()}transformByMatrix3(e){return xM(this,this,e),this.check()}transformByMatrix2(e){return Fq(this,this,e),this.check()}transformByQuaternion(e){return Hb(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}};var Ry=class extends CA{toString(){let e=\"[\";if(oo.printRowMajor){e+=\"row-major:\";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+n]}`}else{e+=\"column-major:\";for(let n=0;n<this.ELEMENTS;++n)e+=` ${this[n]}`}return e+=\"]\",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Gr(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){let r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){let r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}};function Wq(){let t=new Ji(9);return Ji!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function jq(t,e){if(t===e){let n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Xq(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],c=e[5],d=e[6],m=e[7],b=e[8],C=b*s-c*m,B=-b*o+c*d,k=m*o-s*d,V=n*C+r*B+i*k;return V?(V=1/V,t[0]=C*V,t[1]=(-b*r+i*m)*V,t[2]=(c*r-i*s)*V,t[3]=B*V,t[4]=(b*n-i*d)*V,t[5]=(-c*n+i*o)*V,t[6]=k*V,t[7]=(-m*n+r*d)*V,t[8]=(s*n-r*o)*V,t):null}function Yq(t){let e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],c=t[6],d=t[7],m=t[8];return e*(m*o-s*d)+n*(-m*i+s*c)+r*(d*i-o*c)}function O8(t,e,n){let r=e[0],i=e[1],o=e[2],s=e[3],c=e[4],d=e[5],m=e[6],b=e[7],C=e[8],B=n[0],k=n[1],V=n[2],q=n[3],K=n[4],Y=n[5],ee=n[6],J=n[7],se=n[8];return t[0]=B*r+k*s+V*m,t[1]=B*i+k*c+V*b,t[2]=B*o+k*d+V*C,t[3]=q*r+K*s+Y*m,t[4]=q*i+K*c+Y*b,t[5]=q*o+K*d+Y*C,t[6]=ee*r+J*s+se*m,t[7]=ee*i+J*c+se*b,t[8]=ee*o+J*d+se*C,t}function Zq(t,e,n){let r=e[0],i=e[1],o=e[2],s=e[3],c=e[4],d=e[5],m=e[6],b=e[7],C=e[8],B=n[0],k=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=c,t[5]=d,t[6]=B*r+k*s+m,t[7]=B*i+k*c+b,t[8]=B*o+k*d+C,t}function qq(t,e,n){let r=e[0],i=e[1],o=e[2],s=e[3],c=e[4],d=e[5],m=e[6],b=e[7],C=e[8],B=Math.sin(n),k=Math.cos(n);return t[0]=k*r+B*s,t[1]=k*i+B*c,t[2]=k*o+B*d,t[3]=k*s-B*r,t[4]=k*c-B*i,t[5]=k*d-B*o,t[6]=m,t[7]=b,t[8]=C,t}function F8(t,e,n){let r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Qq(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,c=r+r,d=i+i,m=n*s,b=r*s,C=r*c,B=i*s,k=i*c,V=i*d,q=o*s,K=o*c,Y=o*d;return t[0]=1-C-V,t[3]=b-Y,t[6]=B+K,t[1]=b+Y,t[4]=1-m-V,t[7]=k-q,t[2]=B-K,t[5]=k+q,t[8]=1-m-C,t}var k8;(function(t){t[t.COL0ROW0=0]=\"COL0ROW0\",t[t.COL0ROW1=1]=\"COL0ROW1\",t[t.COL0ROW2=2]=\"COL0ROW2\",t[t.COL1ROW0=3]=\"COL1ROW0\",t[t.COL1ROW1=4]=\"COL1ROW1\",t[t.COL1ROW2=5]=\"COL1ROW2\",t[t.COL2ROW0=6]=\"COL2ROW0\",t[t.COL2ROW1=7]=\"COL2ROW1\",t[t.COL2ROW2=8]=\"COL2ROW2\"})(k8||(k8={}));var X1e=Object.freeze([1,0,0,0,1,0,0,0,1]),Mi=class extends Ry{static get IDENTITY(){return Z1e()}static get ZERO(){return Y1e()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return k8}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(X1e)}fromObject(e){return this.check()}fromQuaternion(e){return Qq(this,e),this.check()}set(e,n,r,i,o,s,c,d,m){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=d,this[8]=m,this.check()}setRowMajor(e,n,r,i,o,s,c,d,m){return this[0]=e,this[1]=i,this[2]=c,this[3]=n,this[4]=o,this[5]=d,this[6]=r,this[7]=s,this[8]=m,this.check()}determinant(){return Yq(this)}transpose(){return jq(this,this),this.check()}invert(){return Xq(this,this),this.check()}multiplyLeft(e){return O8(this,e,this),this.check()}multiplyRight(e){return O8(this,this,e),this.check()}rotate(e){return qq(this,this,e),this.check()}scale(e){return Array.isArray(e)?F8(this,this,e):F8(this,this,[e,e]),this.check()}translate(e){return Zq(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=zb(n||[-0,-0],e,this);break;case 3:r=Gb(n||[-0,-0,-0],e,this);break;case 4:r=xM(n||[-0,-0,-0,-0],e,this);break;default:throw new Error(\"Illegal vector\")}return MA(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}},SM,CM=null;function Y1e(){return SM||(SM=new Mi([0,0,0,0,0,0,0,0,0]),Object.freeze(SM)),SM}function Z1e(){return CM||(CM=new Mi,Object.freeze(CM)),CM}var _s={};Aa(_s,{add:()=>yye,adjoint:()=>eye,clone:()=>Q1e,copy:()=>K1e,create:()=>q1e,decompose:()=>uye,determinant:()=>U8,equals:()=>wye,exactEquals:()=>bye,frob:()=>_ye,fromQuat:()=>Y8,fromQuat2:()=>aye,fromRotation:()=>rye,fromRotationTranslation:()=>$q,fromRotationTranslationScale:()=>hye,fromRotationTranslationScaleOrigin:()=>fye,fromScaling:()=>nye,fromTranslation:()=>tye,fromValues:()=>J1e,fromXRotation:()=>iye,fromYRotation:()=>oye,fromZRotation:()=>sye,frustum:()=>Z8,getRotation:()=>cye,getScaling:()=>eQ,getTranslation:()=>lye,identity:()=>Jq,invert:()=>z8,lookAt:()=>K8,mul:()=>Tye,multiply:()=>Wb,multiplyScalar:()=>xye,multiplyScalarAndAdd:()=>vye,ortho:()=>Q8,orthoNO:()=>nQ,orthoZO:()=>Aye,perspective:()=>q8,perspectiveFromFieldOfView:()=>pye,perspectiveNO:()=>tQ,perspectiveZO:()=>dye,rotate:()=>H8,rotateX:()=>W8,rotateY:()=>j8,rotateZ:()=>X8,scale:()=>G8,set:()=>$1e,str:()=>mye,sub:()=>Eye,subtract:()=>rQ,targetTo:()=>gye,translate:()=>V8,transpose:()=>N8});function q1e(){let t=new Ji(16);return Ji!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Q1e(t){let e=new Ji(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function K1e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function J1e(t,e,n,r,i,o,s,c,d,m,b,C,B,k,V,q){let K=new Ji(16);return K[0]=t,K[1]=e,K[2]=n,K[3]=r,K[4]=i,K[5]=o,K[6]=s,K[7]=c,K[8]=d,K[9]=m,K[10]=b,K[11]=C,K[12]=B,K[13]=k,K[14]=V,K[15]=q,K}function $1e(t,e,n,r,i,o,s,c,d,m,b,C,B,k,V,q,K){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=c,t[7]=d,t[8]=m,t[9]=b,t[10]=C,t[11]=B,t[12]=k,t[13]=V,t[14]=q,t[15]=K,t}function Jq(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N8(t,e){if(t===e){let n=e[1],r=e[2],i=e[3],o=e[6],s=e[7],c=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=c}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function z8(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],c=e[5],d=e[6],m=e[7],b=e[8],C=e[9],B=e[10],k=e[11],V=e[12],q=e[13],K=e[14],Y=e[15],ee=n*c-r*s,J=n*d-i*s,se=n*m-o*s,xe=r*d-i*c,Ee=r*m-o*c,Xe=i*m-o*d,Ne=b*q-C*V,be=b*K-B*V,ge=b*Y-k*V,Qe=C*K-B*q,Ct=C*Y-k*q,Mt=B*Y-k*K,mt=ee*Mt-J*Ct+se*Qe+xe*ge-Ee*be+Xe*Ne;return mt?(mt=1/mt,t[0]=(c*Mt-d*Ct+m*Qe)*mt,t[1]=(i*Ct-r*Mt-o*Qe)*mt,t[2]=(q*Xe-K*Ee+Y*xe)*mt,t[3]=(B*Ee-C*Xe-k*xe)*mt,t[4]=(d*ge-s*Mt-m*be)*mt,t[5]=(n*Mt-i*ge+o*be)*mt,t[6]=(K*se-V*Xe-Y*J)*mt,t[7]=(b*Xe-B*se+k*J)*mt,t[8]=(s*Ct-c*ge+m*Ne)*mt,t[9]=(r*ge-n*Ct-o*Ne)*mt,t[10]=(V*Ee-q*se+Y*ee)*mt,t[11]=(C*se-b*Ee-k*ee)*mt,t[12]=(c*be-s*Qe-d*Ne)*mt,t[13]=(n*Qe-r*be+i*Ne)*mt,t[14]=(q*J-V*xe-K*ee)*mt,t[15]=(b*xe-C*J+B*ee)*mt,t):null}function eye(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],c=e[5],d=e[6],m=e[7],b=e[8],C=e[9],B=e[10],k=e[11],V=e[12],q=e[13],K=e[14],Y=e[15],ee=n*c-r*s,J=n*d-i*s,se=n*m-o*s,xe=r*d-i*c,Ee=r*m-o*c,Xe=i*m-o*d,Ne=b*q-C*V,be=b*K-B*V,ge=b*Y-k*V,Qe=C*K-B*q,Ct=C*Y-k*q,Mt=B*Y-k*K;return t[0]=c*Mt-d*Ct+m*Qe,t[1]=i*Ct-r*Mt-o*Qe,t[2]=q*Xe-K*Ee+Y*xe,t[3]=B*Ee-C*Xe-k*xe,t[4]=d*ge-s*Mt-m*be,t[5]=n*Mt-i*ge+o*be,t[6]=K*se-V*Xe-Y*J,t[7]=b*Xe-B*se+k*J,t[8]=s*Ct-c*ge+m*Ne,t[9]=r*ge-n*Ct-o*Ne,t[10]=V*Ee-q*se+Y*ee,t[11]=C*se-b*Ee-k*ee,t[12]=c*be-s*Qe-d*Ne,t[13]=n*Qe-r*be+i*Ne,t[14]=q*J-V*xe-K*ee,t[15]=b*xe-C*J+B*ee,t}function U8(t){let e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],c=t[6],d=t[7],m=t[8],b=t[9],C=t[10],B=t[11],k=t[12],V=t[13],q=t[14],K=t[15],Y=e*s-n*o,ee=e*c-r*o,J=n*c-r*s,se=m*V-b*k,xe=m*q-C*k,Ee=b*q-C*V,Xe=e*Ee-n*xe+r*se,Ne=o*Ee-s*xe+c*se,be=m*J-b*ee+C*Y,ge=k*J-V*ee+q*Y;return d*Xe-i*Ne+K*be-B*ge}function Wb(t,e,n){let r=e[0],i=e[1],o=e[2],s=e[3],c=e[4],d=e[5],m=e[6],b=e[7],C=e[8],B=e[9],k=e[10],V=e[11],q=e[12],K=e[13],Y=e[14],ee=e[15],J=n[0],se=n[1],xe=n[2],Ee=n[3];return t[0]=J*r+se*c+xe*C+Ee*q,t[1]=J*i+se*d+xe*B+Ee*K,t[2]=J*o+se*m+xe*k+Ee*Y,t[3]=J*s+se*b+xe*V+Ee*ee,J=n[4],se=n[5],xe=n[6],Ee=n[7],t[4]=J*r+se*c+xe*C+Ee*q,t[5]=J*i+se*d+xe*B+Ee*K,t[6]=J*o+se*m+xe*k+Ee*Y,t[7]=J*s+se*b+xe*V+Ee*ee,J=n[8],se=n[9],xe=n[10],Ee=n[11],t[8]=J*r+se*c+xe*C+Ee*q,t[9]=J*i+se*d+xe*B+Ee*K,t[10]=J*o+se*m+xe*k+Ee*Y,t[11]=J*s+se*b+xe*V+Ee*ee,J=n[12],se=n[13],xe=n[14],Ee=n[15],t[12]=J*r+se*c+xe*C+Ee*q,t[13]=J*i+se*d+xe*B+Ee*K,t[14]=J*o+se*m+xe*k+Ee*Y,t[15]=J*s+se*b+xe*V+Ee*ee,t}function V8(t,e,n){let r=n[0],i=n[1],o=n[2],s,c,d,m,b,C,B,k,V,q,K,Y;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*o+e[12],t[13]=e[1]*r+e[5]*i+e[9]*o+e[13],t[14]=e[2]*r+e[6]*i+e[10]*o+e[14],t[15]=e[3]*r+e[7]*i+e[11]*o+e[15]):(s=e[0],c=e[1],d=e[2],m=e[3],b=e[4],C=e[5],B=e[6],k=e[7],V=e[8],q=e[9],K=e[10],Y=e[11],t[0]=s,t[1]=c,t[2]=d,t[3]=m,t[4]=b,t[5]=C,t[6]=B,t[7]=k,t[8]=V,t[9]=q,t[10]=K,t[11]=Y,t[12]=s*r+b*i+V*o+e[12],t[13]=c*r+C*i+q*o+e[13],t[14]=d*r+B*i+K*o+e[14],t[15]=m*r+k*i+Y*o+e[15]),t}function G8(t,e,n){let r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function H8(t,e,n,r){let i=r[0],o=r[1],s=r[2],c=Math.sqrt(i*i+o*o+s*s),d,m,b,C,B,k,V,q,K,Y,ee,J,se,xe,Ee,Xe,Ne,be,ge,Qe,Ct,Mt,mt,jt;return c<1e-6?null:(c=1/c,i*=c,o*=c,s*=c,m=Math.sin(n),d=Math.cos(n),b=1-d,C=e[0],B=e[1],k=e[2],V=e[3],q=e[4],K=e[5],Y=e[6],ee=e[7],J=e[8],se=e[9],xe=e[10],Ee=e[11],Xe=i*i*b+d,Ne=o*i*b+s*m,be=s*i*b-o*m,ge=i*o*b-s*m,Qe=o*o*b+d,Ct=s*o*b+i*m,Mt=i*s*b+o*m,mt=o*s*b-i*m,jt=s*s*b+d,t[0]=C*Xe+q*Ne+J*be,t[1]=B*Xe+K*Ne+se*be,t[2]=k*Xe+Y*Ne+xe*be,t[3]=V*Xe+ee*Ne+Ee*be,t[4]=C*ge+q*Qe+J*Ct,t[5]=B*ge+K*Qe+se*Ct,t[6]=k*ge+Y*Qe+xe*Ct,t[7]=V*ge+ee*Qe+Ee*Ct,t[8]=C*Mt+q*mt+J*jt,t[9]=B*Mt+K*mt+se*jt,t[10]=k*Mt+Y*mt+xe*jt,t[11]=V*Mt+ee*mt+Ee*jt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function W8(t,e,n){let r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],c=e[6],d=e[7],m=e[8],b=e[9],C=e[10],B=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+m*r,t[5]=s*i+b*r,t[6]=c*i+C*r,t[7]=d*i+B*r,t[8]=m*i-o*r,t[9]=b*i-s*r,t[10]=C*i-c*r,t[11]=B*i-d*r,t}function j8(t,e,n){let r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],c=e[2],d=e[3],m=e[8],b=e[9],C=e[10],B=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-m*r,t[1]=s*i-b*r,t[2]=c*i-C*r,t[3]=d*i-B*r,t[8]=o*r+m*i,t[9]=s*r+b*i,t[10]=c*r+C*i,t[11]=d*r+B*i,t}function X8(t,e,n){let r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],c=e[2],d=e[3],m=e[4],b=e[5],C=e[6],B=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+m*r,t[1]=s*i+b*r,t[2]=c*i+C*r,t[3]=d*i+B*r,t[4]=m*i-o*r,t[5]=b*i-s*r,t[6]=C*i-c*r,t[7]=B*i-d*r,t}function tye(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function nye(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rye(t,e,n){let r=n[0],i=n[1],o=n[2],s=Math.sqrt(r*r+i*i+o*o),c,d,m;return s<1e-6?null:(s=1/s,r*=s,i*=s,o*=s,d=Math.sin(e),c=Math.cos(e),m=1-c,t[0]=r*r*m+c,t[1]=i*r*m+o*d,t[2]=o*r*m-i*d,t[3]=0,t[4]=r*i*m-o*d,t[5]=i*i*m+c,t[6]=o*i*m+r*d,t[7]=0,t[8]=r*o*m+i*d,t[9]=i*o*m-r*d,t[10]=o*o*m+c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function iye(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function oye(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function sye(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function $q(t,e,n){let r=e[0],i=e[1],o=e[2],s=e[3],c=r+r,d=i+i,m=o+o,b=r*c,C=r*d,B=r*m,k=i*d,V=i*m,q=o*m,K=s*c,Y=s*d,ee=s*m;return t[0]=1-(k+q),t[1]=C+ee,t[2]=B-Y,t[3]=0,t[4]=C-ee,t[5]=1-(b+q),t[6]=V+K,t[7]=0,t[8]=B+Y,t[9]=V-K,t[10]=1-(b+k),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function aye(t,e){let n=new Ji(3),r=-e[0],i=-e[1],o=-e[2],s=e[3],c=e[4],d=e[5],m=e[6],b=e[7],C=r*r+i*i+o*o+s*s;return C>0?(n[0]=(c*s+b*r+d*o-m*i)*2/C,n[1]=(d*s+b*i+m*r-c*o)*2/C,n[2]=(m*s+b*o+c*i-d*r)*2/C):(n[0]=(c*s+b*r+d*o-m*i)*2,n[1]=(d*s+b*i+m*r-c*o)*2,n[2]=(m*s+b*o+c*i-d*r)*2),$q(t,e,n),t}function lye(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function eQ(t,e){let n=e[0],r=e[1],i=e[2],o=e[4],s=e[5],c=e[6],d=e[8],m=e[9],b=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(o*o+s*s+c*c),t[2]=Math.sqrt(d*d+m*m+b*b),t}function cye(t,e){let n=new Ji(3);eQ(n,e);let r=1/n[0],i=1/n[1],o=1/n[2],s=e[0]*r,c=e[1]*i,d=e[2]*o,m=e[4]*r,b=e[5]*i,C=e[6]*o,B=e[8]*r,k=e[9]*i,V=e[10]*o,q=s+b+V,K=0;return q>0?(K=Math.sqrt(q+1)*2,t[3]=.25*K,t[0]=(C-k)/K,t[1]=(B-d)/K,t[2]=(c-m)/K):s>b&&s>V?(K=Math.sqrt(1+s-b-V)*2,t[3]=(C-k)/K,t[0]=.25*K,t[1]=(c+m)/K,t[2]=(B+d)/K):b>V?(K=Math.sqrt(1+b-s-V)*2,t[3]=(B-d)/K,t[0]=(c+m)/K,t[1]=.25*K,t[2]=(C+k)/K):(K=Math.sqrt(1+V-s-b)*2,t[3]=(c-m)/K,t[0]=(B+d)/K,t[1]=(C+k)/K,t[2]=.25*K),t}function uye(t,e,n,r){e[0]=r[12],e[1]=r[13],e[2]=r[14];let i=r[0],o=r[1],s=r[2],c=r[4],d=r[5],m=r[6],b=r[8],C=r[9],B=r[10];n[0]=Math.sqrt(i*i+o*o+s*s),n[1]=Math.sqrt(c*c+d*d+m*m),n[2]=Math.sqrt(b*b+C*C+B*B);let k=1/n[0],V=1/n[1],q=1/n[2],K=i*k,Y=o*V,ee=s*q,J=c*k,se=d*V,xe=m*q,Ee=b*k,Xe=C*V,Ne=B*q,be=K+se+Ne,ge=0;return be>0?(ge=Math.sqrt(be+1)*2,t[3]=.25*ge,t[0]=(xe-Xe)/ge,t[1]=(Ee-ee)/ge,t[2]=(Y-J)/ge):K>se&&K>Ne?(ge=Math.sqrt(1+K-se-Ne)*2,t[3]=(xe-Xe)/ge,t[0]=.25*ge,t[1]=(Y+J)/ge,t[2]=(Ee+ee)/ge):se>Ne?(ge=Math.sqrt(1+se-K-Ne)*2,t[3]=(Ee-ee)/ge,t[0]=(Y+J)/ge,t[1]=.25*ge,t[2]=(xe+Xe)/ge):(ge=Math.sqrt(1+Ne-K-se)*2,t[3]=(Y-J)/ge,t[0]=(Ee+ee)/ge,t[1]=(xe+Xe)/ge,t[2]=.25*ge),t}function hye(t,e,n,r){let i=e[0],o=e[1],s=e[2],c=e[3],d=i+i,m=o+o,b=s+s,C=i*d,B=i*m,k=i*b,V=o*m,q=o*b,K=s*b,Y=c*d,ee=c*m,J=c*b,se=r[0],xe=r[1],Ee=r[2];return t[0]=(1-(V+K))*se,t[1]=(B+J)*se,t[2]=(k-ee)*se,t[3]=0,t[4]=(B-J)*xe,t[5]=(1-(C+K))*xe,t[6]=(q+Y)*xe,t[7]=0,t[8]=(k+ee)*Ee,t[9]=(q-Y)*Ee,t[10]=(1-(C+V))*Ee,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function fye(t,e,n,r,i){let o=e[0],s=e[1],c=e[2],d=e[3],m=o+o,b=s+s,C=c+c,B=o*m,k=o*b,V=o*C,q=s*b,K=s*C,Y=c*C,ee=d*m,J=d*b,se=d*C,xe=r[0],Ee=r[1],Xe=r[2],Ne=i[0],be=i[1],ge=i[2],Qe=(1-(q+Y))*xe,Ct=(k+se)*xe,Mt=(V-J)*xe,mt=(k-se)*Ee,jt=(1-(B+Y))*Ee,Mn=(K+ee)*Ee,rn=(V+J)*Xe,In=(K-ee)*Xe,On=(1-(B+q))*Xe;return t[0]=Qe,t[1]=Ct,t[2]=Mt,t[3]=0,t[4]=mt,t[5]=jt,t[6]=Mn,t[7]=0,t[8]=rn,t[9]=In,t[10]=On,t[11]=0,t[12]=n[0]+Ne-(Qe*Ne+mt*be+rn*ge),t[13]=n[1]+be-(Ct*Ne+jt*be+In*ge),t[14]=n[2]+ge-(Mt*Ne+Mn*be+On*ge),t[15]=1,t}function Y8(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,c=r+r,d=i+i,m=n*s,b=r*s,C=r*c,B=i*s,k=i*c,V=i*d,q=o*s,K=o*c,Y=o*d;return t[0]=1-C-V,t[1]=b+Y,t[2]=B-K,t[3]=0,t[4]=b-Y,t[5]=1-m-V,t[6]=k+q,t[7]=0,t[8]=B+K,t[9]=k-q,t[10]=1-m-C,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Z8(t,e,n,r,i,o,s){let c=1/(n-e),d=1/(i-r),m=1/(o-s);return t[0]=o*2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*d,t[6]=0,t[7]=0,t[8]=(n+e)*c,t[9]=(i+r)*d,t[10]=(s+o)*m,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*m,t[15]=0,t}function tQ(t,e,n,r,i){let o=1/Math.tan(e/2);if(t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){let s=1/(r-i);t[10]=(i+r)*s,t[14]=2*i*r*s}else t[10]=-1,t[14]=-2*r;return t}var q8=tQ;function dye(t,e,n,r,i){let o=1/Math.tan(e/2);if(t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){let s=1/(r-i);t[10]=i*s,t[14]=i*r*s}else t[10]=-1,t[14]=-r;return t}function pye(t,e,n,r){let i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),c=Math.tan(e.rightDegrees*Math.PI/180),d=2/(s+c),m=2/(i+o);return t[0]=d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=m,t[6]=0,t[7]=0,t[8]=-((s-c)*d*.5),t[9]=(i-o)*m*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function nQ(t,e,n,r,i,o,s){let c=1/(e-n),d=1/(r-i),m=1/(o-s);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*m,t[11]=0,t[12]=(e+n)*c,t[13]=(i+r)*d,t[14]=(s+o)*m,t[15]=1,t}var Q8=nQ;function Aye(t,e,n,r,i,o,s){let c=1/(e-n),d=1/(r-i),m=1/(o-s);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=m,t[11]=0,t[12]=(e+n)*c,t[13]=(i+r)*d,t[14]=o*m,t[15]=1,t}function K8(t,e,n,r){let i,o,s,c,d,m,b,C,B,k,V=e[0],q=e[1],K=e[2],Y=r[0],ee=r[1],J=r[2],se=n[0],xe=n[1],Ee=n[2];return Math.abs(V-se)<1e-6&&Math.abs(q-xe)<1e-6&&Math.abs(K-Ee)<1e-6?Jq(t):(C=V-se,B=q-xe,k=K-Ee,i=1/Math.sqrt(C*C+B*B+k*k),C*=i,B*=i,k*=i,o=ee*k-J*B,s=J*C-Y*k,c=Y*B-ee*C,i=Math.sqrt(o*o+s*s+c*c),i?(i=1/i,o*=i,s*=i,c*=i):(o=0,s=0,c=0),d=B*c-k*s,m=k*o-C*c,b=C*s-B*o,i=Math.sqrt(d*d+m*m+b*b),i?(i=1/i,d*=i,m*=i,b*=i):(d=0,m=0,b=0),t[0]=o,t[1]=d,t[2]=C,t[3]=0,t[4]=s,t[5]=m,t[6]=B,t[7]=0,t[8]=c,t[9]=b,t[10]=k,t[11]=0,t[12]=-(o*V+s*q+c*K),t[13]=-(d*V+m*q+b*K),t[14]=-(C*V+B*q+k*K),t[15]=1,t)}function gye(t,e,n,r){let i=e[0],o=e[1],s=e[2],c=r[0],d=r[1],m=r[2],b=i-n[0],C=o-n[1],B=s-n[2],k=b*b+C*C+B*B;k>0&&(k=1/Math.sqrt(k),b*=k,C*=k,B*=k);let V=d*B-m*C,q=m*b-c*B,K=c*C-d*b;return k=V*V+q*q+K*K,k>0&&(k=1/Math.sqrt(k),V*=k,q*=k,K*=k),t[0]=V,t[1]=q,t[2]=K,t[3]=0,t[4]=C*K-B*q,t[5]=B*V-b*K,t[6]=b*q-C*V,t[7]=0,t[8]=b,t[9]=C,t[10]=B,t[11]=0,t[12]=i,t[13]=o,t[14]=s,t[15]=1,t}function mye(t){return`mat4(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}, ${t[4]}, ${t[5]}, ${t[6]}, ${t[7]}, ${t[8]}, ${t[9]}, ${t[10]}, ${t[11]}, ${t[12]}, ${t[13]}, ${t[14]}, ${t[15]})`}function _ye(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8]+t[9]*t[9]+t[10]*t[10]+t[11]*t[11]+t[12]*t[12]+t[13]*t[13]+t[14]*t[14]+t[15]*t[15])}function yye(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function rQ(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function xye(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function vye(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function bye(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function wye(t,e){let n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],c=t[5],d=t[6],m=t[7],b=t[8],C=t[9],B=t[10],k=t[11],V=t[12],q=t[13],K=t[14],Y=t[15],ee=e[0],J=e[1],se=e[2],xe=e[3],Ee=e[4],Xe=e[5],Ne=e[6],be=e[7],ge=e[8],Qe=e[9],Ct=e[10],Mt=e[11],mt=e[12],jt=e[13],Mn=e[14],rn=e[15];return Math.abs(n-ee)<=1e-6*Math.max(1,Math.abs(n),Math.abs(ee))&&Math.abs(r-J)<=1e-6*Math.max(1,Math.abs(r),Math.abs(J))&&Math.abs(i-se)<=1e-6*Math.max(1,Math.abs(i),Math.abs(se))&&Math.abs(o-xe)<=1e-6*Math.max(1,Math.abs(o),Math.abs(xe))&&Math.abs(s-Ee)<=1e-6*Math.max(1,Math.abs(s),Math.abs(Ee))&&Math.abs(c-Xe)<=1e-6*Math.max(1,Math.abs(c),Math.abs(Xe))&&Math.abs(d-Ne)<=1e-6*Math.max(1,Math.abs(d),Math.abs(Ne))&&Math.abs(m-be)<=1e-6*Math.max(1,Math.abs(m),Math.abs(be))&&Math.abs(b-ge)<=1e-6*Math.max(1,Math.abs(b),Math.abs(ge))&&Math.abs(C-Qe)<=1e-6*Math.max(1,Math.abs(C),Math.abs(Qe))&&Math.abs(B-Ct)<=1e-6*Math.max(1,Math.abs(B),Math.abs(Ct))&&Math.abs(k-Mt)<=1e-6*Math.max(1,Math.abs(k),Math.abs(Mt))&&Math.abs(V-mt)<=1e-6*Math.max(1,Math.abs(V),Math.abs(mt))&&Math.abs(q-jt)<=1e-6*Math.max(1,Math.abs(q),Math.abs(jt))&&Math.abs(K-Mn)<=1e-6*Math.max(1,Math.abs(K),Math.abs(Mn))&&Math.abs(Y-rn)<=1e-6*Math.max(1,Math.abs(Y),Math.abs(rn))}var Tye=Wb,Eye=rQ;var bc={};Aa(bc,{add:()=>J8,ceil:()=>Sye,clone:()=>oQ,copy:()=>aQ,create:()=>iQ,cross:()=>Lye,dist:()=>Gye,distance:()=>fQ,div:()=>Vye,divide:()=>hQ,dot:()=>tF,equals:()=>Nye,exactEquals:()=>pQ,floor:()=>Cye,forEach:()=>Xye,fromValues:()=>sQ,inverse:()=>Dye,len:()=>Wye,length:()=>MM,lerp:()=>nF,max:()=>Iye,min:()=>Mye,mul:()=>Uye,multiply:()=>uQ,negate:()=>Bye,normalize:()=>eF,random:()=>Oye,round:()=>Pye,scale:()=>$8,scaleAndAdd:()=>Rye,set:()=>lQ,sqrDist:()=>Hye,sqrLen:()=>jye,squaredDistance:()=>dQ,squaredLength:()=>IM,str:()=>kye,sub:()=>zye,subtract:()=>cQ,transformMat4:()=>rF,transformQuat:()=>iF,zero:()=>Fye});function iQ(){let t=new Ji(4);return Ji!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function oQ(t){let e=new Ji(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function sQ(t,e,n,r){let i=new Ji(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function aQ(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function lQ(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function J8(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function cQ(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function uQ(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function hQ(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Sye(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Cye(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Mye(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Iye(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Pye(t,e){return t[0]=Zu(e[0]),t[1]=Zu(e[1]),t[2]=Zu(e[2]),t[3]=Zu(e[3]),t}function $8(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Rye(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function fQ(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function dQ(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function MM(t){let e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function IM(t){let e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function Bye(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Dye(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function eF(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s,t}function tF(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Lye(t,e,n,r){let i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],s=n[0]*r[3]-n[3]*r[0],c=n[1]*r[2]-n[2]*r[1],d=n[1]*r[3]-n[3]*r[1],m=n[2]*r[3]-n[3]*r[2],b=e[0],C=e[1],B=e[2],k=e[3];return t[0]=C*m-B*d+k*c,t[1]=-(b*m)+B*s-k*o,t[2]=b*d-C*s+k*i,t[3]=-(b*c)+C*o-B*i,t}function nF(t,e,n,r){let i=e[0],o=e[1],s=e[2],c=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t[3]=c+r*(n[3]-c),t}function Oye(t,e){e=e===void 0?1:e;let n,r,i,o,s,c;do n=Kf()*2-1,r=Kf()*2-1,s=n*n+r*r;while(s>=1);do i=Kf()*2-1,o=Kf()*2-1,c=i*i+o*o;while(c>=1);let d=Math.sqrt((1-s)/c);return t[0]=e*n,t[1]=e*r,t[2]=e*i*d,t[3]=e*o*d,t}function rF(t,e,n){let r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}function iF(t,e,n){let r=e[0],i=e[1],o=e[2],s=n[0],c=n[1],d=n[2],m=n[3],b=m*r+c*o-d*i,C=m*i+d*r-s*o,B=m*o+s*i-c*r,k=-s*r-c*i-d*o;return t[0]=b*m+k*-s+C*-d-B*-c,t[1]=C*m+k*-c+B*-s-b*-d,t[2]=B*m+k*-d+b*-c-C*-s,t[3]=e[3],t}function Fye(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function kye(t){return`vec4(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}function pQ(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Nye(t,e){let n=t[0],r=t[1],i=t[2],o=t[3],s=e[0],c=e[1],d=e[2],m=e[3];return Math.abs(n-s)<=1e-6*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-c)<=1e-6*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-d)<=1e-6*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-m)<=1e-6*Math.max(1,Math.abs(o),Math.abs(m))}var zye=cQ,Uye=uQ,Vye=hQ,Gye=fQ,Hye=dQ,Wye=MM,jye=IM,Xye=(function(){let t=iQ();return function(e,n,r,i,o,s){let c,d;for(n||(n=4),r||(r=0),i?d=Math.min(i*n+r,e.length):d=e.length,c=r;c<d;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],t[3]=e[c+3],o(t,t,s),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2],e[c+3]=t[3];return e}})();var aF;(function(t){t[t.COL0ROW0=0]=\"COL0ROW0\",t[t.COL0ROW1=1]=\"COL0ROW1\",t[t.COL0ROW2=2]=\"COL0ROW2\",t[t.COL0ROW3=3]=\"COL0ROW3\",t[t.COL1ROW0=4]=\"COL1ROW0\",t[t.COL1ROW1=5]=\"COL1ROW1\",t[t.COL1ROW2=6]=\"COL1ROW2\",t[t.COL1ROW3=7]=\"COL1ROW3\",t[t.COL2ROW0=8]=\"COL2ROW0\",t[t.COL2ROW1=9]=\"COL2ROW1\",t[t.COL2ROW2=10]=\"COL2ROW2\",t[t.COL2ROW3=11]=\"COL2ROW3\",t[t.COL3ROW0=12]=\"COL3ROW0\",t[t.COL3ROW1=13]=\"COL3ROW1\",t[t.COL3ROW2=14]=\"COL3ROW2\",t[t.COL3ROW3=15]=\"COL3ROW3\"})(aF||(aF={}));var Yye=45*Math.PI/180,Zye=1,oF=.1,sF=500,qye=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),wn=class extends Ry{static get IDENTITY(){return Kye()}static get ZERO(){return Qye()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return aF}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,o,s,c,d,m,b,C,B,k,V,q,K){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=d,this[8]=m,this[9]=b,this[10]=C,this[11]=B,this[12]=k,this[13]=V,this[14]=q,this[15]=K,this.check()}setRowMajor(e,n,r,i,o,s,c,d,m,b,C,B,k,V,q,K){return this[0]=e,this[1]=o,this[2]=m,this[3]=k,this[4]=n,this[5]=s,this[6]=b,this[7]=V,this[8]=r,this[9]=c,this[10]=C,this[11]=q,this[12]=i,this[13]=d,this[14]=B,this[15]=K,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(qye)}fromObject(e){return this.check()}fromQuaternion(e){return Y8(this,e),this.check()}frustum(e){let{left:n,right:r,bottom:i,top:o,near:s=oF,far:c=sF}=e;return c===1/0?Jye(this,n,r,i,o,s):Z8(this,n,r,i,o,s,c),this.check()}lookAt(e){let{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return K8(this,n,r,i),this.check()}ortho(e){let{left:n,right:r,bottom:i,top:o,near:s=oF,far:c=sF}=e;return Q8(this,n,r,i,o,s,c),this.check()}orthographic(e){let{fovy:n=Yye,aspect:r=Zye,focalDistance:i=1,near:o=oF,far:s=sF}=e;AQ(n);let c=n/2,d=i*Math.tan(c),m=d*r;return this.ortho({left:-m,right:m,bottom:-d,top:d,near:o,far:s})}perspective(e){let{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:o=500}=e;return AQ(n),q8(this,n,r,i,o),this.check()}determinant(){return U8(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];let r=this.getScale(n),i=1/r[0],o=1/r[1],s=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*o,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*o,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*o,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];let r=this.getScale(n),i=1/r[0],o=1/r[1],s=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*o,e[2]=this[2]*s,e[3]=this[4]*i,e[4]=this[5]*o,e[5]=this[6]*s,e[6]=this[8]*i,e[7]=this[9]*o,e[8]=this[10]*s,e}transpose(){return N8(this,this),this.check()}invert(){return z8(this,this),this.check()}multiplyLeft(e){return Wb(this,e,this),this.check()}multiplyRight(e){return Wb(this,this,e),this.check()}rotateX(e){return W8(this,this,e),this.check()}rotateY(e){return j8(this,this,e),this.check()}rotateZ(e){return X8(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return H8(this,this,e,n),this.check()}scale(e){return G8(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return V8(this,this,e),this.check()}transform(e,n){return e.length===4?(n=rF(n||[-0,-0,-0,-0],e,this),MA(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){let{length:r}=e,i;switch(r){case 2:i=Ub(n||[-0,-0],e,this);break;case 3:i=Um(n||[-0,-0,-0],e,this);break;default:throw new Error(\"Illegal vector\")}return MA(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=_M(n||[-0,-0],e,this);break;case 3:r=yM(n||[-0,-0,-0],e,this);break;default:throw new Error(\"Illegal vector\")}return MA(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}},PM,RM;function Qye(){return PM||(PM=new wn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(PM)),PM}function Kye(){return RM||(RM=new wn,Object.freeze(RM)),RM}function AQ(t){if(t>Math.PI*2)throw Error(\"expected radians\")}function Jye(t,e,n,r,i,o){let s=2*o/(n-e),c=2*o/(i-r),d=(n+e)/(n-e),m=(i+r)/(i-r),b=-1,C=-1,B=-2*o;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=d,t[9]=m,t[10]=b,t[11]=C,t[12]=0,t[13]=0,t[14]=B,t[15]=0,t}function gQ(){let t=new Ji(4);return Ji!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function mQ(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function lF(t,e,n){n=n*.5;let r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function cF(t,e,n){let r=e[0],i=e[1],o=e[2],s=e[3],c=n[0],d=n[1],m=n[2],b=n[3];return t[0]=r*b+s*c+i*m-o*d,t[1]=i*b+s*d+o*c-r*m,t[2]=o*b+s*m+r*d-i*c,t[3]=s*b-r*c-i*d-o*m,t}function _Q(t,e,n){n*=.5;let r=e[0],i=e[1],o=e[2],s=e[3],c=Math.sin(n),d=Math.cos(n);return t[0]=r*d+s*c,t[1]=i*d+o*c,t[2]=o*d-i*c,t[3]=s*d-r*c,t}function yQ(t,e,n){n*=.5;let r=e[0],i=e[1],o=e[2],s=e[3],c=Math.sin(n),d=Math.cos(n);return t[0]=r*d-o*c,t[1]=i*d+s*c,t[2]=o*d+r*c,t[3]=s*d-i*c,t}function xQ(t,e,n){n*=.5;let r=e[0],i=e[1],o=e[2],s=e[3],c=Math.sin(n),d=Math.cos(n);return t[0]=r*d+i*c,t[1]=i*d-r*c,t[2]=o*d+s*c,t[3]=s*d-o*c,t}function vQ(t,e){let n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function jb(t,e,n,r){let i=e[0],o=e[1],s=e[2],c=e[3],d=n[0],m=n[1],b=n[2],C=n[3],B,k,V,q,K;return B=i*d+o*m+s*b+c*C,B<0&&(B=-B,d=-d,m=-m,b=-b,C=-C),1-B>1e-6?(k=Math.acos(B),K=Math.sin(k),V=Math.sin((1-r)*k)/K,q=Math.sin(r*k)/K):(V=1-r,q=r),t[0]=V*i+q*d,t[1]=V*o+q*m,t[2]=V*s+q*b,t[3]=V*c+q*C,t}function bQ(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,c=s?1/s:0;return t[0]=-n*c,t[1]=-r*c,t[2]=-i*c,t[3]=o*c,t}function wQ(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function uF(t,e){let n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);let o=(i+1)%3,s=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[o*3+o]-e[s*3+s]+1),t[i]=.5*r,r=.5/r,t[3]=(e[o*3+s]-e[s*3+o])*r,t[o]=(e[o*3+i]+e[i*3+o])*r,t[s]=(e[s*3+i]+e[i*3+s])*r}return t}var TQ=J8;var EQ=$8,SQ=tF,CQ=nF,MQ=MM;var IQ=IM;var PQ=eF;var RQ=(function(){let t=vM(),e=bM(1,0,0),n=bM(0,1,0);return function(r,i,o){let s=Vb(i,o);return s<-.999999?(zm(t,e,i),D8(t)<1e-6&&zm(t,n,i),M8(t,t),lF(r,t,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(zm(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+s,PQ(r,r))}})(),XGe=(function(){let t=gQ(),e=gQ();return function(n,r,i,o,s,c){return jb(t,r,s,c),jb(e,i,o,c),jb(n,t,e,2*c*(1-c)),n}})(),YGe=(function(){let t=Wq();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],PQ(e,uF(e,t))}})();var e2e=[0,0,0,1],qu=class extends CA{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return uF(this,e),this.check()}fromAxisRotation(e,n){return lF(this,e,n),this.check()}identity(){return mQ(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Gr(e)}get y(){return this[1]}set y(e){this[1]=Gr(e)}get z(){return this[2]}set z(e){this[2]=Gr(e)}get w(){return this[3]}set w(e){this[3]=Gr(e)}len(){return MQ(this)}lengthSquared(){return IQ(this)}dot(e){return SQ(this,e)}rotationTo(e,n){return RQ(this,e,n),this.check()}add(e){return TQ(this,this,e),this.check()}calculateW(){return vQ(this,this),this.check()}conjugate(){return wQ(this,this),this.check()}invert(){return bQ(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(CQ(this,e,n,r),this.check())}multiplyRight(e){return cF(this,this,e),this.check()}multiplyLeft(e){return cF(this,e,this),this.check()}normalize(){let e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return _Q(this,this,e),this.check()}rotateY(e){return yQ(this,this,e),this.check()}rotateZ(e){return xQ(this,this,e),this.check()}scale(e){return EQ(this,this,e),this.check()}slerp(e,n,r){let i,o,s;switch(arguments.length){case 1:({start:i=e2e,target:o,ratio:s}=e);break;case 2:i=this,o=e,s=n;break;default:i=e,o=n,s=r}return jb(this,i,o,s),this.check()}transformVector4(e,n=new EM){return iF(n,e,this),MA(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}};var qh={};Aa(qh,{EPSILON1:()=>t2e,EPSILON10:()=>u2e,EPSILON11:()=>h2e,EPSILON12:()=>f2e,EPSILON13:()=>d2e,EPSILON14:()=>p2e,EPSILON15:()=>A2e,EPSILON16:()=>g2e,EPSILON17:()=>m2e,EPSILON18:()=>_2e,EPSILON19:()=>y2e,EPSILON2:()=>n2e,EPSILON20:()=>x2e,EPSILON3:()=>r2e,EPSILON4:()=>i2e,EPSILON5:()=>o2e,EPSILON6:()=>s2e,EPSILON7:()=>a2e,EPSILON8:()=>l2e,EPSILON9:()=>c2e,PI_OVER_FOUR:()=>b2e,PI_OVER_SIX:()=>w2e,PI_OVER_TWO:()=>v2e,TWO_PI:()=>T2e});var t2e=.1,n2e=.01,r2e=.001,i2e=1e-4,o2e=1e-5,s2e=1e-6,a2e=1e-7,l2e=1e-8,c2e=1e-9,u2e=1e-10,h2e=1e-11,f2e=1e-12,d2e=1e-13,p2e=1e-14,A2e=1e-15,g2e=1e-16,m2e=1e-17,_2e=1e-18,y2e=1e-19,x2e=1e-20,v2e=Math.PI/2,b2e=Math.PI/4,w2e=Math.PI/6,T2e=Math.PI*2;function hF(t,e=[],n=0){let r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function BQ(t){return t-Math.fround(t)}function DQ(t){let e=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){let i=n*4+r;hF(t[r*4+n],e,i*2)}return e}var E2e=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n\n// All these functions are for substituting tan() function from Intel GPU only\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n\n    // 2pi range reduction\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n`,fF={name:\"fp32\",vs:E2e};var LQ=`\nuniform fp64arithmeticUniforms {\n  uniform float ONE;\n} fp64;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some 'equivalent' form.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * fp64.ONE - (t - a);\n  float a_lo = a * fp64.ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * fp64.ONE;\n  float err = b - (sum - a) * fp64.ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *\n    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n`;var S2e={ONE:1},dF={name:\"fp64arithmetic\",vs:LQ,defaultUniforms:S2e,uniformTypes:{ONE:\"f32\"},fp64ify:hF,fp64LowPart:BQ,fp64ifyMatrix4:DQ};var C2e=[0,1,1,1],M2e=`uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nout vec4 picking_vRGBcolor_Avalid;\n\n// Normalize unsigned byte color to 0-1 range\nvec3 picking_normalizeColor(vec3 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\n// Normalize unsigned byte color to 0-1 range\nvec4 picking_normalizeColor(vec4 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\nbool picking_isColorZero(vec3 color) {\n  return dot(color, vec3(1.0)) < 0.00001;\n}\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.00001;\n}\n\n// Check if this vertex is highlighted \nbool isVertexHighlighted(vec3 vertexColor) {\n  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);\n  return\n    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));\n}\n\n// Set the current picking color\nvoid picking_setPickingColor(vec3 pickingColor) {\n  pickingColor = picking_normalizeColor(pickingColor);\n\n  if (bool(picking.isActive)) {\n    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!bool(picking.isAttribute)) {\n      // Stores the picking color so that the fragment shader can render it during picking\n      picking_vRGBcolor_Avalid.rgb = pickingColor;\n    }\n  } else {\n    // Do the comparison with selected item color in vertex shader as it should mean fewer compares\n    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec2 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec3 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n`,I2e=`uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nin vec4 picking_vRGBcolor_Avalid;\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 picking_filterHighlightColor(vec4 color) {\n  // If we are still picking, we don't highlight\n  if (picking.isActive > 0.5) {\n    return color;\n  }\n\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    // Blend in highlight color based on its alpha value\n    float highLightAlpha = picking.highlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 picking_filterPickingColor(vec4 color) {\n  if (bool(picking.isActive)) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 picking_filterColor(vec4 color) {\n  vec4 highlightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highlightColor);\n}\n`,BM={props:{},uniforms:{},name:\"picking\",uniformTypes:{isActive:\"f32\",isAttribute:\"f32\",isHighlightActive:\"f32\",useFloatColors:\"f32\",highlightedObjectColor:\"vec3<f32>\",highlightColor:\"vec4<f32>\"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:C2e},vs:M2e,fs:I2e,getUniforms:P2e};function P2e(t={},e){let n={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)n.isHighlightActive=!1;else{n.isHighlightActive=!0;let r=t.highlightedObjectColor.slice(0,3);n.highlightedObjectColor=r}if(t.highlightColor){let r=Array.from(t.highlightColor,i=>i/255);Number.isFinite(r[3])||(r[3]=1),n.highlightColor=r}return t.isActive!==void 0&&(n.isActive=!!t.isActive,n.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(n.useFloatColors=!!t.useFloatColors),n}lr();var pF=`precision highp int;\n\n// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\n  vec3 color;\n};\n\nstruct PointLight {\n  vec3 color;\n  vec3 position;\n  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform lightingUniforms {\n  int enabled;\n  int lightType;\n\n  int directionalLightCount;\n  int pointLightCount;\n\n  vec3 ambientColor;\n\n  vec3 lightColor0;\n  vec3 lightPosition0;\n  vec3 lightDirection0;\n  vec3 lightAttenuation0;\n\n  vec3 lightColor1;\n  vec3 lightPosition1;\n  vec3 lightDirection1;\n  vec3 lightAttenuation1;\n\n  vec3 lightColor2;\n  vec3 lightPosition2;\n  vec3 lightDirection2;\n  vec3 lightAttenuation2;\n} lighting;\n\nPointLight lighting_getPointLight(int index) {\n  switch (index) {\n    case 0:\n      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);\n    case 1:\n      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);\n    case 2:\n    default:  \n      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);\n  }\n}\n\nDirectionalLight lighting_getDirectionalLight(int index) {\n  switch (index) {\n    case 0:\n      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);\n    case 1:\n      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);\n    case 2:\n    default:   \n      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);\n  }\n} \n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n// #endif\n`;var OQ=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\n  color: vec3<f32>,\n};\n\nstruct PointLight {\n  color: vec3<f32>,\n  position: vec3<f32>,\n  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential\n};\n\nstruct DirectionalLight {\n  color: vec3<f32>,\n  direction: vec3<f32>,\n};\n\nstruct lightingUniforms {\n  enabled: i32,\n  pointLightCount: i32,\n  directionalLightCount: i32,\n\n  ambientColor: vec3<f32>,\n\n  // TODO - support multiple lights by uncommenting arrays below\n  lightType: i32,\n  lightColor: vec3<f32>,\n  lightDirection: vec3<f32>,\n  lightPosition: vec3<f32>,\n  lightAttenuation: vec3<f32>,\n\n  // AmbientLight ambientLight;\n  // PointLight pointLight[MAX_LIGHTS];\n  // DirectionalLight directionalLight[MAX_LIGHTS];\n};\n\n// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)\n@binding(1) @group(0) var<uniform> lighting : lightingUniforms;\n\nfn lighting_getPointLight(index: i32) -> PointLight {\n  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);\n}\n\nfn lighting_getDirectionalLight(index: i32) -> DirectionalLight {\n  return DirectionalLight(lighting.lightColor, lighting.lightDirection);\n} \n\nfn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n`;var R2e=5,B2e=255,Xb;(function(t){t[t.POINT=0]=\"POINT\",t[t.DIRECTIONAL=1]=\"DIRECTIONAL\"})(Xb||(Xb={}));var Ip={props:{},uniforms:{},name:\"lighting\",defines:{},uniformTypes:{enabled:\"i32\",lightType:\"i32\",directionalLightCount:\"i32\",pointLightCount:\"i32\",ambientColor:\"vec3<f32>\",lightColor0:\"vec3<f32>\",lightPosition0:\"vec3<f32>\",lightDirection0:\"vec3<f32>\",lightAttenuation0:\"vec3<f32>\",lightColor1:\"vec3<f32>\",lightPosition1:\"vec3<f32>\",lightDirection1:\"vec3<f32>\",lightAttenuation1:\"vec3<f32>\",lightColor2:\"vec3<f32>\",lightPosition2:\"vec3<f32>\",lightDirection2:\"vec3<f32>\",lightAttenuation2:\"vec3<f32>\"},defaultUniforms:{enabled:1,lightType:Xb.POINT,directionalLightCount:0,pointLightCount:0,ambientColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:OQ,vs:pF,fs:pF,getUniforms:D2e};function D2e(t,e={}){if(t=t&&{...t},!t)return{...Ip.defaultUniforms};t.lights&&(t={...t,...O2e(t.lights),lights:void 0});let{ambientLight:n,pointLights:r,directionalLights:i}=t||{};if(!(n||r&&r.length>0||i&&i.length>0))return{...Ip.defaultUniforms,enabled:0};let s={...Ip.defaultUniforms,...e,...L2e({ambientLight:n,pointLights:r,directionalLights:i})};return t.enabled!==void 0&&(s.enabled=t.enabled?1:0),s}function L2e({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){let r={};r.ambientColor=AF(t);let i=0;for(let o of e){r.lightType=Xb.POINT;let s=i;r[`lightColor${s}`]=AF(o),r[`lightPosition${s}`]=o.position,r[`lightAttenuation${s}`]=o.attenuation||[1,0,0],i++}for(let o of n){r.lightType=Xb.DIRECTIONAL;let s=i;r[`lightColor${s}`]=AF(o),r[`lightDirection${s}`]=o.direction,i++}return i>R2e&&St.warn(\"MAX_LIGHTS exceeded\")(),r.directionalLightCount=n.length,r.pointLightCount=e.length,r}function O2e(t){let e={pointLights:[],directionalLights:[]};for(let n of t||[])switch(n.type){case\"ambient\":e.ambientLight=n;break;case\"directional\":e.directionalLights?.push(n);break;case\"point\":e.pointLights?.push(n);break;default:}return e}function AF(t={}){let{color:e=[0,0,0],intensity:n=1}=t;return e.map(r=>r*n/B2e)}var DM=`uniform phongMaterialUniforms {\n  uniform float ambient;\n  uniform float diffuse;\n  uniform float shininess;\n  uniform vec3  specularColor;\n} material;\n`,LM=`#define MAX_LIGHTS 3\n\nuniform phongMaterialUniforms {\n  uniform float ambient;\n  uniform float diffuse;\n  uniform float shininess;\n  uniform vec3  specularColor;\n} material;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n  vec3 halfway_direction = normalize(light_direction + view_direction);\n  float lambertian = dot(light_direction, normal_worldspace);\n  float specular = 0.0;\n  if (lambertian > 0.0) {\n    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n    specular = pow(specular_angle, material.shininess);\n  }\n  lambertian = max(lambertian, 0.0);\n  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting.enabled == 0) {\n    return lightColor;\n  }\n\n  vec3 view_direction = normalize(cameraPosition - position_worldspace);\n  lightColor = material.ambient * surfaceColor * lighting.ambientColor;\n\n  for (int i = 0; i < lighting.pointLightCount; i++) {\n    PointLight pointLight = lighting_getPointLight(i);\n    vec3 light_position_worldspace = pointLight.position;\n    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));\n    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);\n  }\n\n  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);\n  for (int i = lighting.pointLightCount; i < totalLights; i++) {\n    DirectionalLight directionalLight = lighting_getDirectionalLight(i);\n    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n  }\n  \n  return lightColor;\n}\n`;var OM=`struct phongMaterialUniforms {\n  ambient: f32,\n  diffuse: f32,\n  shininess: f32,\n  specularColor: vec3<f32>,\n};\n\n@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;\n\nfn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {\n  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);\n  var lambertian: f32 = dot(light_direction, normal_worldspace);\n  var specular: f32 = 0.0;\n  if (lambertian > 0.0) {\n    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n    specular = pow(specular_angle, phongMaterial.shininess);\n  }\n  lambertian = max(lambertian, 0.0);\n  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;\n}\n\nfn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {\n  var lightColor: vec3<f32> = surfaceColor;\n\n  if (lighting.enabled == 0) {\n    return lightColor;\n  }\n\n  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);\n  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;\n\n  if (lighting.lightType == 0) {\n    let pointLight: PointLight  = lighting_getPointLight(0);\n    let light_position_worldspace: vec3<f32> = pointLight.position;\n    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);\n    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n  } else if (lighting.lightType == 1) {\n    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);\n    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n  }\n  \n  return lightColor;\n  /*\n  for (int i = 0; i < MAX_LIGHTS; i++) {\n    if (i >= lighting.pointLightCount) {\n      break;\n    }\n    PointLight pointLight = lighting.pointLight[i];\n    vec3 light_position_worldspace = pointLight.position;\n    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n  }\n\n  for (int i = 0; i < MAX_LIGHTS; i++) {\n    if (i >= lighting.directionalLightCount) {\n      break;\n    }\n    DirectionalLight directionalLight = lighting.directionalLight[i];\n    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n  }\n  */\n}\n\nfn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{\n  var lightColor = vec3<f32>(0, 0, 0);\n  let surfaceColor = vec3<f32>(0, 0, 0);\n\n  if (lighting.enabled == 0) {\n    let view_direction = normalize(cameraPosition - position_worldspace);\n\n    switch (lighting.lightType) {\n      case 0, default: {\n        let pointLight: PointLight = lighting_getPointLight(0);\n        let light_position_worldspace: vec3<f32> = pointLight.position;\n        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);\n        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n      }\n      case 1: {\n        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);\n        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n      }\n    }\n  }\n  return lightColor;\n}\n`;var Pp={props:{},name:\"gouraudMaterial\",vs:LM.replace(\"phongMaterial\",\"gouraudMaterial\"),fs:DM.replace(\"phongMaterial\",\"gouraudMaterial\"),source:OM.replaceAll(\"phongMaterial\",\"gouraudMaterial\"),defines:{LIGHTING_VERTEX:!0},dependencies:[Ip],uniformTypes:{ambient:\"f32\",diffuse:\"f32\",shininess:\"f32\",specularColor:\"vec3<f32>\"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){let e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(n=>n/255)),{...Pp.defaultUniforms,...e}}};var Vm={name:\"phongMaterial\",dependencies:[Ip],source:OM,vs:DM,fs:LM,defines:{LIGHTING_FRAGMENT:!0},uniformTypes:{ambient:\"f32\",diffuse:\"f32\",shininess:\"f32\",specularColor:\"vec3<f32>\"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){let e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(n=>n/255)),{...Vm.defaultUniforms,...e}}};var FQ=`out vec3 pbr_vPosition;\nout vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nout mat3 pbr_vTBN;\n# else\nout vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = pbrProjection.modelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(pbrProjection.normalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(pbrProjection.modelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else // HAS_TANGENTS != 1\n  pbr_vNormal = normalize(vec3(pbrProjection.modelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n`,kQ=`precision highp float;\n\nuniform pbrMaterialUniforms {\n  // Material is unlit\n  bool unlit;\n\n  // Base color map\n  bool baseColorMapEnabled;\n  vec4 baseColorFactor;\n\n  bool normalMapEnabled;  \n  float normalScale; // #ifdef HAS_NORMALMAP\n\n  bool emissiveMapEnabled;\n  vec3 emissiveFactor; // #ifdef HAS_EMISSIVEMAP\n\n  vec2 metallicRoughnessValues;\n  bool metallicRoughnessMapEnabled;\n\n  bool occlusionMapEnabled;\n  float occlusionStrength; // #ifdef HAS_OCCLUSIONMAP\n  \n  bool alphaCutoffEnabled;\n  float alphaCutoff; // #ifdef ALPHA_CUTOFF\n  \n  // IBL\n  bool IBLenabled;\n  vec2 scaleIBLAmbient; // #ifdef USE_IBL\n  \n  // debugging flags used for shader output of intermediate PBR variables\n  // #ifdef PBR_DEBUG\n  vec4 scaleDiffBaseMR;\n  vec4 scaleFGDSpec;\n  // #endif\n} pbrMaterial;\n\n// Samplers\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D pbr_baseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D pbr_normalSampler;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D pbr_emissiveSampler;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D pbr_metallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D pbr_occlusionSampler;\n#endif\n#ifdef USE_IBL\nuniform samplerCube pbr_diffuseEnvSampler;\nuniform samplerCube pbr_specularEnvSampler;\nuniform sampler2D pbr_brdfLUT;\n#endif\n\n// Inputs from vertex shader\n\nin vec3 pbr_vPosition;\nin vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nin mat3 pbr_vTBN;\n#else\nin vec3 pbr_vNormal;\n#endif\n#endif\n\n// Encapsulate the various inputs used by the various functions in the shading equation\n// We store values in this struct to simplify the integration of alternative implementations\n// of the shading terms, outlined in the Readme.MD Appendix.\nstruct PBRInfo {\n  float NdotL;                  // cos angle between normal and light direction\n  float NdotV;                  // cos angle between normal and view direction\n  float NdotH;                  // cos angle between normal and half vector\n  float LdotH;                  // cos angle between light direction and half vector\n  float VdotH;                  // cos angle between view direction and half vector\n  float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\n  float metalness;              // metallic value at the surface\n  vec3 reflectance0;            // full reflectance color (normal incidence angle)\n  vec3 reflectance90;           // reflectance color at grazing angle\n  float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\n  vec3 diffuseColor;            // color contribution from diffuse lighting\n  vec3 specularColor;           // color contribution from specular lighting\n  vec3 n;                       // normal at surface point\n  vec3 v;                       // vector from surface point to camera\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else // SRGB_FAST_APPROXIMATION\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif //SRGB_FAST_APPROXIMATION\n  return vec4(linOut,srgbIn.w);;\n#else //MANUAL_SRGB\n  return srgbIn;\n#endif //MANUAL_SRGB\n}\n\n// Find the normal for this fragment, pulling either from a predefined normal map\n// or from the interpolated mesh normal and tangent attributes.\nvec3 getNormal()\n{\n  // Retrieve the tangent space matrix\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else // HAS_TANGENTS\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture(pbr_normalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(pbrMaterial.normalScale, pbrMaterial.normalScale, 1.0)));\n#else\n  // The tbn matrix is linearly interpolated, so we need to re-normalize\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n// Calculation of the lighting contribution from an optional Image Based Light source.\n// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].\n// See our README.md on Environment Maps [3] for additional discussion.\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInfo, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0; // resolution of 512x512\n  float lod = (pbrInfo.perceptualRoughness * mipCount);\n  // retrieve a scale and bias to F0. See [1], Figure 3\n  vec3 brdf = SRGBtoLINEAR(texture(pbr_brdfLUT,\n    vec2(pbrInfo.NdotV, 1.0 - pbrInfo.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(texture(pbr_diffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(texture(pbr_specularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(texture(pbr_specularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;\n  vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);\n\n  // For presentation, this allows us to disable IBL terms\n  diffuse *= pbrMaterial.scaleIBLAmbient.x;\n  specular *= pbrMaterial.scaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n// Basic Lambertian diffuse\n// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\n// See also [1], Equation 1\nvec3 diffuse(PBRInfo pbrInfo)\n{\n  return pbrInfo.diffuseColor / M_PI;\n}\n\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\n// Implementation of fresnel from [4], Equation 15\nvec3 specularReflection(PBRInfo pbrInfo)\n{\n  return pbrInfo.reflectance0 +\n    (pbrInfo.reflectance90 - pbrInfo.reflectance0) *\n    pow(clamp(1.0 - pbrInfo.VdotH, 0.0, 1.0), 5.0);\n}\n\n// This calculates the specular geometric attenuation (aka G()),\n// where rougher material will reflect less light back to the viewer.\n// This implementation is based on [1] Equation 4, and we adopt their modifications to\n// alphaRoughness as input as originally proposed in [2].\nfloat geometricOcclusion(PBRInfo pbrInfo)\n{\n  float NdotL = pbrInfo.NdotL;\n  float NdotV = pbrInfo.NdotV;\n  float r = pbrInfo.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n// The following equation(s) model the distribution of microfacet normals across\n// the area being drawn (aka D())\n// Implementation from \"Average Irregularity Representation of a Roughened Surface\n// for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes\n// from EPIC Games [1], Equation 3.\nfloat microfacetDistribution(PBRInfo pbrInfo)\n{\n  float roughnessSq = pbrInfo.alphaRoughness * pbrInfo.alphaRoughness;\n  float f = (pbrInfo.NdotH * roughnessSq - pbrInfo.NdotH) * pbrInfo.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInfo) {\n  pbrInfo.NdotL = 1.0;\n  pbrInfo.NdotH = 0.0;\n  pbrInfo.LdotH = 0.0;\n  pbrInfo.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInfo, vec3 lightDirection) {\n  vec3 n = pbrInfo.n;\n  vec3 v = pbrInfo.v;\n  vec3 l = normalize(lightDirection);             // Vector from surface point to light\n  vec3 h = normalize(l+v);                        // Half vector between both l and v\n\n  pbrInfo.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInfo.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInfo.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInfo.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInfo, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInfo, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInfo, vec3 lightColor) {\n  // Calculate the shading terms for the microfacet specular shading model\n  vec3 F = specularReflection(pbrInfo);\n  float G = geometricOcclusion(pbrInfo);\n  float D = microfacetDistribution(pbrInfo);\n\n  // Calculation of analytical lighting contribution\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInfo);\n  vec3 specContrib = F * G * D / (4.0 * pbrInfo.NdotL * pbrInfo.NdotV);\n  // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\n  return pbrInfo.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n  // The albedo may be defined from a base texture or a flat color\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture(pbr_baseColorSampler, pbr_vUV)) * pbrMaterial.baseColorFactor;\n#else\n  vec4 baseColor = pbrMaterial.baseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < pbrMaterial.alphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbrMaterial.unlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n    // Metallic and Roughness material properties are packed together\n    // In glTF, these factors can be specified by fixed scalar values\n    // or from a metallic-roughness map\n    float perceptualRoughness = pbrMaterial.metallicRoughnessValues.y;\n    float metallic = pbrMaterial.metallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\n    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\n    vec4 mrSample = texture(pbr_metallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n    // Roughness is authored as perceptual roughness; as is convention,\n    // convert to material roughness by squaring the perceptual roughness [2].\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n\n    // Compute reflectance.\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n    // For typical incident reflectance range (between 4% to 100%) set the grazing\n    // reflectance to 100% for typical fresnel effect.\n    // For very low reflectance range on highly diffuse objects (below 4%),\n    // incrementally reduce grazing reflecance to 0%.\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();                          // normal at surface point\n    vec3 v = normalize(pbrProjection.camera - pbr_vPosition);  // Vector from surface point to camera\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInfo = PBRInfo(\n      0.0, // NdotL\n      NdotV,\n      0.0, // NdotH\n      0.0, // LdotH\n      0.0, // VdotH\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n\n#ifdef USE_LIGHTS\n    // Apply ambient light\n    PBRInfo_setAmbientLight(pbrInfo);\n    color += calculateFinalColor(pbrInfo, lighting.ambientColor);\n\n    // Apply directional light\n    for(int i = 0; i < lighting.directionalLightCount; i++) {\n      if (i < lighting.directionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInfo, lighting_getDirectionalLight(i).direction);\n        color += calculateFinalColor(pbrInfo, lighting_getDirectionalLight(i).color);\n      }\n    }\n\n    // Apply point light\n    for(int i = 0; i < lighting.pointLightCount; i++) {\n      if (i < lighting.pointLightCount) {\n        PBRInfo_setPointLight(pbrInfo, lighting_getPointLight(i));\n        float attenuation = getPointLightAttenuation(lighting_getPointLight(i), distance(lighting_getPointLight(i).position, pbr_vPosition));\n        color += calculateFinalColor(pbrInfo, lighting_getPointLight(i).color / attenuation);\n      }\n    }\n#endif\n\n    // Calculate lighting contribution from image based lighting source (IBL)\n#ifdef USE_IBL\n    if (pbrMaterial.IBLenabled) {\n      color += getIBLContribution(pbrInfo, n, reflection);\n    }\n#endif\n\n // Apply optional PBR terms for additional (optional) shading\n#ifdef HAS_OCCLUSIONMAP\n    if (pbrMaterial.occlusionMapEnabled) {\n      float ao = texture(pbr_occlusionSampler, pbr_vUV).r;\n      color = mix(color, color * ao, pbrMaterial.occlusionStrength);\n    }\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    if (pbrMaterial.emissiveMapEnabled) {\n      vec3 emissive = SRGBtoLINEAR(texture(pbr_emissiveSampler, pbr_vUV)).rgb * pbrMaterial.emissiveFactor;\n      color += emissive;\n    }\n#endif\n\n    // This section uses mix to override final color for reference app visualization\n    // of various parameters in the lighting equation.\n#ifdef PBR_DEBUG\n    // TODO: Figure out how to debug multiple lights\n\n    // color = mix(color, F, pbr_scaleFGDSpec.x);\n    // color = mix(color, vec3(G), pbr_scaleFGDSpec.y);\n    // color = mix(color, vec3(D), pbr_scaleFGDSpec.z);\n    // color = mix(color, specContrib, pbr_scaleFGDSpec.w);\n\n    // color = mix(color, diffuseContrib, pbr_scaleDiffBaseMR.x);\n    color = mix(color, baseColor.rgb, pbrMaterial.scaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), pbrMaterial.scaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), pbrMaterial.scaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n`;var NQ=`struct PBRFragmentInputs {\n  pbr_vPosition: vec3f,\n  pbr_vUV: vec2f,\n  pbr_vTBN: mat3f,\n  pbr_vNormal: vec3f\n};\n\nvar fragmentInputs: PBRFragmentInputs;\n\nfn pbr_setPositionNormalTangentUV(position: vec4f, normal: vec4f, tangent: vec4f, uv: vec2f)\n{\n  var pos: vec4f = pbrProjection.modelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  let normalW: vec3f = normalize(vec3(pbrProjection.normalMatrix * vec4(normal.xyz, 0.0)));\n  let tangentW: vec3f = normalize(vec3(pbrProjection.modelMatrix * vec4(tangent.xyz, 0.0)));\n  let bitangentW: vec3f = cross(normalW, tangentW) * tangent.w;\n  fragmentInputs,pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else // HAS_TANGENTS != 1\n  fragmentInputs.pbr_vNormal = normalize(vec3(pbrProjection.modelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n\nstruct pbrMaterialUniforms {\n  // Material is unlit\n  unlit: uint32,\n\n  // Base color map\n  baseColorMapEnabled: uint32,\n  baseColorFactor: vec4f,\n\n  normalMapEnabled : uint32,\n  normalScale: f32,  // #ifdef HAS_NORMALMAP\n\n  emissiveMapEnabled: uint32,\n  emissiveFactor: vec3f, // #ifdef HAS_EMISSIVEMAP\n\n  metallicRoughnessValues: vec2f,\n  metallicRoughnessMapEnabled: uint32,\n\n  occlusionMapEnabled: i32,\n  occlusionStrength: f32, // #ifdef HAS_OCCLUSIONMAP\n  \n  alphaCutoffEnabled: i32,\n  alphaCutoff: f32, // #ifdef ALPHA_CUTOFF\n  \n  // IBL\n  IBLenabled: i32,\n  scaleIBLAmbient: vec2f, // #ifdef USE_IBL\n  \n  // debugging flags used for shader output of intermediate PBR variables\n  // #ifdef PBR_DEBUG\n  scaleDiffBaseMR: vec4f,\n  scaleFGDSpec: vec4f\n  // #endif\n} \n  \n@binding(2) @group(0) var<uniform> material : pbrMaterialUniforms;\n\n// Samplers\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D pbr_baseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D pbr_normalSampler;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D pbr_emissiveSampler;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D pbr_metallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D pbr_occlusionSampler;\n#endif\n#ifdef USE_IBL\nuniform samplerCube pbr_diffuseEnvSampler;\nuniform samplerCube pbr_specularEnvSampler;\nuniform sampler2D pbr_brdfLUT;\n#endif\n\n// Encapsulate the various inputs used by the various functions in the shading equation\n// We store values in this struct to simplify the integration of alternative implementations\n// of the shading terms, outlined in the Readme.MD Appendix.\nstruct PBRInfo {\n  NdotL: f32,                  // cos angle between normal and light direction\n  NdotV: f32,                  // cos angle between normal and view direction\n  NdotH: f32,                  // cos angle between normal and half vector\n  LdotH: f32,                  // cos angle between light direction and half vector\n  VdotH: f32,                  // cos angle between view direction and half vector\n  perceptualRoughness: f32,    // roughness value, as authored by the model creator (input to shader)\n  metalness: f32,              // metallic value at the surface\n  reflectance0: vec3f,            // full reflectance color (normal incidence angle)\n  reflectance90: vec3f,           // reflectance color at grazing angle\n  alphaRoughness: f32,         // roughness mapped to a more linear change in the roughness (proposed by [2])\n  diffuseColor: vec3f,            // color contribution from diffuse lighting\n  specularColor: vec3f,           // color contribution from specular lighting\n  n: vec3f,                       // normal at surface point\n  v: vec3f,                       // vector from surface point to camera\n};\n\nconst M_PI = 3.141592653589793;\nconst c_MinRoughness = 0.04;\n\nfn SRGBtoLINEAR(srgbIn: vec4f ) -> vec4f\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  var linOut: vec3f = pow(srgbIn.xyz,vec3(2.2));\n#else // SRGB_FAST_APPROXIMATION\n  var bLess: vec3f = step(vec3(0.04045),srgbIn.xyz);\n  var linOut: vec3f = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif //SRGB_FAST_APPROXIMATION\n  return vec4f(linOut,srgbIn.w);;\n#else //MANUAL_SRGB\n  return srgbIn;\n#endif //MANUAL_SRGB\n}\n\n// Find the normal for this fragment, pulling either from a predefined normal map\n// or from the interpolated mesh normal and tangent attributes.\nfn getNormal() -> vec3f\n{\n  // Retrieve the tangent space matrix\n#ifndef HAS_TANGENTS\n  var pos_dx: vec3f = dFdx(pbr_vPosition);\n  var pos_dy: vec3f = dFdy(pbr_vPosition);\n  var tex_dx: vec3f = dFdx(vec3(pbr_vUV, 0.0));\n  var tex_dy: vec3f = dFdy(vec3(pbr_vUV, 0.0));\n  var t: vec3f = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  var ng: vec3f = normalize(pbr_vNormal);\n#else\n  var ng: vec3f = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  var b: vec3f = normalize(cross(ng, t));\n  var tbn: mat3f = mat3f(t, b, ng);\n#else // HAS_TANGENTS\n  var tbn: mat3f = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture(pbr_normalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(pbrMaterial.normalScale, pbrMaterial.normalScale, 1.0)));\n#else\n  // The tbn matrix is linearly interpolated, so we need to re-normalize\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n// Calculation of the lighting contribution from an optional Image Based Light source.\n// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].\n// See our README.md on Environment Maps [3] for additional discussion.\n#ifdef USE_IBL\nfn getIBLContribution(PBRInfo pbrInfo, vec3 n, vec3 reflection) -> vec3f\n{\n  float mipCount = 9.0; // resolution of 512x512\n  float lod = (pbrInfo.perceptualRoughness * mipCount);\n  // retrieve a scale and bias to F0. See [1], Figure 3\n  vec3 brdf = SRGBtoLINEAR(texture(pbr_brdfLUT,\n    vec2(pbrInfo.NdotV, 1.0 - pbrInfo.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(texture(pbr_diffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(texture(pbr_specularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(texture(pbr_specularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;\n  vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);\n\n  // For presentation, this allows us to disable IBL terms\n  diffuse *= pbrMaterial.scaleIBLAmbient.x;\n  specular *= pbrMaterial.scaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n// Basic Lambertian diffuse\n// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\n// See also [1], Equation 1\nfn diffuse(pbrInfo: PBRInfo) -> vec3<f32> {\n  return pbrInfo.diffuseColor / PI;\n}\n\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\n// Implementation of fresnel from [4], Equation 15\nfn specularReflection(pbrInfo: PBRInfo) -> vec3<f32> {\n  return pbrInfo.reflectance0 +\n    (pbrInfo.reflectance90 - pbrInfo.reflectance0) *\n    pow(clamp(1.0 - pbrInfo.VdotH, 0.0, 1.0), 5.0);\n}\n\n// This calculates the specular geometric attenuation (aka G()),\n// where rougher material will reflect less light back to the viewer.\n// This implementation is based on [1] Equation 4, and we adopt their modifications to\n// alphaRoughness as input as originally proposed in [2].\nfn geometricOcclusion(pbrInfo: PBRInfo) -> f32 {\n  let NdotL: f32 = pbrInfo.NdotL;\n  let NdotV: f32 = pbrInfo.NdotV;\n  let r: f32 = pbrInfo.alphaRoughness;\n\n  let attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  let attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n// The following equation(s) model the distribution of microfacet normals across\n// the area being drawn (aka D())\n// Implementation from \"Average Irregularity Representation of a Roughened Surface\n// for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes\n// from EPIC Games [1], Equation 3.\nfn microfacetDistribution(pbrInfo: PBRInfo) -> f32 {\n  let roughnessSq = pbrInfo.alphaRoughness * pbrInfo.alphaRoughness;\n  let f = (pbrInfo.NdotH * roughnessSq - pbrInfo.NdotH) * pbrInfo.NdotH + 1.0;\n  return roughnessSq / (PI * f * f);\n}\n\nfn PBRInfo_setAmbientLight(pbrInfo: ptr<function, PBRInfo>) {\n  (*pbrInfo).NdotL = 1.0;\n  (*pbrInfo).NdotH = 0.0;\n  (*pbrInfo).LdotH = 0.0;\n  (*pbrInfo).VdotH = 1.0;\n}\n\nfn PBRInfo_setDirectionalLight(pbrInfo: ptr<function, PBRInfo>, lightDirection: vec3<f32>) {\n  let n = (*pbrInfo).n;\n  let v = (*pbrInfo).v;\n  let l = normalize(lightDirection);             // Vector from surface point to light\n  let h = normalize(l + v);                      // Half vector between both l and v\n\n  (*pbrInfo).NdotL = clamp(dot(n, l), 0.001, 1.0);\n  (*pbrInfo).NdotH = clamp(dot(n, h), 0.0, 1.0);\n  (*pbrInfo).LdotH = clamp(dot(l, h), 0.0, 1.0);\n  (*pbrInfo).VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nfn PBRInfo_setPointLight(pbrInfo: ptr<function, PBRInfo>, pointLight: PointLight) {\n  let light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInfo, light_direction);\n}\n\nfn calculateFinalColor(pbrInfo: PBRInfo, lightColor: vec3<f32>) -> vec3<f32> {\n  // Calculate the shading terms for the microfacet specular shading model\n  let F = specularReflection(pbrInfo);\n  let G = geometricOcclusion(pbrInfo);\n  let D = microfacetDistribution(pbrInfo);\n\n  // Calculation of analytical lighting contribution\n  let diffuseContrib = (1.0 - F) * diffuse(pbrInfo);\n  let specContrib = F * G * D / (4.0 * pbrInfo.NdotL * pbrInfo.NdotV);\n  // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\n  return pbrInfo.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nfn pbr_filterColor(colorUnused: vec4<f32>) -> vec4<f32> {\n  // The albedo may be defined from a base texture or a flat color\n  var baseColor: vec4<f32>;\n  #ifdef HAS_BASECOLORMAP\n  baseColor = SRGBtoLINEAR(textureSample(pbr_baseColorSampler, pbr_baseColorSampler, pbr_vUV)) * pbrMaterial.baseColorFactor;\n  #else\n  baseColor = pbrMaterial.baseColorFactor;\n  #endif\n\n  #ifdef ALPHA_CUTOFF\n  if (baseColor.a < pbrMaterial.alphaCutoff) {\n    discard;\n  }\n  #endif\n\n  var color = vec3<f32>(0.0, 0.0, 0.0);\n\n  if (pbrMaterial.unlit) {\n    color = baseColor.rgb;\n  } else {\n    // Metallic and Roughness material properties are packed together\n    // In glTF, these factors can be specified by fixed scalar values\n    // or from a metallic-roughness map\n    var perceptualRoughness = pbrMaterial.metallicRoughnessValues.y;\n    var metallic = pbrMaterial.metallicRoughnessValues.x;\n    #ifdef HAS_METALROUGHNESSMAP\n    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\n    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\n    let mrSample = textureSample(pbr_metallicRoughnessSampler, pbr_metallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n    #endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n    // Roughness is authored as perceptual roughness; as is convention,\n    // convert to material roughness by squaring the perceptual roughness [2].\n    let alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    let f0 = vec3<f32>(0.04);\n    var diffuseColor = baseColor.rgb * (vec3<f32>(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    let specularColor = mix(f0, baseColor.rgb, metallic);\n\n    // Compute reflectance.\n    let reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n    // For typical incident reflectance range (between 4% to 100%) set the grazing\n    // reflectance to 100% for typical fresnel effect.\n    // For very low reflectance range on highly diffuse objects (below 4%),\n    // incrementally reduce grazing reflectance to 0%.\n    let reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    let specularEnvironmentR0 = specularColor;\n    let specularEnvironmentR90 = vec3<f32>(1.0, 1.0, 1.0) * reflectance90;\n\n    let n = getNormal();                          // normal at surface point\n    let v = normalize(pbrProjection.camera - pbr_vPosition);  // Vector from surface point to camera\n\n    let NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    let reflection = -normalize(reflect(v, n));\n\n    var pbrInfo = PBRInfo(\n      0.0, // NdotL\n      NdotV,\n      0.0, // NdotH\n      0.0, // LdotH\n      0.0, // VdotH\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n    #ifdef USE_LIGHTS\n    // Apply ambient light\n    PBRInfo_setAmbientLight(&pbrInfo);\n    color += calculateFinalColor(pbrInfo, lighting.ambientColor);\n\n    // Apply directional light\n    for (var i = 0; i < lighting.directionalLightCount; i++) {\n      if (i < lighting.directionalLightCount) {\n        PBRInfo_setDirectionalLight(&pbrInfo, lighting_getDirectionalLight(i).direction);\n        color += calculateFinalColor(pbrInfo, lighting_getDirectionalLight(i).color);\n      }\n    }\n\n    // Apply point light\n    for (var i = 0; i < lighting.pointLightCount; i++) {\n      if (i < lighting.pointLightCount) {\n        PBRInfo_setPointLight(&pbrInfo, lighting_getPointLight(i));\n        let attenuation = getPointLightAttenuation(lighting_getPointLight(i), distance(lighting_getPointLight(i).position, pbr_vPosition));\n        color += calculateFinalColor(pbrInfo, lighting_getPointLight(i).color / attenuation);\n      }\n    }\n    #endif\n\n    // Calculate lighting contribution from image based lighting source (IBL)\n    #ifdef USE_IBL\n    if (pbrMaterial.IBLenabled) {\n      color += getIBLContribution(pbrInfo, n, reflection);\n    }\n    #endif\n\n    // Apply optional PBR terms for additional (optional) shading\n    #ifdef HAS_OCCLUSIONMAP\n    if (pbrMaterial.occlusionMapEnabled) {\n      let ao = textureSample(pbr_occlusionSampler, pbr_occlusionSampler, pbr_vUV).r;\n      color = mix(color, color * ao, pbrMaterial.occlusionStrength);\n    }\n    #endif\n\n    #ifdef HAS_EMISSIVEMAP\n    if (pbrMaterial.emissiveMapEnabled) {\n      let emissive = SRGBtoLINEAR(textureSample(pbr_emissiveSampler, pbr_emissiveSampler, pbr_vUV)).rgb * pbrMaterial.emissiveFactor;\n      color += emissive;\n    }\n    #endif\n\n    // This section uses mix to override final color for reference app visualization\n    // of various parameters in the lighting equation.\n    #ifdef PBR_DEBUG\n    // TODO: Figure out how to debug multiple lights\n\n    // color = mix(color, F, pbr_scaleFGDSpec.x);\n    // color = mix(color, vec3(G), pbr_scaleFGDSpec.y);\n    // color = mix(color, vec3(D), pbr_scaleFGDSpec.z);\n    // color = mix(color, specContrib, pbr_scaleFGDSpec.w);\n\n    // color = mix(color, diffuseContrib, pbr_scaleDiffBaseMR.x);\n    color = mix(color, baseColor.rgb, pbrMaterial.scaleDiffBaseMR.y);\n    color = mix(color, vec3<f32>(metallic), pbrMaterial.scaleDiffBaseMR.z);\n    color = mix(color, vec3<f32>(perceptualRoughness), pbrMaterial.scaleDiffBaseMR.w);\n    #endif\n  }\n\n  return vec4<f32>(pow(color, vec3<f32>(1.0 / 2.2)), baseColor.a);\n}\n`;var zQ=`uniform pbrProjectionUniforms {\n  mat4 modelViewProjectionMatrix;\n  mat4 modelMatrix;\n  mat4 normalMatrix;\n  vec3 camera;\n} pbrProjection;\n`,UQ={name:\"pbrProjection\",vs:zQ,fs:zQ,getUniforms:t=>t,uniformTypes:{modelViewProjectionMatrix:\"mat4x4<f32>\",modelMatrix:\"mat4x4<f32>\",normalMatrix:\"mat4x4<f32>\",camera:\"vec3<i32>\"}};var Gm={props:{},uniforms:{},name:\"pbrMaterial\",dependencies:[Ip,UQ],source:NQ,vs:FQ,fs:kQ,defines:{LIGHTING_FRAGMENT:!0,HAS_NORMALMAP:!1,HAS_EMISSIVEMAP:!1,HAS_OCCLUSIONMAP:!1,HAS_BASECOLORMAP:!1,HAS_METALROUGHNESSMAP:!1,ALPHA_CUTOFF:!1,USE_IBL:!1,PBR_DEBUG:!1},getUniforms:t=>t,uniformTypes:{unlit:\"i32\",baseColorMapEnabled:\"i32\",baseColorFactor:\"vec4<f32>\",normalMapEnabled:\"i32\",normalScale:\"f32\",emissiveMapEnabled:\"i32\",emissiveFactor:\"vec3<f32>\",metallicRoughnessValues:\"vec2<f32>\",metallicRoughnessMapEnabled:\"i32\",occlusionMapEnabled:\"i32\",occlusionStrength:\"f32\",alphaCutoffEnabled:\"i32\",alphaCutoff:\"f32\",IBLenabled:\"i32\",scaleIBLAmbient:\"vec2<f32>\",scaleDiffBaseMR:\"vec4<f32>\",scaleFGDSpec:\"vec4<f32>\"}};var VQ=`uniform layerUniforms {\n  uniform float opacity;\n} layer;\n`,gF={name:\"layer\",vs:VQ,fs:VQ,getUniforms:t=>({opacity:Math.pow(t.opacity,.45454545454545453)}),uniformTypes:{opacity:\"f32\"}};var F2e=`\n\nstruct ColorUniforms {\n  opacity: f32,\n};\n\nvar<private> color: ColorUniforms = ColorUniforms(1.0);\n// TODO (kaapp) avoiding binding index collisions to handle layer opacity \n// requires some thought.\n// @group(0) @binding(0) var<uniform> color: ColorUniforms;\n\n@must_use\nfn deckgl_premultiplied_alpha(fragColor: vec4<f32>) -> vec4<f32> {\n    return vec4(fragColor.rgb * fragColor.a, fragColor.a); \n};\n`,PA={name:\"color\",dependencies:[],source:F2e,getUniforms:t=>({}),uniformTypes:{opacity:\"f32\"}};var k2e=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;\n\nstruct VertexGeometry {\n  position: vec4<f32>,\n  worldPosition: vec3<f32>,\n  worldPositionAlt: vec3<f32>,\n  normal: vec3<f32>,\n  uv: vec2<f32>,\n  pickingColor: vec3<f32>,\n};\n\nvar<private> geometry_: VertexGeometry = VertexGeometry(\n  vec4<f32>(0.0, 0.0, 1.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec2<f32>(0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0)\n);\n\nstruct FragmentGeometry {\n  uv: vec2<f32>,\n};\n\nvar<private> fragmentGeometry: FragmentGeometry;\n\nfn smoothedge(edge: f32, x: f32) -> f32 {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n`,GQ=\"#define SMOOTH_EDGE_RADIUS 0.5\",N2e=`${GQ}\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n`,z2e=`${GQ}\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n`,FM={name:\"geometry\",source:k2e,vs:N2e,fs:z2e};var Di;(function(t){t[t.Start=1]=\"Start\",t[t.Move=2]=\"Move\",t[t.End=4]=\"End\",t[t.Cancel=8]=\"Cancel\"})(Di||(Di={}));var Po;(function(t){t[t.None=0]=\"None\",t[t.Left=1]=\"Left\",t[t.Right=2]=\"Right\",t[t.Up=4]=\"Up\",t[t.Down=8]=\"Down\",t[t.Horizontal=3]=\"Horizontal\",t[t.Vertical=12]=\"Vertical\",t[t.All=15]=\"All\"})(Po||(Po={}));var Xn;(function(t){t[t.Possible=1]=\"Possible\",t[t.Began=2]=\"Began\",t[t.Changed=4]=\"Changed\",t[t.Ended=8]=\"Ended\",t[t.Recognized=8]=\"Recognized\",t[t.Cancelled=16]=\"Cancelled\",t[t.Failed=32]=\"Failed\"})(Xn||(Xn={}));var HQ=\"compute\",mF=\"auto\",Yb=\"manipulation\",Hm=\"none\",Zb=\"pan-x\",qb=\"pan-y\";function _F(t){if(t.includes(Hm))return Hm;let e=t.includes(Zb),n=t.includes(qb);return e&&n?Hm:e||n?e?Zb:qb:t.includes(Yb)?Yb:mF}var Qb=class{constructor(e,n){this.actions=\"\",this.manager=e,this.set(n)}set(e){e===HQ&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(let n of this.manager.recognizers)n.options.enable&&(e=e.concat(n.getTouchAction()));return _F(e.join(\" \"))}};function By(t){return t.trim().split(/\\s+/g)}function kM(t,e,n){if(t)for(let r of By(e))t.addEventListener(r,n,!1)}function NM(t,e,n){if(t)for(let r of By(e))t.removeEventListener(r,n,!1)}function yF(t){return(t.ownerDocument||t).defaultView}function xF(t,e){let n=t;for(;n;){if(n===e)return!0;n=n.parentNode}return!1}function zM(t){let e=t.length;if(e===1)return{x:Math.round(t[0].clientX),y:Math.round(t[0].clientY)};let n=0,r=0,i=0;for(;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:Math.round(n/e),y:Math.round(r/e)}}function vF(t){let e=[],n=0;for(;n<t.pointers.length;)e[n]={clientX:Math.round(t.pointers[n].clientX),clientY:Math.round(t.pointers[n].clientY)},n++;return{timeStamp:Date.now(),pointers:e,center:zM(e),deltaX:t.deltaX,deltaY:t.deltaY}}function UM(t,e){let n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function bF(t,e){let n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.sqrt(n*n+r*r)}function WQ(t,e){let n=e.x-t.x,r=e.y-t.y;return Math.atan2(r,n)*180/Math.PI}function wF(t,e){let n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.atan2(r,n)*180/Math.PI}function VM(t,e){return t===e?Po.None:Math.abs(t)>=Math.abs(e)?t<0?Po.Left:Po.Right:e<0?Po.Up:Po.Down}function jQ(t,e){let n=e.center,r=t.offsetDelta,i=t.prevDelta,o=t.prevInput;return(e.eventType===Di.Start||o?.eventType===Di.End)&&(i=t.prevDelta={x:o?.deltaX||0,y:o?.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),{deltaX:i.x+(n.x-r.x),deltaY:i.y+(n.y-r.y)}}function GM(t,e,n){return{x:e/t||0,y:n/t||0}}function XQ(t,e){return bF(e[0],e[1])/bF(t[0],t[1])}function YQ(t,e){return wF(e[1],e[0])-wF(t[1],t[0])}function ZQ(t,e){let n=t.lastInterval||e,r=e.timeStamp-n.timeStamp,i,o,s,c;if(e.eventType!==Di.Cancel&&(r>25||n.velocity===void 0)){let d=e.deltaX-n.deltaX,m=e.deltaY-n.deltaY,b=GM(r,d,m);o=b.x,s=b.y,i=Math.abs(b.x)>Math.abs(b.y)?b.x:b.y,c=VM(d,m),t.lastInterval=e}else i=n.velocity,o=n.velocityX,s=n.velocityY,c=n.direction;e.velocity=i,e.velocityX=o,e.velocityY=s,e.direction=c}function qQ(t,e){let{session:n}=t,{pointers:r}=e,{length:i}=r;n.firstInput||(n.firstInput=vF(e)),i>1&&!n.firstMultiple?n.firstMultiple=vF(e):i===1&&(n.firstMultiple=!1);let{firstInput:o,firstMultiple:s}=n,c=s?s.center:o.center,d=e.center=zM(r);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=WQ(c,d),e.distance=UM(c,d);let{deltaX:m,deltaY:b}=jQ(n,e);e.deltaX=m,e.deltaY=b,e.offsetDirection=VM(e.deltaX,e.deltaY);let C=GM(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=C.x,e.overallVelocityY=C.y,e.overallVelocity=Math.abs(C.x)>Math.abs(C.y)?C.x:C.y,e.scale=s?XQ(s.pointers,r):1,e.rotation=s?YQ(s.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length;let B=t.element;return xF(e.srcEvent.target,B)&&(B=e.srcEvent.target),e.target=B,ZQ(n,e),e}function QQ(t,e,n){let r=n.pointers.length,i=n.changedPointers.length,o=e&Di.Start&&r-i===0,s=e&(Di.End|Di.Cancel)&&r-i===0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e;let c=qQ(t,n);t.emit(\"hammer.input\",c),t.recognize(c),t.session.prevInput=c}var Kb=class{constructor(e){this.evEl=\"\",this.evWin=\"\",this.evTarget=\"\",this.domHandler=n=>{this.manager.options.enable&&this.handler(n)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,n){QQ(this.manager,e,n)}init(){kM(this.element,this.evEl,this.domHandler),kM(this.target,this.evTarget,this.domHandler),kM(yF(this.element),this.evWin,this.domHandler)}destroy(){NM(this.element,this.evEl,this.domHandler),NM(this.target,this.evTarget,this.domHandler),NM(yF(this.element),this.evWin,this.domHandler)}};var V2e={pointerdown:Di.Start,pointermove:Di.Move,pointerup:Di.End,pointercancel:Di.Cancel,pointerout:Di.Cancel},G2e=\"pointerdown\",H2e=\"pointermove pointerup pointercancel\",Jb=class extends Kb{constructor(e){super(e),this.evEl=G2e,this.evWin=H2e,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){let{store:n}=this,r=!1,i=V2e[e.type],o=e.pointerType,s=o===\"touch\",c=n.findIndex(d=>d.pointerId===e.pointerId);i&Di.Start&&(e.buttons||s)?c<0&&(n.push(e),c=n.length-1):i&(Di.End|Di.Cancel)&&(r=!0),!(c<0)&&(n[c]=e,this.callback(i,{pointers:n,changedPointers:[e],eventType:i,pointerType:o,srcEvent:e}),r&&n.splice(c,1))}};var W2e=[\"\",\"webkit\",\"Moz\",\"MS\",\"ms\",\"o\"];function KQ(t,e){let n=e[0].toUpperCase()+e.slice(1);for(let r of W2e){let i=r?r+n:e;if(i in t)return i}}var j2e=1,JQ=2,$Q={touchAction:\"compute\",enable:!0,inputTarget:null,cssProps:{userSelect:\"none\",userDrag:\"none\",touchCallout:\"none\",tapHighlightColor:\"rgba(0,0,0,0)\"}},$b=class{constructor(e,n){this.options={...$Q,...n,cssProps:{...$Q.cssProps,...n.cssProps},inputTarget:n.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new Jb(this),this.touchAction=new Qb(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?JQ:j2e}recognize(e){let{session:n}=this;if(n.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let r,{recognizers:i}=this,{curRecognizer:o}=n;(!o||o&&o.state&Xn.Recognized)&&(o=n.curRecognizer=null);let s=0;for(;s<i.length;)r=i[s],n.stopped!==JQ&&(!o||r===o||r.canRecognizeWith(o))?r.recognize(e):r.reset(),!o&&r.state&(Xn.Began|Xn.Changed|Xn.Ended)&&(o=n.curRecognizer=r),s++}get(e){let{recognizers:n}=this;for(let r=0;r<n.length;r++)if(n[r].options.event===e)return n[r];return null}add(e){if(Array.isArray(e)){for(let r of e)this.add(r);return this}let n=this.get(e.options.event);return n&&this.remove(n),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(let r of e)this.remove(r);return this}let n=typeof e==\"string\"?this.get(e):e;if(n){let{recognizers:r}=this,i=r.indexOf(n);i!==-1&&(r.splice(i,1),this.touchAction.update())}return this}on(e,n){if(!e||!n)return;let{handlers:r}=this;for(let i of By(e))r[i]=r[i]||[],r[i].push(n)}off(e,n){if(!e)return;let{handlers:r}=this;for(let i of By(e))n?r[i]&&r[i].splice(r[i].indexOf(n),1):delete r[i]}emit(e,n){let r=this.handlers[e]&&this.handlers[e].slice();if(!r||!r.length)return;let i=n;i.type=e,i.preventDefault=function(){n.srcEvent.preventDefault()};let o=0;for(;o<r.length;)r[o](i),o++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){let{element:n}=this;if(n){for(let[r,i]of Object.entries(this.options.cssProps)){let o=KQ(n.style,r);e?(this.oldCssProps[o]=n.style[o],n.style[o]=i):n.style[o]=this.oldCssProps[o]||\"\"}e||(this.oldCssProps={})}}};var X2e=1;function eK(){return X2e++}function TF(t){return t&Xn.Cancelled?\"cancel\":t&Xn.Ended?\"end\":t&Xn.Changed?\"move\":t&Xn.Began?\"start\":\"\"}var Rp=class{constructor(e){this.options=e,this.id=eK(),this.state=Xn.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(let i of e)this.recognizeWith(i);return this}let n;if(typeof e==\"string\"){if(n=this.manager.get(e),!n)throw new Error(`Cannot find recognizer ${e}`)}else n=e;let{simultaneous:r}=this;return r[n.id]||(r[n.id]=n,n.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(let r of e)this.dropRecognizeWith(r);return this}let n;return typeof e==\"string\"?n=this.manager.get(e):n=e,n&&delete this.simultaneous[n.id],this}requireFailure(e){if(Array.isArray(e)){for(let i of e)this.requireFailure(i);return this}let n;if(typeof e==\"string\"){if(n=this.manager.get(e),!n)throw new Error(`Cannot find recognizer ${e}`)}else n=e;let{requireFail:r}=this;return r.indexOf(n)===-1&&(r.push(n),n.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(let r of e)this.dropRequireFailure(r);return this}let n;if(typeof e==\"string\"?n=this.manager.get(e):n=e,n){let r=this.requireFail.indexOf(n);r>-1&&this.requireFail.splice(r,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;let{state:n}=this;n<Xn.Ended&&this.manager.emit(this.options.event+TF(n),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),n>=Xn.Ended&&this.manager.emit(this.options.event+TF(n),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Xn.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Xn.Failed|Xn.Possible)))return!1;e++}return!0}recognize(e){let n={...e};if(!this.options.enable){this.reset(),this.state=Xn.Failed;return}this.state&(Xn.Recognized|Xn.Cancelled|Xn.Failed)&&(this.state=Xn.Possible),this.state=this.process(n),this.state&(Xn.Began|Xn.Changed|Xn.Ended|Xn.Cancelled)&&this.tryEmit(n)}getEventNames(){return[this.options.event]}reset(){}};var Bp=class extends Rp{attrTest(e){let n=this.options.pointers;return n===0||e.pointers.length===n}process(e){let{state:n}=this,{eventType:r}=e,i=n&(Xn.Began|Xn.Changed),o=this.attrTest(e);return i&&(r&Di.Cancel||!o)?n|Xn.Cancelled:i||o?r&Di.End?n|Xn.Ended:n&Xn.Began?n|Xn.Changed:Xn.Began:Xn.Failed}};var Wm=class extends Rp{constructor(e={}){super({enable:!0,event:\"tap\",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[Yb]}process(e){let{options:n}=this,r=e.pointers.length===n.pointers,i=e.distance<n.threshold,o=e.deltaTime<n.time;if(this.reset(),e.eventType&Di.Start&&this.count===0)return this.failTimeout();if(i&&o&&r){if(e.eventType!==Di.End)return this.failTimeout();let s=this.pTime?e.timeStamp-this.pTime<n.interval:!0,c=!this.pCenter||UM(this.pCenter,e.center)<n.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!c||!s?this.count=1:this.count+=1,this._input=e,this.count%n.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Xn.Recognized,this.tryEmit(this._input)},n.interval),Xn.Began):Xn.Recognized}return Xn.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Xn.Failed},this.options.interval),Xn.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Xn.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}};var Y2e=[\"\",\"start\",\"move\",\"end\",\"cancel\",\"up\",\"down\",\"left\",\"right\"],RA=class extends Bp{constructor(e={}){super({enable:!0,pointers:1,event:\"pan\",threshold:10,direction:Po.All,...e}),this.pX=null,this.pY=null}getTouchAction(){let{options:{direction:e}}=this,n=[];return e&Po.Horizontal&&n.push(qb),e&Po.Vertical&&n.push(Zb),n}getEventNames(){return Y2e.map(e=>this.options.event+e)}directionTest(e){let{options:n}=this,r=!0,{distance:i}=e,{direction:o}=e,s=e.deltaX,c=e.deltaY;return o&n.direction||(n.direction&Po.Horizontal?(o=s===0?Po.None:s<0?Po.Left:Po.Right,r=s!==this.pX,i=Math.abs(e.deltaX)):(o=c===0?Po.None:c<0?Po.Up:Po.Down,r=c!==this.pY,i=Math.abs(e.deltaY))),e.direction=o,r&&i>n.threshold&&!!(o&n.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&Xn.Began)||!(this.state&Xn.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;let n=Po[e.direction].toLowerCase();n&&(e.additionalEvent=this.options.event+n),super.emit(e)}};var Z2e=[\"\",\"start\",\"move\",\"end\",\"cancel\",\"in\",\"out\"],Dy=class extends Bp{constructor(e={}){super({enable:!0,event:\"pinch\",threshold:0,pointers:2,...e})}getTouchAction(){return[Hm]}getEventNames(){return Z2e.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&Xn.Began))}emit(e){if(e.scale!==1){let n=e.scale<1?\"in\":\"out\";e.additionalEvent=this.options.event+n}super.emit(e)}};var $f=class{constructor(e,n,r){this.element=e,this.callback=n,this.options=r}};var tK=typeof navigator<\"u\"&&navigator.userAgent?navigator.userAgent.toLowerCase():\"\",vXe=typeof window<\"u\"?window:global;var J2e=tK.indexOf(\"firefox\")!==-1,nK=4.000244140625,$2e=40,exe=.25,HM=class extends $f{constructor(e,n,r){super(e,n,{enable:!0,...r}),this.handleEvent=i=>{if(!this.options.enable)return;let o=i.deltaY;globalThis.WheelEvent&&(J2e&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(o/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(o*=$2e)),o!==0&&o%nK===0&&(o=Math.floor(o/nK)),i.shiftKey&&o&&(o=o*exe),this.callback({type:\"wheel\",center:{x:i.clientX,y:i.clientY},delta:-o,srcEvent:i,pointerType:\"mouse\",target:i.target})},e.addEventListener(\"wheel\",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener(\"wheel\",this.handleEvent)}enableEventType(e,n){e===\"wheel\"&&(this.options.enable=n)}};var rK=[\"mousedown\",\"mousemove\",\"mouseup\",\"mouseover\",\"mouseout\",\"mouseleave\"],WM=class extends $f{constructor(e,n,r){super(e,n,{enable:!0,...r}),this.handleEvent=o=>{this.handleOverEvent(o),this.handleOutEvent(o),this.handleEnterEvent(o),this.handleLeaveEvent(o),this.handleMoveEvent(o)},this.pressed=!1;let{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,rK.forEach(o=>e.addEventListener(o,this.handleEvent))}destroy(){rK.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){switch(e){case\"pointermove\":this.enableMoveEvent=n;break;case\"pointerover\":this.enableOverEvent=n;break;case\"pointerout\":this.enableOutEvent=n;break;case\"pointerenter\":this.enableEnterEvent=n;break;case\"pointerleave\":this.enableLeaveEvent=n;break;default:}}handleOverEvent(e){this.enableOverEvent&&e.type===\"mouseover\"&&this._emit(\"pointerover\",e)}handleOutEvent(e){this.enableOutEvent&&e.type===\"mouseout\"&&this._emit(\"pointerout\",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type===\"mouseenter\"&&this._emit(\"pointerenter\",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type===\"mouseleave\"&&this._emit(\"pointerleave\",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case\"mousedown\":e.button>=0&&(this.pressed=!0);break;case\"mousemove\":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit(\"pointermove\",e);break;case\"mouseup\":this.pressed=!1;break;default:}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:\"mouse\",target:n.target})}};var iK=[\"keydown\",\"keyup\"],jM=class extends $f{constructor(e,n,r){super(e,n,{enable:!0,tabIndex:0,...r}),this.handleEvent=i=>{let o=i.target||i.srcElement;o.tagName===\"INPUT\"&&o.type===\"text\"||o.tagName===\"TEXTAREA\"||(this.enableDownEvent&&i.type===\"keydown\"&&this.callback({type:\"keydown\",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type===\"keyup\"&&this.callback({type:\"keyup\",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline=\"none\",iK.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){iK.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===\"keydown\"&&(this.enableDownEvent=n),e===\"keyup\"&&(this.enableUpEvent=n)}};var XM=class extends $f{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:\"contextmenu\",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:\"mouse\",target:i.target})},e.addEventListener(\"contextmenu\",this.handleEvent)}destroy(){this.element.removeEventListener(\"contextmenu\",this.handleEvent)}enableEventType(e,n){e===\"contextmenu\"&&(this.options.enable=n)}};var txe={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},nxe=0,rxe=1,ixe=2,oxe=1,sxe=2,axe=4;function oK(t){let e=txe[t.srcEvent.type];if(!e)return null;let{buttons:n,button:r}=t.srcEvent,i=!1,o=!1,s=!1;return e===2?(i=!!(n&oxe),o=!!(n&axe),s=!!(n&sxe)):(i=r===nxe,o=r===rxe,s=r===ixe),{leftButton:i,middleButton:o,rightButton:s}}function sK(t,e){let n=t.center;if(!n)return null;let r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,o=r.height/e.offsetHeight||1,s={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/o};return{center:n,offsetCenter:s}}var lxe={srcElement:\"root\",priority:0},YM=class{constructor(e,n){this.handleEvent=r=>{if(this.isEmpty())return;let i=this._normalizeEvent(r),o=r.srcEvent.target;for(;o&&o!==i.rootElement;){if(this._emit(i,o),i.handled)return;o=o.parentNode}this._emit(i,\"root\")},this.eventManager=e,this.recognizerName=n,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,o=!1){let{handlers:s,handlersByElement:c}=this,d={...lxe,...r},m=c.get(d.srcElement);m||(m=[],c.set(d.srcElement,m));let b={type:e,handler:n,srcElement:d.srcElement,priority:d.priority};i&&(b.once=!0),o&&(b.passive=!0),s.push(b),this._active=this._active||!b.passive;let C=m.length-1;for(;C>=0&&!(m[C].priority>=b.priority);)C--;m.splice(C+1,0,b)}remove(e,n){let{handlers:r,handlersByElement:i}=this;for(let o=r.length-1;o>=0;o--){let s=r[o];if(s.type===e&&s.handler===n){r.splice(o,1);let c=i.get(s.srcElement);c.splice(c.indexOf(s),1),c.length===0&&i.delete(s.srcElement)}}this._active=r.some(o=>!o.passive)}_emit(e,n){let r=this.handlersByElement.get(n);if(r){let i=!1,o=()=>{e.handled=!0},s=()=>{e.handled=!0,i=!0},c=[];for(let d=0;d<r.length;d++){let{type:m,handler:b,once:C}=r[d];if(b({...e,type:m,stopPropagation:o,stopImmediatePropagation:s}),C&&c.push(r[d]),i)break}for(let d=0;d<c.length;d++){let{type:m,handler:b}=c[d];this.remove(m,b)}}}_normalizeEvent(e){let n=this.eventManager.getElement();return{...e,...oK(e),...sK(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}};function cxe(t){if(\"recognizer\"in t)return t;let e,n=Array.isArray(t)?[...t]:[t];if(typeof n[0]==\"function\"){let r=n.shift(),i=n.shift()||{};e=new r(i)}else e=n.shift();return{recognizer:e,recognizeWith:typeof n[0]==\"string\"?[n[0]]:n[0],requireFailure:typeof n[1]==\"string\"?[n[1]]:n[1]}}var ew=class{constructor(e=null,n={}){if(this._onBasicInput=r=>{this.manager.emit(r.srcEvent.type,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={recognizers:[],events:{},touchAction:\"compute\",tabIndex:0,cssProps:{},...n},this.events=new Map,this.element=e,!!e){this.manager=new $b(e,this.options);for(let r of this.options.recognizers){let{recognizer:i,recognizeWith:o,requireFailure:s}=cxe(r);this.manager.add(i),o&&i.recognizeWith(o),s&&i.requireFailure(s)}this.manager.on(\"hammer.input\",this._onBasicInput),this.wheelInput=new HM(e,this._onOtherEvent,{enable:!1}),this.moveInput=new WM(e,this._onOtherEvent,{enable:!1}),this.keyInput=new jM(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new XM(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){let{manager:r}=this;if(!r)return;let i=r.get(e);i&&(i.set({enable:n}),r.touchAction.update()),this.wheelInput?.enableEventType(e,n),this.moveInput?.enableEventType(e,n),this.keyInput?.enableEventType(e,n),this.contextmenuInput?.enableEventType(e,n)}_addEventHandler(e,n,r,i,o){if(typeof e!=\"string\"){r=n;for(let[m,b]of Object.entries(e))this._addEventHandler(m,b,r,i,o);return}let{manager:s,events:c}=this;if(!s)return;let d=c.get(e);if(!d){let m=this._getRecognizerName(e)||e;d=new YM(this,m),c.set(e,d),s&&s.on(e,d.handleEvent)}d.add(e,n,r,i,o),d.isEmpty()||this._toggleRecognizer(d.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!=\"string\"){for(let[o,s]of Object.entries(e))this._removeEventHandler(o,s);return}let{events:r}=this,i=r.get(e);if(i&&(i.remove(e,n),i.isEmpty())){let{recognizerName:o}=i,s=!1;for(let c of r.values())if(c.recognizerName===o&&!c.isEmpty()){s=!0;break}s||this._toggleRecognizer(o,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(n=>n.getEventNames().includes(e))?.options.event}};var Cn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Cn,\"IDENTITY\",{get:()=>(hn.deprecated(\"COORDINATE_SYSTEM.IDENTITY\",\"COORDINATE_SYSTEM.CARTESIAN\")(),0)});var ea={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},so={common:0,meters:1,pixels:2},tw={click:\"onClick\",dblclick:\"onClick\",panstart:\"onDragStart\",panmove:\"onDrag\",panend:\"onDragEnd\"},EF={multipan:[RA,{threshold:10,direction:Po.Vertical,pointers:2}],pinch:[Dy,{},null,[\"multipan\"]],pan:[RA,{threshold:1},[\"pinch\"],[\"multipan\"]],dblclick:[Wm,{event:\"dblclick\",taps:2}],click:[Wm,{event:\"click\"},null,[\"dblclick\"]]};function uxe(t,e){if(t===e)return!0;if(Array.isArray(t)){let n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function ed(t){let e={},n;return r=>{for(let i in r)if(!uxe(r[i],e[i])){n=t(r),e=r;break}return n}}var aK=[0,0,0,0],hxe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],lK=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],fxe=[0,0,0],cK=[0,0,0],dxe=ed(Axe);function SF(t,e,n=cK){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,o=!0;switch(e===Cn.LNGLAT_OFFSETS||e===Cn.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case ea.WEB_MERCATOR:(e===Cn.LNGLAT||e===Cn.CARTESIAN)&&(i=[0,0,0],o=!1);break;case ea.WEB_MERCATOR_AUTO_OFFSET:e===Cn.LNGLAT?r=i:e===Cn.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case ea.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case ea.GLOBE:o=!1,i=null;break;default:o=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:o}}function pxe(t,e,n){let{viewMatrixUncentered:r,projectionMatrix:i}=t,{viewMatrix:o,viewProjectionMatrix:s}=t,c=aK,d=aK,m=t.cameraPosition,{geospatialOrigin:b,shaderCoordinateOrigin:C,offsetMode:B}=SF(t,e,n);return B&&(d=t.projectPosition(b||C),m=[m[0]-d[0],m[1]-d[1],m[2]-d[2]],d[3]=1,c=bc.transformMat4([],d,s),o=r||o,s=_s.multiply([],i,o),s=_s.multiply([],s,hxe)),{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:c,originCommon:d,cameraPosCommon:m,shaderCoordinateOrigin:C,geospatialOrigin:b}}function uK({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Cn.DEFAULT,coordinateOrigin:i=cK,autoWrapLongitude:o=!1}){r===Cn.DEFAULT&&(r=t.isGeospatial?Cn.LNGLAT:Cn.CARTESIAN);let s=dxe({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return s.wrapLongitude=o,s.modelMatrix=n||lK,s}function Axe({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){let{projectionCenter:i,viewProjectionMatrix:o,originCommon:s,cameraPosCommon:c,shaderCoordinateOrigin:d,geospatialOrigin:m}=pxe(t,n,r),b=t.getDistanceScales(),C=[t.width*e,t.height*e],B=bc.transformMat4([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,k={coordinateSystem:n,projectionMode:t.projectionMode,coordinateOrigin:d,commonOrigin:s.slice(0,3),center:i,pseudoMeters:!!t._pseudoMeters,viewportSize:C,devicePixelRatio:e,focalDistance:B,commonUnitsPerMeter:b.unitsPerMeter,commonUnitsPerWorldUnit:b.unitsPerMeter,commonUnitsPerWorldUnit2:fxe,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:o,modelMatrix:lK,cameraPosition:c};if(m){let V=t.getDistanceScales(m);switch(n){case Cn.METER_OFFSETS:k.commonUnitsPerWorldUnit=V.unitsPerMeter,k.commonUnitsPerWorldUnit2=V.unitsPerMeter2;break;case Cn.LNGLAT:case Cn.LNGLAT_OFFSETS:t._pseudoMeters||(k.commonUnitsPerMeter=V.unitsPerMeter),k.commonUnitsPerWorldUnit=V.unitsPerDegree,k.commonUnitsPerWorldUnit2=V.unitsPerDegree2;break;case Cn.CARTESIAN:k.commonUnitsPerWorldUnit=[1,1,V.unitsPerMeter[2]],k.commonUnitsPerWorldUnit2=[0,0,V.unitsPerMeter2[2]];break;default:break}}return k}var gxe=Object.keys(Cn).map(t=>`const COORDINATE_SYSTEM_${t}: i32 = ${Cn[t]};`).join(\"\"),mxe=Object.keys(ea).map(t=>`const PROJECTION_MODE_${t}: i32 = ${ea[t]};`).join(\"\"),_xe=Object.keys(so).map(t=>`const UNIT_${t.toUpperCase()}: i32 = ${so[t]};`).join(\"\"),yxe=`${gxe}\n${mxe}\n${_xe}\n\nconst TILE_SIZE: f32 = 512.0;\nconst PI: f32 = 3.1415926536;\nconst WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);\nconst ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);\nconst EARTH_RADIUS: f32 = 6370972.0; // meters\nconst GLOBE_RADIUS: f32 = 256.0;\n\n// -----------------------------------------------------------------------------\n// Uniform block (converted from GLSL uniform block)\n// -----------------------------------------------------------------------------\nstruct ProjectUniforms {\n  wrapLongitude: i32,\n  coordinateSystem: i32,\n  commonUnitsPerMeter: vec3<f32>,\n  projectionMode: i32,\n  scale: f32,\n  commonUnitsPerWorldUnit: vec3<f32>,\n  commonUnitsPerWorldUnit2: vec3<f32>,\n  center: vec4<f32>,\n  modelMatrix: mat4x4<f32>,\n  viewProjectionMatrix: mat4x4<f32>,\n  viewportSize: vec2<f32>,\n  devicePixelRatio: f32,\n  focalDistance: f32,\n  cameraPosition: vec3<f32>,\n  coordinateOrigin: vec3<f32>,\n  commonOrigin: vec3<f32>,\n  pseudoMeters: i32,\n};\n\n@group(0) @binding(0)\nvar<uniform> project: ProjectUniforms;\n\n// -----------------------------------------------------------------------------\n// Geometry data\n// (In your GLSL code, \"geometry\" was assumed to be available globally. In WGSL,\n// you might supply this via vertex attributes or a uniform. Here we define a\n// uniform struct for demonstration.)\n// -----------------------------------------------------------------------------\n\n// Structure to carry additional geometry data used by deck.gl filters.\nstruct Geometry {\n  worldPosition: vec3<f32>,\n  worldPositionAlt: vec3<f32>,\n  position: vec4<f32>,\n  normal: vec3<f32>,\n  uv: vec2<f32>,\n  pickingColor: vec3<f32>,\n};\n\n// @group(0) @binding(1)\nvar<private> geometry: Geometry;\n`,hK=`${yxe}\n\n// -----------------------------------------------------------------------------\n// Functions\n// -----------------------------------------------------------------------------\n\n// Returns an adjustment factor for commonUnitsPerMeter\nfn _project_size_at_latitude(lat: f32) -> f32 {\n  let y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\n// Overloaded version: scales a value in meters at a given latitude.\nfn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {\n  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);\n}\n\n// Computes a non-linear scale factor based on geometry.\n// (Note: This function relies on \"geometry\" being provided.)\nfn project_size() -> f32 {\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n      project.pseudoMeters == 0) {\n    if (geometry.position.w == 0.0) {\n      return _project_size_at_latitude(geometry.worldPosition.y);\n    }\n    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    let y2 = y * y;\n    let y4 = y2 * y2;\n    let y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\n// Overloads to scale offsets (meters to world units)\nfn project_size_float(meters: f32) -> f32 {\n  return meters * project.commonUnitsPerMeter.z * project_size();\n}\n\nfn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {\n  return meters * project.commonUnitsPerMeter.xy * project_size();\n}\n\nfn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {\n  return meters * project.commonUnitsPerMeter * project_size();\n}\n\nfn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {\n  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\n\n// Returns a rotation matrix aligning the z\\u2011axis with the given up vector.\nfn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {\n  let uz = normalize(up);\n  let ux = select(\n    vec3<f32>(1.0, 0.0, 0.0),\n    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),\n    abs(uz.z) == 1.0\n  );\n  let uy = cross(uz, ux);\n  return mat3x3<f32>(ux, uy, uz);\n}\n\n// Since WGSL does not support \"out\" parameters, we return a struct.\nstruct RotationResult {\n  needsRotation: bool,\n  transform: mat3x3<f32>,\n};\n\nfn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {\n  if (project.projectionMode == PROJECTION_MODE_GLOBE) {\n    return RotationResult(true, project_get_orientation_matrix(commonPosition));\n  } else {\n    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed\n  };\n}\n\n// Projects a normal vector from the current coordinate system to world space.\nfn project_normal(vector: vec3<f32>) -> vec3<f32> {\n  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);\n  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\n  let rotResult = project_needs_rotation(geometry.position.xyz);\n  if (rotResult.needsRotation) {\n    n = rotResult.transform * n;\n  }\n  return n;\n}\n\n// Applies a scale offset based on y-offset (dy)\nfn project_offset_(offset: vec4<f32>) -> vec4<f32> {\n  let dy: f32 = offset.y;\n  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\n  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n// Projects lng/lat coordinates to a unit tile [0,1]\nfn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {\n  var x = lnglat.x;\n  if (project.wrapLongitude != 0) {\n    x = ((x + 180.0) % 360.0) - 180.0;\n  }\n  let y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2<f32>(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// Projects lng/lat/z coordinates for a globe projection.\nfn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {\n  let lambda = radians(lnglatz.x);\n  let phi = radians(lnglatz.y);\n  let cosPhi = cos(phi);\n  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n  return vec3<f32>(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n// Projects positions (with an optional 64-bit low part) from the input\n// coordinate system to the common space.\nfn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {\n  var position_world = project.modelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug:\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4<f32>(\n        project_mercator_(position_world.xy),\n        _project_size_at_latitude_m(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_GLOBE) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4<f32>(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\n        return vec4<f32>(\n          project_mercator_(position_world.xy) - project.commonOrigin.xy,\n          project_size_float(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);\n  }\n\n  return project_offset_(position_world) +\n         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));\n}\n\n// Overloaded versions for different input types.\nfn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {\n  return project_position_vec4_f64(position, ZERO_64_LOW);\n}\n\nfn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nfn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nfn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\n// Transforms a common space position to clip space.\nfn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {\n  return viewProjectionMatrix * position + center;\n}\n\n// Uses the project viewProjectionMatrix and center.\nfn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {\n  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);\n}\n\n// Returns a clip space offset corresponding to a given number of screen pixels.\nfn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {\n  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\n  return offset * project.focalDistance;\n}\n\nfn project_meter_size_to_pixel(meters: f32) -> f32 {\n  return project_size_float(meters) * project.scale;\n}\n\nfn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {\n  if (unit == UNIT_METERS) {\n    return project_meter_size_to_pixel(size);\n  } else if (unit == UNIT_COMMON) {\n    return size * project.scale;\n  }\n  // UNIT_PIXELS: no scaling applied.\n  return size;\n}\n\nfn project_pixel_size_float(pixels: f32) -> f32 {\n  return pixels / project.scale;\n}\n\nfn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {\n  return pixels / project.scale;\n}\n`;var xxe=Object.keys(Cn).map(t=>`const int COORDINATE_SYSTEM_${t} = ${Cn[t]};`).join(\"\"),vxe=Object.keys(ea).map(t=>`const int PROJECTION_MODE_${t} = ${ea[t]};`).join(\"\"),bxe=Object.keys(so).map(t=>`const int UNIT_${t.toUpperCase()} = ${so[t]};`).join(\"\"),fK=`${xxe}\n${vxe}\n${bxe}\nuniform projectUniforms {\nbool wrapLongitude;\nint coordinateSystem;\nvec3 commonUnitsPerMeter;\nint projectionMode;\nfloat scale;\nvec3 commonUnitsPerWorldUnit;\nvec3 commonUnitsPerWorldUnit2;\nvec4 center;\nmat4 modelMatrix;\nmat4 viewProjectionMatrix;\nvec2 viewportSize;\nfloat devicePixelRatio;\nfloat focalDistance;\nvec3 cameraPosition;\nvec3 coordinateOrigin;\nvec3 commonOrigin;\nbool pseudoMeters;\n} project;\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\nfloat y = clamp(lat, -89.9, 89.9);\nreturn 1.0 / cos(radians(y));\n}\nfloat project_size() {\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\nproject.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\nproject.pseudoMeters == false) {\nif (geometry.position.w == 0.0) {\nreturn project_size_at_latitude(geometry.worldPosition.y);\n}\nfloat y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\nfloat y2 = y * y;\nfloat y4 = y2 * y2;\nfloat y6 = y4 * y2;\nreturn 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n}\nreturn 1.0;\n}\nfloat project_size_at_latitude(float meters, float lat) {\nreturn meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\nreturn meters * project.commonUnitsPerMeter.z * project_size();\n}\nvec2 project_size(vec2 meters) {\nreturn meters * project.commonUnitsPerMeter.xy * project_size();\n}\nvec3 project_size(vec3 meters) {\nreturn meters * project.commonUnitsPerMeter * project_size();\n}\nvec4 project_size(vec4 meters) {\nreturn vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\nvec3 uz = normalize(up);\nvec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\nvec3 uy = cross(uz, ux);\nreturn mat3(ux, uy, uz);\n}\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\ntransform = project_get_orientation_matrix(commonPosition);\nreturn true;\n}\nreturn false;\n}\nvec3 project_normal(vec3 vector) {\nvec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);\nvec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\nmat3 rotation;\nif (project_needs_rotation(geometry.position.xyz, rotation)) {\nn = rotation * n;\n}\nreturn n;\n}\nvec4 project_offset_(vec4 offset) {\nfloat dy = offset.y;\nvec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\nreturn vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\nfloat x = lnglat.x;\nif (project.wrapLongitude) {\nx = mod(x + 180., 360.0) - 180.;\n}\nfloat y = clamp(lnglat.y, -89.9, 89.9);\nreturn vec2(\nradians(x) + PI,\nPI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n) * WORLD_SCALE;\n}\nvec3 project_globe_(vec3 lnglatz) {\nfloat lambda = radians(lnglatz.x);\nfloat phi = radians(lnglatz.y);\nfloat cosPhi = cos(phi);\nfloat D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\nreturn vec3(\nsin(lambda) * cosPhi,\n-cos(lambda) * cosPhi,\nsin(phi)\n) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\nvec4 position_world = project.modelMatrix * position;\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_mercator_(position_world.xy),\nproject_size_at_latitude(position_world.z, position_world.y),\nposition_world.w\n);\n}\nif (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\nposition_world.xyz += project.coordinateOrigin;\n}\n}\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_globe_(position_world.xyz),\nposition_world.w\n);\n}\n}\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nif (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\nreturn vec4(\nproject_mercator_(position_world.xy) - project.commonOrigin.xy,\nproject_size(position_world.z),\nposition_world.w\n);\n}\n}\n}\nif (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\nposition_world.xyz -= project.coordinateOrigin;\n}\nreturn project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));\n}\nvec4 project_position(vec4 position) {\nreturn project_position(position, ZERO_64_LOW);\n}\nvec3 project_position(vec3 position, vec3 position64Low) {\nvec4 projected_position = project_position(vec4(position, 1.0), position64Low);\nreturn projected_position.xyz;\n}\nvec3 project_position(vec3 position) {\nvec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\nreturn projected_position.xyz;\n}\nvec2 project_position(vec2 position) {\nvec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\nreturn projected_position.xy;\n}\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\nreturn viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\nreturn project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\nvec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\nreturn offset * project.focalDistance;\n}\nfloat project_size_to_pixel(float meters) {\nreturn project_size(meters) * project.scale;\n}\nfloat project_size_to_pixel(float size, int unit) {\nif (unit == UNIT_METERS) return project_size_to_pixel(size);\nif (unit == UNIT_COMMON) return size * project.scale;\nreturn size;\n}\nfloat project_pixel_size(float pixels) {\nreturn pixels / project.scale;\n}\nvec2 project_pixel_size(vec2 pixels) {\nreturn pixels / project.scale;\n}\n`;var wxe={};function Txe(t=wxe){return\"viewport\"in t?uK(t):{}}var Ly={name:\"project\",dependencies:[fF,FM],source:hK,vs:fK,getUniforms:Txe,uniformTypes:{wrapLongitude:\"f32\",coordinateSystem:\"i32\",commonUnitsPerMeter:\"vec3<f32>\",projectionMode:\"i32\",scale:\"f32\",commonUnitsPerWorldUnit:\"vec3<f32>\",commonUnitsPerWorldUnit2:\"vec3<f32>\",center:\"vec4<f32>\",modelMatrix:\"mat4x4<f32>\",viewProjectionMatrix:\"mat4x4<f32>\",viewportSize:\"vec2<f32>\",devicePixelRatio:\"f32\",focalDistance:\"f32\",cameraPosition:\"vec3<f32>\",coordinateOrigin:\"vec3<f32>\",commonOrigin:\"vec3<f32>\",pseudoMeters:\"f32\"}};var Exe=`// Define a structure to hold both the clip-space position and the common position.\nstruct ProjectResult {\n  clipPosition: vec4<f32>,\n  commonPosition: vec4<f32>,\n};\n\n// This function mimics the GLSL version with the 'out' parameter by returning both values.\nfn project_position_to_clipspace_and_commonspace(\n    position: vec3<f32>,\n    position64Low: vec3<f32>,\n    offset: vec3<f32>\n) -> ProjectResult {\n  // Compute the projected position.\n  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);\n\n  // Start with the provided offset.\n  var finalOffset: vec3<f32> = offset;\n\n  // Get whether a rotation is needed and the rotation matrix.\n  let rotationResult = project_needs_rotation(projectedPosition);\n\n  // If rotation is needed, update the offset.\n  if (rotationResult.needsRotation) {\n    finalOffset = rotationResult.transform * offset;\n  }\n\n  // Compute the common position.\n  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);\n\n  // Convert to clip-space.\n  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);\n\n  return ProjectResult(clipPosition, commonPosition);\n}\n\n// A convenience overload that returns only the clip-space position.\nfn project_position_to_clipspace(\n    position: vec3<f32>,\n    position64Low: vec3<f32>,\n    offset: vec3<f32>\n) -> vec4<f32> {\n  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;\n}\n`,Sxe=`vec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n`,Lr={name:\"project32\",dependencies:[Ly],source:Exe,vs:Sxe};function CF(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function BA(t,e){let n=bc.transformMat4([],e,t);return bc.scale(n,n,1/n[3]),n}function MF(t,e){let n=t%e;return n<0?e+n:n}function nw(t,e,n){return t<e?e:t>n?n:t}function Cxe(t){return Math.log(t)*Math.LOG2E}var Oy=Math.log2||Cxe;function Qh(t,e){if(!t)throw new Error(e||\"@math.gl/web-mercator: assertion failed.\")}var Kh=Math.PI,dK=Kh/4,Qu=Kh/180,IF=180/Kh,Fy=512,ZM=4003e4,Jh=85.051129,pK=1.5;function PF(t){return Oy(t)}function $l(t){let[e,n]=t;Qh(Number.isFinite(e)),Qh(Number.isFinite(n)&&n>=-90&&n<=90,\"invalid latitude\");let r=e*Qu,i=n*Qu,o=Fy*(r+Kh)/(2*Kh),s=Fy*(Kh+Math.log(Math.tan(dK+i*.5)))/(2*Kh);return[o,s]}function pl(t){let[e,n]=t,r=e/Fy*(2*Kh)-Kh,i=2*(Math.atan(Math.exp(n/Fy*(2*Kh)-Kh))-dK);return[r*IF,i*IF]}function RF(t){let{latitude:e}=t;Qh(Number.isFinite(e));let n=Math.cos(e*Qu);return PF(ZM*n)-9}function rw(t){let e=Math.cos(t*Qu);return Fy/ZM/e}function ky(t){let{latitude:e,longitude:n,highPrecision:r=!1}=t;Qh(Number.isFinite(e)&&Number.isFinite(n));let i=Fy,o=Math.cos(e*Qu),s=i/360,c=s/o,d=i/ZM/o,m={unitsPerMeter:[d,d,d],metersPerUnit:[1/d,1/d,1/d],unitsPerDegree:[s,c,d],degreesPerUnit:[1/s,1/c,1/d]};if(r){let b=Qu*Math.tan(e*Qu)/o,C=s*b/2,B=i/ZM*b,k=B/c*d;m.unitsPerDegree2=[0,C,B],m.unitsPerMeter2=[k,0,k]}return m}function iw(t,e){let[n,r,i]=t,[o,s,c]=e,{unitsPerMeter:d,unitsPerMeter2:m}=ky({longitude:n,latitude:r,highPrecision:!0}),b=$l(t);b[0]+=o*(d[0]+m[0]*s),b[1]+=s*(d[1]+m[1]*s);let C=pl(b),B=(i||0)+(c||0);return Number.isFinite(i)||Number.isFinite(c)?[C[0],C[1],B]:C}function qM(t){let{height:e,pitch:n,bearing:r,altitude:i,scale:o,center:s}=t,c=CF();_s.translate(c,c,[0,0,-i]),_s.rotateX(c,c,-n*Qu),_s.rotateZ(c,c,r*Qu);let d=o/e;return _s.scale(c,c,[d,d,d]),s&&_s.translate(c,c,Ya.negate([],s)),c}function BF(t){let{width:e,height:n,altitude:r,pitch:i=0,offset:o,center:s,scale:c,nearZMultiplier:d=1,farZMultiplier:m=1}=t,{fovy:b=Dp(pK)}=t;r!==void 0&&(b=Dp(r));let C=b*Qu,B=i*Qu,k=jm(b),V=k;s&&(V+=s[2]*c/Math.cos(B)/n);let q=C*(.5+(o?o[1]:0)/n),K=Math.sin(q)*V/Math.sin(nw(Math.PI/2-B-q,.01,Math.PI-.01)),Y=Math.sin(B)*K+V,ee=V*10,J=Math.min(Y*m,ee);return{fov:C,aspect:e/n,focalDistance:k,near:d,far:J}}function Dp(t){return 2*Math.atan(.5/t)*IF}function jm(t){return .5/Math.tan(.5*t*Qu)}function Ny(t,e){let[n,r,i=0]=t;return Qh(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),BA(e,[n,r,i,1])}function DA(t,e,n=0){let[r,i,o]=t;if(Qh(Number.isFinite(r)&&Number.isFinite(i),\"invalid pixel coordinate\"),Number.isFinite(o))return BA(e,[r,i,o,1]);let s=BA(e,[r,i,0,1]),c=BA(e,[r,i,1,1]),d=s[2],m=c[2],b=d===m?0:((n||0)-d)/(m-d);return Jf.lerp([],s,c,b)}function QM(t){let{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:o=24,offset:s=[0,0]}=t,[[c,d],[m,b]]=r,C=Mxe(t.padding),B=$l([c,nw(b,-Jh,Jh)]),k=$l([m,nw(d,-Jh,Jh)]),V=[Math.max(Math.abs(k[0]-B[0]),i),Math.max(Math.abs(k[1]-B[1]),i)],q=[e-C.left-C.right-Math.abs(s[0])*2,n-C.top-C.bottom-Math.abs(s[1])*2];Qh(q[0]>0&&q[1]>0);let K=q[0]/V[0],Y=q[1]/V[1],ee=(C.right-C.left)/2/K,J=(C.top-C.bottom)/2/Y,se=[(k[0]+B[0])/2+ee,(k[1]+B[1])/2+J],xe=pl(se),Ee=Math.min(o,Oy(Math.abs(Math.min(K,Y))));return Qh(Number.isFinite(Ee)),{longitude:xe[0],latitude:xe[1],zoom:Ee}}function Mxe(t=0){return typeof t==\"number\"?{top:t,bottom:t,left:t,right:t}:(Qh(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}var AK=Math.PI/180;function KM(t,e=0){let{width:n,height:r,unproject:i}=t,o={targetZ:e},s=i([0,r],o),c=i([n,r],o),d,m,b=t.fovy?.5*t.fovy*AK:Math.atan(.5/t.altitude),C=(90-t.pitch)*AK;return b>C-.01?(d=gK(t,0,e),m=gK(t,n,e)):(d=i([0,0],o),m=i([n,0],o)),[s,c,m,d]}function gK(t,e,n){let{pixelUnprojectionMatrix:r}=t,i=BA(r,[e,0,1,1]),o=BA(r,[e,t.height,1,1]),c=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(o[2]-i[2]),d=Jf.lerp([],i,o,c),m=pl(d);return m.push(n),m}var _K=512;function DF(t){let{width:e,height:n,pitch:r=0}=t,{longitude:i,latitude:o,zoom:s,bearing:c=0}=t;(i<-180||i>180)&&(i=MF(i+180,360)-180),(c<-180||c>180)&&(c=MF(c+180,360)-180);let d=Oy(n/_K);if(s<=d)s=d,o=0;else{let m=n/2/Math.pow(2,s),b=pl([0,m])[1];if(o<b)o=b;else{let C=pl([0,_K-m])[1];o>C&&(o=C)}}return{width:e,height:n,longitude:i,latitude:o,zoom:s,pitch:r,bearing:c}}var yK=`\nuniform shadowUniforms {\n  bool drawShadowMap;\n  bool useShadowMap;\n  vec4 color;\n  highp int lightId;\n  float lightCount;\n  mat4 viewProjectionMatrix0;\n  mat4 viewProjectionMatrix1;\n  vec4 projectCenter0;\n  vec4 projectCenter1;\n} shadow;\n`,Rxe=`\nconst int max_lights = 2;\n\nout vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  mat4 viewProjectionMatrices[max_lights];\n  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;\n  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;\n  vec4 projectCenters[max_lights];\n  projectCenters[0] = shadow.projectCenter0;\n  projectCenters[1] = shadow.projectCenter1;\n\n  if (shadow.drawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);\n  }\n  if (shadow.useShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow.lightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n`,Bxe=`\n${yK}\n${Rxe}\n`,Dxe=`\nconst int max_lights = 2;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\n\nin vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow.drawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow.useShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow.lightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow.color.a / shadow.lightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n`,Lxe=`\n${yK}\n${Dxe}\n`,Oxe=ed(Uxe),Fxe=ed(Vxe),kxe=[0,0,0,1],Nxe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function zxe(t,e){let[n,r,i]=t,o=DA([n,r,i],e);return Number.isFinite(i)?o:[o[0],o[1],0]}function Uxe({viewport:t,center:e}){return new wn(t.viewProjectionMatrix).invert().transform(e)}function Vxe({viewport:t,shadowMatrices:e}){let n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,o=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(s=>zxe(s,r));for(let s of e){let c=s.clone().translate(new $e(t.center).negate()),d=o.map(b=>c.transform(b)),m=new wn().ortho({left:Math.min(...d.map(b=>b[0])),right:Math.max(...d.map(b=>b[0])),bottom:Math.min(...d.map(b=>b[1])),top:Math.max(...d.map(b=>b[1])),near:Math.min(...d.map(b=>-b[2])),far:Math.max(...d.map(b=>-b[2]))});n.push(m.multiplyRight(s))}return n}function Gxe(t){let{shadowEnabled:e=!0,project:n}=t;if(!e||!n||!t.shadowMatrices||!t.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};let r=Ly.getUniforms(n),i=Oxe({viewport:n.viewport,center:r.center}),o=[],s=Fxe({shadowMatrices:t.shadowMatrices,viewport:n.viewport}).slice();for(let d=0;d<t.shadowMatrices.length;d++){let m=s[d],b=m.clone().translate(new $e(n.viewport.center).negate());r.coordinateSystem===Cn.LNGLAT&&r.projectionMode===ea.WEB_MERCATOR?(s[d]=b,o[d]=i):(s[d]=m.clone().multiplyRight(Nxe),o[d]=b.transform(i))}let c={drawShadowMap:!!t.drawToShadowMap,useShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,color:t.shadowColor||kxe,lightId:t.shadowLightId||0,lightCount:t.shadowMatrices.length,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};for(let d=0;d<s.length;d++)c[`viewProjectionMatrix${d}`]=s[d],c[`projectCenter${d}`]=o[d];for(let d=0;d<2;d++)c[`shadow_uShadowMap${d}`]=t.shadowMaps&&t.shadowMaps[d]||t.dummyShadowMap;return c}var JM={name:\"shadow\",dependencies:[Ly],vs:Bxe,fs:Lxe,inject:{\"vs:DECKGL_FILTER_GL_POSITION\":`\n    position = shadow_setVertexPosition(geometry.position);\n    `,\"fs:DECKGL_FILTER_COLOR\":`\n    color = shadow_filterShadowColor(color);\n    `},getUniforms:Gxe,uniformTypes:{drawShadowMap:\"f32\",useShadowMap:\"f32\",color:\"vec4<f32>\",lightId:\"i32\",lightCount:\"f32\",viewProjectionMatrix0:\"mat4x4<f32>\",viewProjectionMatrix1:\"mat4x4<f32>\",projectCenter0:\"vec4<f32>\",projectCenter1:\"vec4<f32>\"}};var $i={...BM,defaultUniforms:{...BM.defaultUniforms,useFloatColors:!1},inject:{\"vs:DECKGL_FILTER_GL_POSITION\":`\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  `,\"vs:DECKGL_FILTER_COLOR\":`\n  picking_setPickingColor(geometry.pickingColor);\n  `,\"fs:DECKGL_FILTER_COLOR\":{order:99,injection:`\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    `}}};var Hxe=[FM],Wxe=[\"vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)\",\"vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)\",\"vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)\",\"fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)\"],jxe=[];function xK(t){let e=Cm.getDefaultShaderAssembler();for(let r of Hxe)e.addDefaultModule(r);e._hookFunctions.length=0;let n=t===\"glsl\"?Wxe:jxe;for(let r of n)e.addShaderHook(r);return e}var Xxe=[255,255,255],Yxe=1,Zxe=0,$M=class{constructor(e={}){this.type=\"ambient\";let{color:n=Xxe}=e,{intensity:r=Yxe}=e;this.id=e.id||`ambient-${Zxe++}`,this.color=n,this.intensity=r}};var qxe=[255,255,255],Qxe=1,Kxe=[0,0,-1],Jxe=0,ow=class{constructor(e={}){this.type=\"directional\";let{color:n=qxe}=e,{intensity:r=Qxe}=e,{direction:i=Kxe}=e,{_shadow:o=!1}=e;this.id=e.id||`directional-${Jxe++}`,this.color=n,this.intensity=r,this.type=\"directional\",this.direction=new $e(i).normalize().toArray(),this.shadow=o}getProjectedLight(e){return this}};var sw=class{constructor(e,n={id:\"pass\"}){let{id:r}=n;this.id=r,this.device=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}};var Lp=class extends sw{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){let[n,r]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,o=e.clearColor??(i?[0,0,0,0]:!1),s=i?1:!1,c=i?0:!1,d=e.colorMask??15,m={viewport:[0,0,n,r]};e.colorMask&&(m.colorMask=d),e.scissorRect&&(m.scissorRect=e.scissorRect);let b=this.device.beginRenderPass({framebuffer:e.target,parameters:m,clearColor:o,clearDepth:s,clearStencil:c});try{return this._drawLayers(b,e)}finally{b.end(),this.device.submit()}}_drawLayers(e,n){let{target:r,shaderModuleProps:i,viewports:o,views:s,onViewportActive:c,clearStack:d=!0}=n;n.pass=n.pass||\"unknown\",d&&(this._lastRenderIndex=-1);let m=[];for(let b of o){let C=s&&s[b.id];c?.(b);let B=this._getDrawLayerParams(b,n),k=b.subViewports||[b];for(let V of k){let q=this._drawLayersInViewport(e,{target:r,shaderModuleProps:i,viewport:V,view:C,pass:n.pass,layers:n.layers},B);m.push(q)}}return m}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:o,cullRect:s,effects:c,shaderModuleProps:d},m=!1){let b=[],C=bK(this._lastRenderIndex+1),B={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:s},k={};for(let V=0;V<n.length;V++){let q=n[V],K=this._shouldDrawLayer(q,B,o,k),Y={shouldDrawLayer:K};K&&!m&&(Y.shouldDrawLayer=!0,Y.layerRenderIndex=C(q,K),Y.shaderModuleProps=this._getShaderModuleProps(q,c,r,d),Y.layerParameters={...q.context.deck?.props.parameters,...this.getLayerParameters(q,V,e)}),b[V]=Y}return b}_drawLayersInViewport(e,{layers:n,shaderModuleProps:r,pass:i,target:o,viewport:s,view:c},d){let m=$xe(this.device,{shaderModuleProps:r,target:o,viewport:s});if(c){let{clear:C,clearColor:B,clearDepth:k,clearStencil:V}=c.props;if(C){let q=[0,0,0,0],K=1,Y=0;Array.isArray(B)?q=[...B.slice(0,3),B[3]||255].map(J=>J/255):B===!1&&(q=!1),k!==void 0&&(K=k),V!==void 0&&(Y=V),this.device.beginRenderPass({framebuffer:o,parameters:{viewport:m,scissorRect:m},clearColor:q,clearDepth:K,clearStencil:Y}).end()}}let b={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:m});for(let C=0;C<n.length;C++){let B=n[C],k=d[C],{shouldDrawLayer:V}=k;if(V&&B.props.pickable&&b.pickableCount++,B.isComposite&&b.compositeCount++,B.isDrawable&&k.shouldDrawLayer){let{layerRenderIndex:q,shaderModuleProps:K,layerParameters:Y}=k;b.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,q),K.project&&(K.project.viewport=s),B.context.renderPass=e;try{B._drawLayer({renderPass:e,shaderModuleProps:K,uniforms:{layerIndex:q},parameters:Y})}catch(ee){B.raiseError(ee,`drawing ${B} to ${i}`)}}}return b}shouldDrawLayer(e){return!0}getShaderModuleProps(e,n,r){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let s=e.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(n))return!1;n.layer=s,s=s.parent}if(r){let c=n.layer.id;if(c in i||(i[c]=r(n)),!i[c])return!1}return e.activateViewport(n.viewport),!0}_getShaderModuleProps(e,n,r,i){let o=this.device.canvasContext.cssToDeviceRatio(),s=e.internalState?.propsInTransition||e.props,c={layer:s,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:o,modelMatrix:s.modelMatrix,coordinateSystem:s.coordinateSystem,coordinateOrigin:s.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(n)for(let d of n)vK(c,d.getShaderModuleProps?.(e,c));return vK(c,this.getShaderModuleProps(e,n,c),i)}};function bK(t=0,e={}){let n={},r=(i,o)=>{let s=i.props._offset,c=i.id,d=i.parent&&i.parent.id,m;if(d&&!(d in e)&&r(i.parent,!1),d in n){let b=n[d]=n[d]||bK(e[d],e);m=b(i,o),n[c]=b}else Number.isFinite(s)?(m=s+(e[d]||0),n[c]=null):m=t;return o&&m>=t&&(t=m+1),e[c]=m,m};return r}function $xe(t,{shaderModuleProps:e,target:n,viewport:r}){let i=e?.project?.devicePixelRatio??t.canvasContext.cssToDeviceRatio(),[,o]=t.canvasContext.getDrawingBufferSize(),s=n?n.height:o,c=r;return[c.x*i,s-(c.y+c.height)*i,c.width*i,c.height*i]}function vK(t,...e){for(let n of e)if(n)for(let r in n)t[r]?Object.assign(t[r],n[r]):t[r]=n[r];return t}var aw=class extends Lp{constructor(e,n){super(e,n);let r=e.createTexture({format:\"rgba8unorm\",width:1,height:1,sampler:{minFilter:\"linear\",magFilter:\"linear\",addressModeU:\"clamp-to-edge\",addressModeV:\"clamp-to-edge\"}}),i=e.createTexture({format:\"depth16unorm\",width:1,height:1});this.fbo=e.createFramebuffer({id:\"shadowmap\",width:1,height:1,colorAttachments:[r],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){let n=this.fbo,r=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],o=i.width*r,s=i.height*r,c=[1,1,1,1];(o!==n.width||s!==n.height)&&n.resize({width:o,height:s}),super.render({...e,clearColor:c,target:n,pass:\"shadow\"})}getLayerParameters(e,n,r){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:\"less-equal\"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,n,r){return{shadow:{project:r.project,drawToShadowMap:!0}}}};var eve={color:[255,255,255],intensity:1},wK=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],tve=[0,0,0,200/255],zy=class{constructor(e={}){this.id=\"lighting-effect\",this.shadowColor=tve,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;let{device:n,deck:r}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(n),r._addDefaultShaderModule(JM),this.dummyShadowMap=n.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(let n in e){let r=e[n];switch(r.type){case\"ambient\":this.ambientLight=r;break;case\"directional\":this.directionalLights.push(r);break;case\"point\":this.pointLights.push(r);break;default:}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let s=0;s<this.shadowPasses.length;s++)this.shadowPasses[s].render({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:o,shaderModuleProps:{shadow:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,n){let r=this.shadow?{project:n.project,shadowMaps:this.shadowPasses.map(s=>s.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(s=>s.getProjectedLight({layer:e})),pointLights:this.pointLights.map(s=>s.getProjectedLight({layer:e}))},o=e.props.material;return{shadow:r,lighting:i,phongMaterial:o,gouraudMaterial:o}}cleanup(e){for(let n of this.shadowPasses)n.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(JM))}_calculateMatrices(){let e=[];for(let n of this.directionalLights){let r=new wn().lookAt({eye:new $e(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){let r=new aw(e);this.shadowPasses[n]=r}}_applyDefaultLights(){let{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new $M(eve),this.directionalLights.push(new ow(wK[0]),new ow(wK[1])))}};var LF=class{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:o=0,copy:s=!1,initialize:c=!1,maxCount:d}){let m=i||e&&e.constructor||Float32Array,b=n*r+o;if(ArrayBuffer.isView(e)){if(b<=e.length)return e;if(b*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new m(e.buffer,0,b)}let C=1/0;d&&(C=d*r+o);let B=this._allocate(m,b,c,C);return e&&s?B.set(e):c||B.fill(0,0,4),this._release(e),B}release(e){this._release(e)}_allocate(e,n,r,i){let o=Math.max(Math.ceil(n*this.opts.overAlloc),1);o>i&&(o=i);let s=this._pool,c=e.BYTES_PER_ELEMENT*o,d=s.findIndex(m=>m.byteLength>=c);if(d>=0){let m=new e(s.splice(d,1)[0],0,o);return r&&m.fill(0),m}return new e(o)}_release(e){if(!ArrayBuffer.isView(e))return;let n=this._pool,{buffer:r}=e,{byteLength:i}=r,o=n.findIndex(s=>s.byteLength>=i);o<0?n.push(r):(o>0||n.length<this.opts.poolSize)&&n.splice(o,0,r),n.length>this.opts.poolSize&&n.shift()}},$h=new LF;function Vy(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function EK(t){return[t[12],t[13],t[14]]}function SK(t){return{left:Uy(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Uy(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Uy(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Uy(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Uy(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Uy(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}var TK=new $e;function Uy(t,e,n,r){TK.set(t,e,n);let i=TK.len();return{distance:r/i,normal:new $e(-t/i,-e/i,-n/i)}}function nve(t){return t-Math.fround(t)}var lw;function e4(t,e){let{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,o=(i-r)/n;lw=$h.allocate(lw,o,{type:Float32Array,size:n*2});let s=r,c=0;for(;s<i;){for(let d=0;d<n;d++){let m=t[s++];lw[c+d]=m,lw[c+d+n]=nve(m)}c+=n*2}return lw.subarray(0,o*n*2)}function CK(t){let e=null,n=!1;for(let r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}var rve=Math.PI/180,ive=Vy(),MK=[0,0,0],ove={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function sve({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:o,near:s,far:c}){let d=t/e,m=n?new wn().orthographic({fovy:r,aspect:d,focalDistance:i,near:s,far:c}):new wn().perspective({fovy:r,aspect:d,near:s,far:c});if(o){let{left:b=0,right:C=0,top:B=0,bottom:k=0}=o,V=Jl((b+t-C)/2,0,t)-t/2,q=Jl((B+e-k)/2,0,e)-e/2;m[8]-=V*2/t,m[9]+=q*2/e}return m}var t4=class t{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||\"viewport\",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||ove,this.focalDistance=e.focalDistance||1,this.position=e.position||MK,this.modelMatrix=e.modelMatrix||null;let{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?ea.WEB_MERCATOR:ea.WEB_MERCATOR_AUTO_OFFSET:ea.IDENTITY}equals(e){return e instanceof t?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Gs(e.projectionMatrix,this.projectionMatrix)&&Gs(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){let r=this.projectPosition(e),i=Ny(r,this.pixelProjectionMatrix),[o,s]=i,c=n?s:this.height-s;return e.length===2?[o,c]:[o,c,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){let[i,o,s]=e,c=n?o:this.height-o,d=r&&r*this.distanceScales.unitsPerMeter[2],m=DA([i,c,s],this.pixelUnprojectionMatrix,d),[b,C,B]=this.unprojectPosition(m);return Number.isFinite(s)?[b,C,B]:Number.isFinite(r)?[b,C,r]:[b,C]}projectPosition(e){let[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){let[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){let n=$l(e);return n[1]=Jl(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?pl(e):e}getBounds(e={}){let n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),o=this.unproject([0,this.height],n),s=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],o[0],s[0]),Math.min(r[1],i[1],o[1],s[1]),Math.max(r[0],i[0],o[0],s[0]),Math.max(r[1],i[1],o[1],s[1])]}getDistanceScales(e){return e&&this.isGeospatial?ky({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,SK(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n,r){return null}_initProps(e){let n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=RF({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||ky({latitude:r,longitude:n}));let i=Math.pow(2,this.zoom);this.scale=i;let{position:o,modelMatrix:s}=e,c=MK;if(o&&(c=s?new wn(s).transformAsVector(o,[]):o),this.isGeospatial){let d=this.projectPosition([n,r,0]);this.center=new $e(c).scale(this.distanceScales.unitsPerMeter).add(d)}else this.center=this.projectPosition(c)}_initMatrices(e){let{viewMatrix:n=ive,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:o,fovy:s=75,near:c=.1,far:d=1e3,padding:m=null,focalDistance:b=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new wn().multiplyRight(n).translate(new $e(this.center).negate()),this.projectionMatrix=r||sve({width:this.width,height:this.height,orthographic:i,fovyRadians:o||s*rve,focalDistance:b,padding:m,near:c,far:d});let C=Vy();_s.multiply(C,C,this.projectionMatrix),_s.multiply(C,C,this.viewMatrix),this.viewProjectionMatrix=C,this.viewMatrixInverse=_s.invert([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=EK(this.viewMatrixInverse);let B=Vy(),k=Vy();_s.scale(B,B,[this.width/2,-this.height/2,1]),_s.translate(B,B,[1,-1,0]),_s.multiply(k,B,this.viewProjectionMatrix),this.pixelProjectionMatrix=k,this.pixelUnprojectionMatrix=_s.invert(Vy(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||hn.warn(\"Pixel project matrix not invertible\")()}};t4.displayName=\"Viewport\";var su=t4;var n4=class t extends su{constructor(e={}){let{latitude:n=0,longitude:r=0,zoom:i=0,pitch:o=0,bearing:s=0,nearZMultiplier:c=.1,farZMultiplier:d=1.01,nearZ:m,farZ:b,orthographic:C=!1,projectionMatrix:B,repeat:k=!1,worldOffset:V=0,position:q,padding:K,legacyMeterSizes:Y=!1}=e,{width:ee,height:J,altitude:se=1.5}=e,xe=Math.pow(2,i);ee=ee||1,J=J||1;let Ee,Xe=null;if(B)se=B[5]/2,Ee=Dp(se);else{e.fovy?(Ee=e.fovy,se=jm(Ee)):Ee=Dp(se);let be;if(K){let{top:ge=0,bottom:Qe=0}=K;be=[0,Jl((ge+J-Qe)/2,0,J)-J/2]}Xe=BF({width:ee,height:J,scale:xe,center:q&&[0,0,q[2]*rw(n)],offset:be,pitch:o,fovy:Ee,nearZMultiplier:c,farZMultiplier:d}),Number.isFinite(m)&&(Xe.near=m),Number.isFinite(b)&&(Xe.far=b)}let Ne=qM({height:J,pitch:o,bearing:s,scale:xe,altitude:se});V&&(Ne=new wn().translate([512*V,0,0]).multiplyLeft(Ne)),super({...e,width:ee,height:J,viewMatrix:Ne,longitude:r,latitude:n,zoom:i,...Xe,fovy:Ee,focalDistance:se}),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=o,this.bearing=s,this.altitude=se,this.fovy=Ee,this.orthographic=C,this._subViewports=k?[]:null,this._pseudoMeters=Y,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){let e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){let o=i?new t({...this,worldOffset:i}):this;this._subViewports.push(o)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);let[n,r]=this.projectFlat(e),i=(e[2]||0)*rw(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);let[n,r]=this.unprojectFlat(e),i=(e[2]||0)/rw(r);return[n,r,i]}addMetersToLngLat(e,n){return iw(e,n)}panByPosition(e,n,r){let i=DA(n,this.pixelUnprojectionMatrix),o=this.projectFlat(e),s=Jf.add([],o,Jf.negate([],i)),c=Jf.add([],this.center,s),[d,m]=this.unprojectFlat(c);return{longitude:d,latitude:m}}getBounds(e={}){let n=KM(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){let{width:r,height:i}=this,{longitude:o,latitude:s,zoom:c}=QM({width:r,height:i,bounds:e,...n});return new t({width:r,height:i,longitude:o,latitude:s,zoom:c})}};n4.displayName=\"WebMercatorViewport\";var LA=n4;var IK=[0,0,0];function OF(t,e,n=!1){let r=e.projectPosition(t);if(n&&e instanceof LA){let[i,o,s=0]=t,c=e.getDistanceScales([i,o]);r[2]=s*c.unitsPerMeter[2]}return r}function ave(t){let{viewport:e,modelMatrix:n,coordinateOrigin:r}=t,{coordinateSystem:i,fromCoordinateSystem:o,fromCoordinateOrigin:s}=t;return i===Cn.DEFAULT&&(i=e.isGeospatial?Cn.LNGLAT:Cn.CARTESIAN),o===void 0&&(o=i),s===void 0&&(s=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:s}}function FF(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:o}){let[s,c,d=0]=t;switch(n&&([s,c,d]=bc.transformMat4([],[s,c,d,1],n)),r){case Cn.LNGLAT:return OF([s,c,d],e,o);case Cn.LNGLAT_OFFSETS:return OF([s+i[0],c+i[1],d+(i[2]||0)],e,o);case Cn.METER_OFFSETS:return OF(iw(i,[s,c,d]),e,o);case Cn.CARTESIAN:default:return e.isGeospatial?[s+i[0],c+i[1],d+i[2]]:e.projectPosition([s,c,d])}}function PK(t,e){let{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:o,fromCoordinateSystem:s,fromCoordinateOrigin:c}=ave(e),{autoOffset:d=!0}=e,{geospatialOrigin:m=IK,shaderCoordinateOrigin:b=IK,offsetMode:C=!1}=d?SF(n,r,i):{},B=FF(t,{viewport:n,modelMatrix:o,coordinateSystem:s,coordinateOrigin:c,offsetMode:C});if(C){let k=n.projectPosition(m||b);Ya.sub(B,B,k)}return B}var lve=1,cve=1,Xm=class{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){let{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=e,s=lve++,c={time:0,delay:n,duration:r,rate:i,repeat:o};return this._setChannelTime(c,this.time),this.channels.set(s,c),s}removeChannel(e){this.channels.delete(e);for(let[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){let n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;let n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);let n=this.channels.values();for(let i of n)this._setChannelTime(i,this.time);let r=this.animations.values();for(let i of r){let{animation:o,channel:s}=i;o.setTime(this.getTime(s))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){let r=cve++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){let r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}};lr();function RK(t){return typeof window<\"u\"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function BK(t){return typeof window<\"u\"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}wm();var uve=0,cw=class t{static defaultAnimationLoopProps={device:null,onAddHTML:()=>\"\",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:my.stats.get(`animation-loop-${uve++}`),autoResizeViewport:!1};device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw=\"initialized\";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...t.defaultAnimationLoopProps,...e},e=this.props,!e.device)throw new Error(\"No device provided\");this.stats=e.stats||new hl({id:\"animation-loop-stats\"}),this.cpuTime=this.stats.get(\"CPU Time\"),this.gpuTime=this.stats.get(\"GPU Time\"),this.frameRate=this.stats.get(\"Frame Rate\"),this.setProps({autoResizeViewport:e.autoResizeViewport}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}reportError(e){this.props.onError(e),this._error=e}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return\"autoResizeViewport\"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){let n=e instanceof Error?e:new Error(\"Unknown error\");throw this.props.onError(n),n}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw(\"waitForRender\"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw(\"toDataURL\"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error(\"OffscreenCanvas\")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=RK(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(BK(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeViewport()}_initializeAnimationProps(){let e=this.device?.getDefaultCanvasContext();if(!this.device||!e)throw new Error(\"loop\");let n=e?.canvas,r=e.props.useDevicePixels;this.animationProps={animationLoop:this,device:this.device,canvasContext:e,canvas:n,useDevicePixels:r,timeline:this.timeline,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error(\"animationProps\");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;let{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw(\"drawing buffer resized\"),r!==this.animationProps.aspect&&this.setNeedsRedraw(\"drawing buffer aspect changed\"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error(\"No device provided\");this.canvas=this.device.getDefaultCanvasContext().canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){let e=document.createElement(\"div\");document.body.appendChild(e),e.style.position=\"relative\";let n=document.createElement(\"div\");n.style.position=\"absolute\",n.style.left=\"10px\",n.style.bottom=\"10px\",n.style.width=\"300px\",n.style.background=\"white\",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(n);let r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};let[e,n]=this.device?.getDefaultCanvasContext().getDevicePixelSize()||[1,1],r=1,i=this.device?.getDefaultCanvasContext().canvas;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener(\"mousemove\",this._onMousemove.bind(this)),this.canvas.addEventListener(\"mouseleave\",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}};lr();lr();var kF={};function Al(t=\"id\"){kF[t]=kF[t]||1;let e=kF[t]++;return`${t}-${e}`}var r4=class{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||Al(\"geometry\"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&ei.INDEX))throw new Error(\"Index buffer must have INDEX usage\")}destroy(){this.indices?.destroy();for(let e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}};function DK(t,e){if(e instanceof r4)return e;let n=hve(t,e),{attributes:r,bufferLayout:i}=fve(t,e);return new r4({topology:e.topology||\"triangle-list\",bufferLayout:i,vertexCount:e.vertexCount,indices:n,attributes:r})}function hve(t,e){if(!e.indices)return;let n=e.indices.value;return t.createBuffer({usage:ei.INDEX,data:n})}function fve(t,e){let n=[],r={};for(let[o,s]of Object.entries(e.attributes)){let c=o;switch(o){case\"POSITION\":c=\"positions\";break;case\"NORMAL\":c=\"normals\";break;case\"TEXCOORD_0\":c=\"texCoords\";break;case\"COLOR_0\":c=\"colors\";break}if(s){r[c]=t.createBuffer({data:s.value,id:`${o}-buffer`});let{value:d,size:m,normalized:b}=s;n.push({name:c,format:DO(d,m,b)})}}let i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:r,bufferLayout:n,vertexCount:i}}lr();var i4=class t{static defaultProps={...Xh.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new t(e),e._lumaData.defaultPipelineFactory}device;cachingEnabled;destroyPolicy;debug;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};get[Symbol.toStringTag](){return\"PipelineFactory\"}toString(){return`PipelineFactory(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cachePipelines,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=e.props.debugFactories}createRenderPipeline(e){if(!this.cachingEnabled)return this.device.createRenderPipeline(e);let n={...Xh.defaultProps,...e},r=this._renderPipelineCache,i=this._hashRenderPipeline(n),o=r[i]?.pipeline;return o?(r[i].useCount++,this.debug&&St.log(3,`${this}: ${r[i].pipeline} reused, count=${r[i].useCount}, (id=${e.id})`)()):(o=this.device.createRenderPipeline({...n,id:n.id?`${n.id}-cached`:Al(\"unnamed-cached\")}),o.hash=i,r[i]={pipeline:o,useCount:1},this.debug&&St.log(3,`${this}: ${o} created, count=${r[i].useCount}`)()),o}createComputePipeline(e){if(!this.cachingEnabled)return this.device.createComputePipeline(e);let n={...yy.defaultProps,...e},r=this._computePipelineCache,i=this._hashComputePipeline(n),o=r[i]?.pipeline;return o?(r[i].useCount++,this.debug&&St.log(3,`${this}: ${r[i].pipeline} reused, count=${r[i].useCount}, (id=${e.id})`)()):(o=this.device.createComputePipeline({...n,id:n.id?`${n.id}-cached`:void 0}),o.hash=i,r[i]={pipeline:o,useCount:1},this.debug&&St.log(3,`${this}: ${o} created, count=${r[i].useCount}`)()),o}release(e){if(!this.cachingEnabled){e.destroy();return}let n=this._getCache(e),r=e.hash;n[r].useCount--,n[r].useCount===0?(this._destroyPipeline(e),this.debug&&St.log(3,`${this}: ${e} released and destroyed`)()):n[r].useCount<0?(St.error(`${this}: ${e} released, useCount < 0, resetting`)(),n[r].useCount=0):this.debug&&St.log(3,`${this}: ${e} released, count=${n[r].useCount}`)()}_destroyPipeline(e){let n=this._getCache(e);switch(this.destroyPolicy){case\"never\":return!1;case\"unused\":return delete n[e.hash],e.destroy(),!0}}_getCache(e){let n;if(e instanceof yy&&(n=this._computePipelineCache),e instanceof Xh&&(n=this._renderPipelineCache),!n)throw new Error(`${this}`);if(!n[e.hash])throw new Error(`${this}: ${e} matched incorrect entry`);return n}_hashComputePipeline(e){let{type:n}=this.device,r=this._getHash(e.shader.source);return`${n}/C/${r}`}_hashRenderPipeline(e){let n=e.vs?this._getHash(e.vs.source):0,r=e.fs?this._getHash(e.fs.source):0,i=\"-\",o=this._getHash(JSON.stringify(e.bufferLayout)),{type:s}=this.device;switch(s){case\"webgl\":return`${s}/R/${n}/${r}V${i}BL${o}`;case\"webgpu\":default:let c=this._getHash(JSON.stringify(e.parameters));return`${s}/R/${n}/${r}V${i}T${e.topology}P${c}BL${o}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}};lr();var o4=class t{static defaultProps={...Rm.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new t(e),e._lumaData.defaultShaderFactory}device;cachingEnabled;destroyPolicy;debug;_cache={};get[Symbol.toStringTag](){return\"ShaderFactory\"}toString(){return`${this[Symbol.toStringTag]}(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cacheShaders,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=!0}createShader(e){if(!this.cachingEnabled)return this.device.createShader(e);let n=this._hashShader(e),r=this._cache[n];if(r)r.useCount++,this.debug&&St.log(3,`${this}: Reusing shader ${r.shader.id} count=${r.useCount}`)();else{let i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[n]=r={shader:i,useCount:1},this.debug&&St.log(3,`${this}: Created new shader ${i.id}`)()}return r.shader}release(e){if(!this.cachingEnabled){e.destroy();return}let n=this._hashShader(e),r=this._cache[n];if(r)if(r.useCount--,r.useCount===0)this.destroyPolicy===\"unused\"&&(delete this._cache[n],r.shader.destroy(),this.debug&&St.log(3,`${this}: Releasing shader ${e.id}, destroyed`)());else{if(r.useCount<0)throw new Error(`ShaderFactory: Shader ${e.id} released too many times`);this.debug&&St.log(3,`${this}: Releasing shader ${e.id} count=${r.useCount}`)()}}_hashShader(e){return`${e.stage}:${e.source}`}};function LK(t,e){let n={},r=\"Values\";if(t.attributes.length===0&&!t.varyings?.length)return{\"No attributes or varyings\":{[r]:\"N/A\"}};for(let i of t.attributes)if(i){let o=`${i.location} ${i.name}: ${i.type}`;n[`in ${o}`]={[r]:i.stepMode||\"vertex\"}}for(let i of t.varyings||[]){let o=`${i.location} ${i.name}`;n[`out ${o}`]={[r]:JSON.stringify(i)}}return n}var wa=null,NF=null;function OK(t,{id:e,minimap:n,opaque:r,top:i=\"0\",left:o=\"0\",rgbaScale:s=1}){wa||(wa=document.createElement(\"canvas\"),wa.id=e,wa.title=e,wa.style.zIndex=\"100\",wa.style.position=\"absolute\",wa.style.top=i,wa.style.left=o,wa.style.border=\"blue 5px solid\",wa.style.transform=\"scaleY(-1)\",document.body.appendChild(wa),NF=wa.getContext(\"2d\")),(wa.width!==t.width||wa.height!==t.height)&&(wa.width=t.width/2,wa.height=t.height/2,wa.style.width=\"400px\",wa.style.height=\"400px\");let c=t.device.readPixelsToArrayWebGL(t),d=NF?.createImageData(t.width,t.height);if(d){for(let b=0;b<c.length;b+=4)d.data[0+b+0]=c[b+0]*s,d.data[0+b+1]=c[b+1]*s,d.data[0+b+2]=c[b+2]*s,d.data[0+b+3]=r?255:c[b+3]*s;NF?.putImageData(d,0,0)}}function s4(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!s4(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t==\"object\"&&typeof e==\"object\"){let r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(let o of r)if(!e.hasOwnProperty(o)||!s4(t[o],e[o],n-1))return!1;return!0}return!1}lr();var Gy=class{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(n=>n.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(n=>n.attribute):[e.name]}mergeBufferLayouts(e,n){let r=[...e];for(let i of n){let o=r.findIndex(s=>s.name===i.name);o<0?r.push(i):r[o]=i}return r}getBufferIndex(e){let n=this.bufferLayouts.findIndex(r=>r.name===e);return n===-1&&St.warn(`BufferLayout: Missing buffer for \"${e}\".`)(),n}};function FK(t,e){let n=Object.fromEntries(t.attributes.map(i=>[i.name,i.location])),r=e.slice();return r.sort((i,o)=>{let s=i.attributes?i.attributes.map(b=>b.attribute):[i.name],c=o.attributes?o.attributes.map(b=>b.attribute):[o.name],d=Math.min(...s.map(b=>n[b])),m=Math.min(...c.map(b=>n[b]));return d-m}),r}lr();function kK(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function NK(t){return Array.isArray(t)?t.length===0||typeof t[0]==\"number\":!1}function zF(t){return kK(t)||NK(t)}function dve(t){return zF(t)||typeof t==\"number\"||typeof t==\"boolean\"}function zK(t){let e={bindings:{},uniforms:{}};return Object.keys(t).forEach(n=>{let r=t[n];dve(r)?e.uniforms[n]=r:e.bindings[n]=r}),e}var a4=class{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,n){Object.assign(this.options,n);let r=Ay(Object.values(e).filter(i=>i.dependencies));for(let i of r)e[i.name]=i;St.log(1,\"Creating ShaderInputs with modules\",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(let[i,o]of Object.entries(e))this._addModule(o),o.name&&i!==o.name&&!this.options.disableWarnings&&St.warn(`Module name: ${i} vs ${o.name}`)()}destroy(){}setProps(e){for(let n of Object.keys(e)){let r=n,i=e[r]||{},o=this.modules[r];if(!o){this.options.disableWarnings||St.warn(`Module ${n} not found`)();continue}let s=this.moduleUniforms[r],c=this.moduleBindings[r],d=o.getUniforms?.(i,s)||i,{uniforms:m,bindings:b}=zK(d);this.moduleUniforms[r]={...s,...m},this.moduleBindings[r]={...c,...b}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){let e={};for(let n of Object.values(this.moduleBindings))Object.assign(e,n);return e}getDebugTable(){let e={};for(let[n,r]of Object.entries(this.moduleUniforms))for(let[i,o]of Object.entries(r))e[`${n}.${i}`]={type:this.modules[n].uniformTypes?.[i],value:String(o)};return e}_addModule(e){let n=e.name;this.moduleUniforms[n]=e.defaultUniforms||{},this.moduleBindings[n]={}}};lr();var pve=\"\";async function UK(t,e){let n=new Image;return n.crossOrigin=e?.crossOrigin||\"anonymous\",n.src=t.startsWith(\"http\")?t:pve+t,await n.decode(),e?await createImageBitmap(n,e):await createImageBitmap(n)}var Ave=[\"+X\",\"-X\",\"+Y\",\"-Y\",\"+Z\",\"-Z\"];var gve=[\"+X\",\"-X\",\"+Y\",\"-Y\",\"+Z\",\"-Z\"],Hy=class t{device;id;props;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return\"AsyncTexture\"}toString(){return`AsyncTexture:\"${this.id}\"(${this.isReady?\"ready\":\"loading\"})`}constructor(e,n){this.device=e;let r=Al(\"async-texture\");this.props={...t.defaultProps,id:r,...n},this.id=this.props.id,n={...n},typeof n?.data==\"string\"&&n.dimension===\"2d\"&&(n.data=UK(n.data)),n.mipmaps&&(n.mipLevels=\"auto\"),this.ready=new Promise((i,o)=>{this.resolveReady=()=>{this.isReady=!0,i()},this.rejectReady=o}),this.initAsync(n)}async initAsync(e){let n=e.data,r=await VK(n).then(void 0,this.rejectReady);if(this.destroyed)return;let i=this.props.width&&this.props.height?{width:this.props.width,height:this.props.height}:this.getTextureDataSize(r);if(!i)throw new Error(\"Texture size could not be determined\");let o={...i,...e,data:void 0,mipLevels:1},s=this.device.getMipLevelCount(o.width,o.height);if(o.mipLevels=this.props.mipLevels===\"auto\"?s:Math.min(s,this.props.mipLevels),this.texture=this.device.createTexture(o),this.sampler=this.texture.sampler,this.view=this.texture.view,e.data)switch(this.props.dimension){case\"1d\":this._setTexture1DData(this.texture,r);break;case\"2d\":this._setTexture2DData(r);break;case\"3d\":this._setTexture3DData(this.texture,r);break;case\"2d-array\":this._setTextureArrayData(this.texture,r);break;case\"cube\":this._setTextureCubeData(this.texture,r);break;case\"cube-array\":this._setTextureCubeArrayData(this.texture,r);break}this.props.mipmaps&&this.generateMipmaps(),St.info(1,`${this} loaded`),this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}generateMipmaps(){this.texture.generateMipmapsWebGL()}setSampler(e={}){this.texture.setSampler(e instanceof jh?e:this.device.createSampler(e))}resize(e){if(!this.isReady)throw new Error(\"Cannot resize texture before it is ready\");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){let n=this.texture;this.texture=n.clone(e),n.destroy()}return!0}isTextureLevelData(e){let n=e?.data;return ArrayBuffer.isView(n)}getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return this.getTextureDataSize(e[0]);if(this.device.isExternalImage(e))return this.device.getExternalImageSize(e);if(e&&typeof e==\"object\"&&e.constructor===Object){let r=Object.values(e)[0];return{width:r.width,height:r.height}}throw new Error(\"texture size deduction failed\")}getCubeFaceDepth(e){switch(e){case\"+X\":return 0;case\"-X\":return 1;case\"+Y\":return 2;case\"-Y\":return 3;case\"+Z\":return 4;case\"-Z\":return 5;default:throw new Error(e)}}setTextureData(e){}_setTexture1DData(e,n){throw new Error(\"setTexture1DData not supported in WebGL.\")}_setTexture2DData(e,n=0){if(!this.texture)throw new Error(\"Texture not initialized\");let r=this._normalizeTextureData(e);r.length>1&&this.props.mipmaps!==!1&&St.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let i=0;i<r.length;i++){let o=r[i];this.device.isExternalImage(o)?this.texture.copyExternalImage({image:o,depth:n,mipLevel:i,flipY:!0}):this.texture.copyImageData({data:o.data,mipLevel:i})}}_setTexture3DData(e,n){if(this.texture?.props.dimension!==\"3d\")throw new Error(this.id);for(let r=0;r<n.length;r++)this._setTexture2DData(n[r],r)}_setTextureCubeData(e,n){if(this.texture?.props.dimension!==\"cube\")throw new Error(this.id);for(let[r,i]of Object.entries(n)){let o=gve.indexOf(r);this._setTexture2DData(i,o)}}_setTextureArrayData(e,n){if(this.texture?.props.dimension!==\"2d-array\")throw new Error(this.id);for(let r=0;r<n.length;r++)this._setTexture2DData(n[r],r)}_setTextureCubeArrayData(e,n){throw new Error(\"setTextureCubeArrayData not supported in WebGL2.\")}_setTextureCubeFaceData(e,n,r,i=0){Array.isArray(n)&&n.length>1&&this.props.mipmaps!==!1&&St.warn(`${this.id} has mipmap and multiple LODs.`)();let o=Ave.indexOf(r);this._setTexture2DData(n,o)}_normalizeTextureData(e){let n=this.texture,r;return ArrayBuffer.isView(e)?r=[{data:e,width:n.width,height:n.height}]:Array.isArray(e)?r=e:r=[e],r}static defaultProps={...jo.defaultProps,data:null,mipmaps:!1}};async function VK(t){if(t=await t,Array.isArray(t))return await Promise.all(t.map(VK));if(t&&typeof t==\"object\"&&t.constructor===Object){let e=t,n=await Promise.all(Object.values(e)),r=Object.keys(e),i={};for(let o=0;o<r.length;o++)i[r[o]]=n[o];return i}return t}var Ym=2,mve=1e4,gr=class t{static defaultProps={...Xh.defaultProps,source:void 0,vs:null,fs:null,id:\"unnamed\",handle:void 0,userData:{},defines:{},modules:[],geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Cm.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;props;_pipelineNeedsUpdate=\"newly created\";_needsRedraw=\"initializing\";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return\"Model\"}toString(){return`Model(${this.id})`}constructor(e,n){this.props={...t.defaultProps,...n},n=this.props,this.id=n.id||Al(\"model\"),this.device=e,Object.assign(this.userData,n.userData);let r=Object.fromEntries(this.props.modules?.map(d=>[d.name,d])||[]),i=n.shaderInputs||new a4(r,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);let o=yve(e),s=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type===\"webgpu\"&&this.props.source){let{source:d,getUniforms:m}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:o,...this.props,modules:s});this.source=d,this._getModuleUniforms=m,this.props.shaderLayout||=v8(this.source)}else{let{vs:d,fs:m,getUniforms:b}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:o,...this.props,modules:s});this.vs=d,this.fs=m,this._getModuleUniforms=b}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,n.geometry&&this.setGeometry(n.geometry),this.pipelineFactory=n.pipelineFactory||i4.getDefaultPipelineFactory(this.device),this.shaderFactory=n.shaderFactory||o4.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),\"isInstanced\"in n&&(this.isInstanced=n.isInstanced),n.instanceCount&&this.setInstanceCount(n.instanceCount),n.vertexCount&&this.setVertexCount(n.vertexCount),n.indexBuffer&&this.setIndexBuffer(n.indexBuffer),n.attributes&&this.setAttributes(n.attributes),n.constantAttributes&&this.setConstantAttributes(n.constantAttributes),n.bindings&&this.setBindings(n.bindings),n.transformFeedback&&(this.transformFeedback=n.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw(\"contents of bound textures or buffers updated\");let e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){let n=this._areBindingsLoading();if(n)return St.info(Ym,`>>> DRAWING ABORTED ${this.id}: ${n} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let r;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();let i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings});let{indexBuffer:o}=this.vertexArray,s=o?o.byteLength/(o.indexType===\"uint32\"?4:2):void 0;r=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),r?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw=\"waiting for resource initialization\",r}setGeometry(e){this._gpuGeometry?.destroy();let n=e&&DK(this.device,e);if(n){this.setTopology(n.topology||\"triangle-list\");let r=new Gy(this.bufferLayout);this.bufferLayout=r.mergeBufferLayouts(n.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(n)}this._gpuGeometry=n}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate(\"topology\"))}setBufferLayout(e){let n=new Gy(this.bufferLayout);this.bufferLayout=this._gpuGeometry?n.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate(\"bufferLayout\"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){s4(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate(\"parameters\"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw(\"instanceCount\")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw(\"vertexCount\")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new Pb(this.shaderInputs.modules);for(let[n,r]of Object.entries(this.shaderInputs.modules))if(_ve(r)){let i=this._uniformStore.getManagedUniformBuffer(this.device,n);this.bindings[`${n}Uniforms`]=i}this.setNeedsRedraw(\"shaderInputs\")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw(\"shaderInputs\")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw(\"bindings\")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw(\"transformFeedback\")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw(\"indexBuffer\")}setAttributes(e,n){let r=n?.disableWarnings??this.props.disableWarnings;e.indices&&St.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=FK(this.pipeline.shaderLayout,this.bufferLayout);let i=new Gy(this.bufferLayout);for(let[o,s]of Object.entries(e)){let c=i.getBufferLayout(o);if(!c){r||St.warn(`Model(${this.id}): Missing layout for buffer \"${o}\".`)();continue}let d=i.getAttributeNamesForBuffer(c),m=!1;for(let b of d){let C=this._attributeInfos[b];if(C){let B=this.device.type===\"webgpu\"?i.getBufferIndex(C.bufferName):C.location;this.vertexArray.setBuffer(B,s),m=!0}}!m&&!r&&St.warn(`Model(${this.id}): Ignoring buffer \"${s.id}\" for unknown attribute \"${o}\"`)()}this.setNeedsRedraw(\"attributes\")}setConstantAttributes(e,n){for(let[r,i]of Object.entries(e)){let o=this._attributeInfos[r];o?this.vertexArray.setConstantWebGL(o.location,i):(n?.disableWarnings??this.props.disableWarnings)||St.warn(`Model \"${this.id}: Ignoring constant supplied for unknown attribute \"${r}\"`)()}this.setNeedsRedraw(\"constants\")}_areBindingsLoading(){for(let e of Object.values(this.bindings))if(e instanceof Hy&&!e.isReady)return e.id;return!1}_getBindings(){let e={};for(let[n,r]of Object.entries(this.bindings))r instanceof Hy?r.isReady&&(e[n]=r.texture):e[n]=r;return e}_getBindingsUpdateTimestamp(){let e=0;for(let n of Object.values(this.bindings))n instanceof Pm?e=Math.max(e,n.texture.updateTimestamp):n instanceof ei||n instanceof jo?e=Math.max(e,n.updateTimestamp):n instanceof Hy?e=n.texture?Math.max(e,n.texture.updateTimestamp):1/0:n instanceof jh||(e=Math.max(e,n.buffer.updateTimestamp));return e}_setGeometryAttributes(e){let n={...e.attributes};for(let[r]of Object.entries(n))!this.pipeline.shaderLayout.attributes.find(i=>i.name===r)&&r!==\"positions\"&&delete n[r];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(n,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw(\"geometry attributes\")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,n=null;this.pipeline&&(St.log(1,`Model ${this.id}: Recreating pipeline because \"${this._pipelineNeedsUpdate}\".`)(),e=this.pipeline.vs,n=this.pipeline.fs),this._pipelineNeedsUpdate=!1;let r=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:\"vertex\",source:this.source||this.vs,debugShaders:this.props.debugShaders}),i=null;this.source?i=r:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:\"fragment\",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:r,fs:i}),this._attributeInfos=UC(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),n&&this.shaderFactory.release(n)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){let e=St.level>3?0:mve;St.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,St.group(Ym,`>>> DRAWING MODEL ${this.id}`,{collapsed:St.level<=2})())}_logDrawCallEnd(){if(this._logOpen){let e=LK(this.pipeline.shaderLayout,this.id);St.table(Ym,e)();let n=this.shaderInputs.getDebugTable();St.table(Ym,n)();let r=this._getAttributeDebugTable();St.table(Ym,this._attributeInfos)(),St.table(Ym,r)(),St.groupEnd(Ym)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){let n=this.device.props.debugFramebuffers;if(this._drawCount++,!n)return;let r=e.props.framebuffer;r&&OK(r,{id:r.id,minimap:!0})}_getAttributeDebugTable(){let e={};for(let[n,r]of Object.entries(this._attributeInfos)){let i=this.vertexArray.attributes[r.location];e[r.location]={name:n,type:r.shaderType,values:i?this._getBufferOrConstantValues(i,r.bufferDataType):\"null\"}}if(this.vertexArray.indexBuffer){let{indexBuffer:n}=this.vertexArray,r=n.indexType===\"uint32\"?new Uint32Array(n.debugData):new Uint16Array(n.debugData);e.indices={name:\"indices\",type:n.indexType,values:r.toString()}}return e}_getBufferOrConstantValues(e,n){let r=Im(n);return(e instanceof ei?new r(e.debugData):e).toString()}};function _ve(t){return!!(t.uniformTypes&&!xve(t.uniformTypes))}function yve(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function xve(t){for(let e in t)return!1;return!0}lr();var td=class t{device;model;transformFeedback;static defaultProps={...gr.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return e?.info?.type===\"webgl\"}constructor(e,n=t.defaultProps){if(!t.isSupported(e))throw new Error(\"BufferTransform not yet implemented on WebGPU\");this.device=e,this.model=new gr(this.device,{id:n.id||\"buffer-transform-model\",fs:n.fs||Ab(),topology:n.topology||\"point-list\",varyings:n.outputs||n.varyings,...n}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:n.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);let n=this.device.beginRenderPass(e);this.model.draw(n),n.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){let n=this.getBuffer(e);if(!n)throw new Error(\"BufferTransform#getBuffer\");if(n instanceof ei)return n.readAsync();let{buffer:r,byteOffset:i=0,byteLength:o=r.byteLength}=n;return r.readAsync(i,o)}};var vve=\"transform_output\",Wy=class{device;model;sampler;currentIndex=0;samplerTextureMap=null;bindings=[];resources={};constructor(e,n){this.device=e,this.sampler=e.createSampler({addressModeU:\"clamp-to-edge\",addressModeV:\"clamp-to-edge\",minFilter:\"nearest\",magFilter:\"nearest\",mipmapFilter:\"nearest\"}),this.model=new gr(this.device,{id:n.id||Al(\"texture-transform-model\"),fs:n.fs||Ab({input:n.targetTextureVarying,inputChannels:n.targetTextureChannels,output:vve}),vertexCount:n.vertexCount,...n}),this._initialize(n),Object.seal(this)}destroy(){this.model.destroy();for(let e of this.bindings)e.framebuffer?.destroy()}delete(){this.destroy()}run(e){let{framebuffer:n}=this.bindings[this.currentIndex],r=this.device.beginRenderPass({framebuffer:n,...e});this.model.draw(r),r.end(),this.device.submit()}getTargetTexture(){let{targetTexture:e}=this.bindings[this.currentIndex];return e}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}_initialize(e){this._updateBindings(e)}_updateBindings(e){this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e)}_updateBinding(e,{sourceBuffers:n,sourceTextures:r,targetTexture:i}){if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,n),i){e.targetTexture=i;let{width:o,height:s}=i;e.framebuffer&&e.framebuffer.destroy(),e.framebuffer=this.device.createFramebuffer({id:\"transform-framebuffer\",width:o,height:s,colorAttachments:[i]}),e.framebuffer.resize({width:o,height:s})}return e}_setSourceTextureParameters(){let e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(let r in n)n[r].sampler=this.sampler}};var gi=class{id;topology;vertexCount;indices;attributes;userData={};constructor(e){let{attributes:n={},indices:r=null,vertexCount:i=null}=e;this.id=e.id||Al(\"geometry\"),this.topology=e.topology,r&&(this.indices=ArrayBuffer.isView(r)?{value:r,size:1}:r),this.attributes={};for(let[o,s]of Object.entries(n)){let c=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(c.value))throw new Error(`${this._print(o)}: must be typed array or object with value as typed array`);if((o===\"POSITION\"||o===\"positions\")&&!c.size&&(c.size=3),o===\"indices\"){if(this.indices)throw new Error(\"Multiple indices detected\");this.indices=c}else this.attributes[o]=c}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,n){return this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(let i of Object.values(e)){let{value:o,size:s,constant:c}=i;!c&&o&&s!==void 0&&s>=1&&(r=Math.min(r,o.length/s))}return r}};var nd=class{id;matrix=new wn;display=!0;position=new $e;rotation=new $e;scale=new $e(1,1,1);userData={};props={};constructor(e={}){let{id:n}=e;this.id=n||Al(this.constructor.name),this._setScenegraphNodeProps(e)}getBounds(){return null}destroy(){}delete(){this.destroy()}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return this.position=e,this}setRotation(e){return this.rotation=e,this}setScale(e){return this.scale=e,this}setMatrix(e,n=!0){n?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){let{position:n,rotation:r,scale:i,update:o=!0}=e;return n&&this.setPosition(n),r&&this.setRotation(r),i&&this.setScale(i),o&&this.updateMatrix(),this}updateMatrix(){let e=this.position,n=this.rotation,r=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(n),this.matrix.scale(r),this}update(e={}){let{position:n,rotation:r,scale:i}=e;return n&&this.setPosition(n),r&&this.setRotation(r),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(e,n){n=n||this.matrix;let r=new wn(e).multiplyRight(n),i=r.invert(),o=i.transpose();return{viewMatrix:e,modelMatrix:n,objectMatrix:n,worldMatrix:r,worldInverseMatrix:i,worldInverseTransposeMatrix:o}}_setScenegraphNodeProps(e){\"position\"in e&&this.setPosition(e.position),\"rotation\"in e&&this.setRotation(e.rotation),\"scale\"in e&&this.setScale(e.scale),\"matrix\"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}};lr();var Op=class t extends nd{children;constructor(e={}){e=Array.isArray(e)?{children:e}:e;let{children:n=[]}=e;St.assert(n.every(r=>r instanceof nd),\"every child must an instance of ScenegraphNode\"),super(e),this.children=n}getBounds(){let e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((n,{worldMatrix:r})=>{let i=n.getBounds();if(!i)return;let[o,s]=i,c=new $e(o).add(s).divide([2,2,2]);r.transformAsPoint(c,c);let d=new $e(s).subtract(o).divide([2,2,2]);r.transformAsVector(d,d);for(let m=0;m<8;m++){let b=new $e(m&1?-1:1,m&2?-1:1,m&4?-1:1).multiply(d).add(c);for(let C=0;C<3;C++)e[0][C]=Math.min(e[0][C],b[C]),e[1][C]=Math.max(e[1][C],b[C])}}),Number.isFinite(e[0][0])?e:null}destroy(){this.children.forEach(e=>e.destroy()),this.removeAll(),super.destroy()}add(...e){for(let n of e)Array.isArray(n)?this.add(...n):this.children.push(n);return this}remove(e){let n=this.children,r=n.indexOf(e);return r>-1&&n.splice(r,1),this}removeAll(){return this.children=[],this}traverse(e,{worldMatrix:n=new wn}={}){let r=new wn(n).multiplyRight(this.matrix);for(let i of this.children)i instanceof t?i.traverse(e,{worldMatrix:r}):e(i,{worldMatrix:r})}};var OA=class extends nd{model;bounds=null;managedResources;constructor(e){super(e),this.model=e.model,this.managedResources=e.managedResources||[],this.bounds=e.bounds||null,this.setProps(e)}destroy(){this.model&&(this.model.destroy(),this.model=null),this.managedResources.forEach(e=>e.destroy()),this.managedResources=[]}getBounds(){return this.bounds}draw(e){return this.model.draw(e)}};var Zm=class extends gi{constructor(e={}){let{id:n=Al(\"cube-geometry\"),indices:r=!0}=e;super(r?{...e,id:n,topology:\"triangle-list\",indices:{size:1,value:bve},attributes:{...Ive,...e.attributes}}:{...e,id:n,topology:\"triangle-list\",indices:void 0,attributes:{...Pve,...e.attributes}})}},bve=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),wve=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),Tve=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),Eve=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),Sve=new Float32Array([1,-1,1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,1,-1,1,1,1,-1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1]),Cve=new Float32Array([1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,1,0,0]),Mve=new Float32Array([1,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1,1,0,1,1,0,0,0,1,1,1,1,1,1,0,1,1,1,0,0,1,1,1,0,1,1,1,1,1,1,0,0,1,0,1,1,1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,1,1,1,1,0,1,0,0,1,1,0,1,1,1,0,1,0,1,0,0,0,1,0,0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0,0,1,1,0,0,1,1,1,0,1,1,1,1,1,1,1,0,0,1,0,0,0,1,0,1,0,1,1,1,0,1,1,0,0,1,0,1,0,1]),Ive={POSITION:{size:3,value:wve},NORMAL:{size:3,value:Tve},TEXCOORD_0:{size:2,value:Eve}},Pve={POSITION:{size:3,value:Sve},TEXCOORD_0:{size:2,value:Cve},COLOR_0:{size:3,value:Mve}};var Rve={blendColorOperation:\"add\",blendColorSrcFactor:\"one\",blendColorDstFactor:\"zero\",blendAlphaOperation:\"add\",blendAlphaSrcFactor:\"constant\",blendAlphaDstFactor:\"zero\"},qm=class extends Lp{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return\"pickingFBO\"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:o,pickingFBO:s,deviceRect:{x:c,y:d,width:m,height:b},cullRect:C,effects:B,pass:k=\"picking\",pickZ:V,shaderModuleProps:q}){this.pickZ=V;let K=this._resetColorEncoder(V),Y=[c,d,m,b],ee=super.render({target:s,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:o,cullRect:C,effects:B?.filter(se=>se.useInPicking),pass:k,isPicking:!0,shaderModuleProps:q,clearColor:[0,0,0,0],colorMask:15,scissorRect:Y});return this._colorEncoderState=null,{decodePickingColor:K&&Dve.bind(null,K),stats:ee}}shouldDrawLayer(e){let{pickable:n,operation:r}=e.props;return n&&r.includes(\"draw\")||r.includes(\"terrain\")||r.includes(\"mask\")}getShaderModuleProps(e,n,r){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,n,r){let i={...e.props.parameters},{pickable:o,operation:s}=e.props;return!this._colorEncoderState||s.includes(\"terrain\")?i.blend=!1:o&&s.includes(\"draw\")&&(Object.assign(i,Rve),i.blend=!0,i.blendColor=Bve(this._colorEncoderState,e,r)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}};function Bve(t,e,n){let{byLayer:r,byAlpha:i}=t,o,s=r.get(e);return s?(s.viewports.push(n),o=s.a):(o=r.size+1,o<=255?(s={a:o,layer:e,viewports:[n]},r.set(e,s),i[o]=s):(hn.warn(\"Too many pickable layers, only picking the first 255\")(),o=0)),[0,0,0,o/255]}function Dve(t,e){let n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}var FA={NO_STATE:\"Awaiting state\",MATCHED:\"Matched. State transferred from previous layer\",INITIALIZED:\"Initialized\",AWAITING_GC:\"Discarded. Awaiting garbage collection\",AWAITING_FINALIZATION:\"No longer matched. Awaiting garbage collection\",FINALIZED:\"Finalized! Awaiting garbage collection\"},jy=Symbol.for(\"component\"),Ku=Symbol.for(\"propTypes\"),l4=Symbol.for(\"deprecatedProps\"),Fp=Symbol.for(\"asyncPropDefaults\"),rd=Symbol.for(\"asyncPropOriginal\"),ef=Symbol.for(\"asyncPropResolved\");function kp(t,e=()=>!0){return Array.isArray(t)?GK(t,e,[]):e(t)?[t]:[]}function GK(t,e,n){let r=-1;for(;++r<t.length;){let i=t[r];Array.isArray(i)?GK(i,e,n):e(i)&&n.push(i)}return n}function UF({target:t,source:e,start:n=0,count:r=1}){let i=e.length,o=r*i,s=0;for(let c=n;s<i;s++)t[c++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}wm();var uw=class{constructor(e,n,r){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;let r=++this._loadCount,i=e;typeof e==\"string\"&&(i=va(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(o=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=o)}).catch(o=>{this._loadCount===r&&(this.isLoaded=!0,this._error=o||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(let o of this._subscribers)o.onChange(this.getData())}};var hw=class{constructor(e){this.protocol=e.protocol||\"resource://\",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let o=this._resources[e];o?o.setData(n,r):(o=new uw(e,n,this._context),this._resources[e]=o),o.persistent=i}remove(e){let n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){let n=this._consumers[e];if(n){for(let r in n){let i=n[r],o=this._resources[i.resourceId];o&&o.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i=\"default\"}){let{_resources:o,protocol:s}=this;e.startsWith(s)&&(e=e.replace(s,\"\"),o[e]||this.add({resourceId:e,data:null,persistent:!1}));let c=o[e];if(this._track(r,i,c,n),c)return c.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(let e in this._resources)this._resources[e].delete()}_track(e,n,r,i){let o=this._consumers,s=o[e]=o[e]||{},c=s[n],d=c&&c.resourceId&&this._resources[c.resourceId];d&&(d.unsubscribe(c),this.prune()),r&&(c?(c.onChange=i,c.resourceId=r.id):c={onChange:i,resourceId:r.id},s[n]=c,r.subscribe(c))}_prune(){this._pruneRequest=null;for(let e of Object.keys(this._resources)){let n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}};var Lve=\"layerManager.setLayers\",Ove=\"layerManager.activateViewport\",fw=class{constructor(e,n){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=c=>{ss(Ove,this,c),c&&(this.context.viewport=c)};let{deck:r,stats:i,viewport:o,timeline:s}=n||{};this.layers=[],this.resourceManager=new hw({device:e,protocol:\"deck://\"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:r,shaderAssembler:xK(e?.info?.shadingLanguage||\"glsl\"),defaultShaderModules:[gF],renderPass:void 0,stats:i||new hl({id:\"deck.gl\"}),viewport:o||new su({id:\"DEFAULT-INITIAL-VIEWPORT\"}),timeline:s||new Xm,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(let e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(let r of this.layers){let i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?\"layers changed\":this._defaultShaderModulesChanged?\"shader modules changed\":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){\"debug\"in e&&(this._debug=e.debug),\"userData\"in e&&(this.context.userData=e.userData),\"layers\"in e&&(this._nextLayers=e.layers),\"onError\"in e&&(this.context.onError=e.onError)}setLayers(e,n){ss(Lve,this,n,e),this._lastRenderedLayers=e;let r=kp(e,Boolean);for(let i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){let e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){let{defaultShaderModules:n}=this.context;n.find(r=>r.name===e.name)||(n.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){let{defaultShaderModules:n}=this.context,r=n.findIndex(i=>i.name===e.name);r>=0&&(n.splice(r,1),this._defaultShaderModulesChanged=!0)}_handleError(e,n,r){r.raiseError(n,`${e} of ${r}`)}_updateLayers(e,n){let r={};for(let s of e)r[s.id]?hn.warn(`Multiple old layers with same id ${s.id}`)():r[s.id]=s;if(this._defaultShaderModulesChanged){for(let s of e)s.setNeedsUpdate(),s.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}let i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let o=!1;for(let s of i)if(s.hasUniformTransition()){o=`Uniform transition in ${s}`;break}this._needsUpdate=o,this.layers=i}_updateSublayersRecursively(e,n,r){for(let i of e){i.context=this.context;let o=n[i.id];o===null&&hn.warn(`Multiple new layers with same id ${i.id}`)(),n[i.id]=null;let s=null;try{this._debug&&o!==i&&i.validateProps(),o?(this._transferLayerState(o,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),s=i.isComposite?i.getSubLayers():null}catch(c){this._handleError(\"matching\",c,i)}s&&this._updateSublayersRecursively(s,n,r)}}_finalizeOldLayers(e){for(let n in e){let r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=FA.INITIALIZED}catch(n){this._handleError(\"initialization\",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=FA.MATCHED,n!==e&&(e.lifecycle=FA.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError(\"update\",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=FA.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=FA.FINALIZED}catch(n){this._handleError(\"finalization\",n,e)}}};function Li(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Li(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t==\"object\"&&typeof e==\"object\"){let r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(let o of r)if(!e.hasOwnProperty(o)||!Li(t[o],e[o],n-1))return!1;return!0}return!1}var dw=class{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw=\"First render\",this._needsUpdate=\"Initialize\",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(let e in this.controllers){let n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(let e in this.controllers){let n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){let e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){let n=typeof e==\"string\"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){let r=this.getViewports(),i={x:e[0],y:e[1]};for(let o=r.length-1;o>=0;--o){let s=r[o];if(s.containsPixel(i)){let c=e.slice();return c[0]-=s.x,c[1]-=s.y,s.unproject(c,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),(\"width\"in e||\"height\"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate(\"Size changed\"))}_setViews(e){e=kp(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate(\"views changed\"),this.views=e}_setViewState(e){e?(!Li(e,this.viewState,3)&&this.setNeedsUpdate(\"viewState changed\"),this.viewState=e):hn.warn(\"missing `viewState` or `initialViewState`\")()}_createController(e,n){let r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:o=>this.getView(e.id)?.makeViewport({viewState:o,width:this.width,height:this.height})})}_updateController(e,n,r,i){let o=e.controller;if(o&&r){let s={...n,...o,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==o.type)&&(i=this._createController(e,s)),i&&i.setProps(s),i}return null}_rebuildViewports(){let{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){let o=e[i],s=this.getViewState(o),c=o.makeViewport({viewState:s,width:this.width,height:this.height}),d=n[o.id],m=!!o.controller;m&&!d&&(r=!0),(r||!m)&&d&&(d.finalize(),d=null),this.controllers[o.id]=this._updateController(o,s,c,d),c&&this._viewports.unshift(c)}for(let i in n){let o=n[i];o&&!this.controllers[i]&&o.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}};var Fve=/([0-9]+\\.?[0-9]*)(%|px)/;function Np(t){switch(typeof t){case\"number\":return{position:t,relative:!1};case\"string\":let e=Fve.exec(t);if(e&&e.length>=3){let n=e[2]===\"%\",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error(`Could not parse position string ${t}`)}}function zp(t,e){return t.relative?Math.round(t.position*e):t.position}var au=class{constructor(e){let{id:n,x:r=0,y:i=0,width:o=\"100%\",height:s=\"100%\",padding:c=null}=e;this.id=n||this.constructor.displayName||\"view\",this.props={...e,id:this.id},this._x=Np(r),this._y=Np(i),this._width=Np(o),this._height=Np(s),this._padding=c&&{left:Np(c.left||0),right:Np(c.right||0),top:Np(c.top||0),bottom:Np(c.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&Li(this.props,e.props,2)}clone(e){let n=this.constructor;return new n({...this.props,...e})}makeViewport({width:e,height:n,viewState:r}){r=this.filterViewState(r);let i=this.getDimensions({width:e,height:n});if(!i.height||!i.width)return null;let o=this.getViewportType(r);return new o({...r,...this.props,...i})}getViewStateId(){let{viewState:e}=this.props;return typeof e==\"string\"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState==\"object\"){if(!this.props.viewState.id)return this.props.viewState;let n={...e};for(let r in this.props.viewState)r!==\"id\"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){let r={x:zp(this._x,e),y:zp(this._y,n),width:zp(this._width,e),height:zp(this._height,n)};return this._padding&&(r.padding={left:zp(this._padding.left,e),top:zp(this._padding.top,n),right:zp(this._padding.right,e),bottom:zp(this._padding.bottom,n)}),r}get controller(){let e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e==\"function\"?{type:e}:{type:this.ControllerType,...e}:null}};var tf=class{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){let{_timeline:e,settings:n}=this;this._handle=e.addChannel({delay:e.getTime(),duration:n.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};var HK=()=>{},VF={BREAK:1,SNAP_TO_END:2,IGNORE:3},kve=t=>t,Nve=VF.BREAK,pw=class{constructor(e){this._onTransitionUpdate=n=>{let{time:r,settings:{interpolator:i,startProps:o,endProps:s,duration:c,easing:d}}=n,m=d(r/c),b=i.interpolateProps(o,s,m);this.propsInTransition=this.getControllerState({...this.props,...b}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new tf(e.timeline),this.onViewStateChange=e.onViewStateChange||HK,this.onStateChange=e.onStateChange||HK}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1,r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){let{interruption:o,endProps:s}=this.transition.settings;i={...r,...o===VF.SNAP_TO_END?s:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){let{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n===\"auto\")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===VF.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){let r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),o=n.transitionInterpolator,s=o.getDuration?o.getDuration(e,n):n.transitionDuration;if(s===0)return;let c=o.initializeProps(e,i);this.propsInTransition={};let d={duration:s,easing:n.transitionEasing||kve,interpolator:o,interruption:n.transitionInterruption||Nve,startProps:c.start,endProps:c.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(d),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}};function No(t,e){if(!t)throw new Error(e||\"deck.gl: assertion failed.\")}var Aw=class{constructor(e){let{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(let r of this._propsToCompare)if(!(r in e)||!(r in n)||!Gs(e[r],n[r]))return!1;return!0}initializeProps(e,n){let r={},i={};for(let o of this._propsToExtract)(o in e||o in n)&&(r[o]=e[o],i[o]=n[o]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{let r=e[n];No(Number.isFinite(r)||Array.isArray(r),`${n} is required for transition`)})}};var c4=Math.PI/180,WK=180/Math.PI,h4=6370972,Xy=256;function zve(){let t=Xy/h4,e=Math.PI/180*Xy;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}var f4=class extends su{constructor(e={}){let{longitude:n=0,zoom:r=0,nearZMultiplier:i=.5,farZMultiplier:o=1,resolution:s=10}=e,{latitude:c=0,height:d,altitude:m=1.5,fovy:b}=e;c=Math.max(Math.min(c,Jh),-Jh),d=d||1,b?m=jm(b):b=Dp(m);let C=Math.pow(2,r-u4(c)),B=e.nearZ??i,k=e.farZ??(m+Xy*2*C/d)*o,V=new wn().lookAt({eye:[0,-m,0],up:[0,0,1]});V.rotateX(c*c4),V.rotateZ(-n*c4),V.scale(C/d),super({...e,height:d,viewMatrix:V,longitude:n,latitude:c,zoom:r,distanceScales:zve(),fovy:b,focalDistance:m,near:B,far:k}),this.scale=C,this.latitude=c,this.longitude=n,this.fovy=b,this.resolution=s}get projectionMode(){return ea.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){let n={targetZ:e.z||0},r=this.unproject([0,this.height/2],n),i=this.unproject([this.width/2,0],n),o=this.unproject([this.width,this.height/2],n),s=this.unproject([this.width/2,this.height],n);return o[0]<this.longitude&&(o[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],o[0],i[0],s[0]),Math.min(r[1],o[1],i[1],s[1]),Math.max(r[0],o[0],i[0],s[0]),Math.max(r[1],o[1],i[1],s[1])]}unproject(e,{topLeft:n=!0,targetZ:r}={}){let[i,o,s]=e,c=n?o:this.height-o,{pixelUnprojectionMatrix:d}=this,m;if(Number.isFinite(s))m=GF(d,[i,c,s,1]);else{let k=GF(d,[i,c,-1,1]),V=GF(d,[i,c,1,1]),q=((r||0)/h4+1)*Xy,K=Ya.sqrLen(Ya.sub([],k,V)),Y=Ya.sqrLen(k),ee=Ya.sqrLen(V),se=4*((4*Y*ee-(K-Y-ee)**2)/16)/K,xe=Math.sqrt(Y-se),Ee=Math.sqrt(Math.max(0,q*q-se)),Xe=(xe-Ee)/Math.sqrt(K);m=Ya.lerp([],k,V,Xe)}let[b,C,B]=this.unprojectPosition(m);return Number.isFinite(s)?[b,C,B]:Number.isFinite(r)?[b,C,r]:[b,C]}projectPosition(e){let[n,r,i=0]=e,o=n*c4,s=r*c4,c=Math.cos(s),d=(i/h4+1)*Xy;return[Math.sin(o)*c*d,-Math.cos(o)*c*d,Math.sin(s)*d]}unprojectPosition(e){let[n,r,i]=e,o=Ya.len(e),s=Math.asin(i/o),d=Math.atan2(n,-r)*WK,m=s*WK,b=(o/Xy-1)*h4;return[d,m,b]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition([e,n,r],i,o){let c=.25/Math.pow(2,this.zoom-u4(this.latitude)),d=e+c*(o[0]-i[0]),m=n-c*(o[1]-i[1]);m=Math.max(Math.min(m,Jh),-Jh);let b={longitude:d,latitude:m,zoom:r-u4(n)};return b.zoom+=u4(b.latitude),b}};f4.displayName=\"GlobeViewport\";var gw=f4;function u4(t){let e=Math.PI*Math.cos(t*Math.PI/180);return Math.log2(e)}function GF(t,e){let n=bc.transformMat4([],e,t);return bc.scale(n,n,1/n[3]),n}var Uve=[\"longitude\",\"latitude\",\"zoom\",\"bearing\",\"pitch\"],Vve=[\"longitude\",\"latitude\",\"zoom\"],Qm=class extends Aw{constructor(e={}){let n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:Uve,required:Vve},super(r.transitionProps),this.opts=r}initializeProps(e,n){let r=super.initializeProps(e,n),{makeViewport:i,around:o}=this.opts;if(i&&o)if(i(e)instanceof gw)hn.warn(\"around not supported in GlobeView\")();else{let c=i(e),d=i(n),m=c.unproject(o);r.start.around=o,Object.assign(r.end,{around:d.project(m),aroundPosition:m,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){let i={};for(let o of this._propsToExtract)i[o]=Xa(e[o]||0,n[o]||0,r);if(n.aroundPosition&&this.opts.makeViewport){let o=this.opts.makeViewport({...n,...i});Object.assign(i,o.panByPosition(n.aroundPosition,Xa(e.around,n.around,r)))}return i}};var Up={transitionDuration:0},Gve=300,d4=t=>1-(1-t)*(1-t),Yy={WHEEL:[\"wheel\"],PAN:[\"panstart\",\"panmove\",\"panend\"],PINCH:[\"pinchstart\",\"pinchmove\",\"pinchend\"],MULTI_PAN:[\"multipanstart\",\"multipanmove\",\"multipanend\"],DOUBLE_CLICK:[\"dblclick\"],KEYBOARD:[\"keydown\"]},Km={},mw=class{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode=\"rotate\",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new pw({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(let e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;let n=this._eventStartBlocked;switch(e.type){case\"panstart\":return n?!1:this._onPanStart(e);case\"panmove\":return this._onPan(e);case\"panend\":return this._onPanEnd(e);case\"pinchstart\":return n?!1:this._onPinchStart(e);case\"pinchmove\":return this._onPinch(e);case\"pinchend\":return this._onPinchEnd(e);case\"multipanstart\":return n?!1:this._onMultiPanStart(e);case\"multipanmove\":return this._onMultiPan(e);case\"multipanend\":return this._onMultiPanEnd(e);case\"dblclick\":return this._onDoubleClick(e);case\"wheel\":return this._onWheel(e);case\"keydown\":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){let{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){let{width:r,height:i}=this.props;if(n&&n.handled)return!1;let o=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return o&&n&&n.stopPropagation(),o}isFunctionKeyPressed(e){let{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){let n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,\"transitionInterpolator\"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?Gve:0;let{scrollZoom:r=!0,dragPan:i=!0,dragRotate:o=!0,doubleClickZoom:s=!0,touchZoom:c=!0,touchRotate:d=!1,keyboard:m=!0}=e,b=!!this.onViewStateChange;this.toggleEvents(Yy.WHEEL,b&&r),this.toggleEvents(Yy.PAN,b),this.toggleEvents(Yy.PINCH,b&&(c||d)),this.toggleEvents(Yy.MULTI_PAN,b&&d),this.toggleEvents(Yy.DOUBLE_CLICK,b&&s),this.toggleEvents(Yy.KEYBOARD,b&&m),this.scrollZoom=r,this.dragPan=i,this.dragRotate=o,this.doubleClickZoom=s,this.touchZoom=c,this.touchRotate=d,this.keyboard=m}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){let i={...e.getViewportProps(),...n},o=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),o){let s=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:s,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){let n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode===\"pan\")&&(r=!r);let i=this.controllerState[r?\"panStart\":\"rotateStart\"]({pos:n});return this._panMove=r,this.updateViewport(i,Up,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;let n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Up,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){let{inertia:n}=this;if(this.dragPan&&n&&e.velocity){let r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],o=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:d4},{isDragging:!1,isPanning:!0})}else{let r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;let n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Up,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){let{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){let r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],o=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:d4},{isDragging:!1,isRotating:!0})}else{let r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;let n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();let{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:o}=e,s=2/(1+Math.exp(-Math.abs(o*r)));o<0&&s!==0&&(s=1/s);let c=i?{...this._getTransitionProps({around:n}),transitionDuration:250}:Up,d=this.controllerState.zoom({pos:n,scale:s});return this.updateViewport(d,c,{isZooming:!0,isPanning:!0}),i||this._setInteractionState({isZooming:!1,isPanning:!1}),!0}_onMultiPanStart(e){let n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Up,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;let n=this.getCenter(e);n[0]-=e.deltaX;let r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Up,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;let{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){let r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],o=this.controllerState.rotate({pos:i});this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:d4},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{let r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){let n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Km._startPinchRotation=e.rotation,Km._lastPinchEvent=e,this.updateViewport(r,Up,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){let{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){let{rotation:r}=e;n=n.rotate({deltaAngleX:Km._startPinchRotation-r})}return this.updateViewport(n,Up,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Km._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;let{inertia:n}=this,{_lastPinchEvent:r}=Km;if(this.touchZoom&&n&&r&&e.scale!==r.scale){let i=this.getCenter(e),o=this.controllerState.rotateEnd(),s=Math.log2(e.scale),c=(s-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),d=Math.pow(2,s+c*n/2);o=o.zoom({pos:i,scale:d}).zoomEnd(),this.updateViewport(o,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:d4},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{let i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Km._startPinchRotation=null,Km._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;let n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;let n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:o,rotateSpeedY:s}=this.keyboard===!0?{}:this.keyboard,{controllerState:c}=this,d,m={};switch(e.srcEvent.code){case\"Minus\":d=n?c.zoomOut(r).zoomOut(r):c.zoomOut(r),m.isZooming=!0;break;case\"Equal\":d=n?c.zoomIn(r).zoomIn(r):c.zoomIn(r),m.isZooming=!0;break;case\"ArrowLeft\":n?(d=c.rotateLeft(o),m.isRotating=!0):(d=c.moveLeft(i),m.isPanning=!0);break;case\"ArrowRight\":n?(d=c.rotateRight(o),m.isRotating=!0):(d=c.moveRight(i),m.isPanning=!0);break;case\"ArrowUp\":n?(d=c.rotateUp(s),m.isRotating=!0):(d=c.moveUp(i),m.isPanning=!0);break;case\"ArrowDown\":n?(d=c.rotateDown(s),m.isRotating=!0):(d=c.moveDown(i),m.isPanning=!0);break;default:return!1}return this.updateViewport(d,this._getTransitionProps(),m),!0}_getTransitionProps(e){let{transition:n}=this;return!n||!n.transitionInterpolator?Up:e?{...n,transitionInterpolator:new Qm({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}};var _w=class{constructor(e,n){this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}};var jK=5,Hve=1.2,HF=class extends _w{constructor(e){let{width:n,height:r,latitude:i,longitude:o,zoom:s,bearing:c=0,pitch:d=0,altitude:m=1.5,position:b=[0,0,0],maxZoom:C=20,minZoom:B=0,maxPitch:k=60,minPitch:V=0,startPanLngLat:q,startZoomLngLat:K,startRotatePos:Y,startBearing:ee,startPitch:J,startZoom:se,normalize:xe=!0}=e;No(Number.isFinite(o)),No(Number.isFinite(i)),No(Number.isFinite(s)),super({width:n,height:r,latitude:i,longitude:o,zoom:s,bearing:c,pitch:d,altitude:m,maxZoom:C,minZoom:B,maxPitch:k,minPitch:V,normalize:xe,position:b},{startPanLngLat:q,startZoomLngLat:K,startRotatePos:Y,startBearing:ee,startPitch:J,startZoom:se}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){let r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;let o=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){let{startRotatePos:i,startBearing:o,startPitch:s}=this.getState();if(!i||o===void 0||s===void 0)return this;let c;return e?c=this._getNewRotation(e,i,s,o):c={bearing:o+n,pitch:s+r},this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:o}=this.getState();if(o||(i=this.getViewportProps().zoom,o=this._unproject(n)||this._unproject(e)),!o)return this;let{maxZoom:s,minZoom:c}=this.getViewportProps(),d=i+Math.log2(r);d=Jl(d,c,s);let m=this.makeViewport({...this.getViewportProps(),zoom:d});return this._getUpdatedState({zoom:d,...m.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){let n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:o}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(o-n.longitude)>180&&(r.longitude=o<0?o+360:o-360),r}applyConstraints(e){let{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Jl(i,r,n);let{maxPitch:o,minPitch:s,pitch:c}=e;e.pitch=Jl(c,s,o);let{normalize:d=!0}=e;return d&&Object.assign(e,DF(e)),e}_zoomFromCenter(e){let{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){let{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){let n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){let o=e[0]-n[0],s=e[1]-n[1],c=e[1],d=n[1],{width:m,height:b}=this.getViewportProps(),C=o/m,B=0;s>0?Math.abs(b-d)>jK&&(B=s/(d-b)*Hve):s<0&&d>jK&&(B=1-c/d),B=Jl(B,-1,1);let{minPitch:k,maxPitch:V}=this.getViewportProps(),q=i+180*C,K=r;return B>0?K=r+B*(V-r):B<0&&(K=r-B*(k-r)),{pitch:K,bearing:q}}},yw=class extends mw{constructor(){super(...arguments),this.ControllerState=HF,this.transition={transitionDuration:300,transitionInterpolator:new Qm({transitionProps:{compare:[\"longitude\",\"latitude\",\"zoom\",\"bearing\",\"pitch\",\"position\"],required:[\"longitude\",\"latitude\",\"zoom\"]}})},this.dragMode=\"pan\"}setProps(e){e.position=e.position||[0,0,0];let n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}};var p4=class extends au{constructor(e={}){super(e)}getViewportType(){return LA}get ControllerType(){return yw}};p4.displayName=\"MapView\";var XK=p4;var Wve=new zy;function jve(t,e){let n=t.order??1/0,r=e.order??1/0;return n-r}var xw=class{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw=\"Initial render\",this._setEffects([])}addDefaultEffect(e){let n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){let r=n.findIndex(i=>jve(i,e)>0);r<0?n.push(e):n.splice(r,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){\"effects\"in e&&(Li(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){let n={};for(let i of this.effects)n[i.id]=i;let r=[];for(let i of e){let o=n[i.id],s=i;o&&o!==i?o.setProps?(o.setProps(i.props),s=o):o.cleanup(this._context):o||i.setup(this._context),r.push(s),delete n[i.id]}for(let i in n)n[i].cleanup(this._context);this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof zy)||this._resolvedEffects.push(Wve),this._needsRedraw=\"effects changed\"}finalize(){for(let e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}};var vw=class extends Lp{shouldDrawLayer(e){let{operation:n}=e.props;return n.includes(\"draw\")||n.includes(\"terrain\")}};var Xve=\"deckRenderer.renderLayers\",bw=class{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new vw(e),this.pickLayersPass=new qm(e),this.renderCount=0,this._needsRedraw=\"Initial render\",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw=\"layerFilter changed\"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw=\"drawPickingColors changed\")}renderLayers(e){if(!e.viewports.length)return;let n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};r.effects&&this._preRender(r.effects,r);let i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target;this.lastPostProcessEffect&&(r.clearColor=[0,0,0,0],r.clearCanvas=!0);let o=n.render({...r,target:i});r.effects&&(this.lastPostProcessEffect&&(r.clearCanvas=e.clearCanvas===void 0?!0:e.clearCanvas),this._postRender(r.effects,r)),this.renderCount++,ss(Xve,this,o,e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){let{renderBuffers:e}=this;for(let n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(let r of e)n.preRenderStats[r.id]=r.preRender(n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){let{renderBuffers:e}=this,n=this.device.canvasContext.getDrawingBufferSize(),[r,i]=n;e.length===0&&[0,1].map(o=>{let s=this.device.createTexture({sampler:{minFilter:\"linear\",magFilter:\"linear\"},width:r,height:i});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${o}`,colorAttachments:[s]}))});for(let o of e)o.resize(n)}_postRender(e,n){let{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1]};for(let o of e)if(o.postRender){i.target=o.id===this.lastPostProcessEffect?n.target:void 0;let s=o.postRender(i);i.inputBuffer=s,i.swapBuffer=s===r[0]?r[1]:r[0]}}};var Yve={pickedColor:null,pickedObjectIndex:-1};function WF({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:o}){let{x:s,y:c,width:d,height:m}=o,b=i*i,C=-1,B=0;for(let k=0;k<m;k++){let V=k+c-r,q=V*V;if(q>b)B+=4*d;else for(let K=0;K<d;K++){if(t[B+3]-1>=0){let ee=K+s-n,J=ee*ee+q;J<=b&&(b=J,C=B)}B+=4}}if(C>=0){let k=t.slice(C,C+4),V=e(k);if(V){let q=Math.floor(C/4/d),K=C/4-q*d;return{...V,pickedColor:k,pickedX:s+K,pickedY:c+q}}hn.error(\"Picked non-existent layer. Is picking buffer corrupt?\")()}return Yve}function jF({pickedColors:t,decodePickingColor:e}){let n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){let o=t.slice(r,r+4),s=o.join(\",\");if(!n.has(s)){let c=e(o);c?n.set(s,{...c,color:o}):hn.error(\"Picked non-existent layer. Is picking buffer corrupt?\")()}}}return Array.from(n.values())}function A4({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:o}){let s=e[0];e.length>1&&(s=Zve(t?.pickedViewports||e,{x:r,y:i}));let c;if(s){let d=[r-s.x,i-s.y];o!==void 0&&(d[2]=o),c=s.unproject(d)}return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:c,devicePixel:t&&\"pickedX\"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function XF(t){let{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:c}=e,d=s?[s]:[];if(r===\"hover\"){let C=n.index,B=n.layerId,k=s?s.props.id:null;if(k!==B||c!==C){if(k!==B){let V=i.find(q=>q.props.id===B);V&&d.unshift(V)}n.layerId=k,n.index=c,n.info=null}}let m=A4(t),b=new Map;return b.set(null,m),d.forEach(C=>{let B={...m};C===s&&(B.color=o,B.index=c,B.picked=!0),B=g4({layer:C,info:B,mode:r});let k=B.layer;C===s&&r===\"hover\"&&(n.info=B),b.set(k.id,B),r===\"hover\"&&k.updateAutoHighlight(B)}),b}function g4({layer:t,info:e,mode:n}){for(;t&&e;){let r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function Zve(t,e){for(let n=t.length-1;n>=0;n--){let r=t[n];if(r.containsPixel(e))return r}return t[0]}var ww=class{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new qm(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){\"layerFilter\"in e&&(this.layerFilter=e.layerFilter),\"_pickable\"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObjectAsync(e){return this._pickClosestObjectAsync(e)}pickObjectsAsync(e){return this._pickVisibleObjectsAsync(e)}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},o=this.lastPickedInfo.info){let s=o&&o.layer&&o.layer.id,c=o&&o.viewport&&o.viewport.id,d=s?r.find(B=>B.id===s):null,m=c&&i.find(B=>B.id===c)||i[0],b=m&&m.unproject([e-m.x,n-m.y]);return{...o,...{x:e,y:n,viewport:m,coordinate:b,layer:d}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:[\"rgba8unorm\"],depthStencilAttachment:\"depth16unorm\"}),this.device.isTextureFormatRenderable(\"rgba32float\"))){let n=this.device.createFramebuffer({colorAttachments:[\"rgba32float\"],depthStencilAttachment:\"depth16unorm\"});this.depthFBO=n}let{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;let n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}async _pickClosestObjectAsync({layers:e,views:n,viewports:r,x:i,y:o,radius:s=0,depth:c=1,mode:d=\"query\",unproject3D:m,onViewportActive:b,effects:C}){let B=this.device.canvasContext.cssToDeviceRatio(),k=this._getPickable(e);if(!k||r.length===0)return{result:[],emptyInfo:A4({viewports:r,x:i,y:o,pixelRatio:B})};this._resizeBuffer();let V=this.device.canvasContext.cssToDevicePixels([i,o],!0),q=[V.x+Math.floor(V.width/2),V.y+Math.floor(V.height/2)],K=Math.round(s*B),{width:Y,height:ee}=this.pickingFBO,J=this._getPickingRect({deviceX:q[0],deviceY:q[1],deviceRadius:K,deviceWidth:Y,deviceHeight:ee}),se={x:i-s,y:o-s,width:s*2+1,height:s*2+1},xe,Ee=[],Xe=new Set;for(let Ne=0;Ne<c;Ne++){let be;if(J){let Qe=this._drawAndSample({layers:k,views:n,viewports:r,onViewportActive:b,deviceRect:J,cullRect:se,effects:C,pass:`picking:${d}`});be=WF({...Qe,deviceX:q[0],deviceY:q[1],deviceRadius:K,deviceRect:J})}else be={pickedColor:null,pickedObjectIndex:-1};let ge;if(be.pickedLayer&&m&&this.depthFBO){let{pickedColors:Qe}=this._drawAndSample({layers:[be.pickedLayer],views:n,viewports:r,onViewportActive:b,deviceRect:{x:be.pickedX,y:be.pickedY,width:1,height:1},cullRect:se,effects:C,pass:`picking:${d}:z`},!0);Qe[3]&&(ge=Qe[0])}be.pickedLayer&&Ne+1<c&&(Xe.add(be.pickedLayer),be.pickedLayer.disablePickingIndex(be.pickedObjectIndex)),xe=XF({pickInfo:be,lastPickedInfo:this.lastPickedInfo,mode:d,layers:k,viewports:r,x:i,y:o,z:ge,pixelRatio:B});for(let Qe of xe.values())Qe.layer&&Ee.push(Qe);if(!be.pickedColor)break}for(let Ne of Xe)Ne.restorePickingColors();return{result:Ee,emptyInfo:xe.get(null)}}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:o,radius:s=0,depth:c=1,mode:d=\"query\",unproject3D:m,onViewportActive:b,effects:C}){let B=this.device.canvasContext.cssToDeviceRatio(),k=this._getPickable(e);if(!k||r.length===0)return{result:[],emptyInfo:A4({viewports:r,x:i,y:o,pixelRatio:B})};this._resizeBuffer();let V=this.device.canvasContext.cssToDevicePixels([i,o],!0),q=[V.x+Math.floor(V.width/2),V.y+Math.floor(V.height/2)],K=Math.round(s*B),{width:Y,height:ee}=this.pickingFBO,J=this._getPickingRect({deviceX:q[0],deviceY:q[1],deviceRadius:K,deviceWidth:Y,deviceHeight:ee}),se={x:i-s,y:o-s,width:s*2+1,height:s*2+1},xe,Ee=[],Xe=new Set;for(let Ne=0;Ne<c;Ne++){let be;if(J){let Qe=this._drawAndSample({layers:k,views:n,viewports:r,onViewportActive:b,deviceRect:J,cullRect:se,effects:C,pass:`picking:${d}`});be=WF({...Qe,deviceX:q[0],deviceY:q[1],deviceRadius:K,deviceRect:J})}else be={pickedColor:null,pickedObjectIndex:-1};let ge;if(be.pickedLayer&&m&&this.depthFBO){let{pickedColors:Qe}=this._drawAndSample({layers:[be.pickedLayer],views:n,viewports:r,onViewportActive:b,deviceRect:{x:be.pickedX,y:be.pickedY,width:1,height:1},cullRect:se,effects:C,pass:`picking:${d}:z`},!0);Qe[3]&&(ge=Qe[0])}be.pickedLayer&&Ne+1<c&&(Xe.add(be.pickedLayer),be.pickedLayer.disablePickingIndex(be.pickedObjectIndex)),xe=XF({pickInfo:be,lastPickedInfo:this.lastPickedInfo,mode:d,layers:k,viewports:r,x:i,y:o,z:ge,pixelRatio:B});for(let Qe of xe.values())Qe.layer&&Ee.push(Qe);if(!be.pickedColor)break}for(let Ne of Xe)Ne.restorePickingColors();return{result:Ee,emptyInfo:xe.get(null)}}async _pickVisibleObjectsAsync({layers:e,views:n,viewports:r,x:i,y:o,width:s=1,height:c=1,mode:d=\"query\",maxObjects:m=null,onViewportActive:b,effects:C}){let B=this._getPickable(e);if(!B||r.length===0)return[];this._resizeBuffer();let k=this.device.canvasContext.cssToDeviceRatio(),V=this.device.canvasContext.cssToDevicePixels([i,o],!0),q=V.x,K=V.y+V.height,Y=this.device.canvasContext.cssToDevicePixels([i+s,o+c],!0),ee=Y.x+Y.width,J=Y.y,se={x:q,y:J,width:ee-q,height:K-J},xe=this._drawAndSample({layers:B,views:n,viewports:r,onViewportActive:b,deviceRect:se,cullRect:{x:i,y:o,width:s,height:c},effects:C,pass:`picking:${d}`}),Ee=jF(xe),Xe=new Map,Ne=[],be=Number.isFinite(m);for(let ge=0;ge<Ee.length&&!(be&&Ne.length>=m);ge++){let Qe=Ee[ge],Ct={color:Qe.pickedColor,layer:null,index:Qe.pickedObjectIndex,picked:!0,x:i,y:o,pixelRatio:k};Ct=g4({layer:Qe.pickedLayer,info:Ct,mode:d});let Mt=Ct.layer.id;Xe.has(Mt)||Xe.set(Mt,new Set);let mt=Xe.get(Mt),jt=Ct.object??Ct.index;mt.has(jt)||(mt.add(jt),Ne.push(Ct))}return Ne}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:o,width:s=1,height:c=1,mode:d=\"query\",maxObjects:m=null,onViewportActive:b,effects:C}){let B=this._getPickable(e);if(!B||r.length===0)return[];this._resizeBuffer();let k=this.device.canvasContext.cssToDeviceRatio(),V=this.device.canvasContext.cssToDevicePixels([i,o],!0),q=V.x,K=V.y+V.height,Y=this.device.canvasContext.cssToDevicePixels([i+s,o+c],!0),ee=Y.x+Y.width,J=Y.y,se={x:q,y:J,width:ee-q,height:K-J},xe=this._drawAndSample({layers:B,views:n,viewports:r,onViewportActive:b,deviceRect:se,cullRect:{x:i,y:o,width:s,height:c},effects:C,pass:`picking:${d}`}),Ee=jF(xe),Xe=new Map,Ne=[],be=Number.isFinite(m);for(let ge=0;ge<Ee.length&&!(be&&Ne.length>=m);ge++){let Qe=Ee[ge],Ct={color:Qe.pickedColor,layer:null,index:Qe.pickedObjectIndex,picked:!0,x:i,y:o,pixelRatio:k};Ct=g4({layer:Qe.pickedLayer,info:Ct,mode:d});let Mt=Ct.layer.id;Xe.has(Mt)||Xe.set(Mt,new Set);let mt=Xe.get(Mt),jt=Ct.object??Ct.index;mt.has(jt)||(mt.add(jt),Ne.push(Ct))}return Ne}async _drawAndSampleAsync({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:o,cullRect:s,effects:c,pass:d},m=!1){let b=m?this.depthFBO:this.pickingFBO,C={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:b,deviceRect:o,cullRect:s,effects:c,pass:d,pickZ:m,preRenderStats:{},isPicking:!0};for(let ee of c)ee.useInPicking&&(C.preRenderStats[ee.id]=ee.preRender(C));let{decodePickingColor:B}=this.pickLayersPass.render(C),{x:k,y:V,width:q,height:K}=o,Y=new(m?Float32Array:Uint8Array)(q*K*4);return this.device.readPixelsToArrayWebGL(b,{sourceX:k,sourceY:V,sourceWidth:q,sourceHeight:K,target:Y}),{pickedColors:Y,decodePickingColor:B}}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:o,cullRect:s,effects:c,pass:d},m=!1){let b=m?this.depthFBO:this.pickingFBO,C={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:b,deviceRect:o,cullRect:s,effects:c,pass:d,pickZ:m,preRenderStats:{},isPicking:!0};for(let ee of c)ee.useInPicking&&(C.preRenderStats[ee.id]=ee.preRender(C));let{decodePickingColor:B}=this.pickLayersPass.render(C),{x:k,y:V,width:q,height:K}=o,Y=new(m?Float32Array:Uint8Array)(q*K*4);return this.device.readPixelsToArrayWebGL(b,{sourceX:k,sourceY:V,sourceWidth:q,sourceHeight:K,target:Y}),{pickedColors:Y,decodePickingColor:B}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:o}){let s=Math.max(0,e-r),c=Math.max(0,n-r),d=Math.min(i,e+r+1)-s,m=Math.min(o,n+r+1)-c;return d<=0||m<=0?null:{x:s,y:c,width:d,height:m}}};var qve={\"top-left\":{top:0,left:0},\"top-right\":{top:0,right:0},\"bottom-left\":{bottom:0,left:0},\"bottom-right\":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},Qve=\"top-left\",YK=\"root\",m4=class{constructor({deck:e,parentElement:n}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,n?.classList.add(\"deck-widget-container\"),this.parentElement=n}getWidgets(){return this.resolvedWidgets}setProps(e){if(e.widgets&&!Li(e.widgets,this.widgets,1)){let n=e.widgets.filter(Boolean);this._setWidgets(n)}}finalize(){for(let e of this.getWidgets())this._removeWidget(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(let e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(n=>n.id===e.id)||(this._addWidget(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}onRedraw({viewports:e,layers:n}){let r=e.reduce((i,o)=>(i[o.id]=o,i),{});for(let i of this.getWidgets()){let{viewId:o}=i;if(o){let s=r[o];s&&(i.onViewportChange&&i.onViewportChange(s),i.onRedraw?.({viewports:[s],layers:n}))}else{if(i.onViewportChange)for(let s of e)i.onViewportChange(s);i.onRedraw?.({viewports:e,layers:n})}}this.lastViewports=r,this._updateContainers()}onHover(e,n){for(let r of this.getWidgets()){let{viewId:i}=r;(!i||i===e.viewport?.id)&&r.onHover?.(e,n)}}onEvent(e,n){let r=tw[n.type];if(r)for(let i of this.getWidgets()){let{viewId:o}=i;(!o||o===e.viewport?.id)&&i[r]?.(e,n)}}_setWidgets(e){let n={};for(let r of this.resolvedWidgets)n[r.id]=r;this.resolvedWidgets.length=0;for(let r of this.defaultWidgets)n[r.id]=null,this.resolvedWidgets.push(r);for(let r of e){let i=n[r.id];i?i.viewId!==r.viewId||i.placement!==r.placement?(this._removeWidget(i),this._addWidget(r)):r!==i&&(i.setProps(r.props),r=i):this._addWidget(r),n[r.id]=null,this.resolvedWidgets.push(r)}for(let r in n){let i=n[r];i&&this._removeWidget(i)}this.widgets=e}_addWidget(e){let{viewId:n=null,placement:r=Qve}=e,i=e.props._container??n;e.widgetManager=this,e.deck=this.deck,e.rootElement=e._onAdd({deck:this.deck,viewId:n}),e.rootElement&&this._getContainer(i,r).append(e.rootElement),e.updateHTML()}_removeWidget(e){e.onRemove?.(),e.rootElement&&e.rootElement.remove(),e.rootElement=void 0,e.deck=void 0,e.widgetManager=void 0}_getContainer(e,n){if(e&&typeof e!=\"string\")return e;let r=e||YK,i=this.containers[r];i||(i=document.createElement(\"div\"),i.style.pointerEvents=\"none\",i.style.position=\"absolute\",i.style.overflow=\"hidden\",this.parentElement?.append(i),this.containers[r]=i);let o=i.querySelector(`.${n}`);return o||(o=globalThis.document.createElement(\"div\"),o.className=n,o.style.position=\"absolute\",o.style.zIndex=\"2\",Object.assign(o.style,qve[n]),i.append(o)),o}_updateContainers(){let e=this.deck.width,n=this.deck.height;for(let r in this.containers){let i=this.lastViewports[r]||null,o=r===YK||i,s=this.containers[r];o?(s.style.display=\"block\",s.style.left=`${i?i.x:0}px`,s.style.top=`${i?i.y:0}px`,s.style.width=`${i?i.width:e}px`,s.style.height=`${i?i.height:n}px`):s.style.display=\"none\"}}};function YF(t,e){e&&Object.entries(e).map(([n,r])=>{n.startsWith(\"--\")?t.style.setProperty(n,r):t.style[n]=r})}function ZK(t,e){e&&Object.keys(e).map(n=>{n.startsWith(\"--\")?t.style.removeProperty(n):t.style[n]=\"\"})}var Zy=class{constructor(e){this.viewId=null,this.props={...this.constructor.defaultProps,...e},this.id=this.props.id}setProps(e){let n=this.props,r=this.rootElement;r&&n.className!==e.className&&(n.className&&r.classList.remove(n.className),e.className&&r.classList.add(e.className)),r&&!Li(n.style,e.style,1)&&(ZK(r,n.style),YF(r,e.style)),Object.assign(this.props,e),this.updateHTML()}updateHTML(){this.rootElement&&this.onRenderHTML(this.rootElement)}onCreateRootElement(){let e=[\"deck-widget\",this.className,this.props.className],n=document.createElement(\"div\");return e.filter(r=>typeof r==\"string\"&&r.length>0).forEach(r=>n.classList.add(r)),YF(n,this.props.style),n}_onAdd(e){return this.onAdd(e)??this.onCreateRootElement()}onAdd(e){}onRemove(){}onViewportChange(e){}onRedraw(e){}onHover(e,n){}onClick(e,n){}onDrag(e,n){}onDragStart(e,n){}onDragEnd(e,n){}};Zy.defaultProps={id:\"widget\",style:{},_container:null,className:\"\"};var Kve={zIndex:\"1\",position:\"absolute\",pointerEvents:\"none\",color:\"#a0a7b4\",backgroundColor:\"#29323c\",padding:\"10px\",top:\"0\",left:\"0\",display:\"none\"},Tw=class extends Zy{constructor(e={}){super(e),this.id=\"default-tooltip\",this.placement=\"fill\",this.className=\"deck-tooltip\",this.isVisible=!1,this.setProps(e)}onCreateRootElement(){let e=document.createElement(\"div\");return e.className=this.className,Object.assign(e.style,Kve),e}onRenderHTML(e){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&!e.equals(this.lastViewport)&&this.setTooltip(null),this.lastViewport=e}onHover(e){let{deck:n}=this,r=n&&n.props.getTooltip;if(!r)return;let i=r(e);this.setTooltip(i,e.x,e.y)}setTooltip(e,n,r){let i=this.rootElement;if(i){if(typeof e==\"string\")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display=\"none\";return}this.isVisible=!0,i.style.display=\"block\",i.style.transform=`translate(${n}px, ${r}px)`,e&&typeof e==\"object\"&&\"style\"in e&&Object.assign(i.style,e.style)}}};Tw.defaultProps={...Zy.defaultProps};lr();G4();wm();function zA(){}var nwe=({isDragging:t})=>t?\"grabbing\":\"grab\",_$={id:\"\",width:\"100%\",height:\"100%\",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:\"none\",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:zA,onWebGLInitialized:zA,onResize:zA,onViewStateChange:zA,onInteractionStateChange:zA,onBeforeRender:zA,onAfterRender:zA,onLoad:zA,onError:t=>hn.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:nwe,getTooltip:null,debug:!1,drawPickingColors:!1},Bw=class{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new hl({id:\"deck.gl\"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw=\"Initial render\",this._pickRequest={mode:\"hover\",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=r=>{let{_pickRequest:i}=this;if(r.type===\"pointerleave\")i.x=-1,i.y=-1,i.radius=0;else{if(r.leftButton||r.rightButton)return;{let o=r.offsetCenter;if(!o)return;i.x=o.x,i.y=o.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=r},this._onEvent=r=>{let i=tw[r.type],o=r.offsetCenter;if(!i||!o||!this.layerManager)return;let s=this.layerManager.getLayers(),c=this.deckPicker.getLastPickedObject({x:o.x,y:o.y,layers:s,viewports:this.getViewports(o)},this._lastPointerDownInfo),{layer:d}=c,m=d&&(d[i]||d.props[i]),b=this.props[i],C=!1;m&&(C=m.call(d,c,r)),C||(b?.(c,r),this.widgetManager.onEvent(c,r))},this._onPointerDown=r=>{if(this.device?.type===\"webgpu\")return;let i=r.offsetCenter,o=this._pick(\"pickObject\",\"pickObject Time\",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=o.result[0]||o.emptyInfo},this.props={..._$,...e},e=this.props,e.viewState&&e.initialViewState&&hn.warn(\"View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.\")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let n=this.device;if(!n&&e.gl){e.gl instanceof WebGLRenderingContext&&hn.error(\"WebGL1 context not supported.\")();let r=this.props.deviceProps?.onResize;n=Rw.attach(e.gl,{...this.props.deviceProps,onResize:(i,o)=>{let{width:s,height:c}=i.canvas;i.drawingBufferWidth=s,i.drawingBufferHeight=c,this._needsRedraw=\"Canvas resized\",r?.(i,o)}})}n||(n=this._createDevice(e)),this.animationLoop=this._createAnimationLoop(n,e),this.setProps(e),e._typedArrayManagerProps&&$h.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get(\"setProps Time\").timeStart(),\"onLayerHover\"in e&&hn.removed(\"onLayerHover\",\"onHover\")(),\"onLayerClick\"in e&&hn.removed(\"onLayerClick\",\"onClick\")(),e.initialViewState&&!Li(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);let n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),e.device&&e.device.id!==this.device?.id&&(this.animationLoop?.stop(),this.canvas!==e.device.canvasContext?.canvas&&(this.canvas?.remove(),this.eventManager?.destroy(),this.canvas=null),hn.log(`recreating animation loop for new device! id=${e.device.id}`)(),this.animationLoop=this._createAnimationLoop(e.device,e),this.animationLoop.start()),this.animationLoop?.setProps(n),e.useDevicePixels!==void 0&&this.device?.canvasContext&&this.device.canvasContext.setProps({useDevicePixels:e.useDevicePixels}),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n),this.widgetManager.setProps(n)),this.stats.get(\"setProps Time\").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return\"Deck._animate\";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);let r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),o=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return n=n||r||i||o||s,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get(\"Redraw Count\").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return No(this.viewManager),this.viewManager.views}getViewports(e){return No(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){let n=this._pick(\"pickObject\",\"pickObject Time\",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick(\"pickObject\",\"pickMultipleObjects Time\",e).result}pickObjects(e){return this._pick(\"pickObjects\",\"pickObjects Time\",e)}_addResources(e,n=!1){for(let r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(let n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,n,r){No(this.deckPicker);let{stats:i}=this;i.get(\"Pick Count\").incrementCount(),i.get(n).timeStart();let o=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),o}_createCanvas(e){let n=e.canvas;return typeof n==\"string\"&&(n=document.getElementById(n),No(n)),n||(n=document.createElement(\"canvas\"),n.id=e.id||\"deckgl-overlay\",e.width&&typeof e.width==\"number\"&&(n.width=e.width),e.height&&typeof e.height==\"number\"&&(n.height=e.height),(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;let{width:n,height:r}=e;if(n||n===0){let i=Number.isFinite(n)?`${n}px`:n;this.canvas.style.width=i}if(r||r===0){let i=Number.isFinite(r)?`${r}px`:r;this.canvas.style.position=e.style?.position||\"absolute\",this.canvas.style.height=i}}_updateCanvasSize(){let{canvas:e}=this;if(!e)return;let n=e.clientWidth??e.width,r=e.clientHeight??e.height;(n!==this.width||r!==this.height)&&(this.width=n,this.height=r,this.viewManager?.setProps({width:n,height:r}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:n,height:r}))}_createAnimationLoop(e,n){let{gl:r,onError:i}=n;return new cw({device:e,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:i})}_createDevice(e){let n=this.props.deviceProps?.createCanvasContext,r=typeof n==\"object\"?n:void 0,i={adapters:[],_cacheShaders:!0,_cachePipelines:!0,...e.deviceProps};i.adapters.includes(Rw)||i.adapters.push(Rw);let o={alphaMode:this.props.deviceProps?.type===\"webgpu\"?\"premultiplied\":void 0},s=this.props.deviceProps?.onResize;return my.createDevice({_reuseDevices:!0,type:\"webgl\",...i,createCanvasContext:{...o,...r,canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!0},onResize:(c,d)=>{this._needsRedraw=\"Canvas resized\",s?.(c,d)}})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let{views:e}=this.props,n=Array.isArray(e)?e:e?[e]:[new XK({id:\"default-view\"})];return n.length&&this.props.controller&&(n[0].props.controller=this.props.controller),n}_onContextLost(){let{onError:e}=this.props;this.animationLoop&&e&&e(new Error(\"WebGL context is lost\"))}_pickAndCallback(){if(this.device?.type===\"webgpu\")return;let{_pickRequest:e}=this;if(e.event){let{result:n,emptyInfo:r}=this._pick(\"pickObject\",\"pickObject Time\",e);this.cursorState.isHovering=n.length>0;let i=r,o=!1;for(let s of n)i=s,o=s.layer?.onHover(s,e.event)||o;o||(this.props.onHover?.(i,e.event),this.widgetManager.onHover(i,e.event)),e.event=null}}_updateCursor(){let e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas,!this.canvas.isConnected&&this.props.parent&&this.props.parent.insertBefore(this.canvas,this.props.parent.firstChild)),this.device.type===\"webgl\"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type===\"webgl\"&&this.props.onWebGLInitialized(this.device.gl);let n=new Xm;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new ew(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(EF).map(i=>{let[o,s,c,d]=EF[i],m=this.props.eventRecognizerOptions?.[i],b={...s,...m,event:i};return{recognizer:new o(b),recognizeWith:c,requestFailure:d}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(let i in tw)this.eventManager.on(i,this._onEvent);this.viewManager=new dw({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});let r=this.viewManager.getViewports()[0];this.layerManager=new fw(this.device,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new xw({deck:this,device:this.device}),this.deckRenderer=new bw(this.device),this.deckPicker=new ww(this.device),this.widgetManager=new m4({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new Tw),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){let{device:r,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:r,gl:i});let o={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:\"screen\",effects:this.effectManager.getEffects(),...n};this.deckRenderer?.renderLayers(o),o.pass===\"screen\"&&this.widgetManager.onRedraw({viewports:o.viewports,layers:o.layers}),this.props.onAfterRender({device:r,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),hn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!==\"webgpu\"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){let n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){let{stats:e}=this;e.get(\"frameRate\").timeEnd(),e.get(\"frameRate\").timeStart();let n=this.animationLoop.stats;e.get(\"GPU Time\").addTime(n.get(\"GPU Time\").lastTiming),e.get(\"CPU Time\").addTime(n.get(\"CPU Time\").lastTiming)}_getMetrics(){let{metrics:e,stats:n}=this;e.fps=n.get(\"frameRate\").getHz(),e.setPropsTime=n.get(\"setProps Time\").time,e.updateAttributesTime=n.get(\"Update Attributes\").time,e.framesRedrawn=n.get(\"Redraw Count\").count,e.pickTime=n.get(\"pickObject Time\").time+n.get(\"pickMultipleObjects Time\").time+n.get(\"pickObjects Time\").time,e.pickCount=n.get(\"Pick Count\").count,e.gpuTime=n.get(\"GPU Time\").time,e.cpuTime=n.get(\"CPU Time\").time,e.gpuTimePerFrame=n.get(\"GPU Time\").getAverageTime(),e.cpuTimePerFrame=n.get(\"CPU Time\").getAverageTime();let r=my.stats.get(\"Memory Usage\");e.bufferMemory=r.get(\"Buffer Memory\").count,e.textureMemory=r.get(\"Texture Memory\").count,e.renderbufferMemory=r.get(\"Renderbuffer Memory\").count,e.gpuMemory=r.get(\"GPU Memory\").count}};Bw.defaultProps=_$;Bw.VERSION=pZ;var gk=Bw;lr();lr();function y$(t){switch(t){case\"float64\":return Float64Array;case\"uint8\":case\"unorm8\":return Uint8ClampedArray;default:return Im(t)}}var x$=Mm;function Dw(t,e,n){let r=n===\"webgpu\"&&e.type===\"uint8\"?\"unorm8\":e.type;return{attribute:t,format:e.size>1?`${r}x${e.size}`:e.type,byteOffset:e.offset||0}}function UA(t){return t.stride||t.size*t.bytesPerElement}function v$(t,e){return t.type===e.type&&t.size===e.size&&UA(t)===UA(e)&&(t.offset||0)===(e.offset||0)}function mk(t,e){e.offset&&hn.removed(\"shaderAttribute.offset\",\"vertexOffset, elementOffset\")();let n=UA(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,o=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:o,stride:n}}function rwe(t,e){let n=mk(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}var Lw=class{constructor(e,n,r){this._buffer=null,this.device=e,this.id=n.id||\"\",this.size=n.size||1;let i=n.logicalType||n.type,o=i===\"float64\",{defaultValue:s}=n;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0);let c;o?c=\"float32\":!i&&n.isIndexed?c=\"uint32\":c=i||\"float32\";let d=y$(i||c);this.doublePrecision=o,o&&n.fp64===!1&&(d=Float32Array),this.value=null,this.settings={...n,defaultType:d,defaultValue:s,logicalType:i,type:c,normalized:c.includes(\"norm\"),size:this.size,bytesPerElement:d.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){let e=this.getAccessor();return e.vertexOffset?e.vertexOffset*UA(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),$h.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,n=null){let r={};if(this.state.constant){let i=this.value;if(n){let o=mk(this.getAccessor(),n),s=o.offset/i.BYTES_PER_ELEMENT,c=o.size||this.size;r[e]=i.subarray(s,s+c)}else r[e]=i}else r[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?r[`${e}64Low`]=r[e]:r[`${e}64Low`]=new Float32Array(this.size)),r}_getBufferLayout(e=this.id,n=null){let r=this.getAccessor(),i=[],o={name:this.id,byteStride:UA(r),attributes:i};if(this.doublePrecision){let s=rwe(r,n||{});i.push(Dw(e,{...r,...s.high},this.device.type),Dw(`${e}64Low`,{...r,...s.low},this.device.type))}else if(n){let s=mk(r,n);i.push(Dw(e,{...r,...s},this.device.type))}else i.push(Dw(e,r,this.device.type));return o}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){let n=Array.from(this.value);e=[n,n]}else{let{value:n,numInstances:r,size:i}=this,o=r*i;if(n&&o&&n.length>=o){let s=new Array(i).fill(1/0),c=new Array(i).fill(-1/0);for(let d=0;d<o;)for(let m=0;m<i;m++){let b=n[d++];b<s[m]&&(s[m]=b),b>c[m]&&(c[m]=b)}e=[s,c]}}return this.state.bounds=e,e}setData(e){let{state:n}=this,r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ei?r={buffer:e}:r=e;let i={...this.settings,...r};if(ArrayBuffer.isView(r.value)){if(!r.type)if(this.doublePrecision&&r.value instanceof Float64Array)i.type=\"float32\";else{let s=x$(r.value);i.type=i.normalized?s.replace(\"int\",\"norm\"):s}i.bytesPerElement=r.value.BYTES_PER_ELEMENT,i.stride=UA(i)}if(n.bounds=null,r.constant){let o=r.value;if(o=this._normalizeValue(o,[],0),this.settings.normalized&&(o=this.normalizeConstant(o)),!(!n.constant||!this._areValuesEqual(o,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=ArrayBuffer.isView(o)?o:new Float32Array(o)}else if(r.buffer){let o=r.buffer;n.externalBuffer=o,n.constant=!1,this.value=r.value||null}else if(r.value){this._checkExternalBuffer(r);let o=r.value;n.externalBuffer=null,n.constant=!1,this.value=o;let{buffer:s}=this,c=UA(i),d=(i.vertexOffset||0)*c;if(this.doublePrecision&&o instanceof Float64Array&&(o=e4(o,i)),this.settings.isIndexed){let b=this.settings.defaultType;o.constructor!==b&&(o=new b(o))}let m=o.byteLength+d+c*2;(!s||s.byteLength<m)&&(s=this._createBuffer(m)),s.write(o,d)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;let n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&n instanceof Float64Array?e4(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),r*n.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,n=!1){let{state:r}=this,i=r.allocatedValue,o=$h.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=o;let{byteOffset:s}=this,{buffer:c}=this;return(!c||c.byteLength<o.byteLength+s)&&(c=this._createBuffer(o.byteLength+s),n&&i&&c.write(i instanceof Float64Array?e4(i,this):i,s)),r.allocatedValue=o,r.constant=!1,r.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){let{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error(`Attribute ${this.id} value is not TypedArray`);let r=this.settings.defaultType,i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${n.constructor.name}`);!(n instanceof r)&&this.settings.normalized&&!(\"normalized\"in e)&&hn.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case\"snorm8\":return new Float32Array(e).map(n=>(n+128)/255*2-1);case\"snorm16\":return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case\"unorm8\":return new Float32Array(e).map(n=>n/255);case\"unorm16\":return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){let{defaultValue:i,size:o}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let s=o;for(;--s>=0;)n[r+s]=i[s];return n}switch(o){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let s=o;for(;--s>=0;)n[r+s]=Number.isFinite(e[s])?e[s]:i[s]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;let{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();let{isIndexed:n,type:r}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(n?ei.INDEX:ei.VERTEX)|ei.COPY_DST,indexType:n?r:void 0,byteLength:e}),this._buffer}};var b$=[],w$=[];function ys(t,e=0,n=1/0){let r=b$,i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]==\"function\"?r=t:t.length>0&&(w$.length=t.length,r=w$):r=b$,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function X4(t){return t&&t[Symbol.asyncIterator]}function Y4(t,e){let{size:n,stride:r,offset:i,startIndices:o,nested:s}=e,c=t.BYTES_PER_ELEMENT,d=r?r/c:n,m=i?i/c:0,b=Math.floor((t.length-m)/d);return(C,{index:B,target:k})=>{if(!o){let Y=B*d+m;for(let ee=0;ee<n;ee++)k[ee]=t[Y+ee];return k}let V=o[B],q=o[B+1]||b,K;if(s){K=new Array(q-V);for(let Y=V;Y<q;Y++){let ee=Y*d+m;k=new Array(n);for(let J=0;J<n;J++)k[J]=t[ee+J];K[Y-V]=k}}else if(d===n)K=t.subarray(V*n+m,q*n+m);else{K=new t.constructor((q-V)*n);let Y=0;for(let ee=V;ee<q;ee++){let J=ee*d+m;for(let se=0;se<n;se++)K[Y++]=t[J+se]}}return K}}var T$=[],Ow=[[0,1/0]];function E$(t,e){if(t===Ow||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;let n=[],r=t.length,i=0;for(let o=0;o<r;o++){let s=t[o];s[1]<e[0]?(n.push(s),i=o+1):s[0]>e[1]?n.push(s):e=[Math.min(s[0],e[0]),Math.max(s[1],e[1])]}return n.splice(i,0,e),n}var owe={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Z4(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:\"interpolation\",duration:t});let n=t.type||\"interpolation\";return{...owe[n],...e,...t,type:n}}var e_=class extends Lw{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Ow}),this.constant=!1,this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){let n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var n;(n=this.state).layoutChanged||(n.layoutChanged=!v$(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){let{accessor:e}=this.settings;return[this.id].concat(typeof e!=\"function\"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;let{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(o=>e[o])]:e[n];return Z4(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){let{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=E$(this.state.updateRanges,[r,i])}else this.state.updateRanges=Ow}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=T$}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){let{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Ow),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;let{state:{updateRanges:o},settings:{update:s,noAlloc:c}}=this,d=!0;if(s){for(let[m,b]of o)s.call(i,this,{data:n,startRow:m,endRow:b,props:r,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(let[m,b]of o){let C=Number.isFinite(m)?this.getVertexOffset(m):0,B=Number.isFinite(b)?this.getVertexOffset(b):c||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:C,endOffset:B})}this._checkAttributeArray()}else d=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),d}setConstantValue(e,n){let r=this.device.type===\"webgpu\";if(r||n===void 0||typeof n==\"function\"){if(r&&typeof n!=\"function\"){let s=this._normalizeValue(n,[],0);this._areValuesEqual(s,this.value)||this.setNeedsUpdate(\"WebGPU constant updated\")}return!1}let i=this.settings.transform&&e?this.settings.transform.call(e,n):n;return this.setData({constant:!0,value:i})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){let{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){let{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});let s=e;No(ArrayBuffer.isView(s.value),`invalid ${i.accessor}`);let c=!!s.size&&s.size!==this.size;return r.binaryAccessor=Y4(s.value,{size:s.size||this.size,stride:s.stride,offset:s.offset,startIndices:n,nested:c}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){let{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getValue(){let e=this.settings.shaderAttributes,n=super.getValue();if(!e)return n;for(let r in e)Object.assign(n,super.getValue(r,e[r]));return n}getBufferLayout(e){this.state.layoutChanged=!1;let n=this.settings.shaderAttributes,r=super._getBufferLayout(),{stepMode:i}=this.settings;if(i===\"dynamic\"?r.stepMode=e?e.isInstanced?\"instance\":\"vertex\":\"instance\":r.stepMode=i??\"vertex\",!n)return r;for(let o in n){let s=super._getBufferLayout(o,n[o]);r.attributes.push(...s.attributes)}return r}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:o,numInstances:s}){if(e.constant&&this.context.device.type!==\"webgpu\")return;let{settings:c,state:d,value:m,size:b,startIndices:C}=e,{accessor:B,transform:k}=c,V=d.binaryAccessor||(typeof B==\"function\"?B:o[B]);typeof V!=\"function\"&&typeof B==\"string\"&&(V=()=>o[B]),No(typeof V==\"function\",`accessor \"${B}\" is not a function`);let q=e.getVertexOffset(r),{iterable:K,objectInfo:Y}=ys(n,r,i);for(let ee of K){Y.index++;let J=V(ee,Y);if(k&&(J=k.call(this,J)),C){let se=(Y.index<C.length-1?C[Y.index+1]:s)-C[Y.index];if(J&&Array.isArray(J[0])){let xe=q;for(let Ee of J)e._normalizeValue(Ee,m,xe),xe+=b}else J&&J.length>b?m.set(J,q):(e._normalizeValue(J,Y.target,0),UF({target:m,source:Y.target,start:q,count:se}));q+=se*b}else e._normalizeValue(J,m,q),q+=b}}_validateAttributeUpdaters(){let{settings:e}=this;if(!(e.noAlloc||typeof e.update==\"function\"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){let{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error(`Illegal attribute generated for ${this.id}`)}}};function _k(t){let{source:e,target:n,start:r=0,size:i,getData:o}=t,s=t.end||n.length,c=e.length,d=s-r;if(c>d){n.set(e.subarray(0,d),r);return}if(n.set(e,r),!o)return;let m=c;for(;m<d;){let b=o(m,e);for(let C=0;C<i;C++)n[r+m]=b[C]||0,m++}}function S$({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:o}){if(!i||!o)return _k({source:t,target:e,size:n,getData:r}),e;let s=0,c=0,d=r&&((b,C)=>r(b+c,C)),m=Math.min(i.length,o.length);for(let b=1;b<m;b++){let C=i[b]*n,B=o[b]*n;_k({source:t.subarray(s,C),target:e,start:c,end:B,size:n,getData:d}),s=C,c=B}return c<e.length&&_k({source:[],target:e,start:c,size:n,getData:d}),e}function C$(t){let{device:e,settings:n,value:r}=t,i=new e_(e,n);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}function q4(t){switch(t){case 1:return\"float\";case 2:return\"vec2\";case 3:return\"vec3\";case 4:return\"vec4\";default:throw new Error(`No defined attribute type for size \"${t}\"`)}}function Q4(t){switch(t){case 1:return\"float32\";case 2:return\"float32x2\";case 3:return\"float32x3\";case 4:return\"float32x4\";default:throw new Error(\"invalid type size\")}}function K4(t){t.push(t.shift())}function M$(t,e){let{doublePrecision:n,settings:r,value:i,size:o}=t,s=n&&i instanceof Float64Array?2:1,c=0,{shaderAttributes:d}=t.settings;if(d)for(let m of Object.values(d))c=Math.max(c,m.vertexOffset??0);return(r.noAlloc?i.length:(e+c)*o)*s}function J4({device:t,source:e,target:n}){return(!n||n.byteLength<e.byteLength)&&(n?.destroy(),n=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),n}function $4({device:t,buffer:e,attribute:n,fromLength:r,toLength:i,fromStartIndices:o,getData:s=c=>c}){let c=n.doublePrecision&&n.value instanceof Float64Array?2:1,d=n.size*c,m=n.byteOffset,b=n.settings.bytesPerElement<4?m/n.settings.bytesPerElement*4:m,C=n.startIndices,B=o&&C,k=n.isConstant;if(!B&&e&&r>=i)return e;let V=n.value instanceof Float64Array?Float32Array:n.value.constructor,q=k?n.value:new V(n.getBuffer().readSyncWebGL(m,i*V.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!k){let J=s;s=(se,xe)=>n.normalizeConstant(J(se,xe))}let K=k?(J,se)=>s(q,se):(J,se)=>s(q.subarray(J+m,J+m+d),se),Y=e?new Float32Array(e.readSyncWebGL(b,r*4).buffer):new Float32Array(0),ee=new Float32Array(i);return S$({source:Y,target:ee,sourceStartIndices:o,targetStartIndices:C,size:d,getData:K}),(!e||e.byteLength<ee.byteLength+b)&&(e?.destroy(),e=t.createBuffer({byteLength:ee.byteLength+b,usage:35050})),e.write(ee,b),e}var $y=class{constructor({device:e,attribute:n,timeline:r}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new tf(r),this.attribute=n,this.attributeInTransition=C$(n),this.currentStartIndices=n.startIndices}get inProgress(){return this.transition.inProgress}start(e,n,r=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=M$(this.attribute,n),this.transition.start({...e,duration:r})}update(){let e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(let e of this.buffers)e.destroy();this.buffers.length=0}};var Fw=class extends $y{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type=\"interpolation\",this.transform=cwe(e,n)}start(e,n){let r=this.currentLength,i=this.currentStartIndices;if(super.start(e,n,e.duration),e.duration<=0){this.transition.cancel();return}let{buffers:o,attribute:s}=this;K4(o),o[0]=$4({device:this.device,buffer:o[0],attribute:s,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),o[1]=J4({device:this.device,source:o[0],target:o[1]}),this.setBuffer(o[1]);let{transform:c}=this,d=c.model,m=Math.floor(this.currentLength/s.size);P$(s)&&(m/=2),d.setVertexCount(m),s.isConstant?(d.setAttributes({aFrom:o[0]}),d.setConstantAttributes({aTo:s.value})):d.setAttributes({aFrom:o[0],aTo:s.getBuffer()}),c.transformFeedback.setBuffers({vCurrent:o[1]})}onUpdate(){let{duration:e,easing:n}=this.settings,{time:r}=this.transition,i=r/e;n&&(i=n(i));let{model:o}=this.transform,s={time:i};o.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},swe=`uniform interpolationUniforms {\n  float time;\n} interpolation;\n`,I$={name:\"interpolation\",vs:swe,uniformTypes:{time:\"f32\"}},awe=`#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, interpolation.time);\n  gl_Position = vec4(0.0);\n}\n`,lwe=`#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aFrom64Low;\nin ATTRIBUTE_TYPE aTo;\nin ATTRIBUTE_TYPE aTo64Low;\nout ATTRIBUTE_TYPE vCurrent;\nout ATTRIBUTE_TYPE vCurrent64Low;\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid main(void) {\n  for (int i=0; i<ATTRIBUTE_SIZE; i++) {\n    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);\n    vCurrent[i] = value.x;\n    vCurrent64Low[i] = value.y;\n  }\n  gl_Position = vec4(0.0);\n}\n`;function P$(t){return t.doublePrecision&&t.value instanceof Float64Array}function cwe(t,e){let n=e.size,r=q4(n),i=Q4(n),o=e.getBufferLayout();return P$(e)?new td(t,{vs:lwe,bufferLayout:[{name:\"aFrom\",byteStride:8*n,attributes:[{attribute:\"aFrom\",format:i,byteOffset:0},{attribute:\"aFrom64Low\",format:i,byteOffset:4*n}]},{name:\"aTo\",byteStride:8*n,attributes:[{attribute:\"aTo\",format:i,byteOffset:0},{attribute:\"aTo64Low\",format:i,byteOffset:4*n}]}],modules:[dF,I$],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:[\"vCurrent\",\"vCurrent64Low\"],bufferMode:35980,disableWarnings:!0}):new td(t,{vs:awe,bufferLayout:[{name:\"aFrom\",format:i},{name:\"aTo\",format:o.attributes[0].format}],modules:[I$],defines:{ATTRIBUTE_TYPE:r},varyings:[\"vCurrent\"],disableWarnings:!0})}var kw=class extends $y{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type=\"spring\",this.texture=Awe(e),this.framebuffer=gwe(e,this.texture),this.transform=pwe(e,n)}start(e,n){let r=this.currentLength,i=this.currentStartIndices;super.start(e,n);let{buffers:o,attribute:s}=this;for(let d=0;d<2;d++)o[d]=$4({device:this.device,buffer:o[d],attribute:s,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});o[2]=J4({device:this.device,source:o[0],target:o[2]}),this.setBuffer(o[1]);let{model:c}=this.transform;c.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?c.setConstantAttributes({aTo:s.value}):c.setAttributes({aTo:s.getBuffer()})}onUpdate(){let{buffers:e,transform:n,framebuffer:r,transition:i}=this,o=this.settings;n.model.setAttributes({aPrev:e[0],aCur:e[1]}),n.transformFeedback.setBuffers({vNext:e[2]});let s={stiffness:o.stiffness,damping:o.damping};n.model.shaderInputs.setProps({spring:s}),n.run({framebuffer:r,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),K4(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(r)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}},uwe=`uniform springUniforms {\n  float damping;\n  float stiffness;\n} spring;\n`,hwe={name:\"spring\",vs:uwe,uniformTypes:{damping:\"f32\",stiffness:\"f32\"}},fwe=`#version 300 es\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nin ATTRIBUTE_TYPE aPrev;\nin ATTRIBUTE_TYPE aCur;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vNext;\nout float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE force = delta * spring.stiffness;\n  ATTRIBUTE_TYPE resistance = velocity * spring.damping;\n  return force - resistance + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n`,dwe=`#version 300 es\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nin float vIsTransitioningFlag;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  fragColor = vec4(1.0);\n}`;function pwe(t,e){let n=q4(e.size),r=Q4(e.size);return new td(t,{vs:fwe,fs:dwe,bufferLayout:[{name:\"aPrev\",format:r},{name:\"aCur\",format:r},{name:\"aTo\",format:e.getBufferLayout().attributes[0].format}],varyings:[\"vNext\"],modules:[hwe],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:\"always\",blendColorOperation:\"max\",blendColorSrcFactor:\"one\",blendColorDstFactor:\"one\",blendAlphaOperation:\"max\",blendAlphaSrcFactor:\"one\",blendAlphaDstFactor:\"one\"}})}function Awe(t){return t.createTexture({data:new Uint8Array(4),format:\"rgba8unorm\",width:1,height:1})}function gwe(t,e){return t.createFramebuffer({id:\"spring-transition-is-transitioning-framebuffer\",width:1,height:1,colorAttachments:[e]})}var mwe={interpolation:Fw,spring:kw},Nw=class{constructor(e,{id:n,timeline:r}){if(!e)throw new Error(\"AttributeTransitionManager is constructed without device\");this.id=n,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(let e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(let i in e){let o=e[i],s=o.getTransitionSetting(n);s&&this._updateAttribute(i,o,s)}for(let i in this.transitions){let o=e[i];(!o||!o.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){let n=this.transitions[e];return n&&n.inProgress}getAttributes(){let e={};for(let n in this.transitions){let r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(let n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);let e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,n,r){let i=this.transitions[e],o=!i||i.type!==r.type;if(o){i&&this._removeTransition(e);let s=mwe[r.type];s?this.transitions[e]=new s({attribute:n,timeline:this.timeline,device:this.device}):(hn.error(`unsupported transition type '${r.type}'`)(),o=!1)}(o||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}};var R$=\"attributeManager.invalidate\",_we=\"attributeManager.updateStart\",ywe=\"attributeManager.updateEnd\",xwe=\"attribute.updateStart\",vwe=\"attribute.allocate\",bwe=\"attribute.updateEnd\",Ju=class{constructor(e,{id:n=\"attribute-manager\",stats:r,timeline:i}={}){this.mergeBoundsMemoized=ed(CK),this.id=n,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new Nw(e,{id:`${n}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(let e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){let n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:\"instance\"})}remove(e){for(let n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){let r=this._invalidateTrigger(e,n);ss(R$,this,e,r)}invalidateAll(e){for(let n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);ss(R$,this,\"all\")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:o={},buffers:s={},context:c={}}){let d=!1;ss(_we,this),this.stats&&this.stats.get(\"Update Attributes\").timeStart();for(let m in this.attributes){let b=this.attributes[m],C=b.settings.accessor;b.startIndices=r,b.numInstances=n,o[m]&&hn.removed(`props.${m}`,`data.attributes.${m}`)(),b.setExternalBuffer(s[m])||b.setBinaryValue(typeof C==\"string\"?s[C]:void 0,e.startIndices)||typeof C==\"string\"&&!s[C]&&b.setConstantValue(c,o[C])||b.needsUpdate()&&(d=!0,this._updateAttribute({attribute:b,numInstances:n,data:e,props:o,context:c})),this.needsRedraw=this.needsRedraw||b.needsRedraw()}d&&ss(ywe,this,n),this.stats&&this.stats.get(\"Update Attributes\").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){let{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){let n=e.map(r=>this.attributes[r]?.getBounds());return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){let{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(let o in n){let s=n[o];s.needsRedraw(e)&&!r.hasAttribute(o)&&(i[o]=s)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(n=>n.getBufferLayout(e))}_add(e,n){for(let r in e){let i=e[r],o={...i,id:r,size:i.isIndexed&&1||i.size||1,...n};this.attributes[r]=new e_(this.device,o)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){let e={};for(let n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){let{attributes:r,updateTriggers:i}=this,o=i[e];return o&&o.forEach(s=>{let c=r[s];c&&c.setNeedsUpdate(c.id,n)}),o}_updateAttribute(e){let{attribute:n,numInstances:r}=e;if(ss(xwe,n),n.constant){n.setConstantValue(e.context,n.value);return}n.allocate(r)&&ss(vwe,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,ss(bwe,n,r))}};lr();G4();var zw=class extends tf{get value(){return this._value}_onUpdate(){let{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:o}}=this,s=o(e/i);this._value=Xa(n,r,s)}};var B$=1e-5;function D$(t,e,n,r,i){let o=e-t,c=(n-e)*i,d=-o*r;return c+d+o+e}function wwe(t,e,n,r,i){if(Array.isArray(n)){let o=[];for(let s=0;s<n.length;s++)o[s]=D$(t[s],e[s],n[s],r,i);return o}return D$(t,e,n,r,i)}function L$(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){let i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}var Uw=class extends tf{get value(){return this._currValue}_onUpdate(){let{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:o=e,_currValue:s=e}=this,c=wwe(o,s,n,r,i),d=L$(c,n),m=L$(c,s);d<B$&&m<B$&&(c=n,this.end()),this._prevValue=s,this._currValue=c}};var Twe={interpolation:zw,spring:Uw},Vw=class{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){let{transitions:o}=this;if(o.has(e)){let d=o.get(e),{value:m=d.settings.fromValue}=d;n=m,this.remove(e)}if(i=Z4(i),!i)return;let s=Twe[i.type];if(!s){hn.error(`unsupported transition type '${i.type}'`)();return}let c=new s(this.timeline);c.start({...i,fromValue:n,toValue:r}),o.set(e,c)}remove(e){let{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){let e={};for(let[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(let e of this.transitions.keys())this.remove(e)}};function F$(t){let e=t[Ku];for(let n in e){let r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error(`Invalid prop ${n}: ${t[n]}`)}}function k$(t,e){let n=Gw({newProps:t,oldProps:e,propTypes:t[Ku],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=Swe(t,e),i=!1;return r||(i=Cwe(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Mwe(t,e),transitionsChanged:Ewe(t,e)}}function Ewe(t,e){if(!t.transitions)return!1;let n={},r=t[Ku],i=!1;for(let o in t.transitions){let s=r[o],c=s&&s.type;(c===\"number\"||c===\"color\"||c===\"array\")&&yk(t[o],e[o],s)&&(n[o]=!0,i=!0)}return i?n:!1}function Gw({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i=\"props\"}){if(e===t)return!1;if(typeof t!=\"object\"||t===null)return`${i} changed shallowly`;if(typeof e!=\"object\"||e===null)return`${i} changed shallowly`;for(let o of Object.keys(t))if(!(o in n)){if(!(o in e))return`${i}.${o} added`;let s=yk(t[o],e[o],r[o]);if(s)return`${i}.${o} ${s}`}for(let o of Object.keys(e))if(!(o in n)){if(!(o in t))return`${i}.${o} dropped`;if(!Object.hasOwnProperty.call(t,o)){let s=yk(t[o],e[o],r[o]);if(s)return`${i}.${o} ${s}`}}return!1}function yk(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?\"changed deeply\":!r&&e!==t?\"changed shallowly\":null}function Swe(t,e){if(e===null)return\"oldProps is null, initial diff\";let n=!1,{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n=\"Data comparator detected a change\"):t.data!==e.data&&(n=\"A new data container was supplied\"),n&&i&&(n=i(t.data,e.data)||n),n}function Cwe(t,e){if(e===null)return{all:!0};if(\"all\"in t.updateTriggers&&O$(t,e,\"all\"))return{all:!0};let n={},r=!1;for(let i in t.updateTriggers)i!==\"all\"&&O$(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function Mwe(t,e){if(e===null)return!0;let n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function O$(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},Gw({oldProps:i,newProps:r,triggerName:n})}var Iwe=\"count(): argument not an object\",Pwe=\"count(): argument not a container\";function N$(t){if(!Bwe(t))throw new Error(Iwe);if(typeof t.count==\"function\")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(Rwe(t))return Object.keys(t).length;throw new Error(Pwe)}function Rwe(t){return t!==null&&typeof t==\"object\"&&t.constructor===Object}function Bwe(t){return t!==null&&typeof t==\"object\"}function xk(t,e){if(!e)return t;let n={...t,...e};if(\"defines\"in e&&(n.defines={...t.defines,...e.defines}),\"modules\"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name===\"project64\"))){let r=n.modules.findIndex(i=>i.name===\"project32\");r>=0&&n.modules.splice(r,1)}if(\"inject\"in e)if(!t.inject)n.inject=e.inject;else{let r={...t.inject};for(let i in e.inject)r[i]=(r[i]||\"\")+e.inject[i];n.inject=r}return n}lr();var Dwe={minFilter:\"linear\",mipmapFilter:\"linear\",magFilter:\"linear\",addressModeU:\"clamp-to-edge\",addressModeV:\"clamp-to-edge\"},vk={};function z$(t,e,n,r){if(n instanceof jo)return n;n.constructor&&n.constructor.name!==\"Object\"&&(n={data:n});let i=null;n.compressed&&(i={minFilter:\"linear\",mipmapFilter:n.data.length>1?\"nearest\":\"linear\"});let{width:o,height:s}=n.data,c=e.createTexture({...n,sampler:{...Dwe,...i,...r},mipLevels:e.getMipLevelCount(o,s)});return c.generateMipmapsWebGL(),vk[c.id]=t,c}function U$(t,e){!e||!(e instanceof jo)||vk[e.id]===t&&(e.delete(),delete vk[e.id])}var Lwe={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!(\"max\"in e)||t<=e.max)&&(!(\"min\"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||bk(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Li(t,e,1)}},accessor:{validate(t,e){let n=eI(t);return n===\"function\"||n===eI(e.value)},equal(t,e,n){return typeof e==\"function\"?!0:Li(t,e,1)}},array:{validate(t,e){return e.optional&&!t||bk(t)},equal(t,e,n){let{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Li(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;let{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Li(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t==\"function\"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{if(!t)return t;let{dataTransform:r}=n.props;return r?r(t):typeof t.shape==\"string\"&&t.shape.endsWith(\"-table\")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,n)=>{let r=n.context;return!r||!r.device?null:z$(n.id,r.device,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{U$(n.id,t)}}};function V$(t){let e={},n={},r={};for(let[i,o]of Object.entries(t)){let s=o?.deprecatedFor;if(s)r[i]=Array.isArray(s)?s:[s];else{let c=Owe(i,o);e[i]=c,n[i]=c.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function Owe(t,e){switch(eI(e)){case\"object\":return Hw(t,e);case\"array\":return Hw(t,{type:\"array\",value:e,compare:!1});case\"boolean\":return Hw(t,{type:\"boolean\",value:e});case\"number\":return Hw(t,{type:\"number\",value:e});case\"function\":return Hw(t,{type:\"function\",value:e,compare:!0});default:return{name:t,type:\"unknown\",value:e}}}function Hw(t,e){return\"type\"in e?{name:t,...Lwe[e.type],...e}:\"value\"in e?{name:t,type:eI(e.value),...e}:{name:t,type:\"object\",value:e}}function bk(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function eI(t){return bk(t)?\"array\":t===null?\"null\":typeof t}function G$(t,e){let n;for(let o=e.length-1;o>=0;o--){let s=e[o];\"extensions\"in s&&(n=s.extensions)}let r=wk(t.constructor,n),i=Object.create(r);i[jy]=t,i[rd]={},i[ef]={};for(let o=0;o<e.length;++o){let s=e[o];for(let c in s)i[c]=s[c]}return Object.freeze(i),i}var Fwe=\"_mergedDefaultProps\";function wk(t,e){if(!(t instanceof tI.constructor))return{};let n=Fwe;if(e)for(let i of e){let o=i.constructor;o&&(n+=`:${o.extensionName||o.name}`)}let r=H$(t,n);return r||(t[n]=kwe(t,e||[]))}function kwe(t,e){if(!t.prototype)return null;let r=Object.getPrototypeOf(t),i=wk(r),o=H$(t,\"defaultProps\")||{},s=V$(o),c=Object.assign(Object.create(null),i,s.defaultProps),d=Object.assign(Object.create(null),i?.[Ku],s.propTypes),m=Object.assign(Object.create(null),i?.[l4],s.deprecatedProps);for(let b of e){let C=wk(b.constructor);C&&(Object.assign(c,C),Object.assign(d,C[Ku]),Object.assign(m,C[l4]))}return Nwe(c,t),Uwe(c,d),zwe(c,m),c[Ku]=d,c[l4]=m,e.length===0&&!Tk(t,\"_propTypes\")&&(t._propTypes=d),c}function Nwe(t,e){let n=Gwe(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function zwe(t,e){for(let n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){let i=`${this.id}: ${n}`;for(let o of e[n])Tk(this,o)||(this[o]=r);hn.deprecated(i,e[n].join(\"/\"))()}})}function Uwe(t,e){let n={},r={};for(let i in e){let o=e[i],{name:s,value:c}=o;o.async&&(n[s]=c,r[s]=Vwe(s))}t[Fp]=n,t[rd]={},Object.defineProperties(t,r)}function Vwe(t){return{enumerable:!0,set(e){typeof e==\"string\"||e instanceof Promise||X4(e)?this[rd][t]=e:this[ef][t]=e},get(){if(this[ef]){if(t in this[ef])return this[ef][t]||this[Fp][t];if(t in this[rd]){let e=this[jy]&&this[jy].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Fp][t]}}return this[Fp][t]}}}function Tk(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function H$(t,e){return Tk(t,e)&&t[e]}function Gwe(t){let e=t.componentName;return e||hn.warn(`${t.name}.componentName not specified`)(),e||t.name}var Hwe=0,Ww=class{constructor(...e){this.props=G$(this,e),this.id=this.props.id,this.count=Hwe++}clone(e){let{props:n}=this,r={};for(let i in n[Fp])i in n[ef]?r[i]=n[ef][i]:i in n[rd]&&(r[i]=n[rd][i]);return new this.constructor({...n,...r,...e})}};Ww.componentName=\"Component\";Ww.defaultProps={};var tI=Ww;var Wwe=Object.freeze({}),jw=class{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(let e in this.asyncProps){let n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Wwe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){let n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){let n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(let n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[jy]||this.component;let n=e[ef]||{},r=e[rd]||e,i=e[Fp]||{};for(let o in n){let s=n[o];this._createAsyncPropData(o,i[o]),this._updateAsyncProp(o,s),n[o]=this.getAsyncProp(o)}for(let o in r){let s=r[o];this._createAsyncPropData(o,i[o]),this._updateAsyncProp(o,s)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n==\"string\"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(X4(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(let e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){let r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();let r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){let i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){let r=this.asyncProps[e];if(r){r.pendingLoadCount++;let i=r.pendingLoadCount;n.then(o=>{this.component&&(o=this._postProcessValue(r,o),this._setAsyncPropValue(e,o,i),this._onResolve(e,o))}).catch(o=>{this._onError(e,o)})}}async _resolveAsyncIterable(e,n){if(e!==\"data\"){this._setPropValue(e,n);return}let r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;let i=r.pendingLoadCount,o=[],s=0;for await(let c of n){if(!this.component)return;let{dataTransform:d}=this.component.props;d?o=d(c,o):o=o.concat(c),Object.defineProperty(o,\"__diff\",{enumerable:!1,value:[{startRow:s,endRow:o.length}]}),s=o.length,this._setAsyncPropValue(e,o,i)}this._onResolve(e,o)}_postProcessValue(e,n){let r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){let i=this.component&&this.component.props[Ku];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}};var Xw=class extends jw{constructor({attributeManager:e,layer:n}){super(n),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){let r=this.layer,i=r?.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){let r=this.layer;if(r){let i=r.props.onDataLoad;e===\"data\"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){let r=this.layer;r&&r.raiseError(n,`loading ${e} of ${this.layer}`)}};var jwe=\"layer.changeFlag\",Xwe=\"layer.initialize\",Ywe=\"layer.update\",Zwe=\"layer.finalize\",qwe=\"layer.matched\",W$=2**24-1,Qwe=Object.freeze([]),Kwe=ed(({oldViewport:t,viewport:e})=>t.equals(e)),sf=new Uint8ClampedArray(0),Jwe={data:{type:\"data\",value:Qwe,async:!0},dataComparator:{type:\"function\",value:null,optional:!0},_dataDiff:{type:\"function\",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:\"function\",value:null,optional:!0},onDataLoad:{type:\"function\",value:null,optional:!0},onError:{type:\"function\",value:null,optional:!0},fetch:{type:\"function\",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:o})=>{let{resourceManager:s}=n.context;i=i||n.getLoadOptions(),r=r||n.props.loaders,o&&(i={...i,fetch:{...i?.fetch,signal:o}});let c=s.contains(t);return!c&&!i&&(s.add({resourceId:t,data:va(t,r),persistent:!1}),c=!0),c?s.subscribe({resourceId:t,onChange:d=>n.internalState?.reloadAsyncProp(e,d),consumerId:n.id,requestId:e}):va(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:\"number\",min:0,max:1,value:1},operation:\"draw\",onHover:{type:\"function\",value:null,optional:!0},onClick:{type:\"function\",value:null,optional:!0},onDragStart:{type:\"function\",value:null,optional:!0},onDrag:{type:\"function\",value:null,optional:!0},onDragEnd:{type:\"function\",value:null,optional:!0},coordinateSystem:Cn.DEFAULT,coordinateOrigin:{type:\"array\",value:[0,0,0],compare:!0},modelMatrix:{type:\"array\",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:\"XYZ\",colorFormat:\"RGBA\",parameters:{type:\"object\",value:{},optional:!0,compare:2},loadOptions:{type:\"object\",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:\"array\",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:\"function\",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:\"accessor\",value:[0,0,128,128]}},Yw=class extends tI{constructor(){super(...arguments),this.internalState=null,this.lifecycle=FA.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,\"layerName\")?this.layerName:\"\"}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){No(this.internalState);let n=this.internalState.viewport||this.context.viewport,r=FF(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,o,s]=Ny(r,n.pixelProjectionMatrix);return e.length===2?[i,o]:[i,o,s]}unproject(e){return No(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){No(this.internalState);let r=this.internalState.viewport||this.context.viewport;return PK(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){let e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(let n of this.getModels())n.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){let{coordinateSystem:e}=this.props;return e===Cn.DEFAULT||e===Cn.LNGLAT||e===Cn.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){No(e instanceof Uint8Array);let[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:N$(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds([\"positions\",\"instancePositions\"])}getShaders(e){e=xk(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(let n of this.props.extensions)e=xk(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){let n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(let i of r)n.invalidateAll(i);else n.invalidateAll();if(n){let{props:i}=e,o=this.internalState.hasPickingBuffer,s=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(c=>c.getNeedsPickingBuffer.call(this,c));if(o!==s){this.internalState.hasPickingBuffer=s;let{pickingColors:c,instancePickingColors:d}=n.attributes,m=c||d;m&&(s&&m.constant&&(m.constant=!1,n.invalidate(m.id)),!m.value&&!s&&(m.constant=!0,m.value=[0,0,0]))}}}finalizeState(e){for(let r of this.getModels())r.destroy();let n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(let n of this.getModels())n.draw(e.renderPass)}getPickingInfo({info:e,mode:n,sourceLayer:r}){let{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){n&&(e=new Error(`${n}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;let n=this.internalState.viewport;this.internalState.viewport=e,(!n||!Kwe({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e=\"all\"){let n=this.getAttributeManager();n&&(e===\"all\"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){let n=!1;for(let r in e)e[r].layoutChanged()&&(n=!0);for(let r of this.getModels())this._setModelAttributes(r,e,n)}_updateAttributes(){let e=this.getAttributeManager();if(!e)return;let n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});let o=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){let e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){let{uniformTransitions:e}=this.internalState;if(e.active){let n=e.update(),r=Object.create(this.props);for(let i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;let r=Math.floor(sf.length/4);if(this.internalState.usesPickingColorCache=!0,r<n){n>W$&&hn.warn(\"Layer has too many data objects. Picking might not be able to distinguish all objects.\")(),sf=$h.allocate(sf,n,{size:4,copy:!0,maxCount:Math.max(n,W$)});let i=Math.floor(sf.length/4),o=[0,0,0];for(let s=r;s<i;s++)this.encodePickingColor(s,o),sf[s*4+0]=o[0],sf[s*4+1]=o[1],sf[s*4+2]=o[2],sf[s*4+3]=0}e.value=sf.subarray(0,n*4)}_setModelAttributes(e,n,r=!1){if(!Object.keys(n).length)return;if(r){let c=this.getAttributeManager();e.setBufferLayout(c.getBufferLayouts(e)),n=c.getAttributes()}let i=e.userData?.excludeAttributes||{},o={},s={};for(let c in n){if(i[c])continue;let d=n[c].getValue();for(let m in d){let b=d[m];b instanceof ei?n[c].settings.isIndexed?e.setIndexBuffer(b):o[m]=b:b&&(s[m]=b)}}e.setAttributes(o),e.setConstantAttributes(s)}disablePickingIndex(e){let n=this.props.data;if(!(\"attributes\"in n)){this._disablePickingIndex(e);return}let{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,o=r||i,s=o&&n.attributes&&n.attributes[o.id];if(s&&s.value){let c=s.value,d=this.encodePickingColor(e);for(let m=0;m<n.length;m++){let b=o.getVertexOffset(m);c[b]===d[0]&&c[b+1]===d[1]&&c[b+2]===d[2]&&this._disablePickingIndex(m)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){let{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;let o=i.getVertexOffset(e),s=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(s-o),o)}restorePickingColors(){let{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==sf.buffer&&(r.value=sf.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){No(!this.internalState),No(Number.isFinite(this.props.coordinateSystem)),ss(Xwe,this);let e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:\"uint8\",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Xw({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,\"attributeManager\",{get:()=>(hn.deprecated(\"layer.state.attributeManager\",\"layer.getAttributeManager()\")(),e)}),this.internalState.uniformTransitions=new Vw(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(let n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:\"init\",propsChanged:\"init\",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ss(qwe,this,this===e);let{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){let e=this.needsUpdate();if(ss(Ywe,this,e),!e)return;let n=this.props,r=this.context,i=this.internalState,o=r.viewport,s=this._updateUniformTransition();i.propsInTransition=s,r.viewport=i.viewport||o,this.props=s;try{let c=this._getUpdateParams(),d=this.getModels();if(r.device)this.updateState(c);else try{this.updateState(c)}catch{}for(let b of this.props.extensions)b.updateState.call(this,c,b);this.setNeedsRedraw(),this._updateAttributes();let m=this.getModels()[0]!==d[0];this._postUpdate(c,m)}finally{r.viewport=o,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){ss(Zwe,this),this.finalizeState(this.context);for(let e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:n=null,uniforms:r={},parameters:i={}}){this._updateAttributeTransition();let o=this.props,s=this.context;this.props=this.internalState.propsInTransition||o;try{n&&this.setShaderModuleProps(n);let{getPolygonOffset:c}=this.props,d=c&&c(r)||[0,0];s.device instanceof $m&&s.device.setParametersWebGL({polygonOffset:d});for(let m of this.getModels())m.device.type===\"webgpu\"?m.setParameters({...m.parameters,...i}):m.setParameters(i);if(s.device instanceof $m)s.device.withParametersWebGL(i,()=>{let m={renderPass:e,shaderModuleProps:n,uniforms:r,parameters:i,context:s};for(let b of this.props.extensions)b.draw.call(this,m,b);this.draw(m)});else{let m={renderPass:e,shaderModuleProps:n,uniforms:r,parameters:i,context:s};for(let b of this.props.extensions)b.draw.call(this,m,b);this.draw(m)}}finally{this.props=o}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;let{changeFlags:n}=this.internalState;for(let i in e)if(e[i]){let o=!1;switch(i){case\"dataChanged\":let s=e[i],c=n[i];s&&Array.isArray(c)&&(n.dataChanged=Array.isArray(s)?c.concat(s):s,o=!0);default:n[i]||(n[i]=e[i],o=!0)}o&&ss(jwe,this,i,e)}let r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){let r=k$(e,n);if(r.updateTriggersChanged)for(let i in r.updateTriggersChanged)r.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(r.transitionsChanged)for(let i in r.transitionsChanged)this.internalState.uniformTransitions.add(i,n[i],e[i],e.transitions?.[i]);return this.setChangeFlags(r)}validateProps(){F$(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){let n={highlightedObjectColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r==\"function\"&&(n.highlightColor=r(e)),this.setShaderModuleProps({picking:n}),this.setNeedsRedraw()}_getAttributeManager(){let e=this.context;return new Ju(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){let{props:r,oldProps:i}=e,o=this.state.model;o?.isInstanced&&o.setInstanceCount(this.getNumInstances());let{autoHighlight:s,highlightedObjectIndex:c,highlightColor:d}=r;if(n||i.autoHighlight!==s||i.highlightedObjectIndex!==c||i.highlightColor!==d){let m={};Array.isArray(d)&&(m.highlightColor=d),(n||i.autoHighlight!==s||c!==i.highlightedObjectIndex)&&(m.highlightedObjectColor=Number.isFinite(c)&&c>=0?this.encodePickingColor(c):null),this.setShaderModuleProps({picking:m})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;let r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(let o of this.props.extensions)o.onNeedsRedraw.call(this,o);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}};Yw.defaultProps=Jwe;Yw.layerName=\"Layer\";var hi=Yw;var $we=\"compositeLayer.renderLayers\",nI=class extends hi{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){let{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){let{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e==\"function\"){let n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){let{opacity:n,pickable:r,visible:i,parameters:o,getPolygonOffset:s,highlightedObjectIndex:c,autoHighlight:d,highlightColor:m,coordinateSystem:b,coordinateOrigin:C,wrapLongitude:B,positionFormat:k,modelMatrix:V,extensions:q,fetch:K,operation:Y,_subLayerProps:ee}=this.props,J={id:\"\",updateTriggers:{},opacity:n,pickable:r,visible:i,parameters:o,getPolygonOffset:s,highlightedObjectIndex:c,autoHighlight:d,highlightColor:m,coordinateSystem:b,coordinateOrigin:C,wrapLongitude:B,positionFormat:k,modelMatrix:V,extensions:q,fetch:K,operation:Y},se=ee&&e.id&&ee[e.id],xe=se&&se.updateTriggers,Ee=e.id||\"sublayer\";if(se){let Xe=this.props[Ku],Ne=e.type?e.type._propTypes:{};for(let be in se){let ge=Ne[be]||Xe[be];ge&&ge.type===\"accessor\"&&(se[be]=this.getSubLayerAccessor(se[be]))}}Object.assign(J,e,se),J.id=`${this.props.id}-${Ee}`,J.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...xe};for(let Xe of q){let Ne=Xe.getSubLayerProps.call(this,Xe);Ne&&Object.assign(J,Ne,{updateTriggers:Object.assign(J.updateTriggers,Ne.updateTriggers)})}return J}_updateAutoHighlight(e){for(let n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers,i=!r||this.needsUpdate();if(i){let o=this.renderLayers();r=kp(o,Boolean),this.internalState.subLayers=r}ss($we,this,i,r);for(let o of r)o.parent=this}};nI.layerName=\"CompositeLayer\";var xs=nI;var Zw=class{static get componentName(){return Object.prototype.hasOwnProperty.call(this,\"extensionName\")?this.extensionName:\"\"}constructor(e){e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&Li(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){let{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(let i in n)if(i in this.props){let o=n[i],s=this.props[i];r[i]=s,o&&o.type===\"accessor\"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof s==\"function\"&&(r[i]=this.getSubLayerAccessor(s)))}return r}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}};Zw.defaultProps={};Zw.extensionName=\"LayerExtension\";var Ek=Zw;lr();var VA=class{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;let{attributes:n={}}=e;this.typedArrayManager=$h,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);let{data:n,buffers:r={},getGeometry:i,geometryBuffer:o,positionFormat:s,dataChanged:c,normalize:d=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=o&&o.size||(s===\"XY\"?2:3),this.buffers=r,this.normalize=d,o&&(No(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(o),d||(r.vertexPositions=o)),this.geometryBuffer=r.vertexPositions,Array.isArray(c))for(let m of c)this._rebuildGeometry(m);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){let n=e.value||e;return ArrayBuffer.isView(n)?Y4(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){let{attributes:r,buffers:i,_attributeDefs:o,typedArrayManager:s}=this;for(let c in o)if(c in i)s.release(r[c]),r[c]=null;else{let d=o[c];d.copy=n,r[c]=s.allocate(r[c],e,d)}}_forEachGeometry(e,n,r){let{data:i,getGeometry:o}=this,{iterable:s,objectInfo:c}=ys(i,n,r);for(let d of s){c.index++;let m=o?o(d,c):null;e(m,c.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this,{data:o,geometryBuffer:s}=this,{startRow:c=0,endRow:d=1/0}=e||{},m={};if(e||(n=[0],r=[0]),this.normalize||!s)this._forEachGeometry((C,B)=>{let k=C&&this.normalizeGeometry(C);m[B]=k,r[B+1]=r[B]+(k?this.getGeometrySize(k):0)},c,d),i=r[r.length-1];else if(r=o.startIndices,i=r[o.length]||0,ArrayBuffer.isView(s))i=i||s.length/this.positionSize;else if(s instanceof ei){let C=this.positionSize*4;i=i||s.byteLength/C}else if(s.buffer){let C=s.stride||this.positionSize*4;i=i||s.buffer.byteLength/C}else if(s.value){let C=s.value,B=s.stride/C.BYTES_PER_ELEMENT||this.positionSize;i=i||C.length/B}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;let b={};this._forEachGeometry((C,B)=>{let k=m[B]||C;b.vertexStart=r[B],b.indexStart=n[B];let V=B<r.length-1?r[B+1]:i;b.geometrySize=V-r[B],b.geometryIndex=B,this.updateGeometryAttributes(k,b)},c,d),this.vertexCount=n[n.length-1]}};var j$=`uniform arcUniforms {\n  bool greatCircle;\n  bool useShortestPath;\n  float numSegments;\n  float widthScale;\n  float widthMinPixels;\n  float widthMaxPixels;\n  highp int widthUnits;\n} arc;\n`,X$={name:\"arc\",vs:j$,fs:j$,uniformTypes:{greatCircle:\"f32\",useShortestPath:\"f32\",numSegments:\"f32\",widthScale:\"f32\",widthMinPixels:\"f32\",widthMaxPixels:\"f32\",widthUnits:\"i32\"}};var Y$=`#version 300 es\n#define SHADER_NAME arc-layer-vertex-shader\nin vec4 instanceSourceColors;\nin vec4 instanceTargetColors;\nin vec3 instanceSourcePositions;\nin vec3 instanceSourcePositions64Low;\nin vec3 instanceTargetPositions;\nin vec3 instanceTargetPositions64Low;\nin vec3 instancePickingColors;\nin float instanceWidths;\nin float instanceHeights;\nin float instanceTilts;\nout vec4 vColor;\nout vec2 uv;\nout float isValid;\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\nfloat deltaZ = targetZ - sourceZ;\nfloat dh = distance * instanceHeights;\nif (dh == 0.0) {\nreturn sourceZ + deltaZ * ratio;\n}\nfloat unitZ = deltaZ / dh;\nfloat p2 = unitZ * unitZ + 1.0;\nfloat dir = step(deltaZ, 0.0);\nfloat z0 = mix(sourceZ, targetZ, dir);\nfloat r = mix(ratio, 1.0 - ratio, dir);\nreturn sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\nvec2 dir_screenspace = normalize(line_clipspace * project.viewportSize);\ndir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\nreturn dir_screenspace * offset_direction * width / 2.0;\n}\nfloat getSegmentRatio(float index) {\nreturn smoothstep(0.0, 1.0, index / (arc.numSegments - 1.0));\n}\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\nfloat distance = length(source.xy - target.xy);\nfloat z = paraboloid(distance, source.z, target.z, segmentRatio);\nfloat tiltAngle = radians(instanceTilts);\nvec2 tiltDirection = normalize(target.xy - source.xy);\nvec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\nreturn vec3(\nmix(source.xy, target.xy, segmentRatio) + tilt,\nz * cos(tiltAngle)\n);\n}\nfloat getAngularDist (vec2 source, vec2 target) {\nvec2 sourceRadians = radians(source);\nvec2 targetRadians = radians(target);\nvec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\nvec2 shd_sq = sin_half_delta * sin_half_delta;\nfloat a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\nreturn 2.0 * asin(sqrt(a));\n}\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\nvec2 lngLat;\nif(abs(angularDist - PI) < 0.001) {\nlngLat = (1.0 - t) * source.xy + t * target.xy;\n} else {\nfloat a = sin((1.0 - t) * angularDist);\nfloat b = sin(t * angularDist);\nvec3 p = source3D.yxz * a + target3D.yxz * b;\nlngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n}\nfloat z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\nreturn vec3(lngLat, z);\n}\nvoid main(void) {\ngeometry.worldPosition = instanceSourcePositions;\ngeometry.worldPositionAlt = instanceTargetPositions;\nfloat segmentIndex = float(gl_VertexID / 2);\nfloat segmentSide = mod(float(gl_VertexID), 2.) == 0. ? -1. : 1.;\nfloat segmentRatio = getSegmentRatio(segmentIndex);\nfloat prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\nfloat nextSegmentRatio = getSegmentRatio(min(arc.numSegments - 1.0, segmentIndex + 1.0));\nfloat indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\nisValid = 1.0;\nuv = vec2(segmentRatio, segmentSide);\ngeometry.uv = uv;\ngeometry.pickingColor = instancePickingColors;\nvec4 curr;\nvec4 next;\nvec3 source;\nvec3 target;\nif ((arc.greatCircle || project.projectionMode == PROJECTION_MODE_GLOBE) && project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nsource = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\ntarget = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\nfloat angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\nvec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\nvec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\nvec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\nif (abs(currPos.x - prevPos.x) > 180.0) {\nindexDir = -1.0;\nisValid = 0.0;\n} else if (abs(currPos.x - nextPos.x) > 180.0) {\nindexDir = 1.0;\nisValid = 0.0;\n}\nnextPos = indexDir < 0.0 ? prevPos : nextPos;\nnextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\nif (isValid == 0.0) {\nnextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\nfloat t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\ncurrPos = mix(currPos, nextPos, t);\nsegmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n}\nvec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\nvec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\ncurr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\nnext = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n} else {\nvec3 source_world = instanceSourcePositions;\nvec3 target_world = instanceTargetPositions;\nif (arc.useShortestPath) {\nsource_world.x = mod(source_world.x + 180., 360.0) - 180.;\ntarget_world.x = mod(target_world.x + 180., 360.0) - 180.;\nfloat deltaLng = target_world.x - source_world.x;\nif (deltaLng > 180.) target_world.x -= 360.;\nif (deltaLng < -180.) source_world.x -= 360.;\n}\nsource = project_position(source_world, instanceSourcePositions64Low);\ntarget = project_position(target_world, instanceTargetPositions64Low);\nfloat antiMeridianX = 0.0;\nif (arc.useShortestPath) {\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\nantiMeridianX = -(project.coordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n}\nfloat thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\nif (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\nisValid = 0.0;\nindexDir = sign(segmentRatio - thresholdRatio);\nsegmentRatio = thresholdRatio;\n}\n}\nnextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\nvec3 currPos = interpolateFlat(source, target, segmentRatio);\nvec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\nif (arc.useShortestPath) {\nif (nextPos.x < antiMeridianX) {\ncurrPos.x += TILE_SIZE;\nnextPos.x += TILE_SIZE;\n}\n}\ncurr = project_common_position_to_clipspace(vec4(currPos, 1.0));\nnext = project_common_position_to_clipspace(vec4(nextPos, 1.0));\ngeometry.position = vec4(currPos, 1.0);\n}\nfloat widthPixels = clamp(\nproject_size_to_pixel(instanceWidths * arc.widthScale, arc.widthUnits),\narc.widthMinPixels, arc.widthMaxPixels\n);\nvec3 offset = vec3(\ngetExtrusionOffset((next.xy - curr.xy) * indexDir, segmentSide, widthPixels),\n0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\nDECKGL_FILTER_GL_POSITION(curr, geometry);\ngl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\nvec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\nvColor = vec4(color.rgb, color.a * layer.opacity);\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var Z$=`#version 300 es\n#define SHADER_NAME arc-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nin vec2 uv;\nin float isValid;\nout vec4 fragColor;\nvoid main(void) {\nif (isValid == 0.0) {\ndiscard;\n}\nfragColor = vColor;\ngeometry.uv = uv;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var rI=[0,0,0,255],e3e={getSourcePosition:{type:\"accessor\",value:t=>t.sourcePosition},getTargetPosition:{type:\"accessor\",value:t=>t.targetPosition},getSourceColor:{type:\"accessor\",value:rI},getTargetColor:{type:\"accessor\",value:rI},getWidth:{type:\"accessor\",value:1},getHeight:{type:\"accessor\",value:1},getTilt:{type:\"accessor\",value:0},greatCircle:!1,numSegments:{type:\"number\",value:50,min:1},widthUnits:\"pixels\",widthScale:{type:\"number\",value:1,min:0},widthMinPixels:{type:\"number\",value:0,min:0},widthMaxPixels:{type:\"number\",value:Number.MAX_SAFE_INTEGER,min:0}},qw=class extends hi{getBounds(){return this.getAttributeManager()?.getBounds([\"instanceSourcePositions\",\"instanceTargetPositions\"])}getShaders(){return super.getShaders({vs:Y$,fs:Z$,modules:[Lr,$i,X$]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),transition:!0,accessor:\"getSourcePosition\"},instanceTargetPositions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),transition:!0,accessor:\"getTargetPosition\"},instanceSourceColors:{size:this.props.colorFormat.length,type:\"unorm8\",transition:!0,accessor:\"getSourceColor\",defaultValue:rI},instanceTargetColors:{size:this.props.colorFormat.length,type:\"unorm8\",transition:!0,accessor:\"getTargetColor\",defaultValue:rI},instanceWidths:{size:1,transition:!0,accessor:\"getWidth\",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:\"getHeight\",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:\"getTilt\",defaultValue:0}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){let{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:o,greatCircle:s,wrapLongitude:c,numSegments:d}=this.props,m={numSegments:d,widthUnits:so[n],widthScale:r,widthMinPixels:i,widthMaxPixels:o,greatCircle:s,useShortestPath:c},b=this.state.model;b.shaderInputs.setProps({arc:m}),b.setVertexCount(d*2),b.draw(this.context.renderPass)}_getModel(){return new gr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:\"triangle-strip\",isInstanced:!0})}};qw.layerName=\"ArcLayer\";qw.defaultProps=e3e;var iI=qw;var t3e=new Uint32Array([0,2,1,0,3,2]),n3e=new Float32Array([0,1,0,0,1,0,1,1]);function Sk(t,e){if(!e)return r3e(t);let n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,o=Math.ceil(r/e)+1,s=(i-1)*(o-1)*6,c=new Uint32Array(s),d=new Float32Array(i*o*2),m=new Float64Array(i*o*3),b=0,C=0;for(let B=0;B<i;B++){let k=B/(i-1);for(let V=0;V<o;V++){let q=V/(o-1),K=i3e(t,k,q);m[b*3+0]=K[0],m[b*3+1]=K[1],m[b*3+2]=K[2]||0,d[b*2+0]=k,d[b*2+1]=1-q,B>0&&V>0&&(c[C++]=b-o,c[C++]=b-o-1,c[C++]=b-1,c[C++]=b-o,c[C++]=b-1,c[C++]=b),b++}}return{vertexCount:s,positions:m,indices:c,texCoords:d}}function r3e(t){let e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:t3e,texCoords:n3e}}function i3e(t,e,n){return Xa(Xa(t[0],t[1],n),Xa(t[3],t[2],n),e)}var q$=`uniform bitmapUniforms {\n  vec4 bounds;\n  float coordinateConversion;\n  float desaturate;\n  vec3 tintColor;\n  vec4 transparentColor;\n} bitmap;\n`,Q$={name:\"bitmap\",vs:q$,fs:q$,uniformTypes:{bounds:\"vec4<f32>\",coordinateConversion:\"f32\",desaturate:\"f32\",tintColor:\"vec3<f32>\",transparentColor:\"vec4<f32>\"}};var K$=`#version 300 es\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nin vec2 texCoords;\nin vec3 positions;\nin vec3 positions64Low;\n\nout vec2 vTexCoord;\nout vec2 vTexPos;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (bitmap.coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project.commonOrigin.xy;\n  } else if (bitmap.coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n`;var o3e=`\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n`,J$=`#version 300 es\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nin vec2 vTexCoord;\nin vec2 vTexPos;\n\nout vec4 fragColor;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), bitmap.desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * bitmap.tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  if (bitmap.transparentColor.a == 0.0) {\n    return vec4(color, alpha);\n  }\n  float blendedAlpha = alpha + bitmap.transparentColor.a * (1.0 - alpha);\n  float highLightRatio = alpha / blendedAlpha;\n  vec3 blendedRGB = mix(bitmap.transparentColor.rgb, color, highLightRatio);\n  return vec4(blendedRGB, blendedAlpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bitmap.bounds[0]) / (bitmap.bounds[2] - bitmap.bounds[0]),\n    (pos.y - bitmap.bounds[3]) / (bitmap.bounds[1] - bitmap.bounds[3])\n  );\n}\n\n${o3e}\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (bitmap.coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (bitmap.coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture(bitmapTexture, uv);\n\n  fragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * layer.opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n\n  if (bool(picking.isActive) && !bool(picking.isAttribute)) {\n    // Since instance information is not used, we can use picking color for pixel index\n    fragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n`;var s3e={image:{type:\"image\",value:null,async:!0},bounds:{type:\"array\",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Cn.DEFAULT,desaturate:{type:\"number\",min:0,max:1,value:0},transparentColor:{type:\"color\",value:[0,0,0,0]},tintColor:{type:\"color\",value:[255,255,255]},textureParameters:{type:\"object\",ignore:!0,value:null}},Qw=class extends hi{getShaders(){return super.getShaders({vs:K$,fs:J$,modules:[Lr,$i,Q$]})}initializeState(){let e=this.getAttributeManager();e.remove([\"instancePickingColors\"]);let n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){let i=this.getAttributeManager();if(r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),i.invalidateAll()),e.bounds!==n.bounds){let o=this.state.mesh,s=this._createMesh();this.state.model.setVertexCount(s.vertexCount);for(let c in s)o&&o[c]!==s[c]&&i.invalidate(c);this.setState({mesh:s,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){let{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;let{width:i,height:o}=n;r.index=0;let s=a3e(r.color);return r.bitmap={size:{width:i,height:o},uv:s,pixel:[Math.floor(s[0]*i),Math.floor(s[1]*o)]},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){let{bounds:e}=this.props,n=e;return $$(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),Sk(n,this.context.viewport.resolution)}_getModel(){return new gr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:\"triangle-list\",isInstanced:!1})}draw(e){let{shaderModuleProps:n}=e,{model:r,coordinateConversion:i,bounds:o,disablePicking:s}=this.state,{image:c,desaturate:d,transparentColor:m,tintColor:b}=this.props;if(!(n.picking.isActive&&s)&&c&&r){let C={bitmapTexture:c,bounds:o,coordinateConversion:i,desaturate:d,tintColor:b.slice(0,3).map(B=>B/255),transparentColor:m.map(B=>B/255)};r.shaderInputs.setProps({bitmap:C}),r.draw(this.context.renderPass)}}_getCoordinateUniforms(){let{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=Cn,{_imageCoordinateSystem:i}=this.props;if(i!==r){let{bounds:o}=this.props;if(!$$(o))throw new Error(\"_imageCoordinateSystem only supports rectangular bounds\");let s=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&s===n)return{coordinateConversion:-1,bounds:o};if(i===n&&s===e){let c=$l([o[0],o[1]]),d=$l([o[2],o[3]]);return{coordinateConversion:1,bounds:[c[0],c[1],d[0],d[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}};Qw.layerName=\"BitmapLayer\";Qw.defaultProps=s3e;var e2=Qw;function a3e(t){let[e,n,r]=t,i=(r&240)/256,o=(r&15)/16;return[(e+o)/256,(n+i)/256]}function $$(t){return Number.isFinite(t[0])}var eee=`uniform iconUniforms {\n  float sizeScale;\n  vec2 iconsTextureDim;\n  float sizeBasis;\n  float sizeMinPixels;\n  float sizeMaxPixels;\n  bool billboard;\n  highp int sizeUnits;\n  float alphaCutoff;\n} icon;\n`,tee={name:\"icon\",vs:eee,fs:eee,uniformTypes:{sizeScale:\"f32\",iconsTextureDim:\"vec2<f32>\",sizeBasis:\"f32\",sizeMinPixels:\"f32\",sizeMaxPixels:\"f32\",billboard:\"f32\",sizeUnits:\"i32\",alphaCutoff:\"f32\"}};var nee=`#version 300 es\n#define SHADER_NAME icon-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceSizes;\nin float instanceAngles;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin vec4 instanceIconFrames;\nin float instanceColorModes;\nin vec2 instanceOffsets;\nin vec2 instancePixelOffset;\nout float vColorMode;\nout vec4 vColor;\nout vec2 vTextureCoords;\nout vec2 uv;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = angle * PI / 180.0;\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvec2 iconSize = instanceIconFrames.zw;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),\nicon.sizeMinPixels, icon.sizeMaxPixels\n);\nfloat iconConstraint = icon.sizeBasis == 0.0 ? iconSize.x : iconSize.y;\nfloat instanceScale = iconConstraint == 0.0 ? 0.0 : sizePixels / iconConstraint;\nvec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\npixelOffset += instancePixelOffset;\npixelOffset.y *= -1.0;\nif (icon.billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvTextureCoords = mix(\ninstanceIconFrames.xy,\ninstanceIconFrames.xy + iconSize,\n(positions.xy + 1.0) / 2.0\n) / icon.iconsTextureDim;\nvColor = instanceColors;\nDECKGL_FILTER_COLOR(vColor, geometry);\nvColorMode = instanceColorModes;\n}\n`;var ree=`#version 300 es\n#define SHADER_NAME icon-layer-fragment-shader\nprecision highp float;\nuniform sampler2D iconsTexture;\nin float vColorMode;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nvec4 texColor = texture(iconsTexture, vTextureCoords);\nvec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\nfloat a = texColor.a * layer.opacity * vColor.a;\nif (a < icon.alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color, a);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var l3e=1024,c3e=4,iee=()=>{},oee={minFilter:\"linear\",mipmapFilter:\"linear\",magFilter:\"linear\",addressModeU:\"clamp-to-edge\",addressModeV:\"clamp-to-edge\"},u3e={x:0,y:0,width:0,height:0};function h3e(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function f3e(t,e,n,r){let i=Math.min(n/e.width,r/e.height),o=Math.floor(e.width*i),s=Math.floor(e.height*i);return i===1?{image:e,width:o,height:s}:(t.canvas.height=s,t.canvas.width=o,t.clearRect(0,0,o,s),t.drawImage(e,0,0,e.width,e.height,0,0,o,s),{image:t.canvas,width:o,height:s})}function Kw(t){return t&&(t.id||t.url)}function d3e(t,e,n,r){let{width:i,height:o,device:s}=t,c=s.createTexture({format:\"rgba8unorm\",width:e,height:n,sampler:r,mipLevels:s.getMipLevelCount(e,n)}),d=s.createCommandEncoder();return d.copyTextureToTexture({sourceTexture:t,destinationTexture:c,width:i,height:o}),d.finish(),c.generateMipmapsWebGL(),t.destroy(),c}function see(t,e,n){for(let r=0;r<e.length;r++){let{icon:i,xOffset:o}=e[r],s=Kw(i);t[s]={...i,x:o,y:n}}}function p3e({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:o=0,canvasWidth:s}){let c=[];for(let d=0;d<t.length;d++){let m=t[d],b=Kw(m);if(!n[b]){let{height:C,width:B}=m;r+B+e>s&&(see(n,c,i),r=0,i=o+i+e,o=0,c=[]),c.push({icon:m,xOffset:r}),r=r+B+e,o=Math.max(o,C)}}return c.length>0&&see(n,c,i),{mapping:n,rowHeight:o,xOffset:r,yOffset:i,canvasWidth:s,canvasHeight:h3e(o+i+e)}}function A3e(t,e,n){if(!t||!e)return null;n=n||{};let r={},{iterable:i,objectInfo:o}=ys(t);for(let s of i){o.index++;let c=e(s,o),d=Kw(c);if(!c)throw new Error(\"Icon is missing.\");if(!c.url)throw new Error(\"Icon url is missing.\");!r[d]&&(!n[d]||c.url!==n[d].url)&&(r[d]={...c,source:s,sourceIndex:o.index})}return r}var Jw=class{constructor(e,{onUpdate:n=iee,onError:r=iee}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=c3e,this._canvasWidth=l3e,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=n,this.onError=r}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){let n=this._autoPacking?Kw(e):e;return this._mapping[n]||u3e}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:o}){e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r&&(this._texture?.delete(),this._texture=null,this._externalTexture=r),o&&(this._samplerParameters=o)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>\"u\")return;let r=Object.values(A3e(e,n,this._mapping)||{});if(r.length>0){let{mapping:i,xOffset:o,yOffset:s,rowHeight:c,canvasHeight:d}=p3e({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=c,this._mapping=i,this._xOffset=o,this._yOffset=s,this._canvasHeight=d,this._texture||(this._texture=this.device.createTexture({format:\"rgba8unorm\",data:null,width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||oee,mipLevels:this.device.getMipLevelCount(this._canvasWidth,this._canvasHeight)})),this._texture.height!==this._canvasHeight&&(this._texture=d3e(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||oee)),this.onUpdate(!0),this._canvas=this._canvas||document.createElement(\"canvas\"),this._loadIcons(r)}}_loadIcons(e){let n=this._canvas.getContext(\"2d\",{willReadFrequently:!0});for(let r of e)this._pendingCount++,va(r.url,this._loadOptions).then(i=>{let o=Kw(r),s=this._mapping[o],{x:c,y:d,width:m,height:b}=s,{image:C,width:B,height:k}=f3e(n,i,m,b),V=c+(m-B)/2,q=d+(b-k)/2;this._texture?.copyExternalImage({image:C,x:V,y:q,width:B,height:k}),s.x=V,s.y=q,s.width=B,s.height=k,this._texture?.generateMipmapsWebGL(),this.onUpdate(B!==m||k!==b)}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}};var aee=[0,0,0,255],g3e={iconAtlas:{type:\"image\",value:null,async:!0},iconMapping:{type:\"object\",value:{},async:!0},sizeScale:{type:\"number\",value:1,min:0},billboard:!0,sizeUnits:\"pixels\",sizeBasis:\"height\",sizeMinPixels:{type:\"number\",min:0,value:0},sizeMaxPixels:{type:\"number\",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:\"number\",value:.05,min:0,max:1},getPosition:{type:\"accessor\",value:t=>t.position},getIcon:{type:\"accessor\",value:t=>t.icon},getColor:{type:\"accessor\",value:aee},getSize:{type:\"accessor\",value:1},getAngle:{type:\"accessor\",value:0},getPixelOffset:{type:\"accessor\",value:[0,0]},onIconError:{type:\"function\",value:null,optional:!0},textureParameters:{type:\"object\",ignore:!0,value:null}},$w=class extends hi{getShaders(){return super.getShaders({vs:nee,fs:ree,modules:[Lr,$i,tee]})}initializeState(){this.state={iconManager:new Jw(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),transition:!0,accessor:\"getPosition\"},instanceSizes:{size:1,transition:!0,accessor:\"getSize\",defaultValue:1},instanceOffsets:{size:2,accessor:\"getIcon\",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:\"getIcon\",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:\"uint8\",accessor:\"getIcon\",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:\"unorm8\",transition:!0,accessor:\"getColor\",defaultValue:aee},instanceAngles:{size:1,transition:!0,accessor:\"getAngle\"},instancePixelOffset:{size:2,transition:!0,accessor:\"getPixelOffset\"}})}updateState(e){super.updateState(e);let{props:n,oldProps:r,changeFlags:i}=e,o=this.getAttributeManager(),{iconAtlas:s,iconMapping:c,data:d,getIcon:m,textureParameters:b}=n,{iconManager:C}=this.state;if(typeof s==\"string\")return;let B=s||this.internalState.isAsyncPropLoading(\"iconAtlas\");C.setProps({loadOptions:n.loadOptions,autoPacking:!B,iconAtlas:s,iconMapping:B?c:null,textureParameters:b}),B?r.iconMapping!==n.iconMapping&&o.invalidate(\"getIcon\"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&C.packIcons(d,m),i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),o.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){let{sizeScale:n,sizeBasis:r,sizeMinPixels:i,sizeMaxPixels:o,sizeUnits:s,billboard:c,alphaCutoff:d}=this.props,{iconManager:m}=this.state,b=m.getTexture();if(b){let C=this.state.model,B={iconsTexture:b,iconsTextureDim:[b.width,b.height],sizeUnits:so[s],sizeScale:n,sizeBasis:r===\"height\"?1:0,sizeMinPixels:i,sizeMaxPixels:o,billboard:c,alphaCutoff:d};C.shaderInputs.setProps({icon:B}),C.draw(this.context.renderPass)}}_getModel(){let e=[-1,-1,1,-1,-1,1,1,1];return new gr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new gi({topology:\"triangle-strip\",attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(e){e?(this.getAttributeManager()?.invalidate(\"getIcon\"),this.setNeedsUpdate()):this.setNeedsRedraw()}_onError(e){let n=this.getCurrentLayer()?.props.onIconError;n?n(e):hn.error(e.error.message)()}getInstanceOffset(e){let{width:n,height:r,anchorX:i=n/2,anchorY:o=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-o]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){let{x:n,y:r,width:i,height:o}=this.state.iconManager.getIconMapping(e);return[n,r,i,o]}};$w.defaultProps=g3e;$w.layerName=\"IconLayer\";var GA=$w;var m3e=`struct LineUniforms {\n  widthScale: f32,\n  widthMinPixels: f32,\n  widthMaxPixels: f32,\n  useShortestPath: f32,\n  widthUnits: i32,\n};\n\n@group(0) @binding(1)\nvar<uniform> line: LineUniforms;\n`,lee=`uniform lineUniforms {\n  float widthScale;\n  float widthMinPixels;\n  float widthMaxPixels;\n  float useShortestPath;\n  highp int widthUnits;\n} line;\n`,cee={name:\"line\",source:m3e,vs:lee,fs:lee,uniformTypes:{widthScale:\"f32\",widthMinPixels:\"f32\",widthMaxPixels:\"f32\",useShortestPath:\"f32\",widthUnits:\"i32\"}};var uee=`// ---------- Helper Structures & Functions ----------\n\n// Placeholder filter functions.\nfn deckgl_filter_size(offset: vec3<f32>, geometry: Geometry) -> vec3<f32> {\n  return offset;\n}\nfn deckgl_filter_gl_position(p: vec4<f32>, geometry: Geometry) -> vec4<f32> {\n  return p;\n}\nfn deckgl_filter_color(color: vec4<f32>, geometry: Geometry) -> vec4<f32> {\n  return color;\n}\n\n// Compute an extrusion offset given a line direction (in clipspace),\n// an offset direction (-1 or 1), and a width in pixels.\n// Assumes a uniform \"project\" with a viewportSize field is available.\nfn getExtrusionOffset(line_clipspace: vec2<f32>, offset_direction: f32, width: f32) -> vec2<f32> {\n  // project.viewportSize should be provided as a uniform (not shown here)\n  let dir_screenspace = normalize(line_clipspace * project.viewportSize);\n  // Rotate by 90\\xB0: (x,y) becomes (-y,x)\n  let rotated = vec2<f32>(-dir_screenspace.y, dir_screenspace.x);\n  return rotated * offset_direction * width / 2.0;\n}\n\n// Splits the line between two points at a given x coordinate.\n// Interpolates the y and z components.\nfn splitLine(a: vec3<f32>, b: vec3<f32>, x: f32) -> vec3<f32> {\n  let t: f32 = (x - a.x) / (b.x - a.x);\n  return vec3<f32>(x, a.yz + t * (b.yz - a.yz));\n}\n\n// ---------- Uniforms & Global Structures ----------\n\n// Uniforms for line, color, and project are assumed to be defined elsewhere.\n// For example:\n//\n// @group(0) @binding(0)\n// var<uniform> line: LineUniform;\n//\n// struct ColorUniform {\n//   opacity: f32,\n// };\n// @group(0) @binding(1)\n// var<uniform> color: ColorUniform;\n//\n// struct ProjectUniform {\n//   viewportSize: vec2<f32>,\n// };\n// @group(0) @binding(2)\n// var<uniform> project: ProjectUniform;\n\n\n\n// ---------- Vertex Output Structure ----------\n\nstruct Varyings {\n  @builtin(position) gl_Position: vec4<f32>,\n  @location(0) vColor: vec4<f32>,\n  @location(1) uv: vec2<f32>,\n};\n\n// ---------- Vertex Shader Entry Point ----------\n\n@vertex\nfn vertexMain(\n  @location(0) positions: vec3<f32>,\n  @location(1) instanceSourcePositions: vec3<f32>,\n  @location(2) instanceTargetPositions: vec3<f32>,\n  @location(3) instanceSourcePositions64Low: vec3<f32>,\n  @location(4) instanceTargetPositions64Low: vec3<f32>,\n  @location(5) instanceColors: vec4<f32>,\n  @location(6) instancePickingColors: vec3<f32>,\n  @location(7) instanceWidths: f32\n) -> Varyings {\n  var geometry: Geometry;\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  var source_world: vec3<f32> = instanceSourcePositions;\n  var target_world: vec3<f32> = instanceTargetPositions;\n  var source_world_64low: vec3<f32> = instanceSourcePositions64Low;\n  var target_world_64low: vec3<f32> = instanceTargetPositions64Low;\n\n  // Apply shortest-path adjustments if needed.\n  if (line.useShortestPath > 0.5 || line.useShortestPath < -0.5) {\n    source_world.x = (source_world.x + 180.0 % 360.0) - 180.0;\n    target_world.x = (target_world.x + 180.0 % 360.0) - 180.0;\n    let deltaLng: f32 = target_world.x - source_world.x;\n\n    if (deltaLng * line.useShortestPath > 180.0) {\n      source_world.x = source_world.x + 360.0 * line.useShortestPath;\n      source_world = splitLine(source_world, target_world, 180.0 * line.useShortestPath);\n      source_world_64low = vec3<f32>(0.0, 0.0, 0.0);\n    } else if (deltaLng * line.useShortestPath < -180.0) {\n      target_world.x = target_world.x + 360.0 * line.useShortestPath;\n      target_world = splitLine(source_world, target_world, 180.0 * line.useShortestPath);\n      target_world_64low = vec3<f32>(0.0, 0.0, 0.0);\n    } else if (line.useShortestPath < 0.0) {\n      var abortOut: Varyings;\n      abortOut.gl_Position = vec4<f32>(0.0);\n      abortOut.vColor = vec4<f32>(0.0);\n      abortOut.uv = vec2<f32>(0.0);\n      return abortOut;\n    }\n  }\n\n  // Project Pos and target positions to clip space.\n  let sourceResult = project_position_to_clipspace_and_commonspace(source_world, source_world_64low, vec3<f32>(0.0));\n  let targetResult = project_position_to_clipspace_and_commonspace(target_world, target_world_64low, vec3<f32>(0.0));\n  let sourcePos: vec4<f32> = sourceResult.clipPosition;\n  let targetPos: vec4<f32> = targetResult.clipPosition;\n  let source_commonspace: vec4<f32> = sourceResult.commonPosition;\n  let target_commonspace: vec4<f32> = targetResult.commonPosition;\n\n  // Interpolate along the line segment.\n  let segmentIndex: f32 = positions.x;\n  let p: vec4<f32> = sourcePos + segmentIndex * (targetPos - sourcePos);\n  geometry.position = source_commonspace + segmentIndex * (target_commonspace - source_commonspace);\n  let uv: vec2<f32> = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  // Determine width in pixels.\n  let widthPixels: f32 = clamp(\n    project_unit_size_to_pixel(instanceWidths * line.widthScale, line.widthUnits),\n    line.widthMinPixels, line.widthMaxPixels\n  );\n\n  // Compute extrusion offset.\n  let extrusion: vec2<f32> = getExtrusionOffset(targetPos.xy - sourcePos.xy, positions.y, widthPixels);\n  let offset: vec3<f32> = vec3<f32>(extrusion, 0.0);\n\n  // Apply deck.gl filter functions.\n  let filteredOffset = deckgl_filter_size(offset, geometry);\n  let filteredP = deckgl_filter_gl_position(p, geometry);\n\n  let clipOffset: vec2<f32> = project_pixel_size_to_clipspace(filteredOffset.xy);\n  let finalPosition: vec4<f32> = filteredP + vec4<f32>(clipOffset, 0.0, 0.0);\n\n  // Compute color.\n  var vColor: vec4<f32> = vec4<f32>(instanceColors.rgb, instanceColors.a * color.opacity);\n  // vColor = deckgl_filter_color(vColor, geometry);\n\n  var output: Varyings;\n  output.gl_Position = finalPosition;\n  output.vColor = vColor;\n  output.uv = uv;\n  return output;\n}\n\n@fragment\nfn fragmentMain(\n  @location(0) vColor: vec4<f32>,\n  @location(1) uv: vec2<f32>\n) -> @location(0) vec4<f32> {\n  // Create and initialize geometry with the provided uv.\n  var geometry: Geometry;\n  geometry.uv = uv;\n\n  // Start with the input color.\n  var fragColor: vec4<f32> = vColor;\n\n  // Apply the deck.gl filter to the color.\n  fragColor = deckgl_filter_color(fragColor, geometry);\n\n  // Apply premultiplied alpha as required by transparent canvas\n  fragColor = deckgl_premultiplied_alpha(fragColor);\n\n  return fragColor;\n}\n`;var hee=`#version 300 es\n#define SHADER_NAME line-layer-vertex-shader\nin vec3 positions;\nin vec3 instanceSourcePositions;\nin vec3 instanceTargetPositions;\nin vec3 instanceSourcePositions64Low;\nin vec3 instanceTargetPositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin float instanceWidths;\nout vec4 vColor;\nout vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\nvec2 dir_screenspace = normalize(line_clipspace * project.viewportSize);\ndir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\nreturn dir_screenspace * offset_direction * width / 2.0;\n}\nvec3 splitLine(vec3 a, vec3 b, float x) {\nfloat t = (x - a.x) / (b.x - a.x);\nreturn vec3(x, mix(a.yz, b.yz, t));\n}\nvoid main(void) {\ngeometry.worldPosition = instanceSourcePositions;\ngeometry.worldPositionAlt = instanceTargetPositions;\nvec3 source_world = instanceSourcePositions;\nvec3 target_world = instanceTargetPositions;\nvec3 source_world_64low = instanceSourcePositions64Low;\nvec3 target_world_64low = instanceTargetPositions64Low;\nif (line.useShortestPath > 0.5 || line.useShortestPath < -0.5) {\nsource_world.x = mod(source_world.x + 180., 360.0) - 180.;\ntarget_world.x = mod(target_world.x + 180., 360.0) - 180.;\nfloat deltaLng = target_world.x - source_world.x;\nif (deltaLng * line.useShortestPath > 180.) {\nsource_world.x += 360. * line.useShortestPath;\nsource_world = splitLine(source_world, target_world, 180. * line.useShortestPath);\nsource_world_64low = vec3(0.0);\n} else if (deltaLng * line.useShortestPath < -180.) {\ntarget_world.x += 360. * line.useShortestPath;\ntarget_world = splitLine(source_world, target_world, 180. * line.useShortestPath);\ntarget_world_64low = vec3(0.0);\n} else if (line.useShortestPath < 0.) {\ngl_Position = vec4(0.);\nreturn;\n}\n}\nvec4 source_commonspace;\nvec4 target_commonspace;\nvec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\nvec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\nfloat segmentIndex = positions.x;\nvec4 p = mix(source, target, segmentIndex);\ngeometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\nuv = positions.xy;\ngeometry.uv = uv;\ngeometry.pickingColor = instancePickingColors;\nfloat widthPixels = clamp(\nproject_size_to_pixel(instanceWidths * line.widthScale, line.widthUnits),\nline.widthMinPixels, line.widthMaxPixels\n);\nvec3 offset = vec3(\ngetExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\nDECKGL_FILTER_GL_POSITION(p, geometry);\ngl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\nvColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var fee=`#version 300 es\n#define SHADER_NAME line-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var _3e=[0,0,0,255],y3e={getSourcePosition:{type:\"accessor\",value:t=>t.sourcePosition},getTargetPosition:{type:\"accessor\",value:t=>t.targetPosition},getColor:{type:\"accessor\",value:_3e},getWidth:{type:\"accessor\",value:1},widthUnits:\"pixels\",widthScale:{type:\"number\",value:1,min:0},widthMinPixels:{type:\"number\",value:0,min:0},widthMaxPixels:{type:\"number\",value:Number.MAX_SAFE_INTEGER,min:0}},e3=class extends hi{getBounds(){return this.getAttributeManager()?.getBounds([\"instanceSourcePositions\",\"instanceTargetPositions\"])}getShaders(){return super.getShaders({vs:hee,fs:fee,source:uee,modules:[Lr,PA,$i,cee]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),transition:!0,accessor:\"getSourcePosition\"},instanceTargetPositions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),transition:!0,accessor:\"getTargetPosition\"},instanceColors:{size:this.props.colorFormat.length,type:\"unorm8\",transition:!0,accessor:\"getColor\",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:\"getWidth\",defaultValue:1}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){let{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:o,wrapLongitude:s}=this.props,c=this.state.model,d={widthUnits:so[n],widthScale:r,widthMinPixels:i,widthMaxPixels:o,useShortestPath:s?1:0};c.shaderInputs.setProps({line:d}),c.draw(this.context.renderPass),s&&(c.shaderInputs.setProps({line:{...d,useShortestPath:-1}}),c.draw(this.context.renderPass))}_getModel(){let e=this.context.device.type===\"webgpu\"?{depthWriteEnabled:!0,depthCompare:\"less-equal\"}:void 0,n=[0,-1,0,0,1,0,1,-1,0,1,1,0];return new gr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new gi({topology:\"triangle-strip\",attributes:{positions:{size:3,value:new Float32Array(n)}}}),parameters:e,isInstanced:!0})}};e3.layerName=\"LineLayer\";e3.defaultProps=y3e;var oI=e3;var x3e=`struct PointCloudUniforms {\n  radiusPixels: f32,\n  sizeUnits: i32,\n};\n\n@group(0) @binding(3)\nvar<uniform> pointCloud: PointCloudUniforms;\n`,dee=`uniform pointCloudUniforms {\n  float radiusPixels;\n  highp int sizeUnits;\n} pointCloud;\n`,pee={name:\"pointCloud\",source:x3e,vs:dee,fs:dee,uniformTypes:{radiusPixels:\"f32\",sizeUnits:\"i32\"}};var Aee=`#version 300 es\n#define SHADER_NAME point-cloud-layer-vertex-shader\nin vec3 positions;\nin vec3 instanceNormals;\nin vec4 instanceColors;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec3 instancePickingColors;\nout vec4 vColor;\nout vec2 unitPosition;\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.normal = project_normal(instanceNormals);\nunitPosition = positions.xy;\ngeometry.uv = unitPosition;\ngeometry.pickingColor = instancePickingColors;\nvec3 offset = vec3(positions.xy * project_size_to_pixel(pointCloud.radiusPixels, pointCloud.sizeUnits), 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\nvec3 lightColor = lighting_getLightColor(instanceColors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);\nvColor = vec4(lightColor, instanceColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var gee=`#version 300 es\n#define SHADER_NAME point-cloud-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nin vec2 unitPosition;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = unitPosition.xy;\nfloat distToCenter = length(unitPosition);\nif (distToCenter > 1.0) {\ndiscard;\n}\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var mee=`struct ConstantAttributes {\n  instanceNormals: vec3<f32>,\n  instanceColors: vec4<f32>,\n  instancePositions: vec3<f32>,\n  instancePositions64Low: vec3<f32>,\n  instancePickingColors: vec3<f32>\n};\n\nconst constants = ConstantAttributes(\n  vec3<f32>(1.0, 0.0, 0.0),\n  vec4<f32>(0.0, 0.0, 0.0, 1.0),\n  vec3<f32>(0.0),\n  vec3<f32>(0.0),\n  vec3<f32>(0.0)\n);\n\nstruct Attributes {\n  @builtin(instance_index) instanceIndex : u32,\n  @builtin(vertex_index) vertexIndex : u32,\n  @location(0) positions: vec3<f32>,\n  @location(1) instancePositions: vec3<f32>,\n  @location(2) instancePositions64Low: vec3<f32>,\n  @location(3) instanceNormals: vec3<f32>,\n  @location(4) instanceColors: vec4<f32>,\n  @location(5) instancePickingColors: vec3<f32>\n};\n\nstruct Varyings {\n  @builtin(position) position: vec4<f32>,\n  @location(0) vColor: vec4<f32>,\n  @location(1) unitPosition: vec2<f32>,\n};\n\n@vertex\nfn vertexMain(attributes: Attributes) -> Varyings {\n  var varyings: Varyings;\n  \n  // var geometry: Geometry;\n  // geometry.worldPosition = instancePositions;\n  // geometry.normal = project_normal(instanceNormals);\n\n  // position on the containing square in [-1, 1] space\n  varyings.unitPosition = attributes.positions.xy;\n  geometry.uv = varyings.unitPosition;\n  geometry.pickingColor = attributes.instancePickingColors;\n\n  // Find the center of the point and add the current vertex\n  let offset = vec3<f32>(attributes.positions.xy * project_unit_size_to_pixel(pointCloud.radiusPixels, pointCloud.sizeUnits), 0.0);\n  // DECKGL_FILTER_SIZE(offset, geometry);\n\n  varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);\n  // DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  let clipPixels = project_pixel_size_to_clipspace(offset.xy);\n  varyings.position.x += clipPixels.x;\n  varyings.position.y += clipPixels.y;\n\n  // Apply lighting\n  let lightColor = lighting_getLightColor2(attributes.instanceColors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);\n\n  // Apply opacity to instance color, or return instance picking color\n  varyings.vColor = vec4(lightColor, attributes.instanceColors.a * color.opacity);\n  // DECKGL_FILTER_COLOR(vColor, geometry);\n\n  return varyings;\n}\n\n@fragment\nfn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {\n  // var geometry: Geometry;\n  // geometry.uv = unitPosition.xy;\n\n  let distToCenter = length(varyings.unitPosition);\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  var fragColor: vec4<f32>;\n\n  fragColor = varyings.vColor;\n  // DECKGL_FILTER_COLOR(fragColor, geometry);\n\n  // Apply premultiplied alpha as required by transparent canvas\n  fragColor = deckgl_premultiplied_alpha(fragColor);\n\n  return fragColor;\n}\n`;var _ee=[0,0,0,255],yee=[0,0,1],v3e={sizeUnits:\"pixels\",pointSize:{type:\"number\",min:0,value:10},getPosition:{type:\"accessor\",value:t=>t.position},getNormal:{type:\"accessor\",value:yee},getColor:{type:\"accessor\",value:_ee},material:!0,radiusPixels:{deprecatedFor:\"pointSize\"}};function b3e(t){let{header:e,attributes:n}=t;if(!(!e||!n)&&(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0)){let{size:r,value:i}=n.COLOR_0;n.instanceColors={size:r,type:\"unorm8\",value:i}}}var t3=class extends hi{getShaders(){return super.getShaders({vs:Aee,fs:gee,source:mee,modules:[Lr,PA,Pp,$i,pee]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),transition:!0,accessor:\"getPosition\"},instanceNormals:{size:3,transition:!0,accessor:\"getNormal\",defaultValue:yee},instanceColors:{size:this.props.colorFormat.length,type:\"unorm8\",transition:!0,accessor:\"getColor\",defaultValue:_ee}})}updateState(e){let{changeFlags:n,props:r}=e;super.updateState(e),n.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll()),n.dataChanged&&b3e(r.data)}draw({uniforms:e}){let{pointSize:n,sizeUnits:r}=this.props,i=this.state.model,o={sizeUnits:so[r],radiusPixels:n};i.shaderInputs.setProps({pointCloud:o}),this.context.device.type===\"webgpu\"&&(i.instanceCount=this.props.data.length),i.draw(this.context.renderPass)}_getModel(){let e=this.context.device.type===\"webgpu\"?{depthWriteEnabled:!0,depthCompare:\"less-equal\"}:void 0,n=[];for(let r=0;r<3;r++){let i=r/3*Math.PI*2;n.push(Math.cos(i)*2,Math.sin(i)*2,0)}return new gr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new gi({topology:\"triangle-list\",attributes:{positions:new Float32Array(n)}}),parameters:e,isInstanced:!0})}};t3.layerName=\"PointCloudLayer\";t3.defaultProps=v3e;var t2=t3;var xee=`uniform scatterplotUniforms {\n  float radiusScale;\n  float radiusMinPixels;\n  float radiusMaxPixels;\n  float lineWidthScale;\n  float lineWidthMinPixels;\n  float lineWidthMaxPixels;\n  float stroked;\n  float filled;\n  bool antialiasing;\n  bool billboard;\n  highp int radiusUnits;\n  highp int lineWidthUnits;\n} scatterplot;\n`,vee={name:\"scatterplot\",vs:xee,fs:xee,source:\"\",uniformTypes:{radiusScale:\"f32\",radiusMinPixels:\"f32\",radiusMaxPixels:\"f32\",lineWidthScale:\"f32\",lineWidthMinPixels:\"f32\",lineWidthMaxPixels:\"f32\",stroked:\"f32\",filled:\"f32\",antialiasing:\"f32\",billboard:\"f32\",radiusUnits:\"i32\",lineWidthUnits:\"i32\"}};var bee=`#version 300 es\n#define SHADER_NAME scatterplot-layer-vertex-shader\nin vec3 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceRadius;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout vec2 unitPosition;\nout float innerUnitRadius;\nout float outerRadiusPixels;\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\nouterRadiusPixels = clamp(\nproject_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),\nscatterplot.radiusMinPixels, scatterplot.radiusMaxPixels\n);\nfloat lineWidthPixels = clamp(\nproject_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),\nscatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels\n);\nouterRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;\nfloat edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\nunitPosition = edgePadding * positions.xy;\ngeometry.uv = unitPosition;\ngeometry.pickingColor = instancePickingColors;\ninnerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;\nif (scatterplot.billboard) {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = edgePadding * positions * outerRadiusPixels;\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n`;var wee=`#version 300 es\n#define SHADER_NAME scatterplot-layer-fragment-shader\nprecision highp float;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin vec2 unitPosition;\nin float innerUnitRadius;\nin float outerRadiusPixels;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = unitPosition;\nfloat distToCenter = length(unitPosition) * outerRadiusPixels;\nfloat inCircle = scatterplot.antialiasing ?\nsmoothedge(distToCenter, outerRadiusPixels) :\nstep(distToCenter, outerRadiusPixels);\nif (inCircle == 0.0) {\ndiscard;\n}\nif (scatterplot.stroked > 0.5) {\nfloat isLine = scatterplot.antialiasing ?\nsmoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\nstep(innerUnitRadius * outerRadiusPixels, distToCenter);\nif (scatterplot.filled > 0.5) {\nfragColor = mix(vFillColor, vLineColor, isLine);\n} else {\nif (isLine == 0.0) {\ndiscard;\n}\nfragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n}\n} else if (scatterplot.filled < 0.5) {\ndiscard;\n} else {\nfragColor = vFillColor;\n}\nfragColor.a *= inCircle;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var Tee=`// Main shaders\n\nstruct ScatterplotUniforms {\n  radiusScale: f32,\n  radiusMinPixels: f32,\n  radiusMaxPixels: f32,\n  lineWidthScale: f32,\n  lineWidthMinPixels: f32,\n  lineWidthMaxPixels: f32,\n  stroked: f32,\n  filled: i32,\n  antialiasing: i32,\n  billboard: i32,\n  radiusUnits: i32,\n  lineWidthUnits: i32,\n};\n\nstruct ConstantAttributeUniforms {\n instancePositions: vec3<f32>,\n instancePositions64Low: vec3<f32>,\n instanceRadius: f32,\n instanceLineWidths: f32,\n instanceFillColors: vec4<f32>,\n instanceLineColors: vec4<f32>,\n instancePickingColors: vec3<f32>,\n\n instancePositionsConstant: i32,\n instancePositions64LowConstant: i32,\n instanceRadiusConstant: i32,\n instanceLineWidthsConstant: i32,\n instanceFillColorsConstant: i32,\n instanceLineColorsConstant: i32,\n instancePickingColorsConstant: i32\n};\n\n@group(0) @binding(2) var<uniform> scatterplot: ScatterplotUniforms;\n\nstruct ConstantAttributes {\n  instancePositions: vec3<f32>,\n  instancePositions64Low: vec3<f32>,\n  instanceRadius: f32,\n  instanceLineWidths: f32,\n  instanceFillColors: vec4<f32>,\n  instanceLineColors: vec4<f32>,\n  instancePickingColors: vec3<f32>\n};\n\nconst constants = ConstantAttributes(\n  vec3<f32>(0.0),\n  vec3<f32>(0.0),\n  0.0,\n  0.0,\n  vec4<f32>(0.0, 0.0, 0.0, 1.0),\n  vec4<f32>(0.0, 0.0, 0.0, 1.0),\n  vec3<f32>(0.0)\n);\n\nstruct Attributes {\n  @builtin(instance_index) instanceIndex : u32,\n  @builtin(vertex_index) vertexIndex : u32,\n  @location(0) positions: vec3<f32>,\n  @location(1) instancePositions: vec3<f32>,\n  @location(2) instancePositions64Low: vec3<f32>,\n  @location(3) instanceRadius: f32,\n  @location(4) instanceLineWidths: f32,\n  @location(5) instanceFillColors: vec4<f32>,\n  @location(6) instanceLineColors: vec4<f32>,\n  @location(7) instancePickingColors: vec3<f32>\n};\n\nstruct Varyings {\n  @builtin(position) position: vec4<f32>,\n  @location(0) vFillColor: vec4<f32>,\n  @location(1) vLineColor: vec4<f32>,\n  @location(2) unitPosition: vec2<f32>,\n  @location(3) innerUnitRadius: f32,\n  @location(4) outerRadiusPixels: f32,\n};\n\n@vertex\nfn vertexMain(attributes: Attributes) -> Varyings {\n  var varyings: Varyings;\n\n  // Draw an inline geometry constant array clip space triangle to verify that rendering works.\n  // var positions = array<vec2<f32>, 3>(vec2(0.0, 0.5), vec2(-0.5, -0.5), vec2(0.5, -0.5));\n  // if (attributes.instanceIndex == 0) {\n  //   varyings.position = vec4<f32>(positions[attributes.vertexIndex], 0.0, 1.0);\n  //   return varyings;\n  // }\n\n  // var geometry: Geometry;\n  // geometry.worldPosition = instancePositions;\n\n  // Multiply out radius and clamp to limits\n  varyings.outerRadiusPixels = clamp(\n    project_unit_size_to_pixel(scatterplot.radiusScale * attributes.instanceRadius, scatterplot.radiusUnits),\n    scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels\n  );\n\n  // Multiply out line width and clamp to limits\n  let lineWidthPixels = clamp(\n    project_unit_size_to_pixel(scatterplot.lineWidthScale * attributes.instanceLineWidths, scatterplot.lineWidthUnits),\n    scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels\n  );\n\n  // outer radius needs to offset by half stroke width\n  varyings.outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;\n  // Expand geometry to accommodate edge smoothing\n  let edgePadding = select(\n    (varyings.outerRadiusPixels + SMOOTH_EDGE_RADIUS) / varyings.outerRadiusPixels,\n    1.0,\n    scatterplot.antialiasing != 0\n  );\n\n  // position on the containing square in [-1, 1] space\n  varyings.unitPosition = edgePadding * attributes.positions.xy;\n  geometry.uv = varyings.unitPosition;\n  geometry.pickingColor = attributes.instancePickingColors;\n\n  varyings.innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / varyings.outerRadiusPixels;\n\n  if (scatterplot.billboard != 0) {\n    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);\n    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);\n    let offset = attributes.positions; // * edgePadding * varyings.outerRadiusPixels;\n    // DECKGL_FILTER_SIZE(offset, geometry);\n    let clipPixels = project_pixel_size_to_clipspace(offset.xy);\n    varyings.position.x = clipPixels.x;\n    varyings.position.y = clipPixels.y;\n  } else {\n    let offset = edgePadding * attributes.positions * project_pixel_size_float(varyings.outerRadiusPixels);\n    // DECKGL_FILTER_SIZE(offset, geometry);\n    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, offset); // TODO , geometry.position);\n    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);\n  }\n\n  // Apply opacity to instance color, or return instance picking color\n  varyings.vFillColor = vec4<f32>(attributes.instanceFillColors.rgb, attributes.instanceFillColors.a * color.opacity);\n  // DECKGL_FILTER_COLOR(varyings.vFillColor, geometry);\n  varyings.vLineColor = vec4<f32>(attributes.instanceLineColors.rgb, attributes.instanceLineColors.a * color.opacity);\n  // DECKGL_FILTER_COLOR(varyings.vLineColor, geometry);\n\n  return varyings;\n}\n\n@fragment\nfn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {\n  // var geometry: Geometry;\n  // geometry.uv = unitPosition;\n\n  let distToCenter = length(varyings.unitPosition) * varyings.outerRadiusPixels;\n  let inCircle = select(\n    smoothedge(distToCenter, varyings.outerRadiusPixels),\n    step(distToCenter, varyings.outerRadiusPixels),\n    scatterplot.antialiasing != 0\n  );\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  var fragColor: vec4<f32>;\n\n  if (scatterplot.stroked != 0) {\n    let isLine = select(\n      smoothedge(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),\n      step(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),\n      scatterplot.antialiasing != 0\n    );\n\n    if (scatterplot.filled != 0) {\n      fragColor = mix(varyings.vFillColor, varyings.vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      fragColor = vec4<f32>(varyings.vLineColor.rgb, varyings.vLineColor.a * isLine);\n    }\n  } else if (scatterplot.filled == 0) {\n    discard;\n  } else {\n    fragColor = varyings.vFillColor;\n  }\n\n  fragColor.a *= inCircle;\n  // DECKGL_FILTER_COLOR(fragColor, geometry);\n\n  // Apply premultiplied alpha as required by transparent canvas\n  fragColor = deckgl_premultiplied_alpha(fragColor);\n\n  return fragColor;\n  // return vec4<f32>(0, 0, 1, 1);\n}\n`;var Eee=[0,0,0,255],w3e={radiusUnits:\"meters\",radiusScale:{type:\"number\",min:0,value:1},radiusMinPixels:{type:\"number\",min:0,value:0},radiusMaxPixels:{type:\"number\",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:\"meters\",lineWidthScale:{type:\"number\",min:0,value:1},lineWidthMinPixels:{type:\"number\",min:0,value:0},lineWidthMaxPixels:{type:\"number\",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:\"accessor\",value:t=>t.position},getRadius:{type:\"accessor\",value:1},getFillColor:{type:\"accessor\",value:Eee},getLineColor:{type:\"accessor\",value:Eee},getLineWidth:{type:\"accessor\",value:1},strokeWidth:{deprecatedFor:\"getLineWidth\"},outline:{deprecatedFor:\"stroked\"},getColor:{deprecatedFor:[\"getFillColor\",\"getLineColor\"]}},n3=class extends hi{getShaders(){return super.getShaders({vs:bee,fs:wee,source:Tee,modules:[Lr,PA,$i,vee]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),transition:!0,accessor:\"getPosition\"},instanceRadius:{size:1,transition:!0,accessor:\"getRadius\",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:\"unorm8\",accessor:\"getFillColor\",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:\"unorm8\",accessor:\"getLineColor\",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:\"getLineWidth\",defaultValue:1}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){let{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,stroked:s,filled:c,billboard:d,antialiasing:m,lineWidthUnits:b,lineWidthScale:C,lineWidthMinPixels:B,lineWidthMaxPixels:k}=this.props,V={stroked:s,filled:c,billboard:d,antialiasing:m,radiusUnits:so[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,lineWidthUnits:so[b],lineWidthScale:C,lineWidthMinPixels:B,lineWidthMaxPixels:k},q=this.state.model;q.shaderInputs.setProps({scatterplot:V}),this.context.device.type===\"webgpu\"&&(q.instanceCount=this.props.data.length),q.draw(this.context.renderPass)}_getModel(){let e=this.context.device.type===\"webgpu\"?{depthWriteEnabled:!0,depthCompare:\"less-equal\"}:void 0,n=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new gr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new gi({topology:\"triangle-strip\",attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0,parameters:e})}};n3.defaultProps=w3e;n3.layerName=\"ScatterplotLayer\";var n2=n3;var r2={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function t_(t,e,n={}){return See(t,n)!==e?(T3e(t,n),!0):!1}function See(t,e={}){return Math.sign(HA(t,e))}var r3={x:0,y:1,z:2};function HA(t,e={}){let{start:n=0,end:r=t.length,plane:i=\"xy\"}=e,o=e.size||2,s=0,c=r3[i[0]],d=r3[i[1]];for(let m=n,b=r-o;m<r;m+=o)s+=(t[m+c]-t[b+c])*(t[m+d]+t[b+d]),b=m;return s/2}function T3e(t,e){let{start:n=0,end:r=t.length,size:i=2}=e,o=(r-n)/i,s=Math.floor(o/2);for(let c=0;c<s;++c){let d=n+c*i,m=n+(o-1-c)*i;for(let b=0;b<i;++b){let C=t[d+b];t[d+b]=t[m+b],t[m+b]=C}}}function Mk(t,e,n=2,r,i=\"xy\"){let o=e&&e.length,s=o?e[0]*n:t.length,c=Mee(t,0,s,n,!0,r&&r[0],i),d=[];if(!c||c.next===c.prev)return d;let m,b,C,B,k,V,q;if(o&&(c=P3e(t,e,c,n,r,i)),t.length>80*n){B=b=t[0],k=C=t[1];for(let K=n;K<s;K+=n)V=t[K],q=t[K+1],V<B&&(B=V),q<k&&(k=q),V>b&&(b=V),q>C&&(C=q);m=Math.max(b-B,C-k),m=m!==0?32767/m:0}return i3(c,d,n,B,k,m,0),d}function Mee(t,e,n,r,i,o,s){let c,d;o===void 0&&(o=HA(t,{start:e,end:n,size:r,plane:s}));let m=r3[s[0]],b=r3[s[1]];if(i===o<0)for(c=e;c<n;c+=r)d=Cee(c,t[c+m],t[c+b],d);else for(c=n-r;c>=e;c-=r)d=Cee(c,t[c+m],t[c+b],d);return d&&lI(d,d.next)&&(s3(d),d=d.next),d}function n_(t,e){if(!t)return t;e||(e=t);let n=t,r;do if(r=!1,!n.steiner&&(lI(n,n.next)||Xo(n.prev,n,n.next)===0)){if(s3(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function i3(t,e,n,r,i,o,s){if(!t)return;!s&&o&&O3e(t,r,i,o);let c=t,d,m;for(;t.prev!==t.next;){if(d=t.prev,m=t.next,o?C3e(t,r,i,o):S3e(t)){e.push(d.i/n|0),e.push(t.i/n|0),e.push(m.i/n|0),s3(t),t=m.next,c=m.next;continue}if(t=m,t===c){s?s===1?(t=M3e(n_(t),e,n),i3(t,e,n,r,i,o,2)):s===2&&I3e(t,e,n,r,i,o):i3(n_(t),e,n,r,i,o,1);break}}}function S3e(t){let e=t.prev,n=t,r=t.next;if(Xo(e,n,r)>=0)return!1;let i=e.x,o=n.x,s=r.x,c=e.y,d=n.y,m=r.y,b=i<o?i<s?i:s:o<s?o:s,C=c<d?c<m?c:m:d<m?d:m,B=i>o?i>s?i:s:o>s?o:s,k=c>d?c>m?c:m:d>m?d:m,V=r.next;for(;V!==e;){if(V.x>=b&&V.x<=B&&V.y>=C&&V.y<=k&&i2(i,c,o,d,s,m,V.x,V.y)&&Xo(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function C3e(t,e,n,r){let i=t.prev,o=t,s=t.next;if(Xo(i,o,s)>=0)return!1;let c=i.x,d=o.x,m=s.x,b=i.y,C=o.y,B=s.y,k=c<d?c<m?c:m:d<m?d:m,V=b<C?b<B?b:B:C<B?C:B,q=c>d?c>m?c:m:d>m?d:m,K=b>C?b>B?b:B:C>B?C:B,Y=Ck(k,V,e,n,r),ee=Ck(q,K,e,n,r),J=t.prevZ,se=t.nextZ;for(;J&&J.z>=Y&&se&&se.z<=ee;){if(J.x>=k&&J.x<=q&&J.y>=V&&J.y<=K&&J!==i&&J!==s&&i2(c,b,d,C,m,B,J.x,J.y)&&Xo(J.prev,J,J.next)>=0||(J=J.prevZ,se.x>=k&&se.x<=q&&se.y>=V&&se.y<=K&&se!==i&&se!==s&&i2(c,b,d,C,m,B,se.x,se.y)&&Xo(se.prev,se,se.next)>=0))return!1;se=se.nextZ}for(;J&&J.z>=Y;){if(J.x>=k&&J.x<=q&&J.y>=V&&J.y<=K&&J!==i&&J!==s&&i2(c,b,d,C,m,B,J.x,J.y)&&Xo(J.prev,J,J.next)>=0)return!1;J=J.prevZ}for(;se&&se.z<=ee;){if(se.x>=k&&se.x<=q&&se.y>=V&&se.y<=K&&se!==i&&se!==s&&i2(c,b,d,C,m,B,se.x,se.y)&&Xo(se.prev,se,se.next)>=0)return!1;se=se.nextZ}return!0}function M3e(t,e,n){let r=t;do{let i=r.prev,o=r.next.next;!lI(i,o)&&Iee(i,r,r.next,o)&&o3(i,o)&&o3(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),s3(r),s3(r.next),r=t=o),r=r.next}while(r!==t);return n_(r)}function I3e(t,e,n,r,i,o){let s=t;do{let c=s.next.next;for(;c!==s.prev;){if(s.i!==c.i&&N3e(s,c)){let d=Pee(s,c);s=n_(s,s.next),d=n_(d,d.next),i3(s,e,n,r,i,o,0),i3(d,e,n,r,i,o,0);return}c=c.next}s=s.next}while(s!==t)}function P3e(t,e,n,r,i,o){let s=[],c,d,m,b,C;for(c=0,d=e.length;c<d;c++)m=e[c]*r,b=c<d-1?e[c+1]*r:t.length,C=Mee(t,m,b,r,!1,i&&i[c+1],o),C===C.next&&(C.steiner=!0),s.push(k3e(C));for(s.sort(R3e),c=0;c<s.length;c++)n=B3e(s[c],n);return n}function R3e(t,e){return t.x-e.x}function B3e(t,e){let n=D3e(t,e);if(!n)return e;let r=Pee(n,t);return n_(r,r.next),n_(n,n.next)}function D3e(t,e){let n=e,r=t.x,i=t.y,o=-1/0,s;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){let B=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(B<=r&&B>o&&(o=B,s=n.x<n.next.x?n:n.next,B===r))return s}n=n.next}while(n!==e);if(!s)return null;let c=s,d=s.x,m=s.y,b=1/0,C;n=s;do r>=n.x&&n.x>=d&&r!==n.x&&i2(i<m?r:o,i,d,m,i<m?o:r,i,n.x,n.y)&&(C=Math.abs(i-n.y)/(r-n.x),o3(n,t)&&(C<b||C===b&&(n.x>s.x||n.x===s.x&&L3e(s,n)))&&(s=n,b=C)),n=n.next;while(n!==c);return s}function L3e(t,e){return Xo(t.prev,t,e.prev)<0&&Xo(e.next,t,t.next)<0}function O3e(t,e,n,r){let i=t;do i.z===0&&(i.z=Ck(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,F3e(i)}function F3e(t){let e,n,r=1,i,o,s,c,d,m;do{for(o=t,t=null,m=null,i=0;o;){for(i++,c=o,s=0,n=0;n<r&&(s++,c=c.nextZ,!!c);n++);for(d=r;s>0||d>0&&c;)s!==0&&(d===0||!c||o.z<=c.z)?(e=o,o=o.nextZ,s--):(e=c,c=c.nextZ,d--),m?m.nextZ=e:t=e,e.prevZ=m,m=e;o=c}m.nextZ=null,r*=2}while(i>1);return t}function Ck(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function k3e(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function i2(t,e,n,r,i,o,s,c){return(i-s)*(e-c)>=(t-s)*(o-c)&&(t-s)*(r-c)>=(n-s)*(e-c)&&(n-s)*(o-c)>=(i-s)*(r-c)}function N3e(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!z3e(t,e)&&(o3(t,e)&&o3(e,t)&&U3e(t,e)&&(Xo(t.prev,t,e.prev)||Xo(t,e.prev,e))||lI(t,e)&&Xo(t.prev,t,t.next)>0&&Xo(e.prev,e,e.next)>0)}function Xo(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function lI(t,e){return t.x===e.x&&t.y===e.y}function Iee(t,e,n,r){let i=aI(Xo(t,e,n)),o=aI(Xo(t,e,r)),s=aI(Xo(n,r,t)),c=aI(Xo(n,r,e));return!!(i!==o&&s!==c||i===0&&sI(t,n,e)||o===0&&sI(t,r,e)||s===0&&sI(n,t,r)||c===0&&sI(n,e,r))}function sI(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function aI(t){return t>0?1:t<0?-1:0}function z3e(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Iee(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function o3(t,e){return Xo(t.prev,t,t.next)<0?Xo(t,e,t.next)>=0&&Xo(t,t.prev,e)>=0:Xo(t,e,t.prev)<0||Xo(t,t.next,e)<0}function U3e(t,e){let n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function Pee(t,e){let n=new a3(t.i,t.x,t.y),r=new a3(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Cee(t,e,n,r){let i=new a3(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function s3(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}var a3=class{constructor(e,n,r){this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1,this.i=e,this.x=n,this.y=r}};function wc(t,e){let n=e.length,r=t.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function l3(t,e){let n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function WA(t,e,n,r,i=[]){let o=r+e*n;for(let s=0;s<n;s++)i[s]=t[o+s];return i}function cI(t,e,n,r,i=[]){let o,s;if(n&8)o=(r[3]-t[1])/(e[1]-t[1]),s=3;else if(n&4)o=(r[1]-t[1])/(e[1]-t[1]),s=1;else if(n&2)o=(r[2]-t[0])/(e[0]-t[0]),s=2;else if(n&1)o=(r[0]-t[0])/(e[0]-t[0]),s=0;else return null;for(let c=0;c<t.length;c++)i[c]=(s&1)===c?r[s]:o*(e[c]-t[c])+t[c];return i}function c3(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function u3(t,e){let{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:c=t.length}=e||{},d=(c-s)/n,m=[],b=[m],C=WA(t,0,n,s),B,k,V=Dee(C,i,o,[]),q=[];wc(m,C);for(let K=1;K<d;K++){for(B=WA(t,K,n,s,B),k=c3(B,V);k;){cI(C,B,k,V,q);let Y=c3(q,V);Y&&(cI(C,q,Y,V,q),k=Y),wc(m,q),l3(C,q),G3e(V,i,k),r&&m.length>n&&(m=[],b.push(m),wc(m,C)),k=c3(B,V)}wc(m,B),l3(C,B)}return r?b:b[0]}var Ree=0,V3e=1;function h3(t,e=null,n){if(!t.length)return[];let{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n||{},c=[],d=[{pos:t,types:s?new Array(t.length/r).fill(V3e):null,holes:e||[]}],m=[[],[]],b=[];for(;d.length;){let{pos:C,types:B,holes:k}=d.shift();H3e(C,r,k[0]||C.length,m),b=Dee(m[0],i,o,b);let V=c3(m[1],b);if(V){let q=Bee(C,B,r,0,k[0]||C.length,b,V),K={pos:q[0].pos,types:q[0].types,holes:[]},Y={pos:q[1].pos,types:q[1].types,holes:[]};d.push(K,Y);for(let ee=0;ee<k.length;ee++)q=Bee(C,B,r,k[ee],k[ee+1]||C.length,b,V),q[0]&&(K.holes.push(K.pos.length),K.pos=uI(K.pos,q[0].pos),s&&(K.types=uI(K.types,q[0].types))),q[1]&&(Y.holes.push(Y.pos.length),Y.pos=uI(Y.pos,q[1].pos),s&&(Y.types=uI(Y.types,q[1].types)))}else{let q={positions:C};s&&(q.edgeTypes=B),k.length&&(q.holeIndices=k),c.push(q)}}return c}function Bee(t,e,n,r,i,o,s){let c=(i-r)/n,d=[],m=[],b=[],C=[],B=[],k,V,q,K=WA(t,c-1,n,r),Y=Math.sign(s&8?K[1]-o[3]:K[0]-o[2]),ee=e&&e[c-1],J=0,se=0;for(let xe=0;xe<c;xe++)k=WA(t,xe,n,r,k),V=Math.sign(s&8?k[1]-o[3]:k[0]-o[2]),q=e&&e[r/n+xe],V&&Y&&Y!==V&&(cI(K,k,s,o,B),wc(d,B)&&b.push(ee),wc(m,B)&&C.push(ee)),V<=0?(wc(d,k)&&b.push(q),J-=V):b.length&&(b[b.length-1]=Ree),V>=0?(wc(m,k)&&C.push(q),se+=V):C.length&&(C[C.length-1]=Ree),l3(K,k),Y=V,ee=q;return[J?{pos:d,types:e&&b}:null,se?{pos:m,types:e&&C}:null]}function Dee(t,e,n,r){let i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function G3e(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function H3e(t,e,n,r){let i=1/0,o=-1/0,s=1/0,c=-1/0;for(let d=0;d<n;d+=e){let m=t[d],b=t[d+1];i=m<i?m:i,o=m>o?m:o,s=b<s?b:s,c=b>c?b:c}return r[0][0]=i,r[0][1]=s,r[1][0]=o,r[1][1]=c,r}function uI(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}var W3e=85.051129;function Ik(t,e){let{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:o=!0}=e||{},s=t.slice(r,i);Lee(s,n,0,i-r);let c=u3(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(let d of c)Oee(d,n);return c}function Pk(t,e=null,n){let{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n||{};e=e||[];let s=[],c=[],d=0,m=0;for(let C=0;C<=e.length;C++){let B=e[C]||t.length,k=m,V=j3e(t,r,d,B);for(let q=V;q<B;q++)s[m++]=t[q];for(let q=d;q<V;q++)s[m++]=t[q];Lee(s,r,k,m),X3e(s,r,k,m,n?.maxLatitude),d=B,c[C]=m}c.pop();let b=h3(s,c,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(let C of b)Oee(C.positions,r);return b}function j3e(t,e,n,r){let i=-1,o=-1;for(let s=n+1;s<r;s+=e){let c=Math.abs(t[s]);c>i&&(i=c,o=s-1)}return o}function X3e(t,e,n,r,i=W3e){let o=t[n],s=t[r-e];if(Math.abs(o-s)>180){let c=WA(t,0,e,n);c[0]+=Math.round((s-o)/360)*360,wc(t,c),c[1]=Math.sign(c[1])*i,wc(t,c),c[0]=o,wc(t,c)}}function Lee(t,e,n,r){let i=t[0],o;for(let s=n;s<r;s+=e){o=t[s];let c=o-i;(c>180||c<-180)&&(o-=Math.round(c/360)*360),t[s]=i=o}}function Oee(t,e){let n,r=t.length/e;for(let o=0;o<r&&(n=t[o*e],(n+180)%360===0);o++);let i=-Math.round(n/360)*360;if(i!==0)for(let o=0;o<r;o++)t[o*e]+=i}var f3=class extends gi{constructor(e){let{indices:n,attributes:r}=Z3e(e);super({...e,indices:n,attributes:r})}};function Z3e(t){let{radius:e,height:n=1,nradial:r=10}=t,{vertices:i}=t;i&&(hn.assert(i.length>=r),i=i.flatMap(k=>[k[0],k[1]]),t_(i,r2.COUNTER_CLOCKWISE));let o=n>0,s=r+1,c=o?s*3+1:r,d=Math.PI*2/r,m=new Uint16Array(o?r*3*2:0),b=new Float32Array(c*3),C=new Float32Array(c*3),B=0;if(o){for(let k=0;k<s;k++){let V=k*d,q=k%r,K=Math.sin(V),Y=Math.cos(V);for(let ee=0;ee<2;ee++)b[B+0]=i?i[q*2]:Y*e,b[B+1]=i?i[q*2+1]:K*e,b[B+2]=(1/2-ee)*n,C[B+0]=i?i[q*2]:Y,C[B+1]=i?i[q*2+1]:K,B+=3}b[B+0]=b[B-3],b[B+1]=b[B-2],b[B+2]=b[B-1],B+=3}for(let k=o?0:1;k<s;k++){let V=Math.floor(k/2)*Math.sign(.5-k%2),q=V*d,K=(V+r)%r,Y=Math.sin(q),ee=Math.cos(q);b[B+0]=i?i[K*2]:ee*e,b[B+1]=i?i[K*2+1]:Y*e,b[B+2]=n/2,C[B+2]=1,B+=3}if(o){let k=0;for(let V=0;V<r;V++)m[k++]=V*2+0,m[k++]=V*2+2,m[k++]=V*2+0,m[k++]=V*2+1,m[k++]=V*2+1,m[k++]=V*2+3}return{indices:m,attributes:{POSITION:{size:3,value:b},NORMAL:{size:3,value:C}}}}var Fee=`uniform columnUniforms {\n  float radius;\n  float angle;\n  vec2 offset;\n  bool extruded;\n  bool stroked;\n  bool isStroke;\n  float coverage;\n  float elevationScale;\n  float edgeDistance;\n  float widthScale;\n  float widthMinPixels;\n  float widthMaxPixels;\n  highp int radiusUnits;\n  highp int widthUnits;\n} column;\n`,kee={name:\"column\",vs:Fee,fs:Fee,uniformTypes:{radius:\"f32\",angle:\"f32\",offset:\"vec2<f32>\",extruded:\"f32\",stroked:\"f32\",isStroke:\"f32\",coverage:\"f32\",elevationScale:\"f32\",edgeDistance:\"f32\",widthScale:\"f32\",widthMinPixels:\"f32\",widthMaxPixels:\"f32\",radiusUnits:\"i32\",widthUnits:\"i32\"}};var Nee=`#version 300 es\n#define SHADER_NAME column-layer-vertex-shader\nin vec3 positions;\nin vec3 normals;\nin vec3 instancePositions;\nin float instanceElevations;\nin vec3 instancePositions64Low;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin float instanceStrokeWidths;\nin vec3 instancePickingColors;\nout vec4 vColor;\n#ifdef FLAT_SHADING\nout vec3 cameraPosition;\nout vec4 position_commonspace;\n#endif\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\nvec4 color = column.isStroke ? instanceLineColors : instanceFillColors;\nmat2 rotationMatrix = mat2(cos(column.angle), sin(column.angle), -sin(column.angle), cos(column.angle));\nfloat elevation = 0.0;\nfloat strokeOffsetRatio = 1.0;\nif (column.extruded) {\nelevation = instanceElevations * (positions.z + 1.0) / 2.0 * column.elevationScale;\n} else if (column.stroked) {\nfloat widthPixels = clamp(\nproject_size_to_pixel(instanceStrokeWidths * column.widthScale, column.widthUnits),\ncolumn.widthMinPixels, column.widthMaxPixels) / 2.0;\nfloat halfOffset = project_pixel_size(widthPixels) / project_size(column.edgeDistance * column.coverage * column.radius);\nif (column.isStroke) {\nstrokeOffsetRatio -= sign(positions.z) * halfOffset;\n} else {\nstrokeOffsetRatio -= halfOffset;\n}\n}\nfloat shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\nfloat dotRadius = column.radius * column.coverage * shouldRender;\ngeometry.pickingColor = instancePickingColors;\nvec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\nvec3 centroidPosition64Low = instancePositions64Low;\nvec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + column.offset) * dotRadius;\nif (column.radiusUnits == UNIT_METERS) {\noffset = project_size(offset);\n}\nvec3 pos = vec3(offset, 0.);\nDECKGL_FILTER_SIZE(pos, geometry);\ngl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\ngeometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nif (column.extruded && !column.isStroke) {\n#ifdef FLAT_SHADING\ncameraPosition = project.cameraPosition;\nposition_commonspace = geometry.position;\nvColor = vec4(color.rgb, color.a * layer.opacity);\n#else\nvec3 lightColor = lighting_getLightColor(color.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);\nvColor = vec4(lightColor, color.a * layer.opacity);\n#endif\n} else {\nvColor = vec4(color.rgb, color.a * layer.opacity);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var zee=`#version 300 es\n#define SHADER_NAME column-layer-fragment-shader\nprecision highp float;\nout vec4 fragColor;\nin vec4 vColor;\n#ifdef FLAT_SHADING\nin vec3 cameraPosition;\nin vec4 position_commonspace;\n#endif\nvoid main(void) {\nfragColor = vColor;\ngeometry.uv = vec2(0.);\n#ifdef FLAT_SHADING\nif (column.extruded && !column.isStroke && !bool(picking.isActive)) {\nvec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\nfragColor.rgb = lighting_getLightColor(vColor.rgb, cameraPosition, position_commonspace.xyz, normal);\n}\n#endif\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var hI=[0,0,0,255],q3e={diskResolution:{type:\"number\",min:4,value:20},vertices:null,radius:{type:\"number\",min:0,value:1e3},angle:{type:\"number\",value:0},offset:{type:\"array\",value:[0,0]},coverage:{type:\"number\",min:0,max:1,value:1},elevationScale:{type:\"number\",min:0,value:1},radiusUnits:\"meters\",lineWidthUnits:\"meters\",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:\"accessor\",value:t=>t.position},getFillColor:{type:\"accessor\",value:hI},getLineColor:{type:\"accessor\",value:hI},getLineWidth:{type:\"accessor\",value:1},getElevation:{type:\"accessor\",value:1e3},material:!0,getColor:{deprecatedFor:[\"getFillColor\",\"getLineColor\"]}},d3=class extends hi{getShaders(){let e={},{flatShading:n}=this.props;return n&&(e.FLAT_SHADING=1),super.getShaders({vs:Nee,fs:zee,defines:e,modules:[Lr,n?Vm:Pp,$i,kee]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),transition:!0,accessor:\"getPosition\"},instanceElevations:{size:1,transition:!0,accessor:\"getElevation\"},instanceFillColors:{size:this.props.colorFormat.length,type:\"unorm8\",transition:!0,accessor:\"getFillColor\",defaultValue:hI},instanceLineColors:{size:this.props.colorFormat.length,type:\"unorm8\",transition:!0,accessor:\"getLineColor\",defaultValue:hI},instanceStrokeWidths:{size:1,accessor:\"getLineWidth\",transition:!0}})}updateState(e){super.updateState(e);let{props:n,oldProps:r,changeFlags:i}=e,o=i.extensionsChanged||n.flatShading!==r.flatShading;o&&(this.state.models?.forEach(c=>c.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());let s=this.getNumInstances();this.state.fillModel.setInstanceCount(s),this.state.wireframeModel.setInstanceCount(s),(o||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){let i=new f3({radius:1,height:r?2:0,vertices:n,nradial:e}),o=0;if(n)for(let s=0;s<e;s++){let c=n[s],d=Math.sqrt(c[0]*c[0]+c[1]*c[1]);o+=d/e}else o=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*o}),i}_getModels(){let e=this.getShaders(),n=this.getAttributeManager().getBufferLayouts(),r=new gr(this.context.device,{...e,id:`${this.props.id}-fill`,bufferLayout:n,isInstanced:!0}),i=new gr(this.context.device,{...e,id:`${this.props.id}-wireframe`,bufferLayout:n,isInstanced:!0});return{fillModel:r,wireframeModel:i,models:[i,r]}}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){let o=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:o.attributes.POSITION.value.length/3});let s=this.state.fillModel,c=this.state.wireframeModel;s.setGeometry(o),s.setTopology(\"triangle-strip\"),s.setIndexBuffer(null),c.setGeometry(o),c.setTopology(\"line-list\")}draw({uniforms:e}){let{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:o,radiusUnits:s,elevationScale:c,extruded:d,filled:m,stroked:b,wireframe:C,offset:B,coverage:k,radius:V,angle:q}=this.props,K=this.state.fillModel,Y=this.state.wireframeModel,{fillVertexCount:ee,edgeDistance:J}=this.state,se={radius:V,angle:q/180*Math.PI,offset:B,extruded:d,stroked:b,coverage:k,elevationScale:c,edgeDistance:J,radiusUnits:so[s],widthUnits:so[n],widthScale:r,widthMinPixels:i,widthMaxPixels:o};d&&C&&(Y.shaderInputs.setProps({column:{...se,isStroke:!0}}),Y.draw(this.context.renderPass)),m&&(K.setVertexCount(ee),K.shaderInputs.setProps({column:{...se,isStroke:!1}}),K.draw(this.context.renderPass)),!d&&b&&(K.setVertexCount(ee*2/3),K.shaderInputs.setProps({column:{...se,isStroke:!0}}),K.draw(this.context.renderPass))}};d3.layerName=\"ColumnLayer\";d3.defaultProps=q3e;var $u=d3;var Q3e={cellSize:{type:\"number\",min:0,value:1e3},offset:{type:\"array\",value:[1,1]}},p3=class extends $u{_updateGeometry(){let e=new Zm;this.state.fillModel.setGeometry(e)}draw({uniforms:e}){let{elevationScale:n,extruded:r,offset:i,coverage:o,cellSize:s,angle:c,radiusUnits:d}=this.props,m=this.state.fillModel,b={radius:s/2,radiusUnits:so[d],angle:c,offset:i,extruded:r,stroked:!1,coverage:o,elevationScale:n,edgeDistance:1,isStroke:!1,widthUnits:0,widthScale:0,widthMinPixels:0,widthMaxPixels:0};m.shaderInputs.setProps({column:b}),m.draw(this.context.renderPass)}};p3.layerName=\"GridCellLayer\";p3.defaultProps=Q3e;var fI=p3;function Uee(t,e,n,r){let i;if(Array.isArray(t[0])){let o=t.length*e;i=new Array(o);for(let s=0;s<t.length;s++)for(let c=0;c<e;c++)i[s*e+c]=t[s][c]||0}else i=t;return n?u3(i,{size:e,gridResolution:n}):r?Ik(i,{size:e}):i}var K3e=1,J3e=2,Rk=4,A3=class extends VA{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?Uee(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(Vee(e)){let r=0;for(let i of e)r+=this.getGeometrySize(i);return r}let n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&Vee(e))for(let r of e){let i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){let r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:o,geometrySize:s}=n;r.fill(0,o,o+s),i?(r[o]=Rk,r[o+s-2]=Rk):(r[o]+=K3e,r[o+s-2]+=J3e),r[o+s-1]=Rk}_updatePositions(e,n){let{positions:r}=this.attributes;if(!r||!e)return;let{vertexStart:i,geometrySize:o}=n,s=new Array(3);for(let c=i,d=0;d<o;c++,d++)this.getPointOnPath(e,d,s),r[c*3]=s[0],r[c*3+1]=s[1],r[c*3+2]=s[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){let{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);let o=n*i;return r[0]=e[o],r[1]=e[o+1],r[2]=i===3&&e[o+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;let{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}};function Vee(t){return Array.isArray(t[0])}var Gee=`uniform pathUniforms {\n  float widthScale;\n  float widthMinPixels;\n  float widthMaxPixels;\n  float jointType;\n  float capType;\n  float miterLimit;\n  bool billboard;\n  highp int widthUnits;\n} path;\n`,Hee={name:\"path\",vs:Gee,fs:Gee,uniformTypes:{widthScale:\"f32\",widthMinPixels:\"f32\",widthMaxPixels:\"f32\",jointType:\"f32\",capType:\"f32\",miterLimit:\"f32\",billboard:\"f32\",widthUnits:\"i32\"}};var Wee=`#version 300 es\n#define SHADER_NAME path-layer-vertex-shader\nin vec2 positions;\nin float instanceTypes;\nin vec3 instanceStartPositions;\nin vec3 instanceEndPositions;\nin vec3 instanceLeftPositions;\nin vec3 instanceRightPositions;\nin vec3 instanceLeftPositions64Low;\nin vec3 instanceStartPositions64Low;\nin vec3 instanceEndPositions64Low;\nin vec3 instanceRightPositions64Low;\nin float instanceStrokeWidths;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nuniform float opacity;\nout vec4 vColor;\nout vec2 vCornerOffset;\nout float vMiterLength;\nout vec2 vPathPosition;\nout float vPathLength;\nout float vJointType;\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\nfloat flipIfTrue(bool flag) {\nreturn -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\nvec3 prevPoint, vec3 currPoint, vec3 nextPoint,\nvec2 width\n) {\nbool isEnd = positions.x > 0.0;\nfloat sideOfPath = positions.y;\nfloat isJoint = float(sideOfPath == 0.0);\nvec3 deltaA3 = (currPoint - prevPoint);\nvec3 deltaB3 = (nextPoint - currPoint);\nmat3 rotationMatrix;\nbool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);\nif (needsRotation) {\ndeltaA3 = deltaA3 * rotationMatrix;\ndeltaB3 = deltaB3 * rotationMatrix;\n}\nvec2 deltaA = deltaA3.xy / width;\nvec2 deltaB = deltaB3.xy / width;\nfloat lenA = length(deltaA);\nfloat lenB = length(deltaB);\nvec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\nvec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\nvec2 perpA = vec2(-dirA.y, dirA.x);\nvec2 perpB = vec2(-dirB.y, dirB.x);\nvec2 tangent = dirA + dirB;\ntangent = length(tangent) > 0. ? normalize(tangent) : perpA;\nvec2 miterVec = vec2(-tangent.y, tangent.x);\nvec2 dir = isEnd ? dirA : dirB;\nvec2 perp = isEnd ? perpA : perpB;\nfloat L = isEnd ? lenA : lenB;\nfloat sinHalfA = abs(dot(miterVec, perp));\nfloat cosHalfA = abs(dot(dirA, miterVec));\nfloat turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\nfloat cornerPosition = sideOfPath * turnDirection;\nfloat miterSize = 1.0 / max(sinHalfA, EPSILON);\nmiterSize = mix(\nmin(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\nmiterSize,\nstep(0.0, cornerPosition)\n);\nvec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n* (sideOfPath + isJoint * turnDirection);\nbool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\nbool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\nbool isCap = isStartCap || isEndCap;\nif (isCap) {\noffsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);\nvJointType = path.capType;\n} else {\nvJointType = path.jointType;\n}\nvPathLength = L;\nvCornerOffset = offsetVec;\nvMiterLength = dot(vCornerOffset, miterVec * turnDirection);\nvMiterLength = isCap ? isJoint : vMiterLength;\nvec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\nvPathPosition = vec2(\ndot(offsetFromStartOfPath, perp),\ndot(offsetFromStartOfPath, dir)\n);\ngeometry.uv = vPathPosition;\nfloat isValid = step(instanceTypes, 3.5);\nvec3 offset = vec3(offsetVec * width * isValid, 0.0);\nif (needsRotation) {\noffset = rotationMatrix * offset;\n}\nreturn offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\nif (position.w < EPSILON) {\nfloat r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\nposition = refPosition + (position - refPosition) * r;\n}\n}\nvoid main() {\ngeometry.pickingColor = instancePickingColors;\nvColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);\nfloat isEnd = positions.x;\nvec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\nvec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\nvec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\nvec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\nvec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\nvec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\ngeometry.worldPosition = currPosition;\nvec2 widthPixels = vec2(clamp(\nproject_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),\npath.widthMinPixels, path.widthMaxPixels) / 2.0);\nvec3 width;\nif (path.billboard) {\nvec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\nvec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\nvec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\nclipLine(prevPositionScreen, currPositionScreen);\nclipLine(nextPositionScreen, currPositionScreen);\nclipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\nwidth = vec3(widthPixels, 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(\nprevPositionScreen.xyz / prevPositionScreen.w,\ncurrPositionScreen.xyz / currPositionScreen.w,\nnextPositionScreen.xyz / nextPositionScreen.w,\nproject_pixel_size_to_clipspace(width.xy)\n);\nDECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\ngl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n} else {\nprevPosition = project_position(prevPosition, prevPosition64Low);\ncurrPosition = project_position(currPosition, currPosition64Low);\nnextPosition = project_position(nextPosition, nextPosition64Low);\nwidth = vec3(project_pixel_size(widthPixels), 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\ngeometry.position = vec4(currPosition + offset, 1.0);\ngl_Position = project_common_position_to_clipspace(geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var jee=`#version 300 es\n#define SHADER_NAME path-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nin vec2 vCornerOffset;\nin float vMiterLength;\nin vec2 vPathPosition;\nin float vPathLength;\nin float vJointType;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = vPathPosition;\nif (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\nif (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\ndiscard;\n}\nif (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {\ndiscard;\n}\n}\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var Xee=[0,0,0,255],$3e={widthUnits:\"meters\",widthScale:{type:\"number\",min:0,value:1},widthMinPixels:{type:\"number\",min:0,value:0},widthMaxPixels:{type:\"number\",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:\"number\",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:\"accessor\",value:t=>t.path},getColor:{type:\"accessor\",value:Xee},getWidth:{type:\"accessor\",value:1},rounded:{deprecatedFor:[\"jointRounded\",\"capRounded\"]}},Bk={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t},g3=class extends hi{getShaders(){return super.getShaders({vs:Wee,fs:jee,modules:[Lr,$i,Hee]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds([\"vertexPositions\"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:\"float64\",fp64:this.use64bitPositions(),transition:Bk,accessor:\"getPath\",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:\"uint8\",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:\"getWidth\",transition:Bk,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:\"unorm8\",accessor:\"getColor\",transition:Bk,defaultValue:Xee},instancePickingColors:{size:4,type:\"uint8\",accessor:(r,{index:i,target:o})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,o)}}),this.setState({pathTesselator:new A3({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);let{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){let{pathTesselator:s}=this.state,c=n.data.attributes||{};s.updateGeometry({data:n.data,geometryBuffer:c.getPath,buffers:c,normalize:!n._pathType,loop:n._pathType===\"loop\",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||i.invalidateAll()}r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),i.invalidateAll())}getPickingInfo(e){let n=super.getPickingInfo(e),{index:r}=n,i=this.props.data;return i[0]&&i[0].__source&&(n.object=i.find(o=>o.__source.index===r)),n}disablePickingIndex(e){let n=this.props.data;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){let{jointRounded:n,capRounded:r,billboard:i,miterLimit:o,widthUnits:s,widthScale:c,widthMinPixels:d,widthMaxPixels:m}=this.props,b=this.state.model,C={jointType:Number(n),capType:Number(r),billboard:i,widthUnits:so[s],widthScale:c,miterLimit:o,widthMinPixels:d,widthMaxPixels:m};b.shaderInputs.setProps({path:C}),b.draw(this.context.renderPass)}_getModel(){let e=[0,1,2,1,4,2,1,3,4,3,5,4],n=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new gr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new gi({topology:\"triangle-list\",attributes:{indices:new Uint16Array(e),positions:{value:new Float32Array(n),size:2}}}),isInstanced:!0})}calculatePositions(e){let{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get(\"positions\")}calculateSegmentTypes(e){let{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get(\"segmentTypes\")}};g3.defaultProps=$3e;g3.layerName=\"PathLayer\";var eh=g3;var nte=xr(Kee(),1);var mI=r2.CLOCKWISE,Jee=r2.COUNTER_CLOCKWISE,jA={isClosed:!0};function ATe(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error(\"invalid polygon\")}function s2(t){return\"positions\"in t?t.positions:t}function x3(t){return\"holeIndices\"in t?t.holeIndices:null}function gTe(t){return Array.isArray(t[0])}function mTe(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function _Te(t){let e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function yTe(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function $ee(t,e,n,r,i){let o=e,s=n.length;for(let c=0;c<s;c++)for(let d=0;d<r;d++)t[o++]=n[c][d]||0;if(!_Te(n))for(let c=0;c<r;c++)t[o++]=n[0][c]||0;return jA.start=e,jA.end=o,jA.size=r,t_(t,i,jA),o}function ete(t,e,n,r,i=0,o,s){o=o||n.length;let c=o-i;if(c<=0)return e;let d=e;for(let m=0;m<c;m++)t[d++]=n[i+m];if(!yTe(n,r,i,o))for(let m=0;m<r;m++)t[d++]=n[i+m];return jA.start=e,jA.end=d,jA.size=r,t_(t,s,jA),d}function _I(t,e){ATe(t);let n=[],r=[];if(\"positions\"in t){let{positions:i,holeIndices:o}=t;if(o){let s=0;for(let c=0;c<=o.length;c++)s=ete(n,s,i,e,o[c-1],o[c],c===0?mI:Jee),r.push(s);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!gTe(t))return ete(n,0,t,e,0,n.length,mI),n;if(!mTe(t)){let i=0;for(let[o,s]of t.entries())i=$ee(n,i,s,e,o===0?mI:Jee),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return $ee(n,0,t,e,mI),n}function kk(t,e,n){let r=t.length/3,i=0;for(let o=0;o<r;o++){let s=(o+1)%r;i+=t[o*3+e]*t[s*3+n],i-=t[s*3+e]*t[o*3+n]}return Math.abs(i/2)}function tte(t,e,n,r){let i=t.length/3;for(let o=0;o<i;o++){let s=o*3,c=t[s+0],d=t[s+1],m=t[s+2];t[s+e]=c,t[s+n]=d,t[s+r]=m}}function rte(t,e,n,r){let i=x3(t);i&&(i=i.map(c=>c/e));let o=s2(t),s=r&&e===3;if(n){let c=o.length;o=o.slice();let d=[];for(let m=0;m<c;m+=e){d[0]=o[m],d[1]=o[m+1],s&&(d[2]=o[m+2]);let b=n(d);o[m]=b[0],o[m+1]=b[1],s&&(o[m+2]=b[2])}}if(s){let c=kk(o,0,1),d=kk(o,0,2),m=kk(o,1,2);if(!c&&!d&&!m)return[];c>d&&c>m||(d>m?(n||(o=o.slice()),tte(o,0,2,1)):(n||(o=o.slice()),tte(o,2,0,1)))}return(0,nte.default)(o,i,e)}var v3=class extends VA{constructor(e){let{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:r,size:1}}})}get(e){let{attributes:n}=this;return e===\"indices\"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);let n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error(\"missing indices buffer\")}normalizeGeometry(e){if(this.normalize){let n=_I(e,this.positionSize);return this.opts.resolution?h3(s2(n),x3(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Pk(s2(n),x3(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(ote(e)){let n=0;for(let r of e)n+=this.getGeometrySize(r);return n}return s2(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&ote(e))for(let r of e){let i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else{let r=e;this._updateIndices(r,n),this._updatePositions(r,n),this._updateVertexValid(r,n)}}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){let{attributes:o,indexStarts:s,typedArrayManager:c}=this,d=o.indices;if(!d||!e)return;let m=i,b=rte(e,this.positionSize,this.opts.preproject,this.opts.full3d);d=c.allocate(d,i+b.length,{copy:!0});for(let C=0;C<b.length;C++)d[m++]=b[C]+r;s[n+1]=i+b.length,o.indices=d}_updatePositions(e,{vertexStart:n,geometrySize:r}){let{attributes:{positions:i},positionSize:o}=this;if(!i||!e)return;let s=s2(e);for(let c=n,d=0;d<r;c++,d++){let m=s[d*o],b=s[d*o+1],C=o>2?s[d*o+2]:0;i[c*3]=m,i[c*3+1]=b,i[c*3+2]=C}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){let{positionSize:i}=this,o=this.attributes.vertexValid,s=e&&x3(e);if(e&&e.edgeTypes?o.set(e.edgeTypes,n):o.fill(1,n,n+r),s)for(let c=0;c<s.length;c++)o[n+s[c]/i-1]=0;o[n+r-1]=0}};function ote(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}var ste=`uniform solidPolygonUniforms {\n  bool extruded;\n  bool isWireframe;\n  float elevationScale;\n} solidPolygon;\n`,ate={name:\"solidPolygon\",vs:ste,fs:ste,uniformTypes:{extruded:\"f32\",isWireframe:\"f32\",elevationScale:\"f32\"}};var yI=`in vec4 fillColors;\nin vec4 lineColors;\nin vec3 pickingColors;\nout vec4 vColor;\nstruct PolygonProps {\nvec3 positions;\nvec3 positions64Low;\nvec3 normal;\nfloat elevations;\n};\nvec3 project_offset_normal(vec3 vector) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject.coordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\nreturn normalize(vector * project.commonUnitsPerWorldUnit);\n}\nreturn project_normal(vector);\n}\nvoid calculatePosition(PolygonProps props) {\nvec3 pos = props.positions;\nvec3 pos64Low = props.positions64Low;\nvec3 normal = props.normal;\nvec4 colors = solidPolygon.isWireframe ? lineColors : fillColors;\ngeometry.worldPosition = props.positions;\ngeometry.pickingColor = pickingColors;\nif (solidPolygon.extruded) {\npos.z += props.elevations * solidPolygon.elevationScale;\n}\ngl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nif (solidPolygon.extruded) {\n#ifdef IS_SIDE_VERTEX\nnormal = project_offset_normal(normal);\n#else\nnormal = project_normal(normal);\n#endif\ngeometry.normal = normal;\nvec3 lightColor = lighting_getLightColor(colors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);\nvColor = vec4(lightColor, colors.a * layer.opacity);\n} else {\nvColor = vec4(colors.rgb, colors.a * layer.opacity);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var lte=`#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader\nin vec3 vertexPositions;\nin vec3 vertexPositions64Low;\nin float elevations;\n${yI}\nvoid main(void) {\nPolygonProps props;\nprops.positions = vertexPositions;\nprops.positions64Low = vertexPositions64Low;\nprops.elevations = elevations;\nprops.normal = vec3(0.0, 0.0, 1.0);\ncalculatePosition(props);\n}\n`;var cte=`#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\nin vec2 positions;\nin vec3 vertexPositions;\nin vec3 nextVertexPositions;\nin vec3 vertexPositions64Low;\nin vec3 nextVertexPositions64Low;\nin float elevations;\nin float instanceVertexValid;\n${yI}\nvoid main(void) {\nif(instanceVertexValid < 0.5){\ngl_Position = vec4(0.);\nreturn;\n}\nPolygonProps props;\nvec3 pos;\nvec3 pos64Low;\nvec3 nextPos;\nvec3 nextPos64Low;\n#if RING_WINDING_ORDER_CW == 1\npos = vertexPositions;\npos64Low = vertexPositions64Low;\nnextPos = nextVertexPositions;\nnextPos64Low = nextVertexPositions64Low;\n#else\npos = nextVertexPositions;\npos64Low = nextVertexPositions64Low;\nnextPos = vertexPositions;\nnextPos64Low = vertexPositions64Low;\n#endif\nprops.positions = mix(pos, nextPos, positions.x);\nprops.positions64Low = mix(pos64Low, nextPos64Low, positions.x);\nprops.normal = vec3(\npos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),\nnextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),\n0.0);\nprops.elevations = elevations * positions.y;\ncalculatePosition(props);\n}\n`;var ute=`#version 300 es\n#define SHADER_NAME solid-polygon-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nout vec4 fragColor;\nvoid main(void) {\nfragColor = vColor;\ngeometry.uv = vec2(0.);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var vI=[0,0,0,255],xTe={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:\"CW\",_full3d:!1,elevationScale:{type:\"number\",min:0,value:1},getPolygon:{type:\"accessor\",value:t=>t.polygon},getElevation:{type:\"accessor\",value:1e3},getFillColor:{type:\"accessor\",value:vI},getLineColor:{type:\"accessor\",value:vI},material:!0},xI={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t},b3=class extends hi{getShaders(e){return super.getShaders({vs:e===\"top\"?lte:cte,fs:ute,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder===\"CCW\"?0:1},modules:[Lr,Pp,$i,ate]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds([\"vertexPositions\"])}initializeState(){let{viewport:e}=this.context,{coordinateSystem:n}=this.props,{_full3d:r}=this.props;e.isGeospatial&&n===Cn.DEFAULT&&(n=Cn.LNGLAT);let i;n===Cn.LNGLAT&&(r?i=e.projectPosition.bind(e):i=e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new v3({preproject:i,fp64:this.use64bitPositions(),IndexType:Uint32Array})});let o=this.getAttributeManager(),s=!0;o.remove([\"instancePickingColors\"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},vertexPositions:{size:3,type:\"float64\",stepMode:\"dynamic\",fp64:this.use64bitPositions(),transition:xI,accessor:\"getPolygon\",update:this.calculatePositions,noAlloc:s,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:\"uint16\",stepMode:\"instance\",update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,stepMode:\"dynamic\",transition:xI,accessor:\"getElevation\"},fillColors:{size:this.props.colorFormat.length,type:\"unorm8\",stepMode:\"dynamic\",transition:xI,accessor:\"getFillColor\",defaultValue:vI},lineColors:{size:this.props.colorFormat.length,type:\"unorm8\",stepMode:\"dynamic\",transition:xI,accessor:\"getLineColor\",defaultValue:vI},pickingColors:{size:4,type:\"uint8\",stepMode:\"dynamic\",accessor:(c,{index:d,target:m})=>this.encodePickingColor(c&&c.__source?c.__source.index:d,m)}})}getPickingInfo(e){let n=super.getPickingInfo(e),{index:r}=n,i=this.props.data;return i[0]&&i[0].__source&&(n.object=i.find(o=>o.__source.index===r)),n}disablePickingIndex(e){let n=this.props.data;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){let{extruded:n,filled:r,wireframe:i,elevationScale:o}=this.props,{topModel:s,sideModel:c,wireframeModel:d,polygonTesselator:m}=this.state,b={extruded:!!n,elevationScale:o,isWireframe:!1};d&&i&&(d.setInstanceCount(m.instanceCount-1),d.shaderInputs.setProps({solidPolygon:{...b,isWireframe:!0}}),d.draw(this.context.renderPass)),c&&r&&(c.setInstanceCount(m.instanceCount-1),c.shaderInputs.setProps({solidPolygon:b}),c.draw(this.context.renderPass)),s&&r&&(s.setVertexCount(m.vertexCount),s.shaderInputs.setProps({solidPolygon:b}),s.draw(this.context.renderPass))}updateState(e){super.updateState(e),this.updateGeometry(e);let{props:n,oldProps:r,changeFlags:i}=e,o=this.getAttributeManager();(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded)&&(this.state.models?.forEach(c=>c.destroy()),this.setState(this._getModels()),o.invalidateAll())}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){let{polygonTesselator:o}=this.state,s=e.data.attributes||{};o.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:s.getPolygon,buffers:s,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){let{id:e,filled:n,extruded:r}=this.props,i,o,s;if(n){let c=this.getShaders(\"top\");c.defines.NON_INSTANCED_MODEL=1;let d=this.getAttributeManager().getBufferLayouts({isInstanced:!1});i=new gr(this.context.device,{...c,id:`${e}-top`,topology:\"triangle-list\",bufferLayout:d,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(r){let c=this.getAttributeManager().getBufferLayouts({isInstanced:!0});o=new gr(this.context.device,{...this.getShaders(\"side\"),id:`${e}-side`,bufferLayout:c,geometry:new gi({topology:\"triangle-strip\",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),s=new gr(this.context.device,{...this.getShaders(\"side\"),id:`${e}-wireframe`,bufferLayout:c,geometry:new gi({topology:\"line-strip\",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[o,s,i].filter(Boolean),topModel:i,sideModel:o,wireframeModel:s}}calculateIndices(e){let{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get(\"indices\")}calculatePositions(e){let{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get(\"positions\")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get(\"vertexValid\")}};b3.defaultProps=xTe;b3.layerName=\"SolidPolygonLayer\";var cd=b3;function bI({data:t,getIndex:e,dataRange:n,replace:r}){let{startRow:i=0,endRow:o=1/0}=n,s=t.length,c=s,d=s;for(let B=0;B<s;B++){let k=e(t[B]);if(c>B&&k>=i&&(c=B),k>=o){d=B;break}}let m=c,C=d-c!==r.length?t.slice(d):void 0;for(let B=0;B<r.length;B++)t[m++]=r[B];if(C){for(let B=0;B<C.length;B++)t[m++]=C[B];t.length=m}return{startRow:c,endRow:c+r.length}}var hte=[0,0,0,255],vTe=[0,0,0,255],bTe={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:\"CW\",lineWidthUnits:\"meters\",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:\"accessor\",value:t=>t.polygon},getFillColor:{type:\"accessor\",value:vTe},getLineColor:{type:\"accessor\",value:hte},getLineWidth:{type:\"accessor\",value:1},getElevation:{type:\"accessor\",value:1e3},material:!0},w3=class extends xs{initializeState(){this.state={paths:[],pathsDiff:null},this.props.getLineDashArray&&hn.removed(\"getLineDashArray\",\"PathStyleExtension\")()}updateState({changeFlags:e}){let n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){let r=this.state.paths.slice(),i=e.dataChanged.map(o=>bI({data:r,getIndex:s=>s.__source.index,dataRange:o,replace:this._getPaths(o)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){let{data:n,getPolygon:r,positionFormat:i,_normalize:o}=this.props,s=[],c=i===\"XY\"?2:3,{startRow:d,endRow:m}=e,{iterable:b,objectInfo:C}=ys(n,d,m);for(let B of b){C.index++;let k=r(B,C);o&&(k=_I(k,c));let{holeIndices:V}=k,q=k.positions||k;if(V)for(let K=0;K<=V.length;K++){let Y=q.slice(V[K-1]||0,V[K]||q.length);s.push(this.getSubLayerRow({path:Y},B,C.index))}else s.push(this.getSubLayerRow({path:q},B,C.index))}return s}renderLayers(){let{data:e,_dataDiff:n,stroked:r,filled:i,extruded:o,wireframe:s,_normalize:c,_windingOrder:d,elevationScale:m,transitions:b,positionFormat:C}=this.props,{lineWidthUnits:B,lineWidthScale:k,lineWidthMinPixels:V,lineWidthMaxPixels:q,lineJointRounded:K,lineMiterLimit:Y,lineDashJustified:ee}=this.props,{getFillColor:J,getLineColor:se,getLineWidth:xe,getLineDashArray:Ee,getElevation:Xe,getPolygon:Ne,updateTriggers:be,material:ge}=this.props,{paths:Qe,pathsDiff:Ct}=this.state,Mt=this.getSubLayerClass(\"fill\",cd),mt=this.getSubLayerClass(\"stroke\",eh),jt=this.shouldRenderSubLayer(\"fill\",Qe)&&new Mt({_dataDiff:n,extruded:o,elevationScale:m,filled:i,wireframe:s,_normalize:c,_windingOrder:d,getElevation:Xe,getFillColor:J,getLineColor:o&&s?se:hte,material:ge,transitions:b},this.getSubLayerProps({id:\"fill\",updateTriggers:be&&{getPolygon:be.getPolygon,getElevation:be.getElevation,getFillColor:be.getFillColor,lineColors:o&&s,getLineColor:be.getLineColor}}),{data:e,positionFormat:C,getPolygon:Ne}),Mn=!o&&r&&this.shouldRenderSubLayer(\"stroke\",Qe)&&new mt({_dataDiff:Ct&&(()=>Ct),widthUnits:B,widthScale:k,widthMinPixels:V,widthMaxPixels:q,jointRounded:K,miterLimit:Y,dashJustified:ee,_pathType:\"loop\",transitions:b&&{getWidth:b.getLineWidth,getColor:b.getLineColor,getPath:b.getPolygon},getColor:this.getSubLayerAccessor(se),getWidth:this.getSubLayerAccessor(xe),getDashArray:this.getSubLayerAccessor(Ee)},this.getSubLayerProps({id:\"stroke\",updateTriggers:be&&{getWidth:be.getLineWidth,getColor:be.getLineColor,getDashArray:be.getLineDashArray}}),{data:Qe,positionFormat:C,getPath:rn=>rn.path});return[!o&&jt,Mn,o&&jt]}};w3.layerName=\"PolygonLayer\";w3.defaultProps=bTe;var ud=w3;function fte(t,e){if(!t)return null;let n=\"startIndices\"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?wTe(t,r,n):null}function wTe(t,e,n){let r={properties:{...t.properties[e]}};for(let i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function dte(t,e){let n={points:null,lines:null,polygons:null};for(let r in n){let i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*4);let o=[];for(let s=0;s<i.length;s++)e(i[s],o),n[r][s*4+0]=o[0],n[r][s*4+1]=o[1],n[r][s*4+2]=o[2],n[r][s*4+3]=255}return n}var pte=`uniform sdfUniforms {\n  float gamma;\n  bool enabled;\n  float buffer;\n  float outlineBuffer;\n  vec4 outlineColor;\n} sdf;\n`,Ate={name:\"sdf\",vs:pte,fs:pte,uniformTypes:{gamma:\"f32\",enabled:\"f32\",buffer:\"f32\",outlineBuffer:\"f32\",outlineColor:\"vec4<f32>\"}};var gte=`#version 300 es\n#define SHADER_NAME multi-icon-layer-fragment-shader\nprecision highp float;\nuniform sampler2D iconsTexture;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nif (!bool(picking.isActive)) {\nfloat alpha = texture(iconsTexture, vTextureCoords).a;\nvec4 color = vColor;\nif (sdf.enabled) {\nfloat distance = alpha;\nalpha = smoothstep(sdf.buffer - sdf.gamma, sdf.buffer + sdf.gamma, distance);\nif (sdf.outlineBuffer > 0.0) {\nfloat inFill = alpha;\nfloat inBorder = smoothstep(sdf.outlineBuffer - sdf.gamma, sdf.outlineBuffer + sdf.gamma, distance);\ncolor = mix(sdf.outlineColor, vColor, inFill);\nalpha = inBorder;\n}\n}\nfloat a = alpha * color.a;\nif (a < icon.alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color.rgb, a * layer.opacity);\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var Nk=192/256,mte=[],TTe={getIconOffsets:{type:\"accessor\",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:\"color\",value:[0,0,0,255]}},T3=class extends GA{getShaders(){let e=super.getShaders();return{...e,modules:[...e.modules,Ate],fs:gte}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:\"getIconOffsets\"},instancePickingColors:{type:\"uint8\",size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);let{props:n,oldProps:r}=e,{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(o=>o/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&hn.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){let{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:o}=this.state,s=i?Math.max(r,Nk*(1-i)):-1,c=this.state.model,d={buffer:Nk,outlineBuffer:s,gamma:r,enabled:!!n,outlineColor:o};if(c.shaderInputs.setProps({sdf:d}),super.draw(e),n&&i){let{iconManager:m}=this.state;m.getTexture()&&(c.shaderInputs.setProps({sdf:{...d,outlineBuffer:Nk}}),c.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):mte}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):mte}};T3.defaultProps=TTe;T3.layerName=\"MultiIconLayer\";var _te=T3;var E3=class{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:o=\"sans-serif\",fontWeight:s=\"normal\",fontStyle:c=\"normal\",lang:d=null}={}){this.buffer=n,this.cutoff=i,this.radius=r,this.lang=d;let m=this.size=e+n*4,b=this._createCanvas(m),C=this.ctx=b.getContext(\"2d\",{willReadFrequently:!0});C.font=`${c} ${s} ${e}px ${o}`,C.textBaseline=\"alphabetic\",C.textAlign=\"left\",C.fillStyle=\"black\",this.gridOuter=new Float64Array(m*m),this.gridInner=new Float64Array(m*m),this.f=new Float64Array(m),this.z=new Float64Array(m+1),this.v=new Uint16Array(m)}_createCanvas(e){let n=document.createElement(\"canvas\");return n.width=n.height=e,n}draw(e){let{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:o,actualBoundingBoxRight:s}=this.ctx.measureText(e),c=Math.ceil(r),d=0,m=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-o))),b=Math.min(this.size-this.buffer,c+Math.ceil(i)),C=m+2*this.buffer,B=b+2*this.buffer,k=Math.max(C*B,0),V=new Uint8ClampedArray(k),q={data:V,width:C,height:B,glyphWidth:m,glyphHeight:b,glyphTop:c,glyphLeft:d,glyphAdvance:n};if(m===0||b===0)return q;let{ctx:K,buffer:Y,gridInner:ee,gridOuter:J}=this;this.lang&&(K.lang=this.lang),K.clearRect(Y,Y,m,b),K.fillText(e,Y,Y+c);let se=K.getImageData(Y,Y,m,b);J.fill(1e20,0,k),ee.fill(0,0,k);for(let xe=0;xe<b;xe++)for(let Ee=0;Ee<m;Ee++){let Xe=se.data[4*(xe*m+Ee)+3]/255;if(Xe===0)continue;let Ne=(xe+Y)*C+Ee+Y;if(Xe===1)J[Ne]=0,ee[Ne]=1e20;else{let be=.5-Xe;J[Ne]=be>0?be*be:0,ee[Ne]=be<0?be*be:0}}yte(J,0,0,C,B,C,this.f,this.v,this.z),yte(ee,Y,Y,m,b,C,this.f,this.v,this.z);for(let xe=0;xe<k;xe++){let Ee=Math.sqrt(J[xe])-Math.sqrt(ee[xe]);V[xe]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return q}};function yte(t,e,n,r,i,o,s,c,d){for(let m=e;m<e+r;m++)xte(t,n*o+m,o,i,s,c,d);for(let m=n;m<n+i;m++)xte(t,m*o+e,1,r,s,c,d)}function xte(t,e,n,r,i,o,s){o[0]=0,s[0]=-1e20,s[1]=1e20,i[0]=t[e];for(let c=1,d=0,m=0;c<r;c++){i[c]=t[e+c*n];let b=c*c;do{let C=o[d];m=(i[c]-i[C]+b-C*C)/(c-C)/2}while(m<=s[d]&&--d>-1);d++,o[d]=c,s[d]=m,s[d+1]=1e20}for(let c=0,d=0;c<r;c++){for(;s[d+1]<c;)d++;let m=o[d],b=c-m;t[e+c*n]=i[m]+b*b}}var ETe=32,STe=[];function CTe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function vte({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:o={},xOffset:s=0,yOffset:c=0}){let d=0,m=s,b=n+r*2;for(let C of t)if(!o[C]){let B=e(C);m+B+r*2>i&&(m=0,d++),o[C]={x:m+r,y:c+d*b+r,width:B,height:b,layoutWidth:B,layoutHeight:n},m+=B+r*2}return{mapping:o,xOffset:m,yOffset:c+d*b,canvasHeight:CTe(c+(d+1)*b)}}function bte(t,e,n,r){let i=0;for(let o=e;o<n;o++){let s=t[o];i+=r[s]?.layoutWidth||0}return i}function wte(t,e,n,r,i,o){let s=e,c=0;for(let d=e;d<n;d++){let m=bte(t,d,d+1,i);c+m>r&&(s<d&&o.push(d),s=d,c=0),c+=m}return c}function MTe(t,e,n,r,i,o){let s=e,c=e,d=e,m=0;for(let b=e;b<n;b++)if((t[b]===\" \"||t[b+1]===\" \"||b+1===n)&&(d=b+1),d>c){let C=bte(t,c,d,i);m+C>r&&(s<c&&(o.push(c),s=c,m=0),C>r&&(C=wte(t,c,d,r,i,o),s=o[o.length-1])),c=d,m+=C}return m}function ITe(t,e,n,r,i=0,o){o===void 0&&(o=t.length);let s=[];return e===\"break-all\"?wte(t,i,o,n,r,s):MTe(t,i,o,n,r,s),s}function PTe(t,e,n,r,i,o){let s=0,c=0;for(let d=e;d<n;d++){let m=t[d],b=r[m];b?(c||(c=b.layoutHeight),i[d]=s+b.layoutWidth/2,s+=b.layoutWidth):(hn.warn(`Missing character: ${m} (${m.codePointAt(0)})`)(),i[d]=s,s+=ETe)}o[0]=s,o[1]=c}function Tte(t,e,n,r,i){let o=Array.from(t),s=o.length,c=new Array(s),d=new Array(s),m=new Array(s),b=(n===\"break-word\"||n===\"break-all\")&&isFinite(r)&&r>0,C=[0,0],B=[0,0],k=0,V=0,q=0;for(let K=0;K<=s;K++){let Y=o[K];if((Y===`\n`||K===s)&&(q=K),q>V){let ee=b?ITe(o,n,r,i,V,q):STe;for(let J=0;J<=ee.length;J++){let se=J===0?V:ee[J-1],xe=J<ee.length?ee[J]:q;PTe(o,se,xe,i,c,B);for(let Ee=se;Ee<xe;Ee++){let Xe=o[Ee],Ne=i[Xe]?.layoutOffsetY||0;d[Ee]=k+B[1]/2+Ne,m[Ee]=B[0]}k=k+B[1]*e,C[0]=Math.max(C[0],B[0])}V=q}Y===`\n`&&(c[V]=0,d[V]=0,m[V]=0,V++)}return C[1]=k,{x:c,y:d,rowWidth:m,size:C}}function Ete({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:o}){let s=t.BYTES_PER_ELEMENT,c=n?n/s:1,d=r?r/s:0,m=i[e]||Math.ceil((t.length-d)/c),b=o&&new Set,C=new Array(e),B=t;if(c>1||d>0){let k=t.constructor;B=new k(m);for(let V=0;V<m;V++)B[V]=t[V*c+d]}for(let k=0;k<e;k++){let V=i[k],q=i[k+1]||m,K=B.subarray(V,q);C[k]=String.fromCodePoint.apply(null,K),b&&K.forEach(b.add,b)}if(b)for(let k of b)o.add(String.fromCodePoint(k));return{texts:C,characterCount:m}}var a2=class{constructor(e=5){this._cache={},this._order=[],this.limit=e}get(e){let n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){let n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}};function RTe(){let t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}var i_={fontFamily:\"Monaco, monospace\",fontWeight:\"normal\",characterSet:RTe(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},Ste=1024,Cte=.9,Mte=1.2,Pte=3,wI=new a2(Pte);function BTe(t,e){let n;typeof e==\"string\"?n=new Set(Array.from(e)):n=new Set(e);let r=wI.get(t);if(!r)return n;for(let i in r.mapping)n.has(i)&&n.delete(i);return n}function DTe(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function Ite(t,e,n,r){t.font=`${r} ${n}px ${e}`,t.fillStyle=\"#000\",t.textBaseline=\"alphabetic\",t.textAlign=\"left\"}function Rte(t){hn.assert(Number.isFinite(t)&&t>=Pte,\"Invalid cache limit\"),wI=new a2(t)}var S3=class{constructor(){this.props={...i_}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){let{fontSize:e,buffer:n}=this.props;return(e*Mte+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();let n=BTe(this._key,this.props.characterSet),r=wI.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}let i=this._generateFontAtlas(n,r);this._atlas=i,wI.set(this._key,i)}_generateFontAtlas(e,n){let{fontFamily:r,fontWeight:i,fontSize:o,buffer:s,sdf:c,radius:d,cutoff:m}=this.props,b=n&&n.data;b||(b=document.createElement(\"canvas\"),b.width=Ste);let C=b.getContext(\"2d\",{willReadFrequently:!0});Ite(C,r,o,i);let{mapping:B,canvasHeight:k,xOffset:V,yOffset:q}=vte({getFontWidth:K=>C.measureText(K).width,fontHeight:o*Mte,buffer:s,characterSet:e,maxCanvasWidth:Ste,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(b.height!==k){let K=C.getImageData(0,0,b.width,b.height);b.height=k,C.putImageData(K,0,0)}if(Ite(C,r,o,i),c){let K=new E3({fontSize:o,buffer:s,radius:d,cutoff:m,fontFamily:r,fontWeight:`${i}`});for(let Y of e){let{data:ee,width:J,height:se,glyphTop:xe}=K.draw(Y);B[Y].width=J,B[Y].layoutOffsetY=o*Cte-xe;let Ee=C.createImageData(J,se);DTe(ee,Ee),C.putImageData(Ee,B[Y].x,B[Y].y)}}else for(let K of e)C.fillText(K,B[K].x,B[K].y+s+o*Cte);return{xOffset:V,yOffset:q,mapping:B,data:b,width:b.width,height:b.height}}_getKey(){let{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:o,radius:s,cutoff:c}=this.props;return o?`${e} ${n} ${r} ${i} ${s} ${c}`:`${e} ${n} ${r} ${i}`}};var Bte=`uniform textBackgroundUniforms {\n  bool billboard;\n  float sizeScale;\n  float sizeMinPixels;\n  float sizeMaxPixels;\n  vec4 borderRadius;\n  vec4 padding;\n  highp int sizeUnits;\n  bool stroked;\n} textBackground;\n`,Dte={name:\"textBackground\",vs:Bte,fs:Bte,uniformTypes:{billboard:\"f32\",sizeScale:\"f32\",sizeMinPixels:\"f32\",sizeMaxPixels:\"f32\",borderRadius:\"vec4<f32>\",padding:\"vec4<f32>\",sizeUnits:\"i32\",stroked:\"f32\"}};var Lte=`#version 300 es\n#define SHADER_NAME text-background-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceRects;\nin float instanceSizes;\nin float instanceAngles;\nin vec2 instancePixelOffsets;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout float vLineWidth;\nout vec2 uv;\nout vec2 dimensions;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = radians(angle);\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvLineWidth = instanceLineWidths;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * textBackground.sizeScale, textBackground.sizeUnits),\ntextBackground.sizeMinPixels, textBackground.sizeMaxPixels\n);\ndimensions = instanceRects.zw * sizePixels + textBackground.padding.xy + textBackground.padding.zw;\nvec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-textBackground.padding.xy, textBackground.padding.zw, positions);\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\npixelOffset += instancePixelOffsets;\npixelOffset.y *= -1.0;\nif (textBackground.billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n`;var Ote=`#version 300 es\n#define SHADER_NAME text-background-layer-fragment-shader\nprecision highp float;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin float vLineWidth;\nin vec2 uv;\nin vec2 dimensions;\nout vec4 fragColor;\nfloat round_rect(vec2 p, vec2 size, vec4 radii) {\nvec2 pixelPositionCB = (p - 0.5) * size;\nvec2 sizeCB = size * 0.5;\nfloat maxBorderRadius = min(size.x, size.y) * 0.5;\nvec4 borderRadius = vec4(min(radii, maxBorderRadius));\nborderRadius.xy =\n(pixelPositionCB.x > 0.0) ? borderRadius.xy : borderRadius.zw;\nborderRadius.x = (pixelPositionCB.y > 0.0) ? borderRadius.x : borderRadius.y;\nvec2 q = abs(pixelPositionCB) - sizeCB + borderRadius.x;\nreturn -(min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - borderRadius.x);\n}\nfloat rect(vec2 p, vec2 size) {\nvec2 pixelPosition = p * size;\nreturn min(min(pixelPosition.x, size.x - pixelPosition.x),\nmin(pixelPosition.y, size.y - pixelPosition.y));\n}\nvec4 get_stroked_fragColor(float dist) {\nfloat isBorder = smoothedge(dist, vLineWidth);\nreturn mix(vFillColor, vLineColor, isBorder);\n}\nvoid main(void) {\ngeometry.uv = uv;\nif (textBackground.borderRadius != vec4(0.0)) {\nfloat distToEdge = round_rect(uv, dimensions, textBackground.borderRadius);\nif (textBackground.stroked) {\nfragColor = get_stroked_fragColor(distToEdge);\n} else {\nfragColor = vFillColor;\n}\nfloat shapeAlpha = smoothedge(-distToEdge, 0.0);\nfragColor.a *= shapeAlpha;\n} else {\nif (textBackground.stroked) {\nfloat distToEdge = rect(uv, dimensions);\nfragColor = get_stroked_fragColor(distToEdge);\n} else {\nfragColor = vFillColor;\n}\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var LTe={billboard:!0,sizeScale:1,sizeUnits:\"pixels\",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,borderRadius:{type:\"object\",value:0},padding:{type:\"array\",value:[0,0,0,0]},getPosition:{type:\"accessor\",value:t=>t.position},getSize:{type:\"accessor\",value:1},getAngle:{type:\"accessor\",value:0},getPixelOffset:{type:\"accessor\",value:[0,0]},getBoundingRect:{type:\"accessor\",value:[0,0,0,0]},getFillColor:{type:\"accessor\",value:[0,0,0,255]},getLineColor:{type:\"accessor\",value:[0,0,0,255]},getLineWidth:{type:\"accessor\",value:1}},C3=class extends hi{getShaders(){return super.getShaders({vs:Lte,fs:Ote,modules:[Lr,$i,Dte]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),transition:!0,accessor:\"getPosition\"},instanceSizes:{size:1,transition:!0,accessor:\"getSize\",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:\"getAngle\"},instanceRects:{size:4,accessor:\"getBoundingRect\"},instancePixelOffsets:{size:2,transition:!0,accessor:\"getPixelOffset\"},instanceFillColors:{size:4,transition:!0,type:\"unorm8\",accessor:\"getFillColor\",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:\"unorm8\",accessor:\"getLineColor\",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:\"getLineWidth\",defaultValue:1}})}updateState(e){super.updateState(e);let{changeFlags:n}=e;n.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){let{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:o,sizeMaxPixels:s,getLineWidth:c}=this.props,{padding:d,borderRadius:m}=this.props;d.length<4&&(d=[d[0],d[1],d[0],d[1]]),Array.isArray(m)||(m=[m,m,m,m]);let b=this.state.model,C={billboard:n,stroked:!!c,borderRadius:m,padding:d,sizeUnits:so[i],sizeScale:r,sizeMinPixels:o,sizeMaxPixels:s};b.shaderInputs.setProps({textBackground:C}),b.draw(this.context.renderPass)}_getModel(){let e=[0,0,1,0,0,1,1,1];return new gr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new gi({topology:\"triangle-strip\",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}};C3.defaultProps=LTe;C3.layerName=\"TextBackgroundLayer\";var Fte=C3;var kte={start:1,middle:0,end:-1},Nte={top:1,center:0,bottom:-1},zk=[0,0,0,255],OTe=1,FTe={billboard:!0,sizeScale:1,sizeUnits:\"pixels\",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:\"accessor\",value:[255,255,255,255]},getBorderColor:{type:\"accessor\",value:zk},getBorderWidth:{type:\"accessor\",value:0},backgroundBorderRadius:{type:\"object\",value:0},backgroundPadding:{type:\"array\",value:[0,0,0,0]},characterSet:{type:\"object\",value:i_.characterSet},fontFamily:i_.fontFamily,fontWeight:i_.fontWeight,lineHeight:OTe,outlineWidth:{type:\"number\",value:0,min:0},outlineColor:{type:\"color\",value:zk},fontSettings:{type:\"object\",value:{},compare:1},wordBreak:\"break-word\",maxWidth:{type:\"number\",value:-1},getText:{type:\"accessor\",value:t=>t.text},getPosition:{type:\"accessor\",value:t=>t.position},getColor:{type:\"accessor\",value:zk},getSize:{type:\"accessor\",value:32},getAngle:{type:\"accessor\",value:0},getTextAnchor:{type:\"accessor\",value:\"middle\"},getAlignmentBaseline:{type:\"accessor\",value:\"center\"},getPixelOffset:{type:\"accessor\",value:[0,0]},backgroundColor:{deprecatedFor:[\"background\",\"getBackgroundColor\"]}},M3=class extends xs{constructor(){super(...arguments),this.getBoundingRect=(e,n)=>{let{size:[r,i]}=this.transformParagraph(e,n),{fontSize:o}=this.state.fontAtlasManager.props;r/=o,i/=o;let{getTextAnchor:s,getAlignmentBaseline:c}=this.props,d=kte[typeof s==\"function\"?s(e,n):s],m=Nte[typeof c==\"function\"?c(e,n):c];return[(d-1)*r/2,(m-1)*i/2,r,i]},this.getIconOffsets=(e,n)=>{let{getTextAnchor:r,getAlignmentBaseline:i}=this.props,{x:o,y:s,rowWidth:c,size:[d,m]}=this.transformParagraph(e,n),b=kte[typeof r==\"function\"?r(e,n):r],C=Nte[typeof i==\"function\"?i(e,n):i],B=o.length,k=new Array(B*2),V=0;for(let q=0;q<B;q++){let K=(1-b)*(d-c[q])/2;k[V++]=(b-1)*d/2+K+o[q],k[V++]=(C-1)*m/2+s[q]}return k}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new S3},this.props.maxWidth>0&&hn.once(1,\"v8.9 breaking change: TextLayer maxWidth is now relative to text size\")()}updateState(e){let{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){let{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:o}=this.state,s={...e,characterSet:o,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(s),!0;for(let c in s)if(s[c]!==i.props[c])return i.setProps(s),!0;return!1}_updateText(){let{data:e,characterSet:n}=this.props,r=e.attributes?.getText,{getText:i}=this.props,o=e.startIndices,s,c=n===\"auto\"&&new Set;if(r&&o){let{texts:d,characterCount:m}=Ete({...ArrayBuffer.isView(r)?{value:r}:r,length:e.length,startIndices:o,characterSet:c});s=m,i=(b,{index:C})=>d[C]}else{let{iterable:d,objectInfo:m}=ys(e);o=[0],s=0;for(let b of d){m.index++;let C=Array.from(i(b,m)||\"\");c&&C.forEach(c.add,c),s+=C.length,o.push(s)}}this.setState({getText:i,startIndices:o,numInstances:s,characterSet:c||n})}transformParagraph(e,n){let{fontAtlasManager:r}=this.state,i=r.mapping,o=this.state.getText,{wordBreak:s,lineHeight:c,maxWidth:d}=this.props,m=o(e,n)||\"\";return Tte(m,c,s,d*r.props.fontSize,i)}renderLayers(){let{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,atlas:o,mapping:s},styleVersion:c}=this.state,{data:d,_dataDiff:m,getPosition:b,getColor:C,getSize:B,getAngle:k,getPixelOffset:V,getBackgroundColor:q,getBorderColor:K,getBorderWidth:Y,backgroundBorderRadius:ee,backgroundPadding:J,background:se,billboard:xe,fontSettings:Ee,outlineWidth:Xe,outlineColor:Ne,sizeScale:be,sizeUnits:ge,sizeMinPixels:Qe,sizeMaxPixels:Ct,transitions:Mt,updateTriggers:mt}=this.props,jt=this.getSubLayerClass(\"characters\",_te),Mn=this.getSubLayerClass(\"background\",Fte);return[se&&new Mn({getFillColor:q,getLineColor:K,getLineWidth:Y,borderRadius:ee,padding:J,getPosition:b,getSize:B,getAngle:k,getPixelOffset:V,billboard:xe,sizeScale:be,sizeUnits:ge,sizeMinPixels:Qe,sizeMaxPixels:Ct,transitions:Mt&&{getPosition:Mt.getPosition,getAngle:Mt.getAngle,getSize:Mt.getSize,getFillColor:Mt.getBackgroundColor,getLineColor:Mt.getBorderColor,getLineWidth:Mt.getBorderWidth,getPixelOffset:Mt.getPixelOffset}},this.getSubLayerProps({id:\"background\",updateTriggers:{getPosition:mt.getPosition,getAngle:mt.getAngle,getSize:mt.getSize,getFillColor:mt.getBackgroundColor,getLineColor:mt.getBorderColor,getLineWidth:mt.getBorderWidth,getPixelOffset:mt.getPixelOffset,getBoundingRect:{getText:mt.getText,getTextAnchor:mt.getTextAnchor,getAlignmentBaseline:mt.getAlignmentBaseline,styleVersion:c}}}),{data:d.attributes&&d.attributes.background?{length:d.length,attributes:d.attributes.background}:d,_dataDiff:m,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new jt({sdf:Ee.sdf,smoothing:Number.isFinite(Ee.smoothing)?Ee.smoothing:i_.smoothing,outlineWidth:Xe/(Ee.radius||i_.radius),outlineColor:Ne,iconAtlas:o,iconMapping:s,getPosition:b,getColor:C,getSize:B,getAngle:k,getPixelOffset:V,billboard:xe,sizeScale:be*i,sizeUnits:ge,sizeMinPixels:Qe*i,sizeMaxPixels:Ct*i,transitions:Mt&&{getPosition:Mt.getPosition,getAngle:Mt.getAngle,getColor:Mt.getColor,getSize:Mt.getSize,getPixelOffset:Mt.getPixelOffset}},this.getSubLayerProps({id:\"characters\",updateTriggers:{all:mt.getText,getPosition:mt.getPosition,getAngle:mt.getAngle,getColor:mt.getColor,getSize:mt.getSize,getPixelOffset:mt.getPixelOffset,getIconOffsets:{getTextAnchor:mt.getTextAnchor,getAlignmentBaseline:mt.getAlignmentBaseline,styleVersion:c}}}),{data:d,_dataDiff:m,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){Rte(e)}};M3.defaultProps=FTe;M3.layerName=\"TextLayer\";var l2=M3;var I3={circle:{type:n2,props:{filled:\"filled\",stroked:\"stroked\",lineWidthMaxPixels:\"lineWidthMaxPixels\",lineWidthMinPixels:\"lineWidthMinPixels\",lineWidthScale:\"lineWidthScale\",lineWidthUnits:\"lineWidthUnits\",pointRadiusMaxPixels:\"radiusMaxPixels\",pointRadiusMinPixels:\"radiusMinPixels\",pointRadiusScale:\"radiusScale\",pointRadiusUnits:\"radiusUnits\",pointAntialiasing:\"antialiasing\",pointBillboard:\"billboard\",getFillColor:\"getFillColor\",getLineColor:\"getLineColor\",getLineWidth:\"getLineWidth\",getPointRadius:\"getRadius\"}},icon:{type:GA,props:{iconAtlas:\"iconAtlas\",iconMapping:\"iconMapping\",iconSizeMaxPixels:\"sizeMaxPixels\",iconSizeMinPixels:\"sizeMinPixels\",iconSizeScale:\"sizeScale\",iconSizeUnits:\"sizeUnits\",iconAlphaCutoff:\"alphaCutoff\",iconBillboard:\"billboard\",getIcon:\"getIcon\",getIconAngle:\"getAngle\",getIconColor:\"getColor\",getIconPixelOffset:\"getPixelOffset\",getIconSize:\"getSize\"}},text:{type:l2,props:{textSizeMaxPixels:\"sizeMaxPixels\",textSizeMinPixels:\"sizeMinPixels\",textSizeScale:\"sizeScale\",textSizeUnits:\"sizeUnits\",textBackground:\"background\",textBackgroundPadding:\"backgroundPadding\",textFontFamily:\"fontFamily\",textFontWeight:\"fontWeight\",textLineHeight:\"lineHeight\",textMaxWidth:\"maxWidth\",textOutlineColor:\"outlineColor\",textOutlineWidth:\"outlineWidth\",textWordBreak:\"wordBreak\",textCharacterSet:\"characterSet\",textBillboard:\"billboard\",textFontSettings:\"fontSettings\",getText:\"getText\",getTextAngle:\"getAngle\",getTextColor:\"getColor\",getTextPixelOffset:\"getPixelOffset\",getTextSize:\"getSize\",getTextAnchor:\"getTextAnchor\",getTextAlignmentBaseline:\"getAlignmentBaseline\",getTextBackgroundColor:\"getBackgroundColor\",getTextBorderColor:\"getBorderColor\",getTextBorderWidth:\"getBorderWidth\"}}},P3={type:eh,props:{lineWidthUnits:\"widthUnits\",lineWidthScale:\"widthScale\",lineWidthMinPixels:\"widthMinPixels\",lineWidthMaxPixels:\"widthMaxPixels\",lineJointRounded:\"jointRounded\",lineCapRounded:\"capRounded\",lineMiterLimit:\"miterLimit\",lineBillboard:\"billboard\",getLineColor:\"getColor\",getLineWidth:\"getWidth\"}},TI={type:cd,props:{extruded:\"extruded\",filled:\"filled\",wireframe:\"wireframe\",elevationScale:\"elevationScale\",material:\"material\",_full3d:\"_full3d\",getElevation:\"getElevation\",getFillColor:\"getFillColor\",getLineColor:\"getLineColor\"}};function c2({type:t,props:e}){let n={};for(let r in e)n[r]=t.defaultProps[e[r]];return n}function EI(t,e){let{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(let o in e){let s=e[o],c=t.props[o];o.startsWith(\"get\")&&(c=t.getSubLayerAccessor(c),i.updateTriggers[s]=r[o],n&&(i.transitions[s]=n[o])),i[s]=c}return i}function Ute(t){if(Array.isArray(t))return t;switch(hn.assert(t.type,\"GeoJSON does not have type\"),t.type){case\"Feature\":return[t];case\"FeatureCollection\":return hn.assert(Array.isArray(t.features),\"GeoJSON does not have features array\"),t.features;default:return[{geometry:t}]}}function Uk(t,e,n={}){let r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:o=t.length}=n;for(let s=i;s<o;s++){let c=t[s],{geometry:d}=c;if(d)if(d.type===\"GeometryCollection\"){hn.assert(Array.isArray(d.geometries),\"GeoJSON does not have geometries array\");let{geometries:m}=d;for(let b=0;b<m.length;b++){let C=m[b];zte(C,r,e,c,s)}}else zte(d,r,e,c,s)}return r}function zte(t,e,n,r,i){let{type:o,coordinates:s}=t,{pointFeatures:c,lineFeatures:d,polygonFeatures:m,polygonOutlineFeatures:b}=e;if(!NTe(o,s)){hn.warn(`${o} coordinates are malformed`)();return}switch(o){case\"Point\":c.push(n({geometry:t},r,i));break;case\"MultiPoint\":s.forEach(C=>{c.push(n({geometry:{type:\"Point\",coordinates:C}},r,i))});break;case\"LineString\":d.push(n({geometry:t},r,i));break;case\"MultiLineString\":s.forEach(C=>{d.push(n({geometry:{type:\"LineString\",coordinates:C}},r,i))});break;case\"Polygon\":m.push(n({geometry:t},r,i)),s.forEach(C=>{b.push(n({geometry:{type:\"LineString\",coordinates:C}},r,i))});break;case\"MultiPolygon\":s.forEach(C=>{m.push(n({geometry:{type:\"Polygon\",coordinates:C}},r,i)),C.forEach(B=>{b.push(n({geometry:{type:\"LineString\",coordinates:B}},r,i))})});break;default:}}var kTe={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function NTe(t,e){let n=kTe[t];for(hn.assert(n,`Unknown GeoJSON type ${t}`);e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function Vte(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function SI(t){return t.geometry.coordinates}function Gte(t,e){let n=Vte(),{pointFeatures:r,lineFeatures:i,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=SI,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=SI,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=SI,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=SI,n}function Hte(t,e){let n=Vte(),{points:r,lines:i,polygons:o}=t,s=dte(t,e);n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:4,value:s.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:4,value:s.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType=\"open\";let c=o.positions.value.length/o.positions.size,d=Array(c).fill(1);for(let m of o.primitivePolygonIndices.value)d[m-1]=0;return n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,instanceVertexValid:{size:1,value:new Uint16Array(d)},pickingColors:{size:4,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:4,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType=\"open\",n}var zTe=[\"points\",\"linestrings\",\"polygons\"],UTe={...c2(I3.circle),...c2(I3.icon),...c2(I3.text),...c2(P3),...c2(TI),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:\"object\",value:null},iconMapping:{type:\"object\",value:{}},getIcon:{type:\"accessor\",value:t=>t.properties.icon},getText:{type:\"accessor\",value:t=>t.properties.text},pointType:\"circle\",getRadius:{deprecatedFor:\"getPointRadius\"}},R3=class extends xs{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;let{data:r}=this.props,i=r&&\"points\"in r&&\"polygons\"in r&&\"lines\"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){let r=Hte(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){let r=Ute(e.data),i=this.getSubLayerRow.bind(this),o={},s={};if(Array.isArray(n.dataChanged)){let d=this.state.features;for(let m in d)o[m]=d[m].slice(),s[m]=[];for(let m of n.dataChanged){let b=Uk(r,i,m);for(let C in d)s[C].push(bI({data:o[C],getIndex:B=>B.__source.index,dataRange:m,replace:b[C]}))}}else o=Uk(r,i);let c=Gte(o,s);this.setState({features:o,featuresDiff:s,layerProps:c})}getPickingInfo(e){let n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=zTe.find(o=>i.id.startsWith(`${this.id}-${o}-`)),r>=0&&i.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){let n=`${this.id}-points-`,r=e.featureType===\"points\";for(let i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){let{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i=\"polygons-fill\",o=this.shouldRenderSubLayer(i,r.polygons?.data)&&this.getSubLayerClass(i,TI.type);if(o){let s=EI(this,TI.props),c=e&&n;return c||delete s.getLineColor,s.updateTriggers.lineColors=c,new o(s,this.getSubLayerProps({id:i,updateTriggers:s.updateTriggers}),r.polygons)}return null}_renderLineLayers(){let{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i=\"polygons-stroke\",o=\"linestrings\",s=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline?.data)&&this.getSubLayerClass(i,P3.type),c=this.shouldRenderSubLayer(o,r.lines?.data)&&this.getSubLayerClass(o,P3.type);if(s||c){let d=EI(this,P3.props);return[s&&new s(d,this.getSubLayerProps({id:i,updateTriggers:d.updateTriggers}),r.polygonsOutline),c&&new c(d,this.getSubLayerProps({id:o,updateTriggers:d.updateTriggers}),r.lines)]}return null}_renderPointLayers(){let{pointType:e}=this.props,{layerProps:n,binary:r}=this.state,{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(c=>c.__source.index===i));let o=new Set(e.split(\"+\")),s=[];for(let c of o){let d=`points-${c}`,m=I3[c],b=m&&this.shouldRenderSubLayer(d,n.points?.data)&&this.getSubLayerClass(d,m.type);if(b){let C=EI(this,m.props),B=n.points;if(c===\"text\"&&r){let{instancePickingColors:k,...V}=B.data.attributes;B={...B,data:{...B.data,attributes:V}}}s.push(new b(C,this.getSubLayerProps({id:d,updateTriggers:C.updateTriggers,highlightedObjectIndex:i}),B))}}return s}renderLayers(){let{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){let{binary:n}=this.state;return!n||typeof e!=\"function\"?super.getSubLayerAccessor(e):(r,i)=>{let{data:o,index:s}=i,c=fte(o,s);return e(c,i)}}};R3.layerName=\"GeoJsonLayer\";R3.defaultProps=UTe;var Vp=R3;var VTe={...ud.defaultProps},B3=class extends xs{indexToBounds(){return null}renderLayers(){let{elevationScale:e,extruded:n,wireframe:r,filled:i,stroked:o,lineWidthUnits:s,lineWidthScale:c,lineWidthMinPixels:d,lineWidthMaxPixels:m,lineJointRounded:b,lineMiterLimit:C,lineDashJustified:B,getElevation:k,getFillColor:V,getLineColor:q,getLineWidth:K}=this.props,{updateTriggers:Y,material:ee,transitions:J}=this.props,se=this.getSubLayerClass(\"cell\",ud),{updateTriggers:xe,...Ee}=this.indexToBounds()||{};return new se({filled:i,wireframe:r,extruded:n,elevationScale:e,stroked:o,lineWidthUnits:s,lineWidthScale:c,lineWidthMinPixels:d,lineWidthMaxPixels:m,lineJointRounded:b,lineMiterLimit:C,lineDashJustified:B,material:ee,transitions:J,getElevation:k,getFillColor:V,getLineColor:q,getLineWidth:K},this.getSubLayerProps({id:\"cell\",updateTriggers:Y&&{...xe,getElevation:Y.getElevation,getFillColor:Y.getFillColor,getLineColor:Y.getLineColor,getLineWidth:Y.getLineWidth}}),Ee)}};B3.layerName=\"GeoCellLayer\";B3.defaultProps=VTe;var XA=B3;var mi=(function(t){t=t||{};var e=typeof t<\"u\"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i=[],o=\"\";function s(At){return e.locateFile?e.locateFile(At,o):o+At}var c;typeof document<\"u\"&&document.currentScript&&(o=document.currentScript.src),o.indexOf(\"blob:\")!==0?o=o.substr(0,o.lastIndexOf(\"/\")+1):o=\"\",c=function(Nt,sn,zt){var _=new XMLHttpRequest;_.open(\"GET\",Nt,!0),_.responseType=\"arraybuffer\",_.onload=function(){if(_.status==200||_.status==0&&_.response){sn(_.response);return}var Er=ln(Nt);if(Er){sn(Er.buffer);return}zt()},_.onerror=zt,_.send(null)};var d=e.print||console.log.bind(console),m=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&(i=e.arguments);var b=0,C=function(At){b=At},B=function(){return b},k=8;function V(At,Nt,sn,zt){switch(sn=sn||\"i8\",sn.charAt(sn.length-1)===\"*\"&&(sn=\"i32\"),sn){case\"i1\":mt[At>>0]=Nt;break;case\"i8\":mt[At>>0]=Nt;break;case\"i16\":Mn[At>>1]=Nt;break;case\"i32\":In[At>>2]=Nt;break;case\"i64\":he=[Nt>>>0,(ae=Nt,+Xs(ae)>=1?ae>0?(us(+Hi(ae/4294967296),4294967295)|0)>>>0:~~+Ys((ae-+(~~ae>>>0))/4294967296)>>>0:0)],In[At>>2]=he[0],In[At+4>>2]=he[1];break;case\"float\":Pn[At>>2]=Nt;break;case\"double\":_n[At>>3]=Nt;break;default:rl(\"invalid type for setValue: \"+sn)}}function q(At,Nt,sn){switch(Nt=Nt||\"i8\",Nt.charAt(Nt.length-1)===\"*\"&&(Nt=\"i32\"),Nt){case\"i1\":return mt[At>>0];case\"i8\":return mt[At>>0];case\"i16\":return Mn[At>>1];case\"i32\":return In[At>>2];case\"i64\":return In[At>>2];case\"float\":return Pn[At>>2];case\"double\":return _n[At>>3];default:rl(\"invalid type for getValue: \"+Nt)}return null}var K=!1;function Y(At,Nt){At||rl(\"Assertion failed: \"+Nt)}function ee(At){var Nt=e[\"_\"+At];return Y(Nt,\"Cannot call unknown function \"+At+\", make sure it is exported\"),Nt}function J(At,Nt,sn,zt,_){var ai={string:function(wo){var Sr=0;if(wo!=null&&wo!==0){var Nr=(wo.length<<2)+1;Sr=s0(Nr),be(wo,Sr,Nr)}return Sr},array:function(wo){var Sr=s0(wo.length);return Qe(wo,Sr),Sr}};function Er(wo){return Nt===\"string\"?Xe(wo):Nt===\"boolean\"?!!wo:wo}var fe=ee(At),Xi=[],aa=0;if(zt)for(var bo=0;bo<zt.length;bo++){var kr=ai[sn[bo]];kr?(aa===0&&(aa=to()),Xi[bo]=kr(zt[bo])):Xi[bo]=zt[bo]}var li=fe.apply(null,Xi);return li=Er(li),aa!==0&&xd(aa),li}function se(At,Nt,sn,zt){sn=sn||[];var _=sn.every(function(Er){return Er===\"number\"}),ai=Nt!==\"string\";return ai&&_&&!zt?ee(At):function(){return J(At,Nt,sn,arguments,zt)}}var xe=typeof TextDecoder<\"u\"?new TextDecoder(\"utf8\"):void 0;function Ee(At,Nt,sn){for(var zt=Nt+sn,_=Nt;At[_]&&!(_>=zt);)++_;if(_-Nt>16&&At.subarray&&xe)return xe.decode(At.subarray(Nt,_));for(var ai=\"\";Nt<_;){var Er=At[Nt++];if(!(Er&128)){ai+=String.fromCharCode(Er);continue}var fe=At[Nt++]&63;if((Er&224)==192){ai+=String.fromCharCode((Er&31)<<6|fe);continue}var Xi=At[Nt++]&63;if((Er&240)==224?Er=(Er&15)<<12|fe<<6|Xi:Er=(Er&7)<<18|fe<<12|Xi<<6|At[Nt++]&63,Er<65536)ai+=String.fromCharCode(Er);else{var aa=Er-65536;ai+=String.fromCharCode(55296|aa>>10,56320|aa&1023)}}return ai}function Xe(At,Nt){return At?Ee(jt,At,Nt):\"\"}function Ne(At,Nt,sn,zt){if(!(zt>0))return 0;for(var _=sn,ai=sn+zt-1,Er=0;Er<At.length;++Er){var fe=At.charCodeAt(Er);if(fe>=55296&&fe<=57343){var Xi=At.charCodeAt(++Er);fe=65536+((fe&1023)<<10)|Xi&1023}if(fe<=127){if(sn>=ai)break;Nt[sn++]=fe}else if(fe<=2047){if(sn+1>=ai)break;Nt[sn++]=192|fe>>6,Nt[sn++]=128|fe&63}else if(fe<=65535){if(sn+2>=ai)break;Nt[sn++]=224|fe>>12,Nt[sn++]=128|fe>>6&63,Nt[sn++]=128|fe&63}else{if(sn+3>=ai)break;Nt[sn++]=240|fe>>18,Nt[sn++]=128|fe>>12&63,Nt[sn++]=128|fe>>6&63,Nt[sn++]=128|fe&63}}return Nt[sn]=0,sn-_}function be(At,Nt,sn){return Ne(At,jt,Nt,sn)}var ge=typeof TextDecoder<\"u\"?new TextDecoder(\"utf-16le\"):void 0;function Qe(At,Nt){mt.set(At,Nt)}function Ct(At,Nt){return At%Nt>0&&(At+=Nt-At%Nt),At}var Mt,mt,jt,Mn,rn,In,On,Pn,_n;function tr(At){Mt=At,e.HEAP8=mt=new Int8Array(At),e.HEAP16=Mn=new Int16Array(At),e.HEAP32=In=new Int32Array(At),e.HEAPU8=jt=new Uint8Array(At),e.HEAPU16=rn=new Uint16Array(At),e.HEAPU32=On=new Uint32Array(At),e.HEAPF32=Pn=new Float32Array(At),e.HEAPF64=_n=new Float64Array(At)}var on=5271536,Pt=28624,Mr=e.TOTAL_MEMORY||33554432;e.buffer?Mt=e.buffer:Mt=new ArrayBuffer(Mr),Mr=Mt.byteLength,tr(Mt),In[Pt>>2]=on;function Fn(At){for(;At.length>0;){var Nt=At.shift();if(typeof Nt==\"function\"){Nt();continue}var sn=Nt.func;typeof sn==\"number\"?Nt.arg===void 0?e.dynCall_v(sn):e.dynCall_vi(sn,Nt.arg):sn(Nt.arg===void 0?null:Nt.arg)}}var Br=[],nr=[],lo=[],oi=[];function cs(){if(e.preRun)for(typeof e.preRun==\"function\"&&(e.preRun=[e.preRun]);e.preRun.length;)mr(e.preRun.shift());Fn(Br)}function yi(){Fn(nr)}function Ro(){Fn(lo)}function co(){if(e.postRun)for(typeof e.postRun==\"function\"&&(e.postRun=[e.postRun]);e.postRun.length;)Yr(e.postRun.shift());Fn(oi)}function mr(At){Br.unshift(At)}function Yr(At){oi.unshift(At)}var Xs=Math.abs,Ys=Math.ceil,Hi=Math.floor,us=Math.min,Zr=0,Oi=null,Fr=null;function eo(At){Zr++,e.monitorRunDependencies&&e.monitorRunDependencies(Zr)}function $t(At){if(Zr--,e.monitorRunDependencies&&e.monitorRunDependencies(Zr),Zr==0&&(Oi!==null&&(clearInterval(Oi),Oi=null),Fr)){var Nt=Fr;Fr=null,Nt()}}e.preloadedImages={},e.preloadedAudios={};var en=null,Sn=\"data:application/octet-stream;base64,\";function Ze(At){return String.prototype.startsWith?At.startsWith(Sn):At.indexOf(Sn)===0}var ae,he;en=\"data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAdmVydGV4Um90YXRpb25zAGNlbGxUb1ZlcnRleABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl\";var pe=28640;function ze(At){return At}function He(At){var Nt=/\\b__Z[\\w\\d_]+/g;return At.replace(Nt,function(sn){var zt=sn;return sn===zt?sn:zt+\" [\"+sn+\"]\"})}function ot(){var At=new Error;if(!At.stack){try{throw new Error(0)}catch(Nt){At=Nt}if(!At.stack)return\"(no stack trace available)\"}return At.stack.toString()}function tt(){var At=ot();return e.extraStackTrace&&(At+=`\n`+e.extraStackTrace()),He(At)}function Je(At,Nt,sn,zt){rl(\"Assertion failed: \"+Xe(At)+\", at: \"+[Nt?Xe(Nt):\"unknown filename\",sn,zt?Xe(zt):\"unknown function\"])}function nt(){return mt.length}function Dt(At,Nt,sn){jt.set(jt.subarray(Nt,Nt+sn),At)}function vt(At){return e.___errno_location&&(In[e.___errno_location()>>2]=At),At}function Vt(At){rl(\"OOM\")}function Ke(At){try{var Nt=new ArrayBuffer(At);return Nt.byteLength!=At?void 0:(new Int8Array(Nt).set(mt),xi(Nt),tr(Nt),1)}catch{}}function zn(At){var Nt=nt(),sn=16777216,zt=2147483648-sn;if(At>zt)return!1;for(var _=16777216,ai=Math.max(Nt,_);ai<At;)ai<=536870912?ai=Ct(2*ai,sn):ai=Math.min(Ct((3*ai+2147483648)/4,sn),zt);var Er=Ke(ai);return!!Er}var Wr=typeof atob==\"function\"?atob:function(At){var Nt=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",sn=\"\",zt,_,ai,Er,fe,Xi,aa,bo=0;At=At.replace(/[^A-Za-z0-9\\+\\/\\=]/g,\"\");do Er=Nt.indexOf(At.charAt(bo++)),fe=Nt.indexOf(At.charAt(bo++)),Xi=Nt.indexOf(At.charAt(bo++)),aa=Nt.indexOf(At.charAt(bo++)),zt=Er<<2|fe>>4,_=(fe&15)<<4|Xi>>2,ai=(Xi&3)<<6|aa,sn=sn+String.fromCharCode(zt),Xi!==64&&(sn=sn+String.fromCharCode(_)),aa!==64&&(sn=sn+String.fromCharCode(ai));while(bo<At.length);return sn};function fn(At){try{for(var Nt=Wr(At),sn=new Uint8Array(Nt.length),zt=0;zt<Nt.length;++zt)sn[zt]=Nt.charCodeAt(zt);return sn}catch{throw new Error(\"Converting base64 string to bytes failed.\")}}function ln(At){if(Ze(At))return fn(At.slice(Sn.length))}var Nn={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Ir={a:rl,b:C,c:B,d:Je,e:vt,f:nt,g:Dt,h:zn,i:Vt,j:ze,k:He,l:Ke,m:ot,n:tt,o:pe,p:Pt},Et=(function(At,Nt,sn){\"almost asm\";var zt=new At.Int8Array(sn),_=new At.Int32Array(sn),ai=new At.Uint8Array(sn),Er=new At.Float32Array(sn),fe=new At.Float64Array(sn),Xi=Nt.o|0,aa=Nt.p|0,bo=At.Math.floor,kr=At.Math.abs,li=At.Math.sqrt,wo=At.Math.pow,Sr=At.Math.cos,Nr=At.Math.sin,vh=At.Math.tan,mg=At.Math.acos,_g=At.Math.asin,c0=At.Math.atan,La=At.Math.atan2,bh=At.Math.ceil,Ps=At.Math.imul,u0=At.Math.min,yg=At.Math.max,la=At.Math.clz32,Jn=Nt.b,ve=Nt.c,Wn=Nt.d,D_=Nt.e,L_=Nt.f,vd=Nt.g,O_=Nt.h,xg=Nt.i,Ae=28656;function h0(A){return zt=new Int8Array(A),ai=new Uint8Array(A),_=new Int32Array(A),Er=new Float32Array(A),fe=new Float64Array(A),sn=A,!0}function Dl(A){A=A|0;var g=0;return g=Ae,Ae=Ae+A|0,Ae=Ae+15&-16,g|0}function f0(){return Ae|0}function vg(A){A=A|0,Ae=A}function bg(A,g){A=A|0,g=g|0,Ae=A}function wg(A,g){A=A|0,g=g|0;var x=0,T=0,M=0;return(A|0)<0?(g=2,g|0):(A|0)>13780509?(g=Rf(15,g)|0,g|0):(x=((A|0)<0)<<31>>31,M=Ut(A|0,x|0,3,0)|0,T=ve()|0,x=Ve(A|0,x|0,1,0)|0,x=Ut(M|0,T|0,x|0,ve()|0)|0,x=Ve(x|0,ve()|0,1,0)|0,A=ve()|0,_[g>>2]=x,_[g+4>>2]=A,g=0,g|0)}function bd(A,g,x,T){return A=A|0,g=g|0,x=x|0,T=T|0,vu(A,g,x,T,0)|0}function vu(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0;if(W=Ae,Ae=Ae+16|0,O=W,!(d0(A,g,x,T,M)|0))return T=0,Ae=W,T|0;do if((x|0)>=0){if((x|0)>13780509){if(D=Rf(15,O)|0,D|0)break;N=O,O=_[N>>2]|0,N=_[N+4>>2]|0}else D=((x|0)<0)<<31>>31,Z=Ut(x|0,D|0,3,0)|0,N=ve()|0,D=Ve(x|0,D|0,1,0)|0,D=Ut(Z|0,N|0,D|0,ve()|0)|0,D=Ve(D|0,ve()|0,1,0)|0,N=ve()|0,_[O>>2]=D,_[O+4>>2]=N,O=D;if(Fi(T|0,0,O<<3|0)|0,M|0){Fi(M|0,0,O<<2|0)|0,D=lc(A,g,x,T,M,O,N,0)|0;break}D=Fe(O,4)|0,D?(Z=lc(A,g,x,T,D,O,N,0)|0,Be(D),D=Z):D=13}else D=2;while(!1);return Z=D,Ae=W,Z|0}function d0(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0;if(Ye=Ae,Ae=Ae+16|0,Se=Ye,Pe=Ye+8|0,Ce=Se,_[Ce>>2]=A,_[Ce+4>>2]=g,(x|0)<0)return Pe=2,Ae=Ye,Pe|0;if(D=T,_[D>>2]=A,_[D+4>>2]=g,D=(M|0)!=0,D&&(_[M>>2]=0),dr(A,g)|0)return Pe=9,Ae=Ye,Pe|0;_[Pe>>2]=0;e:do if((x|0)>=1)if(D)for(ne=1,Z=0,_e=0,Ce=1,D=A;;){if(!(Z|_e)){if(D=Ho(D,g,4,Pe,Se)|0,D|0)break e;if(g=Se,D=_[g>>2]|0,g=_[g+4>>2]|0,dr(D,g)|0){D=9;break e}}if(D=Ho(D,g,_[26800+(_e<<2)>>2]|0,Pe,Se)|0,D|0)break e;if(g=Se,D=_[g>>2]|0,g=_[g+4>>2]|0,A=T+(ne<<3)|0,_[A>>2]=D,_[A+4>>2]=g,_[M+(ne<<2)>>2]=Ce,A=Z+1|0,O=(A|0)==(Ce|0),N=_e+1|0,W=(N|0)==6,dr(D,g)|0){D=9;break e}if(Ce=Ce+(W&O&1)|0,(Ce|0)>(x|0)){D=0;break}else ne=ne+1|0,Z=O?0:A,_e=O?W?0:N:_e}else for(ne=1,Z=0,_e=0,Ce=1,D=A;;){if(!(Z|_e)){if(D=Ho(D,g,4,Pe,Se)|0,D|0)break e;if(g=Se,D=_[g>>2]|0,g=_[g+4>>2]|0,dr(D,g)|0){D=9;break e}}if(D=Ho(D,g,_[26800+(_e<<2)>>2]|0,Pe,Se)|0,D|0)break e;if(g=Se,D=_[g>>2]|0,g=_[g+4>>2]|0,A=T+(ne<<3)|0,_[A>>2]=D,_[A+4>>2]=g,A=Z+1|0,O=(A|0)==(Ce|0),N=_e+1|0,W=(N|0)==6,dr(D,g)|0){D=9;break e}if(Ce=Ce+(W&O&1)|0,(Ce|0)>(x|0)){D=0;break}else ne=ne+1|0,Z=O?0:A,_e=O?W?0:N:_e}else D=0;while(!1);return Pe=D,Ae=Ye,Pe|0}function lc(A,g,x,T,M,D,O,N){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0,D=D|0,O=O|0,N=N|0;var W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0;if(Ye=Ae,Ae=Ae+16|0,Se=Ye+8|0,Pe=Ye,W=Jt(A|0,g|0,D|0,O|0)|0,ne=ve()|0,_e=T+(W<<3)|0,et=_e,yt=_[et>>2]|0,et=_[et+4>>2]|0,Z=(yt|0)==(A|0)&(et|0)==(g|0),!((yt|0)==0&(et|0)==0|Z))do W=Ve(W|0,ne|0,1,0)|0,W=Bt(W|0,ve()|0,D|0,O|0)|0,ne=ve()|0,_e=T+(W<<3)|0,yt=_e,et=_[yt>>2]|0,yt=_[yt+4>>2]|0,Z=(et|0)==(A|0)&(yt|0)==(g|0);while(!((et|0)==0&(yt|0)==0|Z));if(W=M+(W<<2)|0,Z&&(_[W>>2]|0)<=(N|0)||(yt=_e,_[yt>>2]=A,_[yt+4>>2]=g,_[W>>2]=N,(N|0)>=(x|0)))return yt=0,Ae=Ye,yt|0;switch(Z=N+1|0,_[Se>>2]=0,W=Ho(A,g,2,Se,Pe)|0,W|0){case 9:{Ce=9;break}case 0:{W=Pe,W=lc(_[W>>2]|0,_[W+4>>2]|0,x,T,M,D,O,Z)|0,W||(Ce=9);break}default:}e:do if((Ce|0)==9){switch(_[Se>>2]=0,W=Ho(A,g,3,Se,Pe)|0,W|0){case 9:break;case 0:{if(W=Pe,W=lc(_[W>>2]|0,_[W+4>>2]|0,x,T,M,D,O,Z)|0,W|0)break e;break}default:break e}switch(_[Se>>2]=0,W=Ho(A,g,1,Se,Pe)|0,W|0){case 9:break;case 0:{if(W=Pe,W=lc(_[W>>2]|0,_[W+4>>2]|0,x,T,M,D,O,Z)|0,W|0)break e;break}default:break e}switch(_[Se>>2]=0,W=Ho(A,g,5,Se,Pe)|0,W|0){case 9:break;case 0:{if(W=Pe,W=lc(_[W>>2]|0,_[W+4>>2]|0,x,T,M,D,O,Z)|0,W|0)break e;break}default:break e}switch(_[Se>>2]=0,W=Ho(A,g,4,Se,Pe)|0,W|0){case 9:break;case 0:{if(W=Pe,W=lc(_[W>>2]|0,_[W+4>>2]|0,x,T,M,D,O,Z)|0,W|0)break e;break}default:break e}switch(_[Se>>2]=0,W=Ho(A,g,6,Se,Pe)|0,W|0){case 9:break;case 0:{if(W=Pe,W=lc(_[W>>2]|0,_[W+4>>2]|0,x,T,M,D,O,Z)|0,W|0)break e;break}default:break e}return yt=0,Ae=Ye,yt|0}while(!1);return yt=W,Ae=Ye,yt|0}function Ho(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0;if(x>>>0>6)return M=1,M|0;if(_e=(_[T>>2]|0)%6|0,_[T>>2]=_e,(_e|0)>0){D=0;do x=Ch(x)|0,D=D+1|0;while((D|0)<(_[T>>2]|0))}if(_e=Tt(A|0,g|0,45)|0,ve()|0,ne=_e&127,ne>>>0>121)return M=5,M|0;W=ts(A,g)|0,D=Tt(A|0,g|0,52)|0,ve()|0,D=D&15;e:do if(!D)Z=8;else{for(;;){if(O=(15-D|0)*3|0,N=Tt(A|0,g|0,O|0)|0,ve()|0,N=N&7,(N|0)==7){g=5;break}if(Pe=(ho(D)|0)==0,D=D+-1|0,Ce=Ot(7,0,O|0)|0,g=g&~(ve()|0),Se=Ot(_[(Pe?432:16)+(N*28|0)+(x<<2)>>2]|0,0,O|0)|0,O=ve()|0,x=_[(Pe?640:224)+(N*28|0)+(x<<2)>>2]|0,A=Se|A&~Ce,g=O|g,!x){x=0;break e}if(!D){Z=8;break e}}return g|0}while(!1);(Z|0)==8&&(Pe=_[848+(ne*28|0)+(x<<2)>>2]|0,Se=Ot(Pe|0,0,45)|0,A=Se|A,g=ve()|0|g&-1040385,x=_[4272+(ne*28|0)+(x<<2)>>2]|0,(Pe&127|0)==127&&(Pe=Ot(_[848+(ne*28|0)+20>>2]|0,0,45)|0,g=ve()|0|g&-1040385,x=_[4272+(ne*28|0)+20>>2]|0,A=Rh(Pe|A,g)|0,g=ve()|0,_[T>>2]=(_[T>>2]|0)+1)),N=Tt(A|0,g|0,45)|0,ve()|0,N=N&127;e:do if(Qr(N)|0){t:do if((ts(A,g)|0)==1){if((ne|0)!=(N|0))if(g0(N,_[7696+(ne*28|0)>>2]|0)|0){A=Su(A,g)|0,O=1,g=ve()|0;break}else Wn(27795,26864,533,26872);switch(W|0){case 3:{A=Rh(A,g)|0,g=ve()|0,_[T>>2]=(_[T>>2]|0)+1,O=0;break t}case 5:{A=Su(A,g)|0,g=ve()|0,_[T>>2]=(_[T>>2]|0)+5,O=0;break t}case 0:return Pe=9,Pe|0;default:return Pe=1,Pe|0}}else O=0;while(!1);if((x|0)>0){D=0;do A=C0(A,g)|0,g=ve()|0,D=D+1|0;while((D|0)!=(x|0))}if((ne|0)!=(N|0)){if(!(wh(N)|0)){if((O|0)!=0|(ts(A,g)|0)!=5)break;_[T>>2]=(_[T>>2]|0)+1;break}switch(_e&127){case 8:case 118:break e;default:}(ts(A,g)|0)!=3&&(_[T>>2]=(_[T>>2]|0)+1)}}else if((x|0)>0){D=0;do A=Rh(A,g)|0,g=ve()|0,D=D+1|0;while((D|0)!=(x|0))}while(!1);return _[T>>2]=((_[T>>2]|0)+x|0)%6|0,Pe=M,_[Pe>>2]=A,_[Pe+4>>2]=g,Pe=0,Pe|0}function vx(A,g,x,T){return A=A|0,g=g|0,x=x|0,T=T|0,F_(A,g,x,T)|0?(Fi(T|0,0,x*48|0)|0,T=k_(A,g,x,T)|0,T|0):(T=0,T|0)}function F_(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0;if(Pe=Ae,Ae=Ae+16|0,Ce=Pe,Se=Pe+8|0,_e=Ce,_[_e>>2]=A,_[_e+4>>2]=g,(x|0)<0)return Se=2,Ae=Pe,Se|0;if(!x)return Se=T,_[Se>>2]=A,_[Se+4>>2]=g,Se=0,Ae=Pe,Se|0;_[Se>>2]=0;e:do if(dr(A,g)|0)A=9;else{M=0,_e=A;do{if(A=Ho(_e,g,4,Se,Ce)|0,A|0)break e;if(g=Ce,_e=_[g>>2]|0,g=_[g+4>>2]|0,M=M+1|0,dr(_e,g)|0){A=9;break e}}while((M|0)<(x|0));ne=T,_[ne>>2]=_e,_[ne+4>>2]=g,ne=x+-1|0,Z=0,A=1;do{if(M=26800+(Z<<2)|0,(Z|0)==5)for(O=_[M>>2]|0,D=0,M=A;;){if(A=Ce,A=Ho(_[A>>2]|0,_[A+4>>2]|0,O,Se,Ce)|0,A|0)break e;if((D|0)!=(ne|0))if(W=Ce,N=_[W>>2]|0,W=_[W+4>>2]|0,A=T+(M<<3)|0,_[A>>2]=N,_[A+4>>2]=W,!(dr(N,W)|0))A=M+1|0;else{A=9;break e}else A=M;if(D=D+1|0,(D|0)>=(x|0))break;M=A}else for(O=Ce,W=_[M>>2]|0,N=0,M=A,D=_[O>>2]|0,O=_[O+4>>2]|0;;){if(A=Ho(D,O,W,Se,Ce)|0,A|0)break e;if(O=Ce,D=_[O>>2]|0,O=_[O+4>>2]|0,A=T+(M<<3)|0,_[A>>2]=D,_[A+4>>2]=O,A=M+1|0,dr(D,O)|0){A=9;break e}if(N=N+1|0,(N|0)>=(x|0))break;M=A}Z=Z+1|0}while(Z>>>0<6);A=Ce,A=(_e|0)==(_[A>>2]|0)&&(g|0)==(_[A+4>>2]|0)?0:9}while(!1);return Se=A,Ae=Pe,Se|0}function k_(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0;if(_e=Ae,Ae=Ae+16|0,O=_e,!x)return _[T>>2]=A,_[T+4>>2]=g,T=0,Ae=_e,T|0;do if((x|0)>=0){if((x|0)>13780509){if(M=Rf(15,O)|0,M|0)break;D=O,M=_[D>>2]|0,D=_[D+4>>2]|0}else M=((x|0)<0)<<31>>31,ne=Ut(x|0,M|0,3,0)|0,D=ve()|0,M=Ve(x|0,M|0,1,0)|0,M=Ut(ne|0,D|0,M|0,ve()|0)|0,M=Ve(M|0,ve()|0,1,0)|0,D=ve()|0,ne=O,_[ne>>2]=M,_[ne+4>>2]=D;if(Z=Fe(M,8)|0,!Z)M=13;else{if(ne=Fe(M,4)|0,!ne){Be(Z),M=13;break}if(M=lc(A,g,x,Z,ne,M,D,0)|0,M|0){Be(Z),Be(ne);break}if(g=_[O>>2]|0,O=_[O+4>>2]|0,(O|0)>0|(O|0)==0&g>>>0>0){M=0,N=0,W=0;do A=Z+(N<<3)|0,D=_[A>>2]|0,A=_[A+4>>2]|0,!((D|0)==0&(A|0)==0)&&(_[ne+(N<<2)>>2]|0)==(x|0)&&(Ce=T+(M<<3)|0,_[Ce>>2]=D,_[Ce+4>>2]=A,M=M+1|0),N=Ve(N|0,W|0,1,0)|0,W=ve()|0;while((W|0)<(O|0)|(W|0)==(O|0)&N>>>0<g>>>0)}Be(Z),Be(ne),M=0}}else M=2;while(!1);return Ce=M,Ae=_e,Ce|0}function Tg(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0;for(N=Ae,Ae=Ae+16|0,D=N,O=N+8|0,M=(dr(A,g)|0)==0,M=M?1:2;;){if(_[O>>2]=0,Z=(Ho(A,g,M,O,D)|0)==0,W=D,Z&((_[W>>2]|0)==(x|0)?(_[W+4>>2]|0)==(T|0):0)){A=4;break}if(M=M+1|0,M>>>0>=7){M=7,A=4;break}}return(A|0)==4?(Ae=N,M|0):0}function zr(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0;if(N=Ae,Ae=Ae+48|0,M=N+16|0,D=N+8|0,O=N,x=Nc(x)|0,x|0)return O=x,Ae=N,O|0;if(Z=A,W=_[Z+4>>2]|0,x=D,_[x>>2]=_[Z>>2],_[x+4>>2]=W,Qd(D,M),x=U_(M,g,O)|0,!x){if(g=_[D>>2]|0,D=_[A+8>>2]|0,(D|0)>0){M=_[A+12>>2]|0,x=0;do g=(_[M+(x<<3)>>2]|0)+g|0,x=x+1|0;while((x|0)<(D|0))}x=O,M=_[x>>2]|0,x=_[x+4>>2]|0,D=((g|0)<0)<<31>>31,(x|0)<(D|0)|(x|0)==(D|0)&M>>>0<g>>>0?(x=O,_[x>>2]=g,_[x+4>>2]=D,x=D):g=M,W=Ve(g|0,x|0,12,0)|0,Z=ve()|0,x=O,_[x>>2]=W,_[x+4>>2]=Z,x=T,_[x>>2]=W,_[x+4>>2]=Z,x=0}return Z=x,Ae=N,Z|0}function wd(A,g,x,T,M,D,O){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0,D=D|0,O=O|0;var N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0,qt=0,xn=0,dn=0,Vn=0,qn=0,ur=0,Gn=0,Tn=0,Zt=0,hr=0,wi=0,ir=0,Ti=0,Qs=0,Mx=0;if(wi=Ae,Ae=Ae+64|0,Gn=wi+48|0,Tn=wi+32|0,Zt=wi+24|0,qt=wi+8|0,xn=wi,W=_[A>>2]|0,(W|0)<=0)return hr=0,Ae=wi,hr|0;for(dn=A+4|0,Vn=Gn+8|0,qn=Tn+8|0,ur=qt+8|0,N=0,lt=0;;){Z=_[dn>>2]|0,at=Z+(lt<<4)|0,_[Gn>>2]=_[at>>2],_[Gn+4>>2]=_[at+4>>2],_[Gn+8>>2]=_[at+8>>2],_[Gn+12>>2]=_[at+12>>2],(lt|0)==(W+-1|0)?(_[Tn>>2]=_[Z>>2],_[Tn+4>>2]=_[Z+4>>2],_[Tn+8>>2]=_[Z+8>>2],_[Tn+12>>2]=_[Z+12>>2]):(at=Z+(lt+1<<4)|0,_[Tn>>2]=_[at>>2],_[Tn+4>>2]=_[at+4>>2],_[Tn+8>>2]=_[at+8>>2],_[Tn+12>>2]=_[at+12>>2]),W=V_(Gn,Tn,T,Zt)|0;e:do if(W)Z=0,N=W;else if(W=Zt,Z=_[W>>2]|0,W=_[W+4>>2]|0,(W|0)>0|(W|0)==0&Z>>>0>0){yt=0,at=0;t:for(;;){if(Ti=1/(+(Z>>>0)+4294967296*+(W|0)),Mx=+fe[Gn>>3],W=ct(Z|0,W|0,yt|0,at|0)|0,Qs=+(W>>>0)+4294967296*+(ve()|0),ir=+(yt>>>0)+4294967296*+(at|0),fe[qt>>3]=Ti*(Mx*Qs)+Ti*(+fe[Tn>>3]*ir),fe[ur>>3]=Ti*(+fe[Vn>>3]*Qs)+Ti*(+fe[qn>>3]*ir),W=un(qt,T,xn)|0,W|0){N=W;break}et=xn,Ye=_[et>>2]|0,et=_[et+4>>2]|0,Ce=Jt(Ye|0,et|0,g|0,x|0)|0,ne=ve()|0,W=O+(Ce<<3)|0,_e=W,Z=_[_e>>2]|0,_e=_[_e+4>>2]|0;n:do if((Z|0)==0&(_e|0)==0)qe=W,hr=16;else for(Se=0,Pe=0;;){if((Se|0)>(x|0)|(Se|0)==(x|0)&Pe>>>0>g>>>0){N=1;break t}if((Z|0)==(Ye|0)&(_e|0)==(et|0))break n;if(W=Ve(Ce|0,ne|0,1,0)|0,Ce=Bt(W|0,ve()|0,g|0,x|0)|0,ne=ve()|0,Pe=Ve(Pe|0,Se|0,1,0)|0,Se=ve()|0,W=O+(Ce<<3)|0,_e=W,Z=_[_e>>2]|0,_e=_[_e+4>>2]|0,(Z|0)==0&(_e|0)==0){qe=W,hr=16;break}}while(!1);if((hr|0)==16&&(hr=0,!((Ye|0)==0&(et|0)==0))&&(Pe=qe,_[Pe>>2]=Ye,_[Pe+4>>2]=et,Pe=D+(_[M>>2]<<3)|0,_[Pe>>2]=Ye,_[Pe+4>>2]=et,Pe=M,Pe=Ve(_[Pe>>2]|0,_[Pe+4>>2]|0,1,0)|0,Ye=ve()|0,et=M,_[et>>2]=Pe,_[et+4>>2]=Ye),yt=Ve(yt|0,at|0,1,0)|0,at=ve()|0,W=Zt,Z=_[W>>2]|0,W=_[W+4>>2]|0,!((W|0)>(at|0)|(W|0)==(at|0)&Z>>>0>yt>>>0)){Z=1;break e}}Z=0}else Z=1;while(!1);if(lt=lt+1|0,!Z){hr=21;break}if(W=_[A>>2]|0,(lt|0)>=(W|0)){N=0,hr=21;break}}return(hr|0)==21?(Ae=wi,N|0):0}function p0(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0,qt=0,xn=0,dn=0,Vn=0,qn=0,ur=0,Gn=0,Tn=0,Zt=0,hr=0,wi=0,ir=0,Ti=0,Qs=0;if(Qs=Ae,Ae=Ae+112|0,hr=Qs+80|0,W=Qs+72|0,wi=Qs,ir=Qs+56|0,M=Nc(x)|0,M|0)return Ti=M,Ae=Qs,Ti|0;if(Z=A+8|0,Ti=Ge((_[Z>>2]<<5)+32|0)|0,!Ti)return Ti=13,Ae=Qs,Ti|0;if(Df(A,Ti),M=Nc(x)|0,!M){if(Tn=A,Zt=_[Tn+4>>2]|0,M=W,_[M>>2]=_[Tn>>2],_[M+4>>2]=Zt,Qd(W,hr),M=U_(hr,g,wi)|0,M)Tn=0,Zt=0;else{if(M=_[W>>2]|0,D=_[Z>>2]|0,(D|0)>0){O=_[A+12>>2]|0,x=0;do M=(_[O+(x<<3)>>2]|0)+M|0,x=x+1|0;while((x|0)!=(D|0));x=M}else x=M;M=wi,D=_[M>>2]|0,M=_[M+4>>2]|0,O=((x|0)<0)<<31>>31,(M|0)<(O|0)|(M|0)==(O|0)&D>>>0<x>>>0?(M=wi,_[M>>2]=x,_[M+4>>2]=O,M=O):x=D,Tn=Ve(x|0,M|0,12,0)|0,Zt=ve()|0,M=wi,_[M>>2]=Tn,_[M+4>>2]=Zt,M=0}if(!M){if(x=Fe(Tn,8)|0,!x)return Be(Ti),Ti=13,Ae=Qs,Ti|0;if(N=Fe(Tn,8)|0,!N)return Be(Ti),Be(x),Ti=13,Ae=Qs,Ti|0;ur=hr,_[ur>>2]=0,_[ur+4>>2]=0,ur=A,Gn=_[ur+4>>2]|0,M=W,_[M>>2]=_[ur>>2],_[M+4>>2]=Gn,M=wd(W,Tn,Zt,g,hr,x,N)|0;e:do if(M)Be(x),Be(N),Be(Ti);else{t:do if((_[Z>>2]|0)>0){for(O=A+12|0,D=0;M=wd((_[O>>2]|0)+(D<<3)|0,Tn,Zt,g,hr,x,N)|0,D=D+1|0,!(M|0);)if((D|0)>=(_[Z>>2]|0))break t;Be(x),Be(N),Be(Ti);break e}while(!1);(Zt|0)>0|(Zt|0)==0&Tn>>>0>0&&Fi(N|0,0,Tn<<3|0)|0,Gn=hr,ur=_[Gn+4>>2]|0;t:do if((ur|0)>0|(ur|0)==0&(_[Gn>>2]|0)>>>0>0){dn=x,Vn=N,qn=x,ur=N,Gn=x,M=x,qe=x,qt=N,xn=N,x=N;n:for(;;){for(et=0,yt=0,at=0,lt=0,D=0,O=0;;){N=wi,W=N+56|0;do _[N>>2]=0,N=N+4|0;while((N|0)<(W|0));if(g=dn+(et<<3)|0,Z=_[g>>2]|0,g=_[g+4>>2]|0,d0(Z,g,1,wi,0)|0){N=wi,W=N+56|0;do _[N>>2]=0,N=N+4|0;while((N|0)<(W|0));N=Fe(7,4)|0,N|0&&(lc(Z,g,1,wi,N,7,0,0)|0,Be(N))}for(Ye=0;;){Pe=wi+(Ye<<3)|0,Se=_[Pe>>2]|0,Pe=_[Pe+4>>2]|0;r:do if((Se|0)==0&(Pe|0)==0)N=D,W=O;else{if(ne=Jt(Se|0,Pe|0,Tn|0,Zt|0)|0,Z=ve()|0,N=T+(ne<<3)|0,g=N,W=_[g>>2]|0,g=_[g+4>>2]|0,!((W|0)==0&(g|0)==0)){_e=0,Ce=0;do{if((_e|0)>(Zt|0)|(_e|0)==(Zt|0)&Ce>>>0>Tn>>>0)break n;if((W|0)==(Se|0)&(g|0)==(Pe|0)){N=D,W=O;break r}N=Ve(ne|0,Z|0,1,0)|0,ne=Bt(N|0,ve()|0,Tn|0,Zt|0)|0,Z=ve()|0,Ce=Ve(Ce|0,_e|0,1,0)|0,_e=ve()|0,N=T+(ne<<3)|0,g=N,W=_[g>>2]|0,g=_[g+4>>2]|0}while(!((W|0)==0&(g|0)==0))}if((Se|0)==0&(Pe|0)==0){N=D,W=O;break}sl(Se,Pe,ir)|0,Lh(A,Ti,ir)|0&&(Ce=Ve(D|0,O|0,1,0)|0,O=ve()|0,_e=N,_[_e>>2]=Se,_[_e+4>>2]=Pe,D=Vn+(D<<3)|0,_[D>>2]=Se,_[D+4>>2]=Pe,D=Ce),N=D,W=O}while(!1);if(Ye=Ye+1|0,Ye>>>0>=7)break;D=N,O=W}if(et=Ve(et|0,yt|0,1,0)|0,yt=ve()|0,at=Ve(at|0,lt|0,1,0)|0,lt=ve()|0,O=hr,D=_[O>>2]|0,O=_[O+4>>2]|0,(lt|0)<(O|0)|(lt|0)==(O|0)&at>>>0<D>>>0)D=N,O=W;else break}if((O|0)>0|(O|0)==0&D>>>0>0){D=0,O=0;do lt=dn+(D<<3)|0,_[lt>>2]=0,_[lt+4>>2]=0,D=Ve(D|0,O|0,1,0)|0,O=ve()|0,lt=hr,at=_[lt+4>>2]|0;while((O|0)<(at|0)|((O|0)==(at|0)?D>>>0<(_[lt>>2]|0)>>>0:0))}if(lt=hr,_[lt>>2]=N,_[lt+4>>2]=W,(W|0)>0|(W|0)==0&N>>>0>0)Ye=x,et=xn,yt=Gn,at=qt,lt=Vn,x=qe,xn=M,qt=qn,qe=Ye,M=et,Gn=ur,ur=yt,qn=at,Vn=dn,dn=lt;else break t}Be(qn),Be(ur),Be(Ti),M=1;break e}else M=N;while(!1);Be(Ti),Be(x),Be(M),M=0}while(!1);return Ti=M,Ae=Qs,Ti|0}}return Be(Ti),Ti=M,Ae=Qs,Ti|0}function A0(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;if(ne=Ae,Ae=Ae+176|0,W=ne,(g|0)<1)return re(x,0,0),Z=0,Ae=ne,Z|0;for(N=A,N=Tt(_[N>>2]|0,_[N+4>>2]|0,52)|0,ve()|0,re(x,(g|0)>6?g:6,N&15),N=0;T=A+(N<<3)|0,T=uc(_[T>>2]|0,_[T+4>>2]|0,W)|0,!(T|0);){if(T=_[W>>2]|0,(T|0)>0){O=0;do D=W+8+(O<<4)|0,O=O+1|0,T=W+8+(((O|0)%(T|0)|0)<<4)|0,M=Me(x,T,D)|0,M?Te(x,M)|0:Ie(x,D,T)|0,T=_[W>>2]|0;while((O|0)<(T|0))}if(N=N+1|0,(N|0)>=(g|0)){T=0,Z=13;break}}return(Z|0)==13?(Ae=ne,T|0):(ce(x),Z=T,Ae=ne,Z|0)}function Eg(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0;if(D=Ae,Ae=Ae+32|0,T=D,M=D+16|0,A=A0(A,g,M)|0,A|0)return x=A,Ae=D,x|0;if(_[x>>2]=0,_[x+4>>2]=0,_[x+8>>2]=0,A=de(M)|0,A|0)do{g=jd(x)|0;do B0(g,A)|0,O=A+16|0,_[T>>2]=_[O>>2],_[T+4>>2]=_[O+4>>2],_[T+8>>2]=_[O+8>>2],_[T+12>>2]=_[O+12>>2],Te(M,A)|0,A=Oe(M,T)|0;while((A|0)!=0);A=de(M)|0}while((A|0)!=0);return ce(M),A=qs(x)|0,A?(Xd(x),O=A,Ae=D,O|0):(O=0,Ae=D,O|0)}function Qr(A){return A=A|0,A>>>0>121?(A=0,A|0):(A=_[7696+(A*28|0)+16>>2]|0,A|0)}function wh(A){return A=A|0,(A|0)==4|(A|0)==117|0}function Th(A){return A=A|0,_[11120+((_[A>>2]|0)*216|0)+((_[A+4>>2]|0)*72|0)+((_[A+8>>2]|0)*24|0)+(_[A+12>>2]<<3)>>2]|0}function il(A){return A=A|0,_[11120+((_[A>>2]|0)*216|0)+((_[A+4>>2]|0)*72|0)+((_[A+8>>2]|0)*24|0)+(_[A+12>>2]<<3)+4>>2]|0}function N_(A,g){A=A|0,g=g|0,A=7696+(A*28|0)|0,_[g>>2]=_[A>>2],_[g+4>>2]=_[A+4>>2],_[g+8>>2]=_[A+8>>2],_[g+12>>2]=_[A+12>>2]}function z_(A,g){A=A|0,g=g|0;var x=0,T=0;if(g>>>0>20)return g=-1,g|0;do if((_[11120+(g*216|0)>>2]|0)!=(A|0))if((_[11120+(g*216|0)+8>>2]|0)!=(A|0))if((_[11120+(g*216|0)+16>>2]|0)!=(A|0))if((_[11120+(g*216|0)+24>>2]|0)!=(A|0))if((_[11120+(g*216|0)+32>>2]|0)!=(A|0))if((_[11120+(g*216|0)+40>>2]|0)!=(A|0))if((_[11120+(g*216|0)+48>>2]|0)!=(A|0))if((_[11120+(g*216|0)+56>>2]|0)!=(A|0))if((_[11120+(g*216|0)+64>>2]|0)!=(A|0))if((_[11120+(g*216|0)+72>>2]|0)!=(A|0))if((_[11120+(g*216|0)+80>>2]|0)!=(A|0))if((_[11120+(g*216|0)+88>>2]|0)!=(A|0))if((_[11120+(g*216|0)+96>>2]|0)!=(A|0))if((_[11120+(g*216|0)+104>>2]|0)!=(A|0))if((_[11120+(g*216|0)+112>>2]|0)!=(A|0))if((_[11120+(g*216|0)+120>>2]|0)!=(A|0))if((_[11120+(g*216|0)+128>>2]|0)!=(A|0))if((_[11120+(g*216|0)+136>>2]|0)==(A|0))A=2,x=1,T=2;else{if((_[11120+(g*216|0)+144>>2]|0)==(A|0)){A=0,x=2,T=0;break}if((_[11120+(g*216|0)+152>>2]|0)==(A|0)){A=0,x=2,T=1;break}if((_[11120+(g*216|0)+160>>2]|0)==(A|0)){A=0,x=2,T=2;break}if((_[11120+(g*216|0)+168>>2]|0)==(A|0)){A=1,x=2,T=0;break}if((_[11120+(g*216|0)+176>>2]|0)==(A|0)){A=1,x=2,T=1;break}if((_[11120+(g*216|0)+184>>2]|0)==(A|0)){A=1,x=2,T=2;break}if((_[11120+(g*216|0)+192>>2]|0)==(A|0)){A=2,x=2,T=0;break}if((_[11120+(g*216|0)+200>>2]|0)==(A|0)){A=2,x=2,T=1;break}if((_[11120+(g*216|0)+208>>2]|0)==(A|0)){A=2,x=2,T=2;break}else A=-1;return A|0}else A=2,x=1,T=1;else A=2,x=1,T=0;else A=1,x=1,T=2;else A=1,x=1,T=1;else A=1,x=1,T=0;else A=0,x=1,T=2;else A=0,x=1,T=1;else A=0,x=1,T=0;else A=2,x=0,T=2;else A=2,x=0,T=1;else A=2,x=0,T=0;else A=1,x=0,T=2;else A=1,x=0,T=1;else A=1,x=0,T=0;else A=0,x=0,T=2;else A=0,x=0,T=1;else A=0,x=0,T=0;while(!1);return g=_[11120+(g*216|0)+(x*72|0)+(A*24|0)+(T<<3)+4>>2]|0,g|0}function g0(A,g){return A=A|0,g=g|0,(_[7696+(A*28|0)+20>>2]|0)==(g|0)?(g=1,g|0):(g=(_[7696+(A*28|0)+24>>2]|0)==(g|0),g|0)}function Fc(A,g){return A=A|0,g=g|0,_[848+(A*28|0)+(g<<2)>>2]|0}function yf(A,g){return A=A|0,g=g|0,(_[848+(A*28|0)>>2]|0)==(g|0)?(g=0,g|0):(_[848+(A*28|0)+4>>2]|0)==(g|0)?(g=1,g|0):(_[848+(A*28|0)+8>>2]|0)==(g|0)?(g=2,g|0):(_[848+(A*28|0)+12>>2]|0)==(g|0)?(g=3,g|0):(_[848+(A*28|0)+16>>2]|0)==(g|0)?(g=4,g|0):(_[848+(A*28|0)+20>>2]|0)==(g|0)?(g=5,g|0):((_[848+(A*28|0)+24>>2]|0)==(g|0)?6:7)|0}function m0(){return 122}function Td(A){A=A|0;var g=0,x=0,T=0;g=0;do Ot(g|0,0,45)|0,T=ve()|0|134225919,x=A+(g<<3)|0,_[x>>2]=-1,_[x+4>>2]=T,g=g+1|0;while((g|0)!=122);return 0}function _0(A){A=A|0;var g=0,x=0,T=0;return T=+fe[A+16>>3],x=+fe[A+24>>3],g=T-x,+(T<x?g+6.283185307179586:g)}function Sg(A){return A=A|0,+fe[A+16>>3]<+fe[A+24>>3]|0}function xf(A){return A=A|0,+(+fe[A>>3]-+fe[A+8>>3])}function bu(A,g){A=A|0,g=g|0;var x=0,T=0,M=0;return x=+fe[g>>3],!(x>=+fe[A+8>>3])||!(x<=+fe[A>>3])?(g=0,g|0):(T=+fe[A+16>>3],x=+fe[A+24>>3],M=+fe[g+8>>3],g=M>=x,A=M<=T&1,T<x?g&&(A=1):g||(A=0),g=(A|0)!=0,g|0)}function y0(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;return+fe[A>>3]<+fe[g+8>>3]||+fe[A+8>>3]>+fe[g>>3]?(T=0,T|0):(D=+fe[A+16>>3],x=A+24|0,ne=+fe[x>>3],O=D<ne,T=g+16|0,Z=+fe[T>>3],M=g+24|0,W=+fe[M>>3],N=Z<W,g=ne-Z<W-D,A=O?N|g?1:2:0,g=N?O?1:g?2:1:0,D=+ca(D,A),D<+ca(+fe[M>>3],g)||(ne=+ca(+fe[x>>3],A),ne>+ca(+fe[T>>3],g))?(N=0,N|0):(N=1,N|0))}function Cg(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0;D=+fe[A+16>>3],W=+fe[A+24>>3],A=D<W,N=+fe[g+16>>3],O=+fe[g+24>>3],M=N<O,g=W-N<O-D,_[x>>2]=A?M|g?1:2:0,_[T>>2]=M?A?1:g?2:1:0}function cr(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;return+fe[A>>3]<+fe[g>>3]||+fe[A+8>>3]>+fe[g+8>>3]?(T=0,T|0):(T=A+16|0,W=+fe[T>>3],D=+fe[A+24>>3],O=W<D,x=g+16|0,ne=+fe[x>>3],M=g+24|0,Z=+fe[M>>3],N=ne<Z,g=D-ne<Z-W,A=O?N|g?1:2:0,g=N?O?1:g?2:1:0,D=+ca(D,A),D<=+ca(+fe[M>>3],g)?(ne=+ca(+fe[T>>3],A),N=ne>=+ca(+fe[x>>3],g),N|0):(N=0,N|0))}function Ed(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0;M=Ae,Ae=Ae+176|0,T=M,_[T>>2]=4,N=+fe[g>>3],fe[T+8>>3]=N,D=+fe[g+16>>3],fe[T+16>>3]=D,fe[T+24>>3]=N,N=+fe[g+24>>3],fe[T+32>>3]=N,O=+fe[g+8>>3],fe[T+40>>3]=O,fe[T+48>>3]=N,fe[T+56>>3]=O,fe[T+64>>3]=D,g=T+72|0,x=g+96|0;do _[g>>2]=0,g=g+4|0;while((g|0)<(x|0));ri(A|0,T|0,168)|0,Ae=M}function U_(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0;Pe=Ae,Ae=Ae+288|0,ne=Pe+264|0,_e=Pe+96|0,Z=Pe,N=Z,W=N+96|0;do _[N>>2]=0,N=N+4|0;while((N|0)<(W|0));return g=Vd(g,Z)|0,g|0?(Se=g,Ae=Pe,Se|0):(W=Z,Z=_[W>>2]|0,W=_[W+4>>2]|0,sl(Z,W,ne)|0,uc(Z,W,_e)|0,O=+Bh(ne,_e+8|0),fe[ne>>3]=+fe[A>>3],W=ne+8|0,fe[W>>3]=+fe[A+16>>3],fe[_e>>3]=+fe[A+8>>3],Z=_e+8|0,fe[Z>>3]=+fe[A+24>>3],M=+Bh(ne,_e),et=+fe[W>>3]-+fe[Z>>3],D=+kr(+et),Ye=+fe[ne>>3]-+fe[_e>>3],T=+kr(+Ye),!(et==0|Ye==0)&&(et=+Pi(+D,+T),et=+bh(+(M*M/+Kr(+(et/+Kr(+D,+T)),3)/(O*(O*2.59807621135)*.8))),fe[Xi>>3]=et,Ce=~~et>>>0,Se=+kr(et)>=1?et>0?~~+u0(+bo(et/4294967296),4294967295)>>>0:~~+bh((et-+(~~et>>>0))/4294967296)>>>0:0,(_[Xi+4>>2]&2146435072|0)!=2146435072)?(_e=(Ce|0)==0&(Se|0)==0,g=x,_[g>>2]=_e?1:Ce,_[g+4>>2]=_e?0:Se,g=0):g=1,Se=g,Ae=Pe,Se|0)}function V_(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;Z=Ae,Ae=Ae+288|0,O=Z+264|0,N=Z+96|0,W=Z,M=W,D=M+96|0;do _[M>>2]=0,M=M+4|0;while((M|0)<(D|0));return x=Vd(x,W)|0,x|0?(T=x,Ae=Z,T|0):(x=W,M=_[x>>2]|0,x=_[x+4>>2]|0,sl(M,x,O)|0,uc(M,x,N)|0,ne=+Bh(O,N+8|0),ne=+bh(+(+Bh(A,g)/(ne*2))),fe[Xi>>3]=ne,x=~~ne>>>0,M=+kr(ne)>=1?ne>0?~~+u0(+bo(ne/4294967296),4294967295)>>>0:~~+bh((ne-+(~~ne>>>0))/4294967296)>>>0:0,(_[Xi+4>>2]&2146435072|0)==2146435072?(T=1,Ae=Z,T|0):(W=(x|0)==0&(M|0)==0,_[T>>2]=W?1:x,_[T+4>>2]=W?0:M,T=0,Ae=Z,T|0))}function Sd(A,g){A=A|0,g=+g;var x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;D=A+16|0,O=+fe[D>>3],x=A+24|0,M=+fe[x>>3],T=O-M,T=O<M?T+6.283185307179586:T,Z=+fe[A>>3],N=A+8|0,W=+fe[N>>3],ne=Z-W,T=(T*g-T)*.5,g=(ne*g-ne)*.5,Z=Z+g,fe[A>>3]=Z>1.5707963267948966?1.5707963267948966:Z,g=W-g,fe[N>>3]=g<-1.5707963267948966?-1.5707963267948966:g,g=O+T,g=g>3.141592653589793?g+-6.283185307179586:g,fe[D>>3]=g<-3.141592653589793?g+6.283185307179586:g,g=M-T,g=g>3.141592653589793?g+-6.283185307179586:g,fe[x>>3]=g<-3.141592653589793?g+6.283185307179586:g}function bx(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0,_[A>>2]=g,_[A+4>>2]=x,_[A+8>>2]=T}function wx(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0;_e=g+8|0,_[_e>>2]=0,W=+fe[A>>3],O=+kr(+W),Z=+fe[A+8>>3],N=+kr(+Z)*1.1547005383792515,O=O+N*.5,x=~~O,A=~~N,O=O-+(x|0),N=N-+(A|0);do if(O<.5)if(O<.3333333333333333)if(_[g>>2]=x,N<(O+1)*.5){_[g+4>>2]=A;break}else{A=A+1|0,_[g+4>>2]=A;break}else if(Ce=1-O,A=(!(N<Ce)&1)+A|0,_[g+4>>2]=A,Ce<=N&N<O*2){x=x+1|0,_[g>>2]=x;break}else{_[g>>2]=x;break}else{if(!(O<.6666666666666666))if(x=x+1|0,_[g>>2]=x,N<O*.5){_[g+4>>2]=A;break}else{A=A+1|0,_[g+4>>2]=A;break}if(N<1-O){if(_[g+4>>2]=A,O*2+-1<N){_[g>>2]=x;break}}else A=A+1|0,_[g+4>>2]=A;x=x+1|0,_[g>>2]=x}while(!1);do if(W<0)if(A&1){ne=(A+1|0)/2|0,ne=ct(x|0,((x|0)<0)<<31>>31|0,ne|0,((ne|0)<0)<<31>>31|0)|0,x=~~(+(x|0)-((+(ne>>>0)+4294967296*+(ve()|0))*2+1)),_[g>>2]=x;break}else{ne=(A|0)/2|0,ne=ct(x|0,((x|0)<0)<<31>>31|0,ne|0,((ne|0)<0)<<31>>31|0)|0,x=~~(+(x|0)-(+(ne>>>0)+4294967296*+(ve()|0))*2),_[g>>2]=x;break}while(!1);ne=g+4|0,Z<0&&(x=x-((A<<1|1|0)/2|0)|0,_[g>>2]=x,A=0-A|0,_[ne>>2]=A),T=A-x|0,(x|0)<0?(M=0-x|0,_[ne>>2]=T,_[_e>>2]=M,_[g>>2]=0,A=T,x=0):M=0,(A|0)<0&&(x=x-A|0,_[g>>2]=x,M=M-A|0,_[_e>>2]=M,_[ne>>2]=0,A=0),D=x-M|0,T=A-M|0,(M|0)<0&&(_[g>>2]=D,_[ne>>2]=T,_[_e>>2]=0,A=T,x=D,M=0),T=(A|0)<(x|0)?A:x,T=(M|0)<(T|0)?M:T,!((T|0)<=0)&&(_[g>>2]=x-T,_[ne>>2]=A-T,_[_e>>2]=M-T)}function ds(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0;g=_[A>>2]|0,O=A+4|0,x=_[O>>2]|0,(g|0)<0&&(x=x-g|0,_[O>>2]=x,D=A+8|0,_[D>>2]=(_[D>>2]|0)-g,_[A>>2]=0,g=0),(x|0)<0?(g=g-x|0,_[A>>2]=g,D=A+8|0,M=(_[D>>2]|0)-x|0,_[D>>2]=M,_[O>>2]=0,x=0):(M=A+8|0,D=M,M=_[M>>2]|0),(M|0)<0&&(g=g-M|0,_[A>>2]=g,x=x-M|0,_[O>>2]=x,_[D>>2]=0,M=0),T=(x|0)<(g|0)?x:g,T=(M|0)<(T|0)?M:T,!((T|0)<=0)&&(_[A>>2]=g-T,_[O>>2]=x-T,_[D>>2]=M-T)}function Eh(A,g){A=A|0,g=g|0;var x=0,T=0;T=_[A+8>>2]|0,x=+((_[A+4>>2]|0)-T|0),fe[g>>3]=+((_[A>>2]|0)-T|0)-x*.5,fe[g+8>>3]=x*.8660254037844386}function ps(A,g,x){A=A|0,g=g|0,x=x|0,_[x>>2]=(_[g>>2]|0)+(_[A>>2]|0),_[x+4>>2]=(_[g+4>>2]|0)+(_[A+4>>2]|0),_[x+8>>2]=(_[g+8>>2]|0)+(_[A+8>>2]|0)}function wu(A,g,x){A=A|0,g=g|0,x=x|0,_[x>>2]=(_[A>>2]|0)-(_[g>>2]|0),_[x+4>>2]=(_[A+4>>2]|0)-(_[g+4>>2]|0),_[x+8>>2]=(_[A+8>>2]|0)-(_[g+8>>2]|0)}function vf(A,g){A=A|0,g=g|0;var x=0,T=0;x=Ps(_[A>>2]|0,g)|0,_[A>>2]=x,x=A+4|0,T=Ps(_[x>>2]|0,g)|0,_[x>>2]=T,A=A+8|0,g=Ps(_[A>>2]|0,g)|0,_[A>>2]=g}function Sh(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;O=_[A>>2]|0,N=(O|0)<0,T=(_[A+4>>2]|0)-(N?O:0)|0,D=(T|0)<0,M=(D?0-T|0:0)+((_[A+8>>2]|0)-(N?O:0))|0,x=(M|0)<0,A=x?0:M,g=(D?0:T)-(x?M:0)|0,M=(N?0:O)-(D?T:0)-(x?M:0)|0,x=(g|0)<(M|0)?g:M,x=(A|0)<(x|0)?A:x,T=(x|0)>0,A=A-(T?x:0)|0,g=g-(T?x:0)|0;e:do switch(M-(T?x:0)|0){case 0:switch(g|0){case 0:return N=(A|0)==0?0:(A|0)==1?1:7,N|0;case 1:return N=(A|0)==0?2:(A|0)==1?3:7,N|0;default:break e}case 1:switch(g|0){case 0:return N=(A|0)==0?4:(A|0)==1?5:7,N|0;case 1:{if(!A)A=6;else break e;return A|0}default:break e}default:}while(!1);return N=7,N|0}function Mg(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0;if(W=A+8|0,O=_[W>>2]|0,N=(_[A>>2]|0)-O|0,Z=A+4|0,O=(_[Z>>2]|0)-O|0,N>>>0>715827881|O>>>0>715827881){if(T=(N|0)>0,M=2147483647-N|0,D=-2147483648-N|0,(T?(M|0)<(N|0):(D|0)>(N|0))||(x=N<<1,T?(2147483647-x|0)<(N|0):(-2147483648-x|0)>(N|0))||((O|0)>0?(2147483647-O|0)<(O|0):(-2147483648-O|0)>(O|0))||(g=N*3|0,x=O<<1,(T?(M|0)<(x|0):(D|0)>(x|0))||((N|0)>-1?(g|-2147483648|0)>=(O|0):(g^-2147483648|0)<(O|0))))return Z=1,Z|0}else x=O<<1,g=N*3|0;return T=De(+(g-O|0)*.14285714285714285)|0,_[A>>2]=T,M=De(+(x+N|0)*.14285714285714285)|0,_[Z>>2]=M,_[W>>2]=0,x=(M|0)<(T|0),g=x?T:M,x=x?M:T,(x|0)<0&&(((x|0)==-2147483648||((g|0)>0?(2147483647-g|0)<(x|0):(-2147483648-g|0)>(x|0)))&&Wn(27795,26892,354,26903),((g|0)>-1?(g|-2147483648|0)>=(x|0):(g^-2147483648|0)<(x|0))&&Wn(27795,26892,354,26903)),g=M-T|0,(T|0)<0?(x=0-T|0,_[Z>>2]=g,_[W>>2]=x,_[A>>2]=0,T=0):(g=M,x=0),(g|0)<0&&(T=T-g|0,_[A>>2]=T,x=x-g|0,_[W>>2]=x,_[Z>>2]=0,g=0),D=T-x|0,M=g-x|0,(x|0)<0?(_[A>>2]=D,_[Z>>2]=M,_[W>>2]=0,g=M,M=D,x=0):M=T,T=(g|0)<(M|0)?g:M,T=(x|0)<(T|0)?x:T,(T|0)<=0?(Z=0,Z|0):(_[A>>2]=M-T,_[Z>>2]=g-T,_[W>>2]=x-T,Z=0,Z|0)}function Ig(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0,W=0;if(O=A+8|0,M=_[O>>2]|0,D=(_[A>>2]|0)-M|0,N=A+4|0,M=(_[N>>2]|0)-M|0,D>>>0>715827881|M>>>0>715827881){if(x=(D|0)>0,(x?(2147483647-D|0)<(D|0):(-2147483648-D|0)>(D|0))||(g=D<<1,T=(M|0)>0,T?(2147483647-M|0)<(M|0):(-2147483648-M|0)>(M|0)))return N=1,N|0;if(W=M<<1,(T?(2147483647-W|0)<(M|0):(-2147483648-W|0)>(M|0))||(x?(2147483647-g|0)<(M|0):(-2147483648-g|0)>(M|0))||(x=M*3|0,(M|0)>-1?(x|-2147483648|0)>=(D|0):(x^-2147483648|0)<(D|0)))return W=1,W|0}else x=M*3|0,g=D<<1;return T=De(+(g+M|0)*.14285714285714285)|0,_[A>>2]=T,M=De(+(x-D|0)*.14285714285714285)|0,_[N>>2]=M,_[O>>2]=0,x=(M|0)<(T|0),g=x?T:M,x=x?M:T,(x|0)<0&&(((x|0)==-2147483648||((g|0)>0?(2147483647-g|0)<(x|0):(-2147483648-g|0)>(x|0)))&&Wn(27795,26892,402,26917),((g|0)>-1?(g|-2147483648|0)>=(x|0):(g^-2147483648|0)<(x|0))&&Wn(27795,26892,402,26917)),g=M-T|0,(T|0)<0?(x=0-T|0,_[N>>2]=g,_[O>>2]=x,_[A>>2]=0,T=0):(g=M,x=0),(g|0)<0&&(T=T-g|0,_[A>>2]=T,x=x-g|0,_[O>>2]=x,_[N>>2]=0,g=0),D=T-x|0,M=g-x|0,(x|0)<0?(_[A>>2]=D,_[N>>2]=M,_[O>>2]=0,g=M,M=D,x=0):M=T,T=(g|0)<(M|0)?g:M,T=(x|0)<(T|0)?x:T,(T|0)<=0?(W=0,W|0):(_[A>>2]=M-T,_[N>>2]=g-T,_[O>>2]=x-T,W=0,W|0)}function x0(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;O=A+8|0,x=_[O>>2]|0,g=(_[A>>2]|0)-x|0,N=A+4|0,x=(_[N>>2]|0)-x|0,T=De(+((g*3|0)-x|0)*.14285714285714285)|0,_[A>>2]=T,g=De(+((x<<1)+g|0)*.14285714285714285)|0,_[N>>2]=g,_[O>>2]=0,x=g-T|0,(T|0)<0?(D=0-T|0,_[N>>2]=x,_[O>>2]=D,_[A>>2]=0,g=x,T=0,x=D):x=0,(g|0)<0&&(T=T-g|0,_[A>>2]=T,x=x-g|0,_[O>>2]=x,_[N>>2]=0,g=0),D=T-x|0,M=g-x|0,(x|0)<0?(_[A>>2]=D,_[N>>2]=M,_[O>>2]=0,g=M,M=D,x=0):M=T,T=(g|0)<(M|0)?g:M,T=(x|0)<(T|0)?x:T,!((T|0)<=0)&&(_[A>>2]=M-T,_[N>>2]=g-T,_[O>>2]=x-T)}function Cd(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;O=A+8|0,x=_[O>>2]|0,g=(_[A>>2]|0)-x|0,N=A+4|0,x=(_[N>>2]|0)-x|0,T=De(+((g<<1)+x|0)*.14285714285714285)|0,_[A>>2]=T,g=De(+((x*3|0)-g|0)*.14285714285714285)|0,_[N>>2]=g,_[O>>2]=0,x=g-T|0,(T|0)<0?(D=0-T|0,_[N>>2]=x,_[O>>2]=D,_[A>>2]=0,g=x,T=0,x=D):x=0,(g|0)<0&&(T=T-g|0,_[A>>2]=T,x=x-g|0,_[O>>2]=x,_[N>>2]=0,g=0),D=T-x|0,M=g-x|0,(x|0)<0?(_[A>>2]=D,_[N>>2]=M,_[O>>2]=0,g=M,M=D,x=0):M=T,T=(g|0)<(M|0)?g:M,T=(x|0)<(T|0)?x:T,!((T|0)<=0)&&(_[A>>2]=M-T,_[N>>2]=g-T,_[O>>2]=x-T)}function Ll(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;g=_[A>>2]|0,O=A+4|0,x=_[O>>2]|0,N=A+8|0,T=_[N>>2]|0,M=x+(g*3|0)|0,_[A>>2]=M,x=T+(x*3|0)|0,_[O>>2]=x,g=(T*3|0)+g|0,_[N>>2]=g,T=x-M|0,(M|0)<0?(g=g-M|0,_[O>>2]=T,_[N>>2]=g,_[A>>2]=0,x=T,T=0):T=M,(x|0)<0&&(T=T-x|0,_[A>>2]=T,g=g-x|0,_[N>>2]=g,_[O>>2]=0,x=0),D=T-g|0,M=x-g|0,(g|0)<0?(_[A>>2]=D,_[O>>2]=M,_[N>>2]=0,T=D,g=0):M=x,x=(M|0)<(T|0)?M:T,x=(g|0)<(x|0)?g:x,!((x|0)<=0)&&(_[A>>2]=T-x,_[O>>2]=M-x,_[N>>2]=g-x)}function Oa(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;M=_[A>>2]|0,O=A+4|0,g=_[O>>2]|0,N=A+8|0,x=_[N>>2]|0,T=(g*3|0)+M|0,M=x+(M*3|0)|0,_[A>>2]=M,_[O>>2]=T,g=(x*3|0)+g|0,_[N>>2]=g,x=T-M|0,(M|0)<0?(g=g-M|0,_[O>>2]=x,_[N>>2]=g,_[A>>2]=0,M=0):x=T,(x|0)<0&&(M=M-x|0,_[A>>2]=M,g=g-x|0,_[N>>2]=g,_[O>>2]=0,x=0),D=M-g|0,T=x-g|0,(g|0)<0?(_[A>>2]=D,_[O>>2]=T,_[N>>2]=0,M=D,g=0):T=x,x=(T|0)<(M|0)?T:M,x=(g|0)<(x|0)?g:x,!((x|0)<=0)&&(_[A>>2]=M-x,_[O>>2]=T-x,_[N>>2]=g-x)}function v0(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0;(g+-1|0)>>>0>=6||(M=(_[15440+(g*12|0)>>2]|0)+(_[A>>2]|0)|0,_[A>>2]=M,N=A+4|0,T=(_[15440+(g*12|0)+4>>2]|0)+(_[N>>2]|0)|0,_[N>>2]=T,O=A+8|0,g=(_[15440+(g*12|0)+8>>2]|0)+(_[O>>2]|0)|0,_[O>>2]=g,x=T-M|0,(M|0)<0?(g=g-M|0,_[N>>2]=x,_[O>>2]=g,_[A>>2]=0,T=0):(x=T,T=M),(x|0)<0&&(T=T-x|0,_[A>>2]=T,g=g-x|0,_[O>>2]=g,_[N>>2]=0,x=0),D=T-g|0,M=x-g|0,(g|0)<0?(_[A>>2]=D,_[N>>2]=M,_[O>>2]=0,T=D,g=0):M=x,x=(M|0)<(T|0)?M:T,x=(g|0)<(x|0)?g:x,!((x|0)<=0)&&(_[A>>2]=T-x,_[N>>2]=M-x,_[O>>2]=g-x))}function G_(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;M=_[A>>2]|0,O=A+4|0,g=_[O>>2]|0,N=A+8|0,x=_[N>>2]|0,T=g+M|0,M=x+M|0,_[A>>2]=M,_[O>>2]=T,g=x+g|0,_[N>>2]=g,x=T-M|0,(M|0)<0?(g=g-M|0,_[O>>2]=x,_[N>>2]=g,_[A>>2]=0,T=0):(x=T,T=M),(x|0)<0&&(T=T-x|0,_[A>>2]=T,g=g-x|0,_[N>>2]=g,_[O>>2]=0,x=0),D=T-g|0,M=x-g|0,(g|0)<0?(_[A>>2]=D,_[O>>2]=M,_[N>>2]=0,T=D,g=0):M=x,x=(M|0)<(T|0)?M:T,x=(g|0)<(x|0)?g:x,!((x|0)<=0)&&(_[A>>2]=T-x,_[O>>2]=M-x,_[N>>2]=g-x)}function Tu(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;g=_[A>>2]|0,O=A+4|0,T=_[O>>2]|0,N=A+8|0,x=_[N>>2]|0,M=T+g|0,_[A>>2]=M,T=x+T|0,_[O>>2]=T,g=x+g|0,_[N>>2]=g,x=T-M|0,(M|0)<0?(g=g-M|0,_[O>>2]=x,_[N>>2]=g,_[A>>2]=0,T=0):(x=T,T=M),(x|0)<0&&(T=T-x|0,_[A>>2]=T,g=g-x|0,_[N>>2]=g,_[O>>2]=0,x=0),D=T-g|0,M=x-g|0,(g|0)<0?(_[A>>2]=D,_[O>>2]=M,_[N>>2]=0,T=D,g=0):M=x,x=(M|0)<(T|0)?M:T,x=(g|0)<(x|0)?g:x,!((x|0)<=0)&&(_[A>>2]=T-x,_[O>>2]=M-x,_[N>>2]=g-x)}function Ch(A){switch(A=A|0,A|0){case 1:{A=5;break}case 5:{A=4;break}case 4:{A=6;break}case 6:{A=2;break}case 2:{A=3;break}case 3:{A=1;break}default:}return A|0}function kc(A){switch(A=A|0,A|0){case 1:{A=3;break}case 3:{A=2;break}case 2:{A=6;break}case 6:{A=4;break}case 4:{A=5;break}case 5:{A=1;break}default:}return A|0}function bf(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;g=_[A>>2]|0,O=A+4|0,x=_[O>>2]|0,N=A+8|0,T=_[N>>2]|0,M=x+(g<<1)|0,_[A>>2]=M,x=T+(x<<1)|0,_[O>>2]=x,g=(T<<1)+g|0,_[N>>2]=g,T=x-M|0,(M|0)<0?(g=g-M|0,_[O>>2]=T,_[N>>2]=g,_[A>>2]=0,x=T,T=0):T=M,(x|0)<0&&(T=T-x|0,_[A>>2]=T,g=g-x|0,_[N>>2]=g,_[O>>2]=0,x=0),D=T-g|0,M=x-g|0,(g|0)<0?(_[A>>2]=D,_[O>>2]=M,_[N>>2]=0,T=D,g=0):M=x,x=(M|0)<(T|0)?M:T,x=(g|0)<(x|0)?g:x,!((x|0)<=0)&&(_[A>>2]=T-x,_[O>>2]=M-x,_[N>>2]=g-x)}function Md(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;M=_[A>>2]|0,O=A+4|0,g=_[O>>2]|0,N=A+8|0,x=_[N>>2]|0,T=(g<<1)+M|0,M=x+(M<<1)|0,_[A>>2]=M,_[O>>2]=T,g=(x<<1)+g|0,_[N>>2]=g,x=T-M|0,(M|0)<0?(g=g-M|0,_[O>>2]=x,_[N>>2]=g,_[A>>2]=0,M=0):x=T,(x|0)<0&&(M=M-x|0,_[A>>2]=M,g=g-x|0,_[N>>2]=g,_[O>>2]=0,x=0),D=M-g|0,T=x-g|0,(g|0)<0?(_[A>>2]=D,_[O>>2]=T,_[N>>2]=0,M=D,g=0):T=x,x=(T|0)<(M|0)?T:M,x=(g|0)<(x|0)?g:x,!((x|0)<=0)&&(_[A>>2]=M-x,_[O>>2]=T-x,_[N>>2]=g-x)}function b0(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0;return O=(_[A>>2]|0)-(_[g>>2]|0)|0,N=(O|0)<0,T=(_[A+4>>2]|0)-(_[g+4>>2]|0)-(N?O:0)|0,D=(T|0)<0,M=(N?0-O|0:0)+(_[A+8>>2]|0)-(_[g+8>>2]|0)+(D?0-T|0:0)|0,A=(M|0)<0,g=A?0:M,x=(D?0:T)-(A?M:0)|0,M=(N?0:O)-(D?T:0)-(A?M:0)|0,A=(x|0)<(M|0)?x:M,A=(g|0)<(A|0)?g:A,T=(A|0)>0,g=g-(T?A:0)|0,x=x-(T?A:0)|0,A=M-(T?A:0)|0,A=(A|0)>-1?A:0-A|0,x=(x|0)>-1?x:0-x|0,g=(g|0)>-1?g:0-g|0,g=(x|0)>(g|0)?x:g,((A|0)>(g|0)?A:g)|0}function H_(A,g){A=A|0,g=g|0;var x=0;x=_[A+8>>2]|0,_[g>>2]=(_[A>>2]|0)-x,_[g+4>>2]=(_[A+4>>2]|0)-x}function Id(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0;return T=_[A>>2]|0,_[g>>2]=T,M=_[A+4>>2]|0,O=g+4|0,_[O>>2]=M,N=g+8|0,_[N>>2]=0,x=(M|0)<(T|0),A=x?T:M,x=x?M:T,(x|0)<0&&((x|0)==-2147483648||((A|0)>0?(2147483647-A|0)<(x|0):(-2147483648-A|0)>(x|0))||((A|0)>-1?(A|-2147483648|0)>=(x|0):(A^-2147483648|0)<(x|0)))?(g=1,g|0):(A=M-T|0,(T|0)<0?(x=0-T|0,_[O>>2]=A,_[N>>2]=x,_[g>>2]=0,T=0):(A=M,x=0),(A|0)<0&&(T=T-A|0,_[g>>2]=T,x=x-A|0,_[N>>2]=x,_[O>>2]=0,A=0),D=T-x|0,M=A-x|0,(x|0)<0?(_[g>>2]=D,_[O>>2]=M,_[N>>2]=0,A=M,M=D,x=0):M=T,T=(A|0)<(M|0)?A:M,T=(x|0)<(T|0)?x:T,(T|0)<=0?(g=0,g|0):(_[g>>2]=M-T,_[O>>2]=A-T,_[N>>2]=x-T,g=0,g|0))}function Pd(A){A=A|0;var g=0,x=0,T=0,M=0;g=A+8|0,M=_[g>>2]|0,x=M-(_[A>>2]|0)|0,_[A>>2]=x,T=A+4|0,A=(_[T>>2]|0)-M|0,_[T>>2]=A,_[g>>2]=0-(A+x)}function W_(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;x=_[A>>2]|0,g=0-x|0,_[A>>2]=g,O=A+8|0,_[O>>2]=0,N=A+4|0,T=_[N>>2]|0,M=T+x|0,(x|0)>0?(_[N>>2]=M,_[O>>2]=x,_[A>>2]=0,g=0,T=M):x=0,(T|0)<0?(D=g-T|0,_[A>>2]=D,x=x-T|0,_[O>>2]=x,_[N>>2]=0,M=D-x|0,g=0-x|0,(x|0)<0?(_[A>>2]=M,_[N>>2]=g,_[O>>2]=0,T=g,x=0):(T=0,M=D)):M=g,g=(T|0)<(M|0)?T:M,g=(x|0)<(g|0)?x:g,!((g|0)<=0)&&(_[A>>2]=M-g,_[N>>2]=T-g,_[O>>2]=x-g)}function j_(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0;if(_e=Ae,Ae=Ae+64|0,ne=_e,N=_e+56|0,!(!0&(g&2013265920|0)==134217728&(!0&(T&2013265920|0)==134217728)))return M=5,Ae=_e,M|0;if((A|0)==(x|0)&(g|0)==(T|0))return _[M>>2]=0,M=0,Ae=_e,M|0;if(O=Tt(A|0,g|0,52)|0,ve()|0,O=O&15,Z=Tt(x|0,T|0,52)|0,ve()|0,(O|0)!=(Z&15|0))return M=12,Ae=_e,M|0;if(D=O+-1|0,O>>>0>1){cc(A,g,D,ne)|0,cc(x,T,D,N)|0,Z=ne,W=_[Z>>2]|0,Z=_[Z+4>>2]|0;e:do if((W|0)==(_[N>>2]|0)&&(Z|0)==(_[N+4>>2]|0)){O=(O^15)*3|0,D=Tt(A|0,g|0,O|0)|0,ve()|0,D=D&7,O=Tt(x|0,T|0,O|0)|0,ve()|0,O=O&7;do if((D|0)==0|(O|0)==0)_[M>>2]=1,D=0;else if((D|0)==7)D=5;else{if((D|0)==1|(O|0)==1&&dr(W,Z)|0){D=5;break}if((_[15536+(D<<2)>>2]|0)!=(O|0)&&(_[15568+(D<<2)>>2]|0)!=(O|0))break e;_[M>>2]=1,D=0}while(!1);return M=D,Ae=_e,M|0}while(!1)}D=ne,O=D+56|0;do _[D>>2]=0,D=D+4|0;while((D|0)<(O|0));return bd(A,g,1,ne)|0,g=ne,!((_[g>>2]|0)==(x|0)&&(_[g+4>>2]|0)==(T|0))&&(g=ne+8|0,!((_[g>>2]|0)==(x|0)&&(_[g+4>>2]|0)==(T|0)))&&(g=ne+16|0,!((_[g>>2]|0)==(x|0)&&(_[g+4>>2]|0)==(T|0)))&&(g=ne+24|0,!((_[g>>2]|0)==(x|0)&&(_[g+4>>2]|0)==(T|0)))&&(g=ne+32|0,!((_[g>>2]|0)==(x|0)&&(_[g+4>>2]|0)==(T|0)))&&(g=ne+40|0,!((_[g>>2]|0)==(x|0)&&(_[g+4>>2]|0)==(T|0)))?(D=ne+48|0,D=((_[D>>2]|0)==(x|0)?(_[D+4>>2]|0)==(T|0):0)&1):D=1,_[M>>2]=D,M=0,Ae=_e,M|0}function uo(A,g,x,T,M){return A=A|0,g=g|0,x=x|0,T=T|0,M=M|0,x=Tg(A,g,x,T)|0,(x|0)==7?(M=11,M|0):(T=Ot(x|0,0,56)|0,g=g&-2130706433|(ve()|0)|268435456,_[M>>2]=A|T,_[M+4>>2]=g,M=0,M|0)}function Mh(A,g,x){return A=A|0,g=g|0,x=x|0,!0&(g&2013265920|0)==268435456?(_[x>>2]=A,_[x+4>>2]=g&-2130706433|134217728,x=0,x|0):(x=6,x|0)}function Fa(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0;return M=Ae,Ae=Ae+16|0,T=M,_[T>>2]=0,!0&(g&2013265920|0)==268435456?(D=Tt(A|0,g|0,56)|0,ve()|0,T=Ho(A,g&-2130706433|134217728,D&7,T,x)|0,Ae=M,T|0):(T=6,Ae=M,T|0)}function Rd(A,g){A=A|0,g=g|0;var x=0;switch(x=Tt(A|0,g|0,56)|0,ve()|0,x&7){case 0:case 7:return x=0,x|0;default:}return x=g&-2130706433|134217728,!(!0&(g&2013265920|0)==268435456)||!0&(g&117440512|0)==16777216&(dr(A,x)|0)!=0?(x=0,x|0):(x=S0(A,x)|0,x|0)}function Bd(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0;return M=Ae,Ae=Ae+16|0,T=M,!0&(g&2013265920|0)==268435456?(D=g&-2130706433|134217728,O=x,_[O>>2]=A,_[O+4>>2]=D,_[T>>2]=0,g=Tt(A|0,g|0,56)|0,ve()|0,T=Ho(A,D,g&7,T,x+8|0)|0,Ae=M,T|0):(T=6,Ae=M,T|0)}function w0(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0;return M=(dr(A,g)|0)==0,g=g&-2130706433,T=x,_[T>>2]=M?A:0,_[T+4>>2]=M?g|285212672:0,T=x+8|0,_[T>>2]=A,_[T+4>>2]=g|301989888,T=x+16|0,_[T>>2]=A,_[T+4>>2]=g|318767104,T=x+24|0,_[T>>2]=A,_[T+4>>2]=g|335544320,T=x+32|0,_[T>>2]=A,_[T+4>>2]=g|352321536,x=x+40|0,_[x>>2]=A,_[x+4>>2]=g|369098752,0}function Ol(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0;return O=Ae,Ae=Ae+16|0,M=O,D=g&-2130706433|134217728,!0&(g&2013265920|0)==268435456?(T=Tt(A|0,g|0,56)|0,ve()|0,T=L(A,D,T&7)|0,(T|0)==-1?(_[x>>2]=0,D=6,Ae=O,D|0):(Cu(A,D,M)|0&&Wn(27795,26932,282,26947),g=Tt(A|0,g|0,52)|0,ve()|0,g=g&15,dr(A,D)|0?T0(M,g,T,2,x):Ld(M,g,T,2,x),D=0,Ae=O,D|0)):(D=6,Ae=O,D|0)}function Dd(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0;T=Ae,Ae=Ae+16|0,M=T,Ih(A,g,x,M),wx(M,x+4|0),Ae=T}function Ih(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0;if(N=Ae,Ae=Ae+16|0,W=N,wf(A,x,W),D=+mg(+(1-+fe[W>>3]*.5)),D<1e-16){_[T>>2]=0,_[T+4>>2]=0,_[T+8>>2]=0,_[T+12>>2]=0,Ae=N;return}if(W=_[x>>2]|0,M=+fe[15920+(W*24|0)>>3],M=+Pf(M-+Pf(+Iu(15600+(W<<4)|0,A))),ho(g)|0?O=+Pf(M+-.3334731722518321):O=M,M=+vh(+D)*2.618033988749896,(g|0)>0){A=0;do M=M*2.6457513110645907,A=A+1|0;while((A|0)!=(g|0))}D=+Sr(+O)*M,fe[T>>3]=D,O=+Nr(+O)*M,fe[T+8>>3]=O,Ae=N}function wf(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0;if(D=Ae,Ae=Ae+32|0,M=D,P(A,M),_[g>>2]=0,fe[x>>3]=5,T=+w(16400,M),T<+fe[x>>3]&&(_[g>>2]=0,fe[x>>3]=T),T=+w(16424,M),T<+fe[x>>3]&&(_[g>>2]=1,fe[x>>3]=T),T=+w(16448,M),T<+fe[x>>3]&&(_[g>>2]=2,fe[x>>3]=T),T=+w(16472,M),T<+fe[x>>3]&&(_[g>>2]=3,fe[x>>3]=T),T=+w(16496,M),T<+fe[x>>3]&&(_[g>>2]=4,fe[x>>3]=T),T=+w(16520,M),T<+fe[x>>3]&&(_[g>>2]=5,fe[x>>3]=T),T=+w(16544,M),T<+fe[x>>3]&&(_[g>>2]=6,fe[x>>3]=T),T=+w(16568,M),T<+fe[x>>3]&&(_[g>>2]=7,fe[x>>3]=T),T=+w(16592,M),T<+fe[x>>3]&&(_[g>>2]=8,fe[x>>3]=T),T=+w(16616,M),T<+fe[x>>3]&&(_[g>>2]=9,fe[x>>3]=T),T=+w(16640,M),T<+fe[x>>3]&&(_[g>>2]=10,fe[x>>3]=T),T=+w(16664,M),T<+fe[x>>3]&&(_[g>>2]=11,fe[x>>3]=T),T=+w(16688,M),T<+fe[x>>3]&&(_[g>>2]=12,fe[x>>3]=T),T=+w(16712,M),T<+fe[x>>3]&&(_[g>>2]=13,fe[x>>3]=T),T=+w(16736,M),T<+fe[x>>3]&&(_[g>>2]=14,fe[x>>3]=T),T=+w(16760,M),T<+fe[x>>3]&&(_[g>>2]=15,fe[x>>3]=T),T=+w(16784,M),T<+fe[x>>3]&&(_[g>>2]=16,fe[x>>3]=T),T=+w(16808,M),T<+fe[x>>3]&&(_[g>>2]=17,fe[x>>3]=T),T=+w(16832,M),T<+fe[x>>3]&&(_[g>>2]=18,fe[x>>3]=T),T=+w(16856,M),!(T<+fe[x>>3])){Ae=D;return}_[g>>2]=19,fe[x>>3]=T,Ae=D}function Tf(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0;if(D=+l(A),D<1e-16){g=15600+(g<<4)|0,_[M>>2]=_[g>>2],_[M+4>>2]=_[g+4>>2],_[M+8>>2]=_[g+8>>2],_[M+12>>2]=_[g+12>>2];return}if(O=+La(+ +fe[A+8>>3],+ +fe[A>>3]),(x|0)>0){A=0;do D=D*.37796447300922725,A=A+1|0;while((A|0)!=(x|0))}N=D*.3333333333333333,T?(x=(ho(x)|0)==0,D=+c0(+((x?N:N*.37796447300922725)*.381966011250105))):(D=+c0(+(D*.381966011250105)),ho(x)|0&&(O=+Pf(O+.3334731722518321))),ci(15600+(g<<4)|0,+Pf(+fe[15920+(g*24|0)>>3]-O),D,M)}function X_(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0;T=Ae,Ae=Ae+16|0,M=T,Eh(A+4|0,M),Tf(M,_[A>>2]|0,g,0,x),Ae=T}function T0(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0,qt=0,xn=0,dn=0,Vn=0,qn=0,ur=0,Gn=0,Tn=0,Zt=0,hr=0,wi=0,ir=0;if(hr=Ae,Ae=Ae+272|0,D=hr+256|0,at=hr+240|0,Gn=hr,Tn=hr+224|0,Zt=hr+208|0,lt=hr+176|0,qe=hr+160|0,qt=hr+192|0,xn=hr+144|0,dn=hr+128|0,Vn=hr+112|0,qn=hr+96|0,ur=hr+80|0,_[D>>2]=g,_[at>>2]=_[A>>2],_[at+4>>2]=_[A+4>>2],_[at+8>>2]=_[A+8>>2],_[at+12>>2]=_[A+12>>2],Pg(at,D,Gn),_[M>>2]=0,at=T+x+((T|0)==5&1)|0,(at|0)<=(x|0)){Ae=hr;return}W=_[D>>2]|0,Z=Tn+4|0,ne=lt+4|0,_e=x+5|0,Ce=16880+(W<<2)|0,Se=16960+(W<<2)|0,Pe=dn+8|0,Ye=Vn+8|0,et=qn+8|0,yt=Zt+4|0,N=x;e:for(;;){O=Gn+(((N|0)%5|0)<<4)|0,_[Zt>>2]=_[O>>2],_[Zt+4>>2]=_[O+4>>2],_[Zt+8>>2]=_[O+8>>2],_[Zt+12>>2]=_[O+12>>2];do;while((Ph(Zt,W,0,1)|0)==2);if((N|0)>(x|0)&(ho(g)|0)!=0){if(_[lt>>2]=_[Zt>>2],_[lt+4>>2]=_[Zt+4>>2],_[lt+8>>2]=_[Zt+8>>2],_[lt+12>>2]=_[Zt+12>>2],Eh(Z,qe),T=_[lt>>2]|0,D=_[17040+(T*80|0)+(_[Tn>>2]<<2)>>2]|0,_[lt>>2]=_[18640+(T*80|0)+(D*20|0)>>2],O=_[18640+(T*80|0)+(D*20|0)+16>>2]|0,(O|0)>0){A=0;do G_(ne),A=A+1|0;while((A|0)<(O|0))}switch(O=18640+(T*80|0)+(D*20|0)+4|0,_[qt>>2]=_[O>>2],_[qt+4>>2]=_[O+4>>2],_[qt+8>>2]=_[O+8>>2],vf(qt,(_[Ce>>2]|0)*3|0),ps(ne,qt,ne),ds(ne),Eh(ne,xn),wi=+(_[Se>>2]|0),fe[dn>>3]=wi*3,fe[Pe>>3]=0,ir=wi*-1.5,fe[Vn>>3]=ir,fe[Ye>>3]=wi*2.598076211353316,fe[qn>>3]=ir,fe[et>>3]=wi*-2.598076211353316,_[17040+((_[lt>>2]|0)*80|0)+(_[Zt>>2]<<2)>>2]|0){case 1:{A=Vn,T=dn;break}case 3:{A=qn,T=Vn;break}case 2:{A=dn,T=qn;break}default:{A=12;break e}}f(qe,xn,T,A,ur),Tf(ur,_[lt>>2]|0,W,1,M+8+(_[M>>2]<<4)|0),_[M>>2]=(_[M>>2]|0)+1}if((N|0)<(_e|0)&&(Eh(yt,lt),Tf(lt,_[Zt>>2]|0,W,1,M+8+(_[M>>2]<<4)|0),_[M>>2]=(_[M>>2]|0)+1),_[Tn>>2]=_[Zt>>2],_[Tn+4>>2]=_[Zt+4>>2],_[Tn+8>>2]=_[Zt+8>>2],_[Tn+12>>2]=_[Zt+12>>2],N=N+1|0,(N|0)>=(at|0)){A=3;break}}if((A|0)==3){Ae=hr;return}else(A|0)==12&&Wn(26970,27017,572,27027)}function Pg(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0;W=Ae,Ae=Ae+128|0,T=W+64|0,M=W,D=T,O=20240,N=D+60|0;do _[D>>2]=_[O>>2],D=D+4|0,O=O+4|0;while((D|0)<(N|0));D=M,O=20304,N=D+60|0;do _[D>>2]=_[O>>2],D=D+4|0,O=O+4|0;while((D|0)<(N|0));N=(ho(_[g>>2]|0)|0)==0,T=N?T:M,M=A+4|0,bf(M),Md(M),ho(_[g>>2]|0)|0&&(Oa(M),_[g>>2]=(_[g>>2]|0)+1),_[x>>2]=_[A>>2],g=x+4|0,ps(M,T,g),ds(g),_[x+16>>2]=_[A>>2],g=x+20|0,ps(M,T+12|0,g),ds(g),_[x+32>>2]=_[A>>2],g=x+36|0,ps(M,T+24|0,g),ds(g),_[x+48>>2]=_[A>>2],g=x+52|0,ps(M,T+36|0,g),ds(g),_[x+64>>2]=_[A>>2],x=x+68|0,ps(M,T+48|0,x),ds(x),Ae=W}function Ph(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0;if(Pe=Ae,Ae=Ae+32|0,Ce=Pe+12|0,N=Pe,Se=A+4|0,_e=_[16960+(g<<2)>>2]|0,ne=(T|0)!=0,_e=ne?_e*3|0:_e,M=_[Se>>2]|0,Z=A+8|0,O=_[Z>>2]|0,ne){if(D=A+12|0,T=_[D>>2]|0,M=O+M+T|0,(M|0)==(_e|0))return Se=1,Ae=Pe,Se|0;W=D}else W=A+12|0,T=_[W>>2]|0,M=O+M+T|0;if((M|0)<=(_e|0))return Se=0,Ae=Pe,Se|0;do if((T|0)>0){if(T=_[A>>2]|0,(O|0)>0){D=18640+(T*80|0)+60|0,T=A;break}T=18640+(T*80|0)+40|0,x?(bx(Ce,_e,0,0),wu(Se,Ce,N),Tu(N),ps(N,Ce,Se),D=T,T=A):(D=T,T=A)}else D=18640+((_[A>>2]|0)*80|0)+20|0,T=A;while(!1);if(_[T>>2]=_[D>>2],M=D+16|0,(_[M>>2]|0)>0){T=0;do G_(Se),T=T+1|0;while((T|0)<(_[M>>2]|0))}return A=D+4|0,_[Ce>>2]=_[A>>2],_[Ce+4>>2]=_[A+4>>2],_[Ce+8>>2]=_[A+8>>2],g=_[16880+(g<<2)>>2]|0,vf(Ce,ne?g*3|0:g),ps(Se,Ce,Se),ds(Se),ne?T=((_[Z>>2]|0)+(_[Se>>2]|0)+(_[W>>2]|0)|0)==(_e|0)?1:2:T=2,Se=T,Ae=Pe,Se|0}function Eu(A,g){A=A|0,g=g|0;var x=0;do x=Ph(A,g,0,1)|0;while((x|0)==2);return x|0}function Ld(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0,qt=0,xn=0,dn=0,Vn=0,qn=0,ur=0,Gn=0;if(qn=Ae,Ae=Ae+240|0,D=qn+224|0,qt=qn+208|0,xn=qn,dn=qn+192|0,Vn=qn+176|0,et=qn+160|0,yt=qn+144|0,at=qn+128|0,lt=qn+112|0,qe=qn+96|0,_[D>>2]=g,_[qt>>2]=_[A>>2],_[qt+4>>2]=_[A+4>>2],_[qt+8>>2]=_[A+8>>2],_[qt+12>>2]=_[A+12>>2],E0(qt,D,xn),_[M>>2]=0,Ye=T+x+((T|0)==6&1)|0,(Ye|0)<=(x|0)){Ae=qn;return}W=_[D>>2]|0,Z=x+6|0,ne=16960+(W<<2)|0,_e=yt+8|0,Ce=at+8|0,Se=lt+8|0,Pe=dn+4|0,O=0,N=x,T=-1;e:for(;;){if(D=(N|0)%6|0,A=xn+(D<<4)|0,_[dn>>2]=_[A>>2],_[dn+4>>2]=_[A+4>>2],_[dn+8>>2]=_[A+8>>2],_[dn+12>>2]=_[A+12>>2],A=O,O=Ph(dn,W,0,1)|0,(N|0)>(x|0)&(ho(g)|0)!=0&&(A|0)!=1&&(_[dn>>2]|0)!=(T|0)){switch(Eh(xn+(((D+5|0)%6|0)<<4)+4|0,Vn),Eh(xn+(D<<4)+4|0,et),ur=+(_[ne>>2]|0),fe[yt>>3]=ur*3,fe[_e>>3]=0,Gn=ur*-1.5,fe[at>>3]=Gn,fe[Ce>>3]=ur*2.598076211353316,fe[lt>>3]=Gn,fe[Se>>3]=ur*-2.598076211353316,D=_[qt>>2]|0,_[17040+(D*80|0)+(((T|0)==(D|0)?_[dn>>2]|0:T)<<2)>>2]|0){case 1:{A=at,T=yt;break}case 3:{A=lt,T=at;break}case 2:{A=yt,T=lt;break}default:{A=8;break e}}f(Vn,et,T,A,qe),!(y(Vn,qe)|0)&&!(y(et,qe)|0)&&(Tf(qe,_[qt>>2]|0,W,1,M+8+(_[M>>2]<<4)|0),_[M>>2]=(_[M>>2]|0)+1)}if((N|0)<(Z|0)&&(Eh(Pe,Vn),Tf(Vn,_[dn>>2]|0,W,1,M+8+(_[M>>2]<<4)|0),_[M>>2]=(_[M>>2]|0)+1),N=N+1|0,(N|0)>=(Ye|0)){A=3;break}else T=_[dn>>2]|0}if((A|0)==3){Ae=qn;return}else(A|0)==8&&Wn(27054,27017,737,27099)}function E0(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0;W=Ae,Ae=Ae+160|0,T=W+80|0,M=W,D=T,O=20368,N=D+72|0;do _[D>>2]=_[O>>2],D=D+4|0,O=O+4|0;while((D|0)<(N|0));D=M,O=20448,N=D+72|0;do _[D>>2]=_[O>>2],D=D+4|0,O=O+4|0;while((D|0)<(N|0));N=(ho(_[g>>2]|0)|0)==0,T=N?T:M,M=A+4|0,bf(M),Md(M),ho(_[g>>2]|0)|0&&(Oa(M),_[g>>2]=(_[g>>2]|0)+1),_[x>>2]=_[A>>2],g=x+4|0,ps(M,T,g),ds(g),_[x+16>>2]=_[A>>2],g=x+20|0,ps(M,T+12|0,g),ds(g),_[x+32>>2]=_[A>>2],g=x+36|0,ps(M,T+24|0,g),ds(g),_[x+48>>2]=_[A>>2],g=x+52|0,ps(M,T+36|0,g),ds(g),_[x+64>>2]=_[A>>2],g=x+68|0,ps(M,T+48|0,g),ds(g),_[x+80>>2]=_[A>>2],x=x+84|0,ps(M,T+60|0,x),ds(x),Ae=W}function Od(A,g){return A=A|0,g=g|0,g=Tt(A|0,g|0,52)|0,ve()|0,g&15|0}function Rg(A,g){return A=A|0,g=g|0,g=Tt(A|0,g|0,45)|0,ve()|0,g&127|0}function Bg(A,g,x,T){return A=A|0,g=g|0,x=x|0,T=T|0,(x+-1|0)>>>0>14?(T=4,T|0):(x=Tt(A|0,g|0,(15-x|0)*3|0)|0,ve()|0,_[T>>2]=x&7,T=0,T|0)}function Dg(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0;if(A>>>0>15)return T=4,T|0;if(g>>>0>121)return T=17,T|0;O=Ot(A|0,0,52)|0,M=ve()|0,N=Ot(g|0,0,45)|0,M=M|(ve()|0)|134225919;e:do if((A|0)>=1){for(N=1,O=(zt[20528+g>>0]|0)!=0,D=-1;;){if(g=_[x+(N+-1<<2)>>2]|0,g>>>0>6){M=18,g=10;break}if(!((g|0)==0|O^1))if((g|0)==1){M=19,g=10;break}else O=0;if(Z=(15-N|0)*3|0,W=Ot(7,0,Z|0)|0,M=M&~(ve()|0),g=Ot(g|0,((g|0)<0)<<31>>31|0,Z|0)|0,D=g|D&~W,M=ve()|0|M,(N|0)<(A|0))N=N+1|0;else break e}if((g|0)==10)return M|0}else D=-1;while(!1);return Z=T,_[Z>>2]=D,_[Z+4>>2]=M,Z=0,Z|0}function S0(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0;return!(!0&(g&-16777216|0)==134217728)||(T=Tt(A|0,g|0,52)|0,ve()|0,T=T&15,x=Tt(A|0,g|0,45)|0,ve()|0,x=x&127,x>>>0>121)?(A=0,A|0):(O=(T^15)*3|0,M=Tt(A|0,g|0,O|0)|0,O=Ot(M|0,ve()|0,O|0)|0,M=ve()|0,D=ct(-1227133514,-1171,O|0,M|0)|0,!((O&613566756&D|0)==0&(M&4681&(ve()|0)|0)==0)||(O=(T*3|0)+19|0,D=Ot(~A|0,~g|0,O|0)|0,O=Tt(D|0,ve()|0,O|0)|0,!((T|0)==15|(O|0)==0&(ve()|0)==0))?(O=0,O|0):!(zt[20528+x>>0]|0)||(g=g&8191,(A|0)==0&(g|0)==0)?(O=1,O|0):(O=ni(A|0,g|0,0)|0,ve()|0,((63-O|0)%3|0|0)!=0|0))}function Lg(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0;return!0&(g&-16777216|0)==134217728&&(T=Tt(A|0,g|0,52)|0,ve()|0,T=T&15,x=Tt(A|0,g|0,45)|0,ve()|0,x=x&127,x>>>0<=121)&&(O=(T^15)*3|0,M=Tt(A|0,g|0,O|0)|0,O=Ot(M|0,ve()|0,O|0)|0,M=ve()|0,D=ct(-1227133514,-1171,O|0,M|0)|0,(O&613566756&D|0)==0&(M&4681&(ve()|0)|0)==0)&&(O=(T*3|0)+19|0,D=Ot(~A|0,~g|0,O|0)|0,O=Tt(D|0,ve()|0,O|0)|0,(T|0)==15|(O|0)==0&(ve()|0)==0)&&(!(zt[20528+x>>0]|0)||(x=g&8191,(A|0)==0&(x|0)==0)||(O=ni(A|0,x|0,0)|0,ve()|0,(63-O|0)%3|0|0))||Rd(A,g)|0?(O=1,O|0):(O=(ie(A,g)|0)!=0&1,O|0)}function Fd(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0;if(M=Ot(g|0,0,52)|0,D=ve()|0,x=Ot(x|0,0,45)|0,x=D|(ve()|0)|134225919,(g|0)<1){D=-1,T=x,g=A,_[g>>2]=D,A=A+4|0,_[A>>2]=T;return}for(D=1,M=-1;O=(15-D|0)*3|0,N=Ot(7,0,O|0)|0,x=x&~(ve()|0),O=Ot(T|0,0,O|0)|0,M=M&~N|O,x=x|(ve()|0),(D|0)!=(g|0);)D=D+1|0;N=A,O=N,_[O>>2]=M,N=N+4|0,_[N>>2]=x}function cc(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0;if(D=Tt(A|0,g|0,52)|0,ve()|0,D=D&15,x>>>0>15)return T=4,T|0;if((D|0)<(x|0))return T=12,T|0;if((D|0)==(x|0))return _[T>>2]=A,_[T+4>>2]=g,T=0,T|0;if(M=Ot(x|0,0,52)|0,M=M|A,A=ve()|0|g&-15728641,(D|0)>(x|0))do g=Ot(7,0,(14-x|0)*3|0)|0,x=x+1|0,M=g|M,A=ve()|0|A;while((x|0)<(D|0));return _[T>>2]=M,_[T+4>>2]=A,T=0,T|0}function Ef(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0;if(D=Tt(A|0,g|0,52)|0,ve()|0,D=D&15,!((x|0)<16&(D|0)<=(x|0)))return T=4,T|0;M=x-D|0,x=Tt(A|0,g|0,45)|0,ve()|0;e:do if(!(Qr(x&127)|0))x=ua(7,0,M,((M|0)<0)<<31>>31)|0,M=ve()|0;else{t:do if(D|0){for(x=1;O=Ot(7,0,(15-x|0)*3|0)|0,!!((O&A|0)==0&((ve()|0)&g|0)==0);)if(x>>>0<D>>>0)x=x+1|0;else break t;x=ua(7,0,M,((M|0)<0)<<31>>31)|0,M=ve()|0;break e}while(!1);x=ua(7,0,M,((M|0)<0)<<31>>31)|0,x=Ut(x|0,ve()|0,5,0)|0,x=Ve(x|0,ve()|0,-5,-1)|0,x=ft(x|0,ve()|0,6,0)|0,x=Ve(x|0,ve()|0,1,0)|0,M=ve()|0}while(!1);return O=T,_[O>>2]=x,_[O+4>>2]=M,O=0,O|0}function dr(A,g){A=A|0,g=g|0;var x=0,T=0,M=0;if(M=Tt(A|0,g|0,45)|0,ve()|0,!(Qr(M&127)|0))return M=0,M|0;M=Tt(A|0,g|0,52)|0,ve()|0,M=M&15;e:do if(!M)x=0;else for(T=1;;){if(x=Tt(A|0,g|0,(15-T|0)*3|0)|0,ve()|0,x=x&7,x|0)break e;if(T>>>0<M>>>0)T=T+1|0;else{x=0;break}}while(!1);return M=(x|0)==0&1,M|0}function Fl(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0;if(O=Ae,Ae=Ae+16|0,D=O,Fg(D,A,g,x),g=D,A=_[g>>2]|0,g=_[g+4>>2]|0,(A|0)==0&(g|0)==0)return Ae=O,0;M=0,x=0;do N=T+(M<<3)|0,_[N>>2]=A,_[N+4>>2]=g,M=Ve(M|0,x|0,1,0)|0,x=ve()|0,If(D),N=D,A=_[N>>2]|0,g=_[N+4>>2]|0;while(!((A|0)==0&(g|0)==0));return Ae=O,0}function Og(A,g,x,T){return A=A|0,g=g|0,x=x|0,T=T|0,(T|0)<(x|0)?(x=g,T=A,Jn(x|0),T|0):(x=Ot(-1,-1,((T-x|0)*3|0)+3|0)|0,T=Ot(~x|0,~(ve()|0)|0,(15-T|0)*3|0)|0,x=~(ve()|0)&g,T=~T&A,Jn(x|0),T|0)}function ol(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0;return M=Tt(A|0,g|0,52)|0,ve()|0,M=M&15,(x|0)<16&(M|0)<=(x|0)?((M|0)<(x|0)&&(M=Ot(-1,-1,((x+-1-M|0)*3|0)+3|0)|0,M=Ot(~M|0,~(ve()|0)|0,(15-x|0)*3|0)|0,g=~(ve()|0)&g,A=~M&A),M=Ot(x|0,0,52)|0,x=g&-15728641|(ve()|0),_[T>>2]=A|M,_[T+4>>2]=x,T=0,T|0):(T=4,T|0)}function Tx(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0,qt=0,xn=0,dn=0,Vn=0,qn=0,ur=0,Gn=0,Tn=0,Zt=0;if((x|0)==0&(T|0)==0)return Zt=0,Zt|0;if(M=A,D=_[M>>2]|0,M=_[M+4>>2]|0,!0&(M&15728640|0)==0){if(!((T|0)>0|(T|0)==0&x>>>0>0)||(Zt=g,_[Zt>>2]=D,_[Zt+4>>2]=M,(x|0)==1&(T|0)==0))return Zt=0,Zt|0;M=1,D=0;do Gn=A+(M<<3)|0,Tn=_[Gn+4>>2]|0,Zt=g+(M<<3)|0,_[Zt>>2]=_[Gn>>2],_[Zt+4>>2]=Tn,M=Ve(M|0,D|0,1,0)|0,D=ve()|0;while((D|0)<(T|0)|(D|0)==(T|0)&M>>>0<x>>>0);return M=0,M|0}if(ur=x<<3,Tn=Ge(ur)|0,!Tn)return Zt=13,Zt|0;if(ri(Tn|0,A|0,ur|0)|0,Gn=Fe(x,8)|0,!Gn)return Be(Tn),Zt=13,Zt|0;e:for(;;){M=Tn,Z=_[M>>2]|0,M=_[M+4>>2]|0,Vn=Tt(Z|0,M|0,52)|0,ve()|0,Vn=Vn&15,qn=Vn+-1|0,dn=(Vn|0)!=0,xn=(T|0)>0|(T|0)==0&x>>>0>0;t:do if(dn&xn){if(at=Ot(qn|0,0,52)|0,lt=ve()|0,qn>>>0>15){if(!((Z|0)==0&(M|0)==0)){Zt=16;break e}for(D=0,A=0;;){if(D=Ve(D|0,A|0,1,0)|0,A=ve()|0,!((A|0)<(T|0)|(A|0)==(T|0)&D>>>0<x>>>0))break t;if(O=Tn+(D<<3)|0,qt=_[O>>2]|0,O=_[O+4>>2]|0,!((qt|0)==0&(O|0)==0)){M=O,Zt=16;break e}}}for(N=Z,A=M,D=0,O=0;;){if(!((N|0)==0&(A|0)==0)){if(!(!0&(A&117440512|0)==0)){Zt=21;break e}if(ne=Tt(N|0,A|0,52)|0,ve()|0,ne=ne&15,(ne|0)<(qn|0)){M=12,Zt=27;break e}if((ne|0)!=(qn|0)&&(N=N|at,A=A&-15728641|lt,ne>>>0>=Vn>>>0)){W=qn;do qt=Ot(7,0,(14-W|0)*3|0)|0,W=W+1|0,N=qt|N,A=ve()|0|A;while(W>>>0<ne>>>0)}if(Ce=Jt(N|0,A|0,x|0,T|0)|0,Se=ve()|0,W=Gn+(Ce<<3)|0,ne=W,_e=_[ne>>2]|0,ne=_[ne+4>>2]|0,!((_e|0)==0&(ne|0)==0)){et=0,yt=0;do{if((et|0)>(T|0)|(et|0)==(T|0)&yt>>>0>x>>>0){Zt=31;break e}if((_e|0)==(N|0)&(ne&-117440513|0)==(A|0)){Pe=Tt(_e|0,ne|0,56)|0,ve()|0,Pe=Pe&7,Ye=Pe+1|0,qt=Tt(_e|0,ne|0,45)|0,ve()|0;n:do if(!(Qr(qt&127)|0))ne=7;else{if(_e=Tt(_e|0,ne|0,52)|0,ve()|0,_e=_e&15,!_e){ne=6;break}for(ne=1;;){if(qt=Ot(7,0,(15-ne|0)*3|0)|0,!((qt&N|0)==0&((ve()|0)&A|0)==0)){ne=7;break n}if(ne>>>0<_e>>>0)ne=ne+1|0;else{ne=6;break}}}while(!1);if((Pe+2|0)>>>0>ne>>>0){Zt=41;break e}qt=Ot(Ye|0,0,56)|0,A=ve()|0|A&-117440513,qe=W,_[qe>>2]=0,_[qe+4>>2]=0,N=qt|N}else Ce=Ve(Ce|0,Se|0,1,0)|0,Ce=Bt(Ce|0,ve()|0,x|0,T|0)|0,Se=ve()|0;yt=Ve(yt|0,et|0,1,0)|0,et=ve()|0,W=Gn+(Ce<<3)|0,ne=W,_e=_[ne>>2]|0,ne=_[ne+4>>2]|0}while(!((_e|0)==0&(ne|0)==0))}qt=W,_[qt>>2]=N,_[qt+4>>2]=A}if(D=Ve(D|0,O|0,1,0)|0,O=ve()|0,!((O|0)<(T|0)|(O|0)==(T|0)&D>>>0<x>>>0))break t;A=Tn+(D<<3)|0,N=_[A>>2]|0,A=_[A+4>>2]|0}}while(!1);if(qt=Ve(x|0,T|0,5,0)|0,qe=ve()|0,qe>>>0<0|(qe|0)==0&qt>>>0<11){Zt=85;break}if(qt=ft(x|0,T|0,6,0)|0,ve()|0,qt=Fe(qt,8)|0,!qt){Zt=48;break}do if(xn){for(Ye=0,A=0,Pe=0,et=0;;){if(ne=Gn+(Ye<<3)|0,O=ne,D=_[O>>2]|0,O=_[O+4>>2]|0,(D|0)==0&(O|0)==0)qe=Pe;else{_e=Tt(D|0,O|0,56)|0,ve()|0,_e=_e&7,N=_e+1|0,Ce=O&-117440513,qe=Tt(D|0,O|0,45)|0,ve()|0;t:do if(Qr(qe&127)|0){if(Se=Tt(D|0,O|0,52)|0,ve()|0,Se=Se&15,Se|0)for(W=1;;){if(qe=Ot(7,0,(15-W|0)*3|0)|0,!((D&qe|0)==0&(Ce&(ve()|0)|0)==0))break t;if(W>>>0<Se>>>0)W=W+1|0;else break}O=Ot(N|0,0,56)|0,D=O|D,O=ve()|0|Ce,N=ne,_[N>>2]=D,_[N+4>>2]=O,N=_e+2|0}while(!1);(N|0)==7?(qe=qt+(A<<3)|0,_[qe>>2]=D,_[qe+4>>2]=O&-117440513,A=Ve(A|0,Pe|0,1,0)|0,qe=ve()|0):qe=Pe}if(Ye=Ve(Ye|0,et|0,1,0)|0,et=ve()|0,(et|0)<(T|0)|(et|0)==(T|0)&Ye>>>0<x>>>0)Pe=qe;else break}if(xn){if(yt=qn>>>0>15,at=Ot(qn|0,0,52)|0,lt=ve()|0,!dn){for(D=0,W=0,N=0,O=0;(Z|0)==0&(M|0)==0||(qn=g+(D<<3)|0,_[qn>>2]=Z,_[qn+4>>2]=M,D=Ve(D|0,W|0,1,0)|0,W=ve()|0),N=Ve(N|0,O|0,1,0)|0,O=ve()|0,!!((O|0)<(T|0)|(O|0)==(T|0)&N>>>0<x>>>0);)M=Tn+(N<<3)|0,Z=_[M>>2]|0,M=_[M+4>>2]|0;M=qe;break}for(D=0,W=0,O=0,N=0;;){do if(!((Z|0)==0&(M|0)==0)){if(Se=Tt(Z|0,M|0,52)|0,ve()|0,Se=Se&15,yt|(Se|0)<(qn|0)){Zt=80;break e}if((Se|0)!=(qn|0)){if(ne=Z|at,_e=M&-15728641|lt,Se>>>0>=Vn>>>0){Ce=qn;do dn=Ot(7,0,(14-Ce|0)*3|0)|0,Ce=Ce+1|0,ne=dn|ne,_e=ve()|0|_e;while(Ce>>>0<Se>>>0)}}else ne=Z,_e=M;Pe=Jt(ne|0,_e|0,x|0,T|0)|0,Ce=0,Se=0,et=ve()|0;do{if((Ce|0)>(T|0)|(Ce|0)==(T|0)&Se>>>0>x>>>0){Zt=81;break e}if(dn=Gn+(Pe<<3)|0,Ye=_[dn+4>>2]|0,(Ye&-117440513|0)==(_e|0)&&(_[dn>>2]|0)==(ne|0)){Zt=65;break}dn=Ve(Pe|0,et|0,1,0)|0,Pe=Bt(dn|0,ve()|0,x|0,T|0)|0,et=ve()|0,Se=Ve(Se|0,Ce|0,1,0)|0,Ce=ve()|0,dn=Gn+(Pe<<3)|0}while(!((_[dn>>2]|0)==(ne|0)&&(_[dn+4>>2]|0)==(_e|0)));if((Zt|0)==65&&(Zt=0,!0&(Ye&117440512|0)==100663296))break;dn=g+(D<<3)|0,_[dn>>2]=Z,_[dn+4>>2]=M,D=Ve(D|0,W|0,1,0)|0,W=ve()|0}while(!1);if(O=Ve(O|0,N|0,1,0)|0,N=ve()|0,!((N|0)<(T|0)|(N|0)==(T|0)&O>>>0<x>>>0))break;M=Tn+(O<<3)|0,Z=_[M>>2]|0,M=_[M+4>>2]|0}M=qe}else D=0,M=qe}else D=0,A=0,M=0;while(!1);if(Fi(Gn|0,0,ur|0)|0,ri(Tn|0,qt|0,A<<3|0)|0,Be(qt),(A|0)==0&(M|0)==0){Zt=89;break}else g=g+(D<<3)|0,T=M,x=A}if((Zt|0)==16)!0&(M&117440512|0)==0?(M=4,Zt=27):Zt=21;else if((Zt|0)==31)Wn(27795,27122,620,27132);else{if((Zt|0)==41)return Be(Tn),Be(Gn),Zt=10,Zt|0;if((Zt|0)==48)return Be(Tn),Be(Gn),Zt=13,Zt|0;(Zt|0)==80?Wn(27795,27122,711,27132):(Zt|0)==81?Wn(27795,27122,723,27132):(Zt|0)==85&&(ri(g|0,Tn|0,x<<3|0)|0,Zt=89)}return(Zt|0)==21?(Be(Tn),Be(Gn),Zt=5,Zt|0):(Zt|0)==27?(Be(Tn),Be(Gn),Zt=M,Zt|0):(Zt|0)==89?(Be(Tn),Be(Gn),Zt=0,Zt|0):0}function kd(A,g,x,T,M,D,O){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0,D=D|0,O=O|0;var N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0;if(Ye=Ae,Ae=Ae+16|0,Pe=Ye,!((x|0)>0|(x|0)==0&g>>>0>0))return Pe=0,Ae=Ye,Pe|0;if((O|0)>=16)return Pe=12,Ae=Ye,Pe|0;Ce=0,Se=0,_e=0,N=0;e:for(;;){if(Z=A+(Ce<<3)|0,W=_[Z>>2]|0,Z=_[Z+4>>2]|0,ne=Tt(W|0,Z|0,52)|0,ve()|0,(ne&15|0)>(O|0)){N=12,W=11;break}if(Fg(Pe,W,Z,O),ne=Pe,Z=_[ne>>2]|0,ne=_[ne+4>>2]|0,(Z|0)==0&(ne|0)==0)W=_e;else{W=_e;do{if(!((N|0)<(D|0)|(N|0)==(D|0)&W>>>0<M>>>0)){W=10;break e}_e=T+(W<<3)|0,_[_e>>2]=Z,_[_e+4>>2]=ne,W=Ve(W|0,N|0,1,0)|0,N=ve()|0,If(Pe),_e=Pe,Z=_[_e>>2]|0,ne=_[_e+4>>2]|0}while(!((Z|0)==0&(ne|0)==0))}if(Ce=Ve(Ce|0,Se|0,1,0)|0,Se=ve()|0,(Se|0)<(x|0)|(Se|0)==(x|0)&Ce>>>0<g>>>0)_e=W;else{N=0,W=11;break}}return(W|0)==10?(Pe=14,Ae=Ye,Pe|0):(W|0)==11?(Ae=Ye,N|0):0}function Nd(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0;Ce=Ae,Ae=Ae+16|0,_e=Ce;e:do if((x|0)>0|(x|0)==0&g>>>0>0){for(Z=0,O=0,D=0,ne=0;;){if(W=A+(Z<<3)|0,N=_[W>>2]|0,W=_[W+4>>2]|0,!((N|0)==0&(W|0)==0)&&(W=(Ef(N,W,T,_e)|0)==0,N=_e,O=Ve(_[N>>2]|0,_[N+4>>2]|0,O|0,D|0)|0,D=ve()|0,!W)){D=12;break}if(Z=Ve(Z|0,ne|0,1,0)|0,ne=ve()|0,!((ne|0)<(x|0)|(ne|0)==(x|0)&Z>>>0<g>>>0))break e}return Ae=Ce,D|0}else O=0,D=0;while(!1);return _[M>>2]=O,_[M+4>>2]=D,M=0,Ae=Ce,M|0}function es(A,g){return A=A|0,g=g|0,g=Tt(A|0,g|0,52)|0,ve()|0,g&1|0}function ts(A,g){A=A|0,g=g|0;var x=0,T=0,M=0;if(M=Tt(A|0,g|0,52)|0,ve()|0,M=M&15,!M)return M=0,M|0;for(T=1;;){if(x=Tt(A|0,g|0,(15-T|0)*3|0)|0,ve()|0,x=x&7,x|0){T=5;break}if(T>>>0<M>>>0)T=T+1|0;else{x=0,T=5;break}}return(T|0)==5?x|0:0}function C0(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0,W=0;if(W=Tt(A|0,g|0,52)|0,ve()|0,W=W&15,!W)return N=g,W=A,Jn(N|0),W|0;for(N=1,x=0;;){D=(15-N|0)*3|0,T=Ot(7,0,D|0)|0,M=ve()|0,O=Tt(A|0,g|0,D|0)|0,ve()|0,D=Ot(Ch(O&7)|0,0,D|0)|0,O=ve()|0,A=D|A&~T,g=O|g&~M;e:do if(!x)if((D&T|0)==0&(O&M|0)==0)x=0;else if(T=Tt(A|0,g|0,52)|0,ve()|0,T=T&15,!T)x=1;else{x=1;t:for(;;){switch(O=Tt(A|0,g|0,(15-x|0)*3|0)|0,ve()|0,O&7){case 1:break t;case 0:break;default:{x=1;break e}}if(x>>>0<T>>>0)x=x+1|0;else{x=1;break e}}for(x=1;;)if(O=(15-x|0)*3|0,M=Tt(A|0,g|0,O|0)|0,ve()|0,D=Ot(7,0,O|0)|0,g=g&~(ve()|0),O=Ot(Ch(M&7)|0,0,O|0)|0,A=A&~D|O,g=g|(ve()|0),x>>>0<T>>>0)x=x+1|0;else{x=1;break}}while(!1);if(N>>>0<W>>>0)N=N+1|0;else break}return Jn(g|0),A|0}function Rh(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0;if(T=Tt(A|0,g|0,52)|0,ve()|0,T=T&15,!T)return x=g,T=A,Jn(x|0),T|0;for(x=1;D=(15-x|0)*3|0,O=Tt(A|0,g|0,D|0)|0,ve()|0,M=Ot(7,0,D|0)|0,g=g&~(ve()|0),D=Ot(Ch(O&7)|0,0,D|0)|0,A=D|A&~M,g=ve()|0|g,x>>>0<T>>>0;)x=x+1|0;return Jn(g|0),A|0}function Ex(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0,W=0;if(W=Tt(A|0,g|0,52)|0,ve()|0,W=W&15,!W)return N=g,W=A,Jn(N|0),W|0;for(N=1,x=0;;){D=(15-N|0)*3|0,T=Ot(7,0,D|0)|0,M=ve()|0,O=Tt(A|0,g|0,D|0)|0,ve()|0,D=Ot(kc(O&7)|0,0,D|0)|0,O=ve()|0,A=D|A&~T,g=O|g&~M;e:do if(!x)if((D&T|0)==0&(O&M|0)==0)x=0;else if(T=Tt(A|0,g|0,52)|0,ve()|0,T=T&15,!T)x=1;else{x=1;t:for(;;){switch(O=Tt(A|0,g|0,(15-x|0)*3|0)|0,ve()|0,O&7){case 1:break t;case 0:break;default:{x=1;break e}}if(x>>>0<T>>>0)x=x+1|0;else{x=1;break e}}for(x=1;;)if(M=(15-x|0)*3|0,D=Ot(7,0,M|0)|0,O=g&~(ve()|0),g=Tt(A|0,g|0,M|0)|0,ve()|0,g=Ot(kc(g&7)|0,0,M|0)|0,A=A&~D|g,g=O|(ve()|0),x>>>0<T>>>0)x=x+1|0;else{x=1;break}}while(!1);if(N>>>0<W>>>0)N=N+1|0;else break}return Jn(g|0),A|0}function Su(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0;if(T=Tt(A|0,g|0,52)|0,ve()|0,T=T&15,!T)return x=g,T=A,Jn(x|0),T|0;for(x=1;O=(15-x|0)*3|0,D=Ot(7,0,O|0)|0,M=g&~(ve()|0),g=Tt(A|0,g|0,O|0)|0,ve()|0,g=Ot(kc(g&7)|0,0,O|0)|0,A=g|A&~D,g=ve()|0|M,x>>>0<T>>>0;)x=x+1|0;return Jn(g|0),A|0}function Sf(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;if(W=Ae,Ae=Ae+64|0,N=W+40|0,T=W+24|0,M=W+12|0,D=W,Ot(g|0,0,52)|0,x=ve()|0|134225919,!g)return(_[A+4>>2]|0)>2||(_[A+8>>2]|0)>2||(_[A+12>>2]|0)>2?(O=0,N=0,Jn(O|0),Ae=W,N|0):(Ot(Th(A)|0,0,45)|0,O=ve()|0|x,N=-1,Jn(O|0),Ae=W,N|0);if(_[N>>2]=_[A>>2],_[N+4>>2]=_[A+4>>2],_[N+8>>2]=_[A+8>>2],_[N+12>>2]=_[A+12>>2],O=N+4|0,(g|0)>0)for(A=-1;_[T>>2]=_[O>>2],_[T+4>>2]=_[O+4>>2],_[T+8>>2]=_[O+8>>2],g&1?(x0(O),_[M>>2]=_[O>>2],_[M+4>>2]=_[O+4>>2],_[M+8>>2]=_[O+8>>2],Ll(M)):(Cd(O),_[M>>2]=_[O>>2],_[M+4>>2]=_[O+4>>2],_[M+8>>2]=_[O+8>>2],Oa(M)),wu(T,M,D),ds(D),ne=(15-g|0)*3|0,Z=Ot(7,0,ne|0)|0,x=x&~(ve()|0),ne=Ot(Sh(D)|0,0,ne|0)|0,A=ne|A&~Z,x=ve()|0|x,(g|0)>1;)g=g+-1|0;else A=-1;e:do if((_[O>>2]|0)<=2&&(_[N+8>>2]|0)<=2&&(_[N+12>>2]|0)<=2){if(T=Th(N)|0,g=Ot(T|0,0,45)|0,g=g|A,A=ve()|0|x&-1040385,D=il(N)|0,!(Qr(T)|0)){if((D|0)<=0)break;for(M=0;;){if(T=Tt(g|0,A|0,52)|0,ve()|0,T=T&15,T)for(x=1;ne=(15-x|0)*3|0,N=Tt(g|0,A|0,ne|0)|0,ve()|0,Z=Ot(7,0,ne|0)|0,A=A&~(ve()|0),ne=Ot(Ch(N&7)|0,0,ne|0)|0,g=g&~Z|ne,A=A|(ve()|0),x>>>0<T>>>0;)x=x+1|0;if(M=M+1|0,(M|0)==(D|0))break e}}M=Tt(g|0,A|0,52)|0,ve()|0,M=M&15;t:do if(M){x=1;n:for(;;){switch(ne=Tt(g|0,A|0,(15-x|0)*3|0)|0,ve()|0,ne&7){case 1:break n;case 0:break;default:break t}if(x>>>0<M>>>0)x=x+1|0;else break t}if(g0(T,_[N>>2]|0)|0)for(x=1;N=(15-x|0)*3|0,Z=Ot(7,0,N|0)|0,ne=A&~(ve()|0),A=Tt(g|0,A|0,N|0)|0,ve()|0,A=Ot(kc(A&7)|0,0,N|0)|0,g=g&~Z|A,A=ne|(ve()|0),x>>>0<M>>>0;)x=x+1|0;else for(x=1;ne=(15-x|0)*3|0,N=Tt(g|0,A|0,ne|0)|0,ve()|0,Z=Ot(7,0,ne|0)|0,A=A&~(ve()|0),ne=Ot(Ch(N&7)|0,0,ne|0)|0,g=g&~Z|ne,A=A|(ve()|0),x>>>0<M>>>0;)x=x+1|0}while(!1);if((D|0)>0){x=0;do g=C0(g,A)|0,A=ve()|0,x=x+1|0;while((x|0)!=(D|0))}}else g=0,A=0;while(!1);return Z=A,ne=g,Jn(Z|0),Ae=W,ne|0}function ho(A){return A=A|0,(A|0)%2|0|0}function un(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0;return M=Ae,Ae=Ae+16|0,T=M,g>>>0>15?(T=4,Ae=M,T|0):(_[A+4>>2]&2146435072|0)==2146435072||(_[A+8+4>>2]&2146435072|0)==2146435072?(T=3,Ae=M,T|0):(Dd(A,g,T),g=Sf(T,g)|0,T=ve()|0,_[x>>2]=g,_[x+4>>2]=T,(g|0)==0&(T|0)==0&&Wn(27795,27122,1050,27145),T=0,Ae=M,T|0)}function Cf(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0;if(M=x+4|0,D=Tt(A|0,g|0,52)|0,ve()|0,D=D&15,O=Tt(A|0,g|0,45)|0,ve()|0,T=(D|0)==0,Qr(O&127)|0){if(T)return O=1,O|0;T=1}else{if(T)return O=0,O|0;(_[M>>2]|0)==0&&(_[x+8>>2]|0)==0?T=(_[x+12>>2]|0)!=0&1:T=1}for(x=1;x&1?Ll(M):Oa(M),O=Tt(A|0,g|0,(15-x|0)*3|0)|0,ve()|0,v0(M,O&7),x>>>0<D>>>0;)x=x+1|0;return T|0}function Cu(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;if(ne=Ae,Ae=Ae+16|0,W=ne,Z=Tt(A|0,g|0,45)|0,ve()|0,Z=Z&127,Z>>>0>121)return _[x>>2]=0,_[x+4>>2]=0,_[x+8>>2]=0,_[x+12>>2]=0,Z=5,Ae=ne,Z|0;e:do if((Qr(Z)|0)!=0&&(D=Tt(A|0,g|0,52)|0,ve()|0,D=D&15,(D|0)!=0)){T=1;t:for(;;){switch(N=Tt(A|0,g|0,(15-T|0)*3|0)|0,ve()|0,N&7){case 5:break t;case 0:break;default:{T=g;break e}}if(T>>>0<D>>>0)T=T+1|0;else{T=g;break e}}for(M=1,T=g;g=(15-M|0)*3|0,O=Ot(7,0,g|0)|0,N=T&~(ve()|0),T=Tt(A|0,T|0,g|0)|0,ve()|0,T=Ot(kc(T&7)|0,0,g|0)|0,A=A&~O|T,T=N|(ve()|0),M>>>0<D>>>0;)M=M+1|0}else T=g;while(!1);if(N=7696+(Z*28|0)|0,_[x>>2]=_[N>>2],_[x+4>>2]=_[N+4>>2],_[x+8>>2]=_[N+8>>2],_[x+12>>2]=_[N+12>>2],!(Cf(A,T,x)|0))return Z=0,Ae=ne,Z|0;if(O=x+4|0,_[W>>2]=_[O>>2],_[W+4>>2]=_[O+4>>2],_[W+8>>2]=_[O+8>>2],D=Tt(A|0,T|0,52)|0,ve()|0,N=D&15,D&1?(Oa(O),D=N+1|0):D=N,!(Qr(Z)|0))T=0;else{e:do if(!N)T=0;else for(g=1;;){if(M=Tt(A|0,T|0,(15-g|0)*3|0)|0,ve()|0,M=M&7,M|0){T=M;break e}if(g>>>0<N>>>0)g=g+1|0;else{T=0;break}}while(!1);T=(T|0)==4&1}if(!(Ph(x,D,T,0)|0))(D|0)!=(N|0)&&(_[O>>2]=_[W>>2],_[O+4>>2]=_[W+4>>2],_[O+8>>2]=_[W+8>>2]);else{if(Qr(Z)|0)do;while((Ph(x,D,0,0)|0)!=0);(D|0)!=(N|0)&&Cd(O)}return Z=0,Ae=ne,Z|0}function sl(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0;return D=Ae,Ae=Ae+16|0,T=D,M=Cu(A,g,T)|0,M|0?(Ae=D,M|0):(M=Tt(A|0,g|0,52)|0,ve()|0,X_(T,M&15,x),M=0,Ae=D,M|0)}function uc(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0;if(O=Ae,Ae=Ae+16|0,D=O,T=Cu(A,g,D)|0,T|0)return D=T,Ae=O,D|0;T=Tt(A|0,g|0,45)|0,ve()|0,T=(Qr(T&127)|0)==0,M=Tt(A|0,g|0,52)|0,ve()|0,M=M&15;e:do if(!T){if(M|0)for(T=1;;){if(N=Ot(7,0,(15-T|0)*3|0)|0,!((N&A|0)==0&((ve()|0)&g|0)==0))break e;if(T>>>0<M>>>0)T=T+1|0;else break}return T0(D,M,0,5,x),N=0,Ae=O,N|0}while(!1);return Ld(D,M,0,6,x),N=0,Ae=O,N|0}function zd(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0;if(M=Tt(A|0,g|0,45)|0,ve()|0,!(Qr(M&127)|0))return M=2,_[x>>2]=M,0;if(M=Tt(A|0,g|0,52)|0,ve()|0,M=M&15,!M)return M=5,_[x>>2]=M,0;for(T=1;;){if(D=Ot(7,0,(15-T|0)*3|0)|0,!((D&A|0)==0&((ve()|0)&g|0)==0)){T=2,A=6;break}if(T>>>0<M>>>0)T=T+1|0;else{T=5,A=6;break}}return(A|0)==6&&(_[x>>2]=T),0}function M0(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0;_e=Ae,Ae=Ae+128|0,Z=_e+112|0,D=_e+96|0,ne=_e,M=Tt(A|0,g|0,52)|0,ve()|0,N=M&15,_[Z>>2]=N,O=Tt(A|0,g|0,45)|0,ve()|0,O=O&127;e:do if(Qr(O)|0){if(N|0)for(T=1;;){if(W=Ot(7,0,(15-T|0)*3|0)|0,!((W&A|0)==0&((ve()|0)&g|0)==0)){M=0;break e}if(T>>>0<N>>>0)T=T+1|0;else break}if(M&1)M=1;else return W=Ot(N+1|0,0,52)|0,ne=ve()|0|g&-15728641,Z=Ot(7,0,(14-N|0)*3|0)|0,ne=M0((W|A)&~Z,ne&~(ve()|0),x)|0,Ae=_e,ne|0}else M=0;while(!1);if(T=Cu(A,g,D)|0,!T){M?(Pg(D,Z,ne),W=5):(E0(D,Z,ne),W=6);e:do if(Qr(O)|0)if(!N)A=5;else for(T=1;;){if(O=Ot(7,0,(15-T|0)*3|0)|0,!((O&A|0)==0&((ve()|0)&g|0)==0)){A=2;break e}if(T>>>0<N>>>0)T=T+1|0;else{A=5;break}}else A=2;while(!1);Fi(x|0,-1,A<<2|0)|0;e:do if(M)for(D=0;;){if(O=ne+(D<<4)|0,Eu(O,_[Z>>2]|0)|0,O=_[O>>2]|0,N=_[x>>2]|0,(N|0)==-1|(N|0)==(O|0))T=x;else{M=0;do{if(M=M+1|0,M>>>0>=A>>>0){T=1;break e}T=x+(M<<2)|0,N=_[T>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(_[T>>2]=O,D=D+1|0,D>>>0>=W>>>0){T=0;break}}else for(D=0;;){if(O=ne+(D<<4)|0,Ph(O,_[Z>>2]|0,0,1)|0,O=_[O>>2]|0,N=_[x>>2]|0,(N|0)==-1|(N|0)==(O|0))T=x;else{M=0;do{if(M=M+1|0,M>>>0>=A>>>0){T=1;break e}T=x+(M<<2)|0,N=_[T>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(_[T>>2]=O,D=D+1|0,D>>>0>=W>>>0){T=0;break}}while(!1)}return ne=T,Ae=_e,ne|0}function Ud(){return 12}function Vd(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0,W=0;if(A>>>0>15)return N=4,N|0;if(Ot(A|0,0,52)|0,N=ve()|0|134225919,!A){x=0,T=0;do Qr(T)|0&&(Ot(T|0,0,45)|0,O=N|(ve()|0),A=g+(x<<3)|0,_[A>>2]=-1,_[A+4>>2]=O,x=x+1|0),T=T+1|0;while((T|0)!=122);return x=0,x|0}x=0,O=0;do{if(Qr(O)|0){for(Ot(O|0,0,45)|0,T=1,M=-1,D=N|(ve()|0);W=Ot(7,0,(15-T|0)*3|0)|0,M=M&~W,D=D&~(ve()|0),(T|0)!=(A|0);)T=T+1|0;W=g+(x<<3)|0,_[W>>2]=M,_[W+4>>2]=D,x=x+1|0}O=O+1|0}while((O|0)!=122);return x=0,x|0}function Y_(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0;if(at=Ae,Ae=Ae+16|0,et=at,yt=Tt(A|0,g|0,52)|0,ve()|0,yt=yt&15,x>>>0>15)return yt=4,Ae=at,yt|0;if((yt|0)<(x|0))return yt=12,Ae=at,yt|0;if((yt|0)!=(x|0))if(D=Ot(x|0,0,52)|0,D=D|A,N=ve()|0|g&-15728641,(yt|0)>(x|0)){W=x;do Ye=Ot(7,0,(14-W|0)*3|0)|0,W=W+1|0,D=Ye|D,N=ve()|0|N;while((W|0)<(yt|0));Ye=D}else Ye=D;else Ye=A,N=g;Pe=Tt(Ye|0,N|0,45)|0,ve()|0;e:do if(Qr(Pe&127)|0){if(W=Tt(Ye|0,N|0,52)|0,ve()|0,W=W&15,W|0)for(D=1;;){if(Pe=Ot(7,0,(15-D|0)*3|0)|0,!((Pe&Ye|0)==0&((ve()|0)&N|0)==0)){Z=33;break e}if(D>>>0<W>>>0)D=D+1|0;else break}if(Pe=T,_[Pe>>2]=0,_[Pe+4>>2]=0,(yt|0)>(x|0)){for(Pe=g&-15728641,Se=yt;;){if(Ce=Se,Se=Se+-1|0,Se>>>0>15|(yt|0)<(Se|0)){Z=19;break}if((yt|0)!=(Se|0))if(D=Ot(Se|0,0,52)|0,D=D|A,W=ve()|0|Pe,(yt|0)<(Ce|0))_e=D;else{Z=Se;do _e=Ot(7,0,(14-Z|0)*3|0)|0,Z=Z+1|0,D=_e|D,W=ve()|0|W;while((Z|0)<(yt|0));_e=D}else _e=A,W=g;if(ne=Tt(_e|0,W|0,45)|0,ve()|0,!(Qr(ne&127)|0))D=0;else{ne=Tt(_e|0,W|0,52)|0,ve()|0,ne=ne&15;t:do if(!ne)D=0;else for(Z=1;;){if(D=Tt(_e|0,W|0,(15-Z|0)*3|0)|0,ve()|0,D=D&7,D|0)break t;if(Z>>>0<ne>>>0)Z=Z+1|0;else{D=0;break}}while(!1);D=(D|0)==0&1}if(W=Tt(A|0,g|0,(15-Ce|0)*3|0)|0,ve()|0,W=W&7,(W|0)==7){M=5,Z=42;break}if(D=(D|0)!=0,(W|0)==1&D){M=5,Z=42;break}if(_e=W+(((W|0)!=0&D)<<31>>31)|0,_e|0&&(Z=yt-Ce|0,Z=ua(7,0,Z,((Z|0)<0)<<31>>31)|0,ne=ve()|0,D?(D=Ut(Z|0,ne|0,5,0)|0,D=Ve(D|0,ve()|0,-5,-1)|0,D=ft(D|0,ve()|0,6,0)|0,D=Ve(D|0,ve()|0,1,0)|0,W=ve()|0):(D=Z,W=ne),Ce=_e+-1|0,Ce=Ut(Z|0,ne|0,Ce|0,((Ce|0)<0)<<31>>31|0)|0,Ce=Ve(D|0,W|0,Ce|0,ve()|0)|0,_e=ve()|0,ne=T,ne=Ve(Ce|0,_e|0,_[ne>>2]|0,_[ne+4>>2]|0)|0,_e=ve()|0,Ce=T,_[Ce>>2]=ne,_[Ce+4>>2]=_e),(Se|0)<=(x|0)){Z=37;break}}if((Z|0)==19)Wn(27795,27122,1367,27158);else if((Z|0)==37){O=T,M=_[O+4>>2]|0,O=_[O>>2]|0;break}else if((Z|0)==42)return Ae=at,M|0}else M=0,O=0}else Z=33;while(!1);e:do if((Z|0)==33)if(Pe=T,_[Pe>>2]=0,_[Pe+4>>2]=0,(yt|0)>(x|0)){for(D=yt;;){if(M=Tt(A|0,g|0,(15-D|0)*3|0)|0,ve()|0,M=M&7,(M|0)==7){M=5;break}if(O=yt-D|0,O=ua(7,0,O,((O|0)<0)<<31>>31)|0,M=Ut(O|0,ve()|0,M|0,0)|0,O=ve()|0,Pe=T,O=Ve(_[Pe>>2]|0,_[Pe+4>>2]|0,M|0,O|0)|0,M=ve()|0,Pe=T,_[Pe>>2]=O,_[Pe+4>>2]=M,D=D+-1|0,(D|0)<=(x|0))break e}return Ae=at,M|0}else M=0,O=0;while(!1);return Ef(Ye,N,yt,et)|0&&Wn(27795,27122,1327,27173),yt=et,et=_[yt+4>>2]|0,((M|0)>-1|(M|0)==-1&O>>>0>4294967295)&((et|0)>(M|0)|((et|0)==(M|0)?(_[yt>>2]|0)>>>0>O>>>0:0))?(yt=0,Ae=at,yt|0):(Wn(27795,27122,1407,27158),0)}function Mf(A,g,x,T,M,D){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0,D=D|0;var O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0;if(_e=Ae,Ae=Ae+16|0,O=_e,M>>>0>15)return D=4,Ae=_e,D|0;if(N=Tt(x|0,T|0,52)|0,ve()|0,N=N&15,(N|0)>(M|0))return D=12,Ae=_e,D|0;if(Ef(x,T,M,O)|0&&Wn(27795,27122,1327,27173),ne=O,Z=_[ne+4>>2]|0,!(((g|0)>-1|(g|0)==-1&A>>>0>4294967295)&((Z|0)>(g|0)|((Z|0)==(g|0)?(_[ne>>2]|0)>>>0>A>>>0:0))))return D=2,Ae=_e,D|0;ne=M-N|0,M=Ot(M|0,0,52)|0,W=ve()|0|T&-15728641,Z=D,_[Z>>2]=M|x,_[Z+4>>2]=W,Z=Tt(x|0,T|0,45)|0,ve()|0;e:do if(Qr(Z&127)|0){if(N|0)for(O=1;;){if(Z=Ot(7,0,(15-O|0)*3|0)|0,!((Z&x|0)==0&((ve()|0)&T|0)==0))break e;if(O>>>0<N>>>0)O=O+1|0;else break}if((ne|0)<1)return D=0,Ae=_e,D|0;for(Z=N^15,T=-1,W=1,O=1;;){N=ne-W|0,N=ua(7,0,N,((N|0)<0)<<31>>31)|0,x=ve()|0;do if(O)if(O=Ut(N|0,x|0,5,0)|0,O=Ve(O|0,ve()|0,-5,-1)|0,O=ft(O|0,ve()|0,6,0)|0,M=ve()|0,(g|0)>(M|0)|(g|0)==(M|0)&A>>>0>O>>>0){g=Ve(A|0,g|0,-1,-1)|0,g=ct(g|0,ve()|0,O|0,M|0)|0,O=ve()|0,Ce=D,Pe=_[Ce>>2]|0,Ce=_[Ce+4>>2]|0,Ye=(Z+T|0)*3|0,Se=Ot(7,0,Ye|0)|0,Ce=Ce&~(ve()|0),T=ft(g|0,O|0,N|0,x|0)|0,A=ve()|0,M=Ve(T|0,A|0,2,0)|0,Ye=Ot(M|0,ve()|0,Ye|0)|0,Ce=ve()|0|Ce,M=D,_[M>>2]=Ye|Pe&~Se,_[M+4>>2]=Ce,A=Ut(T|0,A|0,N|0,x|0)|0,A=ct(g|0,O|0,A|0,ve()|0)|0,O=0,g=ve()|0;break}else{Ye=D,Se=_[Ye>>2]|0,Ye=_[Ye+4>>2]|0,Pe=Ot(7,0,(Z+T|0)*3|0)|0,Ye=Ye&~(ve()|0),O=D,_[O>>2]=Se&~Pe,_[O+4>>2]=Ye,O=1;break}else Se=D,M=_[Se>>2]|0,Se=_[Se+4>>2]|0,T=(Z+T|0)*3|0,Ce=Ot(7,0,T|0)|0,Se=Se&~(ve()|0),Ye=ft(A|0,g|0,N|0,x|0)|0,O=ve()|0,T=Ot(Ye|0,O|0,T|0)|0,Se=ve()|0|Se,Pe=D,_[Pe>>2]=T|M&~Ce,_[Pe+4>>2]=Se,O=Ut(Ye|0,O|0,N|0,x|0)|0,A=ct(A|0,g|0,O|0,ve()|0)|0,O=0,g=ve()|0;while(!1);if((ne|0)>(W|0))T=~W,W=W+1|0;else{g=0;break}}return Ae=_e,g|0}while(!1);if((ne|0)<1)return Ye=0,Ae=_e,Ye|0;for(M=N^15,O=1;;)if(Pe=ne-O|0,Pe=ua(7,0,Pe,((Pe|0)<0)<<31>>31)|0,Ye=ve()|0,W=D,x=_[W>>2]|0,W=_[W+4>>2]|0,N=(M-O|0)*3|0,T=Ot(7,0,N|0)|0,W=W&~(ve()|0),Ce=ft(A|0,g|0,Pe|0,Ye|0)|0,Se=ve()|0,N=Ot(Ce|0,Se|0,N|0)|0,W=ve()|0|W,Z=D,_[Z>>2]=N|x&~T,_[Z+4>>2]=W,Ye=Ut(Ce|0,Se|0,Pe|0,Ye|0)|0,A=ct(A|0,g|0,Ye|0,ve()|0)|0,g=ve()|0,(ne|0)<=(O|0)){g=0;break}else O=O+1|0;return Ae=_e,g|0}function Fg(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0;M=Tt(g|0,x|0,52)|0,ve()|0,M=M&15,(g|0)==0&(x|0)==0|((T|0)>15|(M|0)>(T|0))?(D=-1,g=-1,x=0,M=0):(g=Og(g,x,M+1|0,T)|0,O=(ve()|0)&-15728641,x=Ot(T|0,0,52)|0,x=g|x,O=O|(ve()|0),g=(dr(x,O)|0)==0,D=M,g=g?-1:T,M=O),O=A,_[O>>2]=x,_[O+4>>2]=M,_[A+8>>2]=D,_[A+12>>2]=g}function Gd(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0;if(M=Tt(A|0,g|0,52)|0,ve()|0,M=M&15,D=T+8|0,_[D>>2]=M,(A|0)==0&(g|0)==0|((x|0)>15|(M|0)>(x|0))){x=T,_[x>>2]=0,_[x+4>>2]=0,_[D>>2]=-1,_[T+12>>2]=-1;return}if(A=Og(A,g,M+1|0,x)|0,D=(ve()|0)&-15728641,M=Ot(x|0,0,52)|0,M=A|M,D=D|(ve()|0),A=T,_[A>>2]=M,_[A+4>>2]=D,A=T+12|0,dr(M,D)|0){_[A>>2]=x;return}else{_[A>>2]=-1;return}}function If(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0;if(x=A,g=_[x>>2]|0,x=_[x+4>>2]|0,!((g|0)==0&(x|0)==0)&&(T=Tt(g|0,x|0,52)|0,ve()|0,T=T&15,N=Ot(1,0,(T^15)*3|0)|0,g=Ve(N|0,ve()|0,g|0,x|0)|0,x=ve()|0,N=A,_[N>>2]=g,_[N+4>>2]=x,N=A+8|0,O=_[N>>2]|0,!((T|0)<(O|0)))){for(W=A+12|0,D=T;;){if((D|0)==(O|0)){T=5;break}if(Z=(D|0)==(_[W>>2]|0),M=(15-D|0)*3|0,T=Tt(g|0,x|0,M|0)|0,ve()|0,T=T&7,Z&((T|0)==1&!0)){T=7;break}if(!((T|0)==7&!0)){T=10;break}if(Z=Ot(1,0,M|0)|0,g=Ve(g|0,x|0,Z|0,ve()|0)|0,x=ve()|0,Z=A,_[Z>>2]=g,_[Z+4>>2]=x,(D|0)>(O|0))D=D+-1|0;else{T=10;break}}if((T|0)==5){Z=A,_[Z>>2]=0,_[Z+4>>2]=0,_[N>>2]=-1,_[W>>2]=-1;return}else if((T|0)==7){O=Ot(1,0,M|0)|0,O=Ve(g|0,x|0,O|0,ve()|0)|0,N=ve()|0,Z=A,_[Z>>2]=O,_[Z+4>>2]=N,_[W>>2]=D+-1;return}else if((T|0)==10)return}}function Pf(A){A=+A;var g=0;return g=A<0?A+6.283185307179586:A,+(A>=6.283185307179586?g+-6.283185307179586:g)}function Mu(A,g){return A=A|0,g=g|0,+kr(+(+fe[A>>3]-+fe[g>>3]))<17453292519943298e-27?(g=+kr(+(+fe[A+8>>3]-+fe[g+8>>3]))<17453292519943298e-27,g|0):(g=0,g|0)}function ca(A,g){switch(A=+A,g=g|0,g|0){case 1:{A=A<0?A+6.283185307179586:A;break}case 2:{A=A>0?A+-6.283185307179586:A;break}default:}return+A}function kg(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0;return M=+fe[g>>3],T=+fe[A>>3],D=+Nr(+((M-T)*.5)),x=+Nr(+((+fe[g+8>>3]-+fe[A+8>>3])*.5)),x=D*D+x*(+Sr(+M)*+Sr(+T)*x),+(+La(+ +li(+x),+ +li(+(1-x)))*2)}function Bh(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0;return M=+fe[g>>3],T=+fe[A>>3],D=+Nr(+((M-T)*.5)),x=+Nr(+((+fe[g+8>>3]-+fe[A+8>>3])*.5)),x=D*D+x*(+Sr(+M)*+Sr(+T)*x),+(+La(+ +li(+x),+ +li(+(1-x)))*2*6371.007180918475)}function Z_(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0;return M=+fe[g>>3],T=+fe[A>>3],D=+Nr(+((M-T)*.5)),x=+Nr(+((+fe[g+8>>3]-+fe[A+8>>3])*.5)),x=D*D+x*(+Sr(+M)*+Sr(+T)*x),+(+La(+ +li(+x),+ +li(+(1-x)))*2*6371.007180918475*1e3)}function Iu(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0;return D=+fe[g>>3],T=+Sr(+D),M=+fe[g+8>>3]-+fe[A+8>>3],O=T*+Nr(+M),x=+fe[A>>3],+ +La(+O,+(+Nr(+D)*+Sr(+x)-+Sr(+M)*(T*+Nr(+x))))}function ci(A,g,x,T){A=A|0,g=+g,x=+x,T=T|0;var M=0,D=0,O=0,N=0;if(x<1e-16){_[T>>2]=_[A>>2],_[T+4>>2]=_[A+4>>2],_[T+8>>2]=_[A+8>>2],_[T+12>>2]=_[A+12>>2];return}D=g<0?g+6.283185307179586:g,D=g>=6.283185307179586?D+-6.283185307179586:D;do if(D<1e-16)g=+fe[A>>3]+x,fe[T>>3]=g,M=T;else{if(M=+kr(+(D+-3.141592653589793))<1e-16,g=+fe[A>>3],M){g=g-x,fe[T>>3]=g,M=T;break}if(O=+Sr(+x),x=+Nr(+x),g=O*+Nr(+g)+ +Sr(+D)*(x*+Sr(+g)),g=g>1?1:g,g=+_g(+(g<-1?-1:g)),fe[T>>3]=g,+kr(+(g+-1.5707963267948966))<1e-16){fe[T>>3]=1.5707963267948966,fe[T+8>>3]=0;return}if(+kr(+(g+1.5707963267948966))<1e-16){fe[T>>3]=-1.5707963267948966,fe[T+8>>3]=0;return}if(N=1/+Sr(+g),D=x*+Nr(+D)*N,x=+fe[A>>3],g=N*((O-+Nr(+g)*+Nr(+x))/+Sr(+x)),O=D>1?1:D,g=g>1?1:g,g=+fe[A+8>>3]+ +La(+(O<-1?-1:O),+(g<-1?-1:g)),g>3.141592653589793)do g=g+-6.283185307179586;while(g>3.141592653589793);if(g<-3.141592653589793)do g=g+6.283185307179586;while(g<-3.141592653589793);fe[T+8>>3]=g;return}while(!1);if(+kr(+(g+-1.5707963267948966))<1e-16){fe[M>>3]=1.5707963267948966,fe[T+8>>3]=0;return}if(+kr(+(g+1.5707963267948966))<1e-16){fe[M>>3]=-1.5707963267948966,fe[T+8>>3]=0;return}if(g=+fe[A+8>>3],g>3.141592653589793)do g=g+-6.283185307179586;while(g>3.141592653589793);if(g<-3.141592653589793)do g=g+6.283185307179586;while(g<-3.141592653589793);fe[T+8>>3]=g}function q_(A,g){return A=A|0,g=g|0,A>>>0>15?(g=4,g|0):(fe[g>>3]=+fe[20656+(A<<3)>>3],g=0,g|0)}function Hd(A,g){return A=A|0,g=g|0,A>>>0>15?(g=4,g|0):(fe[g>>3]=+fe[20784+(A<<3)>>3],g=0,g|0)}function I0(A,g){return A=A|0,g=g|0,A>>>0>15?(g=4,g|0):(fe[g>>3]=+fe[20912+(A<<3)>>3],g=0,g|0)}function P0(A,g){return A=A|0,g=g|0,A>>>0>15?(g=4,g|0):(fe[g>>3]=+fe[21040+(A<<3)>>3],g=0,g|0)}function Rf(A,g){A=A|0,g=g|0;var x=0;return A>>>0>15?(g=4,g|0):(x=ua(7,0,A,((A|0)<0)<<31>>31)|0,x=Ut(x|0,ve()|0,120,0)|0,A=ve()|0,_[g>>2]=x|2,_[g+4>>2]=A,g=0,g|0)}function Ng(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0;return Ce=+fe[g>>3],ne=+fe[A>>3],W=+Nr(+((Ce-ne)*.5)),D=+fe[g+8>>3],Z=+fe[A+8>>3],O=+Nr(+((D-Z)*.5)),N=+Sr(+ne),_e=+Sr(+Ce),O=W*W+O*(_e*N*O),O=+La(+ +li(+O),+ +li(+(1-O)))*2,W=+fe[x>>3],Ce=+Nr(+((W-Ce)*.5)),T=+fe[x+8>>3],D=+Nr(+((T-D)*.5)),M=+Sr(+W),D=Ce*Ce+D*(_e*M*D),D=+La(+ +li(+D),+ +li(+(1-D)))*2,W=+Nr(+((ne-W)*.5)),T=+Nr(+((Z-T)*.5)),T=W*W+T*(N*M*T),T=+La(+ +li(+T),+ +li(+(1-T)))*2,M=(O+D+T)*.5,+(+c0(+ +li(+(+vh(+(M*.5))*+vh(+((M-O)*.5))*+vh(+((M-D)*.5))*+vh(+((M-T)*.5)))))*4)}function R0(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0;if(N=Ae,Ae=Ae+192|0,D=N+168|0,O=N,M=sl(A,g,D)|0,M|0)return x=M,Ae=N,x|0;if(uc(A,g,O)|0&&Wn(27795,27190,415,27199),g=_[O>>2]|0,(g|0)>0){if(T=+Ng(O+8|0,O+8+(((g|0)!=1&1)<<4)|0,D)+0,(g|0)!=1){A=1;do M=A,A=A+1|0,T=T+ +Ng(O+8+(M<<4)|0,O+8+(((A|0)%(g|0)|0)<<4)|0,D);while((A|0)<(g|0))}}else T=0;return fe[x>>3]=T,x=0,Ae=N,x|0}function Q_(A,g,x){return A=A|0,g=g|0,x=x|0,A=R0(A,g,x)|0,A|0||(fe[x>>3]=+fe[x>>3]*6371.007180918475*6371.007180918475),A|0}function kl(A,g,x){return A=A|0,g=g|0,x=x|0,A=R0(A,g,x)|0,A|0||(fe[x>>3]=+fe[x>>3]*6371.007180918475*6371.007180918475*1e3*1e3),A|0}function Wd(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;if(N=Ae,Ae=Ae+176|0,O=N,A=Ol(A,g,O)|0,A|0)return O=A,Ae=N,O|0;if(fe[x>>3]=0,A=_[O>>2]|0,(A|0)<=1)return O=0,Ae=N,O|0;g=A+-1|0,A=0,T=+fe[O+8>>3],M=+fe[O+16>>3],D=0;do A=A+1|0,Z=T,T=+fe[O+8+(A<<4)>>3],ne=+Nr(+((T-Z)*.5)),W=M,M=+fe[O+8+(A<<4)+8>>3],W=+Nr(+((M-W)*.5)),W=ne*ne+W*(+Sr(+T)*+Sr(+Z)*W),D=D+ +La(+ +li(+W),+ +li(+(1-W)))*2;while((A|0)<(g|0));return fe[x>>3]=D,O=0,Ae=N,O|0}function yn(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;if(N=Ae,Ae=Ae+176|0,O=N,A=Ol(A,g,O)|0,A|0)return O=A,D=+fe[x>>3],D=D*6371.007180918475,fe[x>>3]=D,Ae=N,O|0;if(fe[x>>3]=0,A=_[O>>2]|0,(A|0)<=1)return O=0,D=0,D=D*6371.007180918475,fe[x>>3]=D,Ae=N,O|0;g=A+-1|0,A=0,T=+fe[O+8>>3],M=+fe[O+16>>3],D=0;do A=A+1|0,Z=T,T=+fe[O+8+(A<<4)>>3],ne=+Nr(+((T-Z)*.5)),W=M,M=+fe[O+8+(A<<4)+8>>3],W=+Nr(+((M-W)*.5)),W=ne*ne+W*(+Sr(+Z)*+Sr(+T)*W),D=D+ +La(+ +li(+W),+ +li(+(1-W)))*2;while((A|0)!=(g|0));return fe[x>>3]=D,O=0,ne=D,ne=ne*6371.007180918475,fe[x>>3]=ne,Ae=N,O|0}function Rn(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;if(N=Ae,Ae=Ae+176|0,O=N,A=Ol(A,g,O)|0,A|0)return O=A,D=+fe[x>>3],D=D*6371.007180918475,D=D*1e3,fe[x>>3]=D,Ae=N,O|0;if(fe[x>>3]=0,A=_[O>>2]|0,(A|0)<=1)return O=0,D=0,D=D*6371.007180918475,D=D*1e3,fe[x>>3]=D,Ae=N,O|0;g=A+-1|0,A=0,T=+fe[O+8>>3],M=+fe[O+16>>3],D=0;do A=A+1|0,Z=T,T=+fe[O+8+(A<<4)>>3],ne=+Nr(+((T-Z)*.5)),W=M,M=+fe[O+8+(A<<4)+8>>3],W=+Nr(+((M-W)*.5)),W=ne*ne+W*(+Sr(+Z)*+Sr(+T)*W),D=D+ +La(+ +li(+W),+ +li(+(1-W)))*2;while((A|0)!=(g|0));return fe[x>>3]=D,O=0,ne=D,ne=ne*6371.007180918475,ne=ne*1e3,fe[x>>3]=ne,Ae=N,O|0}function jd(A){A=A|0;var g=0,x=0,T=0;return g=Fe(1,12)|0,g||Wn(27280,27235,49,27293),x=A+4|0,T=_[x>>2]|0,T|0?(T=T+8|0,_[T>>2]=g,_[x>>2]=g,g|0):(_[A>>2]|0&&Wn(27310,27235,61,27333),T=A,_[T>>2]=g,_[x>>2]=g,g|0)}function B0(A,g){A=A|0,g=g|0;var x=0,T=0;return T=Ge(24)|0,T||Wn(27347,27235,78,27361),_[T>>2]=_[g>>2],_[T+4>>2]=_[g+4>>2],_[T+8>>2]=_[g+8>>2],_[T+12>>2]=_[g+12>>2],_[T+16>>2]=0,g=A+4|0,x=_[g>>2]|0,x|0?(_[x+16>>2]=T,_[g>>2]=T,T|0):(_[A>>2]|0&&Wn(27376,27235,82,27361),_[A>>2]=T,_[g>>2]=T,T|0)}function Xd(A){A=A|0;var g=0,x=0,T=0,M=0;if(A)for(T=1;;){if(g=_[A>>2]|0,g|0)do{if(x=_[g>>2]|0,x|0)do M=x,x=_[x+16>>2]|0,Be(M);while((x|0)!=0);M=g,g=_[g+8>>2]|0,Be(M)}while((g|0)!=0);if(g=A,A=_[A+8>>2]|0,T||Be(g),A)T=0;else break}}function qs(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0,qt=0,xn=0,dn=0,Vn=0,qn=0,ur=0,Gn=0,Tn=0,Zt=0,hr=0,wi=0,ir=0;if(M=A+8|0,_[M>>2]|0)return ir=1,ir|0;if(T=_[A>>2]|0,!T)return ir=0,ir|0;g=T,x=0;do x=x+1|0,g=_[g+8>>2]|0;while((g|0)!=0);if(x>>>0<2)return ir=0,ir|0;hr=Ge(x<<2)|0,hr||Wn(27396,27235,317,27415),Zt=Ge(x<<5)|0,Zt||Wn(27437,27235,321,27415),_[A>>2]=0,xn=A+4|0,_[xn>>2]=0,_[M>>2]=0,x=0,Tn=0,qt=0,_e=0;e:for(;;){if(ne=_[T>>2]|0,ne){D=0,O=ne;do{if(W=+fe[O+8>>3],g=O,O=_[O+16>>2]|0,Z=(O|0)==0,M=Z?ne:O,N=+fe[M+8>>3],+kr(+(W-N))>3.141592653589793){ir=14;break}D=D+(N-W)*(+fe[g>>3]+ +fe[M>>3])}while(!Z);if((ir|0)==14){ir=0,D=0,g=ne;do qe=+fe[g+8>>3],Gn=g+16|0,ur=_[Gn>>2]|0,ur=(ur|0)==0?ne:ur,lt=+fe[ur+8>>3],D=D+(+fe[g>>3]+ +fe[ur>>3])*((lt<0?lt+6.283185307179586:lt)-(qe<0?qe+6.283185307179586:qe)),g=_[((g|0)==0?T:Gn)>>2]|0;while((g|0)!=0)}D>0?(_[hr+(Tn<<2)>>2]=T,Tn=Tn+1|0,M=qt,g=_e):ir=19}else ir=19;if((ir|0)==19){ir=0;do if(x){if(g=x+8|0,_[g>>2]|0){ir=21;break e}if(x=Fe(1,12)|0,!x){ir=23;break e}_[g>>2]=x,M=x+4|0,O=x,g=_e}else if(_e){M=xn,O=_e+8|0,g=T,x=A;break}else if(_[A>>2]|0){ir=27;break e}else{M=xn,O=A,g=T,x=A;break}while(!1);if(_[O>>2]=T,_[M>>2]=T,O=Zt+(qt<<5)|0,Z=_[T>>2]|0,Z){for(ne=Zt+(qt<<5)+8|0,fe[ne>>3]=17976931348623157e292,_e=Zt+(qt<<5)+24|0,fe[_e>>3]=17976931348623157e292,fe[O>>3]=-17976931348623157e292,Ce=Zt+(qt<<5)+16|0,fe[Ce>>3]=-17976931348623157e292,yt=17976931348623157e292,at=-17976931348623157e292,M=0,Se=Z,W=17976931348623157e292,Ye=17976931348623157e292,et=-17976931348623157e292,N=-17976931348623157e292;D=+fe[Se>>3],qe=+fe[Se+8>>3],Se=_[Se+16>>2]|0,Pe=(Se|0)==0,lt=+fe[(Pe?Z:Se)+8>>3],D<W&&(fe[ne>>3]=D,W=D),qe<Ye&&(fe[_e>>3]=qe,Ye=qe),D>et?fe[O>>3]=D:D=et,qe>N&&(fe[Ce>>3]=qe,N=qe),yt=qe>0&qe<yt?qe:yt,at=qe<0&qe>at?qe:at,M=M|+kr(+(qe-lt))>3.141592653589793,!Pe;)et=D;M&&(fe[Ce>>3]=at,fe[_e>>3]=yt)}else _[O>>2]=0,_[O+4>>2]=0,_[O+8>>2]=0,_[O+12>>2]=0,_[O+16>>2]=0,_[O+20>>2]=0,_[O+24>>2]=0,_[O+28>>2]=0;M=qt+1|0}if(Gn=T+8|0,T=_[Gn>>2]|0,_[Gn>>2]=0,T)qt=M,_e=g;else{ir=45;break}}if((ir|0)==21)Wn(27213,27235,35,27247);else if((ir|0)==23)Wn(27267,27235,37,27247);else if((ir|0)==27)Wn(27310,27235,61,27333);else if((ir|0)==45){e:do if((Tn|0)>0){for(Gn=(M|0)==0,qn=M<<2,ur=(A|0)==0,Vn=0,g=0;;){if(dn=_[hr+(Vn<<2)>>2]|0,Gn)ir=73;else{if(qt=Ge(qn)|0,!qt){ir=50;break}if(xn=Ge(qn)|0,!xn){ir=52;break}t:do if(ur)x=0;else{for(M=0,x=0,O=A;T=Zt+(M<<5)|0,ka(_[O>>2]|0,T,_[dn>>2]|0)|0?(_[qt+(x<<2)>>2]=O,_[xn+(x<<2)>>2]=T,Pe=x+1|0):Pe=x,O=_[O+8>>2]|0,O;)M=M+1|0,x=Pe;if((Pe|0)>0)if(T=_[qt>>2]|0,(Pe|0)==1)x=T;else for(Ce=0,Se=-1,x=T,_e=T;;){for(Z=_[_e>>2]|0,T=0,O=0;M=_[_[qt+(O<<2)>>2]>>2]|0,(M|0)==(Z|0)?ne=T:ne=T+((ka(M,_[xn+(O<<2)>>2]|0,_[Z>>2]|0)|0)&1)|0,O=O+1|0,(O|0)!=(Pe|0);)T=ne;if(M=(ne|0)>(Se|0),x=M?_e:x,T=Ce+1|0,(T|0)==(Pe|0))break t;Ce=T,Se=M?ne:Se,_e=_[qt+(T<<2)>>2]|0}else x=0}while(!1);if(Be(qt),Be(xn),x){if(M=x+4|0,T=_[M>>2]|0,T)x=T+8|0;else if(_[x>>2]|0){ir=70;break}_[x>>2]=dn,_[M>>2]=dn}else ir=73}if((ir|0)==73){if(ir=0,g=_[dn>>2]|0,g|0)do xn=g,g=_[g+16>>2]|0,Be(xn);while((g|0)!=0);Be(dn),g=1}if(Vn=Vn+1|0,(Vn|0)>=(Tn|0)){wi=g;break e}}(ir|0)==50?Wn(27452,27235,249,27471):(ir|0)==52?Wn(27490,27235,252,27471):(ir|0)==70&&Wn(27310,27235,61,27333)}else wi=0;while(!1);return Be(hr),Be(Zt),ir=wi,ir|0}return 0}function ka(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;if(!(bu(g,x)|0)||(g=Sg(g)|0,T=+fe[x>>3],M=+fe[x+8>>3],M=g&M<0?M+6.283185307179586:M,A=_[A>>2]|0,!A))return A=0,A|0;if(g){g=0,Z=M,x=A;e:for(;;){for(;O=+fe[x>>3],M=+fe[x+8>>3],x=x+16|0,ne=_[x>>2]|0,ne=(ne|0)==0?A:ne,D=+fe[ne>>3],N=+fe[ne+8>>3],O>D?(W=O,O=N):(W=D,D=O,O=M,M=N),T=T==D|T==W?T+2220446049250313e-31:T,!!(T<D|T>W);)if(x=_[x>>2]|0,!x){x=22;break e}if(N=O<0?O+6.283185307179586:O,O=M<0?M+6.283185307179586:M,Z=N==Z|O==Z?Z+-2220446049250313e-31:Z,W=N+(O-N)*((T-D)/(W-D)),(W<0?W+6.283185307179586:W)>Z&&(g=g^1),x=_[x>>2]|0,!x){x=22;break}}if((x|0)==22)return g|0}else{g=0,Z=M,x=A;e:for(;;){for(;O=+fe[x>>3],M=+fe[x+8>>3],x=x+16|0,ne=_[x>>2]|0,ne=(ne|0)==0?A:ne,D=+fe[ne>>3],N=+fe[ne+8>>3],O>D?(W=O,O=N):(W=D,D=O,O=M,M=N),T=T==D|T==W?T+2220446049250313e-31:T,!!(T<D|T>W);)if(x=_[x>>2]|0,!x){x=22;break e}if(Z=O==Z|M==Z?Z+-2220446049250313e-31:Z,O+(M-O)*((T-D)/(W-D))>Z&&(g=g^1),x=_[x>>2]|0,!x){x=22;break}}if((x|0)==22)return g|0}return 0}function Nl(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0;if(at=Ae,Ae=Ae+32|0,yt=at+16|0,et=at,D=Tt(A|0,g|0,52)|0,ve()|0,D=D&15,Se=Tt(x|0,T|0,52)|0,ve()|0,(D|0)!=(Se&15|0))return yt=12,Ae=at,yt|0;if(Z=Tt(A|0,g|0,45)|0,ve()|0,Z=Z&127,ne=Tt(x|0,T|0,45)|0,ve()|0,ne=ne&127,Z>>>0>121|ne>>>0>121)return yt=5,Ae=at,yt|0;if(Se=(Z|0)!=(ne|0),Se){if(N=yf(Z,ne)|0,(N|0)==7)return yt=1,Ae=at,yt|0;W=yf(ne,Z)|0,(W|0)==7?Wn(27514,27538,161,27548):(Pe=N,O=W)}else Pe=0,O=0;_e=Qr(Z)|0,Ce=Qr(ne)|0,_[yt>>2]=0,_[yt+4>>2]=0,_[yt+8>>2]=0,_[yt+12>>2]=0;do if(Pe){if(ne=_[4272+(Z*28|0)+(Pe<<2)>>2]|0,N=(ne|0)>0,Ce)if(N){Z=0,W=x,N=T;do W=Ex(W,N)|0,N=ve()|0,O=kc(O)|0,(O|0)==1&&(O=kc(1)|0),Z=Z+1|0;while((Z|0)!=(ne|0));ne=O,Z=W,W=N}else ne=O,Z=x,W=T;else if(N){Z=0,W=x,N=T;do W=Su(W,N)|0,N=ve()|0,O=kc(O)|0,Z=Z+1|0;while((Z|0)!=(ne|0));ne=O,Z=W,W=N}else ne=O,Z=x,W=T;if(Cf(Z,W,yt)|0,Se||Wn(27563,27538,191,27548),N=(_e|0)!=0,O=(Ce|0)!=0,N&O&&Wn(27590,27538,192,27548),N){if(O=ts(A,g)|0,(O|0)==7){D=5;break}if(zt[22e3+(O*7|0)+Pe>>0]|0){D=1;break}W=_[21168+(O*28|0)+(Pe<<2)>>2]|0,Z=W}else if(O){if(O=ts(Z,W)|0,(O|0)==7){D=5;break}if(zt[22e3+(O*7|0)+ne>>0]|0){D=1;break}Z=0,W=_[21168+(ne*28|0)+(O<<2)>>2]|0}else Z=0,W=0;if((Z|W|0)<0)D=5;else{if((W|0)>0){N=yt+4|0,O=0;do Tu(N),O=O+1|0;while((O|0)!=(W|0))}if(_[et>>2]=0,_[et+4>>2]=0,_[et+8>>2]=0,v0(et,Pe),D|0)for(;ho(D)|0?Ll(et):Oa(et),(D|0)>1;)D=D+-1|0;if((Z|0)>0){D=0;do Tu(et),D=D+1|0;while((D|0)!=(Z|0))}Ye=yt+4|0,ps(Ye,et,Ye),ds(Ye),Ye=51}}else if(Cf(x,T,yt)|0,(_e|0)!=0&(Ce|0)!=0)if((ne|0)!=(Z|0)&&Wn(27621,27538,261,27548),O=ts(A,g)|0,D=ts(x,T)|0,(O|0)==7|(D|0)==7)D=5;else if(zt[22e3+(O*7|0)+D>>0]|0)D=1;else if(O=_[21168+(O*28|0)+(D<<2)>>2]|0,(O|0)>0){N=yt+4|0,D=0;do Tu(N),D=D+1|0;while((D|0)!=(O|0));Ye=51}else Ye=51;else Ye=51;while(!1);return(Ye|0)==51&&(D=yt+4|0,_[M>>2]=_[D>>2],_[M+4>>2]=_[D+4>>2],_[M+8>>2]=_[D+8>>2],D=0),yt=D,Ae=at,yt|0}function zg(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0;if(Ye=Ae,Ae=Ae+48|0,Z=Ye+36|0,O=Ye+24|0,N=Ye+12|0,W=Ye,M=Tt(A|0,g|0,52)|0,ve()|0,M=M&15,Ce=Tt(A|0,g|0,45)|0,ve()|0,Ce=Ce&127,Ce>>>0>121)return T=5,Ae=Ye,T|0;if(ne=Qr(Ce)|0,Ot(M|0,0,52)|0,et=ve()|0|134225919,D=T,_[D>>2]=-1,_[D+4>>2]=et,!M)return M=Sh(x)|0,(M|0)==7||(M=Fc(Ce,M)|0,(M|0)==127)?(et=1,Ae=Ye,et|0):(Se=Ot(M|0,0,45)|0,Pe=ve()|0,Ce=T,Pe=_[Ce+4>>2]&-1040385|Pe,et=T,_[et>>2]=_[Ce>>2]|Se,_[et+4>>2]=Pe,et=0,Ae=Ye,et|0);for(_[Z>>2]=_[x>>2],_[Z+4>>2]=_[x+4>>2],_[Z+8>>2]=_[x+8>>2],x=M;;){if(D=x,x=x+-1|0,_[O>>2]=_[Z>>2],_[O+4>>2]=_[Z+4>>2],_[O+8>>2]=_[Z+8>>2],ho(D)|0){if(M=Mg(Z)|0,M|0){x=13;break}_[N>>2]=_[Z>>2],_[N+4>>2]=_[Z+4>>2],_[N+8>>2]=_[Z+8>>2],Ll(N)}else{if(M=Ig(Z)|0,M|0){x=13;break}_[N>>2]=_[Z>>2],_[N+4>>2]=_[Z+4>>2],_[N+8>>2]=_[Z+8>>2],Oa(N)}if(wu(O,N,W),ds(W),M=T,at=_[M>>2]|0,M=_[M+4>>2]|0,lt=(15-D|0)*3|0,yt=Ot(7,0,lt|0)|0,M=M&~(ve()|0),lt=Ot(Sh(W)|0,0,lt|0)|0,M=ve()|0|M,et=T,_[et>>2]=lt|at&~yt,_[et+4>>2]=M,(D|0)<=1){x=14;break}}e:do if((x|0)!=13&&(x|0)==14)if((_[Z>>2]|0)<=1&&(_[Z+4>>2]|0)<=1&&(_[Z+8>>2]|0)<=1){x=Sh(Z)|0,M=Fc(Ce,x)|0,(M|0)==127?W=0:W=Qr(M)|0;t:do if(x){if(ne){if(M=ts(A,g)|0,(M|0)==7){M=5;break e}if(D=_[21376+(M*28|0)+(x<<2)>>2]|0,(D|0)>0){M=x,x=0;do M=Ch(M)|0,x=x+1|0;while((x|0)!=(D|0))}else M=x;if((M|0)==1){M=9;break e}x=Fc(Ce,M)|0,(x|0)==127&&Wn(27648,27538,411,27678),Qr(x)|0?Wn(27693,27538,412,27678):(Pe=x,Se=D,_e=M)}else Pe=M,Se=0,_e=x;if(N=_[4272+(Ce*28|0)+(_e<<2)>>2]|0,(N|0)<=-1&&Wn(27724,27538,419,27678),!W){if((Se|0)<0){M=5;break e}if(Se|0){D=T,M=0,x=_[D>>2]|0,D=_[D+4>>2]|0;do x=Rh(x,D)|0,D=ve()|0,lt=T,_[lt>>2]=x,_[lt+4>>2]=D,M=M+1|0;while((M|0)<(Se|0))}if((N|0)<=0){M=Pe,x=58;break}for(D=T,M=0,x=_[D>>2]|0,D=_[D+4>>2]|0;;)if(x=Rh(x,D)|0,D=ve()|0,lt=T,_[lt>>2]=x,_[lt+4>>2]=D,M=M+1|0,(M|0)==(N|0)){M=Pe,x=58;break t}}if(O=yf(Pe,Ce)|0,(O|0)==7&&Wn(27514,27538,428,27678),M=T,x=_[M>>2]|0,M=_[M+4>>2]|0,(N|0)>0){D=0;do x=Rh(x,M)|0,M=ve()|0,lt=T,_[lt>>2]=x,_[lt+4>>2]=M,D=D+1|0;while((D|0)!=(N|0))}if(M=ts(x,M)|0,(M|0)==7&&Wn(27795,27538,440,27678),x=wh(Pe)|0,x=_[(x?21792:21584)+(O*28|0)+(M<<2)>>2]|0,(x|0)<0&&Wn(27795,27538,454,27678),!x)M=Pe,x=58;else{O=T,M=0,D=_[O>>2]|0,O=_[O+4>>2]|0;do D=C0(D,O)|0,O=ve()|0,lt=T,_[lt>>2]=D,_[lt+4>>2]=O,M=M+1|0;while((M|0)<(x|0));M=Pe,x=58}}else if((ne|0)!=0&(W|0)!=0){if(x=ts(A,g)|0,D=T,D=ts(_[D>>2]|0,_[D+4>>2]|0)|0,(x|0)==7|(D|0)==7){M=5;break e}if(D=_[21376+(x*28|0)+(D<<2)>>2]|0,(D|0)<0){M=5;break e}if(!D)x=59;else{N=T,x=0,O=_[N>>2]|0,N=_[N+4>>2]|0;do O=Rh(O,N)|0,N=ve()|0,lt=T,_[lt>>2]=O,_[lt+4>>2]=N,x=x+1|0;while((x|0)<(D|0));x=58}}else x=58;while(!1);if((x|0)==58&&W&&(x=59),(x|0)==59&&(lt=T,(ts(_[lt>>2]|0,_[lt+4>>2]|0)|0)==1)){M=9;break}lt=T,yt=_[lt>>2]|0,lt=_[lt+4>>2]&-1040385,at=Ot(M|0,0,45)|0,lt=lt|(ve()|0),M=T,_[M>>2]=yt|at,_[M+4>>2]=lt,M=0}else M=1;while(!1);return lt=M,Ae=Ye,lt|0}function Sx(A,g,x,T,M,D){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0,D=D|0;var O=0,N=0;return N=Ae,Ae=Ae+16|0,O=N,M?A=15:(A=Nl(A,g,x,T,O)|0,A||(H_(O,D),A=0)),Ae=N,A|0}function Cx(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0;return O=Ae,Ae=Ae+16|0,D=O,T?x=15:(x=Id(x,D)|0,x||(x=zg(A,g,D,M)|0)),Ae=O,x|0}function Yd(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0;return W=Ae,Ae=Ae+32|0,O=W+12|0,N=W,D=Nl(A,g,A,g,O)|0,D|0?(N=D,Ae=W,N|0):(A=Nl(A,g,x,T,N)|0,A|0?(N=A,Ae=W,N|0):(O=b0(O,N)|0,N=M,_[N>>2]=O,_[N+4>>2]=((O|0)<0)<<31>>31,N=0,Ae=W,N|0))}function Yi(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0;return W=Ae,Ae=Ae+32|0,O=W+12|0,N=W,D=Nl(A,g,A,g,O)|0,!D&&(D=Nl(A,g,x,T,N)|0,!D)?(T=b0(O,N)|0,T=Ve(T|0,((T|0)<0)<<31>>31|0,1,0)|0,O=ve()|0,N=M,_[N>>2]=T,_[N+4>>2]=O,N=0,Ae=W,N|0):(N=D,Ae=W,N|0)}function fo(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0,qt=0,xn=0,dn=0,Vn=0;if(dn=Ae,Ae=Ae+48|0,qt=dn+24|0,O=dn+12|0,xn=dn,D=Nl(A,g,A,g,qt)|0,!D&&(D=Nl(A,g,x,T,O)|0,!D)){lt=b0(qt,O)|0,qe=((lt|0)<0)<<31>>31,_[qt>>2]=0,_[qt+4>>2]=0,_[qt+8>>2]=0,_[O>>2]=0,_[O+4>>2]=0,_[O+8>>2]=0,Nl(A,g,A,g,qt)|0&&Wn(27795,27538,692,27747),Nl(A,g,x,T,O)|0&&Wn(27795,27538,697,27747),Pd(qt),Pd(O),ne=(lt|0)==0?0:1/+(lt|0),x=_[qt>>2]|0,Ye=ne*+((_[O>>2]|0)-x|0),et=qt+4|0,T=_[et>>2]|0,yt=ne*+((_[O+4>>2]|0)-T|0),at=qt+8|0,D=_[at>>2]|0,ne=ne*+((_[O+8>>2]|0)-D|0),_[xn>>2]=x,_e=xn+4|0,_[_e>>2]=T,Ce=xn+8|0,_[Ce>>2]=D;e:do if((lt|0)<0)D=0;else for(Se=0,Pe=0;;){W=+(Pe>>>0)+4294967296*+(Se|0),Vn=Ye*W+ +(x|0),N=yt*W+ +(T|0),W=ne*W+ +(D|0),x=~~+Ri(+Vn),O=~~+Ri(+N),D=~~+Ri(+W),Vn=+kr(+(+(x|0)-Vn)),N=+kr(+(+(O|0)-N)),W=+kr(+(+(D|0)-W));do if(Vn>N&Vn>W)x=0-(O+D)|0,T=O;else if(Z=0-x|0,N>W){T=Z-D|0;break}else{T=O,D=Z-O|0;break}while(!1);if(_[xn>>2]=x,_[_e>>2]=T,_[Ce>>2]=D,W_(xn),D=zg(A,g,xn,M+(Pe<<3)|0)|0,D|0)break e;if(!((Se|0)<(qe|0)|(Se|0)==(qe|0)&Pe>>>0<lt>>>0)){D=0;break e}x=Ve(Pe|0,Se|0,1,0)|0,T=ve()|0,Se=T,Pe=x,x=_[qt>>2]|0,T=_[et>>2]|0,D=_[at>>2]|0}while(!1);return xn=D,Ae=dn,xn|0}return xn=D,Ae=dn,xn|0}function ua(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0;if((x|0)==0&(T|0)==0)return M=0,D=1,Jn(M|0),D|0;D=A,M=g,A=1,g=0;do O=(x&1|0)==0&!0,A=Ut((O?1:D)|0,(O?0:M)|0,A|0,g|0)|0,g=ve()|0,x=jn(x|0,T|0,1)|0,T=ve()|0,D=Ut(D|0,M|0,D|0,M|0)|0,M=ve()|0;while(!((x|0)==0&(T|0)==0));return Jn(g|0),A|0}function Dh(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;N=Ae,Ae=Ae+16|0,D=N,O=Tt(A|0,g|0,52)|0,ve()|0,O=O&15;do if(O){if(M=sl(A,g,D)|0,!M){Z=+fe[D>>3],W=1/+Sr(+Z),ne=+fe[25968+(O<<3)>>3],fe[x>>3]=Z+ne,fe[x+8>>3]=Z-ne,Z=+fe[D+8>>3],W=ne*W,fe[x+16>>3]=W+Z,fe[x+24>>3]=Z-W;break}return O=M,Ae=N,O|0}else{if(M=Tt(A|0,g|0,45)|0,ve()|0,M=M&127,M>>>0>121)return O=5,Ae=N,O|0;D=22064+(M<<5)|0,_[x>>2]=_[D>>2],_[x+4>>2]=_[D+4>>2],_[x+8>>2]=_[D+8>>2],_[x+12>>2]=_[D+12>>2],_[x+16>>2]=_[D+16>>2],_[x+20>>2]=_[D+20>>2],_[x+24>>2]=_[D+24>>2],_[x+28>>2]=_[D+28>>2];break}while(!1);return Sd(x,T?1.4:1.1),T=26096+(O<<3)|0,(_[T>>2]|0)==(A|0)&&(_[T+4>>2]|0)==(g|0)&&(fe[x>>3]=1.5707963267948966),O=26224+(O<<3)|0,(_[O>>2]|0)==(A|0)&&(_[O+4>>2]|0)==(g|0)&&(fe[x+8>>3]=-1.5707963267948966),+fe[x>>3]!=1.5707963267948966&&+fe[x+8>>3]!=-1.5707963267948966?(O=0,Ae=N,O|0):(fe[x+16>>3]=3.141592653589793,fe[x+24>>3]=-3.141592653589793,O=0,Ae=N,O|0)}function D0(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;Z=Ae,Ae=Ae+48|0,O=Z+32|0,D=Z+40|0,N=Z,Fd(O,0,0,0),W=_[O>>2]|0,O=_[O+4>>2]|0;do if(x>>>0<=15){if(M=Nc(T)|0,M|0){T=N,_[T>>2]=0,_[T+4>>2]=0,_[N+8>>2]=M,_[N+12>>2]=-1,T=N+16|0,W=N+29|0,_[T>>2]=0,_[T+4>>2]=0,_[T+8>>2]=0,zt[T+12>>0]=0,zt[W>>0]=zt[D>>0]|0,zt[W+1>>0]=zt[D+1>>0]|0,zt[W+2>>0]=zt[D+2>>0]|0;break}if(M=Fe((_[g+8>>2]|0)+1|0,32)|0,M){Df(g,M),ne=N,_[ne>>2]=W,_[ne+4>>2]=O,_[N+8>>2]=0,_[N+12>>2]=x,_[N+16>>2]=T,_[N+20>>2]=g,_[N+24>>2]=M,zt[N+28>>0]=0,W=N+29|0,zt[W>>0]=zt[D>>0]|0,zt[W+1>>0]=zt[D+1>>0]|0,zt[W+2>>0]=zt[D+2>>0]|0;break}else{T=N,_[T>>2]=0,_[T+4>>2]=0,_[N+8>>2]=13,_[N+12>>2]=-1,T=N+16|0,W=N+29|0,_[T>>2]=0,_[T+4>>2]=0,_[T+8>>2]=0,zt[T+12>>0]=0,zt[W>>0]=zt[D>>0]|0,zt[W+1>>0]=zt[D+1>>0]|0,zt[W+2>>0]=zt[D+2>>0]|0;break}}else W=N,_[W>>2]=0,_[W+4>>2]=0,_[N+8>>2]=4,_[N+12>>2]=-1,W=N+16|0,ne=N+29|0,_[W>>2]=0,_[W+4>>2]=0,_[W+8>>2]=0,zt[W+12>>0]=0,zt[ne>>0]=zt[D>>0]|0,zt[ne+1>>0]=zt[D+1>>0]|0,zt[ne+2>>0]=zt[D+2>>0]|0;while(!1);Bf(N),_[A>>2]=_[N>>2],_[A+4>>2]=_[N+4>>2],_[A+8>>2]=_[N+8>>2],_[A+12>>2]=_[N+12>>2],_[A+16>>2]=_[N+16>>2],_[A+20>>2]=_[N+20>>2],_[A+24>>2]=_[N+24>>2],_[A+28>>2]=_[N+28>>2],Ae=Z}function Bf(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0;if(qe=Ae,Ae=Ae+336|0,Se=qe+168|0,Pe=qe,T=A,x=_[T>>2]|0,T=_[T+4>>2]|0,(x|0)==0&(T|0)==0){Ae=qe;return}if(g=A+28|0,zt[g>>0]|0?(x=Zd(x,T)|0,T=ve()|0):zt[g>>0]=1,lt=A+20|0,!(_[_[lt>>2]>>2]|0)){g=A+24|0,x=_[g>>2]|0,x|0&&Be(x),at=A,_[at>>2]=0,_[at+4>>2]=0,_[A+8>>2]=0,_[lt>>2]=0,_[A+12>>2]=-1,_[A+16>>2]=0,_[g>>2]=0,Ae=qe;return}at=A+16|0,g=_[at>>2]|0,M=g&15;e:do if((x|0)==0&(T|0)==0)yt=A+24|0;else{Ye=A+12|0,_e=(M|0)==3,ne=g&255,W=(M|1|0)==3,Ce=A+24|0,Z=(M+-1|0)>>>0<3,O=(M|2|0)==3,N=Pe+8|0;t:for(;;){if(D=Tt(x|0,T|0,52)|0,ve()|0,D=D&15,(D|0)==(_[Ye>>2]|0)){switch(ne&15){case 0:case 2:case 3:{if(M=sl(x,T,Se)|0,M|0){et=15;break t}if(Lh(_[lt>>2]|0,_[Ce>>2]|0,Se)|0){et=19;break t}break}default:}if(W&&(M=_[(_[lt>>2]|0)+4>>2]|0,_[Se>>2]=_[M>>2],_[Se+4>>2]=_[M+4>>2],_[Se+8>>2]=_[M+8>>2],_[Se+12>>2]=_[M+12>>2],bu(26832,Se)|0)){if(un(_[(_[lt>>2]|0)+4>>2]|0,D,Pe)|0){et=25;break}if(M=Pe,(_[M>>2]|0)==(x|0)&&(_[M+4>>2]|0)==(T|0)){et=29;break}}if(Z){if(M=uc(x,T,Se)|0,M|0){et=32;break}if(Dh(x,T,Pe,0)|0){et=36;break}if(O&&L0(_[lt>>2]|0,_[Ce>>2]|0,Se,Pe)|0){et=42;break}if(W&&Pu(_[lt>>2]|0,_[Ce>>2]|0,Se,Pe)|0){et=42;break}}if(_e){if(g=Dh(x,T,Se,1)|0,M=_[Ce>>2]|0,g|0){et=45;break}if(y0(M,Se)|0){if(Ed(Pe,Se),cr(Se,_[Ce>>2]|0)|0){et=53;break}if(Lh(_[lt>>2]|0,_[Ce>>2]|0,N)|0){et=53;break}if(Pu(_[lt>>2]|0,_[Ce>>2]|0,Pe,Se)|0){et=53;break}}}}do if((D|0)<(_[Ye>>2]|0)){if(g=Dh(x,T,Se,1)|0,M=_[Ce>>2]|0,g|0){et=58;break t}if(!(y0(M,Se)|0)){et=73;break}if(cr(_[Ce>>2]|0,Se)|0&&(Ed(Pe,Se),L0(_[lt>>2]|0,_[Ce>>2]|0,Pe,Se)|0)){et=65;break t}if(x=ol(x,T,D+1|0,Pe)|0,x|0){et=67;break t}T=Pe,x=_[T>>2]|0,T=_[T+4>>2]|0}else et=73;while(!1);if((et|0)==73&&(et=0,x=Zd(x,T)|0,T=ve()|0),(x|0)==0&(T|0)==0){yt=Ce;break e}}switch(et|0){case 15:{g=_[Ce>>2]|0,g|0&&Be(g),et=A,_[et>>2]=0,_[et+4>>2]=0,_[lt>>2]=0,_[Ye>>2]=-1,_[at>>2]=0,_[Ce>>2]=0,_[A+8>>2]=M,et=20;break}case 19:{_[A>>2]=x,_[A+4>>2]=T,et=20;break}case 25:{Wn(27795,27761,470,27772);break}case 29:{_[A>>2]=x,_[A+4>>2]=T,Ae=qe;return}case 32:{g=_[Ce>>2]|0,g|0&&Be(g),yt=A,_[yt>>2]=0,_[yt+4>>2]=0,_[lt>>2]=0,_[Ye>>2]=-1,_[at>>2]=0,_[Ce>>2]=0,_[A+8>>2]=M,Ae=qe;return}case 36:{Wn(27795,27761,493,27772);break}case 42:{_[A>>2]=x,_[A+4>>2]=T,Ae=qe;return}case 45:{M|0&&Be(M),et=A,_[et>>2]=0,_[et+4>>2]=0,_[lt>>2]=0,_[Ye>>2]=-1,_[at>>2]=0,_[Ce>>2]=0,_[A+8>>2]=g,et=55;break}case 53:{_[A>>2]=x,_[A+4>>2]=T,et=55;break}case 58:{M|0&&Be(M),et=A,_[et>>2]=0,_[et+4>>2]=0,_[lt>>2]=0,_[Ye>>2]=-1,_[at>>2]=0,_[Ce>>2]=0,_[A+8>>2]=g,et=71;break}case 65:{_[A>>2]=x,_[A+4>>2]=T,et=71;break}case 67:{g=_[Ce>>2]|0,g|0&&Be(g),yt=A,_[yt>>2]=0,_[yt+4>>2]=0,_[lt>>2]=0,_[Ye>>2]=-1,_[at>>2]=0,_[Ce>>2]=0,_[A+8>>2]=x,Ae=qe;return}}if((et|0)==20){Ae=qe;return}else if((et|0)==55){Ae=qe;return}else if((et|0)==71){Ae=qe;return}}while(!1);g=_[yt>>2]|0,g|0&&Be(g),et=A,_[et>>2]=0,_[et+4>>2]=0,_[A+8>>2]=0,_[lt>>2]=0,_[A+12>>2]=-1,_[at>>2]=0,_[yt>>2]=0,Ae=qe}function Zd(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0;_e=Ae,Ae=Ae+16|0,ne=_e,T=Tt(A|0,g|0,52)|0,ve()|0,T=T&15,x=Tt(A|0,g|0,45)|0,ve()|0;do if(T){for(;x=Ot(T+4095|0,0,52)|0,M=ve()|0|g&-15728641,D=(15-T|0)*3|0,O=Ot(7,0,D|0)|0,N=ve()|0,x=x|A|O,M=M|N,W=Tt(A|0,g|0,D|0)|0,ve()|0,W=W&7,T=T+-1|0,!(W>>>0<6);)if(T)g=M,A=x;else{Z=4;break}if((Z|0)==4){x=Tt(x|0,M|0,45)|0,ve()|0;break}return ne=(W|0)==0&(dr(x,M)|0)!=0,ne=Ot((ne?2:1)+W|0,0,D|0)|0,Z=ve()|0|g&~N,ne=ne|A&~O,Jn(Z|0),Ae=_e,ne|0}while(!1);return x=x&127,x>>>0>120?(Z=0,ne=0,Jn(Z|0),Ae=_e,ne|0):(Fd(ne,0,x+1|0,0),Z=_[ne+4>>2]|0,ne=_[ne>>2]|0,Jn(Z|0),Ae=_e,ne|0)}function Ug(A,g,x,T,M,D){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0,D=D|0;var O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0;et=Ae,Ae=Ae+160|0,_e=et+80|0,N=et+64|0,Ce=et+112|0,Ye=et,D0(_e,A,g,x),Z=_e,Fg(N,_[Z>>2]|0,_[Z+4>>2]|0,g),Z=N,W=_[Z>>2]|0,Z=_[Z+4>>2]|0,O=_[_e+8>>2]|0,Se=Ce+4|0,_[Se>>2]=_[_e>>2],_[Se+4>>2]=_[_e+4>>2],_[Se+8>>2]=_[_e+8>>2],_[Se+12>>2]=_[_e+12>>2],_[Se+16>>2]=_[_e+16>>2],_[Se+20>>2]=_[_e+20>>2],_[Se+24>>2]=_[_e+24>>2],_[Se+28>>2]=_[_e+28>>2],Se=Ye,_[Se>>2]=W,_[Se+4>>2]=Z,Se=Ye+8|0,_[Se>>2]=O,A=Ye+12|0,g=Ce,x=A+36|0;do _[A>>2]=_[g>>2],A=A+4|0,g=g+4|0;while((A|0)<(x|0));if(Ce=Ye+48|0,_[Ce>>2]=_[N>>2],_[Ce+4>>2]=_[N+4>>2],_[Ce+8>>2]=_[N+8>>2],_[Ce+12>>2]=_[N+12>>2],(W|0)==0&(Z|0)==0)return Ye=O,Ae=et,Ye|0;x=Ye+16|0,ne=Ye+24|0,_e=Ye+28|0,O=0,N=0,g=W,A=Z;do{if(!((O|0)<(M|0)|(O|0)==(M|0)&N>>>0<T>>>0)){Pe=4;break}if(Z=N,N=Ve(N|0,O|0,1,0)|0,O=ve()|0,Z=D+(Z<<3)|0,_[Z>>2]=g,_[Z+4>>2]=A,If(Ce),A=Ce,g=_[A>>2]|0,A=_[A+4>>2]|0,(g|0)==0&(A|0)==0){if(Bf(x),g=x,A=_[g>>2]|0,g=_[g+4>>2]|0,(A|0)==0&(g|0)==0){Pe=10;break}Gd(A,g,_[_e>>2]|0,Ce),A=Ce,g=_[A>>2]|0,A=_[A+4>>2]|0}Z=Ye,_[Z>>2]=g,_[Z+4>>2]=A}while(!((g|0)==0&(A|0)==0));return(Pe|0)==4?(A=Ye+40|0,g=_[A>>2]|0,g|0&&Be(g),Pe=Ye+16|0,_[Pe>>2]=0,_[Pe+4>>2]=0,_[ne>>2]=0,_[Ye+36>>2]=0,_[_e>>2]=-1,_[Ye+32>>2]=0,_[A>>2]=0,Gd(0,0,0,Ce),_[Ye>>2]=0,_[Ye+4>>2]=0,_[Se>>2]=0,Ye=14,Ae=et,Ye|0):((Pe|0)==10&&(_[Ye>>2]=0,_[Ye+4>>2]=0,_[Se>>2]=_[ne>>2]),Ye=_[Se>>2]|0,Ae=et,Ye|0)}function qd(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0;if(_e=Ae,Ae=Ae+48|0,W=_e+32|0,N=_e+40|0,Z=_e,!(_[A>>2]|0))return ne=T,_[ne>>2]=0,_[ne+4>>2]=0,ne=0,Ae=_e,ne|0;Fd(W,0,0,0),O=W,M=_[O>>2]|0,O=_[O+4>>2]|0;do if(g>>>0>15)ne=Z,_[ne>>2]=0,_[ne+4>>2]=0,_[Z+8>>2]=4,_[Z+12>>2]=-1,ne=Z+16|0,x=Z+29|0,_[ne>>2]=0,_[ne+4>>2]=0,_[ne+8>>2]=0,zt[ne+12>>0]=0,zt[x>>0]=zt[N>>0]|0,zt[x+1>>0]=zt[N+1>>0]|0,zt[x+2>>0]=zt[N+2>>0]|0,x=4,ne=9;else{if(x=Nc(x)|0,x|0){W=Z,_[W>>2]=0,_[W+4>>2]=0,_[Z+8>>2]=x,_[Z+12>>2]=-1,W=Z+16|0,ne=Z+29|0,_[W>>2]=0,_[W+4>>2]=0,_[W+8>>2]=0,zt[W+12>>0]=0,zt[ne>>0]=zt[N>>0]|0,zt[ne+1>>0]=zt[N+1>>0]|0,zt[ne+2>>0]=zt[N+2>>0]|0,ne=9;break}if(x=Fe((_[A+8>>2]|0)+1|0,32)|0,!x){ne=Z,_[ne>>2]=0,_[ne+4>>2]=0,_[Z+8>>2]=13,_[Z+12>>2]=-1,ne=Z+16|0,x=Z+29|0,_[ne>>2]=0,_[ne+4>>2]=0,_[ne+8>>2]=0,zt[ne+12>>0]=0,zt[x>>0]=zt[N>>0]|0,zt[x+1>>0]=zt[N+1>>0]|0,zt[x+2>>0]=zt[N+2>>0]|0,x=13,ne=9;break}Df(A,x),Se=Z,_[Se>>2]=M,_[Se+4>>2]=O,O=Z+8|0,_[O>>2]=0,_[Z+12>>2]=g,_[Z+20>>2]=A,_[Z+24>>2]=x,zt[Z+28>>0]=0,M=Z+29|0,zt[M>>0]=zt[N>>0]|0,zt[M+1>>0]=zt[N+1>>0]|0,zt[M+2>>0]=zt[N+2>>0]|0,_[Z+16>>2]=3,Ce=+xf(x),Ce=Ce*+_0(x),D=+kr(+ +fe[x>>3]),D=Ce/+Sr(+ +Kr(+D,+ +kr(+ +fe[x+8>>3])))*6371.007180918475*6371.007180918475,M=Z+12|0,x=_[M>>2]|0;e:do if((x|0)>0)do{if(q_(x+-1|0,W)|0,!(D/+fe[W>>3]>10))break e;Se=_[M>>2]|0,x=Se+-1|0,_[M>>2]=x}while((Se|0)>1);while(!1);if(Bf(Z),M=T,_[M>>2]=0,_[M+4>>2]=0,M=Z,x=_[M>>2]|0,M=_[M+4>>2]|0,!((x|0)==0&(M|0)==0))do Ef(x,M,g,W)|0,N=W,A=T,N=Ve(_[A>>2]|0,_[A+4>>2]|0,_[N>>2]|0,_[N+4>>2]|0)|0,A=ve()|0,Se=T,_[Se>>2]=N,_[Se+4>>2]=A,Bf(Z),Se=Z,x=_[Se>>2]|0,M=_[Se+4>>2]|0;while(!((x|0)==0&(M|0)==0));x=_[O>>2]|0}while(!1);return Se=x,Ae=_e,Se|0}function Na(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0;if(!(bu(g,x)|0)||(g=Sg(g)|0,T=+fe[x>>3],M=+fe[x+8>>3],M=g&M<0?M+6.283185307179586:M,Ce=_[A>>2]|0,(Ce|0)<=0))return Ce=0,Ce|0;if(_e=_[A+4>>2]|0,g){g=0,ne=M,x=-1,A=0;e:for(;;){for(Z=A;O=+fe[_e+(Z<<4)>>3],M=+fe[_e+(Z<<4)+8>>3],A=(x+2|0)%(Ce|0)|0,D=+fe[_e+(A<<4)>>3],N=+fe[_e+(A<<4)+8>>3],O>D?(W=O,O=N):(W=D,D=O,O=M,M=N),T=T==D|T==W?T+2220446049250313e-31:T,!!(T<D|T>W);)if(x=Z+1|0,(x|0)>=(Ce|0)){x=22;break e}else A=Z,Z=x,x=A;if(N=O<0?O+6.283185307179586:O,O=M<0?M+6.283185307179586:M,ne=N==ne|O==ne?ne+-2220446049250313e-31:ne,W=N+(O-N)*((T-D)/(W-D)),(W<0?W+6.283185307179586:W)>ne&&(g=g^1),A=Z+1|0,(A|0)>=(Ce|0)){x=22;break}else x=Z}if((x|0)==22)return g|0}else{g=0,ne=M,x=-1,A=0;e:for(;;){for(Z=A;O=+fe[_e+(Z<<4)>>3],M=+fe[_e+(Z<<4)+8>>3],A=(x+2|0)%(Ce|0)|0,D=+fe[_e+(A<<4)>>3],N=+fe[_e+(A<<4)+8>>3],O>D?(W=O,O=N):(W=D,D=O,O=M,M=N),T=T==D|T==W?T+2220446049250313e-31:T,!!(T<D|T>W);)if(x=Z+1|0,(x|0)>=(Ce|0)){x=22;break e}else A=Z,Z=x,x=A;if(ne=O==ne|M==ne?ne+-2220446049250313e-31:ne,O+(M-O)*((T-D)/(W-D))>ne&&(g=g^1),A=Z+1|0,(A|0)>=(Ce|0)){x=22;break}else x=Z}if((x|0)==22)return g|0}return 0}function Qd(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0;if(Pe=_[A>>2]|0,!Pe){_[g>>2]=0,_[g+4>>2]=0,_[g+8>>2]=0,_[g+12>>2]=0,_[g+16>>2]=0,_[g+20>>2]=0,_[g+24>>2]=0,_[g+28>>2]=0;return}if(Ye=g+8|0,fe[Ye>>3]=17976931348623157e292,et=g+24|0,fe[et>>3]=17976931348623157e292,fe[g>>3]=-17976931348623157e292,yt=g+16|0,fe[yt>>3]=-17976931348623157e292,!((Pe|0)<=0)){for(Ce=_[A+4>>2]|0,Z=17976931348623157e292,ne=-17976931348623157e292,_e=0,A=-1,D=17976931348623157e292,O=17976931348623157e292,W=-17976931348623157e292,T=-17976931348623157e292,Se=0;x=+fe[Ce+(Se<<4)>>3],N=+fe[Ce+(Se<<4)+8>>3],A=A+2|0,M=+fe[Ce+(((A|0)==(Pe|0)?0:A)<<4)+8>>3],x<D&&(fe[Ye>>3]=x,D=x),N<O&&(fe[et>>3]=N,O=N),x>W?fe[g>>3]=x:x=W,N>T&&(fe[yt>>3]=N,T=N),Z=N>0&N<Z?N:Z,ne=N<0&N>ne?N:ne,_e=_e|+kr(+(N-M))>3.141592653589793,A=Se+1|0,(A|0)!=(Pe|0);)at=Se,W=x,Se=A,A=at;_e&&(fe[yt>>3]=ne,fe[et>>3]=Z)}}function Nc(A){return A=A|0,(A>>>0<4?0:15)|0}function Df(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0,qt=0,xn=0,dn=0;if(Pe=_[A>>2]|0,Pe){if(Ye=g+8|0,fe[Ye>>3]=17976931348623157e292,et=g+24|0,fe[et>>3]=17976931348623157e292,fe[g>>3]=-17976931348623157e292,yt=g+16|0,fe[yt>>3]=-17976931348623157e292,(Pe|0)>0){for(M=_[A+4>>2]|0,Ce=17976931348623157e292,Se=-17976931348623157e292,T=0,x=-1,W=17976931348623157e292,Z=17976931348623157e292,_e=-17976931348623157e292,O=-17976931348623157e292,at=0;D=+fe[M+(at<<4)>>3],ne=+fe[M+(at<<4)+8>>3],xn=x+2|0,N=+fe[M+(((xn|0)==(Pe|0)?0:xn)<<4)+8>>3],D<W&&(fe[Ye>>3]=D,W=D),ne<Z&&(fe[et>>3]=ne,Z=ne),D>_e?fe[g>>3]=D:D=_e,ne>O&&(fe[yt>>3]=ne,O=ne),Ce=ne>0&ne<Ce?ne:Ce,Se=ne<0&ne>Se?ne:Se,T=T|+kr(+(ne-N))>3.141592653589793,x=at+1|0,(x|0)!=(Pe|0);)xn=at,_e=D,at=x,x=xn;T&&(fe[yt>>3]=Se,fe[et>>3]=Ce)}}else _[g>>2]=0,_[g+4>>2]=0,_[g+8>>2]=0,_[g+12>>2]=0,_[g+16>>2]=0,_[g+20>>2]=0,_[g+24>>2]=0,_[g+28>>2]=0;if(xn=A+8|0,x=_[xn>>2]|0,!((x|0)<=0)){qt=A+12|0,qe=0;do if(M=_[qt>>2]|0,T=qe,qe=qe+1|0,et=g+(qe<<5)|0,yt=_[M+(T<<3)>>2]|0,yt){if(at=g+(qe<<5)+8|0,fe[at>>3]=17976931348623157e292,A=g+(qe<<5)+24|0,fe[A>>3]=17976931348623157e292,fe[et>>3]=-17976931348623157e292,lt=g+(qe<<5)+16|0,fe[lt>>3]=-17976931348623157e292,(yt|0)>0){for(Pe=_[M+(T<<3)+4>>2]|0,Ce=17976931348623157e292,Se=-17976931348623157e292,M=0,T=-1,Ye=0,W=17976931348623157e292,Z=17976931348623157e292,ne=-17976931348623157e292,O=-17976931348623157e292;D=+fe[Pe+(Ye<<4)>>3],_e=+fe[Pe+(Ye<<4)+8>>3],T=T+2|0,N=+fe[Pe+(((T|0)==(yt|0)?0:T)<<4)+8>>3],D<W&&(fe[at>>3]=D,W=D),_e<Z&&(fe[A>>3]=_e,Z=_e),D>ne?fe[et>>3]=D:D=ne,_e>O&&(fe[lt>>3]=_e,O=_e),Ce=_e>0&_e<Ce?_e:Ce,Se=_e<0&_e>Se?_e:Se,M=M|+kr(+(_e-N))>3.141592653589793,T=Ye+1|0,(T|0)!=(yt|0);)dn=Ye,Ye=T,ne=D,T=dn;M&&(fe[lt>>3]=Se,fe[A>>3]=Ce)}}else _[et>>2]=0,_[et+4>>2]=0,_[et+8>>2]=0,_[et+12>>2]=0,_[et+16>>2]=0,_[et+20>>2]=0,_[et+24>>2]=0,_[et+28>>2]=0,x=_[xn>>2]|0;while((qe|0)<(x|0))}}function Lh(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0;if(!(Na(A,g,x)|0))return M=0,M|0;if(M=A+8|0,(_[M>>2]|0)<=0)return M=1,M|0;for(T=A+12|0,A=0;;){if(D=A,A=A+1|0,Na((_[T>>2]|0)+(D<<3)|0,g+(A<<5)|0,x)|0){A=0,T=6;break}if((A|0)>=(_[M>>2]|0)){A=1,T=6;break}}return(T|0)==6?A|0:0}function L0(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;if(Z=Ae,Ae=Ae+16|0,N=Z,O=x+8|0,!(Na(A,g,O)|0))return W=0,Ae=Z,W|0;W=A+8|0;e:do if((_[W>>2]|0)>0){for(D=A+12|0,M=0;;){if(ne=M,M=M+1|0,Na((_[D>>2]|0)+(ne<<3)|0,g+(M<<5)|0,O)|0){M=0;break}if((M|0)>=(_[W>>2]|0))break e}return Ae=Z,M|0}while(!1);if(zc(A,g,x,T)|0)return ne=0,Ae=Z,ne|0;_[N>>2]=_[x>>2],_[N+4>>2]=O,M=_[W>>2]|0;e:do if((M|0)>0)for(A=A+12|0,O=0,D=M;;){if(M=_[A>>2]|0,(_[M+(O<<3)>>2]|0)>0){if(Na(N,T,_[M+(O<<3)+4>>2]|0)|0){M=0;break e}if(M=O+1|0,zc((_[A>>2]|0)+(O<<3)|0,g+(M<<5)|0,x,T)|0){M=0;break e}D=_[W>>2]|0}else M=O+1|0;if((M|0)<(D|0))O=M;else{M=1;break}}else M=1;while(!1);return ne=M,Ae=Z,ne|0}function zc(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0,qt=0,xn=0,dn=0,Vn=0;if(xn=Ae,Ae=Ae+176|0,at=xn+172|0,M=xn+168|0,lt=xn,!(y0(g,T)|0))return A=0,Ae=xn,A|0;if(Cg(g,T,at,M),ri(lt|0,x|0,168)|0,(_[x>>2]|0)>0){g=0;do dn=lt+8+(g<<4)+8|0,yt=+ca(+fe[dn>>3],_[M>>2]|0),fe[dn>>3]=yt,g=g+1|0;while((g|0)<(_[x>>2]|0))}Ye=+fe[T>>3],et=+fe[T+8>>3],yt=+ca(+fe[T+16>>3],_[M>>2]|0),Se=+ca(+fe[T+24>>3],_[M>>2]|0);e:do if((_[A>>2]|0)>0){if(T=A+4|0,M=_[lt>>2]|0,(M|0)<=0){for(g=0;;)if(g=g+1|0,(g|0)>=(_[A>>2]|0)){g=0;break e}}for(x=0;;){if(g=_[T>>2]|0,Ce=+fe[g+(x<<4)>>3],Pe=+ca(+fe[g+(x<<4)+8>>3],_[at>>2]|0),g=_[T>>2]|0,x=x+1|0,dn=(x|0)%(_[A>>2]|0)|0,D=+fe[g+(dn<<4)>>3],O=+ca(+fe[g+(dn<<4)+8>>3],_[at>>2]|0),!(Ce>=Ye)|!(D>=Ye)&&!(Ce<=et)|!(D<=et)&&!(Pe<=Se)|!(O<=Se)&&!(Pe>=yt)|!(O>=yt)){_e=D-Ce,Z=O-Pe,g=0;do if(Vn=g,g=g+1|0,dn=(g|0)==(M|0)?0:g,D=+fe[lt+8+(Vn<<4)+8>>3],O=+fe[lt+8+(dn<<4)+8>>3]-D,N=+fe[lt+8+(Vn<<4)>>3],W=+fe[lt+8+(dn<<4)>>3]-N,ne=_e*O-Z*W,ne!=0&&(qe=Pe-D,qt=Ce-N,W=(qe*W-O*qt)/ne,!(W<0|W>1))&&(ne=(_e*qe-Z*qt)/ne,ne>=0&ne<=1)){g=1;break e}while((g|0)<(M|0))}if((x|0)>=(_[A>>2]|0)){g=0;break}}}else g=0;while(!1);return Vn=g,Ae=xn,Vn|0}function Pu(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0;if(zc(A,g,x,T)|0)return D=1,D|0;if(D=A+8|0,(_[D>>2]|0)<=0)return D=0,D|0;for(M=A+12|0,A=0;;){if(O=A,A=A+1|0,zc((_[M>>2]|0)+(O<<3)|0,g+(A<<5)|0,x,T)|0){A=1,M=6;break}if((A|0)>=(_[D>>2]|0)){A=0,M=6;break}}return(M|0)==6?A|0:0}function Vg(){return 8}function Kd(){return 16}function Oh(){return 168}function Gg(){return 8}function O0(){return 16}function F0(){return 12}function Hg(){return 8}function I(A){return A=A|0,+(+((_[A>>2]|0)>>>0)+4294967296*+(_[A+4>>2]|0))}function l(A){A=A|0;var g=0,x=0;return x=+fe[A>>3],g=+fe[A+8>>3],+ +li(+(x*x+g*g))}function f(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0;Z=+fe[A>>3],W=+fe[g>>3]-Z,N=+fe[A+8>>3],O=+fe[g+8>>3]-N,_e=+fe[x>>3],D=+fe[T>>3]-_e,Ce=+fe[x+8>>3],ne=+fe[T+8>>3]-Ce,D=(D*(N-Ce)-(Z-_e)*ne)/(W*ne-O*D),fe[M>>3]=Z+W*D,fe[M+8>>3]=N+O*D}function y(A,g){return A=A|0,g=g|0,+kr(+(+fe[A>>3]-+fe[g>>3]))<11920928955078125e-23?(g=+kr(+(+fe[A+8>>3]-+fe[g+8>>3]))<11920928955078125e-23,g|0):(g=0,g|0)}function w(A,g){A=A|0,g=g|0;var x=0,T=0,M=0;return M=+fe[A>>3]-+fe[g>>3],T=+fe[A+8>>3]-+fe[g+8>>3],x=+fe[A+16>>3]-+fe[g+16>>3],+(M*M+T*T+x*x)}function P(A,g){A=A|0,g=g|0;var x=0,T=0,M=0;x=+fe[A>>3],T=+Sr(+x),x=+Nr(+x),fe[g+16>>3]=x,x=+fe[A+8>>3],M=T*+Sr(+x),fe[g>>3]=M,x=T*+Nr(+x),fe[g+8>>3]=x}function L(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0;if(D=Ae,Ae=Ae+16|0,M=D,T=dr(A,g)|0,(x+-1|0)>>>0>5||(T=(T|0)!=0,(x|0)==1&T))return M=-1,Ae=D,M|0;do if(z(A,g,M)|0)T=-1;else if(T){T=((_[26352+(x<<2)>>2]|0)+5-(_[M>>2]|0)|0)%5|0;break}else{T=((_[26384+(x<<2)>>2]|0)+6-(_[M>>2]|0)|0)%6|0;break}while(!1);return M=T,Ae=D,M|0}function z(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0;if(ne=Ae,Ae=Ae+32|0,N=ne+16|0,W=ne,T=Cu(A,g,N)|0,T|0)return x=T,Ae=ne,x|0;D=Rg(A,g)|0,Z=ts(A,g)|0,N_(D,W),T=z_(D,_[N>>2]|0)|0;do if(Qr(D)|0){do switch(D|0){case 4:{M=0;break}case 14:{M=1;break}case 24:{M=2;break}case 38:{M=3;break}case 49:{M=4;break}case 58:{M=5;break}case 63:{M=6;break}case 72:{M=7;break}case 83:{M=8;break}case 97:{M=9;break}case 107:{M=10;break}case 117:{M=11;break}default:Wn(27795,27797,75,27806)}while(!1);if(O=_[26416+(M*24|0)+8>>2]|0,g=_[26416+(M*24|0)+16>>2]|0,A=_[N>>2]|0,(A|0)!=(_[W>>2]|0)&&(W=wh(D)|0,A=_[N>>2]|0,W|(A|0)==(g|0)&&(T=(T+1|0)%6|0)),(Z|0)==3&(A|0)==(g|0)){T=(T+5|0)%6|0;break}(Z|0)==5&(A|0)==(O|0)&&(T=(T+1|0)%6|0)}while(!1);return _[x>>2]=T,x=0,Ae=ne,x|0}function G(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0;if(lt=Ae,Ae=Ae+32|0,at=lt+24|0,et=lt+20|0,Pe=lt+8|0,Se=lt+16|0,Ce=lt,W=(dr(A,g)|0)==0,W=W?6:5,ne=Tt(A|0,g|0,52)|0,ve()|0,ne=ne&15,W>>>0<=x>>>0)return T=2,Ae=lt,T|0;_e=(ne|0)==0,!_e&&(Ye=Ot(7,0,(ne^15)*3|0)|0,(Ye&A|0)==0&((ve()|0)&g|0)==0)?M=x:D=4;e:do if((D|0)==4){if(M=(dr(A,g)|0)!=0,((M?4:5)|0)<(x|0)||z(A,g,at)|0||(D=(_[at>>2]|0)+x|0,M?M=26704+(((D|0)%5|0)<<2)|0:M=26736+(((D|0)%6|0)<<2)|0,Ye=_[M>>2]|0,(Ye|0)==7))return T=1,Ae=lt,T|0;_[et>>2]=0,M=Ho(A,g,Ye,et,Pe)|0;do if(!M){if(N=Pe,Z=_[N>>2]|0,N=_[N+4>>2]|0,O=N>>>0<g>>>0|(N|0)==(g|0)&Z>>>0<A>>>0,D=O?Z:A,O=O?N:g,!_e&&(_e=Ot(7,0,(ne^15)*3|0)|0,(Z&_e|0)==0&(N&(ve()|0)|0)==0))M=x;else{if(N=(x+-1+W|0)%(W|0)|0,M=dr(A,g)|0,(N|0)<0&&Wn(27795,27797,248,27822),W=(M|0)!=0,((W?4:5)|0)<(N|0)&&Wn(27795,27797,248,27822),z(A,g,at)|0&&Wn(27795,27797,248,27822),M=(_[at>>2]|0)+N|0,W?M=26704+(((M|0)%5|0)<<2)|0:M=26736+(((M|0)%6|0)<<2)|0,N=_[M>>2]|0,(N|0)==7&&Wn(27795,27797,248,27822),_[Se>>2]=0,M=Ho(A,g,N,Se,Ce)|0,M|0)break;Z=Ce,W=_[Z>>2]|0,Z=_[Z+4>>2]|0;do if(Z>>>0<O>>>0|(Z|0)==(O|0)&W>>>0<D>>>0){if(dr(W,Z)|0?D=Tg(W,Z,A,g)|0:D=_[26800+((((_[Se>>2]|0)+(_[26768+(N<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,M=dr(W,Z)|0,(D+-1|0)>>>0>5){M=-1,D=W,O=Z;break}if(M=(M|0)!=0,(D|0)==1&M){M=-1,D=W,O=Z;break}do if(z(W,Z,at)|0)M=-1;else if(M){M=((_[26352+(D<<2)>>2]|0)+5-(_[at>>2]|0)|0)%5|0;break}else{M=((_[26384+(D<<2)>>2]|0)+6-(_[at>>2]|0)|0)%6|0;break}while(!1);D=W,O=Z}else M=x;while(!1);N=Pe,Z=_[N>>2]|0,N=_[N+4>>2]|0}if((D|0)==(Z|0)&(O|0)==(N|0)){if(W=(dr(Z,N)|0)!=0,W?A=Tg(Z,N,A,g)|0:A=_[26800+((((_[et>>2]|0)+(_[26768+(Ye<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,M=dr(Z,N)|0,(A+-1|0)>>>0<=5&&(yt=(M|0)!=0,!((A|0)==1&yt)))do if(z(Z,N,at)|0)M=-1;else if(yt){M=((_[26352+(A<<2)>>2]|0)+5-(_[at>>2]|0)|0)%5|0;break}else{M=((_[26384+(A<<2)>>2]|0)+6-(_[at>>2]|0)|0)%6|0;break}while(!1);else M=-1;M=M+1|0,M=(M|0)==6|W&(M|0)==5?0:M}g=O,A=D;break e}while(!1);return T=M,Ae=lt,T|0}while(!1);return yt=Ot(M|0,0,56)|0,at=ve()|0|g&-2130706433|536870912,_[T>>2]=yt|A,_[T+4>>2]=at,T=0,Ae=lt,T|0}function j(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0;return D=(dr(A,g)|0)==0,T=G(A,g,0,x)|0,M=(T|0)==0,D?!M||(T=G(A,g,1,x+8|0)|0,T|0)||(T=G(A,g,2,x+16|0)|0,T|0)||(T=G(A,g,3,x+24|0)|0,T|0)||(T=G(A,g,4,x+32|0)|0,T)?(D=T,D|0):G(A,g,5,x+40|0)|0:!M||(T=G(A,g,1,x+8|0)|0,T|0)||(T=G(A,g,2,x+16|0)|0,T|0)||(T=G(A,g,3,x+24|0)|0,T|0)||(T=G(A,g,4,x+32|0)|0,T|0)?(D=T,D|0):(D=x+40|0,_[D>>2]=0,_[D+4>>2]=0,D=0,D|0)}function Q(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0,N=0,W=0;return W=Ae,Ae=Ae+192|0,M=W,D=W+168|0,O=Tt(A|0,g|0,56)|0,ve()|0,O=O&7,N=g&-2130706433|134217728,T=Cu(A,N,D)|0,T|0?(N=T,Ae=W,N|0):(g=Tt(A|0,g|0,52)|0,ve()|0,g=g&15,dr(A,N)|0?T0(D,g,O,1,M):Ld(D,g,O,1,M),N=M+8|0,_[x>>2]=_[N>>2],_[x+4>>2]=_[N+4>>2],_[x+8>>2]=_[N+8>>2],_[x+12>>2]=_[N+12>>2],N=0,Ae=W,N|0)}function ie(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0;return M=Ae,Ae=Ae+16|0,x=M,!(!0&(g&2013265920|0)==536870912)||(T=g&-2130706433|134217728,!(S0(A,T)|0))?(T=0,Ae=M,T|0):(D=Tt(A|0,g|0,56)|0,ve()|0,D=(G(A,T,D&7,x)|0)==0,T=x,T=D&((_[T>>2]|0)==(A|0)?(_[T+4>>2]|0)==(g|0):0)&1,Ae=M,T|0)}function re(A,g,x){A=A|0,g=g|0,x=x|0;var T=0;(g|0)>0?(T=Fe(g,4)|0,_[A>>2]=T,T||Wn(27835,27858,40,27872)):_[A>>2]=0,_[A+4>>2]=g,_[A+8>>2]=0,_[A+12>>2]=x}function ce(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0;M=A+4|0,D=A+12|0,O=A+8|0;e:for(;;){for(x=_[M>>2]|0,g=0;;){if((g|0)>=(x|0))break e;if(T=_[A>>2]|0,N=_[T+(g<<2)>>2]|0,!N)g=g+1|0;else break}g=T+(~~(+kr(+(+wo(10,+ +(15-(_[D>>2]|0)|0))*(+fe[N>>3]+ +fe[N+8>>3])))%+(x|0))>>>0<<2)|0,x=_[g>>2]|0;t:do if(x|0){if(T=N+32|0,(x|0)==(N|0))_[g>>2]=_[T>>2];else{if(x=x+32|0,g=_[x>>2]|0,!g)break;for(;(g|0)!=(N|0);)if(x=g+32|0,g=_[x>>2]|0,!g)break t;_[x>>2]=_[T>>2]}Be(N),_[O>>2]=(_[O>>2]|0)+-1}while(!1)}Be(_[A>>2]|0)}function de(A){A=A|0;var g=0,x=0,T=0;for(T=_[A+4>>2]|0,x=0;;){if((x|0)>=(T|0)){g=0,x=4;break}if(g=_[(_[A>>2]|0)+(x<<2)>>2]|0,!g)x=x+1|0;else{x=4;break}}return(x|0)==4?g|0:0}function Te(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0;if(x=~~(+kr(+(+wo(10,+ +(15-(_[A+12>>2]|0)|0))*(+fe[g>>3]+ +fe[g+8>>3])))%+(_[A+4>>2]|0))>>>0,x=(_[A>>2]|0)+(x<<2)|0,T=_[x>>2]|0,!T)return D=1,D|0;D=g+32|0;do if((T|0)!=(g|0)){if(x=_[T+32>>2]|0,!x)return D=1,D|0;for(M=x;;){if((M|0)==(g|0)){M=8;break}if(x=_[M+32>>2]|0,x)T=M,M=x;else{x=1,M=10;break}}if((M|0)==8){_[T+32>>2]=_[D>>2];break}else if((M|0)==10)return x|0}else _[x>>2]=_[D>>2];while(!1);return Be(g),D=A+8|0,_[D>>2]=(_[D>>2]|0)+-1,D=0,D|0}function Ie(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0;D=Ge(40)|0,D||Wn(27888,27858,98,27901),_[D>>2]=_[g>>2],_[D+4>>2]=_[g+4>>2],_[D+8>>2]=_[g+8>>2],_[D+12>>2]=_[g+12>>2],M=D+16|0,_[M>>2]=_[x>>2],_[M+4>>2]=_[x+4>>2],_[M+8>>2]=_[x+8>>2],_[M+12>>2]=_[x+12>>2],_[D+32>>2]=0,M=~~(+kr(+(+wo(10,+ +(15-(_[A+12>>2]|0)|0))*(+fe[g>>3]+ +fe[g+8>>3])))%+(_[A+4>>2]|0))>>>0,M=(_[A>>2]|0)+(M<<2)|0,T=_[M>>2]|0;do if(!T)_[M>>2]=D;else{for(;!(Mu(T,g)|0&&Mu(T+16|0,x)|0);)if(M=_[T+32>>2]|0,T=(M|0)==0?T:M,!(_[T+32>>2]|0)){O=10;break}if((O|0)==10){_[T+32>>2]=D;break}return Be(D),O=T,O|0}while(!1);return O=A+8|0,_[O>>2]=(_[O>>2]|0)+1,O=D,O|0}function Me(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0;if(M=~~(+kr(+(+wo(10,+ +(15-(_[A+12>>2]|0)|0))*(+fe[g>>3]+ +fe[g+8>>3])))%+(_[A+4>>2]|0))>>>0,M=_[(_[A>>2]|0)+(M<<2)>>2]|0,!M)return x=0,x|0;if(!x){for(A=M;;){if(Mu(A,g)|0){T=10;break}if(A=_[A+32>>2]|0,!A){A=0,T=10;break}}if((T|0)==10)return A|0}for(A=M;;){if(Mu(A,g)|0&&Mu(A+16|0,x)|0){T=10;break}if(A=_[A+32>>2]|0,!A){A=0,T=10;break}}return(T|0)==10?A|0:0}function Oe(A,g){A=A|0,g=g|0;var x=0;if(x=~~(+kr(+(+wo(10,+ +(15-(_[A+12>>2]|0)|0))*(+fe[g>>3]+ +fe[g+8>>3])))%+(_[A+4>>2]|0))>>>0,A=_[(_[A>>2]|0)+(x<<2)>>2]|0,!A)return x=0,x|0;for(;;){if(Mu(A,g)|0){g=5;break}if(A=_[A+32>>2]|0,!A){A=0,g=5;break}}return(g|0)==5?A|0:0}function We(){return 27920}function De(A){return A=+A,~~+po(+A)|0}function Ge(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0,Ye=0,et=0,yt=0,at=0,lt=0,qe=0,qt=0;qt=Ae,Ae=Ae+16|0,Ce=qt;do if(A>>>0<245){if(Z=A>>>0<11?16:A+11&-8,A=Z>>>3,_e=_[6981]|0,x=_e>>>A,x&3|0)return g=(x&1^1)+A|0,A=27964+(g<<1<<2)|0,x=A+8|0,T=_[x>>2]|0,M=T+8|0,D=_[M>>2]|0,(D|0)==(A|0)?_[6981]=_e&~(1<<g):(_[D+12>>2]=A,_[x>>2]=D),qe=g<<3,_[T+4>>2]=qe|3,qe=T+qe+4|0,_[qe>>2]=_[qe>>2]|1,qe=M,Ae=qt,qe|0;if(ne=_[6983]|0,Z>>>0>ne>>>0){if(x|0)return g=2<<A,g=x<<A&(g|0-g),g=(g&0-g)+-1|0,N=g>>>12&16,g=g>>>N,x=g>>>5&8,g=g>>>x,D=g>>>2&4,g=g>>>D,A=g>>>1&2,g=g>>>A,T=g>>>1&1,T=(x|N|D|A|T)+(g>>>T)|0,g=27964+(T<<1<<2)|0,A=g+8|0,D=_[A>>2]|0,N=D+8|0,x=_[N>>2]|0,(x|0)==(g|0)?(A=_e&~(1<<T),_[6981]=A):(_[x+12>>2]=g,_[A>>2]=x,A=_e),qe=T<<3,O=qe-Z|0,_[D+4>>2]=Z|3,M=D+Z|0,_[M+4>>2]=O|1,_[D+qe>>2]=O,ne|0&&(T=_[6986]|0,g=ne>>>3,x=27964+(g<<1<<2)|0,g=1<<g,A&g?(A=x+8|0,g=_[A>>2]|0):(_[6981]=A|g,g=x,A=x+8|0),_[A>>2]=T,_[g+12>>2]=T,_[T+8>>2]=g,_[T+12>>2]=x),_[6983]=O,_[6986]=M,qe=N,Ae=qt,qe|0;if(D=_[6982]|0,D){for(x=(D&0-D)+-1|0,M=x>>>12&16,x=x>>>M,T=x>>>5&8,x=x>>>T,O=x>>>2&4,x=x>>>O,N=x>>>1&2,x=x>>>N,W=x>>>1&1,W=_[28228+((T|M|O|N|W)+(x>>>W)<<2)>>2]|0,x=W,N=W,W=(_[W+4>>2]&-8)-Z|0;A=_[x+16>>2]|0,!(!A&&(A=_[x+20>>2]|0,!A));)O=(_[A+4>>2]&-8)-Z|0,M=O>>>0<W>>>0,x=A,N=M?A:N,W=M?O:W;if(O=N+Z|0,O>>>0>N>>>0){M=_[N+24>>2]|0,g=_[N+12>>2]|0;do if((g|0)==(N|0)){if(A=N+20|0,g=_[A>>2]|0,!g&&(A=N+16|0,g=_[A>>2]|0,!g)){x=0;break}for(;;)if(T=g+20|0,x=_[T>>2]|0,x)g=x,A=T;else if(T=g+16|0,x=_[T>>2]|0,x)g=x,A=T;else break;_[A>>2]=0,x=g}else x=_[N+8>>2]|0,_[x+12>>2]=g,_[g+8>>2]=x,x=g;while(!1);do if(M|0){if(g=_[N+28>>2]|0,A=28228+(g<<2)|0,(N|0)==(_[A>>2]|0)){if(_[A>>2]=x,!x){_[6982]=D&~(1<<g);break}}else if(qe=M+16|0,_[((_[qe>>2]|0)==(N|0)?qe:M+20|0)>>2]=x,!x)break;_[x+24>>2]=M,g=_[N+16>>2]|0,g|0&&(_[x+16>>2]=g,_[g+24>>2]=x),g=_[N+20>>2]|0,g|0&&(_[x+20>>2]=g,_[g+24>>2]=x)}while(!1);return W>>>0<16?(qe=W+Z|0,_[N+4>>2]=qe|3,qe=N+qe+4|0,_[qe>>2]=_[qe>>2]|1):(_[N+4>>2]=Z|3,_[O+4>>2]=W|1,_[O+W>>2]=W,ne|0&&(T=_[6986]|0,g=ne>>>3,x=27964+(g<<1<<2)|0,g=1<<g,g&_e?(A=x+8|0,g=_[A>>2]|0):(_[6981]=g|_e,g=x,A=x+8|0),_[A>>2]=T,_[g+12>>2]=T,_[T+8>>2]=g,_[T+12>>2]=x),_[6983]=W,_[6986]=O),qe=N+8|0,Ae=qt,qe|0}else _e=Z}else _e=Z}else _e=Z}else if(A>>>0<=4294967231)if(A=A+11|0,Z=A&-8,T=_[6982]|0,T){M=0-Z|0,A=A>>>8,A?Z>>>0>16777215?W=31:(_e=(A+1048320|0)>>>16&8,Ye=A<<_e,N=(Ye+520192|0)>>>16&4,Ye=Ye<<N,W=(Ye+245760|0)>>>16&2,W=14-(N|_e|W)+(Ye<<W>>>15)|0,W=Z>>>(W+7|0)&1|W<<1):W=0,x=_[28228+(W<<2)>>2]|0;e:do if(!x)x=0,A=0,Ye=61;else for(A=0,N=Z<<((W|0)==31?0:25-(W>>>1)|0),D=0;;){if(O=(_[x+4>>2]&-8)-Z|0,O>>>0<M>>>0)if(O)A=x,M=O;else{A=x,M=0,Ye=65;break e}if(Ye=_[x+20>>2]|0,x=_[x+16+(N>>>31<<2)>>2]|0,D=(Ye|0)==0|(Ye|0)==(x|0)?D:Ye,x)N=N<<1;else{x=D,Ye=61;break}}while(!1);if((Ye|0)==61){if((x|0)==0&(A|0)==0){if(A=2<<W,A=(A|0-A)&T,!A){_e=Z;break}_e=(A&0-A)+-1|0,O=_e>>>12&16,_e=_e>>>O,D=_e>>>5&8,_e=_e>>>D,N=_e>>>2&4,_e=_e>>>N,W=_e>>>1&2,_e=_e>>>W,x=_e>>>1&1,A=0,x=_[28228+((D|O|N|W|x)+(_e>>>x)<<2)>>2]|0}x?Ye=65:(N=A,O=M)}if((Ye|0)==65)for(D=x;;)if(_e=(_[D+4>>2]&-8)-Z|0,x=_e>>>0<M>>>0,M=x?_e:M,A=x?D:A,x=_[D+16>>2]|0,x||(x=_[D+20>>2]|0),x)D=x;else{N=A,O=M;break}if((N|0)!=0&&O>>>0<((_[6983]|0)-Z|0)>>>0&&(ne=N+Z|0,ne>>>0>N>>>0)){D=_[N+24>>2]|0,g=_[N+12>>2]|0;do if((g|0)==(N|0)){if(A=N+20|0,g=_[A>>2]|0,!g&&(A=N+16|0,g=_[A>>2]|0,!g)){g=0;break}for(;;)if(M=g+20|0,x=_[M>>2]|0,x)g=x,A=M;else if(M=g+16|0,x=_[M>>2]|0,x)g=x,A=M;else break;_[A>>2]=0}else qe=_[N+8>>2]|0,_[qe+12>>2]=g,_[g+8>>2]=qe;while(!1);do if(D){if(A=_[N+28>>2]|0,x=28228+(A<<2)|0,(N|0)==(_[x>>2]|0)){if(_[x>>2]=g,!g){T=T&~(1<<A),_[6982]=T;break}}else if(qe=D+16|0,_[((_[qe>>2]|0)==(N|0)?qe:D+20|0)>>2]=g,!g)break;_[g+24>>2]=D,A=_[N+16>>2]|0,A|0&&(_[g+16>>2]=A,_[A+24>>2]=g),A=_[N+20>>2]|0,A&&(_[g+20>>2]=A,_[A+24>>2]=g)}while(!1);e:do if(O>>>0<16)qe=O+Z|0,_[N+4>>2]=qe|3,qe=N+qe+4|0,_[qe>>2]=_[qe>>2]|1;else{if(_[N+4>>2]=Z|3,_[ne+4>>2]=O|1,_[ne+O>>2]=O,g=O>>>3,O>>>0<256){x=27964+(g<<1<<2)|0,A=_[6981]|0,g=1<<g,A&g?(A=x+8|0,g=_[A>>2]|0):(_[6981]=A|g,g=x,A=x+8|0),_[A>>2]=ne,_[g+12>>2]=ne,_[ne+8>>2]=g,_[ne+12>>2]=x;break}if(g=O>>>8,g?O>>>0>16777215?x=31:(lt=(g+1048320|0)>>>16&8,qe=g<<lt,at=(qe+520192|0)>>>16&4,qe=qe<<at,x=(qe+245760|0)>>>16&2,x=14-(at|lt|x)+(qe<<x>>>15)|0,x=O>>>(x+7|0)&1|x<<1):x=0,g=28228+(x<<2)|0,_[ne+28>>2]=x,A=ne+16|0,_[A+4>>2]=0,_[A>>2]=0,A=1<<x,!(T&A)){_[6982]=T|A,_[g>>2]=ne,_[ne+24>>2]=g,_[ne+12>>2]=ne,_[ne+8>>2]=ne;break}g=_[g>>2]|0;t:do if((_[g+4>>2]&-8|0)!=(O|0)){for(T=O<<((x|0)==31?0:25-(x>>>1)|0);x=g+16+(T>>>31<<2)|0,A=_[x>>2]|0,!!A;)if((_[A+4>>2]&-8|0)==(O|0)){g=A;break t}else T=T<<1,g=A;_[x>>2]=ne,_[ne+24>>2]=g,_[ne+12>>2]=ne,_[ne+8>>2]=ne;break e}while(!1);lt=g+8|0,qe=_[lt>>2]|0,_[qe+12>>2]=ne,_[lt>>2]=ne,_[ne+8>>2]=qe,_[ne+12>>2]=g,_[ne+24>>2]=0}while(!1);return qe=N+8|0,Ae=qt,qe|0}else _e=Z}else _e=Z;else _e=-1;while(!1);if(x=_[6983]|0,x>>>0>=_e>>>0)return g=x-_e|0,A=_[6986]|0,g>>>0>15?(qe=A+_e|0,_[6986]=qe,_[6983]=g,_[qe+4>>2]=g|1,_[A+x>>2]=g,_[A+4>>2]=_e|3):(_[6983]=0,_[6986]=0,_[A+4>>2]=x|3,qe=A+x+4|0,_[qe>>2]=_[qe>>2]|1),qe=A+8|0,Ae=qt,qe|0;if(O=_[6984]|0,O>>>0>_e>>>0)return at=O-_e|0,_[6984]=at,qe=_[6987]|0,lt=qe+_e|0,_[6987]=lt,_[lt+4>>2]=at|1,_[qe+4>>2]=_e|3,qe=qe+8|0,Ae=qt,qe|0;if(_[7099]|0?A=_[7101]|0:(_[7101]=4096,_[7100]=4096,_[7102]=-1,_[7103]=-1,_[7104]=0,_[7092]=0,_[7099]=Ce&-16^1431655768,A=4096),N=_e+48|0,W=_e+47|0,D=A+W|0,M=0-A|0,Z=D&M,Z>>>0<=_e>>>0||(A=_[7091]|0,A|0&&(ne=_[7089]|0,Ce=ne+Z|0,Ce>>>0<=ne>>>0|Ce>>>0>A>>>0)))return qe=0,Ae=qt,qe|0;e:do if(_[7092]&4)g=0,Ye=143;else{x=_[6987]|0;t:do if(x){for(T=28372;Ce=_[T>>2]|0,!(Ce>>>0<=x>>>0&&(Ce+(_[T+4>>2]|0)|0)>>>0>x>>>0);)if(A=_[T+8>>2]|0,A)T=A;else{Ye=128;break t}if(g=D-O&M,g>>>0<2147483647)if(A=ui(g|0)|0,(A|0)==((_[T>>2]|0)+(_[T+4>>2]|0)|0)){if((A|0)!=-1){O=g,D=A,Ye=145;break e}}else T=A,Ye=136;else g=0}else Ye=128;while(!1);do if((Ye|0)==128)if(x=ui(0)|0,(x|0)!=-1&&(g=x,Se=_[7100]|0,Pe=Se+-1|0,g=((Pe&g|0)==0?0:(Pe+g&0-Se)-g|0)+Z|0,Se=_[7089]|0,Pe=g+Se|0,g>>>0>_e>>>0&g>>>0<2147483647)){if(Ce=_[7091]|0,Ce|0&&Pe>>>0<=Se>>>0|Pe>>>0>Ce>>>0){g=0;break}if(A=ui(g|0)|0,(A|0)==(x|0)){O=g,D=x,Ye=145;break e}else T=A,Ye=136}else g=0;while(!1);do if((Ye|0)==136){if(x=0-g|0,!(N>>>0>g>>>0&(g>>>0<2147483647&(T|0)!=-1)))if((T|0)==-1){g=0;break}else{O=g,D=T,Ye=145;break e}if(A=_[7101]|0,A=W-g+A&0-A,A>>>0>=2147483647){O=g,D=T,Ye=145;break e}if((ui(A|0)|0)==-1){ui(x|0)|0,g=0;break}else{O=A+g|0,D=T,Ye=145;break e}}while(!1);_[7092]=_[7092]|4,Ye=143}while(!1);if((Ye|0)==143&&Z>>>0<2147483647&&(at=ui(Z|0)|0,Pe=ui(0)|0,et=Pe-at|0,yt=et>>>0>(_e+40|0)>>>0,!((at|0)==-1|yt^1|at>>>0<Pe>>>0&((at|0)!=-1&(Pe|0)!=-1)^1))&&(O=yt?et:g,D=at,Ye=145),(Ye|0)==145){g=(_[7089]|0)+O|0,_[7089]=g,g>>>0>(_[7090]|0)>>>0&&(_[7090]=g),W=_[6987]|0;e:do if(W){for(g=28372;;){if(A=_[g>>2]|0,x=_[g+4>>2]|0,(D|0)==(A+x|0)){Ye=154;break}if(T=_[g+8>>2]|0,T)g=T;else break}if((Ye|0)==154&&(lt=g+4|0,(_[g+12>>2]&8|0)==0)&&D>>>0>W>>>0&A>>>0<=W>>>0){_[lt>>2]=x+O,qe=(_[6984]|0)+O|0,at=W+8|0,at=(at&7|0)==0?0:0-at&7,lt=W+at|0,at=qe-at|0,_[6987]=lt,_[6984]=at,_[lt+4>>2]=at|1,_[W+qe+4>>2]=40,_[6988]=_[7103];break}for(D>>>0<(_[6985]|0)>>>0&&(_[6985]=D),x=D+O|0,g=28372;;){if((_[g>>2]|0)==(x|0)){Ye=162;break}if(A=_[g+8>>2]|0,A)g=A;else break}if((Ye|0)==162&&(_[g+12>>2]&8|0)==0){_[g>>2]=D,ne=g+4|0,_[ne>>2]=(_[ne>>2]|0)+O,ne=D+8|0,ne=D+((ne&7|0)==0?0:0-ne&7)|0,g=x+8|0,g=x+((g&7|0)==0?0:0-g&7)|0,Z=ne+_e|0,N=g-ne-_e|0,_[ne+4>>2]=_e|3;t:do if((W|0)==(g|0))qe=(_[6984]|0)+N|0,_[6984]=qe,_[6987]=Z,_[Z+4>>2]=qe|1;else{if((_[6986]|0)==(g|0)){qe=(_[6983]|0)+N|0,_[6983]=qe,_[6986]=Z,_[Z+4>>2]=qe|1,_[Z+qe>>2]=qe;break}if(A=_[g+4>>2]|0,(A&3|0)==1){O=A&-8,T=A>>>3;n:do if(A>>>0<256)if(A=_[g+8>>2]|0,x=_[g+12>>2]|0,(x|0)==(A|0)){_[6981]=_[6981]&~(1<<T);break}else{_[A+12>>2]=x,_[x+8>>2]=A;break}else{D=_[g+24>>2]|0,A=_[g+12>>2]|0;do if((A|0)==(g|0)){if(x=g+16|0,T=x+4|0,A=_[T>>2]|0,A)x=T;else if(A=_[x>>2]|0,!A){A=0;break}for(;;)if(M=A+20|0,T=_[M>>2]|0,T)A=T,x=M;else if(M=A+16|0,T=_[M>>2]|0,T)A=T,x=M;else break;_[x>>2]=0}else qe=_[g+8>>2]|0,_[qe+12>>2]=A,_[A+8>>2]=qe;while(!1);if(!D)break;x=_[g+28>>2]|0,T=28228+(x<<2)|0;do if((_[T>>2]|0)!=(g|0)){if(qe=D+16|0,_[((_[qe>>2]|0)==(g|0)?qe:D+20|0)>>2]=A,!A)break n}else{if(_[T>>2]=A,A|0)break;_[6982]=_[6982]&~(1<<x);break n}while(!1);if(_[A+24>>2]=D,x=g+16|0,T=_[x>>2]|0,T|0&&(_[A+16>>2]=T,_[T+24>>2]=A),x=_[x+4>>2]|0,!x)break;_[A+20>>2]=x,_[x+24>>2]=A}while(!1);g=g+O|0,M=O+N|0}else M=N;if(g=g+4|0,_[g>>2]=_[g>>2]&-2,_[Z+4>>2]=M|1,_[Z+M>>2]=M,g=M>>>3,M>>>0<256){x=27964+(g<<1<<2)|0,A=_[6981]|0,g=1<<g,A&g?(A=x+8|0,g=_[A>>2]|0):(_[6981]=A|g,g=x,A=x+8|0),_[A>>2]=Z,_[g+12>>2]=Z,_[Z+8>>2]=g,_[Z+12>>2]=x;break}g=M>>>8;do if(!g)T=0;else{if(M>>>0>16777215){T=31;break}lt=(g+1048320|0)>>>16&8,qe=g<<lt,at=(qe+520192|0)>>>16&4,qe=qe<<at,T=(qe+245760|0)>>>16&2,T=14-(at|lt|T)+(qe<<T>>>15)|0,T=M>>>(T+7|0)&1|T<<1}while(!1);if(g=28228+(T<<2)|0,_[Z+28>>2]=T,A=Z+16|0,_[A+4>>2]=0,_[A>>2]=0,A=_[6982]|0,x=1<<T,!(A&x)){_[6982]=A|x,_[g>>2]=Z,_[Z+24>>2]=g,_[Z+12>>2]=Z,_[Z+8>>2]=Z;break}g=_[g>>2]|0;n:do if((_[g+4>>2]&-8|0)!=(M|0)){for(T=M<<((T|0)==31?0:25-(T>>>1)|0);x=g+16+(T>>>31<<2)|0,A=_[x>>2]|0,!!A;)if((_[A+4>>2]&-8|0)==(M|0)){g=A;break n}else T=T<<1,g=A;_[x>>2]=Z,_[Z+24>>2]=g,_[Z+12>>2]=Z,_[Z+8>>2]=Z;break t}while(!1);lt=g+8|0,qe=_[lt>>2]|0,_[qe+12>>2]=Z,_[lt>>2]=Z,_[Z+8>>2]=qe,_[Z+12>>2]=g,_[Z+24>>2]=0}while(!1);return qe=ne+8|0,Ae=qt,qe|0}for(g=28372;A=_[g>>2]|0,!(A>>>0<=W>>>0&&(qe=A+(_[g+4>>2]|0)|0,qe>>>0>W>>>0));)g=_[g+8>>2]|0;M=qe+-47|0,A=M+8|0,A=M+((A&7|0)==0?0:0-A&7)|0,M=W+16|0,A=A>>>0<M>>>0?W:A,g=A+8|0,x=O+-40|0,at=D+8|0,at=(at&7|0)==0?0:0-at&7,lt=D+at|0,at=x-at|0,_[6987]=lt,_[6984]=at,_[lt+4>>2]=at|1,_[D+x+4>>2]=40,_[6988]=_[7103],x=A+4|0,_[x>>2]=27,_[g>>2]=_[7093],_[g+4>>2]=_[7094],_[g+8>>2]=_[7095],_[g+12>>2]=_[7096],_[7093]=D,_[7094]=O,_[7096]=0,_[7095]=g,g=A+24|0;do lt=g,g=g+4|0,_[g>>2]=7;while((lt+8|0)>>>0<qe>>>0);if((A|0)!=(W|0)){if(D=A-W|0,_[x>>2]=_[x>>2]&-2,_[W+4>>2]=D|1,_[A>>2]=D,g=D>>>3,D>>>0<256){x=27964+(g<<1<<2)|0,A=_[6981]|0,g=1<<g,A&g?(A=x+8|0,g=_[A>>2]|0):(_[6981]=A|g,g=x,A=x+8|0),_[A>>2]=W,_[g+12>>2]=W,_[W+8>>2]=g,_[W+12>>2]=x;break}if(g=D>>>8,g?D>>>0>16777215?T=31:(lt=(g+1048320|0)>>>16&8,qe=g<<lt,at=(qe+520192|0)>>>16&4,qe=qe<<at,T=(qe+245760|0)>>>16&2,T=14-(at|lt|T)+(qe<<T>>>15)|0,T=D>>>(T+7|0)&1|T<<1):T=0,x=28228+(T<<2)|0,_[W+28>>2]=T,_[W+20>>2]=0,_[M>>2]=0,g=_[6982]|0,A=1<<T,!(g&A)){_[6982]=g|A,_[x>>2]=W,_[W+24>>2]=x,_[W+12>>2]=W,_[W+8>>2]=W;break}g=_[x>>2]|0;t:do if((_[g+4>>2]&-8|0)!=(D|0)){for(T=D<<((T|0)==31?0:25-(T>>>1)|0);x=g+16+(T>>>31<<2)|0,A=_[x>>2]|0,!!A;)if((_[A+4>>2]&-8|0)==(D|0)){g=A;break t}else T=T<<1,g=A;_[x>>2]=W,_[W+24>>2]=g,_[W+12>>2]=W,_[W+8>>2]=W;break e}while(!1);lt=g+8|0,qe=_[lt>>2]|0,_[qe+12>>2]=W,_[lt>>2]=W,_[W+8>>2]=qe,_[W+12>>2]=g,_[W+24>>2]=0}}else qe=_[6985]|0,(qe|0)==0|D>>>0<qe>>>0&&(_[6985]=D),_[7093]=D,_[7094]=O,_[7096]=0,_[6990]=_[7099],_[6989]=-1,_[6994]=27964,_[6993]=27964,_[6996]=27972,_[6995]=27972,_[6998]=27980,_[6997]=27980,_[7e3]=27988,_[6999]=27988,_[7002]=27996,_[7001]=27996,_[7004]=28004,_[7003]=28004,_[7006]=28012,_[7005]=28012,_[7008]=28020,_[7007]=28020,_[7010]=28028,_[7009]=28028,_[7012]=28036,_[7011]=28036,_[7014]=28044,_[7013]=28044,_[7016]=28052,_[7015]=28052,_[7018]=28060,_[7017]=28060,_[7020]=28068,_[7019]=28068,_[7022]=28076,_[7021]=28076,_[7024]=28084,_[7023]=28084,_[7026]=28092,_[7025]=28092,_[7028]=28100,_[7027]=28100,_[7030]=28108,_[7029]=28108,_[7032]=28116,_[7031]=28116,_[7034]=28124,_[7033]=28124,_[7036]=28132,_[7035]=28132,_[7038]=28140,_[7037]=28140,_[7040]=28148,_[7039]=28148,_[7042]=28156,_[7041]=28156,_[7044]=28164,_[7043]=28164,_[7046]=28172,_[7045]=28172,_[7048]=28180,_[7047]=28180,_[7050]=28188,_[7049]=28188,_[7052]=28196,_[7051]=28196,_[7054]=28204,_[7053]=28204,_[7056]=28212,_[7055]=28212,qe=O+-40|0,at=D+8|0,at=(at&7|0)==0?0:0-at&7,lt=D+at|0,at=qe-at|0,_[6987]=lt,_[6984]=at,_[lt+4>>2]=at|1,_[D+qe+4>>2]=40,_[6988]=_[7103];while(!1);if(g=_[6984]|0,g>>>0>_e>>>0)return at=g-_e|0,_[6984]=at,qe=_[6987]|0,lt=qe+_e|0,_[6987]=lt,_[lt+4>>2]=at|1,_[qe+4>>2]=_e|3,qe=qe+8|0,Ae=qt,qe|0}return qe=We()|0,_[qe>>2]=12,qe=0,Ae=qt,qe|0}function Be(A){A=A|0;var g=0,x=0,T=0,M=0,D=0,O=0,N=0,W=0;if(A){x=A+-8|0,M=_[6985]|0,A=_[A+-4>>2]|0,g=A&-8,W=x+g|0;do if(A&1)N=x,O=x;else{if(T=_[x>>2]|0,!(A&3)||(O=x+(0-T)|0,D=T+g|0,O>>>0<M>>>0))return;if((_[6986]|0)==(O|0)){if(A=W+4|0,g=_[A>>2]|0,(g&3|0)!=3){N=O,g=D;break}_[6983]=D,_[A>>2]=g&-2,_[O+4>>2]=D|1,_[O+D>>2]=D;return}if(x=T>>>3,T>>>0<256)if(A=_[O+8>>2]|0,g=_[O+12>>2]|0,(g|0)==(A|0)){_[6981]=_[6981]&~(1<<x),N=O,g=D;break}else{_[A+12>>2]=g,_[g+8>>2]=A,N=O,g=D;break}M=_[O+24>>2]|0,A=_[O+12>>2]|0;do if((A|0)==(O|0)){if(g=O+16|0,x=g+4|0,A=_[x>>2]|0,A)g=x;else if(A=_[g>>2]|0,!A){A=0;break}for(;;)if(T=A+20|0,x=_[T>>2]|0,x)A=x,g=T;else if(T=A+16|0,x=_[T>>2]|0,x)A=x,g=T;else break;_[g>>2]=0}else N=_[O+8>>2]|0,_[N+12>>2]=A,_[A+8>>2]=N;while(!1);if(M){if(g=_[O+28>>2]|0,x=28228+(g<<2)|0,(_[x>>2]|0)==(O|0)){if(_[x>>2]=A,!A){_[6982]=_[6982]&~(1<<g),N=O,g=D;break}}else if(N=M+16|0,_[((_[N>>2]|0)==(O|0)?N:M+20|0)>>2]=A,!A){N=O,g=D;break}_[A+24>>2]=M,g=O+16|0,x=_[g>>2]|0,x|0&&(_[A+16>>2]=x,_[x+24>>2]=A),g=_[g+4>>2]|0,g?(_[A+20>>2]=g,_[g+24>>2]=A,N=O,g=D):(N=O,g=D)}else N=O,g=D}while(!1);if(!(O>>>0>=W>>>0)&&(A=W+4|0,T=_[A>>2]|0,!!(T&1))){if(T&2)_[A>>2]=T&-2,_[N+4>>2]=g|1,_[O+g>>2]=g,M=g;else{if((_[6987]|0)==(W|0)){if(W=(_[6984]|0)+g|0,_[6984]=W,_[6987]=N,_[N+4>>2]=W|1,(N|0)!=(_[6986]|0))return;_[6986]=0,_[6983]=0;return}if((_[6986]|0)==(W|0)){W=(_[6983]|0)+g|0,_[6983]=W,_[6986]=O,_[N+4>>2]=W|1,_[O+W>>2]=W;return}M=(T&-8)+g|0,x=T>>>3;do if(T>>>0<256)if(g=_[W+8>>2]|0,A=_[W+12>>2]|0,(A|0)==(g|0)){_[6981]=_[6981]&~(1<<x);break}else{_[g+12>>2]=A,_[A+8>>2]=g;break}else{D=_[W+24>>2]|0,A=_[W+12>>2]|0;do if((A|0)==(W|0)){if(g=W+16|0,x=g+4|0,A=_[x>>2]|0,A)g=x;else if(A=_[g>>2]|0,!A){x=0;break}for(;;)if(T=A+20|0,x=_[T>>2]|0,x)A=x,g=T;else if(T=A+16|0,x=_[T>>2]|0,x)A=x,g=T;else break;_[g>>2]=0,x=A}else x=_[W+8>>2]|0,_[x+12>>2]=A,_[A+8>>2]=x,x=A;while(!1);if(D|0){if(A=_[W+28>>2]|0,g=28228+(A<<2)|0,(_[g>>2]|0)==(W|0)){if(_[g>>2]=x,!x){_[6982]=_[6982]&~(1<<A);break}}else if(T=D+16|0,_[((_[T>>2]|0)==(W|0)?T:D+20|0)>>2]=x,!x)break;_[x+24>>2]=D,A=W+16|0,g=_[A>>2]|0,g|0&&(_[x+16>>2]=g,_[g+24>>2]=x),A=_[A+4>>2]|0,A|0&&(_[x+20>>2]=A,_[A+24>>2]=x)}}while(!1);if(_[N+4>>2]=M|1,_[O+M>>2]=M,(N|0)==(_[6986]|0)){_[6983]=M;return}}if(A=M>>>3,M>>>0<256){x=27964+(A<<1<<2)|0,g=_[6981]|0,A=1<<A,g&A?(g=x+8|0,A=_[g>>2]|0):(_[6981]=g|A,A=x,g=x+8|0),_[g>>2]=N,_[A+12>>2]=N,_[N+8>>2]=A,_[N+12>>2]=x;return}A=M>>>8,A?M>>>0>16777215?T=31:(O=(A+1048320|0)>>>16&8,W=A<<O,D=(W+520192|0)>>>16&4,W=W<<D,T=(W+245760|0)>>>16&2,T=14-(D|O|T)+(W<<T>>>15)|0,T=M>>>(T+7|0)&1|T<<1):T=0,A=28228+(T<<2)|0,_[N+28>>2]=T,_[N+20>>2]=0,_[N+16>>2]=0,g=_[6982]|0,x=1<<T;e:do if(!(g&x))_[6982]=g|x,_[A>>2]=N,_[N+24>>2]=A,_[N+12>>2]=N,_[N+8>>2]=N;else{A=_[A>>2]|0;t:do if((_[A+4>>2]&-8|0)!=(M|0)){for(T=M<<((T|0)==31?0:25-(T>>>1)|0);x=A+16+(T>>>31<<2)|0,g=_[x>>2]|0,!!g;)if((_[g+4>>2]&-8|0)==(M|0)){A=g;break t}else T=T<<1,A=g;_[x>>2]=N,_[N+24>>2]=A,_[N+12>>2]=N,_[N+8>>2]=N;break e}while(!1);O=A+8|0,W=_[O>>2]|0,_[W+12>>2]=N,_[O>>2]=N,_[N+8>>2]=W,_[N+12>>2]=A,_[N+24>>2]=0}while(!1);if(W=(_[6989]|0)+-1|0,_[6989]=W,!(W|0)){for(A=28380;A=_[A>>2]|0,A;)A=A+8|0;_[6989]=-1}}}}function Fe(A,g){A=A|0,g=g|0;var x=0;return A?(x=Ps(g,A)|0,(g|A)>>>0>65535&&(x=((x>>>0)/(A>>>0)|0|0)==(g|0)?x:-1)):x=0,A=Ge(x)|0,!A||!(_[A+-4>>2]&3)||Fi(A|0,0,x|0)|0,A|0}function Ve(A,g,x,T){return A=A|0,g=g|0,x=x|0,T=T|0,x=A+x>>>0,Jn(g+T+(x>>>0<A>>>0|0)>>>0|0),x|0|0}function ct(A,g,x,T){return A=A|0,g=g|0,x=x|0,T=T|0,T=g-T-(x>>>0>A>>>0|0)>>>0,Jn(T|0),A-x>>>0|0|0}function dt(A){return A=A|0,(A?31-(la(A^A-1)|0)|0:32)|0}function pt(A,g,x,T,M){A=A|0,g=g|0,x=x|0,T=T|0,M=M|0;var D=0,O=0,N=0,W=0,Z=0,ne=0,_e=0,Ce=0,Se=0,Pe=0;if(ne=A,W=g,Z=W,O=x,Ce=T,N=Ce,!Z)return D=(M|0)!=0,N?D?(_[M>>2]=A|0,_[M+4>>2]=g&0,Ce=0,M=0,Jn(Ce|0),M|0):(Ce=0,M=0,Jn(Ce|0),M|0):(D&&(_[M>>2]=(ne>>>0)%(O>>>0),_[M+4>>2]=0),Ce=0,M=(ne>>>0)/(O>>>0)>>>0,Jn(Ce|0),M|0);D=(N|0)==0;do if(O){if(!D){if(D=(la(N|0)|0)-(la(Z|0)|0)|0,D>>>0<=31){_e=D+1|0,N=31-D|0,g=D-31>>31,O=_e,A=ne>>>(_e>>>0)&g|Z<<N,g=Z>>>(_e>>>0)&g,D=0,N=ne<<N;break}return M?(_[M>>2]=A|0,_[M+4>>2]=W|g&0,Ce=0,M=0,Jn(Ce|0),M|0):(Ce=0,M=0,Jn(Ce|0),M|0)}if(D=O-1|0,D&O|0){N=(la(O|0)|0)+33-(la(Z|0)|0)|0,Pe=64-N|0,_e=32-N|0,W=_e>>31,Se=N-32|0,g=Se>>31,O=N,A=_e-1>>31&Z>>>(Se>>>0)|(Z<<_e|ne>>>(N>>>0))&g,g=g&Z>>>(N>>>0),D=ne<<Pe&W,N=(Z<<Pe|ne>>>(Se>>>0))&W|ne<<_e&N-33>>31;break}return M|0&&(_[M>>2]=D&ne,_[M+4>>2]=0),(O|0)==1?(Se=W|g&0,Pe=A|0|0,Jn(Se|0),Pe|0):(Pe=dt(O|0)|0,Se=Z>>>(Pe>>>0)|0,Pe=Z<<32-Pe|ne>>>(Pe>>>0)|0,Jn(Se|0),Pe|0)}else{if(D)return M|0&&(_[M>>2]=(Z>>>0)%(O>>>0),_[M+4>>2]=0),Se=0,Pe=(Z>>>0)/(O>>>0)>>>0,Jn(Se|0),Pe|0;if(!ne)return M|0&&(_[M>>2]=0,_[M+4>>2]=(Z>>>0)%(N>>>0)),Se=0,Pe=(Z>>>0)/(N>>>0)>>>0,Jn(Se|0),Pe|0;if(D=N-1|0,!(D&N))return M|0&&(_[M>>2]=A|0,_[M+4>>2]=D&Z|g&0),Se=0,Pe=Z>>>((dt(N|0)|0)>>>0),Jn(Se|0),Pe|0;if(D=(la(N|0)|0)-(la(Z|0)|0)|0,D>>>0<=30){g=D+1|0,N=31-D|0,O=g,A=Z<<N|ne>>>(g>>>0),g=Z>>>(g>>>0),D=0,N=ne<<N;break}return M?(_[M>>2]=A|0,_[M+4>>2]=W|g&0,Se=0,Pe=0,Jn(Se|0),Pe|0):(Se=0,Pe=0,Jn(Se|0),Pe|0)}while(!1);if(!O)Z=N,W=0,N=0;else{_e=x|0|0,ne=Ce|T&0,Z=Ve(_e|0,ne|0,-1,-1)|0,x=ve()|0,W=N,N=0;do T=W,W=D>>>31|W<<1,D=N|D<<1,T=A<<1|T>>>31|0,Ce=A>>>31|g<<1|0,ct(Z|0,x|0,T|0,Ce|0)|0,Pe=ve()|0,Se=Pe>>31|((Pe|0)<0?-1:0)<<1,N=Se&1,A=ct(T|0,Ce|0,Se&_e|0,(((Pe|0)<0?-1:0)>>31|((Pe|0)<0?-1:0)<<1)&ne|0)|0,g=ve()|0,O=O-1|0;while((O|0)!=0);Z=W,W=0}return O=0,M|0&&(_[M>>2]=A,_[M+4>>2]=g),Se=(D|0)>>>31|(Z|O)<<1|(O<<1|D>>>31)&0|W,Pe=(D<<1|0)&-2|N,Jn(Se|0),Pe|0}function ft(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0;return Z=g>>31|((g|0)<0?-1:0)<<1,W=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,D=T>>31|((T|0)<0?-1:0)<<1,M=((T|0)<0?-1:0)>>31|((T|0)<0?-1:0)<<1,N=ct(Z^A|0,W^g|0,Z|0,W|0)|0,O=ve()|0,A=D^Z,g=M^W,ct((pt(N,O,ct(D^x|0,M^T|0,D|0,M|0)|0,ve()|0,0)|0)^A|0,(ve()|0)^g|0,A|0,g|0)|0}function Xt(A,g){A=A|0,g=g|0;var x=0,T=0,M=0,D=0;return D=A&65535,M=g&65535,x=Ps(M,D)|0,T=A>>>16,A=(x>>>16)+(Ps(M,T)|0)|0,M=g>>>16,g=Ps(M,D)|0,Jn((A>>>16)+(Ps(M,T)|0)+(((A&65535)+g|0)>>>16)|0),A+g<<16|x&65535|0|0}function Ut(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0;return M=A,D=x,x=Xt(M,D)|0,A=ve()|0,Jn((Ps(g,D)|0)+(Ps(T,M)|0)+A|A&0|0),x|0|0|0}function Bt(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0,O=0,N=0,W=0,Z=0;return M=Ae,Ae=Ae+16|0,N=M|0,O=g>>31|((g|0)<0?-1:0)<<1,D=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,Z=T>>31|((T|0)<0?-1:0)<<1,W=((T|0)<0?-1:0)>>31|((T|0)<0?-1:0)<<1,A=ct(O^A|0,D^g|0,O|0,D|0)|0,g=ve()|0,pt(A,g,ct(Z^x|0,W^T|0,Z|0,W|0)|0,ve()|0,N)|0,T=ct(_[N>>2]^O|0,_[N+4>>2]^D|0,O|0,D|0)|0,x=ve()|0,Ae=M,Jn(x|0),T|0}function Jt(A,g,x,T){A=A|0,g=g|0,x=x|0,T=T|0;var M=0,D=0;return D=Ae,Ae=Ae+16|0,M=D|0,pt(A,g,x,T,M)|0,Ae=D,Jn(_[M+4>>2]|0),_[M>>2]|0|0}function jn(A,g,x){return A=A|0,g=g|0,x=x|0,(x|0)<32?(Jn(g>>x|0),A>>>x|(g&(1<<x)-1)<<32-x):(Jn(((g|0)<0?-1:0)|0),g>>x-32|0)}function Tt(A,g,x){return A=A|0,g=g|0,x=x|0,(x|0)<32?(Jn(g>>>x|0),A>>>x|(g&(1<<x)-1)<<32-x):(Jn(0),g>>>x-32|0)}function Ot(A,g,x){return A=A|0,g=g|0,x=x|0,(x|0)<32?(Jn(g<<x|(A&(1<<x)-1<<32-x)>>>32-x|0),A<<x):(Jn(A<<x-32|0),0)}function ni(A,g,x){return A=A|0,g=g|0,x=x|0,g=la(g)|0,(g|0)==32&&(g=g+(la(A)|0)|0),Jn(0),g|0}function Pi(A,g){return A=+A,g=+g,A!=A?+g:g!=g?+A:+yg(+A,+g)}function Kr(A,g){return A=+A,g=+g,A!=A?+g:g!=g?+A:+u0(+A,+g)}function Ri(A){return A=+A,A>=0?+bo(A+.5):+bh(A-.5)}function ri(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0;if((x|0)>=8192)return vd(A|0,g|0,x|0)|0,A|0;if(D=A|0,M=A+x|0,(A&3)==(g&3)){for(;A&3;){if(!x)return D|0;zt[A>>0]=zt[g>>0]|0,A=A+1|0,g=g+1|0,x=x-1|0}for(x=M&-4|0,T=x-64|0;(A|0)<=(T|0);)_[A>>2]=_[g>>2],_[A+4>>2]=_[g+4>>2],_[A+8>>2]=_[g+8>>2],_[A+12>>2]=_[g+12>>2],_[A+16>>2]=_[g+16>>2],_[A+20>>2]=_[g+20>>2],_[A+24>>2]=_[g+24>>2],_[A+28>>2]=_[g+28>>2],_[A+32>>2]=_[g+32>>2],_[A+36>>2]=_[g+36>>2],_[A+40>>2]=_[g+40>>2],_[A+44>>2]=_[g+44>>2],_[A+48>>2]=_[g+48>>2],_[A+52>>2]=_[g+52>>2],_[A+56>>2]=_[g+56>>2],_[A+60>>2]=_[g+60>>2],A=A+64|0,g=g+64|0;for(;(A|0)<(x|0);)_[A>>2]=_[g>>2],A=A+4|0,g=g+4|0}else for(x=M-4|0;(A|0)<(x|0);)zt[A>>0]=zt[g>>0]|0,zt[A+1>>0]=zt[g+1>>0]|0,zt[A+2>>0]=zt[g+2>>0]|0,zt[A+3>>0]=zt[g+3>>0]|0,A=A+4|0,g=g+4|0;for(;(A|0)<(M|0);)zt[A>>0]=zt[g>>0]|0,A=A+1|0,g=g+1|0;return D|0}function Fi(A,g,x){A=A|0,g=g|0,x=x|0;var T=0,M=0,D=0,O=0;if(D=A+x|0,g=g&255,(x|0)>=67){for(;A&3;)zt[A>>0]=g,A=A+1|0;for(T=D&-4|0,O=g|g<<8|g<<16|g<<24,M=T-64|0;(A|0)<=(M|0);)_[A>>2]=O,_[A+4>>2]=O,_[A+8>>2]=O,_[A+12>>2]=O,_[A+16>>2]=O,_[A+20>>2]=O,_[A+24>>2]=O,_[A+28>>2]=O,_[A+32>>2]=O,_[A+36>>2]=O,_[A+40>>2]=O,_[A+44>>2]=O,_[A+48>>2]=O,_[A+52>>2]=O,_[A+56>>2]=O,_[A+60>>2]=O,A=A+64|0;for(;(A|0)<(T|0);)_[A>>2]=O,A=A+4|0}for(;(A|0)<(D|0);)zt[A>>0]=g,A=A+1|0;return D-x|0}function po(A){return A=+A,A>=0?+bo(A+.5):+bh(A-.5)}function ui(A){A=A|0;var g=0,x=0,T=0;return T=L_()|0,x=_[aa>>2]|0,g=x+A|0,(A|0)>0&(g|0)<(x|0)|(g|0)<0?(xg(g|0)|0,D_(12),-1):(g|0)>(T|0)&&!(O_(g|0)|0)?(D_(12),-1):(_[aa>>2]=g,x|0)}return{___divdi3:ft,___muldi3:Ut,___remdi3:Bt,___uremdi3:Jt,_areNeighborCells:j_,_bitshift64Ashr:jn,_bitshift64Lshr:Tt,_bitshift64Shl:Ot,_calloc:Fe,_cellAreaKm2:Q_,_cellAreaM2:kl,_cellAreaRads2:R0,_cellToBoundary:uc,_cellToCenterChild:ol,_cellToChildPos:Y_,_cellToChildren:Fl,_cellToChildrenSize:Ef,_cellToLatLng:sl,_cellToLocalIj:Sx,_cellToParent:cc,_cellToVertex:G,_cellToVertexes:j,_cellsToDirectedEdge:uo,_cellsToLinkedMultiPolygon:Eg,_childPosToCell:Mf,_compactCells:Tx,_constructCell:Dg,_destroyLinkedMultiPolygon:Xd,_directedEdgeToBoundary:Ol,_directedEdgeToCells:Bd,_edgeLengthKm:yn,_edgeLengthM:Rn,_edgeLengthRads:Wd,_emscripten_replace_memory:h0,_free:Be,_getBaseCellNumber:Rg,_getDirectedEdgeDestination:Fa,_getDirectedEdgeOrigin:Mh,_getHexagonAreaAvgKm2:q_,_getHexagonAreaAvgM2:Hd,_getHexagonEdgeLengthAvgKm:I0,_getHexagonEdgeLengthAvgM:P0,_getIcosahedronFaces:M0,_getIndexDigit:Bg,_getNumCells:Rf,_getPentagons:Vd,_getRes0Cells:Td,_getResolution:Od,_greatCircleDistanceKm:Bh,_greatCircleDistanceM:Z_,_greatCircleDistanceRads:kg,_gridDisk:bd,_gridDiskDistances:vu,_gridDistance:Yd,_gridPathCells:fo,_gridPathCellsSize:Yi,_gridRing:vx,_gridRingUnsafe:F_,_i64Add:Ve,_i64Subtract:ct,_isPentagon:dr,_isResClassIII:es,_isValidCell:S0,_isValidDirectedEdge:Rd,_isValidIndex:Lg,_isValidVertex:ie,_latLngToCell:un,_llvm_ctlz_i64:ni,_llvm_maxnum_f64:Pi,_llvm_minnum_f64:Kr,_llvm_round_f64:Ri,_localIjToCell:Cx,_malloc:Ge,_maxFaceCount:zd,_maxGridDiskSize:wg,_maxPolygonToCellsSize:zr,_maxPolygonToCellsSizeExperimental:qd,_memcpy:ri,_memset:Fi,_originToDirectedEdges:w0,_pentagonCount:Ud,_polygonToCells:p0,_polygonToCellsExperimental:Ug,_readInt64AsDoubleFromPointer:I,_res0CellCount:m0,_round:po,_sbrk:ui,_sizeOfCellBoundary:Oh,_sizeOfCoordIJ:Hg,_sizeOfGeoLoop:Gg,_sizeOfGeoPolygon:O0,_sizeOfH3Index:Vg,_sizeOfLatLng:Kd,_sizeOfLinkedGeoPolygon:F0,_uncompactCells:kd,_uncompactCellsSize:Nd,_vertexToLatLng:Q,establishStackSpace:bg,stackAlloc:Dl,stackRestore:vg,stackSave:f0}})(Nn,Ir,Mt),di=e.___divdi3=Et.___divdi3,pi=e.___muldi3=Et.___muldi3,ti=e.___remdi3=Et.___remdi3,Wi=e.___uremdi3=Et.___uremdi3,Lt=e._areNeighborCells=Et._areNeighborCells,Ai=e._bitshift64Ashr=Et._bitshift64Ashr,Vo=e._bitshift64Lshr=Et._bitshift64Lshr,Es=e._bitshift64Shl=Et._bitshift64Shl,qr=e._calloc=Et._calloc,Yt=e._cellAreaKm2=Et._cellAreaKm2,kn=e._cellAreaM2=Et._cellAreaM2,Hn=e._cellAreaRads2=Et._cellAreaRads2,Qo=e._cellToBoundary=Et._cellToBoundary,Pc=e._cellToCenterChild=Et._cellToCenterChild,$a=e._cellToChildPos=Et._cellToChildPos,Un=e._cellToChildren=Et._cellToChildren,Ko=e._cellToChildrenSize=Et._cellToChildrenSize,mu=e._cellToLatLng=Et._cellToLatLng,hs=e._cellToLocalIj=Et._cellToLocalIj,Ml=e._cellToParent=Et._cellToParent,Ss=e._cellToVertex=Et._cellToVertex,Zs=e._cellToVertexes=Et._cellToVertexes,Cs=e._cellsToDirectedEdge=Et._cellsToDirectedEdge,Bo=e._cellsToLinkedMultiPolygon=Et._cellsToLinkedMultiPolygon,rr=e._childPosToCell=Et._childPosToCell,Rc=e._compactCells=Et._compactCells,Il=e._constructCell=Et._constructCell,Jo=e._destroyLinkedMultiPolygon=Et._destroyLinkedMultiPolygon,el=e._directedEdgeToBoundary=Et._directedEdgeToBoundary,Do=e._directedEdgeToCells=Et._directedEdgeToCells,Bc=e._edgeLengthKm=Et._edgeLengthKm,$o=e._edgeLengthM=Et._edgeLengthM,ph=e._edgeLengthRads=Et._edgeLengthRads,xi=e._emscripten_replace_memory=Et._emscripten_replace_memory,Ah=e._free=Et._free,Ia=e._getBaseCellNumber=Et._getBaseCellNumber,Ms=e._getDirectedEdgeDestination=Et._getDirectedEdgeDestination,Pa=e._getDirectedEdgeOrigin=Et._getDirectedEdgeOrigin,Pl=e._getHexagonAreaAvgKm2=Et._getHexagonAreaAvgKm2,fs=e._getHexagonAreaAvgM2=Et._getHexagonAreaAvgM2,gh=e._getHexagonEdgeLengthAvgKm=Et._getHexagonEdgeLengthAvgKm,wr=e._getHexagonEdgeLengthAvgM=Et._getHexagonEdgeLengthAvgM,_r=e._getIcosahedronFaces=Et._getIcosahedronFaces,_u=e._getIndexDigit=Et._getIndexDigit,Is=e._getNumCells=Et._getNumCells,yu=e._getPentagons=Et._getPentagons,Lo=e._getRes0Cells=Et._getRes0Cells,Rl=e._getResolution=Et._getResolution,mh=e._greatCircleDistanceKm=Et._greatCircleDistanceKm,xo=e._greatCircleDistanceM=Et._greatCircleDistanceM,oc=e._greatCircleDistanceRads=Et._greatCircleDistanceRads,tl=e._gridDisk=Et._gridDisk,Ra=e._gridDiskDistances=Et._gridDiskDistances,Ba=e._gridDistance=Et._gridDistance,Zn=e._gridPathCells=Et._gridPathCells,sc=e._gridPathCellsSize=Et._gridPathCellsSize,df=e._gridRing=Et._gridRing,ac=e._gridRingUnsafe=Et._gridRingUnsafe,Go=e._i64Add=Et._i64Add,si=e._i64Subtract=Et._i64Subtract,Kn=e._isPentagon=Et._isPentagon,Bn=e._isResClassIII=Et._isResClassIII,vi=e._isValidCell=Et._isValidCell,_h=e._isValidDirectedEdge=Et._isValidDirectedEdge,ia=e._isValidIndex=Et._isValidIndex,nl=e._isValidVertex=Et._isValidVertex,oa=e._latLngToCell=Et._latLngToCell,gd=e._llvm_ctlz_i64=Et._llvm_ctlz_i64,yh=e._llvm_maxnum_f64=Et._llvm_maxnum_f64,vo=e._llvm_minnum_f64=Et._llvm_minnum_f64,pf=e._llvm_round_f64=Et._llvm_round_f64,Dc=e._localIjToCell=Et._localIjToCell,Ag=e._malloc=Et._malloc,Da=e._maxFaceCount=Et._maxFaceCount,Af=e._maxGridDiskSize=Et._maxGridDiskSize,xu=e._maxPolygonToCellsSize=Et._maxPolygonToCellsSize,_x=e._maxPolygonToCellsSizeExperimental=Et._maxPolygonToCellsSizeExperimental,P_=e._memcpy=Et._memcpy,gf=e._memset=Et._memset,bi=e._originToDirectedEdges=Et._originToDirectedEdges,md=e._pentagonCount=Et._pentagonCount,Tr=e._polygonToCells=Et._polygonToCells,sr=e._polygonToCellsExperimental=Et._polygonToCellsExperimental,_d=e._readInt64AsDoubleFromPointer=Et._readInt64AsDoubleFromPointer,Pr=e._res0CellCount=Et._res0CellCount,i0=e._round=Et._round,Bl=e._sbrk=Et._sbrk,yd=e._sizeOfCellBoundary=Et._sizeOfCellBoundary,xh=e._sizeOfCoordIJ=Et._sizeOfCoordIJ,yx=e._sizeOfGeoLoop=Et._sizeOfGeoLoop,o0=e._sizeOfGeoPolygon=Et._sizeOfGeoPolygon,R_=e._sizeOfH3Index=Et._sizeOfH3Index,iE=e._sizeOfLatLng=Et._sizeOfLatLng,xx=e._sizeOfLinkedGeoPolygon=Et._sizeOfLinkedGeoPolygon,sa=e._uncompactCells=Et._uncompactCells,Lc=e._uncompactCellsSize=Et._uncompactCellsSize,ji=e._vertexToLatLng=Et._vertexToLatLng,mf=e.establishStackSpace=Et.establishStackSpace,s0=e.stackAlloc=Et.stackAlloc,xd=e.stackRestore=Et.stackRestore,to=e.stackSave=Et.stackSave;if(e.asm=Et,e.cwrap=se,e.setValue=V,e.getValue=q,en){Ze(en)||(en=s(en));{eo(\"memory initializer\");var a0=function(At){At.byteLength&&(At=new Uint8Array(At)),jt.set(At,k),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,$t(\"memory initializer\")},l0=function(){c(en,a0,function(){throw\"could not load memory initializer \"+en})},gg=ln(en);if(gg)a0(gg.buffer);else if(e.memoryInitializerRequest){var B_=function(){var At=e.memoryInitializerRequest,Nt=At.response;if(At.status!==200&&At.status!==0){var sn=ln(e.memoryInitializerRequestURL);if(sn)Nt=sn.buffer;else{console.warn(\"a problem seems to have happened with Module.memoryInitializerRequest, status: \"+At.status+\", retrying \"+en),l0();return}}a0(Nt)};e.memoryInitializerRequest.response?setTimeout(B_,0):e.memoryInitializerRequest.addEventListener(\"load\",B_)}else l0()}}var Oc;Fr=function At(){Oc||_f(),Oc||(Fr=At)};function _f(At){if(At=At||i,Zr>0||(cs(),Zr>0))return;function Nt(){Oc||(Oc=!0,!K&&(yi(),Ro(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),co()))}e.setStatus?(e.setStatus(\"Running...\"),setTimeout(function(){setTimeout(function(){e.setStatus(\"\")},1),Nt()},1)):Nt()}e.run=_f;function rl(At){throw e.onAbort&&e.onAbort(At),At+=\"\",d(At),m(At),K=!0,\"abort(\"+At+\"). Build with -s ASSERTIONS=1 for more info.\"}if(e.abort=rl,e.preInit)for(typeof e.preInit==\"function\"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return _f(),t})(typeof mi==\"object\"?mi:{}),Qn=\"number\",Yn=Qn,u2=Qn,$n=Qn,er=Qn,Ta=Qn,bn=Qn,GTe=[[\"sizeOfH3Index\",Qn],[\"sizeOfLatLng\",Qn],[\"sizeOfCellBoundary\",Qn],[\"sizeOfGeoLoop\",Qn],[\"sizeOfGeoPolygon\",Qn],[\"sizeOfLinkedGeoPolygon\",Qn],[\"sizeOfCoordIJ\",Qn],[\"readInt64AsDoubleFromPointer\",Qn],[\"isValidCell\",u2,[$n,er]],[\"isValidIndex\",u2,[$n,er]],[\"latLngToCell\",Yn,[Qn,Qn,Ta,bn]],[\"cellToLatLng\",Yn,[$n,er,bn]],[\"cellToBoundary\",Yn,[$n,er,bn]],[\"maxGridDiskSize\",Yn,[Qn,bn]],[\"gridDisk\",Yn,[$n,er,Qn,bn]],[\"gridDiskDistances\",Yn,[$n,er,Qn,bn,bn]],[\"gridRing\",Yn,[$n,er,Qn,bn]],[\"gridRingUnsafe\",Yn,[$n,er,Qn,bn]],[\"maxPolygonToCellsSize\",Yn,[bn,Ta,Qn,bn]],[\"polygonToCells\",Yn,[bn,Ta,Qn,bn]],[\"maxPolygonToCellsSizeExperimental\",Yn,[bn,Ta,Qn,bn]],[\"polygonToCellsExperimental\",Yn,[bn,Ta,Qn,Qn,Qn,bn]],[\"cellsToLinkedMultiPolygon\",Yn,[bn,Qn,bn]],[\"destroyLinkedMultiPolygon\",null,[bn]],[\"compactCells\",Yn,[bn,bn,Qn,Qn]],[\"uncompactCells\",Yn,[bn,Qn,Qn,bn,Qn,Ta]],[\"uncompactCellsSize\",Yn,[bn,Qn,Qn,Ta,bn]],[\"isPentagon\",u2,[$n,er]],[\"isResClassIII\",u2,[$n,er]],[\"getBaseCellNumber\",Qn,[$n,er]],[\"getResolution\",Qn,[$n,er]],[\"getIndexDigit\",Qn,[$n,er,Qn]],[\"constructCell\",Yn,[Qn,Qn,bn,bn]],[\"maxFaceCount\",Yn,[$n,er,bn]],[\"getIcosahedronFaces\",Yn,[$n,er,bn]],[\"cellToParent\",Yn,[$n,er,Ta,bn]],[\"cellToChildren\",Yn,[$n,er,Ta,bn]],[\"cellToCenterChild\",Yn,[$n,er,Ta,bn]],[\"cellToChildrenSize\",Yn,[$n,er,Ta,bn]],[\"cellToChildPos\",Yn,[$n,er,Ta,bn]],[\"childPosToCell\",Yn,[Qn,Qn,$n,er,Ta,bn]],[\"areNeighborCells\",Yn,[$n,er,$n,er,bn]],[\"cellsToDirectedEdge\",Yn,[$n,er,$n,er,bn]],[\"getDirectedEdgeOrigin\",Yn,[$n,er,bn]],[\"getDirectedEdgeDestination\",Yn,[$n,er,bn]],[\"isValidDirectedEdge\",u2,[$n,er]],[\"directedEdgeToCells\",Yn,[$n,er,bn]],[\"originToDirectedEdges\",Yn,[$n,er,bn]],[\"directedEdgeToBoundary\",Yn,[$n,er,bn]],[\"gridDistance\",Yn,[$n,er,$n,er,bn]],[\"gridPathCells\",Yn,[$n,er,$n,er,bn]],[\"gridPathCellsSize\",Yn,[$n,er,$n,er,bn]],[\"cellToLocalIj\",Yn,[$n,er,$n,er,Qn,bn]],[\"localIjToCell\",Yn,[$n,er,bn,Qn,bn]],[\"getHexagonAreaAvgM2\",Yn,[Ta,bn]],[\"getHexagonAreaAvgKm2\",Yn,[Ta,bn]],[\"getHexagonEdgeLengthAvgM\",Yn,[Ta,bn]],[\"getHexagonEdgeLengthAvgKm\",Yn,[Ta,bn]],[\"greatCircleDistanceM\",Qn,[bn,bn]],[\"greatCircleDistanceKm\",Qn,[bn,bn]],[\"greatCircleDistanceRads\",Qn,[bn,bn]],[\"cellAreaM2\",Yn,[$n,er,bn]],[\"cellAreaKm2\",Yn,[$n,er,bn]],[\"cellAreaRads2\",Yn,[$n,er,bn]],[\"edgeLengthM\",Yn,[$n,er,bn]],[\"edgeLengthKm\",Yn,[$n,er,bn]],[\"edgeLengthRads\",Yn,[$n,er,bn]],[\"getNumCells\",Yn,[Ta,bn]],[\"getRes0Cells\",Yn,[bn]],[\"res0CellCount\",Qn],[\"getPentagons\",Yn,[Qn,bn]],[\"pentagonCount\",Qn],[\"cellToVertex\",Yn,[$n,er,Qn,bn]],[\"cellToVertexes\",Yn,[$n,er,bn]],[\"vertexToLatLng\",Yn,[$n,er,bn]],[\"isValidVertex\",u2,[$n,er]]],HTe=0,WTe=1,jTe=2,XTe=3,Yte=4,YTe=5,ZTe=6,qTe=7,QTe=8,KTe=9,JTe=10,$Te=11,eEe=12,tEe=13,nEe=14,rEe=15,iEe=16,oEe=17,sEe=18,aEe=19,vs={};vs[HTe]=\"Success\";vs[WTe]=\"The operation failed but a more specific error is not available\";vs[jTe]=\"Argument was outside of acceptable range\";vs[XTe]=\"Latitude or longitude arguments were outside of acceptable range\";vs[Yte]=\"Resolution argument was outside of acceptable range\";vs[YTe]=\"Cell argument was not valid\";vs[ZTe]=\"Directed edge argument was not valid\";vs[qTe]=\"Undirected edge argument was not valid\";vs[QTe]=\"Vertex argument was not valid\";vs[KTe]=\"Pentagon distortion was encountered\";vs[JTe]=\"Duplicate input\";vs[$Te]=\"Cell arguments were not neighbors\";vs[eEe]=\"Cell arguments had incompatible resolutions\";vs[tEe]=\"Memory allocation failed\";vs[nEe]=\"Bounds of provided memory were insufficient\";vs[rEe]=\"Mode or flags argument was not valid\";vs[iEe]=\"Index argument was not valid\";vs[oEe]=\"Base cell number was outside of acceptable range\";vs[sEe]=\"Child indexing digits invalid\";vs[aEe]=\"Child indexing digits refer to a deleted subsequence\";var Zte=1e3,lEe=1001,qte=1002,II={};II[Zte]=\"Unknown unit\";II[lEe]=\"Array length out of bounds\";II[qte]=\"Got unexpected null value for H3 index\";var cEe=\"Unknown error\";function Qte(t,e,n){var r=n&&\"value\"in n,i=new Error((t[e]||cEe)+\" (code: \"+e+(r?\", value: \"+n.value:\"\")+\")\");return i.code=e,i}function Kte(t,e){var n=arguments.length===2?{value:e}:{};return Qte(vs,t,n)}function Jte(t,e){var n=arguments.length===2?{value:e}:{};return Qte(II,t,n)}function o_(t){if(t!==0)throw Kte(t)}var Ws={};GTe.forEach(function(e){Ws[e[0]]=mi.cwrap.apply(mi,e)});var h2=16;var $te=4,Wte=4,YA=8,uEe=8,CI=Ws.sizeOfH3Index(),ene=Ws.sizeOfLatLng(),hEe=Ws.sizeOfCellBoundary(),kat=Ws.sizeOfGeoPolygon(),Nat=Ws.sizeOfGeoLoop(),fEe=Ws.sizeOfLinkedGeoPolygon(),zat=Ws.sizeOfCoordIJ(),jte={m:\"m\",m2:\"m2\",km:\"km\",km2:\"km2\",rads:\"rads\",rads2:\"rads2\"};function dEe(t){if(typeof t!=\"number\"||t<0||t>15||Math.floor(t)!==t)throw Kte(Yte,t);return t}function pEe(t){if(!t)throw Jte(qte);return t}var Uat=Math.pow(2,32)-1;var AEe=/[^0-9a-fA-F]/;function s_(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!=\"string\"||AEe.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),h2),n=parseInt(t.substring(t.length-8),h2);return[n,e]}function Xte(t){if(t>=0)return t.toString(h2);t=t&2147483647;var e=tne(8,t.toString(h2)),n=(parseInt(e[0],h2)+8).toString(h2);return e=n+e.substring(1),e}function gEe(t,e){return Xte(e)+tne(8,Xte(t))}function tne(t,e){for(var n=t-e.length,r=\"\",i=0;i<n;i++)r+=\"0\";return r=r+e,r}var Vat=Math.pow(2,32);function mEe(t,e){e===void 0&&(e=0);var n=mi.getValue(t+CI*e,\"i32\"),r=mi.getValue(t+CI*e+$te,\"i32\");return r?gEe(n,r):null}function _Ee(t,e){return e===void 0&&(e=0),mi.getValue(t+YA*e,\"double\")}function yEe(t){return Ws.readInt64AsDoubleFromPointer(t)}function xEe(t,e,n){mi.HEAPU32.set(s_(t),e/$te+2*n)}function vEe(t,e){for(var n=e.length,r=0;r<n;r++)xEe(e[r],t,r)}function MI(t){return EEe(mi.getValue(t,\"double\"))}function Vk(t){return[MI(t),MI(t+YA)]}function nne(t){return[MI(t+YA),MI(t)]}function bEe(t,e,n){for(var r=mi.getValue(t,\"i32\"),i=t+YA,o=[],s=e?nne:Vk,c=0;c<r*2;c+=2)o.push(s(i+YA*c));return n&&o.push(o[0]),o}function wEe(t,e){for(var n=[],r=e?nne:Vk,i,o,s,c;t;){for(n.push(i=[]),o=mi.getValue(t,\"i8*\");o;){for(i.push(s=[]),c=mi.getValue(o,\"i8*\");c;)s.push(r(c)),c=mi.getValue(c+YA*2,\"i8*\");e&&s.push(s[0]),o=mi.getValue(o+Wte*2,\"i8*\")}t=mi.getValue(t+Wte*2,\"i8*\")}return n}function rne(t){var e=s_(t),n=e[0],r=e[1];return!!Ws.isPentagon(n,r)}function ine(t){var e=s_(t),n=e[0],r=e[1];return Ws.isValidCell(n,r)?Ws.getResolution(n,r):-1}function one(t,e,n){var r=mi._malloc(ene);mi.HEAPF64.set([t,e].map(TEe),r/YA);var i=mi._malloc(CI);try{return o_(Ws.latLngToCell(r,n,i)),pEe(mEe(i))}finally{mi._free(i),mi._free(r)}}function D3(t){var e=mi._malloc(ene),n=s_(t),r=n[0],i=n[1];try{return o_(Ws.cellToLatLng(r,i,e)),Vk(e)}finally{mi._free(e)}}function sne(t,e){var n=mi._malloc(hEe),r=s_(t),i=r[0],o=r[1];try{return o_(Ws.cellToBoundary(i,o,n)),bEe(n,e,e)}finally{mi._free(n)}}function ane(t,e){if(!t||!t.length)return[];var n=t.length,r=mi._calloc(n,CI);vEe(r,t);var i=mi._calloc(fEe);try{return o_(Ws.cellsToLinkedMultiPolygon(r,n,i)),wEe(i,e)}finally{Ws.destroyLinkedMultiPolygon(i),mi._free(i),mi._free(r)}}function lne(t,e){var n=s_(t),r=n[0],i=n[1],o=s_(e),s=o[0],c=o[1],d=mi._malloc(uEe);try{return o_(Ws.gridDistance(r,i,s,c,d)),yEe(d)}finally{mi._free(d)}}function cne(t,e){dEe(t);var n=mi._malloc(YA);try{switch(e){case jte.m:o_(Ws.getHexagonEdgeLengthAvgM(t,n));break;case jte.km:o_(Ws.getHexagonEdgeLengthAvgKm(t,n));break;default:throw Jte(Zte,e)}return _Ee(n)}finally{mi._free(n)}}function TEe(t){return t*Math.PI/180}function EEe(t){return t*180/Math.PI}function PI(t,e){e=e===void 0?t[0][0]:e;for(let n of t){let r=n[0]-e;r>180?n[0]-=360:r<-180&&(n[0]+=360)}}function SEe(t,e,n){let[r,i]=D3(t),o=e.length;PI(e,i);let s=e[0]===e[o-1]?o-1:o;for(let c=0;c<s;c++)e[c][0]=Xa(i,e[c][0],n),e[c][1]=Xa(r,e[c][1],n)}function une(t,e,n){let r=t(e,n),[i,o]=D3(r);return[o,i]}function Gk(t,e=1){let n=sne(t,!0);return e!==1?SEe(t,n,e):PI(n),n}function hne(t){let e=new Float64Array(t.length*2),n=0;for(let r of t)e[n++]=r[0],e[n++]=r[1];return e}var RI=xr(Hk(),1),CEe=3,MEe=30,IEe=2*MEe+1,dne=180/Math.PI;function Ane(t,e,n){let r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function pne(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function gne(t){return[pne(t[0]),pne(t[1])]}function mne(t,[e,n]){switch(t){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error(\"Invalid face\")}}function _ne([t,e,n]){let r=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*dne,r*dne]}function yne(t){let e=RI.default.fromString(t,!0,10).toString(2);for(;e.length<CEe+IEe;)e=\"0\"+e;let n=e.lastIndexOf(\"1\"),r=e.substring(0,3),i=e.substring(3,n),o=i.length/2,s=RI.default.fromString(r,!0,2).toString(10),c=RI.default.fromString(i,!0,2).toString(4);for(;c.length<o;)c=\"0\"+c;return`${s}/${c}`}function PEe(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);let i=e[0];e[0]=e[1],e[1]=i}}function xne(t){let e=t.split(\"/\"),n=parseInt(e[0],10),r=e[1],i=r.length,o=[0,0],s;for(let c=i-1;c>=0;c--){s=i-c;let d=r[c],m=0,b=0;d===\"1\"?b=1:d===\"2\"?(m=1,b=1):d===\"3\"&&(m=1);let C=Math.pow(2,s-1);PEe(C,o,m,b),o[0]+=C*m,o[1]+=C*b}if(n%2===1){let c=o[0];o[0]=o[1],o[1]=c}return{face:n,ij:o,level:s}}var vne=xr(Hk(),1);function REe(t){let e=t.padEnd(16,\"0\");return vne.default.fromString(e,16)}var BEe=100;function DEe({face:t,ij:e,level:n}){let r=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(BEe*Math.pow(2,-n))),o=new Float64Array(4*i*2+2),s=0,c=0;for(let d=0;d<4;d++){let m=r[d].slice(0),b=r[d+1],C=(b[0]-m[0])/i,B=(b[1]-m[1])/i;for(let k=0;k<i;k++){m[0]+=C,m[1]+=B;let V=Ane(e,n,m),q=gne(V),K=mne(t,q),Y=_ne(K);Math.abs(Y[1])>89.999&&(Y[0]=c);let ee=Y[0]-c;Y[0]+=ee>180?-360:ee<-180?360:0,o[s++]=Y[0],o[s++]=Y[1],c=Y[0]}}return o[s++]=o[0],o[s++]=o[1],o}function LEe(t){if(typeof t==\"string\"){if(t.indexOf(\"/\")>0)return t;t=REe(t)}return yne(t.toString())}function bne(t){let e=LEe(t),n=xne(e);return DEe(n)}var OEe={getS2Token:{type:\"accessor\",value:t=>t.token}},O3=class extends XA{indexToBounds(){let{data:e,getS2Token:n}=this.props;return{data:e,_normalize:!1,positionFormat:\"XY\",getPolygon:(r,i)=>bne(n(r,i))}}};O3.layerName=\"S2Layer\";O3.defaultProps=OEe;var BI=O3;var Wk=512;function FEe(t,e){let n=0,r=0,i=1<<t.length,o=i/Wk;for(let s=0;s<t.length;s++){i>>=1;let c=parseInt(t[s]);c%2&&(n|=i),c>1&&(r|=i)}return[[n/o,Wk-r/o],[(n+e)/o,Wk-(r+e)/o]]}function wne(t,e=1){let[n,r]=FEe(t,e),[i,o]=pl(n),[s,c]=pl(r);return[s,o,s,c,i,c,i,o,s,o]}var kEe={getQuadkey:{type:\"accessor\",value:t=>t.quadkey}},F3=class extends XA{indexToBounds(){let{data:e,extruded:n,getQuadkey:r}=this.props,i=n?.99:1;return{data:e,_normalize:!1,positionFormat:\"XY\",getPolygon:(o,s)=>wne(r(o,s),i),updateTriggers:{getPolygon:i}}}};F3.layerName=\"QuadkeyLayer\";F3.defaultProps=kEe;var DI=F3;var LI=class{constructor(e){this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,\"west\"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){let e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error(\"byteLength not defined in tile data\"),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){let{index:o,id:s,bbox:c,userData:d,zoom:m}=this,b=this._loaderId;this._abortController=new AbortController;let{signal:C}=this._abortController,B=await n.scheduleRequest(this,q=>q.isSelected?1:-1);if(!B){this._isCancelled=!0;return}if(this._isCancelled){B.done();return}let k=null,V;try{k=await e({index:o,id:s,bbox:c,userData:d,zoom:m,signal:C})}catch(q){V=q||!0}finally{B.done()}if(b===this._loaderId){if(this._loader=void 0,this.content=k,this._isCancelled&&!k){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,V?i(V,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController?.abort())}};var bs={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};var Tne=new $e,NEe=new $e,f2=class t{constructor(e=[0,0,0],n=[0,0,0],r){r=r||Tne.copy(e).add(n).scale(.5),this.center=new $e(r),this.halfDiagonal=new $e(n).subtract(this.center),this.minimum=new $e(e),this.maximum=new $e(n)}clone(){return new t(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){let{halfDiagonal:n}=this,r=NEe.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),o=this.center.dot(r)+e.distance;return o-i>0?bs.INSIDE:o+i<0?bs.OUTSIDE:bs.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){let n=Tne.from(e).subtract(this.center),{halfDiagonal:r}=this,i=0,o;return o=Math.abs(n.x)-r.x,o>0&&(i+=o*o),o=Math.abs(n.y)-r.y,o>0&&(i+=o*o),o=Math.abs(n.z)-r.z,o>0&&(i+=o*o),i}};var k3=new $e,Ene=new $e,hd=class t{constructor(e=[0,0,0],n=0){this.radius=-0,this.center=new $e,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=k3.from(n),this.center=new $e().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new t(this.center,this.radius)}union(e){let n=this.center,r=this.radius,i=e.center,o=e.radius,s=k3.copy(i).subtract(n),c=s.magnitude();if(r>=c+o)return this.clone();if(o>=c+r)return e.clone();let d=(r+c+o)*.5;return Ene.copy(s).scale((-r+d)/c).add(n),this.center.copy(Ene),this.radius=d,this}expand(e){let r=k3.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);let n=_s.getScaling(k3,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){let n=this.distanceTo(e);return n*n}distanceTo(e){let r=k3.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){let n=this.center,r=this.radius,o=e.normal.dot(n)+e.distance;return o<-r?bs.OUTSIDE:o<r?bs.INTERSECTING:bs.INSIDE}};var zEe=new $e,UEe=new $e,OI=new $e,FI=new $e,kI=new $e,VEe=new $e,GEe=new $e,Gp={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8},Hp=class t{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){this.center=new $e().from(e),this.halfAxes=new Mi(n)}get halfSize(){let e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new $e(e).len(),new $e(n).len(),new $e(r).len()]}get quaternion(){let e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new $e(e).normalize(),o=new $e(n).normalize(),s=new $e(r).normalize();return new qu().fromMatrix3(new Mi([...i,...o,...s]))}fromCenterHalfSizeQuaternion(e,n,r){let i=new qu(r),o=new Mi().fromQuaternion(i);return o[0]=o[0]*n[0],o[1]=o[1]*n[0],o[2]=o[2]*n[0],o[3]=o[3]*n[1],o[4]=o[4]*n[1],o[5]=o[5]*n[1],o[6]=o[6]*n[2],o[7]=o[7]*n[2],o[8]=o[8]*n[2],this.center=new $e().from(e),this.halfAxes=o,this}clone(){return new t(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new hd){let n=this.halfAxes,r=n.getColumn(0,OI),i=n.getColumn(1,FI),o=n.getColumn(2,kI),s=zEe.copy(r).add(i).add(o);return e.center.copy(this.center),e.radius=s.magnitude(),e}intersectPlane(e){let n=this.center,r=e.normal,i=this.halfAxes,o=r.x,s=r.y,c=r.z,d=Math.abs(o*i[Gp.COLUMN0ROW0]+s*i[Gp.COLUMN0ROW1]+c*i[Gp.COLUMN0ROW2])+Math.abs(o*i[Gp.COLUMN1ROW0]+s*i[Gp.COLUMN1ROW1]+c*i[Gp.COLUMN1ROW2])+Math.abs(o*i[Gp.COLUMN2ROW0]+s*i[Gp.COLUMN2ROW1]+c*i[Gp.COLUMN2ROW2]),m=r.dot(n)+e.distance;return m<=-d?bs.OUTSIDE:m>=d?bs.INSIDE:bs.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){let n=UEe.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,OI),o=r.getColumn(1,FI),s=r.getColumn(2,kI),c=i.magnitude(),d=o.magnitude(),m=s.magnitude();i.normalize(),o.normalize(),s.normalize();let b=0,C;return C=Math.abs(n.dot(i))-c,C>0&&(b+=C*C),C=Math.abs(n.dot(o))-d,C>0&&(b+=C*C),C=Math.abs(n.dot(s))-m,C>0&&(b+=C*C),b}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=this.center,c=this.halfAxes,d=c.getColumn(0,OI),m=c.getColumn(1,FI),b=c.getColumn(2,kI),C=VEe.copy(d).add(m).add(b).add(s),B=GEe.copy(C).subtract(e),k=n.dot(B);return i=Math.min(k,i),o=Math.max(k,o),C.copy(s).add(d).add(m).subtract(b),B.copy(C).subtract(e),k=n.dot(B),i=Math.min(k,i),o=Math.max(k,o),C.copy(s).add(d).subtract(m).add(b),B.copy(C).subtract(e),k=n.dot(B),i=Math.min(k,i),o=Math.max(k,o),C.copy(s).add(d).subtract(m).subtract(b),B.copy(C).subtract(e),k=n.dot(B),i=Math.min(k,i),o=Math.max(k,o),s.copy(C).subtract(d).add(m).add(b),B.copy(C).subtract(e),k=n.dot(B),i=Math.min(k,i),o=Math.max(k,o),s.copy(C).subtract(d).add(m).subtract(b),B.copy(C).subtract(e),k=n.dot(B),i=Math.min(k,i),o=Math.max(k,o),s.copy(C).subtract(d).subtract(m).add(b),B.copy(C).subtract(e),k=n.dot(B),i=Math.min(k,i),o=Math.max(k,o),s.copy(C).subtract(d).subtract(m).subtract(b),B.copy(C).subtract(e),k=n.dot(B),i=Math.min(k,i),o=Math.max(k,o),r[0]=i,r[1]=o,r}transform(e){this.center.transformAsPoint(e);let n=this.halfAxes.getColumn(0,OI);n.transformAsPoint(e);let r=this.halfAxes.getColumn(1,FI);r.transformAsPoint(e);let i=this.halfAxes.getColumn(2,kI);return i.transformAsPoint(e),this.halfAxes=new Mi([...n,...r,...i]),this}getTransform(){throw new Error(\"not implemented\")}};var Sne=new $e,Cne=new $e,gl=class t{constructor(e=[0,0,1],n=0){this.normal=new $e,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return ba(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=Sne.from(e),this.normal.from(n).normalize();let r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),ba(Gs(this.normal.len(),1)),this.distance=i,this}clone(){return new t(this.normal,this.distance)}equals(e){return Gs(this.distance,e.distance)&&Gs(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){let n=Cne.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){let r=Sne.from(e),i=this.getPointDistance(r),o=Cne.copy(this.normal).scale(i);return r.subtract(o).to(n)}};var Mne=[new $e([1,0,0]),new $e([0,1,0]),new $e([0,0,1])],Ine=new $e,HEe=new $e,ec=class t{constructor(e=[]){this.planes=e}fromBoundingSphere(e){this.planes.length=2*Mne.length;let n=e.center,r=e.radius,i=0;for(let o of Mne){let s=this.planes[i],c=this.planes[i+1];s||(s=this.planes[i]=new gl),c||(c=this.planes[i+1]=new gl);let d=Ine.copy(o).scale(-r).add(n);s.fromPointNormal(d,o);let m=Ine.copy(o).scale(r).add(n),b=HEe.copy(o).negate();c.fromPointNormal(m,b),i+=2}return this}computeVisibility(e){let n=bs.INSIDE;for(let r of this.planes)switch(e.intersectPlane(r)){case bs.OUTSIDE:return bs.OUTSIDE;case bs.INTERSECTING:n=bs.INTERSECTING;break;default:}return n}computeVisibilityWithPlaneMask(e,n){if(ba(Number.isFinite(n),\"parentPlaneMask is required.\"),n===t.MASK_OUTSIDE||n===t.MASK_INSIDE)return n;let r=t.MASK_INSIDE,i=this.planes;for(let o=0;o<this.planes.length;++o){let s=o<31?1<<o:0;if(o<31&&(n&s)===0)continue;let c=i[o],d=e.intersectPlane(c);if(d===bs.OUTSIDE)return t.MASK_OUTSIDE;d===bs.INTERSECTING&&(r|=s)}return r}};ec.MASK_OUTSIDE=4294967295;ec.MASK_INSIDE=0;ec.MASK_INDETERMINATE=2147483647;var Elt=new $e,Slt=new $e,Clt=new $e,Mlt=new $e,Ilt=new $e;var Olt=new $e,Flt=new $e,klt=new $e,Nlt=new $e,zlt=new $e,Ult=new $e,Vlt=new $e,Glt=new $e,Hlt=new $e,Wlt=new $e,jlt=new $e,Xlt=new $e;var fd=new Mi,jEe=new Mi,XEe=new Mi,NI=new Mi,Pne=new Mi;function Yk(t,e={}){let n=qh.EPSILON20,r=10,i=0,o=0,s=jEe,c=XEe;s.identity(),c.copy(t);let d=n*YEe(c);for(;o<r&&ZEe(c)>d;)qEe(c,NI),Pne.copy(NI).transpose(),c.multiplyRight(NI),c.multiplyLeft(Pne),s.multiplyRight(NI),++i>2&&(++o,i=0);return e.unitary=s.toTarget(e.unitary),e.diagonal=c.toTarget(e.diagonal),e}function YEe(t){let e=0;for(let n=0;n<9;++n){let r=t[n];e+=r*r}return Math.sqrt(e)}var jk=[1,0,0],Xk=[2,2,1];function ZEe(t){let e=0;for(let n=0;n<3;++n){let r=t[fd.getElementIndex(Xk[n],jk[n])];e+=2*r*r}return Math.sqrt(e)}function qEe(t,e){let n=qh.EPSILON15,r=0,i=1;for(let m=0;m<3;++m){let b=Math.abs(t[fd.getElementIndex(Xk[m],jk[m])]);b>r&&(i=m,r=b)}let o=jk[i],s=Xk[i],c=1,d=0;if(Math.abs(t[fd.getElementIndex(s,o)])>n){let m=t[fd.getElementIndex(s,s)],b=t[fd.getElementIndex(o,o)],C=t[fd.getElementIndex(s,o)],B=(m-b)/2/C,k;B<0?k=-1/(-B+Math.sqrt(1+B*B)):k=1/(B+Math.sqrt(1+B*B)),c=1/Math.sqrt(1+k*k),d=k*c}return Mi.IDENTITY.to(e),e[fd.getElementIndex(o,o)]=e[fd.getElementIndex(s,s)]=c,e[fd.getElementIndex(s,o)]=d,e[fd.getElementIndex(o,s)]=-d,e}var ZA=new $e,QEe=new $e,KEe=new $e,JEe=new $e,$Ee=new $e,eSe=new Mi,tSe={diagonal:new Mi,unitary:new Mi};function N3(t,e=new Hp){if(!t||t.length===0)return e.halfAxes=new Mi([0,0,0,0,0,0,0,0,0]),e.center=new $e,e;let n=t.length,r=new $e(0,0,0);for(let be of t)r.add(be);let i=1/n;r.multiplyByScalar(i);let o=0,s=0,c=0,d=0,m=0,b=0;for(let be of t){let ge=ZA.copy(be).subtract(r);o+=ge.x*ge.x,s+=ge.x*ge.y,c+=ge.x*ge.z,d+=ge.y*ge.y,m+=ge.y*ge.z,b+=ge.z*ge.z}o*=i,s*=i,c*=i,d*=i,m*=i,b*=i;let C=eSe;C[0]=o,C[1]=s,C[2]=c,C[3]=s,C[4]=d,C[5]=m,C[6]=c,C[7]=m,C[8]=b;let{unitary:B}=Yk(C,tSe),k=e.halfAxes.copy(B),V=k.getColumn(0,KEe),q=k.getColumn(1,JEe),K=k.getColumn(2,$Ee),Y=-Number.MAX_VALUE,ee=-Number.MAX_VALUE,J=-Number.MAX_VALUE,se=Number.MAX_VALUE,xe=Number.MAX_VALUE,Ee=Number.MAX_VALUE;for(let be of t)ZA.copy(be),Y=Math.max(ZA.dot(V),Y),ee=Math.max(ZA.dot(q),ee),J=Math.max(ZA.dot(K),J),se=Math.min(ZA.dot(V),se),xe=Math.min(ZA.dot(q),xe),Ee=Math.min(ZA.dot(K),Ee);V=V.multiplyByScalar(.5*(se+Y)),q=q.multiplyByScalar(.5*(xe+ee)),K=K.multiplyByScalar(.5*(Ee+J)),e.center.copy(V).add(q).add(K);let Xe=QEe.set(Y-se,ee-xe,J-Ee).multiplyByScalar(.5),Ne=new Mi([Xe[0],0,0,0,Xe[1],0,0,0,Xe[2]]);return e.halfAxes.multiplyRight(Ne),e}var d2=512,Rne=3,Bne=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],Dne=Bne.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),nSe=Dne.concat([[.25,.5],[.75,.5]]),Zk=class t{constructor(e,n,r){this.x=e,this.y=n,this.z=r}get children(){if(!this._children){let e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new t(e,n,r),new t(e,n+1,r),new t(e+1,n,r),new t(e+1,n+1,r)]}return this._children}update(e){let{viewport:n,cullingVolume:r,elevationBounds:i,minZ:o,maxZ:s,bounds:c,offset:d,project:m}=e,b=this.getBoundingVolume(i,d,m);if(c&&!this.insideBounds(c)||r.computeVisibility(b)<0)return!1;if(!this.childVisible){let{z:B}=this;if(B<s&&B>=o){let k=b.distanceTo(n.cameraPosition)*n.scale/n.height;B+=Math.floor(Math.log2(k))}if(B>=s)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(let B of this.children)B.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(let n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){let o=Math.pow(2,this.z),s=d2/o;return this.x*s<r&&this.y*s<i&&(this.x+1)*s>e&&(this.y+1)*s>n}getBoundingVolume(e,n,r){if(r){let d=this.z<1?nSe:this.z<2?Dne:Bne,m=[];for(let b of d){let C=zI(this.x+b[0],this.y+b[1],this.z);C[2]=e[0],m.push(r(C)),e[0]!==e[1]&&(C[2]=e[1],m.push(r(C)))}return N3(m)}let i=Math.pow(2,this.z),o=d2/i,s=this.x*o+n*d2,c=d2-(this.y+1)*o;return new f2([s,c,e[0]],[s+o,c+o,e[1]])}};function Lne(t,e,n,r){let i=t instanceof gw&&t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map(({normal:k,distance:V})=>new gl(k.clone().negate(),V)),s=new ec(o),c=t.distanceScales.unitsPerMeter[2],d=n&&n[0]*c||0,m=n&&n[1]*c||0,b=t instanceof LA&&t.pitch<=60?e:0;if(r){let[k,V,q,K]=r,Y=$l([k,K]),ee=$l([q,V]);r=[Y[0],d2-Y[1],ee[0],d2-ee[1]]}let C=new Zk(0,0,0),B={viewport:t,project:i,cullingVolume:s,elevationBounds:[d,m],minZ:b,maxZ:e,bounds:r,offset:0};if(C.update(B),t instanceof LA&&t.subViewports&&t.subViewports.length>1){for(B.offset=-1;C.update(B)&&!(--B.offset<-Rne););for(B.offset=1;C.update(B)&&!(++B.offset>Rne););}return C.getSelected()}var Wp=512,rSe=[-1/0,-1/0,1/0,1/0],qA={type:\"object\",value:null,validate:(t,e)=>e.optional&&t===null||typeof t==\"string\"||Array.isArray(t)&&t.every(n=>typeof n==\"string\"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;let n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function UI(t,e){let n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function iSe(t){return Math.abs(t.split(\"\").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function QA(t,e){if(!t||!t.length)return null;let{index:n,id:r}=e;if(Array.isArray(t)){let o=iSe(r)%t.length;t=t[o]}let i=t;for(let o of Object.keys(n)){let s=new RegExp(`{${o}}`,\"g\");i=i.replace(s,String(n[o]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\\{-y\\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function oSe(t,e,n){let r;if(e&&e.length===2){let[i,o]=e,s=t.getBounds({z:i}),c=t.getBounds({z:o});r=[Math.min(s[0],c[0]),Math.min(s[1],c[1]),Math.max(s[2],c[2]),Math.max(s[3],c[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function Fne({viewport:t,z:e,cullRect:n}){return(t.subViewports||[t]).map(i=>qk(i,e||0,n))}function qk(t,e,n){if(!Array.isArray(e)){let o=n.x-t.x,s=n.y-t.y,{width:c,height:d}=n,m={targetZ:e},b=t.unproject([o,s],m),C=t.unproject([o+c,s],m),B=t.unproject([o,s+d],m),k=t.unproject([o+c,s+d],m);return[Math.min(b[0],C[0],B[0],k[0]),Math.min(b[1],C[1],B[1],k[1]),Math.max(b[0],C[0],B[0],k[0]),Math.max(b[1],C[1],B[1],k[1])]}let r=qk(t,e[0],n),i=qk(t,e[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function sSe(t,e,n){return n?UI(t,n).map(i=>i*e/Wp):t.map(r=>r*e/Wp)}function Qk(t,e){return Math.pow(2,t)*Wp/e}function zI(t,e,n){let r=Qk(n,Wp),i=t/r*360-180,o=Math.PI-2*Math.PI*e/r,s=180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)));return[i,s]}function One(t,e,n,r){let i=Qk(n,r);return[t/i*Wp,e/i*Wp]}function Kk(t,e,n,r,i=Wp){if(t.isGeospatial){let[m,b]=zI(e,n,r),[C,B]=zI(e+1,n+1,r);return{west:m,north:b,east:C,south:B}}let[o,s]=One(e,n,r,i),[c,d]=One(e+1,n+1,r,i);return{left:o,top:s,right:c,bottom:d}}function aSe(t,e,n,r,i){let o=oSe(t,null,r),s=Qk(e,n),[c,d,m,b]=sSe(o,s,i),C=[];for(let B=Math.floor(c);B<m;B++)for(let k=Math.floor(d);k<b;k++)C.push({x:B,y:k,z:e});return C}function Jk({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:o=Wp,modelMatrix:s,modelMatrixInverse:c,zoomOffset:d=0}){let m=t.isGeospatial?Math.round(t.zoom+Math.log2(Wp/o))+d:Math.ceil(t.zoom)+d;if(typeof n==\"number\"&&Number.isFinite(n)&&m<n){if(!i)return[];m=n}typeof e==\"number\"&&Number.isFinite(e)&&m>e&&(m=e);let b=i;return s&&c&&i&&!t.isGeospatial&&(b=UI(i,s)),t.isGeospatial?Lne(t,m,r,i):aSe(t,m,o,b||rSe,c)}function $k(t){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(t)}function eN(t){return Number.isFinite(t.west)&&Number.isFinite(t.north)&&Number.isFinite(t.east)&&Number.isFinite(t.south)}function kne(t){let e={},n;return r=>{for(let i in r)if(!lSe(r[i],e[i])){n=t(r),e=r;break}return n}}function lSe(t,e){if(t===e)return!0;if(Array.isArray(t)){let n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}var Nne=1,VI=2,cSe=\"never\",uSe=\"no-overlap\",z3=\"best-available\",hSe=5,fSe={[z3]:pSe,[uSe]:ASe,[cSe]:()=>{}},dSe={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:\"best-available\",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}},p2=class{constructor(e){this._getCullBounds=kne(Fne),this.opts={...dSe,...e},this.setOptions(this.opts),this.onTileLoad=n=>{this.opts.onTileLoad?.(n),this.opts.maxCacheByteSize!==null&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new bA({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new wn,this._modelMatrixInverse=new wn}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(let e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(let e of this._cache.keys()){let n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={zRange:null,modelMatrix:null}){let i=r?new wn(r):new wn,o=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Gs(this._zRange,n)||o){o&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;let c=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=c.map(d=>this._getTile(d,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(c=>this._getTile(c.index,!0)));let s=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),s&&this._frameNumber++,this._frameNumber}isTileVisible(e,n,r){if(!e.isVisible)return!1;if(n&&this._viewport){let i=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:o}=e;for(let[s,c,d,m]of i){let b;if(\"west\"in o)b=o.west<d&&o.east>s&&o.south<m&&o.north>c;else{if(r&&!wn.IDENTITY.equals(r)){let[k,V,q,K]=UI([o.left,o.top,o.right,o.bottom],r);o={left:k,top:V,right:q,bottom:K}}let C=Math.min(o.top,o.bottom),B=Math.max(o.top,o.bottom);b=o.left<d&&o.right>s&&C<m&&B>c}if(b)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:o,modelMatrixInverse:s}){let{tileSize:c,extent:d,zoomOffset:m}=this.opts;return Jk({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:c,extent:d,modelMatrix:o,modelMatrixInverse:s,zoomOffset:m})}getTileId(e){return`${e.x}-${e.y}-${e.z}`}getTileZoom(e){return e.z}getTileMetadata(e){let{tileSize:n}=this.opts;return{bbox:Kk(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){let n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){let e=this.opts.refinementStrategy||z3,n=new Array(this._cache.size),r=0;for(let i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(let i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e==\"function\"?e:fSe[e])(Array.from(this._cache.values())),r=0;for(let i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){let{maxRequests:e=0}=this.opts,n=[],r=0;for(let i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){let{_cache:e}=this;for(let n of e.values())n.parent=null,n.children&&(n.children.length=0);for(let n of e.values()){let r=this._getNearestAncestor(n);n.parent=r,r?.children&&r.children.push(n)}}_resizeCache(){let{_cache:e,opts:n}=this,r=n.maxCacheSize??(n.maxCacheByteSize!==null?1/0:hSe*this.selectedTiles.length),i=n.maxCacheByteSize??1/0;if(e.size>r||this._cacheByteSize>i){for(let[s,c]of e)if(!c.isVisible&&!c.isSelected&&(this._cacheByteSize-=n.maxCacheByteSize!==null?c.byteLength:0,e.delete(s),this.opts.onTileUnload?.(c)),e.size<=r&&this._cacheByteSize<=i)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((s,c)=>s.zoom-c.zoom),this._dirty=!1)}_getTile(e,n){let r=this.getTileId(e),i=this._cache.get(r),o=!1;return!i&&n?(i=new LI(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),o=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(o=!0),i&&o&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){let{_minZoom:n=0}=this,r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);let i=this._getTile(r);if(i)return i}return null}};function pSe(t){for(let e of t)e.state=0;for(let e of t)e.isSelected&&!zne(e)&&tN(e);for(let e of t)e.isVisible=!!(e.state&VI)}function ASe(t){for(let n of t)n.state=0;for(let n of t)n.isSelected&&zne(n);let e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(let n of e)if(n.isVisible=!!(n.state&VI),n.children&&(n.isVisible||n.state&Nne))for(let r of n.children)r.state=Nne;else n.isSelected&&tN(n)}function zne(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=VI,!0;e=e.parent}return!1}function tN(t){for(let e of t.children)e.isLoaded||e.content?e.state|=VI:tN(e)}var gSe={TilesetClass:p2,data:{type:\"data\",value:[]},dataComparator:qA.equal,renderSubLayers:{type:\"function\",value:t=>new Vp(t)},getTileData:{type:\"function\",optional:!0,value:null},onViewportLoad:{type:\"function\",optional:!0,value:null},onTileLoad:{type:\"function\",value:t=>{}},onTileUnload:{type:\"function\",value:t=>{}},onTileError:{type:\"function\",value:t=>console.error(t)},extent:{type:\"array\",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:z3,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0},U3=class extends xs{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){this.state?.tileset?.finalize()}get isLoaded(){return!!this.state?.tileset?.selectedTiles?.every(e=>e.isLoaded&&e.layers&&e.layers.every(n=>n.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state,r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():n.tiles.forEach(o=>{o.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){let{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:o,maxZoom:s,minZoom:c,maxRequests:d,debounceTime:m,zoomOffset:b}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:s,minZoom:c,tileSize:e,refinementStrategy:i,extent:o,maxRequests:d,debounceTime:m,zoomOffset:b,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){let e=this.state.tileset,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:o}=e,s=this.state.isLoaded!==o,c=this.state.frameNumber!==i;o&&(s||c)&&this._onViewportLoad(),c&&this.setState({frameNumber:i}),this.state.isLoaded=o}_onViewportLoad(){let{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){let{data:n,getTileData:r,fetch:i}=this.props,{signal:o}=e;return e.url=typeof n==\"string\"||Array.isArray(n)?QA(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:\"data\",layer:this,signal:o}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo(e){let n=e.sourceLayer,r=n.props.tile,i=e.info;return i.picked&&(i.tile=r),i.sourceTile=r,i.sourceTileSubLayer=n,i}_updateAutoHighlight(e){e.sourceTileSubLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{let n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{let r=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=kp(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){let{tile:r}=e.props,{modelMatrix:i}=this.props;return this.state.tileset.isTileVisible(r,n,i?new wn(i):null)}};U3.defaultProps=gSe;U3.layerName=\"TileLayer\";var th=U3;var Une=`uniform tripsUniforms {\n  bool fadeTrail;\n  float trailLength;\n  float currentTime;\n} trips;\n`,Vne={name:\"trips\",vs:Une,fs:Une,uniformTypes:{fadeTrail:\"f32\",trailLength:\"f32\",currentTime:\"f32\"}};var mSe={fadeTrail:!0,trailLength:{type:\"number\",value:120,min:0},currentTime:{type:\"number\",value:0,min:0},getTimestamps:{type:\"accessor\",value:t=>t.timestamps}},V3=class extends eh{getShaders(){let e=super.getShaders();return e.inject={\"vs:#decl\":`in float instanceTimestamps;\nin float instanceNextTimestamps;\nout float vTime;\n`,\"vs:#main-end\":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n`,\"fs:#decl\":`in float vTime;\n`,\"fs:#main-start\":`if(vTime > trips.currentTime || (trips.fadeTrail && (vTime < trips.currentTime - trips.trailLength))) {\n  discard;\n}\n`,\"fs:DECKGL_FILTER_COLOR\":`if(trips.fadeTrail) {\n  color.a *= 1.0 - (trips.currentTime - vTime) / trips.trailLength;\n}\n`},e.modules=[...e.modules,Vne],e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:\"getTimestamps\",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){let{fadeTrail:n,trailLength:r,currentTime:i}=this.props,o={fadeTrail:n,trailLength:r,currentTime:i};this.state.model.shaderInputs.setProps({trips:o}),super.draw(e)}};V3.layerName=\"TripsLayer\";V3.defaultProps=mSe;var GI=V3;var _Se=10;function ySe(t,e){let n;return t==null?n=e:typeof t==\"object\"?n={...t,coverage:e}:n={getHexagon:t,coverage:e},n}var xSe={...ud.defaultProps,highPrecision:\"auto\",coverage:{type:\"number\",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:\"accessor\",value:t=>t.hexagon},extruded:!0},A2=class t extends xs{initializeState(){t._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:e}){return this._shouldUseHighPrecision()?e.propsOrDataChanged:e.somethingChanged}updateState({props:e,changeFlags:n}){if(e.highPrecision!==!0&&(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagon)){let r=this._calculateH3DataProps();this.setState(r)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let e=-1,n=!1,r=!1,{iterable:i,objectInfo:o}=ys(this.props.data);for(let s of i){o.index++;let c=this.props.getHexagon(s,o),d=ine(c);if(e<0){if(e=d,!this.props.highPrecision)break}else if(e!==d){r=!0;break}if(rne(c)){n=!0;break}}return{resolution:e,edgeLengthKM:e>=0?cne(e,\"km\"):0,hasMultipleRes:r,hasPentagon:n}}_shouldUseHighPrecision(){if(this.props.highPrecision===\"auto\"){let{resolution:e,hasPentagon:n,hasMultipleRes:r}=this.state,{viewport:i}=this.context;return!!i?.resolution||r||n||e>=0&&e<=5}return this.props.highPrecision}_updateVertices(e){if(this._shouldUseHighPrecision())return;let{resolution:n,edgeLengthKM:r,centerHex:i}=this.state;if(n<0)return;let o=this.props.centerHexagon||one(e.latitude,e.longitude,n);if(i===o)return;if(i)try{if(lne(i,o)*r<_Se)return}catch{}let{unitsPerMeter:s}=e.distanceScales,c=Gk(o),[d,m]=D3(o),[b,C]=e.projectFlat([m,d]);c=c.map(B=>{let k=e.projectFlat(B);return[(k[0]-b)/s[0],(k[1]-C)/s[1]]}),this.setState({centerHex:o,vertices:c})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){let{elevationScale:e,material:n,coverage:r,extruded:i,wireframe:o,stroked:s,filled:c,lineWidthUnits:d,lineWidthScale:m,lineWidthMinPixels:b,lineWidthMaxPixels:C,getFillColor:B,getElevation:k,getLineColor:V,getLineWidth:q,transitions:K,updateTriggers:Y}=this.props;return{elevationScale:e,extruded:i,coverage:r,wireframe:o,stroked:s,filled:c,lineWidthUnits:d,lineWidthScale:m,lineWidthMinPixels:b,lineWidthMaxPixels:C,material:n,getElevation:k,getFillColor:B,getLineColor:V,getLineWidth:q,transitions:K,updateTriggers:{getFillColor:Y.getFillColor,getElevation:Y.getElevation,getLineColor:Y.getLineColor,getLineWidth:Y.getLineWidth}}}_renderPolygonLayer(){let{data:e,getHexagon:n,updateTriggers:r,coverage:i}=this.props,o=this.getSubLayerClass(\"hexagon-cell-hifi\",ud),s=this._getForwardProps();return s.updateTriggers.getPolygon=ySe(r.getHexagon,i),new o(s,this.getSubLayerProps({id:\"hexagon-cell-hifi\",updateTriggers:s.updateTriggers}),{data:e,_normalize:!1,_windingOrder:\"CCW\",positionFormat:\"XY\",getPolygon:(c,d)=>{let m=n(c,d);return hne(Gk(m,i))}})}_renderColumnLayer(){let{data:e,getHexagon:n,updateTriggers:r}=this.props,i=this.getSubLayerClass(\"hexagon-cell\",$u),o=this._getForwardProps();return o.updateTriggers.getPosition=r.getHexagon,new i(o,this.getSubLayerProps({id:\"hexagon-cell\",flatShading:!0,updateTriggers:o.updateTriggers}),{data:e,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:une.bind(null,n)})}};A2.defaultProps=xSe;A2.layerName=\"H3HexagonLayer\";A2._checkH3Lib=()=>{};var g2=A2;var vSe={getHexagons:{type:\"accessor\",value:t=>t.hexagons}},G3=class extends XA{initializeState(){g2._checkH3Lib()}updateState({props:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagons){let{data:r,getHexagons:i}=e,o=[],{iterable:s,objectInfo:c}=ys(r);for(let d of s){c.index++;let m=i(d,c),b=ane(m,!0);for(let C of b){for(let B of C)PI(B);o.push(this.getSubLayerRow({polygon:C},d,c.index))}}this.setState({polygons:o})}}indexToBounds(){let{getElevation:e,getFillColor:n,getLineColor:r,getLineWidth:i}=this.props;return{data:this.state.polygons,getPolygon:o=>o.polygon,getElevation:this.getSubLayerAccessor(e),getFillColor:this.getSubLayerAccessor(n),getLineColor:this.getSubLayerAccessor(r),getLineWidth:this.getSubLayerAccessor(i)}}};G3.layerName=\"H3ClusterLayer\";G3.defaultProps=vSe;var HI=G3;lr();var nN=Math.PI/180,WI=new Float32Array(16),Gne=new Float32Array(12);function Hne(t,e,n){let r=e[0]*nN,i=e[1]*nN,o=e[2]*nN,s=Math.sin(o),c=Math.sin(r),d=Math.sin(i),m=Math.cos(o),b=Math.cos(r),C=Math.cos(i),B=n[0],k=n[1],V=n[2];t[0]=B*C*b,t[1]=B*d*b,t[2]=B*-c,t[3]=k*(-d*m+C*c*s),t[4]=k*(C*m+d*c*s),t[5]=k*b*s,t[6]=V*(d*s+C*c*m),t[7]=V*(-C*s+d*c*m),t[8]=V*b*m}function Wne(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}var jI={size:12,accessor:[\"getOrientation\",\"getScale\",\"getTranslation\",\"getTransformMatrix\"],shaderAttributes:{instanceModelMatrixCol0:{size:3,elementOffset:0},instanceModelMatrixCol1:{size:3,elementOffset:3},instanceModelMatrixCol2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){let{data:r,getOrientation:i,getScale:o,getTranslation:s,getTransformMatrix:c}=this.props,d=Array.isArray(c),m=d&&c.length===16,b=Array.isArray(o),C=Array.isArray(i),B=Array.isArray(s),k=m||!d&&!!c(r[0]);k?t.constant=m:t.constant=C&&b&&B;let V=t.value;if(t.constant){let q;k?(WI.set(c),q=Wne(WI)):(q=Gne,Hne(q,i,o),q.set(s,9)),t.value=new Float32Array(q)}else{let q=e*t.size,{iterable:K,objectInfo:Y}=ys(r,e,n);for(let ee of K){Y.index++;let J;if(k)WI.set(m?c:c(ee,Y)),J=Wne(WI);else{J=Gne;let se=C?i:i(ee,Y),xe=b?o:o(ee,Y);Hne(J,se,xe),J.set(B?s:s(ee,Y),9)}V[q++]=J[0],V[q++]=J[1],V[q++]=J[2],V[q++]=J[3],V[q++]=J[4],V[q++]=J[5],V[q++]=J[6],V[q++]=J[7],V[q++]=J[8],V[q++]=J[9],V[q++]=J[10],V[q++]=J[11]}}}};function XI(t,e){return e===Cn.CARTESIAN||e===Cn.METER_OFFSETS||e===Cn.DEFAULT&&!t.isGeospatial}var jne=`uniform simpleMeshUniforms {\n  float sizeScale;\n  bool composeModelMatrix;\n  bool hasTexture;\n  bool flatShading;\n} simpleMesh;\n`,Xne={name:\"simpleMesh\",vs:jne,fs:jne,uniformTypes:{sizeScale:\"f32\",composeModelMatrix:\"f32\",hasTexture:\"f32\",flatShading:\"f32\"}};var Yne=`#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin vec3 instanceModelMatrixCol0;\nin vec3 instanceModelMatrixCol1;\nin vec3 instanceModelMatrixCol2;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = texCoords;\ngeometry.pickingColor = instancePickingColors;\nvTexCoord = texCoords;\ncameraPosition = project.cameraPosition;\nvColor = vec4(colors * instanceColors.rgb, instanceColors.a);\nmat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);\nvec3 pos = (instanceModelMatrix * positions) * simpleMesh.sizeScale + instanceTranslation;\nif (simpleMesh.composeModelMatrix) {\nDECKGL_FILTER_SIZE(pos, geometry);\nnormals_commonspace = project_normal(instanceModelMatrix * normals);\ngeometry.worldPosition += pos;\ngl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\ngeometry.position = position_commonspace;\n}\nelse {\npos = project_size(pos);\nDECKGL_FILTER_SIZE(pos, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\ngeometry.position = position_commonspace;\nnormals_commonspace = project_normal(instanceModelMatrix * normals);\n}\ngeometry.normal = normals_commonspace;\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var Zne=`#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\nprecision highp float;\nuniform sampler2D sampler;\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = vTexCoord;\nvec3 normal;\nif (simpleMesh.flatShading) {\nnormal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n} else {\nnormal = normals_commonspace;\n}\nvec4 color = simpleMesh.hasTexture ? texture(sampler, vTexCoord) : vColor;\nDECKGL_FILTER_COLOR(color, geometry);\nvec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\nfragColor = vec4(lightColor, color.a * layer.opacity);\n}\n`;function rN(t){let e=t.positions||t.POSITION;hn.assert(e,'no \"postions\" or \"POSITION\" attribute in mesh');let n=e.value.length/e.size,r=t.COLOR_0||t.colors;r||(r={size:3,value:new Float32Array(n*3).fill(1)});let i=t.NORMAL||t.normals;i||(i={size:3,value:new Float32Array(n*3).fill(0)});let o=t.TEXCOORD_0||t.texCoords;return o||(o={size:2,value:new Float32Array(n*2).fill(0)}),{positions:e,colors:r,normals:i,texCoords:o}}function qne(t){return t instanceof gi?(t.attributes=rN(t.attributes),t):t.attributes?new gi({...t,topology:\"triangle-list\",attributes:rN(t.attributes)}):new gi({topology:\"triangle-list\",attributes:rN(t)})}var bSe=[0,0,0,255],wSe={mesh:{type:\"object\",value:null,async:!0},texture:{type:\"image\",value:null,async:!0},sizeScale:{type:\"number\",value:1,min:0},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:\"accessor\",value:t=>t.position},getColor:{type:\"accessor\",value:bSe},getOrientation:{type:\"accessor\",value:[0,0,0]},getScale:{type:\"accessor\",value:[1,1,1]},getTranslation:{type:\"accessor\",value:[0,0,0]},getTransformMatrix:{type:\"accessor\",value:[]},textureParameters:{type:\"object\",ignore:!0,value:null}},H3=class extends hi{getShaders(){return super.getShaders({vs:Yne,fs:Zne,modules:[Lr,Vm,$i,Xne]})}getBounds(){if(this.props._instanced)return super.getBounds();let e=this.state.positionBounds;if(e)return e;let{mesh:n}=this.props;if(!n)return null;if(e=n.header?.boundingBox,!e){let{attributes:r}=qne(n);r.POSITION=r.POSITION||r.positions,e=wp(r)}return this.state.positionBounds=e,e}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:\"float64\",fp64:this.use64bitPositions(),size:3,accessor:\"getPosition\"},instanceColors:{type:\"unorm8\",transition:!0,size:this.props.colorFormat.length,accessor:\"getColor\",defaultValue:[0,0,0,255]},instanceModelMatrix:jI}),this.setState({emptyTexture:this.context.device.createTexture({data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);let{props:n,oldProps:r,changeFlags:i}=e;if(n.mesh!==r.mesh||i.extensionsChanged){if(this.state.positionBounds=null,this.state.model?.destroy(),n.mesh){this.state.model=this.getModel(n.mesh);let o=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&n.texture instanceof jo&&this.setTexture(n.texture),this.state.model&&this.state.model.setTopology(this.props.wireframe?\"line-strip\":\"triangle-list\")}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){let{model:n}=this.state;if(!n)return;let{viewport:r,renderPass:i}=this.context,{sizeScale:o,coordinateSystem:s,_instanced:c}=this.props,d={sizeScale:o,composeModelMatrix:!c||XI(r,s),flatShading:!this.state.hasNormals};n.shaderInputs.setProps({simpleMesh:d}),n.draw(i)}get isLoaded(){return!!(this.state?.model&&super.isLoaded)}getModel(e){let n=new gr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:qne(e),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state,o={sampler:r||i,hasTexture:!!r};return n.shaderInputs.setProps({simpleMesh:o}),n}setTexture(e){let{emptyTexture:n,model:r}=this.state;if(r){let i={sampler:e||n,hasTexture:!!e};r.shaderInputs.setProps({simpleMesh:i})}}};H3.defaultProps=wSe;H3.layerName=\"SimpleMeshLayer\";var jp=H3;var Qne=\"4.3.3\";var YI={TRANSCODER:\"basis_transcoder.js\",TRANSCODER_WASM:\"basis_transcoder.wasm\",ENCODER:\"basis_encoder.js\",ENCODER_WASM:\"basis_encoder.wasm\"},Kne;async function oN(t){FL(t.modules);let e=kL(\"basis\");return e||(Kne||=TSe(t),await Kne)}async function TSe(t){let e=null,n=null;return[e,n]=await Promise.all([await Xf(YI.TRANSCODER,\"textures\",t),await Xf(YI.TRANSCODER_WASM,\"textures\",t)]),e=e||globalThis.BASIS,await ESe(e,n)}function ESe(t,e){let n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(i=>{let{BasisFile:o,initializeBasis:s}=i;s(),r({BasisFile:o})})})}var iN;async function sN(t){let e=t.modules||{};return e.basisEncoder?e.basisEncoder:(iN=iN||SSe(t),await iN)}async function SSe(t){let e=null,n=null;return[e,n]=await Promise.all([await Xf(YI.ENCODER,\"textures\",t),await Xf(YI.ENCODER_WASM,\"textures\",t)]),e=e||globalThis.BASIS,await CSe(e,n)}function CSe(t,e){let n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(i=>{let{BasisFile:o,KTX2File:s,initializeBasis:c,BasisEncoder:d}=i;c(),r({BasisFile:o,KTX2File:s,BasisEncoder:d})})})}var a_={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919};var MSe=[\"\",\"WEBKIT_\",\"MOZ_\"],Jne={WEBGL_compressed_texture_s3tc:\"dxt\",WEBGL_compressed_texture_s3tc_srgb:\"dxt-srgb\",WEBGL_compressed_texture_etc1:\"etc1\",WEBGL_compressed_texture_etc:\"etc2\",WEBGL_compressed_texture_pvrtc:\"pvrtc\",WEBGL_compressed_texture_atc:\"atc\",WEBGL_compressed_texture_astc:\"astc\",EXT_texture_compression_rgtc:\"rgtc\"},ZI=null;function $ne(t){if(!ZI){t=t||ISe()||void 0,ZI=new Set;for(let e of MSe)for(let n in Jne)if(t&&t.getExtension(`${e}${n}`)){let r=Jne[n];ZI.add(r)}}return ZI}function ISe(){try{return document.createElement(\"canvas\").getContext(\"webgl\")}catch{return null}}var uu=[171,75,84,88,32,50,48,187,13,10,26,10];function ere(t){let e=new Uint8Array(t);return!(e.byteLength<uu.length||e[0]!==uu[0]||e[1]!==uu[1]||e[2]!==uu[2]||e[3]!==uu[3]||e[4]!==uu[4]||e[5]!==uu[5]||e[6]!==uu[6]||e[7]!==uu[7]||e[8]!==uu[8]||e[9]!==uu[9]||e[10]!==uu[10]||e[11]!==uu[11])}var PSe={etc1:{basisFormat:0,compressed:!0,format:a_.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:a_.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:a_.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},\"bc7-m6-opaque-only\":{basisFormat:6,compressed:!0},\"bc7-m5\":{basisFormat:7,compressed:!0},\"pvrtc1-4-rgb\":{basisFormat:8,compressed:!0,format:a_.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},\"pvrtc1-4-rgba\":{basisFormat:9,compressed:!0,format:a_.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},\"astc-4x4\":{basisFormat:10,compressed:!0,format:a_.COMPRESSED_RGBA_ASTC_4X4_KHR},\"atc-rgb\":{basisFormat:11,compressed:!0},\"atc-rgba-interpolated-alpha\":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function nre(t,e){if(e.basis.containerFormat===\"auto\"){if(ere(t)){let r=await sN(e);return tre(r.KTX2File,t,e)}let{BasisFile:n}=await oN(e);return aN(n,t,e)}switch(e.basis.module){case\"encoder\":let n=await sN(e);switch(e.basis.containerFormat){case\"ktx2\":return tre(n.KTX2File,t,e);case\"basis\":default:return aN(n.BasisFile,t,e)}case\"transcoder\":default:let{BasisFile:r}=await oN(e);return aN(r,t,e)}}function aN(t,e,n){let r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error(\"Failed to start basis transcoding\");let i=r.getNumImages(),o=[];for(let s=0;s<i;s++){let c=r.getNumLevels(s),d=[];for(let m=0;m<c;m++)d.push(RSe(r,s,m,n));o.push(d)}return o}finally{r.close(),r.delete()}}function RSe(t,e,n,r){let i=t.getImageWidth(e,n),o=t.getImageHeight(e,n),s=t.getHasAlpha(),{compressed:c,format:d,basisFormat:m}=rre(r,s),b=t.getImageTranscodedSizeInBytes(e,n,m),C=new Uint8Array(b);if(!t.transcodeImage(C,e,n,m,0,0))throw new Error(\"failed to start Basis transcoding\");return{width:i,height:o,data:C,compressed:c,format:d,hasAlpha:s}}function tre(t,e,n){let r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error(\"failed to start KTX2 transcoding\");let i=r.getLevels(),o=[];for(let s=0;s<i;s++)o.push(BSe(r,s,n));return[o]}finally{r.close(),r.delete()}}function BSe(t,e,n){let{alphaFlag:r,height:i,width:o}=t.getImageLevelInfo(e,0,0),{compressed:s,format:c,basisFormat:d}=rre(n,r),m=t.getImageTranscodedSizeInBytes(e,0,0,d),b=new Uint8Array(m);if(!t.transcodeImage(b,e,0,0,d,0,-1,-1))throw new Error(\"Failed to transcode KTX2 image\");return{width:o,height:i,data:b,compressed:s,levelSize:m,hasAlpha:r,format:c}}function rre(t,e){let n=t&&t.basis&&t.basis.format;return n===\"auto\"&&(n=qI()),typeof n==\"object\"&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),PSe[n]}function qI(){let t=$ne();return t.has(\"astc\")?\"astc-4x4\":t.has(\"dxt\")?{alpha:\"bc3\",noAlpha:\"bc1\"}:t.has(\"pvrtc\")?{alpha:\"pvrtc1-4-rgba\",noAlpha:\"pvrtc1-4-rgb\"}:t.has(\"etc1\")?\"etc1\":t.has(\"etc2\")?\"etc2\":\"rgb565\"}var ire={dataType:null,batchType:null,name:\"Basis\",id:\"basis\",module:\"textures\",version:Qne,worker:!0,extensions:[\"basis\",\"ktx2\"],mimeTypes:[\"application/octet-stream\",\"image/ktx2\"],tests:[\"sB\"],binary:!0,options:{basis:{format:\"auto\",libraryPath:\"libs/\",containerFormat:\"auto\",module:\"transcoder\"}}},lN={...ire,parse:nre};lr();function sre(t){return{addressModeU:ore(t.wrapS),addressModeV:ore(t.wrapT),magFilter:DSe(t.magFilter),...LSe(t.minFilter)}}function ore(t){switch(t){case 33071:return\"clamp-to-edge\";case 10497:return\"repeat\";case 33648:return\"mirror-repeat\";default:return}}function DSe(t){switch(t){case 9728:return\"nearest\";case 9729:return\"linear\";default:return}}function LSe(t){switch(t){case 9728:return{minFilter:\"nearest\"};case 9729:return{minFilter:\"linear\"};case 9984:return{minFilter:\"nearest\",mipmapFilter:\"nearest\"};case 9985:return{minFilter:\"linear\",mipmapFilter:\"nearest\"};case 9986:return{minFilter:\"nearest\",mipmapFilter:\"linear\"};case 9987:return{minFilter:\"linear\",mipmapFilter:\"linear\"};default:return{}}}function j3(t,e,n,r){let i={defines:{MANUAL_SRGB:!0,SRGB_FAST_APPROXIMATION:!0},bindings:{},uniforms:{camera:[0,0,0],metallicRoughnessValues:[1,1]},parameters:{},glParameters:{},generatedTextures:[]};i.defines.USE_TEX_LOD=!0;let{imageBasedLightingEnvironment:o}=r;return o&&(i.bindings.pbr_diffuseEnvSampler=o.diffuseEnvSampler.texture,i.bindings.pbr_specularEnvSampler=o.specularEnvSampler.texture,i.bindings.pbr_BrdfLUT=o.brdfLutTexture.texture,i.uniforms.scaleIBLAmbient=[1,1]),r?.pbrDebug&&(i.defines.PBR_DEBUG=!0,i.uniforms.scaleDiffBaseMR=[0,0,0,0],i.uniforms.scaleFGDSpec=[0,0,0,0]),n.NORMAL&&(i.defines.HAS_NORMALS=!0),n.TANGENT&&r?.useTangents&&(i.defines.HAS_TANGENTS=!0),n.TEXCOORD_0&&(i.defines.HAS_UV=!0),r?.imageBasedLightingEnvironment&&(i.defines.USE_IBL=!0),r?.lights&&(i.defines.USE_LIGHTS=!0),e&&OSe(t,e,i),i}function OSe(t,e,n){if(n.uniforms.unlit=!!e.unlit,e.pbrMetallicRoughness&&FSe(t,e.pbrMetallicRoughness,n),e.normalTexture){W3(t,e.normalTexture,\"pbr_normalSampler\",\"HAS_NORMALMAP\",n);let{scale:r=1}=e.normalTexture;n.uniforms.normalScale=r}if(e.occlusionTexture){W3(t,e.occlusionTexture,\"pbr_occlusionSampler\",\"HAS_OCCLUSIONMAP\",n);let{strength:r=1}=e.occlusionTexture;n.uniforms.occlusionStrength=r}switch(e.emissiveTexture&&(W3(t,e.emissiveTexture,\"pbr_emissiveSampler\",\"HAS_EMISSIVEMAP\",n),n.uniforms.emissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode||\"MASK\"){case\"MASK\":let{alphaCutoff:r=.5}=e;n.defines.ALPHA_CUTOFF=!0,n.uniforms.alphaCutoff=r;break;case\"BLEND\":St.warn(\"glTF BLEND alphaMode might not work well because it requires mesh sorting\")(),n.parameters.blend=!0,n.parameters.blendColorOperation=\"add\",n.parameters.blendColorSrcFactor=\"src-alpha\",n.parameters.blendColorDstFactor=\"one-minus-src-alpha\",n.parameters.blendAlphaOperation=\"add\",n.parameters.blendAlphaSrcFactor=\"one\",n.parameters.blendAlphaDstFactor=\"one-minus-src-alpha\",n.glParameters.blend=!0,n.glParameters.blendEquation=32774,n.glParameters.blendFunc=[770,771,1,771];break}}function FSe(t,e,n){e.baseColorTexture&&W3(t,e.baseColorTexture,\"pbr_baseColorSampler\",\"HAS_BASECOLORMAP\",n),n.uniforms.baseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&W3(t,e.metallicRoughnessTexture,\"pbr_metallicRoughnessSampler\",\"HAS_METALROUGHNESSMAP\",n);let{metallicFactor:r=1,roughnessFactor:i=1}=e;n.uniforms.metallicRoughnessValues=[r,i]}function W3(t,e,n,r,i){let o=e.texture.source.image,s;o.compressed?s=o:s={data:o};let c={wrapS:10497,wrapT:10497,...e?.texture?.sampler},d=t.createTexture({id:e.uniformName||e.id,sampler:sre(c),...s});i.bindings[n]=d,r&&(i.defines[r]=!0),i.generatedTextures.push(d)}var l_;(function(t){t[t.POINTS=0]=\"POINTS\",t[t.LINES=1]=\"LINES\",t[t.LINE_LOOP=2]=\"LINE_LOOP\",t[t.LINE_STRIP=3]=\"LINE_STRIP\",t[t.TRIANGLES=4]=\"TRIANGLES\",t[t.TRIANGLE_STRIP=5]=\"TRIANGLE_STRIP\",t[t.TRIANGLE_FAN=6]=\"TRIANGLE_FAN\"})(l_||(l_={}));function are(t){switch(t){case l_.POINTS:return\"point-list\";case l_.LINES:return\"line-list\";case l_.LINE_STRIP:return\"line-strip\";case l_.TRIANGLES:return\"triangle-list\";case l_.TRIANGLE_STRIP:return\"triangle-strip\";default:throw new Error(String(t))}}lr();var kSe=`\nlayout(0) positions: vec4; // in vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    in vec4 normals; // in vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    in vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    // in vec2 TEXCOORD_0;\n    in vec2 texCoords;\n  #endif\n\n@vertex\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = normals;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = texCoords;\n    #endif\n\n    pbr_setPositionNormalTangentUV(positions, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * positions;\n  }\n\n@fragment\n  out vec4 fragmentColor;\n\n  void main(void) {\n    vec3 pos = pbr_vPosition;\n    fragmentColor = pbr_filterColor(vec4(1.0));\n  }\n`,NSe=`#version 300 es\n\n  // in vec4 POSITION;\n  in vec4 positions;\n\n  #ifdef HAS_NORMALS\n    // in vec4 NORMAL;\n    in vec4 normals;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    in vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    // in vec2 TEXCOORD_0;\n    in vec2 texCoords;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = normals;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = texCoords;\n    #endif\n\n    pbr_setPositionNormalTangentUV(positions, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = pbrProjection.modelViewProjectionMatrix * positions;\n  }\n`,zSe=`#version 300 es\n  out vec4 fragmentColor;\n\n  void main(void) {\n    vec3 pos = pbr_vPosition;\n    fragmentColor = pbr_filterColor(vec4(1.0));\n  }\n`;function lre(t,e){let{id:n,geometry:r,parsedPPBRMaterial:i,vertexCount:o,modelOptions:s={}}=e;St.info(4,\"createGLTFModel defines: \",i.defines)();let c=[],d={depthWriteEnabled:!0,depthCompare:\"less\",depthFormat:\"depth24plus\",cullMode:\"back\"},m={id:n,source:kSe,vs:NSe,fs:zSe,geometry:r,topology:r.topology,vertexCount:o,modules:[Gm],...s,defines:{...i.defines,...s.defines},parameters:{...d,...i.parameters,...s.parameters}},b=new gr(t,m),{camera:C,...B}={...i.uniforms,...s.uniforms,...i.bindings,...s.bindings};return b.shaderInputs.setProps({pbrMaterial:B,pbrProjection:{camera:C}}),new OA({managedResources:c,model:b})}var USe={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:void 0,lights:!0,useTangents:!1};function ure(t,e,n={}){let r={...USe,...n};return e.scenes.map(o=>VSe(t,o,e.nodes,r))}function VSe(t,e,n,r){let o=(e.nodes||[]).map(c=>hre(t,c,n,r));return new Op({id:e.name||e.id,children:o})}function hre(t,e,n,r){if(!e._node){let s=(e.children||[]).map(d=>hre(t,d,n,r));e.mesh&&s.push(GSe(t,e.mesh,r));let c=new Op({id:e.name||e.id,children:s});if(e.matrix)c.setMatrix(e.matrix);else{if(c.matrix.identity(),e.translation&&c.matrix.translate(e.translation),e.rotation){let d=new wn().fromQuaternion(e.rotation);c.matrix.multiplyRight(d)}e.scale&&c.matrix.scale(e.scale)}e._node=c}let i=n.find(o=>o.id===e.id);return i._node=e._node,e._node}function GSe(t,e,n){if(!e._mesh){let i=(e.primitives||[]).map((s,c)=>HSe(t,s,c,e,n)),o=new Op({id:e.name||e.id,children:i});e._mesh=o}return e._mesh}function HSe(t,e,n,r,i){let o=e.name||`${r.name||r.id}-primitive-${n}`,s=are(e.mode||4),c=e.indices?e.indices.count:WSe(e.attributes),d=cre(o,e,s),m=j3(t,e.material,d.attributes,i),b=lre(t,{id:o,geometry:cre(o,e,s),parsedPPBRMaterial:m,modelOptions:i.modelOptions,vertexCount:c});return b.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],b}function WSe(t){throw new Error(\"getVertexCount not implemented\")}function cre(t,e,n){let r={};for(let[i,o]of Object.entries(e.attributes)){let{components:s,size:c,value:d}=o;r[i]={size:c??s,value:d}}return new gi({id:t,topology:n,indices:e.indices.value,attributes:r})}lr();lr();var cN=new qu;function fre(t,{input:e,interpolation:n,output:r},i,o){let s=e[e.length-1],c=t%s,d=e.findIndex(B=>B>=c),m=Math.max(0,d-1);if(!Array.isArray(i[o]))switch(o){case\"translation\":i[o]=[0,0,0];break;case\"rotation\":i[o]=[0,0,0,1];break;case\"scale\":i[o]=[1,1,1];break;default:St.warn(`Bad animation path ${o}`)()}let b=e[m],C=e[d];switch(n){case\"STEP\":YSe(i,o,r[m]);break;case\"LINEAR\":if(C>b){let B=(c-b)/(C-b);jSe(i,o,r[m],r[d],B)}break;case\"CUBICSPLINE\":if(C>b){let B=(c-b)/(C-b),k=C-b,V=r[3*m+1],q=r[3*m+2],K=r[3*d+0],Y=r[3*d+1];XSe(i,o,{p0:V,outTangent0:q,inTangent1:K,p1:Y,tDiff:k,ratio:B})}break;default:St.warn(`Interpolation ${n} not supported`)();break}}function jSe(t,e,n,r,i){if(!t[e])throw new Error;if(e===\"rotation\"){cN.slerp({start:n,target:r,ratio:i});for(let o=0;o<cN.length;o++)t[e][o]=cN[o]}else for(let o=0;o<n.length;o++)t[e][o]=i*r[o]+(1-i)*n[o]}function XSe(t,e,{p0:n,outTangent0:r,inTangent1:i,p1:o,tDiff:s,ratio:c}){if(!t[e])throw new Error;for(let d=0;d<t[e].length;d++){let m=r[d]*s,b=i[d]*s;t[e][d]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*n[d]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*m+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[d]+(Math.pow(c,3)-Math.pow(c,2))*b}}function YSe(t,e,n){if(!t[e])throw new Error;for(let r=0;r<n.length;r++)t[e][r]=n[r]}var uN=class{animation;startTime=0;playing=!0;speed=1;constructor(e){this.animation=e.animation,this.animation.name||=\"unnamed\",Object.assign(this,e)}setTime(e){if(!this.playing)return;let r=(e/1e3-this.startTime)*this.speed;this.animation.channels.forEach(({sampler:i,target:o,path:s})=>{fre(r,i,o,s),qSe(o,o._node)})}},QI=class{animations;constructor(e){this.animations=e.animations.map((n,r)=>{let i=n.name||`Animation-${r}`;return new uN({animation:{name:i,channels:n.channels}})})}animate(e){St.warn(\"GLTFAnimator#animate is deprecated. Use GLTFAnimator#setTime instead\")(),this.setTime(e)}setTime(e){this.animations.forEach(n=>n.setTime(e))}getAnimations(){return this.animations}},ZSe=new wn;function qSe(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){let n=ZSe.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}var QSe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},KSe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function dre(t){let e=KSe[t.componentType],n=QSe[t.type],r=n*t.count,{buffer:i,byteOffset:o=0}=t.bufferView?.data??{};return{typedArray:new e(i,o+(t.byteOffset||0),r),components:n}}function Are(t){return(t.animations||[]).map((n,r)=>{let i=n.name||`Animation-${r}`,o=n.samplers.map(({input:c,interpolation:d=\"LINEAR\",output:m})=>({input:pre(t.accessors[c]),interpolation:d,output:pre(t.accessors[m])})),s=n.channels.map(({sampler:c,target:d})=>({sampler:o[c],target:t.nodes[d.node??0],path:d.path}));return{name:i,channels:s}})}function pre(t){if(!t._animation){let{typedArray:e,components:n}=dre(t);if(n===1)t._animation=Array.from(e);else{let r=[];for(let i=0;i<e.length;i+=n)r.push(Array.from(e.slice(i,i+n)));t._animation=r}}return t._animation}function KI(t){if(ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof ImageBitmap)return t;if(Array.isArray(t))return t.map(KI);if(t&&typeof t==\"object\"){let e={};for(let n in t)e[n]=KI(t[n]);return e}return t}function hN(t,e,n){e=KI(e);let r=ure(t,e,n),i=Are(e),o=new QI({animations:i});return{scenes:r,animator:o}}var fN={};Aa(fN,{createExtMeshFeatures:()=>pCe,decode:()=>cCe,encode:()=>uCe,name:()=>lCe});function ta(t,e){if(!t)throw new Error(e||\"assert failed: gltf\")}var JI={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$I={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4};var JSe=1.33,gre=[\"SCALAR\",\"VEC2\",\"VEC3\",\"VEC4\"],$Se=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],eCe=new Map($Se),tCe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},nCe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},rCe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function eP(t){return gre[t-1]||gre[0]}function KA(t){let e=eCe.get(t.constructor);if(!e)throw new Error(\"Illegal typed array\");return e}function m2(t,e){let n=rCe[t.componentType],r=tCe[t.type],i=nCe[t.componentType],o=t.count*r,s=t.count*r*i;ta(s>=0&&s<=e.byteLength);let c=$I[t.componentType],d=JI[t.type];return{ArrayType:n,length:o,byteLength:s,componentByteSize:c,numberOfComponentsInElement:d}}function X3(t){let{images:e,bufferViews:n}=t;e=e||[],n=n||[];let r=e.map(s=>s.bufferView);n=n.filter(s=>!r.includes(s));let i=n.reduce((s,c)=>s+c.byteLength,0),o=e.reduce((s,c)=>{let{width:d,height:m}=c.image;return s+d*m},0);return i+Math.ceil(4*o*JSe)}function mre(t,e,n){let r=t.bufferViews[n];ta(r);let i=r.buffer,o=e[i];ta(o);let s=(r.byteOffset||0)+o.byteOffset;return new Uint8Array(o.arrayBuffer,s,r.byteLength)}function _re(t,e,n){let r=typeof n==\"number\"?t.accessors?.[n]:n;if(!r)throw new Error(`No gltf accessor ${JSON.stringify(n)}`);let i=t.bufferViews?.[r.bufferView||0];if(!i)throw new Error(`No gltf buffer view for accessor ${i}`);let{arrayBuffer:o,byteOffset:s}=e[i.buffer],c=(s||0)+(r.byteOffset||0)+(i.byteOffset||0),{ArrayType:d,length:m,componentByteSize:b,numberOfComponentsInElement:C}=m2(r,i),B=b*C,k=i.byteStride||B;if(typeof i.byteStride>\"u\"||i.byteStride===B)return new d(o,c,m);let V=new d(m);for(let q=0;q<r.count;q++){let K=new d(o,c+q*k,C);V.set(K,q*C)}return V}function iCe(){return{asset:{version:\"2.0\",generator:\"loaders.gl\"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]}}var _i=class{gltf;sourceBuffers;byteLength;constructor(e){this.gltf={json:e?.json||iCe(),buffers:e?.buffers||[],images:e?.images||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}hasExtension(e){let n=this.getUsedExtensions().find(i=>i===e),r=this.getRequiredExtensions().find(i=>i===e);return typeof n==\"string\"||typeof r==\"string\"}getExtension(e){let n=this.getUsedExtensions().find(i=>i===e),r=this.json.extensions||{};return n?r[e]:null}getRequiredExtension(e){return this.getRequiredExtensions().find(r=>r===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,n){return(e.extensions||{})[n]}getScene(e){return this.getObject(\"scenes\",e)}getNode(e){return this.getObject(\"nodes\",e)}getSkin(e){return this.getObject(\"skins\",e)}getMesh(e){return this.getObject(\"meshes\",e)}getMaterial(e){return this.getObject(\"materials\",e)}getAccessor(e){return this.getObject(\"accessors\",e)}getTexture(e){return this.getObject(\"textures\",e)}getSampler(e){return this.getObject(\"samplers\",e)}getImage(e){return this.getObject(\"images\",e)}getBufferView(e){return this.getObject(\"bufferViews\",e)}getBuffer(e){return this.getObject(\"buffers\",e)}getObject(e,n){if(typeof n==\"object\")return n;let r=this.json[e]&&this.json[e][n];if(!r)throw new Error(`glTF file error: Could not find ${e}[${n}]`);return r}getTypedArrayForBufferView(e){e=this.getBufferView(e);let n=e.buffer,r=this.gltf.buffers[n];ta(r);let i=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,i,e.byteLength)}getTypedArrayForAccessor(e){let n=this.getAccessor(e);return _re(this.gltf.json,this.gltf.buffers,n)}getTypedArrayForImageData(e){e=this.getAccessor(e);let n=this.getBufferView(e.bufferView),i=this.getBuffer(n.buffer).data,o=n.byteOffset||0;return new Uint8Array(i,o,n.byteLength)}addApplicationData(e,n){return this.json[e]=n,this}addExtraData(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}addObjectExtension(e,n,r){return e.extensions=e.extensions||{},e.extensions[n]=r,this.registerUsedExtension(n),this}setObjectExtension(e,n,r){let i=e.extensions||{};i[n]=r}removeObjectExtension(e,n){let r=e?.extensions||{};if(r[n]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];let i=this.json.extensionsRemoved;i.includes(n)||i.push(n)}delete r[n]}addExtension(e,n={}){return ta(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}addRequiredExtension(e,n={}){return ta(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===e)||this.json.extensionsRequired.push(e)}removeExtension(e){if(this.json.extensions?.[e]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];let n=this.json.extensionsRemoved;n.includes(e)||n.push(e)}this.json.extensions&&delete this.json.extensions[e],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e)}setDefaultScene(e){this.json.scene=e}addScene(e){let{nodeIndices:n}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(e){let{meshIndex:n,matrix:r}=e;this.json.nodes=this.json.nodes||[];let i={mesh:n};return r&&(i.matrix=r),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(e){let{attributes:n,indices:r,material:i,mode:o=4}=e,c={primitives:[{attributes:this._addAttributes(n),mode:o}]};if(r){let d=this._addIndices(r);c.primitives[0].indices=d}return Number.isFinite(i)&&(c.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(c),this.json.meshes.length-1}addPointCloud(e){let r={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addImage(e,n){let r=Sm(e),i=n||r?.mimeType,s={bufferView:this.addBufferView(e),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(s),this.json.images.length-1}addBufferView(e,n=0,r=this.byteLength){let i=e.byteLength;ta(Number.isFinite(i)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);let o={buffer:n,byteOffset:r,byteLength:i};return this.byteLength+=vA(i,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(o),this.json.bufferViews.length-1}addAccessor(e,n){let r={bufferView:e,type:eP(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(e,n={size:3}){let r=this.addBufferView(e),i={min:n.min,max:n.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(e,n.size));let o={size:n.size,componentType:KA(e),count:Math.round(e.length/n.size),min:i.min,max:i.max};return this.addAccessor(r,Object.assign(o,n))}addTexture(e){let{imageIndex:n}=e,r={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(r),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){let e=this.byteLength,n=new ArrayBuffer(e),r=new Uint8Array(n),i=0;for(let o of this.sourceBuffers||[])i=QL(o,r,i);this.json?.buffers?.[0]?this.json.buffers[0].byteLength=e:this.json.buffers=[{byteLength:e}],this.gltf.binary=n,this.sourceBuffers=[n],this.gltf.buffers=[{arrayBuffer:n,byteOffset:0,byteLength:n.byteLength}]}_removeStringFromArray(e,n){let r=!0;for(;r;){let i=e.indexOf(n);i>-1?e.splice(i,1):r=!1}}_addAttributes(e={}){let n={};for(let r in e){let i=e[r],o=this._getGltfAttributeName(r),s=this.addBinaryBuffer(i.value,i);n[o]=s}return n}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case\"position\":case\"positions\":case\"vertices\":return\"POSITION\";case\"normal\":case\"normals\":return\"NORMAL\";case\"color\":case\"colors\":return\"COLOR_0\";case\"texcoord\":case\"texcoords\":return\"TEXCOORD_0\";default:return e}}_getAccessorMinMax(e,n){let r={min:null,max:null};if(e.length<n)return r;r.min=[],r.max=[];let i=e.subarray(0,n);for(let o of i)r.min.push(o),r.max.push(o);for(let o=n;o<e.length;o+=n)for(let s=0;s<n;s++)r.min[0+s]=Math.min(r.min[0+s],e[o+s]),r.max[0+s]=Math.max(r.max[0+s],e[o+s]);return r}};function yre(t){return(t%1+1)%1}var xre={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},oCe={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},vre={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function Y3(t,e){return vre[e]*xre[t]}function _2(t,e,n,r){if(n!==\"UINT8\"&&n!==\"UINT16\"&&n!==\"UINT32\"&&n!==\"UINT64\")return null;let i=t.getTypedArrayForBufferView(e),o=y2(i,\"SCALAR\",n,r+1);return o instanceof BigInt64Array||o instanceof BigUint64Array?null:o}function y2(t,e,n,r=1){let i=xre[e],o=oCe[n],s=vre[n],c=r*i,d=c*s,m=t.buffer,b=t.byteOffset;return b%s!==0&&(m=new Uint8Array(m).slice(b,b+d).buffer,b=0),new o(m,b,c)}function x2(t,e,n){let r=`TEXCOORD_${e.texCoord||0}`,i=n.attributes[r],o=t.getTypedArrayForAccessor(i),s=t.gltf.json,c=e.index,d=s.textures?.[c]?.source;if(typeof d<\"u\"){let m=s.images?.[d]?.mimeType,b=t.gltf.images?.[d];if(b&&typeof b.width<\"u\"){let C=[];for(let B=0;B<o.length;B+=2){let k=sCe(b,m,o,B,e.channels);C.push(k)}return C}}return[]}function tP(t,e,n,r,i){if(!n?.length)return;let o=[];for(let b of n){let C=r.findIndex(B=>B===b);C===-1&&(C=r.push(b)-1),o.push(C)}let s=new Uint32Array(o),c=t.gltf.buffers.push({arrayBuffer:s.buffer,byteOffset:s.byteOffset,byteLength:s.byteLength})-1,d=t.addBufferView(s,c,0),m=t.addAccessor(d,{size:1,componentType:KA(s),count:s.length});i.attributes[e]=m}function sCe(t,e,n,r,i=[0]){let o={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},s=n[r],c=n[r+1],d=1;e&&(e.indexOf(\"image/jpeg\")!==-1||e.indexOf(\"image/png\")!==-1)&&(d=4);let m=aCe(s,c,t,d),b=0;for(let C of i){let B=typeof C==\"number\"?Object.values(o)[C]:o[C],k=m+B.offset,V=cb(t);if(V.data.length<=k)throw new Error(`${V.data.length} <= ${k}`);let q=V.data[k];b|=q<<B.shift}return b}function aCe(t,e,n,r=1){let i=n.width,o=yre(t)*(i-1),s=Math.round(o),c=n.height,d=yre(e)*(c-1),m=Math.round(d),b=n.components?n.components:r;return(m*i+s)*b}function nP(t,e,n,r,i){let o=[];for(let s=0;s<e;s++){let c=n[s],d=n[s+1]-n[s];if(d+c>r)break;let m=c/i,b=d/i;o.push(t.slice(m,m+b))}return o}function rP(t,e,n){let r=[];for(let i=0;i<e;i++){let o=i*n;r.push(t.slice(o,o+n))}return r}function iP(t,e,n,r){if(n)throw new Error(\"Not implemented - arrayOffsets for strings is specified\");if(r){let i=[],o=new TextDecoder(\"utf8\"),s=0;for(let c=0;c<t;c++){let d=r[c+1]-r[c];if(d+s<=e.length){let m=e.subarray(s,d+s),b=o.decode(m);i.push(b),s+=d}}return i}return[]}var v2=\"EXT_mesh_features\",lCe=v2;async function cCe(t,e){let n=new _i(t);hCe(n,e)}function uCe(t,e){let n=new _i(t);return dCe(n,e),n.createBinaryChunk(),n.gltf}function hCe(t,e){let n=t.gltf.json;if(n.meshes)for(let r of n.meshes)for(let i of r.primitives)fCe(t,i,e)}function fCe(t,e,n){if(!n?.gltf?.loadBuffers)return;let i=e.extensions?.[v2]?.featureIds;if(i)for(let o of i){let s;if(typeof o.attribute<\"u\"){let c=`_FEATURE_ID_${o.attribute}`,d=e.attributes[c];s=t.getTypedArrayForAccessor(d)}else typeof o.texture<\"u\"&&n?.gltf?.loadImages?s=x2(t,o.texture,e):s=[];o.data=s}}function dCe(t,e){let n=t.gltf.json.meshes;if(n)for(let r of n)for(let i of r.primitives)ACe(t,i)}function pCe(t,e,n,r){e.extensions||(e.extensions={});let i=e.extensions[v2];i||(i={featureIds:[]},e.extensions[v2]=i);let{featureIds:o}=i,s={featureCount:n.length,propertyTable:r,data:n};o.push(s),t.addObjectExtension(e,v2,i)}function ACe(t,e){let n=e.extensions?.[v2];if(!n)return;let r=n.featureIds;r.forEach((i,o)=>{if(i.data){let{accessorKey:s,index:c}=gCe(e.attributes),d=new Uint32Array(i.data);r[o]={featureCount:d.length,propertyTable:i.propertyTable,attribute:c},t.gltf.buffers.push({arrayBuffer:d.buffer,byteOffset:d.byteOffset,byteLength:d.byteLength});let m=t.addBufferView(d),b=t.addAccessor(m,{size:1,componentType:KA(d),count:d.length});e.attributes[s]=b}})}function gCe(t){let e=\"_FEATURE_ID_\",n=Object.keys(t).filter(o=>o.indexOf(e)===0),r=-1;for(let o of n){let s=Number(o.substring(e.length));s>r&&(r=s)}return r++,{accessorKey:`${e}${r}`,index:r}}var AN={};Aa(AN,{createExtStructuralMetadata:()=>NCe,decode:()=>_Ce,encode:()=>yCe,name:()=>mCe});var b2=\"EXT_structural_metadata\",mCe=b2;async function _Ce(t,e){let n=new _i(t);xCe(n,e)}function yCe(t,e){let n=new _i(t);return FCe(n,e),n.createBinaryChunk(),n.gltf}function xCe(t,e){if(!e.gltf?.loadBuffers)return;let n=t.getExtension(b2);n&&(e.gltf?.loadImages&&vCe(t,n),bCe(t,n))}function vCe(t,e){let n=e.propertyTextures,r=t.gltf.json;if(n&&r.meshes)for(let i of r.meshes)for(let o of i.primitives)TCe(t,n,o,e)}function bCe(t,e){let n=e.schema;if(!n)return;let r=n.classes,i=e.propertyTables;if(r&&i)for(let o in r){let s=wCe(i,o);s&&SCe(t,n,s)}}function wCe(t,e){for(let n of t)if(n.class===e)return n;return null}function TCe(t,e,n,r){if(!e)return;let o=n.extensions?.[b2]?.propertyTextures;if(o)for(let s of o){let c=e[s];ECe(t,c,n,r)}}function ECe(t,e,n,r){if(!e.properties)return;r.dataAttributeNames||(r.dataAttributeNames=[]);let i=e.class;for(let o in e.properties){let s=`${i}_${o}`,c=e.properties?.[o];if(!c)continue;c.data||(c.data=[]);let d=c.data,m=x2(t,c,n);m!==null&&(tP(t,s,m,d,n),c.data=d,r.dataAttributeNames.push(s))}}function SCe(t,e,n){let r=e.classes?.[n.class];if(!r)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${n.class}`);let i=n.count;for(let o in r.properties){let s=r.properties[o],c=n.properties?.[o];if(c){let d=CCe(t,e,s,i,c);c.data=d}}}function CCe(t,e,n,r,i){let o=[],s=i.values,c=t.getTypedArrayForBufferView(s),d=MCe(t,n,i,r),m=ICe(t,i,r);switch(n.type){case\"SCALAR\":case\"VEC2\":case\"VEC3\":case\"VEC4\":case\"MAT2\":case\"MAT3\":case\"MAT4\":{o=PCe(n,r,c,d);break}case\"BOOLEAN\":throw new Error(`Not implemented - classProperty.type=${n.type}`);case\"STRING\":{o=iP(r,c,d,m);break}case\"ENUM\":{o=RCe(e,n,r,c,d);break}default:throw new Error(`Unknown classProperty type ${n.type}`)}return o}function MCe(t,e,n,r){return e.array&&typeof e.count>\"u\"&&typeof n.arrayOffsets<\"u\"?_2(t,n.arrayOffsets,n.arrayOffsetType||\"UINT32\",r):null}function ICe(t,e,n){return typeof e.stringOffsets<\"u\"?_2(t,e.stringOffsets,e.stringOffsetType||\"UINT32\",n):null}function PCe(t,e,n,r){let i=t.array,o=t.count,s=Y3(t.type,t.componentType),c=n.byteLength/s,d;return t.componentType?d=y2(n,t.type,t.componentType,c):d=n,i?r?nP(d,e,r,n.length,s):o?rP(d,e,o):[]:d}function RCe(t,e,n,r,i){let o=e.enumType;if(!o)throw new Error(\"Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM\");let s=t.enums?.[o];if(!s)throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${o}`);let c=s.valueType||\"UINT16\",d=Y3(e.type,c),m=r.byteLength/d,b=y2(r,e.type,c,m);if(b||(b=r),e.array){if(i)return BCe({valuesData:b,numberOfElements:n,arrayOffsets:i,valuesDataBytesLength:r.length,elementSize:d,enumEntry:s});let C=e.count;return C?DCe(b,n,C,s):[]}return pN(b,0,n,s)}function BCe(t){let{valuesData:e,numberOfElements:n,arrayOffsets:r,valuesDataBytesLength:i,elementSize:o,enumEntry:s}=t,c=[];for(let d=0;d<n;d++){let m=r[d],b=r[d+1]-r[d];if(b+m>i)break;let C=m/o,B=b/o,k=pN(e,C,B,s);c.push(k)}return c}function DCe(t,e,n,r){let i=[];for(let o=0;o<e;o++){let s=n*o,c=pN(t,s,n,r);i.push(c)}return i}function pN(t,e,n,r){let i=[];for(let o=0;o<n;o++)if(t instanceof BigInt64Array||t instanceof BigUint64Array)i.push(\"\");else{let s=t[e+o],c=LCe(r,s);c?i.push(c.name):i.push(\"\")}return i}function LCe(t,e){for(let n of t.values)if(n.value===e)return n;return null}var OCe=\"schemaClassId\";function FCe(t,e){let n=t.getExtension(b2);if(n&&n.propertyTables)for(let r of n.propertyTables){let i=r.class,o=n.schema?.classes?.[i];r.properties&&o&&kCe(r,o,t)}}function kCe(t,e,n){for(let r in t.properties){let i=t.properties[r].data;if(i){let o=e.properties[r];if(o){let s=VCe(i,o,n);t.properties[r]=s}}}}function NCe(t,e,n=OCe){let r=t.getExtension(b2);r||(r=t.addExtension(b2)),r.schema=zCe(e,n,r.schema);let i=UCe(e,n,r.schema);return r.propertyTables||(r.propertyTables=[]),r.propertyTables.push(i)-1}function zCe(t,e,n){let r=n??{id:\"schema_id\"},i={properties:{}};for(let o of t){let s={type:o.elementType,componentType:o.componentType};i.properties[o.name]=s}return r.classes={},r.classes[e]=i,r}function UCe(t,e,n){let r={class:e,count:0},i=0,o=n.classes?.[e];for(let s of t){if(i===0&&(i=s.values.length),i!==s.values.length&&s.values.length)throw new Error(\"Illegal values in attributes\");o?.properties[s.name]&&(r.properties||(r.properties={}),r.properties[s.name]={values:0,data:s.values})}return r.count=i,r}function VCe(t,e,n){let r={values:0};if(e.type===\"STRING\"){let{stringData:i,stringOffsets:o}=WCe(t);r.stringOffsets=dN(o,n),r.values=dN(i,n)}else if(e.type===\"SCALAR\"&&e.componentType){let i=HCe(t,e.componentType);r.values=dN(i,n)}return r}var GCe={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:Int32Array,UINT64:Uint32Array,FLOAT32:Float32Array,FLOAT64:Float64Array};function HCe(t,e){let n=[];for(let i of t)n.push(Number(i));let r=GCe[e];if(!r)throw new Error(\"Illegal component type\");return new r(n)}function WCe(t){let e=new TextEncoder,n=[],r=0;for(let d of t){let m=e.encode(d);r+=m.length,n.push(m)}let i=new Uint8Array(r),o=[],s=0;for(let d of n)i.set(d,s),o.push(s),s+=d.length;o.push(s);let c=new Uint32Array(o);return{stringData:i,stringOffsets:c}}function dN(t,e){return e.gltf.buffers.push({arrayBuffer:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}),e.addBufferView(t)}var gN={};Aa(gN,{decode:()=>XCe,name:()=>jCe});var bre=\"EXT_feature_metadata\",jCe=bre;async function XCe(t,e){let n=new _i(t);YCe(n,e)}function YCe(t,e){if(!e.gltf?.loadBuffers)return;let n=t.getExtension(bre);n&&(e.gltf?.loadImages&&ZCe(t,n),qCe(t,n))}function ZCe(t,e){let n=e.schema;if(!n)return;let r=n.classes,{featureTextures:i}=e;if(r&&i)for(let o in r){let s=r[o],c=KCe(i,o);c&&$Ce(t,c,s)}}function qCe(t,e){let n=e.schema;if(!n)return;let r=n.classes,i=e.featureTables;if(r&&i)for(let o in r){let s=QCe(i,o);s&&JCe(t,n,s)}}function QCe(t,e){for(let n in t){let r=t[n];if(r.class===e)return r}return null}function KCe(t,e){for(let n in t){let r=t[n];if(r.class===e)return r}return null}function JCe(t,e,n){if(!n.class)return;let r=e.classes?.[n.class];if(!r)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${n.class}`);let i=n.count;for(let o in r.properties){let s=r.properties[o],c=n.properties?.[o];if(c){let d=eMe(t,e,s,i,c);c.data=d}}}function $Ce(t,e,n){let r=e.class;for(let i in n.properties){let o=e?.properties?.[i];if(o){let s=oMe(t,o,r);o.data=s}}}function eMe(t,e,n,r,i){let o=[],s=i.bufferView,c=t.getTypedArrayForBufferView(s),d=tMe(t,n,i,r),m=nMe(t,n,i,r);return n.type===\"STRING\"||n.componentType===\"STRING\"?o=iP(r,c,d,m):rMe(n)&&(o=iMe(n,r,c,d)),o}function tMe(t,e,n,r){return e.type===\"ARRAY\"&&typeof e.componentCount>\"u\"&&typeof n.arrayOffsetBufferView<\"u\"?_2(t,n.arrayOffsetBufferView,n.offsetType||\"UINT32\",r):null}function nMe(t,e,n,r){return typeof n.stringOffsetBufferView<\"u\"?_2(t,n.stringOffsetBufferView,n.offsetType||\"UINT32\",r):null}function rMe(t){let e=[\"UINT8\",\"INT16\",\"UINT16\",\"INT32\",\"UINT32\",\"INT64\",\"UINT64\",\"FLOAT32\",\"FLOAT64\"];return e.includes(t.type)||typeof t.componentType<\"u\"&&e.includes(t.componentType)}function iMe(t,e,n,r){let i=t.type===\"ARRAY\",o=t.componentCount,s=\"SCALAR\",c=t.componentType||t.type,d=Y3(s,c),m=n.byteLength/d,b=y2(n,s,c,m);return i?r?nP(b,e,r,n.length,d):o?rP(b,e,o):[]:b}function oMe(t,e,n){let r=t.gltf.json;if(!r.meshes)return[];let i=[];for(let o of r.meshes)for(let s of o.primitives)sMe(t,n,e,i,s);return i}function sMe(t,e,n,r,i){let o={channels:n.channels,...n.texture},s=x2(t,o,i);s&&tP(t,e,s,r,i)}var wre=\"4.3.3\";var w2=!0,Tre=1735152710,yN=12,oP=8,aMe=1313821514,lMe=5130562,cMe=0,uMe=0,hMe=1;function fMe(t,e=0){return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}function Ere(t,e=0,n={}){let r=new DataView(t),{magic:i=Tre}=n,o=r.getUint32(e,!1);return o===i||o===Tre}function Sre(t,e,n=0,r={}){let i=new DataView(e),o=fMe(i,n+0),s=i.getUint32(n+4,w2),c=i.getUint32(n+8,w2);switch(Object.assign(t,{header:{byteOffset:n,byteLength:c,hasBinChunk:!1},type:o,version:s,json:{},binChunks:[]}),n+=yN,t.version){case 1:return dMe(t,i,n);case 2:return pMe(t,i,n,r={});default:throw new Error(`Invalid GLB version ${t.version}. Only supports version 1 and 2.`)}}function dMe(t,e,n){Rr(t.header.byteLength>yN+oP);let r=e.getUint32(n+0,w2),i=e.getUint32(n+4,w2);return n+=oP,Rr(i===cMe),mN(t,e,n,r),n+=r,n+=_N(t,e,n,t.header.byteLength),n}function pMe(t,e,n,r){return Rr(t.header.byteLength>yN+oP),AMe(t,e,n,r),n+t.header.byteLength}function AMe(t,e,n,r){for(;n+8<=t.header.byteLength;){let i=e.getUint32(n+0,w2),o=e.getUint32(n+4,w2);switch(n+=oP,o){case aMe:mN(t,e,n,i);break;case lMe:_N(t,e,n,i);break;case uMe:r.strict||mN(t,e,n,i);break;case hMe:r.strict||_N(t,e,n,i);break;default:break}n+=vA(i,4)}return n}function mN(t,e,n,r){let i=new Uint8Array(e.buffer,n,r),s=new TextDecoder(\"utf8\").decode(i);return t.json=JSON.parse(s),vA(r,4)}function _N(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),vA(r,4)}function xN(t,e){if(t.startsWith(\"data:\")||t.startsWith(\"http:\")||t.startsWith(\"https:\"))return t;let r=e.baseUri||e.uri;if(!r)throw new Error(`'baseUri' must be provided to resolve relative url ${t}`);return r.substr(0,r.lastIndexOf(\"/\")+1)+t}var bN={};Aa(bN,{decode:()=>CMe,name:()=>SMe});var gMe=\"B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB\",mMe=\"B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB\",_Me=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),yMe=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),xMe={0:\"\",1:\"meshopt_decodeFilterOct\",2:\"meshopt_decodeFilterQuat\",3:\"meshopt_decodeFilterExp\",NONE:\"\",OCTAHEDRAL:\"meshopt_decodeFilterOct\",QUATERNION:\"meshopt_decodeFilterQuat\",EXPONENTIAL:\"meshopt_decodeFilterExp\"},vMe={0:\"meshopt_decodeVertexBuffer\",1:\"meshopt_decodeIndexBuffer\",2:\"meshopt_decodeIndexSequence\",ATTRIBUTES:\"meshopt_decodeVertexBuffer\",TRIANGLES:\"meshopt_decodeIndexBuffer\",INDICES:\"meshopt_decodeIndexSequence\"};async function Cre(t,e,n,r,i,o=\"NONE\"){let s=await bMe();EMe(s,s.exports[vMe[i]],t,e,n,r,s.exports[xMe[o||\"NONE\"]])}var vN;async function bMe(){return vN||(vN=wMe()),vN}async function wMe(){let t=gMe;WebAssembly.validate(_Me)&&(t=mMe,console.log(\"Warning: meshopt_decoder is using experimental SIMD support\"));let e=await WebAssembly.instantiate(TMe(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function TMe(t){let e=new Uint8Array(t.length);for(let r=0;r<t.length;++r){let i=t.charCodeAt(r);e[r]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let n=0;for(let r=0;r<t.length;++r)e[n++]=e[r]<60?yMe[e[r]]:(e[r]-60)*64+e[++r];return e.buffer.slice(0,n)}function EMe(t,e,n,r,i,o,s){let c=t.exports.sbrk,d=r+3&-4,m=c(d*i),b=c(o.length),C=new Uint8Array(t.exports.memory.buffer);C.set(o,b);let B=e(m,r,i,b,o.length);if(B===0&&s&&s(m,d,i),n.set(C.subarray(m,m+r*i)),c(m-c(0)),B!==0)throw new Error(`Malformed buffer data: ${B}`)}var sP=\"EXT_meshopt_compression\",SMe=sP;async function CMe(t,e){let n=new _i(t);if(!e?.gltf?.decompressMeshes||!e.gltf?.loadBuffers)return;let r=[];for(let i of t.json.bufferViews||[])r.push(MMe(n,i));await Promise.all(r),n.removeExtension(sP)}async function MMe(t,e){let n=t.getObjectExtension(e,sP);if(n){let{byteOffset:r=0,byteLength:i=0,byteStride:o,count:s,mode:c,filter:d=\"NONE\",buffer:m}=n,b=t.gltf.buffers[m],C=new Uint8Array(b.arrayBuffer,b.byteOffset+r,i),B=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);await Cre(B,s,o,C,c,d),t.removeObjectExtension(e,sP)}}var wN={};Aa(wN,{name:()=>IMe,preprocess:()=>PMe});var T2=\"EXT_texture_webp\",IMe=T2;function PMe(t,e){let n=new _i(t);if(!xO(\"image/webp\")){if(n.getRequiredExtensions().includes(T2))throw new Error(`gltf: Required extension ${T2} not supported by browser`);return}let{json:r}=n;for(let i of r.textures||[]){let o=n.getObjectExtension(i,T2);o&&(i.source=o.source),n.removeObjectExtension(i,T2)}n.removeExtension(T2)}var TN={};Aa(TN,{name:()=>RMe,preprocess:()=>BMe});var aP=\"KHR_texture_basisu\",RMe=aP;function BMe(t,e){let n=new _i(t),{json:r}=n;for(let i of r.textures||[]){let o=n.getObjectExtension(i,aP);o&&(i.source=o.source,n.removeObjectExtension(i,aP))}n.removeExtension(aP)}var IN={};Aa(IN,{decode:()=>ZMe,encode:()=>qMe,name:()=>XMe,preprocess:()=>YMe});var Mre=\"4.3.3\";var Ire={dataType:null,batchType:null,name:\"Draco\",id:\"draco\",module:\"draco\",version:Mre,worker:!0,extensions:[\"drc\"],mimeTypes:[\"application/octet-stream\"],binary:!0,tests:[\"DRACO\"],options:{draco:{decoderType:typeof WebAssembly==\"object\"?\"wasm\":\"js\",libraryPath:\"libs/\",extraAttributes:{},attributeNameEntry:void 0}}};function Rre(t,e,n){let r=Bre(e.metadata),i=[],o=DMe(e.attributes);for(let s in t){let c=t[s],d=Pre(s,c,o[s]);i.push(d)}if(n){let s=Pre(\"indices\",n);i.push(s)}return{fields:i,metadata:r}}function DMe(t){let e={};for(let n in t){let r=t[n];e[r.name||\"undefined\"]=r}return e}function Pre(t,e,n){let r=n?Bre(n.metadata):void 0;return pO(t,e,r)}function Bre(t){Object.entries(t);let e={};for(let n in t)e[`${n}.string`]=JSON.stringify(t[n]);return e}var Dre={POSITION:\"POSITION\",NORMAL:\"NORMAL\",COLOR:\"COLOR_0\",TEX_COORD:\"TEXCOORD_0\"},LMe={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},OMe=4,Z3=class{draco;decoder;metadataQuerier;constructor(e){this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,n={}){let r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);let i=this.decoder.GetEncodedGeometryType(r),o=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let s;switch(i){case this.draco.TRIANGULAR_MESH:s=this.decoder.DecodeBufferToMesh(r,o);break;case this.draco.POINT_CLOUD:s=this.decoder.DecodeBufferToPointCloud(r,o);break;default:throw new Error(\"DRACO: Unknown geometry type.\")}if(!s.ok()||!o.ptr){let B=`DRACO decompression failed: ${s.error_msg()}`;throw new Error(B)}let c=this._getDracoLoaderData(o,i,n),d=this._getMeshData(o,c,n),m=wp(d.attributes),b=Rre(d.attributes,c,d.indices);return{loader:\"draco\",loaderData:c,header:{vertexCount:o.num_points(),boundingBox:m},...d,schema:b}}finally{this.draco.destroy(r),o&&this.draco.destroy(o)}}_getDracoLoaderData(e,n,r){let i=this._getTopLevelMetadata(e),o=this._getDracoAttributes(e,r);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:i,attributes:o}}_getDracoAttributes(e,n){let r={};for(let i=0;i<e.num_attributes();i++){let o=this.decoder.GetAttribute(e,i),s=this._getAttributeMetadata(e,i);r[o.unique_id()]={unique_id:o.unique_id(),attribute_type:o.attribute_type(),data_type:o.data_type(),num_components:o.num_components(),byte_offset:o.byte_offset(),byte_stride:o.byte_stride(),normalized:o.normalized(),attribute_index:i,metadata:s};let c=this._getQuantizationTransform(o,n);c&&(r[o.unique_id()].quantization_transform=c);let d=this._getOctahedronTransform(o,n);d&&(r[o.unique_id()].octahedron_transform=d)}return r}_getMeshData(e,n,r){let i=this._getMeshAttributes(n,e,r);if(!i.POSITION)throw new Error(\"DRACO: No position attribute found.\");if(e instanceof this.draco.Mesh)switch(r.topology){case\"triangle-strip\":return{topology:\"triangle-strip\",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(e),size:1}};case\"triangle-list\":default:return{topology:\"triangle-list\",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:\"point-list\",mode:0,attributes:i}}_getMeshAttributes(e,n,r){let i={};for(let o of Object.values(e.attributes)){let s=this._deduceAttributeName(o,r);o.name=s;let c=this._getAttributeValues(n,o);if(c){let{value:d,size:m}=c;i[s]={value:d,size:m,byteOffset:o.byte_offset,byteStride:o.byte_stride,normalized:o.normalized}}}return i}_getTriangleListIndices(e){let r=e.num_faces()*3,i=r*OMe,o=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(e,i,o),new Uint32Array(this.draco.HEAPF32.buffer,o,r).slice()}finally{this.draco._free(o)}}_getTriangleStripIndices(e){let n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),NMe(n)}finally{this.draco.destroy(n)}}_getAttributeValues(e,n){let r=LMe[n.data_type];if(!r)return console.warn(`DRACO: Unsupported attribute type ${n.data_type}`),null;let i=n.num_components,s=e.num_points()*i,c=s*r.BYTES_PER_ELEMENT,d=FMe(this.draco,r),m,b=this.draco._malloc(c);try{let C=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,C,d,c,b),m=new r(this.draco.HEAPF32.buffer,b,s).slice()}finally{this.draco._free(b)}return{value:m,size:i}}_deduceAttributeName(e,n){let r=e.unique_id;for(let[s,c]of Object.entries(n.extraAttributes||{}))if(c===r)return s;let i=e.attribute_type;for(let s in Dre)if(this.draco[s]===i)return Dre[s];let o=n.attributeNameEntry||\"name\";return e.metadata[o]?e.metadata[o].string:`CUSTOM_ATTRIBUTE_${r}`}_getTopLevelMetadata(e){let n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}_getAttributeMetadata(e,n){let r=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(r)}_getDracoMetadata(e){if(!e||!e.ptr)return{};let n={},r=this.metadataQuerier.NumEntries(e);for(let i=0;i<r;i++){let o=this.metadataQuerier.GetEntryName(e,i);n[o]=this._getDracoMetadataField(e,o)}return n}_getDracoMetadataField(e,n){let r=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,r);let i=kMe(r);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:i}}finally{this.draco.destroy(r)}}_disableAttributeTransforms(e){let{quantizedAttributes:n=[],octahedronAttributes:r=[]}=e,i=[...n,...r];for(let o of i)this.decoder.SkipAttributeTransform(this.draco[o])}_getQuantizationTransform(e,n){let{quantizedAttributes:r=[]}=n,i=e.attribute_type();if(r.map(s=>this.decoder[s]).includes(i)){let s=new this.draco.AttributeQuantizationTransform;try{if(s.InitFromAttribute(e))return{quantization_bits:s.quantization_bits(),range:s.range(),min_values:new Float32Array([1,2,3]).map(c=>s.min_value(c))}}finally{this.draco.destroy(s)}}return null}_getOctahedronTransform(e,n){let{octahedronAttributes:r=[]}=n,i=e.attribute_type();if(r.map(s=>this.decoder[s]).includes(i)){let s=new this.draco.AttributeQuantizationTransform;try{if(s.InitFromAttribute(e))return{quantization_bits:s.quantization_bits()}}finally{this.draco.destroy(s)}}return null}};function FMe(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}function kMe(t){let e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}function NMe(t){let e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}var zMe=\"1.5.6\",UMe=\"1.4.1\",EN=`https://www.gstatic.com/draco/versioned/decoders/${zMe}`,Tc={DECODER:\"draco_wasm_wrapper.js\",DECODER_WASM:\"draco_decoder.wasm\",FALLBACK_DECODER:\"draco_decoder.js\",ENCODER:\"draco_encoder.js\"},SN={[Tc.DECODER]:`${EN}/${Tc.DECODER}`,[Tc.DECODER_WASM]:`${EN}/${Tc.DECODER_WASM}`,[Tc.FALLBACK_DECODER]:`${EN}/${Tc.FALLBACK_DECODER}`,[Tc.ENCODER]:`https://raw.githubusercontent.com/google/draco/${UMe}/javascript/${Tc.ENCODER}`},CN;async function Lre(t){let e=t.modules||{};return e.draco3d?CN||=e.draco3d.createDecoderModule({}).then(n=>({draco:n})):CN||=VMe(t),await CN}async function VMe(t){let e,n;switch(t.draco&&t.draco.decoderType){case\"js\":e=await Xf(SN[Tc.FALLBACK_DECODER],\"draco\",t,Tc.FALLBACK_DECODER);break;case\"wasm\":default:[e,n]=await Promise.all([await Xf(SN[Tc.DECODER],\"draco\",t,Tc.DECODER),await Xf(SN[Tc.DECODER_WASM],\"draco\",t,Tc.DECODER_WASM)])}return e=e||globalThis.DracoDecoderModule,await GMe(e,n)}function GMe(t,e){let n={};return e&&(n.wasmBinary=e),new Promise(r=>{t({...n,onModuleLoaded:i=>r({draco:i})})})}var lP={...Ire,parse:HMe};async function HMe(t,e){let{draco:n}=await Lre(e),r=new Z3(n);try{return r.parseSync(t,e?.draco)}finally{r.destroy()}}function Ore(t){let e={};for(let n in t){let r=t[n];if(n!==\"indices\"){let i=MN(r);e[n]=i}}return e}function MN(t){let{buffer:e,size:n,count:r}=WMe(t);return{value:e,size:n,byteOffset:0,count:r,type:eP(n),componentType:KA(e)}}function WMe(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=jMe(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}function jMe(t,e,n=!1){return t?Array.isArray(t)?new e(t):n&&!(t instanceof e)?new e(t):t:null}var JA=\"KHR_draco_mesh_compression\",XMe=JA;function YMe(t,e,n){let r=new _i(t);for(let i of Fre(r))r.getObjectExtension(i,JA)}async function ZMe(t,e,n){if(!e?.gltf?.decompressMeshes)return;let r=new _i(t),i=[];for(let o of Fre(r))r.getObjectExtension(o,JA)&&i.push(QMe(r,o,e,n));await Promise.all(i),r.removeExtension(JA)}function qMe(t,e={}){let n=new _i(t);for(let r of n.json.meshes||[])KMe(r,e),n.addRequiredExtension(JA)}async function QMe(t,e,n,r){let i=t.getObjectExtension(e,JA);if(!i)return;let o=t.getTypedArrayForBufferView(i.bufferView),s=vm(o.buffer,o.byteOffset),c={...n};delete c[\"3d-tiles\"];let d=await eu(s,lP,c,r),m=Ore(d.attributes);for(let[b,C]of Object.entries(m))if(b in e.attributes){let B=e.attributes[b],k=t.getAccessor(B);k?.min&&k?.max&&(C.min=k.min,C.max=k.max)}e.attributes=m,d.indices&&(e.indices=MN(d.indices)),t.removeObjectExtension(e,JA),JMe(e)}function KMe(t,e,n=4,r,i){if(!r.DracoWriter)throw new Error(\"options.gltf.DracoWriter not provided\");let o=r.DracoWriter.encodeSync({attributes:t}),s=i?.parseSync?.({attributes:t}),c=r._addFauxAttributes(s.attributes),d=r.addBufferView(o);return{primitives:[{attributes:c,mode:n,extensions:{[JA]:{bufferView:d,attributes:c}}}]}}function JMe(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error(\"glTF: Empty primitive detected: Draco decompression failure?\")}function*Fre(t){for(let e of t.json.meshes||[])for(let n of e.primitives)yield n}var PN={};Aa(PN,{decode:()=>n4e,name:()=>$Me});var uP=\"KHR_texture_transform\",$Me=uP,cP=new $e,e4e=new Mi,t4e=new Mi;async function n4e(t,e){if(!new _i(t).hasExtension(uP)||!e.gltf?.loadBuffers)return;let i=t.json.materials||[];for(let o=0;o<i.length;o++)r4e(o,t)}function r4e(t,e){let n=e.json.materials?.[t],r=[n?.pbrMetallicRoughness?.baseColorTexture,n?.emissiveTexture,n?.normalTexture,n?.occlusionTexture,n?.pbrMetallicRoughness?.metallicRoughnessTexture],i=[];for(let o of r)o&&o?.extensions?.[uP]&&i4e(e,t,o,i)}function i4e(t,e,n,r){let i=o4e(n,r);if(!i)return;let o=t.json.meshes||[];for(let s of o)for(let c of s.primitives){let d=c.material;Number.isFinite(d)&&e===d&&s4e(t,c,i)}}function o4e(t,e){let n=t.extensions?.[uP],{texCoord:r=0}=t,{texCoord:i=r}=n;if(!(e.findIndex(([s,c])=>s===r&&c===i)!==-1)){let s=c4e(n);return r!==i&&(t.texCoord=i),e.push([r,i]),{originalTexCoord:r,texCoord:i,matrix:s}}return null}function s4e(t,e,n){let{originalTexCoord:r,texCoord:i,matrix:o}=n,s=e.attributes[`TEXCOORD_${r}`];if(Number.isFinite(s)){let c=t.json.accessors?.[s];if(c&&c.bufferView){let d=t.json.bufferViews?.[c.bufferView];if(d){let{arrayBuffer:m,byteOffset:b}=t.buffers[d.buffer],C=(b||0)+(c.byteOffset||0)+(d.byteOffset||0),{ArrayType:B,length:k}=m2(c,d),V=$I[c.componentType],q=JI[c.type],K=d.byteStride||V*q,Y=new Float32Array(k);for(let ee=0;ee<c.count;ee++){let J=new B(m,C+ee*K,2);cP.set(J[0],J[1],1),cP.transformByMatrix3(o),Y.set([cP[0],cP[1]],ee*q)}r===i?a4e(c,d,t.buffers,Y):l4e(i,c,e,t,Y)}}}}function a4e(t,e,n,r){t.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),e.buffer=n.length-1,e.byteLength=r.buffer.byteLength,e.byteOffset=0,delete e.byteStride}function l4e(t,e,n,r,i){r.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});let o=r.json.bufferViews;if(!o)return;o.push({buffer:r.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});let s=r.json.accessors;s&&(s.push({bufferView:o?.length-1,byteOffset:0,componentType:5126,count:e.count,type:\"VEC2\"}),n.attributes[`TEXCOORD_${t}`]=s.length-1)}function c4e(t){let{offset:e=[0,0],rotation:n=0,scale:r=[1,1]}=t,i=new Mi().set(1,0,0,0,1,0,e[0],e[1],1),o=e4e.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),s=t4e.set(r[0],0,0,0,r[1],0,0,0,1);return i.multiplyRight(o).multiplyRight(s)}var RN={};Aa(RN,{decode:()=>h4e,encode:()=>f4e,name:()=>u4e});var c_=\"KHR_lights_punctual\",u4e=c_;async function h4e(t){let e=new _i(t),{json:n}=e,r=e.getExtension(c_);r&&(e.json.lights=r.lights,e.removeExtension(c_));for(let i of n.nodes||[]){let o=e.getObjectExtension(i,c_);o&&(i.light=o.light),e.removeObjectExtension(i,c_)}}async function f4e(t){let e=new _i(t),{json:n}=e;if(n.lights){let r=e.addExtension(c_);ta(!r.lights),r.lights=n.lights,delete n.lights}if(e.json.lights){for(let r of e.json.lights){let i=r.node;e.addObjectExtension(i,c_,r)}delete e.json.lights}}var BN={};Aa(BN,{decode:()=>p4e,encode:()=>A4e,name:()=>d4e});var q3=\"KHR_materials_unlit\",d4e=q3;async function p4e(t){let e=new _i(t),{json:n}=e;for(let r of n.materials||[])r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),e.removeObjectExtension(r,q3);e.removeExtension(q3)}function A4e(t){let e=new _i(t),{json:n}=e;if(e.materials)for(let r of n.materials||[])r.unlit&&(delete r.unlit,e.addObjectExtension(r,q3,{}),e.addExtension(q3))}var DN={};Aa(DN,{decode:()=>m4e,encode:()=>_4e,name:()=>g4e});var Q3=\"KHR_techniques_webgl\",g4e=Q3;async function m4e(t){let e=new _i(t),{json:n}=e,r=e.getExtension(Q3);if(r){let i=y4e(r,e);for(let o of n.materials||[]){let s=e.getObjectExtension(o,Q3);s&&(o.technique=Object.assign({},s,i[s.technique]),o.technique.values=x4e(o.technique,e)),e.removeObjectExtension(o,Q3)}e.removeExtension(Q3)}}async function _4e(t,e){}function y4e(t,e){let{programs:n=[],shaders:r=[],techniques:i=[]}=t,o=new TextDecoder;return r.forEach(s=>{if(Number.isFinite(s.bufferView))s.code=o.decode(e.getTypedArrayForBufferView(s.bufferView));else throw new Error(\"KHR_techniques_webgl: no shader code\")}),n.forEach(s=>{s.fragmentShader=r[s.fragmentShader],s.vertexShader=r[s.vertexShader]}),i.forEach(s=>{s.program=n[s.program]}),i}function x4e(t,e){let n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(r=>{t.uniforms[r].value&&!(r in n)&&(n[r]=t.uniforms[r].value)}),Object.keys(n).forEach(r=>{typeof n[r]==\"object\"&&n[r].index!==void 0&&(n[r].texture=e.getTexture(n[r].index))}),n}var kre=[AN,fN,bN,wN,TN,IN,RN,BN,DN,PN,gN];function Nre(t,e={},n){let r=kre.filter(i=>Ure(i.name,e));for(let i of r)i.preprocess?.(t,e,n)}async function zre(t,e={},n){let r=kre.filter(i=>Ure(i.name,e));for(let i of r)await i.decode?.(t,e,n)}function Ure(t,e){let n=e?.gltf?.excludeExtensions||{};return!(t in n&&!n[t])}var LN=\"KHR_binary_glTF\";function Vre(t){let e=new _i(t),{json:n}=e;for(let r of n.images||[]){let i=e.getObjectExtension(r,LN);i&&Object.assign(r,i),e.removeObjectExtension(r,LN)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(LN)}var Gre={accessors:\"accessor\",animations:\"animation\",buffers:\"buffer\",bufferViews:\"bufferView\",images:\"image\",materials:\"material\",meshes:\"mesh\",nodes:\"node\",samplers:\"sampler\",scenes:\"scene\",skins:\"skin\",textures:\"texture\"},b4e={accessor:\"accessors\",animations:\"animation\",buffer:\"buffers\",bufferView:\"bufferViews\",image:\"images\",material:\"materials\",mesh:\"meshes\",node:\"nodes\",sampler:\"samplers\",scene:\"scenes\",skin:\"skins\",texture:\"textures\"},ON=class{idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}};json;normalize(e,n){this.json=e.json;let r=e.json;switch(r.asset&&r.asset.version){case\"2.0\":return;case void 0:case\"1.0\":break;default:console.warn(`glTF: Unknown version ${r.asset.version}`);return}if(!n.normalize)throw new Error(\"glTF v1 is not supported.\");console.warn(\"Converting glTF v1 to glTF v2 format. This is experimental and may fail.\"),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),Vre(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r),this._updateMaterial(r)}_addAsset(e){e.asset=e.asset||{},e.asset.version=\"2.0\",e.asset.generator=e.asset.generator||\"Normalized to glTF 2.0 by loaders.gl\"}_convertTopLevelObjectsToArrays(e){for(let n in Gre)this._convertTopLevelObjectToArray(e,n)}_convertTopLevelObjectToArray(e,n){let r=e[n];if(!(!r||Array.isArray(r))){e[n]=[];for(let i in r){let o=r[i];o.id=o.id||i;let s=e[n].length;e[n].push(o),this.idToIndexMap[n][i]=s}}}_convertObjectIdsToArrayIndices(e){for(let n in Gre)this._convertIdsToIndices(e,n);\"scene\"in e&&(e.scene=this._convertIdToIndex(e.scene,\"scene\"));for(let n of e.textures)this._convertTextureIds(n);for(let n of e.meshes)this._convertMeshIds(n);for(let n of e.nodes)this._convertNodeIds(n);for(let n of e.scenes)this._convertSceneIds(n)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,\"image\"))}_convertMeshIds(e){for(let n of e.primitives){let{attributes:r,indices:i,material:o}=n;for(let s in r)r[s]=this._convertIdToIndex(r[s],\"accessor\");i&&(n.indices=this._convertIdToIndex(i,\"accessor\")),o&&(n.material=this._convertIdToIndex(o,\"material\"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(n=>this._convertIdToIndex(n,\"node\"))),e.meshes&&(e.meshes=e.meshes.map(n=>this._convertIdToIndex(n,\"mesh\")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(n=>this._convertIdToIndex(n,\"node\")))}_convertIdsToIndices(e,n){e[n]||(console.warn(`gltf v1: json doesn't contain attribute ${n}`),e[n]=[]);for(let r of e[n])for(let i in r){let o=r[i],s=this._convertIdToIndex(o,i);r[i]=s}}_convertIdToIndex(e,n){let r=b4e[n];if(r in this.idToIndexMap){let i=this.idToIndexMap[r][e];if(!Number.isFinite(i))throw new Error(`gltf v1: failed to resolve ${n} with id ${e}`);return i}return e}_updateObjects(e){for(let n of this.json.buffers)delete n.type}_updateMaterial(e){for(let n of e.materials){n.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};let r=n.values?.tex||n.values?.texture2d_0||n.values?.diffuseTex,i=e.textures.findIndex(o=>o.id===r);i!==-1&&(n.pbrMetallicRoughness.baseColorTexture={index:i})}}};function Hre(t,e={}){return new ON().normalize(t,e)}async function Wre(t,e,n=0,r,i){return w4e(t,e,n,r),Hre(t,{normalize:r?.gltf?.normalize}),Nre(t,r,i),r?.gltf?.loadBuffers&&t.json.buffers&&await T4e(t,r,i),r?.gltf?.loadImages&&await E4e(t,r,i),await zre(t,r,i),t}function w4e(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!Ere(e,n,r)&&(e=new TextDecoder().decode(e)),typeof e==\"string\")t.json=YL(e);else if(e instanceof ArrayBuffer){let s={};n=Sre(s,e,n,r.glb),ta(s.type===\"glTF\",`Invalid GLB magic string ${s.type}`),t._glb=s,t.json=s.json}else ta(!1,\"GLTF: must be ArrayBuffer or string\");let i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){let{binChunks:s}=t._glb;t.buffers[0]={arrayBuffer:s[0].arrayBuffer,byteOffset:s[0].byteOffset,byteLength:s[0].byteLength}}let o=t.json.images||[];t.images=new Array(o.length).fill({})}async function T4e(t,e,n){let r=t.json.buffers||[];for(let i=0;i<r.length;++i){let o=r[i];if(o.uri){let{fetch:s}=n;ta(s);let c=xN(o.uri,e),m=await(await n?.fetch?.(c))?.arrayBuffer?.();t.buffers[i]={arrayBuffer:m,byteOffset:0,byteLength:m.byteLength},delete o.uri}else t.buffers[i]===null&&(t.buffers[i]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength})}}async function E4e(t,e,n){let r=S4e(t),i=t.json.images||[],o=[];for(let s of r)o.push(C4e(t,i[s],s,e,n));return await Promise.all(o)}function S4e(t){let e=new Set,n=t.json.textures||[];for(let r of n)r.source!==void 0&&e.add(r.source);return Array.from(e).sort()}async function C4e(t,e,n,r,i){let o;if(e.uri&&!e.hasOwnProperty(\"bufferView\")){let c=xN(e.uri,r),{fetch:d}=i;o=await(await d(c)).arrayBuffer(),e.bufferView={data:o}}if(Number.isFinite(e.bufferView)){let c=mre(t.json,t.buffers,e.bufferView);o=vm(c.buffer,c.byteOffset,c.byteLength)}ta(o,\"glTF image has no data\");let s=await eu(o,[fb,lN],{...r,mimeType:e.mimeType,basis:r.basis||{format:qI()}},i);s&&s[0]&&(s={compressed:!0,mipmaps:!1,width:s[0].width,height:s[0].height,data:s[0]}),t.images=t.images||[],t.images[n]=s}var Xp={dataType:null,batchType:null,name:\"glTF\",id:\"gltf\",module:\"gltf\",version:wre,extensions:[\"gltf\",\"glb\"],mimeTypes:[\"model/gltf+json\",\"model/gltf-binary\"],text:!0,binary:!0,tests:[\"glTF\"],parse:M4e,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:console}};async function M4e(t,e={},n){e={...Xp.options,...e},e.gltf={...Xp.options.gltf,...e.gltf};let{byteOffset:r=0}=e;return await Wre({},t,r,e,n)}var I4e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},P4e={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},nh={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},R4e={magFilter:nh.TEXTURE_MAG_FILTER,minFilter:nh.TEXTURE_MIN_FILTER,wrapS:nh.TEXTURE_WRAP_S,wrapT:nh.TEXTURE_WRAP_T},B4e={[nh.TEXTURE_MAG_FILTER]:nh.LINEAR,[nh.TEXTURE_MIN_FILTER]:nh.NEAREST_MIPMAP_LINEAR,[nh.TEXTURE_WRAP_S]:nh.REPEAT,[nh.TEXTURE_WRAP_T]:nh.REPEAT};function D4e(){return{id:\"default-sampler\",parameters:B4e}}function L4e(t){return P4e[t]}function O4e(t){return I4e[t]}var FN=class{baseUri=\"\";jsonUnprocessed;json;buffers=[];images=[];postProcess(e,n={}){let{json:r,buffers:i=[],images:o=[]}=e,{baseUri:s=\"\"}=e;return ta(r),this.baseUri=s,this.buffers=i,this.images=o,this.jsonUnprocessed=r,this.json=this._resolveTree(e.json,n),this.json}_resolveTree(e,n={}){let r={...e};return this.json=r,e.bufferViews&&(r.bufferViews=e.bufferViews.map((i,o)=>this._resolveBufferView(i,o))),e.images&&(r.images=e.images.map((i,o)=>this._resolveImage(i,o))),e.samplers&&(r.samplers=e.samplers.map((i,o)=>this._resolveSampler(i,o))),e.textures&&(r.textures=e.textures.map((i,o)=>this._resolveTexture(i,o))),e.accessors&&(r.accessors=e.accessors.map((i,o)=>this._resolveAccessor(i,o))),e.materials&&(r.materials=e.materials.map((i,o)=>this._resolveMaterial(i,o))),e.meshes&&(r.meshes=e.meshes.map((i,o)=>this._resolveMesh(i,o))),e.nodes&&(r.nodes=e.nodes.map((i,o)=>this._resolveNode(i,o)),r.nodes=r.nodes.map((i,o)=>this._resolveNodeChildren(i))),e.skins&&(r.skins=e.skins.map((i,o)=>this._resolveSkin(i,o))),e.scenes&&(r.scenes=e.scenes.map((i,o)=>this._resolveScene(i,o))),typeof this.json.scene==\"number\"&&r.scenes&&(r.scene=r.scenes[this.json.scene]),r}getScene(e){return this._get(this.json.scenes,e)}getNode(e){return this._get(this.json.nodes,e)}getSkin(e){return this._get(this.json.skins,e)}getMesh(e){return this._get(this.json.meshes,e)}getMaterial(e){return this._get(this.json.materials,e)}getAccessor(e){return this._get(this.json.accessors,e)}getCamera(e){return this._get(this.json.cameras,e)}getTexture(e){return this._get(this.json.textures,e)}getSampler(e){return this._get(this.json.samplers,e)}getImage(e){return this._get(this.json.images,e)}getBufferView(e){return this._get(this.json.bufferViews,e)}getBuffer(e){return this._get(this.json.buffers,e)}_get(e,n){if(typeof n==\"object\")return n;let r=e&&e[n];return r||console.warn(`glTF file error: Could not find ${e}[${n}]`),r}_resolveScene(e,n){return{...e,id:e.id||`scene-${n}`,nodes:(e.nodes||[]).map(r=>this.getNode(r))}}_resolveNode(e,n){let r={...e,id:e?.id||`node-${n}`};return e.mesh!==void 0&&(r.mesh=this.getMesh(e.mesh)),e.camera!==void 0&&(r.camera=this.getCamera(e.camera)),e.skin!==void 0&&(r.skin=this.getSkin(e.skin)),e.meshes!==void 0&&e.meshes.length&&(r.mesh=e.meshes.reduce((i,o)=>{let s=this.getMesh(o);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),r}_resolveNodeChildren(e){return e.children&&(e.children=e.children.map(n=>this.getNode(n))),e}_resolveSkin(e,n){let r=typeof e.inverseBindMatrices==\"number\"?this.getAccessor(e.inverseBindMatrices):void 0;return{...e,id:e.id||`skin-${n}`,inverseBindMatrices:r}}_resolveMesh(e,n){let r={...e,id:e.id||`mesh-${n}`,primitives:[]};return e.primitives&&(r.primitives=e.primitives.map(i=>{let o={...i,attributes:{},indices:void 0,material:void 0},s=i.attributes;for(let c in s)o.attributes[c]=this.getAccessor(s[c]);return i.indices!==void 0&&(o.indices=this.getAccessor(i.indices)),i.material!==void 0&&(o.material=this.getMaterial(i.material)),o})),r}_resolveMaterial(e,n){let r={...e,id:e.id||`material-${n}`};if(r.normalTexture&&(r.normalTexture={...r.normalTexture},r.normalTexture.texture=this.getTexture(r.normalTexture.index)),r.occlusionTexture&&(r.occlusionTexture={...r.occlusionTexture},r.occlusionTexture.texture=this.getTexture(r.occlusionTexture.index)),r.emissiveTexture&&(r.emissiveTexture={...r.emissiveTexture},r.emissiveTexture.texture=this.getTexture(r.emissiveTexture.index)),r.emissiveFactor||(r.emissiveFactor=r.emissiveTexture?[1,1,1]:[0,0,0]),r.pbrMetallicRoughness){r.pbrMetallicRoughness={...r.pbrMetallicRoughness};let i=r.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture={...i.baseColorTexture},i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture={...i.metallicRoughnessTexture},i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return r}_resolveAccessor(e,n){let r=L4e(e.componentType),i=O4e(e.type),o=r*i,s={...e,id:e.id||`accessor-${n}`,bytesPerComponent:r,components:i,bytesPerElement:o,value:void 0,bufferView:void 0,sparse:void 0};if(e.bufferView!==void 0&&(s.bufferView=this.getBufferView(e.bufferView)),s.bufferView){let c=s.bufferView.buffer,{ArrayType:d,byteLength:m}=m2(s,s.bufferView),b=(s.bufferView.byteOffset||0)+(s.byteOffset||0)+c.byteOffset,C=c.arrayBuffer.slice(b,b+m);s.bufferView.byteStride&&(C=this._getValueFromInterleavedBuffer(c,b,s.bufferView.byteStride,s.bytesPerElement,s.count)),s.value=new d(C)}return s}_getValueFromInterleavedBuffer(e,n,r,i,o){let s=new Uint8Array(o*i);for(let c=0;c<o;c++){let d=n+c*r;s.set(new Uint8Array(e.arrayBuffer.slice(d,d+i)),c*i)}return s.buffer}_resolveTexture(e,n){return{...e,id:e.id||`texture-${n}`,sampler:typeof e.sampler==\"number\"?this.getSampler(e.sampler):D4e(),source:typeof e.source==\"number\"?this.getImage(e.source):void 0}}_resolveSampler(e,n){let r={id:e.id||`sampler-${n}`,...e,parameters:{}};for(let i in r){let o=this._enumSamplerParameter(i);o!==void 0&&(r.parameters[o]=r[i])}return r}_enumSamplerParameter(e){return R4e[e]}_resolveImage(e,n){let r={...e,id:e.id||`image-${n}`,image:null,bufferView:e.bufferView!==void 0?this.getBufferView(e.bufferView):void 0},i=this.images[n];return i&&(r.image=i),r}_resolveBufferView(e,n){let r=e.buffer,i=this.buffers[r].arrayBuffer,o=this.buffers[r].byteOffset||0;return e.byteOffset&&(o+=e.byteOffset),{id:`bufferView-${n}`,...e,buffer:this.buffers[r],data:new Uint8Array(i,o,e.byteLength)}}_resolveCamera(e,n){let r={...e,id:e.id||`camera-${n}`};return r.perspective,r.orthographic,r}};function u_(t,e){return new FN().postProcess(t,e)}async function jre(t){let e=[];return t.scenes.forEach(n=>{n.traverse(r=>{})}),await F4e(()=>e.some(n=>!n.loaded))}async function F4e(t){for(;t();)await new Promise(e=>requestAnimationFrame(e))}var Xre=`uniform scenegraphUniforms {\n  float sizeScale;\n  float sizeMinPixels;\n  float sizeMaxPixels;\n  mat4 sceneModelMatrix;\n  bool composeModelMatrix;\n} scenegraph;\n`,Yre={name:\"scenegraph\",vs:Xre,fs:Xre,uniformTypes:{sizeScale:\"f32\",sizeMinPixels:\"f32\",sizeMaxPixels:\"f32\",sceneModelMatrix:\"mat4x4<f32>\",composeModelMatrix:\"f32\"}};var Zre=`#version 300 es\n#define SHADER_NAME scenegraph-layer-vertex-shader\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin vec3 instanceModelMatrixCol0;\nin vec3 instanceModelMatrixCol1;\nin vec3 instanceModelMatrixCol2;\nin vec3 instanceTranslation;\nin vec3 positions;\n#ifdef HAS_UV\nin vec2 texCoords;\n#endif\n#ifdef LIGHTING_PBR\n#ifdef HAS_NORMALS\nin vec3 normals;\n#endif\n#endif\nout vec4 vColor;\n#ifndef LIGHTING_PBR\n#ifdef HAS_UV\nout vec2 vTEXCOORD_0;\n#endif\n#endif\nvoid main(void) {\n#if defined(HAS_UV) && !defined(LIGHTING_PBR)\nvTEXCOORD_0 = texCoords;\ngeometry.uv = texCoords;\n#endif\ngeometry.worldPosition = instancePositions;\ngeometry.pickingColor = instancePickingColors;\nmat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);\nvec3 normal = vec3(0.0, 0.0, 1.0);\n#ifdef LIGHTING_PBR\n#ifdef HAS_NORMALS\nnormal = instanceModelMatrix * (scenegraph.sceneModelMatrix * vec4(normals, 0.0)).xyz;\n#endif\n#endif\nfloat originalSize = project_size_to_pixel(scenegraph.sizeScale);\nfloat clampedSize = clamp(originalSize, scenegraph.sizeMinPixels, scenegraph.sizeMaxPixels);\nvec3 pos = (instanceModelMatrix * (scenegraph.sceneModelMatrix * vec4(positions, 1.0)).xyz) * scenegraph.sizeScale * (clampedSize / originalSize) + instanceTranslation;\nif(scenegraph.composeModelMatrix) {\nDECKGL_FILTER_SIZE(pos, geometry);\ngeometry.normal = project_normal(normal);\ngeometry.worldPosition += pos;\ngl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n}\nelse {\npos = project_size(pos);\nDECKGL_FILTER_SIZE(pos, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\ngeometry.normal = project_normal(normal);\n}\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n#ifdef LIGHTING_PBR\npbr_vPosition = geometry.position.xyz;\n#ifdef HAS_NORMALS\npbr_vNormal = geometry.normal;\n#endif\n#ifdef HAS_UV\npbr_vUV = texCoords;\n#else\npbr_vUV = vec2(0., 0.);\n#endif\ngeometry.uv = pbr_vUV;\n#endif\nvColor = instanceColors;\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var qre=`#version 300 es\n#define SHADER_NAME scenegraph-layer-fragment-shader\nin vec4 vColor;\nout vec4 fragColor;\n#ifndef LIGHTING_PBR\n#if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\nin vec2 vTEXCOORD_0;\nuniform sampler2D pbr_baseColorSampler;\n#endif\n#endif\nvoid main(void) {\n#ifdef LIGHTING_PBR\nfragColor = vColor * pbr_filterColor(vec4(0));\ngeometry.uv = pbr_vUV;\n#else\n#if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\nfragColor = vColor * texture(pbr_baseColorSampler, vTEXCOORD_0);\ngeometry.uv = vTEXCOORD_0;\n#else\nfragColor = vColor;\n#endif\n#endif\nfragColor.a *= layer.opacity;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var Qre=[255,255,255,255],k4e={scenegraph:{type:\"object\",value:null,async:!0},getScene:t=>t&&t.scenes?typeof t.scene==\"object\"?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:\"number\",value:1,min:0},sizeMinPixels:{type:\"number\",min:0,value:0},sizeMaxPixels:{type:\"number\",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:\"accessor\",value:t=>t.position},getColor:{type:\"accessor\",value:Qre},_lighting:\"flat\",_imageBasedLightingEnvironment:void 0,getOrientation:{type:\"accessor\",value:[0,0,0]},getScale:{type:\"accessor\",value:[1,1,1]},getTranslation:{type:\"accessor\",value:[0,0,0]},getTransformMatrix:{type:\"accessor\",value:[]},loaders:[Xp]},K3=class extends hi{getShaders(){let e={},n;this.props._lighting===\"pbr\"?(n=Gm,e.LIGHTING_PBR=1):n={name:\"pbrMaterial\"};let r=[Lr,$i,Yre,n];return super.getShaders({defines:e,vs:Zre,fs:qre,modules:r})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:\"float64\",fp64:this.use64bitPositions(),accessor:\"getPosition\",transition:!0},instanceColors:{type:\"unorm8\",size:this.props.colorFormat.length,accessor:\"getColor\",defaultValue:Qre,transition:!0},instanceModelMatrix:jI})}updateState(e){super.updateState(e);let{props:n,oldProps:r}=e;n.scenegraph!==r.scenegraph?this._updateScenegraph():n._animations!==r._animations&&this._applyAnimationsProp(this.state.animator,n._animations)}finalizeState(e){super.finalizeState(e),this.state.scenegraph?.destroy()}get isLoaded(){return!!(this.state?.scenegraph&&super.isLoaded)}_updateScenegraph(){let e=this.props,{device:n}=this.context,r=null;if(e.scenegraph instanceof nd)r={scenes:[e.scenegraph]};else if(e.scenegraph&&typeof e.scenegraph==\"object\"){let c=e.scenegraph,d=c.json?u_(c):c,m=hN(n,d,this._getModelOptions());r={gltf:d,...m},jre(m).then(()=>{this.setNeedsRedraw()}).catch(b=>{this.raiseError(b,\"loading glTF\")})}let i={layer:this,device:this.context.device},o=e.getScene(r,i),s=e.getAnimator(r,i);if(o instanceof Op){this.state.scenegraph?.destroy(),this._applyAnimationsProp(s,e._animations);let c=[];o.traverse(d=>{d instanceof OA&&c.push(d.model)}),this.setState({scenegraph:o,animator:s,models:c}),this.getAttributeManager().invalidateAll()}else o!==null&&hn.warn(\"invalid scenegraph:\",o)()}_applyAnimationsProp(e,n){if(!e||!n)return;let r=e.getAnimations();Object.keys(n).sort().forEach(i=>{let o=n[i];if(i===\"*\")r.forEach(s=>{Object.assign(s,o)});else if(Number.isFinite(Number(i))){let s=Number(i);s>=0&&s<r.length?Object.assign(r[s],o):hn.warn(`animation ${i} not found`)()}else{let s=r.find(({animation:c})=>c.name===i);s?Object.assign(s,o):hn.warn(`animation ${i} not found`)()}})}_getModelOptions(){let{_imageBasedLightingEnvironment:e}=this.props,n;return e&&(typeof e==\"function\"?n=e({gl:this.context.gl,layer:this}):n=e),{imageBasedLightingEnvironment:n,modelOptions:{id:this.props.id,isInstanced:!0,bufferLayout:this.getAttributeManager().getBufferLayouts(),...this.getShaders()},useTangents:!1}}draw({context:e}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(e.timeline.getTime()),this.setNeedsRedraw());let{viewport:n,renderPass:r}=this.context,{sizeScale:i,sizeMinPixels:o,sizeMaxPixels:s,coordinateSystem:c}=this.props,d={camera:n.cameraPosition},m=this.getNumInstances();this.state.scenegraph.traverse((b,{worldMatrix:C})=>{if(b instanceof OA){let{model:B}=b;B.setInstanceCount(m);let k={sizeScale:i,sizeMinPixels:o,sizeMaxPixels:s,composeModelMatrix:XI(n,c),sceneModelMatrix:C};B.shaderInputs.setProps({pbrProjection:d,scenegraph:k}),B.draw(r)}})}};K3.defaultProps=k4e;K3.layerName=\"ScenegraphLayer\";var hP=K3;var Kre=`uniform meshUniforms {\n  bool pickFeatureIds;\n} mesh;\n`,Jre={name:\"mesh\",vs:Kre,fs:Kre,uniformTypes:{pickFeatureIds:\"f32\"}};var $re=`#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec4 uvRegions;\nin vec3 featureIdsPickingColors;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin vec3 instanceModelMatrixCol0;\nin vec3 instanceModelMatrixCol1;\nin vec3 instanceModelMatrixCol2;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\nvec2 applyUVRegion(vec2 uv) {\n#ifdef HAS_UV_REGIONS\nreturn fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;\n#else\nreturn uv;\n#endif\n}\nvoid main(void) {\nvec2 uv = applyUVRegion(texCoords);\ngeometry.uv = uv;\nif (mesh.pickFeatureIds) {\ngeometry.pickingColor = featureIdsPickingColors;\n} else {\ngeometry.pickingColor = instancePickingColors;\n}\nmat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);\nvTexCoord = uv;\ncameraPosition = project.cameraPosition;\nvColor = vec4(colors * instanceColors.rgb, instanceColors.a);\nvec3 pos = (instanceModelMatrix * positions) * simpleMesh.sizeScale;\nvec3 projectedPosition = project_position(positions);\nposition_commonspace = vec4(projectedPosition, 1.0);\ngl_Position = project_common_position_to_clipspace(position_commonspace);\ngeometry.position = position_commonspace;\nnormals_commonspace = project_normal(instanceModelMatrix * normals);\ngeometry.normal = normals_commonspace;\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n#ifdef MODULE_PBRMATERIAL\npbr_vPosition = geometry.position.xyz;\n#ifdef HAS_NORMALS\npbr_vNormal = geometry.normal;\n#endif\n#ifdef HAS_UV\npbr_vUV = uv;\n#else\npbr_vUV = vec2(0., 0.);\n#endif\ngeometry.uv = pbr_vUV;\n#endif\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var eie=`#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\nprecision highp float;\nuniform sampler2D sampler;\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\nout vec4 fragColor;\nvoid main(void) {\n#ifdef MODULE_PBRMATERIAL\nfragColor = vColor * pbr_filterColor(vec4(0));\ngeometry.uv = pbr_vUV;\nfragColor.a *= layer.opacity;\n#else\ngeometry.uv = vTexCoord;\nvec3 normal;\nif (simpleMesh.flatShading) {\nnormal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n} else {\nnormal = normals_commonspace;\n}\nvec4 color = simpleMesh.hasTexture ? texture(sampler, vTexCoord) : vColor;\nvec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\nfragColor = vec4(lightColor, color.a * layer.opacity);\n#endif\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;function N4e(t){let e=t.positions||t.POSITION,n=e.value.length/e.size;t.COLOR_0||t.colors||(t.colors={size:4,value:new Uint8Array(n*4).fill(255),normalized:!0})}var z4e={pbrMaterial:{type:\"object\",value:null},featureIds:{type:\"array\",value:null,optional:!0}},J3=class extends jp{getShaders(){let e=super.getShaders();return e.modules.push(Gm,Jre),{...e,vs:$re,fs:eie}}initializeState(){let{featureIds:e}=this.props;super.initializeState();let n=this.getAttributeManager();e&&n.add({featureIdsPickingColors:{type:\"uint8\",size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(e){super.updateState(e);let{props:n,oldProps:r}=e;n.pbrMaterial!==r.pbrMaterial&&this.updatePbrMaterialUniforms(n.pbrMaterial)}draw(e){let{featureIds:n}=this.props,{model:r}=this.state;if(!r)return;let i={pickFeatureIds:!!n},o={camera:this.context.viewport.cameraPosition};r.shaderInputs.setProps({pbrProjection:o,mesh:i}),super.draw(e)}getModel(e){let{id:n}=this.props,r=this.parseMaterial(this.props.pbrMaterial,e);this.setState({parsedPBRMaterial:r});let i=this.getShaders();return N4e(e.attributes),new gr(this.context.device,{...this.getShaders(),id:n,geometry:e,bufferLayout:this.getAttributeManager().getBufferLayouts(),defines:{...i.defines,...r?.defines,HAS_UV_REGIONS:e.attributes.uvRegions?1:0},parameters:r?.parameters,isInstanced:!0})}updatePbrMaterialUniforms(e){let{model:n}=this.state;if(n){let{mesh:r}=this.props,i=this.parseMaterial(e,r);this.setState({parsedPBRMaterial:i});let{pbr_baseColorSampler:o}=i.bindings,{emptyTexture:s}=this.state,c={sampler:o||s,hasTexture:!!o},{camera:d,...m}={...i.bindings,...i.uniforms};n.shaderInputs.setProps({simpleMesh:c,pbrMaterial:m})}}parseMaterial(e,n){let r=!!(e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture);return j3(this.context.device,{unlit:r,...e},{NORMAL:n.attributes.normals,TEXCOORD_0:n.attributes.texCoords},{pbrDebug:!1,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(e){let n=this.props.featureIds,r=new Uint8ClampedArray(n.length*e.size),i=[];for(let o=0;o<n.length;o++)this.encodePickingColor(n[o],i),r[o*3]=i[0],r[o*3+1]=i[1],r[o*3+2]=i[2];e.value=r}finalizeState(e){super.finalizeState(e),this.state.parsedPBRMaterial?.generatedTextures.forEach(n=>n.destroy()),this.setState({parsedPBRMaterial:null})}};J3.layerName=\"MeshLayer\";J3.defaultProps=z4e;var tie=J3;var Yp=6356752314245179e-9,U4e={radii:[6378137,6378137,Yp],radiiSquared:[6378137*6378137,6378137*6378137,Yp*Yp],oneOverRadii:[1/6378137,1/6378137,1/Yp],oneOverRadiiSquared:[1/(6378137*6378137),1/(6378137*6378137),1/(Yp*Yp)],maximumRadius:Math.max(6378137,6378137,Yp),centerToleranceSquared:.1};function fP(t){return t}var bdt=new $e;function V4e(t,e=[],n=fP){return\"longitude\"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):\"x\"in t?(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function nie(t,e=[]){return V4e(t,e,oo._cartographicRadians?fP:w8)}function G4e(t,e,n=fP){return\"longitude\"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):\"x\"in e?(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function rie(t,e){return G4e(t,e,oo._cartographicRadians?fP:T8)}var iie=1e-14,H4e=new $e,oie={up:{south:\"east\",north:\"west\",west:\"south\",east:\"north\"},down:{south:\"west\",north:\"east\",west:\"north\",east:\"south\"},south:{up:\"west\",down:\"east\",west:\"down\",east:\"up\"},north:{up:\"east\",down:\"west\",west:\"up\",east:\"down\"},west:{up:\"north\",down:\"south\",north:\"down\",south:\"up\"},east:{up:\"south\",down:\"north\",north:\"up\",south:\"down\"}},kN={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},$3={east:new $e,north:new $e,up:new $e,west:new $e,south:new $e,down:new $e},W4e=new $e,j4e=new $e,X4e=new $e;function NN(t,e,n,r,i,o){let s=oie[e]&&oie[e][n];ba(s&&(!r||r===s));let c,d,m,b=H4e.copy(i);if(Gs(b.x,0,iie)&&Gs(b.y,0,iie)){let B=Math.sign(b.z);c=W4e.fromArray(kN[e]),e!==\"east\"&&e!==\"west\"&&c.scale(B),d=j4e.fromArray(kN[n]),n!==\"east\"&&n!==\"west\"&&d.scale(B),m=X4e.fromArray(kN[r]),r!==\"east\"&&r!==\"west\"&&m.scale(B)}else{let{up:B,east:k,north:V}=$3;k.set(-b.y,b.x,0).normalize(),t.geodeticSurfaceNormal(b,B),V.copy(B).cross(k);let{down:q,west:K,south:Y}=$3;q.copy(B).scale(-1),K.copy(k).scale(-1),Y.copy(V).scale(-1),c=$3[e],d=$3[n],m=$3[r]}return o[0]=c.x,o[1]=c.y,o[2]=c.z,o[3]=0,o[4]=d.x,o[5]=d.y,o[6]=d.z,o[7]=0,o[8]=m.x,o[9]=m.y,o[10]=m.z,o[11]=0,o[12]=b.x,o[13]=b.y,o[14]=b.z,o[15]=1,o}var E2=new $e,Y4e=new $e,Z4e=new $e;function sie(t,e,n=[]){let{oneOverRadii:r,oneOverRadiiSquared:i,centerToleranceSquared:o}=e;E2.from(t);let s=E2.x,c=E2.y,d=E2.z,m=r.x,b=r.y,C=r.z,B=s*s*m*m,k=c*c*b*b,V=d*d*C*C,q=B+k+V,K=Math.sqrt(1/q);if(!Number.isFinite(K))return;let Y=Y4e;if(Y.copy(t).scale(K),q<o)return Y.to(n);let ee=i.x,J=i.y,se=i.z,xe=Z4e;xe.set(Y.x*ee*2,Y.y*J*2,Y.z*se*2);let Ee=(1-K)*E2.len()/(.5*xe.len()),Xe=0,Ne,be,ge,Qe;do{Ee-=Xe,Ne=1/(1+Ee*ee),be=1/(1+Ee*J),ge=1/(1+Ee*se);let Ct=Ne*Ne,Mt=be*be,mt=ge*ge,jt=Ct*Ne,Mn=Mt*be,rn=mt*ge;Qe=B*Ct+k*Mt+V*mt-1;let On=-2*(B*jt*ee+k*Mn*J+V*rn*se);Xe=Qe/On}while(Math.abs(Qe)>qh.EPSILON12);return E2.scale([Ne,be,ge]).to(n)}var dP=new $e,aie=new $e,K4e=new $e,af=new $e,J4e=new $e,pP=new $e,Or=class{constructor(e=0,n=0,r=0){this.centerToleranceSquared=qh.EPSILON1,ba(e>=0),ba(n>=0),ba(r>=0),this.radii=new $e(e,n,r),this.radiiSquared=new $e(e*e,n*n,r*r),this.radiiToTheFourth=new $e(e*e*e*e,n*n*n*n,r*r*r*r),this.oneOverRadii=new $e(e===0?0:1/e,n===0?0:1/n,r===0?0:1/r),this.oneOverRadiiSquared=new $e(e===0?0:1/(e*e),n===0?0:1/(n*n),r===0?0:1/(r*r)),this.minimumRadius=Math.min(e,n,r),this.maximumRadius=Math.max(e,n,r),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||!!(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e,n=[0,0,0]){let r=aie,i=K4e,[,,o]=e;this.geodeticSurfaceNormalCartographic(e,r),i.copy(this.radiiSquared).scale(r);let s=Math.sqrt(r.dot(i));return i.scale(1/s),r.scale(o),i.add(r),i.to(n)}cartesianToCartographic(e,n=[0,0,0]){pP.from(e);let r=this.scaleToGeodeticSurface(pP,af);if(!r)return;let i=this.geodeticSurfaceNormal(r,aie),o=J4e;o.copy(pP).subtract(r);let s=Math.atan2(i.y,i.x),c=Math.asin(i.z),d=Math.sign(Ya.dot(o,pP))*Ya.length(o);return rie([s,c,d],n)}eastNorthUpToFixedFrame(e,n=new wn){return NN(this,\"east\",\"north\",\"up\",e,n)}localFrameToFixedFrame(e,n,r,i,o=new wn){return NN(this,e,n,r,i,o)}geocentricSurfaceNormal(e,n=[0,0,0]){return dP.from(e).normalize().to(n)}geodeticSurfaceNormalCartographic(e,n=[0,0,0]){let r=nie(e),i=r[0],o=r[1],s=Math.cos(o);return dP.set(s*Math.cos(i),s*Math.sin(i),Math.sin(o)).normalize(),dP.to(n)}geodeticSurfaceNormal(e,n=[0,0,0]){return dP.from(e).scale(this.oneOverRadiiSquared).normalize().to(n)}scaleToGeodeticSurface(e,n){return sie(e,this,n)}scaleToGeocentricSurface(e,n=[0,0,0]){af.from(e);let r=af.x,i=af.y,o=af.z,s=this.oneOverRadiiSquared,c=1/Math.sqrt(r*r*s.x+i*i*s.y+o*o*s.z);return af.multiplyScalar(c).to(n)}transformPositionToScaledSpace(e,n=[0,0,0]){return af.from(e).scale(this.oneOverRadii).to(n)}transformPositionFromScaledSpace(e,n=[0,0,0]){return af.from(e).scale(this.radii).to(n)}getSurfaceNormalIntersectionWithZAxis(e,n=0,r=[0,0,0]){ba(Gs(this.radii.x,this.radii.y,qh.EPSILON15)),ba(this.radii.z>0),af.from(e);let i=af.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-n))return af.set(0,0,i).to(r)}};Or.WGS84=new Or(6378137,6378137,Yp);wm();var AP=class{item;previous;next;constructor(e,n,r){this.item=e,this.previous=n,this.next=r}};var gP=class{head=null;tail=null;_length=0;get length(){return this._length}add(e){let n=new AP(e,this.tail,null);return this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n}remove(e){e&&(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}splice(e,n){e!==n&&(this.remove(n),this._insert(e,n))}_insert(e,n){let r=e.next;e.next=n,this.tail===e?this.tail=n:r.previous=n,n.next=r,n.previous=e,++this._length}};var mP=class{_list;_sentinel;_trimTiles;constructor(){this._list=new gP,this._sentinel=this._list.add(\"sentinel\"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(e){let n=e._cacheNode;n&&this._list.splice(this._sentinel,n)}add(e,n,r){n._cacheNode||(n._cacheNode=this._list.add(n),r&&r(e,n))}unloadTile(e,n,r){let i=n._cacheNode;i&&(this._list.remove(i),n._cacheNode=null,r&&r(e,n))}unloadTiles(e,n){let r=this._trimTiles;this._trimTiles=!1;let i=this._list,o=e.maximumMemoryUsage*1024*1024,s=this._sentinel,c=i.head;for(;c!==s&&(e.gpuMemoryUsageInBytes>o||r);){let d=c.item;c=c.next,this.unloadTile(e,d,n)}}trim(){this._trimTiles=!0}};function lie(t,e){Rr(t),Rr(e);let{rtcCenter:n,gltfUpAxis:r}=e,{computedTransform:i,boundingVolume:{center:o}}=t,s=new wn(i);switch(n&&s.translate(n),r){case\"Z\":break;case\"Y\":let C=new wn().rotateX(Math.PI/2);s=s.multiplyRight(C);break;case\"X\":let B=new wn().rotateY(-Math.PI/2);s=s.multiplyRight(B);break;default:break}e.isQuantized&&s.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);let c=new $e(o);e.cartesianModelMatrix=s,e.cartesianOrigin=c;let d=Or.WGS84.cartesianToCartographic(c,new $e),b=Or.WGS84.eastNorthUpToFixedFrame(c).invert();e.cartographicModelMatrix=b.multiplyRight(s),e.cartographicOrigin=d,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}var cie=new $e,zN=new $e,UN=new ec([new gl,new gl,new gl,new gl,new gl,new gl]);function hie(t,e){let{cameraDirection:n,cameraUp:r,height:i}=t,{metersPerUnit:o}=t.distanceScales,s=_P(t,t.center),c=Or.WGS84.eastNorthUpToFixedFrame(s),d=t.unprojectPosition(t.cameraPosition),m=Or.WGS84.cartographicToCartesian(d,new $e),b=new $e(c.transformAsVector(new $e(n).scale(o))).normalize(),C=new $e(c.transformAsVector(new $e(r).scale(o))).normalize();$4e(t);let B=t.constructor,{longitude:k,latitude:V,width:q,bearing:K,zoom:Y}=t,ee=new B({longitude:k,latitude:V,height:i,width:q,bearing:K,zoom:Y,pitch:0});return{camera:{position:m,direction:b,up:C},viewport:t,topDownViewport:ee,height:i,cullingVolume:UN,frameNumber:e,sseDenominator:1.15}}function fie(t,e,n){if(n===0||t.length<=n)return[t,[]];let r=[],{longitude:i,latitude:o}=e.viewport;for(let[m,b]of t.entries()){let[C,B]=b.header.mbs,k=Math.abs(i-C),V=Math.abs(o-B),q=Math.sqrt(V*V+k*k);r.push([m,q])}let s=r.sort((m,b)=>m[1]-b[1]),c=[];for(let m=0;m<n;m++)c.push(t[s[m][0]]);let d=[];for(let m=n;m<s.length;m++)d.push(t[s[m][0]]);return[c,d]}function $4e(t){let e=t.getFrustumPlanes(),n=uie(e.near,t.cameraPosition),r=_P(t,n),i=_P(t,t.cameraPosition,zN),o=0;UN.planes[o++].fromPointNormal(r,cie.copy(r).subtract(i));for(let s in e){if(s===\"near\")continue;let c=e[s],d=uie(c,n,zN),m=_P(t,d,zN);UN.planes[o++].fromPointNormal(m,cie.copy(r).subtract(m))}}function uie(t,e,n=new $e){let r=t.normal.dot(e);return n.copy(t.normal).scale(t.distance-r).add(e),n}function _P(t,e,n=new $e){let r=t.unprojectPosition(e);return Or.WGS84.cartographicToCartesian(r,n)}var eIe=6378137,tIe=6378137,VN=6356752314245179e-9,S2=new $e;function die(t,e){if(t instanceof Hp){let{halfAxes:n}=t,r=nIe(n);return Math.log2(VN/(r+e[2]))}else if(t instanceof hd){let{radius:n}=t;return Math.log2(VN/(n+e[2]))}else if(t.width&&t.height){let{width:n,height:r}=t,i=Math.log2(eIe/n),o=Math.log2(tIe/r);return(i+o)/2}return 1}function GN(t,e,n){Or.WGS84.cartographicToCartesian([t.xmax,t.ymax,t.zmax],S2);let r=Math.sqrt(Math.pow(S2[0]-n[0],2)+Math.pow(S2[1]-n[1],2)+Math.pow(S2[2]-n[2],2));return Math.log2(VN/(r+e[2]))}function pie(t,e,n){let[r,i,o,s]=t;return GN({xmin:r,xmax:o,ymin:i,ymax:s,zmin:0,zmax:0},e,n)}function nIe(t){t.getColumn(0,S2);let e=t.getColumn(1),n=t.getColumn(2);return S2.add(e).add(n).len()}var tc={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},ml;(function(t){t[t.ADD=1]=\"ADD\",t[t.REPLACE=2]=\"REPLACE\"})(ml||(ml={}));var rh;(function(t){t.EMPTY=\"empty\",t.SCENEGRAPH=\"scenegraph\",t.POINTCLOUD=\"pointcloud\",t.MESH=\"mesh\"})(rh||(rh={}));var Ea;(function(t){t.I3S=\"I3S\",t.TILES3D=\"TILES3D\"})(Ea||(Ea={}));var Zp;(function(t){t.GEOMETRIC_ERROR=\"geometricError\",t.MAX_SCREEN_THRESHOLD=\"maxScreenThreshold\"})(Zp||(Zp={}));var Aie={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function yie(t){return t!=null}var _l=new $e,yP=new $e,rIe=new $e,iIe=new $e,h_=new $e,gie=new $e,mie=new $e,_ie=new $e;function xP(t,e,n){if(Rr(t,\"3D Tile: boundingVolume must be defined\"),t.box)return vie(t.box,e,n);if(t.region)return sIe(t.region);if(t.sphere)return oIe(t.sphere,e,n);throw new Error(\"3D Tile: boundingVolume must contain a sphere, region, or box\")}function xie(t,e){if(t.box)return aIe(e);if(t.region){let[n,r,i,o,s,c]=t.region;return[[ou(n),ou(r),s],[ou(i),ou(o),c]]}if(t.sphere)return lIe(e);throw new Error(\"Unkown boundingVolume type\")}function vie(t,e,n){let r=new $e(t[0],t[1],t[2]);e.transform(r,r);let i=[];if(t.length===10){let m=t.slice(3,6),b=new qu;b.fromArray(t,6);let C=new $e([1,0,0]),B=new $e([0,1,0]),k=new $e([0,0,1]);C.transformByQuaternion(b),C.scale(m[0]),B.transformByQuaternion(b),B.scale(m[1]),k.transformByQuaternion(b),k.scale(m[2]),i=[...C.toArray(),...B.toArray(),...k.toArray()]}else i=[...t.slice(3,6),...t.slice(6,9),...t.slice(9,12)];let o=e.transformAsVector(i.slice(0,3)),s=e.transformAsVector(i.slice(3,6)),c=e.transformAsVector(i.slice(6,9)),d=new Mi([o[0],o[1],o[2],s[0],s[1],s[2],c[0],c[1],c[2]]);return yie(n)?(n.center=r,n.halfAxes=d,n):new Hp(r,d)}function oIe(t,e,n){let r=new $e(t[0],t[1],t[2]);e.transform(r,r);let i=e.getScale(yP),o=Math.max(Math.max(i[0],i[1]),i[2]),s=t[3]*o;return yie(n)?(n.center=r,n.radius=s,n):new hd(r,s)}function sIe(t){let[e,n,r,i,o,s]=t,c=Or.WGS84.cartographicToCartesian([ou(e),ou(i),o],rIe),d=Or.WGS84.cartographicToCartesian([ou(r),ou(n),s],iIe),m=new $e().addVectors(c,d).multiplyByScalar(.5);return Or.WGS84.cartesianToCartographic(m,h_),Or.WGS84.cartographicToCartesian([ou(r),h_[1],h_[2]],gie),Or.WGS84.cartographicToCartesian([h_[0],ou(i),h_[2]],mie),Or.WGS84.cartographicToCartesian([h_[0],h_[1],s],_ie),vie([...m,...gie.subtract(m),...mie.subtract(m),..._ie.subtract(m)],new wn)}function aIe(t){let e=bie(),{halfAxes:n}=t,r=new $e(n.getColumn(0)),i=new $e(n.getColumn(1)),o=new $e(n.getColumn(2));for(let s=0;s<2;s++){for(let c=0;c<2;c++){for(let d=0;d<2;d++)_l.copy(t.center),_l.add(r),_l.add(i),_l.add(o),wie(e,_l),o.negate();i.negate()}r.negate()}return e}function lIe(t){let e=bie(),{center:n,radius:r}=t,i=Or.WGS84.scaleToGeodeticSurface(n,_l),o;i?o=Or.WGS84.geodeticSurfaceNormal(i):o=new $e(0,0,1);let s=new $e(o[2],-o[1],0);s.len()>0?s.normalize():s=new $e(0,1,0);let c=s.clone().cross(o);for(let d of[s,c,o]){yP.copy(d).scale(r);for(let m=0;m<2;m++)_l.copy(n),_l.add(yP),wie(e,_l),yP.negate()}return e}function bie(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function wie(t,e){Or.WGS84.cartesianToCartographic(e,_l),t[0][0]=Math.min(t[0][0],_l[0]),t[0][1]=Math.min(t[0][1],_l[1]),t[0][2]=Math.min(t[0][2],_l[2]),t[1][0]=Math.max(t[1][0],_l[0]),t[1][1]=Math.max(t[1][1],_l[1]),t[1][2]=Math.max(t[1][2],_l[2])}var lpt=new $e,cpt=new $e,upt=new wn,hpt=new $e,fpt=new $e,dpt=new $e;function cIe(t,e){let n=t*e;return 1-Math.exp(-(n*n))}function uIe(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){let n=t.dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor;return cIe(e,n)*r}return 0}function Tie(t,e,n){let r=t.tileset,i=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,o=n?i:t.lodMetricValue;if(o===0)return 0;let s=Math.max(t._distanceToCamera,1e-7),{height:c,sseDenominator:d}=e,{viewDistanceScale:m}=r.options,b=o*c*(m||1)/(s*d);return b-=uIe(r,s),b}var HN=new $e,Eie=new $e,$A=new $e,Sie=new $e,hIe=new $e,WN=new wn,Cie=new wn;function Mie(t,e){if(t.lodMetricValue===0||isNaN(t.lodMetricValue))return\"DIG\";let n=2*jN(t,e);return n<2?\"OUT\":!t.header.children||n<=t.lodMetricValue?\"DRAW\":t.header.children?\"DIG\":\"OUT\"}function jN(t,e){let{topDownViewport:n}=e,r=t.header.mbs[1],i=t.header.mbs[0],o=t.header.mbs[2],s=t.header.mbs[3],c=[...t.boundingVolume.center],d=n.unprojectPosition(n.cameraPosition);Or.WGS84.cartographicToCartesian(d,HN),Eie.copy(HN).subtract(c).normalize(),Or.WGS84.eastNorthUpToFixedFrame(c,WN),Cie.copy(WN).invert(),$A.copy(HN).transform(Cie);let m=Math.sqrt($A[0]*$A[0]+$A[1]*$A[1]),b=m*m/$A[2];Sie.copy([$A[0],$A[1],b]);let B=Sie.transform(WN).subtract(c).normalize(),V=Eie.cross(B).normalize().scale(s).add(c),q=Or.WGS84.cartesianToCartographic(V),K=n.project([i,r,o]),Y=n.project(q);return hIe.copy(K).subtract(Y).magnitude()}function Iie(t){return{assetGltfUpAxis:t.asset&&t.asset.gltfUpAxis||\"Y\"}}var eT=class{_map=new Map;_array;_length;constructor(e=0){this._array=new Array(e),this._length=e}get length(){return this._length}set length(e){this._length=e,e>this._array.length&&(this._array.length=e)}get values(){return this._array}get(e){return Rr(e<this._array.length),this._array[e]}set(e,n){Rr(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=n,this._map.set(n,e)}delete(e){let n=this._map.get(e);n>=0&&(this._array.splice(n,1),this._map.delete(e),this.length--)}peek(){return this._array[this._length-1]}push(e){if(!this._map.has(e)){let n=this.length++;this._array[n]=e,this._map.set(e,n)}}pop(){let e=this._array[--this.length];return this._map.delete(e),e}reserve(e){Rr(e>=0),e>this._array.length&&(this._array.length=e)}resize(e){Rr(e>=0),this.length=e}trim(e){e==null&&(e=this.length),this._array.length=e}reset(){this._array=[],this._map=new Map,this._length=0}find(e){return this._map.has(e)}};var fIe={loadSiblings:!1,skipLevelOfDetail:!1,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:\"\"},dd=class{options;root=null;selectedTiles={};requestedTiles={};emptyTiles={};lastUpdate=new Date().getTime();updateDebounceTime=1e3;_traversalStack=new eT;_emptyTraversalStack=new eT;_frameNumber=null;traversalFinished(e){return!0}constructor(e){this.options={...fIe,...e}}traverse(e,n,r){this.root=e,this.options={...this.options,...r},this.reset(),this.updateTile(e,n),this._frameNumber=n.frameNumber,this.executeTraversal(e,n)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(e,n){let r=this._traversalStack;for(e._selectionDepth=1,r.push(e);r.length>0;){let o=r.pop(),s=!1;this.canTraverse(o,n)&&(this.updateChildTiles(o,n),s=this.updateAndPushChildren(o,n,r,o.hasRenderContent?o._selectionDepth+1:o._selectionDepth));let c=o.parent,d=!!(!c||c._shouldRefine),m=!s;o.hasRenderContent?o.refine===ml.ADD?(this.loadTile(o,n),this.selectTile(o,n)):o.refine===ml.REPLACE&&(this.loadTile(o,n),m&&this.selectTile(o,n)):(this.emptyTiles[o.id]=o,this.loadTile(o,n),m&&this.selectTile(o,n)),this.touchTile(o,n),o._shouldRefine=s&&d}let i=new Date().getTime();(this.traversalFinished(n)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(n))}updateChildTiles(e,n){let r=e.children;for(let i of r)this.updateTile(i,n)}updateAndPushChildren(e,n,r,i){let{loadSiblings:o,skipLevelOfDetail:s}=this.options,c=e.children;c.sort(this.compareDistanceToCamera.bind(this));let d=e.refine===ml.REPLACE&&e.hasRenderContent&&!s,m=!1,b=!0;for(let C of c)if(C._selectionDepth=i,C.isVisibleAndInRequestVolume?(r.find(C)&&r.delete(C),r.push(C),m=!0):(d||o)&&(this.loadTile(C,n),this.touchTile(C,n)),d){let B;if(C._inRequestVolume?C.hasRenderContent?B=C.contentAvailable:B=this.executeEmptyTraversal(C,n):B=!1,b=b&&B,!b)return!1}return m||(b=!1),b}updateTile(e,n){this.updateTileVisibility(e,n)}selectTile(e,n){this.shouldSelectTile(e)&&(e._selectedFrame=n.frameNumber,this.selectedTiles[e.id]=e)}loadTile(e,n){this.shouldLoadTile(e)&&(e._requestedFrame=n.frameNumber,e._priority=e._getPriority(),this.requestedTiles[e.id]=e)}touchTile(e,n){e.tileset._cache.touch(e),e._touchedFrame=n.frameNumber}canTraverse(e,n){return e.hasChildren?e.hasTilesetContent?!e.contentExpired:this.shouldRefine(e,n):!1}shouldLoadTile(e){return e.hasUnloadedContent||e.contentExpired}shouldSelectTile(e){return e.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(e,n,r=!1){let i=e._screenSpaceError;return r&&(i=e.getScreenSpaceError(n,!0)),i>e.tileset.memoryAdjustedScreenSpaceError}updateTileVisibility(e,n){let r=[];if(this.options.viewportTraversersMap)for(let i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===n.viewport.id&&r.push(i);else r.push(n.viewport.id);e.updateVisibility(n,r)}compareDistanceToCamera(e,n){return e._distanceToCamera-n._distanceToCamera}anyChildrenVisible(e,n){let r=!1;for(let i of e.children)i.updateVisibility(n),r=r||i.isVisibleAndInRequestVolume;return r}executeEmptyTraversal(e,n){let r=!0,i=this._emptyTraversalStack;for(i.push(e);i.length>0;){let o=i.pop(),s=!o.hasRenderContent&&this.canTraverse(o,n),c=!o.hasRenderContent&&o.children.length===0;if(!s&&!o.contentAvailable&&!c&&(r=!1),this.updateTile(o,n),o.isVisibleAndInRequestVolume||(this.loadTile(o,n),this.touchTile(o,n)),s){let d=o.children;for(let m of d)i.push(m)}}return r}};var Pie=new $e;function dIe(t){return t!=null}var f_=class{tileset;header;id;url;parent;refine;type;contentUrl;lodMetricType=\"geometricError\";lodMetricValue=0;boundingVolume=null;content=null;contentState=tc.UNLOADED;gpuMemoryUsageInBytes=0;children=[];depth=0;viewportIds=[];transform=new wn;extensions=null;implicitTiling=null;userData={};computedTransform;hasEmptyContent=!1;hasTilesetContent=!1;traverser=new dd({});_cacheNode=null;_frameNumber=null;_expireDate=null;_expiredContent=null;_boundingBox=void 0;_distanceToCamera=0;_screenSpaceError=0;_visibilityPlaneMask;_visible=void 0;_contentBoundingVolume;_viewerRequestVolume;_initialTransform=new wn;_priority=0;_selectedFrame=0;_requestedFrame=0;_selectionDepth=0;_touchedFrame=0;_centerZDepth=0;_shouldRefine=!1;_stackLength=0;_visitedFrame=0;_inRequestVolume=!1;_lodJudge=null;constructor(e,n,r,i=\"\"){this.header=n,this.tileset=e,this.id=i||n.id,this.url=n.url,this.parent=r,this.refine=this._getRefine(n.refine),this.type=n.type,this.contentUrl=n.contentUrl,this._initializeLodMetric(n),this._initializeTransforms(n),this._initializeBoundingVolumes(n),this._initializeContent(n),this._initializeRenderingState(n),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===tc.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===tc.UNLOADED}get contentExpired(){return this.contentState===tc.EXPIRED}get contentFailed(){return this.contentState===tc.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=xie(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(e,n){switch(this.tileset.type){case Ea.I3S:return jN(this,e);case Ea.TILES3D:return Tie(this,e,n);default:throw new Error(\"Unsupported tileset type\")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){let e=this.tileset._traverser,{skipLevelOfDetail:n}=e.options,r=this.refine===ml.ADD||n;if(r&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===tc.UNLOADED)return-1;let i=this.parent,s=i&&(!r||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,c=e.root?e.root._screenSpaceError:0;return Math.max(c-s,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=tc.LOADING;let n=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!n)return this.contentState=tc.UNLOADED,!1;try{let r=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,o={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type===\"json\",...this._getLoaderSpecificOptions(i.id)}};return this.content=await va(r,i,o),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=tc.READY,this._onContentLoaded(),!0}catch(r){throw this.contentState=tc.FAILED,r}finally{n.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=tc.UNLOADED,!0}updateVisibility(e,n){if(this._frameNumber===e.frameNumber)return;let r=this.parent,i=r?r._visibilityPlaneMask:ec.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){let o=r?r.computedTransform:this.tileset.modelMatrix;this._updateTransform(o)}this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,i),this._visible=this._visibilityPlaneMask!==ec.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._frameNumber=e.frameNumber,this.viewportIds=n}visibility(e,n){let{cullingVolume:r}=e,{boundingVolume:i}=this;return r.computeVisibilityWithPlaneMask(i,n)}contentVisibility(){return!0}distanceToTile(e){let n=this.boundingVolume;return Math.sqrt(Math.max(n.distanceSquaredTo(e.camera.position),0))}cameraSpaceZDepth({camera:e}){let n=this.boundingVolume;return Pie.subVectors(n.center,e.position),e.direction.dot(Pie)}insideViewerRequestVolume(e){let n=this._viewerRequestVolume;return!n||n.distanceSquaredTo(e.camera.position)<=0}updateExpiration(){if(dIe(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){let e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=tc.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(e){\"lodMetricType\"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn(\"3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType\")),\"lodMetricValue\"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn(\"3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue\"))}_initializeTransforms(e){this.transform=e.transform?new wn(e.transform):new wn;let n=this.parent,r=this.tileset,i=n&&n.computedTransform?n.computedTransform.clone():r.modelMatrix.clone();this.computedTransform=new wn(i).multiplyRight(this.transform);let o=n&&n._initialTransform?n._initialTransform.clone():new wn;this._initialTransform=new wn(o).multiplyRight(this.transform)}_initializeBoundingVolumes(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}_initializeContent(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=tc.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(e){this.depth=e.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=ec.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(e){return e||this.parent&&this.parent.refine||ml.REPLACE}_isTileset(){return this.contentUrl.indexOf(\".json\")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case\"vctr\":case\"geom\":this.tileset._traverser.disableSkipLevelOfDetail=!0;break;default:}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(e){this.boundingVolume=xP(e.boundingVolume,this.computedTransform,this.boundingVolume);let n=e.content;n&&(n.boundingVolume&&(this._contentBoundingVolume=xP(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=xP(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(e=new wn){let n=e.clone().multiplyRight(this.transform);n.equals(this.computedTransform)||(this.computedTransform=n,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(e){switch(e){case\"i3s\":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case\"3d-tiles\":case\"cesium-ion\":default:return Iie(this.tileset.tileset)}}};var vP=class extends dd{compareDistanceToCamera(e,n){return n._distanceToCamera===0&&e._distanceToCamera===0?n._centerZDepth-e._centerZDepth:n._distanceToCamera-e._distanceToCamera}updateTileVisibility(e,n){if(super.updateTileVisibility(e,n),!e.isVisibleAndInRequestVolume)return;let r=e.children.length>0;if(e.hasTilesetContent&&r){let s=e.children[0];this.updateTileVisibility(s,n),e._visible=s._visible;return}if(this.meetsScreenSpaceErrorEarly(e,n)){e._visible=!1;return}let i=e.refine===ml.REPLACE,o=e._optimChildrenWithinParent===Aie.USE_OPTIMIZATION;if(i&&o&&r&&!this.anyChildrenVisible(e,n)){e._visible=!1;return}}meetsScreenSpaceErrorEarly(e,n){let{parent:r}=e;return!r||r.hasTilesetContent||r.refine!==ml.ADD?!1:!this.shouldRefine(e,n,!0)}};var bP=class{frameNumberMap=new Map;register(e,n){let r=this.frameNumberMap.get(e)||new Map,i=r.get(n)||0;r.set(n,i+1),this.frameNumberMap.set(e,r)}deregister(e,n){let r=this.frameNumberMap.get(e);if(!r)return;let i=r.get(n)||1;r.set(n,i-1)}isZero(e,n){return(this.frameNumberMap.get(e)?.get(n)||0)===0}};var XN={REQUESTED:\"REQUESTED\",COMPLETED:\"COMPLETED\",ERROR:\"ERROR\"},wP=class{_statusMap;pendingTilesRegister=new bP;constructor(){this._statusMap={}}add(e,n,r,i){if(!this._statusMap[n]){let{frameNumber:o,viewport:{id:s}}=i;this._statusMap[n]={request:e,callback:r,key:n,frameState:i,status:XN.REQUESTED},this.pendingTilesRegister.register(s,o),e().then(c=>{this._statusMap[n].status=XN.COMPLETED;let{frameNumber:d,viewport:{id:m}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(m,d),this._statusMap[n].callback(c,i)}).catch(c=>{this._statusMap[n].status=XN.ERROR;let{frameNumber:d,viewport:{id:m}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(m,d),r(c)})}}update(e,n){if(this._statusMap[e]){let{frameNumber:r,viewport:{id:i}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(i,r);let{frameNumber:o,viewport:{id:s}}=n;this.pendingTilesRegister.register(s,o),this._statusMap[e].frameState=n}}find(e){return this._statusMap[e]}hasPendingTiles(e,n){return!this.pendingTilesRegister.isZero(e,n)}};var TP=class extends dd{_tileManager;constructor(e){super(e),this._tileManager=new wP}traversalFinished(e){return!this._tileManager.hasPendingTiles(e.viewport.id,this._frameNumber||0)}shouldRefine(e,n){return e._lodJudge=Mie(e,n),e._lodJudge===\"DIG\"}updateChildTiles(e,n){let r=e.header.children||[],i=e.children,o=e.tileset;for(let s of r){let c=`${s.id}-${n.viewport.id}`,d=i&&i.find(m=>m.id===c);if(d)d&&this.updateTile(d,n);else{let m=()=>this._loadTile(s.id,o);this._tileManager.find(c)?this._tileManager.update(c,n):(o.tileset.nodePages&&(m=()=>o.tileset.nodePagesTile.formTileFromNodePages(s.id)),this._tileManager.add(m,c,C=>this._onTileLoad(C,e,c),n))}}return!1}async _loadTile(e,n){let{loader:r}=n,i=n.getTileUrl(`${n.url}/nodes/${e}`),o={...n.loadOptions,i3s:{...n.loadOptions.i3s,isTileHeader:!0}};return await va(i,r,o)}_onTileLoad(e,n,r){let i=new f_(n.tileset,e,n,r);n.children.push(i);let o=this._tileManager.find(i.id).frameState;this.updateTile(i,o),this._frameNumber===o.frameNumber&&(this.traversalFinished(o)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,o)}};var pIe={description:\"\",ellipsoid:Or.WGS84,modelMatrix:new wn,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,memoryCacheOverflow:1,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:t=>t,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,memoryAdjustedScreenSpaceError:!1,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:\"\",i3s:{}},EP=\"Tiles In Tileset(s)\",YN=\"Tiles In Memory\",Rie=\"Tiles In View\",Bie=\"Tiles To Render\",Die=\"Tiles Loaded\",ZN=\"Tiles Loading\",Lie=\"Tiles Unloaded\",Oie=\"Failed Tile Loads\",Fie=\"Points/Vertices\",qN=\"Tile Memory Use\",kie=\"Maximum Screen Space Error\",tT=class{options;loadOptions;type;tileset;loader;url;basePath;modelMatrix;ellipsoid;lodMetricType;lodMetricValue;refine;root=null;roots={};asset={};description=\"\";properties;extras=null;attributions={};credits={};stats;contentFormats={draco:!1,meshopt:!1,dds:!1,ktx2:!1};cartographicCenter=null;cartesianCenter=null;zoom=1;boundingVolume=null;dynamicScreenSpaceErrorComputedDensity=0;maximumMemoryUsage=32;gpuMemoryUsageInBytes=0;memoryAdjustedScreenSpaceError=0;_cacheBytes=0;_cacheOverflowBytes=0;_frameNumber=0;_queryParams={};_extensionsUsed=[];_tiles={};_pendingCount=0;selectedTiles=[];traverseCounter=0;geometricError=0;lastUpdatedVieports=null;_requestedTiles=[];_emptyTiles=[];frameStateData={};_traverser;_cache=new mP;_requestScheduler;updatePromise=null;tilesetInitializationPromise;constructor(e,n){this.options={...pIe,...n},this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||tu.dirname(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new bA({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.memoryAdjustedScreenSpaceError=this.options.maximumScreenSpaceError,this._cacheBytes=this.options.maximumMemoryUsage*1024*1024,this._cacheOverflowBytes=this.options.memoryCacheOverflow*1024*1024,this.stats=new hl({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(e)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(e){this.options={...this.options,...e}}getTileUrl(e){if(e.startsWith(\"data:\"))return e;let r=e;return this.queryParams.length&&(r=`${e}${e.includes(\"?\")?\"&\":\"?\"}${this.queryParams}`),r}hasExtension(e){return this._extensionsUsed.indexOf(e)>-1}update(e=null){this.tilesetInitializationPromise.then(()=>{!e&&this.lastUpdatedVieports?e=this.lastUpdatedVieports:this.lastUpdatedVieports=e,e&&this.doUpdate(e)})}async selectTiles(e=null){return await this.tilesetInitializationPromise,e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise(n=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),n(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}adjustScreenSpaceError(){this.gpuMemoryUsageInBytes<this._cacheBytes?this.memoryAdjustedScreenSpaceError=Math.max(this.memoryAdjustedScreenSpaceError/1.02,this.options.maximumScreenSpaceError):this.gpuMemoryUsageInBytes>this._cacheBytes+this._cacheOverflowBytes&&(this.memoryAdjustedScreenSpaceError*=1.02)}doUpdate(e){if(\"loadTiles\"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;let n=e instanceof Array?e:[e];this._cache.reset(),this._frameNumber++,this.traverseCounter=n.length;let r=[];for(let i of n){let o=i.id;this._needTraverse(o)?r.push(o):this.traverseCounter--}for(let i of n){let o=i.id;if(this.roots[o]||(this.roots[o]=this._initializeTileHeaders(this.tileset,null)),!r.includes(o))continue;let s=hie(i,this._frameNumber);this._traverser.traverse(this.roots[o],s,this.options)}}_needTraverse(e){let n=e;return this.options.viewportTraversersMap&&(n=this.options.viewportTraversersMap[e]),n===e}_onTraversalEnd(e){let n=e.viewport.id;this.frameStateData[n]||(this.frameStateData[n]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});let r=this.frameStateData[n],i=Object.values(this._traverser.selectedTiles),[o,s]=fie(i,e,this.options.maximumTilesSelected);r.selectedTiles=o;for(let c of s)c.unselect();r._requestedTiles=Object.values(this._traverser.requestedTiles),r._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(let e in this.frameStateData){let n=this.frameStateData[e];this.selectedTiles=this.selectedTiles.concat(n.selectedTiles),this._requestedTiles=this._requestedTiles.concat(n._requestedTiles),this._emptyTiles=this._emptyTiles.concat(n._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(let e of this.selectedTiles)this._tiles[e.id]=e;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(e,n){if(e.length!==n.length)return!0;let r=new Set(e.map(s=>s.id)),i=new Set(n.map(s=>s.id)),o=e.filter(s=>!i.has(s.id)).length>0;return o=o||n.filter(s=>!r.has(s.id)).length>0,o}_loadTiles(){for(let e of this._requestedTiles)e.contentUnloaded&&this._loadTile(e)}_unloadTiles(){this._cache.unloadTiles(this,(e,n)=>e._unloadTile(n))}_updateStats(){let e=0,n=0;for(let r of this.selectedTiles)r.contentAvailable&&r.content&&(e++,r.content.pointCount?n+=r.content.pointCount:n+=r.content.vertexCount);this.stats.get(Rie).count=this.selectedTiles.length,this.stats.get(Bie).count=e,this.stats.get(Fie).count=n,this.stats.get(kie).count=this.memoryAdjustedScreenSpaceError}async _initializeTileSet(e){this.type===Ea.I3S&&(this.calculateViewPropsI3S(),e.root=await e.root),this.root=this._initializeTileHeaders(e,null),this.type===Ea.TILES3D&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===Ea.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){let e=this.tileset.fullExtent;if(e){let{xmin:r,xmax:i,ymin:o,ymax:s,zmin:c,zmax:d}=e;this.cartographicCenter=new $e(r+(i-r)/2,o+(s-o)/2,c+(d-c)/2),this.cartesianCenter=new $e,Or.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),this.zoom=GN(e,this.cartographicCenter,this.cartesianCenter);return}let n=this.tileset.store?.extent;if(n){let[r,i,o,s]=n;this.cartographicCenter=new $e(r+(o-r)/2,i+(s-i)/2,0),this.cartesianCenter=new $e,Or.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),this.zoom=pie(n,this.cartographicCenter,this.cartesianCenter);return}console.warn(\"Extent is not defined in the tileset header\"),this.cartographicCenter=new $e,this.zoom=1}calculateViewPropsTiles3D(){let e=this.root,{center:n}=e.boundingVolume;if(!n){console.warn(\"center was not pre-calculated for the root tile\"),this.cartographicCenter=new $e,this.zoom=1;return}n[0]!==0||n[1]!==0||n[2]!==0?(this.cartographicCenter=new $e,Or.WGS84.cartesianToCartographic(n,this.cartographicCenter)):this.cartographicCenter=new $e(0,0,-Or.WGS84.radii[0]),this.cartesianCenter=n,this.zoom=die(e.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(EP),this.stats.get(ZN),this.stats.get(YN),this.stats.get(Rie),this.stats.get(Bie),this.stats.get(Die),this.stats.get(Lie),this.stats.get(Oie),this.stats.get(Fie),this.stats.get(qN,\"memory\"),this.stats.get(kie)}_initializeTileHeaders(e,n){let r=new f_(this,e.root,n);if(n&&(n.children.push(r),r.depth=n.depth+1),this.type===Ea.TILES3D){let i=[];for(i.push(r);i.length>0;){let o=i.pop();this.stats.get(EP).incrementCount();let s=o.header.children||[];for(let c of s){let d=new f_(this,c,o);if(d.contentUrl?.includes(\"?session=\")){let b=new URL(d.contentUrl).searchParams.get(\"session\");b&&(this._queryParams.session=b)}o.children.push(d),d.depth=o.depth+1,i.push(d)}}}return r}_initializeTraverser(){let e;switch(this.type){case Ea.TILES3D:e=vP;break;case Ea.I3S:e=TP;break;default:e=dd}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(e){this._destroySubtree(e)}async _loadTile(e){let n;try{this._onStartTileLoading(),n=await e.loadContent()}catch(r){this._onTileLoadError(e,r instanceof Error?r:new Error(\"load failed\"))}finally{this._onEndTileLoading(),this._onTileLoad(e,n)}}_onTileLoadError(e,n){this.stats.get(Oie).incrementCount();let r=n.message||n.toString(),i=e.url;console.error(`A 3D tile failed to load: ${e.url} ${r}`),this.options.onTileError(e,r,i)}_onTileLoad(e,n){if(n){if(this.type===Ea.I3S){let r=this.tileset?.nodePagesTile?.nodesInNodePages||0;this.stats.get(EP).reset(),this.stats.get(EP).addCount(r)}e&&e.content&&lie(e,e.content),this.updateContentTypes(e),this._addTileToCache(e),this.options.onTileLoad(e)}}updateContentTypes(e){if(this.type===Ea.I3S)switch(e.header.isDracoGeometry&&(this.contentFormats.draco=!0),e.header.textureFormat){case\"dds\":this.contentFormats.dds=!0;break;case\"ktx2\":this.contentFormats.ktx2=!0;break;default:}else if(this.type===Ea.TILES3D){let{extensionsRemoved:n=[]}=e.content?.gltf||{};n.includes(\"KHR_draco_mesh_compression\")&&(this.contentFormats.draco=!0),n.includes(\"EXT_meshopt_compression\")&&(this.contentFormats.meshopt=!0),n.includes(\"KHR_texture_basisu\")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(ZN).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(ZN).decrementCount()}_addTileToCache(e){this._cache.add(this,e,n=>n._updateCacheStats(e))}_updateCacheStats(e){this.stats.get(Die).incrementCount(),this.stats.get(YN).incrementCount(),this.gpuMemoryUsageInBytes+=e.gpuMemoryUsageInBytes||0,this.stats.get(qN).count=this.gpuMemoryUsageInBytes,this.options.memoryAdjustedScreenSpaceError&&this.adjustScreenSpaceError()}_unloadTile(e){this.gpuMemoryUsageInBytes-=e.gpuMemoryUsageInBytes||0,this.stats.get(YN).decrementCount(),this.stats.get(Lie).incrementCount(),this.stats.get(qN).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}_destroy(){let e=[];for(this.root&&e.push(this.root);e.length>0;){let n=e.pop();for(let r of n.children)e.push(r);this._destroyTile(n)}this.root=null}_destroySubtree(e){let n=e,r=[];for(r.push(n);r.length>0;){e=r.pop();for(let i of e.children)r.push(i);e!==n&&this._destroyTile(e)}n.children=[]}_destroyTile(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}_initializeTiles3DTileset(e){if(e.queryString){let n=new URLSearchParams(e.queryString),r=Object.fromEntries(n.entries());this._queryParams={...this._queryParams,...r}}if(this.asset=e.asset,!this.asset)throw new Error(\"Tileset must have an asset property.\");if(this.asset.version!==\"0.0\"&&this.asset.version!==\"1.0\"&&this.asset.version!==\"1.1\")throw new Error(\"The tileset must be 3D Tiles version either 0.0 or 1.0 or 1.1.\");\"tilesetVersion\"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||\"\",this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed||[],this.extras=e.extras}_initializeI3STileset(){this.loadOptions.i3s&&\"token\"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}};var SP=\"4.3.3\";var d_={COMPOSITE:\"cmpt\",POINT_CLOUD:\"pnts\",BATCHED_3D_MODEL:\"b3dm\",INSTANCED_3D_MODEL:\"i3dm\",GEOMETRY:\"geom\",VECTOR:\"vect\",GLTF:\"glTF\"},u0t=Object.keys(d_);function QN(t,e,n){Rr(t instanceof ArrayBuffer);let r=new TextDecoder(\"utf8\"),i=new Uint8Array(t,e,n);return r.decode(i)}function Nie(t,e=0){let n=new DataView(t);return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}var AIe={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},ws={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},br={...AIe,...ws};var KN={[ws.DOUBLE]:Float64Array,[ws.FLOAT]:Float32Array,[ws.UNSIGNED_SHORT]:Uint16Array,[ws.UNSIGNED_INT]:Uint32Array,[ws.UNSIGNED_BYTE]:Uint8Array,[ws.BYTE]:Int8Array,[ws.SHORT]:Int16Array,[ws.INT]:Int32Array},gIe={DOUBLE:ws.DOUBLE,FLOAT:ws.FLOAT,UNSIGNED_SHORT:ws.UNSIGNED_SHORT,UNSIGNED_INT:ws.UNSIGNED_INT,UNSIGNED_BYTE:ws.UNSIGNED_BYTE,BYTE:ws.BYTE,SHORT:ws.SHORT,INT:ws.INT},JN=\"Failed to convert GL type\",lf=class t{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(let n in KN)if(KN[n]===e)return n;throw new Error(JN)}static fromName(e){let n=gIe[e];if(!n)throw new Error(JN);return n}static getArrayType(e){switch(e){case ws.UNSIGNED_SHORT_5_6_5:case ws.UNSIGNED_SHORT_4_4_4_4:case ws.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:let n=KN[e];if(!n)throw new Error(JN);return n}}static getByteSize(e){return t.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return!!t.getArrayType(e)}static createTypedArray(e,n,r=0,i){i===void 0&&(i=(n.byteLength-r)/t.getByteSize(e));let o=t.getArrayType(e);return new o(n,r,i)}};function zie(t,e){if(!t)throw new Error(`math.gl assertion failed. ${e}`)}function $N(t,e=[0,0,0]){let n=t>>11&31,r=t>>5&63,i=t&31;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}var v0t=1/256;var b0t=new Nm,w0t=new $e,T0t=new Nm,E0t=new Nm,S0t=new Uint8Array(1);function Uie(t,e=255){return Jl(t,0,e)/e*2-1}function Vie(t){return t<0?-1:1}function Gie(t,e,n,r){if(zie(r),t<0||t>n||e<0||e>n)throw new Error(`x and y must be unsigned normalized integers between 0 and ${n}`);if(r.x=Uie(t,n),r.y=Uie(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){let i=r.x;r.x=(1-Math.abs(r.y))*Vie(i),r.y=(1-Math.abs(i))*Vie(r.y)}return r.normalize()}function ez(t,e,n){return Gie(t,e,255,n)}var qp=class{json;buffer;featuresLength=0;_cachedTypedArrays={};constructor(e,n){this.json=e,this.buffer=n}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return!!this.json[e]}getGlobalProperty(e,n=br.UNSIGNED_INT,r=1){let i=this.json[e];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(e,n,r,1,i.byteOffset):i}getPropertyArray(e,n,r){let i=this.json[e];return i&&Number.isFinite(i.byteOffset)?(\"componentType\"in i&&(n=lf.fromName(i.componentType)),this._getTypedArrayFromBinary(e,n,r,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(e,n,i)}getProperty(e,n,r,i,o){let s=this.json[e];if(!s)return s;let c=this.getPropertyArray(e,n,r);if(r===1)return c[i];for(let d=0;d<r;++d)o[d]=c[r*i+d];return o}_getTypedArrayFromBinary(e,n,r,i,o){let s=this._cachedTypedArrays,c=s[e];return c||(c=lf.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+o,i*r),s[e]=c),c}_getTypedArrayFromArray(e,n,r){let i=this._cachedTypedArrays,o=i[e];return o||(o=lf.createTypedArray(n,r),i[e]=o),o}};var mIe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_Ie={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},yIe={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};function Hie(t,e,n,r){let{componentType:i}=t;Rr(t.componentType);let o=typeof i==\"string\"?lf.fromName(i):i,s=mIe[t.type],c=_Ie[t.type],d=yIe[t.type];return n+=t.byteOffset,{values:lf.createTypedArray(o,e,n,s*r),type:o,size:s,unpacker:c,packer:d}}var pd=t=>t!==void 0;function Wie(t,e,n){if(!e)return null;let r=t.getExtension(\"3DTILES_batch_table_hierarchy\"),i=e.HIERARCHY;return i&&(console.warn(\"3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy.\"),e.extensions=e.extensions||{},e.extensions[\"3DTILES_batch_table_hierarchy\"]=i,r=i),r?xIe(r,n):null}function xIe(t,e){let n,r,i,o=t.instancesLength,s=t.classes,c=t.classIds,d=t.parentCounts,m=t.parentIds,b=o;pd(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,o));let C;if(pd(d))for(pd(d.byteOffset)&&(d.componentType=defaultValue(d.componentType,GL.UNSIGNED_SHORT),d.type=AttributeType.SCALAR,i=getBinaryAccessor(d),d=i.createArrayBufferView(e.buffer,e.byteOffset+d.byteOffset,o)),C=new Uint16Array(o),b=0,n=0;n<o;++n)C[n]=b,b+=d[n];pd(m)&&pd(m.byteOffset)&&(m.componentType=defaultValue(m.componentType,GL.UNSIGNED_SHORT),m.type=AttributeType.SCALAR,i=getBinaryAccessor(m),m=i.createArrayBufferView(e.buffer,e.byteOffset+m.byteOffset,b));let B=s.length;for(n=0;n<B;++n){let K=s[n].length,Y=s[n].instances,ee=getBinaryProperties(K,Y,e);s[n].instances=combine(ee,Y)}let k=new Array(B).fill(0),V=new Uint16Array(o);for(n=0;n<o;++n)r=c[n],V[n]=k[r],++k[r];let q={classes:s,classIds:c,classIndexes:V,parentCounts:d,parentIndexes:C,parentIds:m};return wIe(q),q}function C2(t,e,n){if(!t)return;let r=t.parentCounts;return t.parentIds?n(t,e):r>0?vIe(t,e,n):bIe(t,e,n)}function vIe(t,e,n){let r=t.classIds,i=t.parentCounts,o=t.parentIds,s=t.parentIndexes,c=r.length,d=scratchVisited;d.length=Math.max(d.length,c);let m=++marker,b=scratchStack;for(b.length=0,b.push(e);b.length>0;){if(e=b.pop(),d[e]===m)continue;d[e]=m;let C=n(t,e);if(pd(C))return C;let B=i[e],k=s[e];for(let V=0;V<B;++V){let q=o[k+V];q!==e&&b.push(q)}}return null}function bIe(t,e,n){let r=!0;for(;r;){let i=n(t,e);if(pd(i))return i;let o=t.parentIds[e];r=o!==e,e=o}throw new Error(\"traverseHierarchySingleParent\")}function wIe(t){let e=[],r=t.classIds.length;for(let i=0;i<r;++i)jie(t,i,stack)}function jie(t,e,n){let r=t.parentCounts,i=t.parentIds,o=t.parentIndexes,c=t.classIds.length;if(!pd(i))return;assert(e<c,`Parent index ${e} exceeds the total number of instances: ${c}`),assert(n.indexOf(e)===-1,\"Circular dependency detected in the batch table hierarchy.\"),n.push(e);let d=pd(r)?r[e]:1,m=pd(r)?o[e]:e;for(let b=0;b<d;++b){let C=i[m+b];C!==e&&jie(t,C,n)}n.pop(e)}function Ec(t){return t!=null}var CP=(t,e)=>t,TIe={HIERARCHY:!0,extensions:!0,extras:!0},p_=class{json;binary;featureCount;_extensions;_properties;_binaryProperties;_hierarchy;constructor(e,n,r,i={}){Rr(r>=0),this.json=e||{},this.binary=n,this.featureCount=r,this._extensions=this.json?.extensions||{},this._properties={};for(let o in this.json)TIe[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),i[\"3DTILES_batch_table_hierarchy\"]&&(this._hierarchy=Wie(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,n){if(this._checkBatchId(e),Rr(typeof n==\"string\",n),this._hierarchy){let r=C2(this._hierarchy,e,(i,o)=>{let s=i.classIds[o];return i.classes[s].name===n});return Ec(r)}return!1}isExactClass(e,n){return Rr(typeof n==\"string\",n),this.getExactClassName(e)===n}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){let n=this._hierarchy.classIds[e];return this._hierarchy.classes[n].name}}hasProperty(e,n){return this._checkBatchId(e),Rr(typeof n==\"string\",n),Ec(this._properties[n])||this._hasPropertyInHierarchy(e,n)}getPropertyNames(e,n){this._checkBatchId(e),n=Ec(n)?n:[],n.length=0;let r=Object.keys(this._properties);return n.push(...r),this._hierarchy&&this._getPropertyNamesInHierarchy(e,n),n}getProperty(e,n){if(this._checkBatchId(e),Rr(typeof n==\"string\",n),this._binaryProperties){let i=this._binaryProperties[n];if(Ec(i))return this._getBinaryProperty(i,e)}let r=this._properties[n];if(Ec(r))return CP(r[e],!0);if(this._hierarchy){let i=this._getHierarchyProperty(e,n);if(Ec(i))return i}}setProperty(e,n,r){let i=this.featureCount;if(this._checkBatchId(e),Rr(typeof n==\"string\",n),this._binaryProperties){let s=this._binaryProperties[n];if(s){this._setBinaryProperty(s,e,r);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,n,r))return;let o=this._properties[n];Ec(o)||(this._properties[n]=new Array(i),o=this._properties[n]),o[e]=CP(r,!0)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error(\"batchId not in range [0, featureCount - 1].\")}_getBinaryProperty(e,n){return e.unpack(e.typedArray,n)}_setBinaryProperty(e,n,r){e.pack(r,e.typedArray,n)}_initializeBinaryProperties(){let e=null;for(let n in this._properties){let r=this._properties[n],i=this._initializeBinaryProperty(n,r);i&&(e=e||{},e[n]=i)}return e}_initializeBinaryProperty(e,n){if(\"byteOffset\"in n){let r=n;Rr(this.binary,`Property ${e} requires a batch table binary.`),Rr(r.type,`Property ${e} requires a type.`);let i=Hie(r,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(e,n){if(!this._hierarchy)return!1;let r=C2(this._hierarchy,e,(i,o)=>{let s=i.classIds[o],c=i.classes[s].instances;return Ec(c[n])});return Ec(r)}_getPropertyNamesInHierarchy(e,n){C2(this._hierarchy,e,(r,i)=>{let o=r.classIds[i],s=r.classes[o].instances;for(let c in s)s.hasOwnProperty(c)&&n.indexOf(c)===-1&&n.push(c)})}_getHierarchyProperty(e,n){return C2(this._hierarchy,e,(r,i)=>{let o=r.classIds[i],s=r.classes[o],c=r.classIndexes[i],d=s.instances[n];return Ec(d)?Ec(d.typedArray)?this._getBinaryProperty(d,c):CP(d[c],!0):null})}_setHierarchyProperty(e,n,r,i){let o=C2(this._hierarchy,n,(s,c)=>{let d=s.classIds[c],m=s.classes[d],b=s.classIndexes[c],C=m.instances[r];return Ec(C)?(Rr(c===n,`Inherited property \"${r}\" is read-only.`),Ec(C.typedArray)?this._setBinaryProperty(C,b,i):C[b]=CP(i,!0),!0):!1});return Ec(o)}};function eg(t,e,n=0){let r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=4,t.version=r.getUint32(n,!0),n+=4,t.byteLength=r.getUint32(n,!0),n+=4,t.version!==1)throw new Error(`3D Tile Version ${t.version} not supported`);return n}var M2=4,Xie=\"b3dm tile in legacy format.\";function I2(t,e,n){let r=new DataView(e),i;t.header=t.header||{};let o=r.getUint32(n,!0);n+=M2;let s=r.getUint32(n,!0);n+=M2;let c=r.getUint32(n,!0);n+=M2;let d=r.getUint32(n,!0);return n+=M2,c>=570425344?(n-=M2*2,i=o,c=s,d=0,o=0,s=0,console.warn(Xie)):d>=570425344&&(n-=M2,i=c,c=o,d=s,o=0,s=0,console.warn(Xie)),t.header.featureTableJsonByteLength=o,t.header.featureTableBinaryByteLength=s,t.header.batchTableJsonByteLength=c,t.header.batchTableBinaryByteLength=d,t.header.batchLength=i,n}function P2(t,e,n,r){return n=EIe(t,e,n,r),n=SIe(t,e,n,r),n}function EIe(t,e,n,r){let{featureTableJsonByteLength:i,featureTableBinaryByteLength:o,batchLength:s}=t.header||{};if(t.featureTableJson={BATCH_LENGTH:s||0},i&&i>0){let c=QN(e,n,i);t.featureTableJson=JSON.parse(c)}return n+=i||0,t.featureTableBinary=new Uint8Array(e,n,o),n+=o||0,n}function SIe(t,e,n,r){let{batchTableJsonByteLength:i,batchTableBinaryByteLength:o}=t.header||{};if(i&&i>0){let s=QN(e,n,i);t.batchTableJson=JSON.parse(s),n+=i,o&&o>0&&(t.batchTableBinary=new Uint8Array(e,n,o),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=o)}return n}function tz(t,e,n){if(!e&&(!t||!t.batchIds||!n))return null;let{batchIds:r,isRGB565:i,pointCount:o=0}=t;if(r&&n){let s=new Uint8ClampedArray(o*3);for(let c=0;c<o;c++){let d=r[c],b=n.getProperty(d,\"dimensions\").map(C=>C*255);s[c*3]=b[0],s[c*3+1]=b[1],s[c*3+2]=b[2]}return{type:br.UNSIGNED_BYTE,value:s,size:3,normalized:!0}}if(e&&i){let s=new Uint8ClampedArray(o*3);for(let c=0;c<o;c++){let d=$N(e[c]);s[c*3]=d[0],s[c*3+1]=d[1],s[c*3+2]=d[2]}return{type:br.UNSIGNED_BYTE,value:s,size:3,normalized:!0}}return e&&e.length===o*3?{type:br.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:br.UNSIGNED_BYTE,value:e||new Uint8ClampedArray,size:4,normalized:!0}}var Yie=new $e;function Zie(t,e){if(!e)return null;if(t.isOctEncoded16P){let n=new Float32Array((t.pointsLength||0)*3);for(let r=0;r<(t.pointsLength||0);r++)ez(e[r*2],e[r*2+1],Yie),Yie.toArray(n,r*3);return{type:br.FLOAT,size:2,value:n}}return{type:br.FLOAT,size:2,value:e}}function qie(t,e,n){return t.isQuantized?n[\"3d-tiles\"]&&n[\"3d-tiles\"].decodeQuantizedPositions?(t.isQuantized=!1,CIe(t,e)):{type:br.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function CIe(t,e){let n=new $e,r=new Float32Array(t.pointCount*3);for(let i=0;i<t.pointCount;i++)n.set(e[i*3],e[i*3+1],e[i*3+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,i*3);return r}async function Qie(t,e,n,r,i){n=eg(t,e,n),n=I2(t,e,n),n=P2(t,e,n,r),MIe(t);let{featureTable:o,batchTable:s}=IIe(t);return await LIe(t,o,s,r,i),PIe(t,o,r),RIe(t,o,s),BIe(t,o),n}function MIe(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function IIe(t){let e=new qp(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty(\"POINTS_LENGTH\");if(!Number.isFinite(n))throw new Error(\"POINTS_LENGTH must be defined\");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty(\"RTC_CENTER\",br.FLOAT,3);let r=DIe(t,e);return{featureTable:e,batchTable:r}}function PIe(t,e,n){if(t.attributes=t.attributes||{positions:null,colors:null,normals:null,batchIds:null},!t.attributes.positions){if(e.hasProperty(\"POSITION\"))t.attributes.positions=e.getPropertyArray(\"POSITION\",br.FLOAT,3);else if(e.hasProperty(\"POSITION_QUANTIZED\")){let r=e.getPropertyArray(\"POSITION_QUANTIZED\",br.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty(\"QUANTIZED_VOLUME_SCALE\",br.FLOAT,3),!t.quantizedVolumeScale)throw new Error(\"QUANTIZED_VOLUME_SCALE must be defined for quantized positions.\");if(t.quantizedVolumeOffset=e.getGlobalProperty(\"QUANTIZED_VOLUME_OFFSET\",br.FLOAT,3),!t.quantizedVolumeOffset)throw new Error(\"QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.\");t.attributes.positions=qie(t,r,n)}}if(!t.attributes.positions)throw new Error(\"Either POSITION or POSITION_QUANTIZED must be defined.\")}function RIe(t,e,n){if(t.attributes=t.attributes||{positions:null,colors:null,normals:null,batchIds:null},!t.attributes.colors){let r=null;e.hasProperty(\"RGBA\")?(r=e.getPropertyArray(\"RGBA\",br.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty(\"RGB\")?r=e.getPropertyArray(\"RGB\",br.UNSIGNED_BYTE,3):e.hasProperty(\"RGB565\")&&(r=e.getPropertyArray(\"RGB565\",br.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=tz(t,r,n)}e.hasProperty(\"CONSTANT_RGBA\")&&(t.constantRGBA=e.getGlobalProperty(\"CONSTANT_RGBA\",br.UNSIGNED_BYTE,4))}function BIe(t,e){if(t.attributes=t.attributes||{positions:null,colors:null,normals:null,batchIds:null},!t.attributes.normals){let n=null;e.hasProperty(\"NORMAL\")?n=e.getPropertyArray(\"NORMAL\",br.FLOAT,3):e.hasProperty(\"NORMAL_OCT16P\")&&(n=e.getPropertyArray(\"NORMAL_OCT16P\",br.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=Zie(t,n)}}function DIe(t,e){let n=null;if(!t.batchIds&&e.hasProperty(\"BATCH_ID\")&&(t.batchIds=e.getPropertyArray(\"BATCH_ID\",br.UNSIGNED_SHORT,1),t.batchIds)){let r=e.getGlobalProperty(\"BATCH_LENGTH\");if(!r)throw new Error(\"Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.\");let{batchTableJson:i,batchTableBinary:o}=t;n=new p_(i,o,r)}return n}async function LIe(t,e,n,r,i){let o,s,c,d=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions[\"3DTILES_draco_point_compression\"];d&&(c=d.properties);let m=e.getExtension(\"3DTILES_draco_point_compression\");if(m){s=m.properties;let C=m.byteOffset,B=m.byteLength;if(!s||!Number.isFinite(C)||!B)throw new Error(\"Draco properties, byteOffset, and byteLength must be defined\");o=(t.featureTableBinary||[]).slice(C,C+B),t.hasPositions=Number.isFinite(s.POSITION),t.hasColors=Number.isFinite(s.RGB)||Number.isFinite(s.RGBA),t.hasNormals=Number.isFinite(s.NORMAL),t.hasBatchIds=Number.isFinite(s.BATCH_ID),t.isTranslucent=Number.isFinite(s.RGBA)}if(!o)return!0;let b={buffer:o,properties:{...s,...c},featureTableProperties:s,batchTableProperties:c,dequantizeInShader:!1};return await OIe(t,b,r,i)}async function OIe(t,e,n,r){if(!r)return;let i={...n,draco:{...n?.draco,extraAttributes:e.batchTableProperties||{}}};delete i[\"3d-tiles\"];let o=await eu(e.buffer,lP,i,r),s=o.attributes.POSITION&&o.attributes.POSITION.value,c=o.attributes.COLOR_0&&o.attributes.COLOR_0.value,d=o.attributes.NORMAL&&o.attributes.NORMAL.value,m=o.attributes.BATCH_ID&&o.attributes.BATCH_ID.value,b=s&&o.attributes.POSITION.value.quantization,C=d&&o.attributes.NORMAL.value.quantization;if(b){let k=o.POSITION.data.quantization,V=k.range;t.quantizedVolumeScale=new $e(V,V,V),t.quantizedVolumeOffset=new $e(k.minValues),t.quantizedRange=(1<<k.quantizationBits)-1,t.isQuantizedDraco=!0}C&&(t.octEncodedRange=(1<<o.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);let B={};if(e.batchTableProperties)for(let k of Object.keys(e.batchTableProperties))o.attributes[k]&&o.attributes[k].value&&(B[k.toLowerCase()]=o.attributes[k].value);t.attributes={positions:s,colors:tz(t,c,void 0),normals:d,batchIds:m,...B}}var MP={URI:0,EMBEDDED:1};function IP(t,e,n,r){t.rotateYtoZ=!0;let i=(t.byteOffset||0)+(t.byteLength||0)-n;if(i===0)throw new Error(\"glTF byte length must be greater than 0.\");return t.gltfUpAxis=r?.[\"3d-tiles\"]&&r[\"3d-tiles\"].assetGltfUpAxis?r[\"3d-tiles\"].assetGltfUpAxis:\"Y\",t.gltfArrayBuffer=vm(e,n,i),t.gltfByteOffset=0,t.gltfByteLength=i,n%4===0||console.warn(`${t.type}: embedded glb is not aligned to a 4-byte boundary.`),(t.byteOffset||0)+(t.byteLength||0)}async function PP(t,e,n,r){let i=n?.[\"3d-tiles\"]||{};if(FIe(t,e,n),i.loadGLTF){if(!r)return;if(t.gltfUrl){let{fetch:o}=r,s=await o(t.gltfUrl,n);t.gltfArrayBuffer=await s.arrayBuffer(),t.gltfByteOffset=0}if(t.gltfArrayBuffer){let o=await eu(t.gltfArrayBuffer,Xp,n,r);t.gltf=u_(o),t.gpuMemoryUsageInBytes=X3(t.gltf),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength}}}function FIe(t,e,n){switch(e){case MP.URI:if(t.gltfArrayBuffer){let r=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),o=new TextDecoder().decode(r);t.gltfUrl=o.replace(/[\\s\\0]+$/,\"\")}delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case MP.EMBEDDED:break;default:throw new Error(\"b3dm: Illegal glTF format field\")}}async function Kie(t,e,n,r,i){n=kIe(t,e,n,r,i),await PP(t,MP.EMBEDDED,r,i);let o=t?.gltf?.extensions;return o&&o.CESIUM_RTC&&(t.rtcCenter=o.CESIUM_RTC.center),n}function kIe(t,e,n,r,i){n=eg(t,e,n),n=I2(t,e,n),n=P2(t,e,n,r),n=IP(t,e,n,r);let o=new qp(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=o.getGlobalProperty(\"RTC_CENTER\",br.FLOAT,3),n}async function Jie(t,e,n,r,i){return n=NIe(t,e,n,r,i),await PP(t,t.gltfFormat||0,r,i),n}function NIe(t,e,n,r,i){if(n=eg(t,e,n),t.version!==1)throw new Error(`Instanced 3D Model version ${t.version} is not supported`);n=I2(t,e,n);let o=new DataView(e);if(t.gltfFormat=o.getUint32(n,!0),n+=4,n=P2(t,e,n,r),n=IP(t,e,n,r),!t?.header?.featureTableJsonByteLength||t.header.featureTableJsonByteLength===0)throw new Error(\"i3dm parser: featureTableJsonByteLength is zero.\");let s=new qp(t.featureTableJson,t.featureTableBinary),c=s.getGlobalProperty(\"INSTANCES_LENGTH\");if(s.featuresLength=c,!Number.isFinite(c))throw new Error(\"i3dm parser: INSTANCES_LENGTH must be defined\");t.eastNorthUp=s.getGlobalProperty(\"EAST_NORTH_UP\"),t.rtcCenter=s.getGlobalProperty(\"RTC_CENTER\",br.FLOAT,3);let d=new p_(t.batchTableJson,t.batchTableBinary,c);return zIe(t,s,d,c),n}function zIe(t,e,n,r){let i=new Array(r),o=new $e,s=new $e,c=new $e,d=new $e,m=new Mi,b=new qu,C=new $e,B={},k=new wn,V=[],q=[],K=[],Y=[];for(let ee=0;ee<r;ee++){let J;if(e.hasProperty(\"POSITION\"))J=e.getProperty(\"POSITION\",br.FLOAT,3,ee,o);else if(e.hasProperty(\"POSITION_QUANTIZED\")){J=e.getProperty(\"POSITION_QUANTIZED\",br.UNSIGNED_SHORT,3,ee,o);let ge=e.getGlobalProperty(\"QUANTIZED_VOLUME_OFFSET\",br.FLOAT,3);if(!ge)throw new Error(\"i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.\");let Qe=e.getGlobalProperty(\"QUANTIZED_VOLUME_SCALE\",br.FLOAT,3);if(!Qe)throw new Error(\"i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.\");let Ct=65535;for(let Mt=0;Mt<3;Mt++)J[Mt]=J[Mt]/Ct*Qe[Mt]+ge[Mt]}if(!J)throw new Error(\"i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.\");o.copy(J),B.translation=o,t.normalUp=e.getProperty(\"NORMAL_UP\",br.FLOAT,3,ee,V),t.normalRight=e.getProperty(\"NORMAL_RIGHT\",br.FLOAT,3,ee,q);let se=!1;if(t.normalUp){if(!t.normalRight)throw new Error(\"i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.\");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty(\"NORMAL_UP_OCT32P\",br.UNSIGNED_SHORT,2,ee,V),t.octNormalRight=e.getProperty(\"NORMAL_RIGHT_OCT32P\",br.UNSIGNED_SHORT,2,ee,q),t.octNormalUp)throw t.octNormalRight?new Error(\"i3dm: oct-encoded orientation not implemented\"):new Error(\"i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P\");t.eastNorthUp?(Or.WGS84.eastNorthUpToFixedFrame(o,k),k.getRotationMatrix3(m)):m.identity()}se&&(d.copy(s).cross(c).normalize(),m.setColumn(0,s),m.setColumn(1,c),m.setColumn(2,d)),b.fromMatrix3(m),B.rotation=b,C.set(1,1,1);let xe=e.getProperty(\"SCALE\",br.FLOAT,1,ee,K);Number.isFinite(xe)&&C.multiplyByScalar(xe);let Ee=e.getProperty(\"SCALE_NON_UNIFORM\",br.FLOAT,3,ee,V);Ee&&C.scale(Ee),B.scale=C;let Xe=e.getProperty(\"BATCH_ID\",br.UNSIGNED_SHORT,1,ee,Y);Xe===void 0&&(Xe=ee);let Ne=new wn().fromQuaternion(B.rotation);k.identity(),k.translate(B.translation),k.multiplyRight(Ne),k.scale(B.scale);let be=k.clone();i[ee]={modelMatrix:be,batchId:Xe}}t.instances=i}async function $ie(t,e,n,r,i,o){n=eg(t,e,n);let s=new DataView(e);for(t.tilesLength=s.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&(t.byteLength||0)-n>12;){let c={shape:\"tile3d\"};t.tiles.push(c),n=await o(e,n,r,i,c)}return n}async function eoe(t,e,n,r){if(t.rotateYtoZ=!0,t.gltfUpAxis=n?.[\"3d-tiles\"]?.assetGltfUpAxis?n[\"3d-tiles\"].assetGltfUpAxis:\"Y\",n?.[\"3d-tiles\"]?.loadGLTF){if(!r)return e.byteLength;let i=await eu(e,Xp,n,r);t.gltf=u_(i),t.gpuMemoryUsageInBytes=X3(t.gltf)}else t.gltfArrayBuffer=e;return e.byteLength}async function nz(t,e=0,n,r,i={shape:\"tile3d\"}){switch(i.byteOffset=e,i.type=Nie(t,e),i.type){case d_.COMPOSITE:return await $ie(i,t,e,n,r,nz);case d_.BATCHED_3D_MODEL:return await Kie(i,t,e,n,r);case d_.GLTF:return await eoe(i,t,n,r);case d_.INSTANCED_3D_MODEL:return await Jie(i,t,e,n,r);case d_.POINT_CLOUD:return await Qie(i,t,e,n,r);default:throw new Error(`3DTileLoader: unknown type ${i.type}`)}}async function rz(t,e,n){if(new Uint32Array(t.slice(0,4))[0]!==1952609651)throw new Error(\"Wrong subtree file magic number\");if(new Uint32Array(t.slice(4,8))[0]!==1)throw new Error(\"Wrong subtree file verson, must be 1\");let o=toe(t.slice(8,16)),s=new Uint8Array(t,24,o),d=new TextDecoder(\"utf8\").decode(s),m=JSON.parse(d),b=toe(t.slice(16,24)),C=new ArrayBuffer(0);if(b&&(C=t.slice(24+o)),await RP(m,m.tileAvailability,C,n),Array.isArray(m.contentAvailability))for(let B of m.contentAvailability)await RP(m,B,C,n);else await RP(m,m.contentAvailability,C,n);return await RP(m,m.childSubtreeAvailability,C,n),m}async function RP(t,e,n,r){let i=Number.isFinite(e.bitstream)?e.bitstream:e.bufferView;if(typeof i!=\"number\")return;let o=t.bufferViews[i],s=t.buffers[o.buffer];if(!r?.baseUrl)throw new Error(\"Url is not provided\");if(!r.fetch)throw new Error(\"fetch is not provided\");if(s.uri){let d=`${r?.baseUrl||\"\"}/${s.uri}`,b=await(await r.fetch(d)).arrayBuffer();e.explicitBitstream=new Uint8Array(b,o.byteOffset,o.byteLength);return}let c=t.buffers.slice(0,o.buffer).reduce((d,m)=>d+m.byteLength,0);e.explicitBitstream=new Uint8Array(n.slice(c,c+s.byteLength),o.byteOffset,o.byteLength)}function toe(t){let e=new DataView(t),n=e.getUint32(0,!0),r=e.getUint32(4,!0);return n+2**32*r}var BP={dataType:null,batchType:null,id:\"3d-tiles-subtree\",name:\"3D Tiles Subtree\",module:\"3d-tiles\",version:SP,extensions:[\"subtree\"],mimeTypes:[\"application/octet-stream\"],tests:[\"subtree\"],parse:rz,options:{}};hy();var ih=null;try{ih=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Ui(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Ui.prototype.__isLong__;Object.defineProperty(Ui.prototype,\"__isLong__\",{value:!0});function yl(t){return(t&&t.__isLong__)===!0}function noe(t){var e=Math.clz32(t&-t);return t?31-e:e}Ui.isLong=yl;var roe={},ioe={};function A_(t,e){var n,r,i;return e?(t>>>=0,(i=0<=t&&t<256)&&(r=ioe[t],r)?r:(n=fi(t,0,!0),i&&(ioe[t]=n),n)):(t|=0,(i=-128<=t&&t<128)&&(r=roe[t],r)?r:(n=fi(t,t<0?-1:0,!1),i&&(roe[t]=n),n))}Ui.fromInt=A_;function oh(t,e){if(isNaN(t))return e?Qp:cf;if(e){if(t<0)return Qp;if(t>=loe)return hoe}else{if(t<=-soe)return Sc;if(t+1>=soe)return uoe}return t<0?oh(-t,e).neg():fi(t%B2|0,t/B2|0,e)}Ui.fromNumber=oh;function fi(t,e,n){return new Ui(t,e,n)}Ui.fromBits=fi;var DP=Math.pow;function oz(t,e,n){if(t.length===0)throw Error(\"empty string\");if(typeof e==\"number\"?(n=e,e=!1):e=!!e,t===\"NaN\"||t===\"Infinity\"||t===\"+Infinity\"||t===\"-Infinity\")return e?Qp:cf;if(n=n||10,n<2||36<n)throw RangeError(\"radix\");var r;if((r=t.indexOf(\"-\"))>0)throw Error(\"interior hyphen\");if(r===0)return oz(t.substring(1),e,n).neg();for(var i=oh(DP(n,8)),o=cf,s=0;s<t.length;s+=8){var c=Math.min(8,t.length-s),d=parseInt(t.substring(s,s+c),n);if(c<8){var m=oh(DP(n,c));o=o.mul(m).add(oh(d))}else o=o.mul(i),o=o.add(oh(d))}return o.unsigned=e,o}Ui.fromString=oz;function sh(t,e){return typeof t==\"number\"?oh(t,e):typeof t==\"string\"?oz(t,e):fi(t.low,t.high,typeof e==\"boolean\"?e:t.unsigned)}Ui.fromValue=sh;var ooe=65536,UIe=1<<24,B2=ooe*ooe,loe=B2*B2,soe=loe/2,aoe=A_(UIe),cf=A_(0);Ui.ZERO=cf;var Qp=A_(0,!0);Ui.UZERO=Qp;var R2=A_(1);Ui.ONE=R2;var coe=A_(1,!0);Ui.UONE=coe;var iz=A_(-1);Ui.NEG_ONE=iz;var uoe=fi(-1,2147483647,!1);Ui.MAX_VALUE=uoe;var hoe=fi(-1,-1,!0);Ui.MAX_UNSIGNED_VALUE=hoe;var Sc=fi(0,-2147483648,!1);Ui.MIN_VALUE=Sc;var tn=Ui.prototype;tn.toInt=function(){return this.unsigned?this.low>>>0:this.low};tn.toNumber=function(){return this.unsigned?(this.high>>>0)*B2+(this.low>>>0):this.high*B2+(this.low>>>0)};tn.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError(\"radix\");if(this.isZero())return\"0\";if(this.isNegative())if(this.eq(Sc)){var n=oh(e),r=this.div(n),i=r.mul(n).sub(this);return r.toString(e)+i.toInt().toString(e)}else return\"-\"+this.neg().toString(e);for(var o=oh(DP(e,6),this.unsigned),s=this,c=\"\";;){var d=s.div(o),m=s.sub(d.mul(o)).toInt()>>>0,b=m.toString(e);if(s=d,s.isZero())return b+c;for(;b.length<6;)b=\"0\"+b;c=\"\"+b+c}};tn.getHighBits=function(){return this.high};tn.getHighBitsUnsigned=function(){return this.high>>>0};tn.getLowBits=function(){return this.low};tn.getLowBitsUnsigned=function(){return this.low>>>0};tn.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Sc)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&(e&1<<n)==0;n--);return this.high!=0?n+33:n+1};tn.isSafeInteger=function(){var e=this.high>>21;return e?this.unsigned?!1:e===-1&&!(this.low===0&&this.high===-2097152):!0};tn.isZero=function(){return this.high===0&&this.low===0};tn.eqz=tn.isZero;tn.isNegative=function(){return!this.unsigned&&this.high<0};tn.isPositive=function(){return this.unsigned||this.high>=0};tn.isOdd=function(){return(this.low&1)===1};tn.isEven=function(){return(this.low&1)===0};tn.equals=function(e){return yl(e)||(e=sh(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};tn.eq=tn.equals;tn.notEquals=function(e){return!this.eq(e)};tn.neq=tn.notEquals;tn.ne=tn.notEquals;tn.lessThan=function(e){return this.comp(e)<0};tn.lt=tn.lessThan;tn.lessThanOrEqual=function(e){return this.comp(e)<=0};tn.lte=tn.lessThanOrEqual;tn.le=tn.lessThanOrEqual;tn.greaterThan=function(e){return this.comp(e)>0};tn.gt=tn.greaterThan;tn.greaterThanOrEqual=function(e){return this.comp(e)>=0};tn.gte=tn.greaterThanOrEqual;tn.ge=tn.greaterThanOrEqual;tn.compare=function(e){if(yl(e)||(e=sh(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};tn.comp=tn.compare;tn.negate=function(){return!this.unsigned&&this.eq(Sc)?Sc:this.not().add(R2)};tn.neg=tn.negate;tn.add=function(e){yl(e)||(e=sh(e));var n=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,s=e.high>>>16,c=e.high&65535,d=e.low>>>16,m=e.low&65535,b=0,C=0,B=0,k=0;return k+=o+m,B+=k>>>16,k&=65535,B+=i+d,C+=B>>>16,B&=65535,C+=r+c,b+=C>>>16,C&=65535,b+=n+s,b&=65535,fi(B<<16|k,b<<16|C,this.unsigned)};tn.subtract=function(e){return yl(e)||(e=sh(e)),this.add(e.neg())};tn.sub=tn.subtract;tn.multiply=function(e){if(this.isZero())return this;if(yl(e)||(e=sh(e)),ih){var n=ih.mul(this.low,this.high,e.low,e.high);return fi(n,ih.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?Qp:cf;if(this.eq(Sc))return e.isOdd()?Sc:cf;if(e.eq(Sc))return this.isOdd()?Sc:cf;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(aoe)&&e.lt(aoe))return oh(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,o=this.low>>>16,s=this.low&65535,c=e.high>>>16,d=e.high&65535,m=e.low>>>16,b=e.low&65535,C=0,B=0,k=0,V=0;return V+=s*b,k+=V>>>16,V&=65535,k+=o*b,B+=k>>>16,k&=65535,k+=s*m,B+=k>>>16,k&=65535,B+=i*b,C+=B>>>16,B&=65535,B+=o*m,C+=B>>>16,B&=65535,B+=s*d,C+=B>>>16,B&=65535,C+=r*b+i*m+o*d+s*c,C&=65535,fi(k<<16|V,C<<16|B,this.unsigned)};tn.mul=tn.multiply;tn.divide=function(e){if(yl(e)||(e=sh(e)),e.isZero())throw Error(\"division by zero\");if(ih){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?ih.div_u:ih.div_s)(this.low,this.high,e.low,e.high);return fi(n,ih.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Qp:cf;var r,i,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Qp;if(e.gt(this.shru(1)))return coe;o=Qp}else{if(this.eq(Sc)){if(e.eq(R2)||e.eq(iz))return Sc;if(e.eq(Sc))return R2;var s=this.shr(1);return r=s.div(e).shl(1),r.eq(cf)?e.isNegative()?R2:iz:(i=this.sub(e.mul(r)),o=r.add(i.div(e)),o)}else if(e.eq(Sc))return this.unsigned?Qp:cf;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=cf}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var c=Math.ceil(Math.log(r)/Math.LN2),d=c<=48?1:DP(2,c-48),m=oh(r),b=m.mul(e);b.isNegative()||b.gt(i);)r-=d,m=oh(r,this.unsigned),b=m.mul(e);m.isZero()&&(m=R2),o=o.add(m),i=i.sub(b)}return o};tn.div=tn.divide;tn.modulo=function(e){if(yl(e)||(e=sh(e)),ih){var n=(this.unsigned?ih.rem_u:ih.rem_s)(this.low,this.high,e.low,e.high);return fi(n,ih.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};tn.mod=tn.modulo;tn.rem=tn.modulo;tn.not=function(){return fi(~this.low,~this.high,this.unsigned)};tn.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};tn.clz=tn.countLeadingZeros;tn.countTrailingZeros=function(){return this.low?noe(this.low):noe(this.high)+32};tn.ctz=tn.countTrailingZeros;tn.and=function(e){return yl(e)||(e=sh(e)),fi(this.low&e.low,this.high&e.high,this.unsigned)};tn.or=function(e){return yl(e)||(e=sh(e)),fi(this.low|e.low,this.high|e.high,this.unsigned)};tn.xor=function(e){return yl(e)||(e=sh(e)),fi(this.low^e.low,this.high^e.high,this.unsigned)};tn.shiftLeft=function(e){return yl(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fi(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fi(0,this.low<<e-32,this.unsigned)};tn.shl=tn.shiftLeft;tn.shiftRight=function(e){return yl(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fi(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fi(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};tn.shr=tn.shiftRight;tn.shiftRightUnsigned=function(e){return yl(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fi(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?fi(this.high,0,this.unsigned):fi(this.high>>>e-32,0,this.unsigned)};tn.shru=tn.shiftRightUnsigned;tn.shr_u=tn.shiftRightUnsigned;tn.rotateLeft=function(e){var n;return yl(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?fi(this.high,this.low,this.unsigned):e<32?(n=32-e,fi(this.low<<e|this.high>>>n,this.high<<e|this.low>>>n,this.unsigned)):(e-=32,n=32-e,fi(this.high<<e|this.low>>>n,this.low<<e|this.high>>>n,this.unsigned))};tn.rotl=tn.rotateLeft;tn.rotateRight=function(e){var n;return yl(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?fi(this.high,this.low,this.unsigned):e<32?(n=32-e,fi(this.high<<n|this.low>>>e,this.low<<n|this.high>>>e,this.unsigned)):(e-=32,n=32-e,fi(this.low<<n|this.high>>>e,this.high<<n|this.low>>>e,this.unsigned))};tn.rotr=tn.rotateRight;tn.toSigned=function(){return this.unsigned?fi(this.low,this.high,!1):this};tn.toUnsigned=function(){return this.unsigned?this:fi(this.low,this.high,!0)};tn.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};tn.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};tn.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Ui.fromBytes=function(e,n,r){return r?Ui.fromBytesLE(e,n):Ui.fromBytesBE(e,n)};Ui.fromBytesLE=function(e,n){return new Ui(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Ui.fromBytesBE=function(e,n){return new Ui(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};typeof BigInt==\"function\"&&(Ui.fromBigInt=function(e,n){var r=Number(BigInt.asIntN(32,e)),i=Number(BigInt.asIntN(32,e>>BigInt(32)));return fi(r,i,n)},Ui.fromValue=function(e,n){return typeof e==\"bigint\"?Ui.fromBigInt(e,n):sh(e,n)},tn.toBigInt=function(){var e=BigInt(this.low>>>0),n=BigInt(this.unsigned?this.high>>>0:this.high);return n<<BigInt(32)|e});var D2=Ui;var VIe=16;function nT(t){t===\"X\"&&(t=\"\");let e=t.padEnd(VIe,\"0\");return D2.fromString(e,!0,16)}function sz(t){if(t.isZero())return\"X\";let e=t.countTrailingZeros(),n=e%4;e=(e-n)/4;let r=e;e*=4;let o=t.shiftRightUnsigned(e).toString(16).replace(/0+$/,\"\");return Array(17-r-o.length).join(\"0\")+o}function az(t,e){let n=GIe(t).shiftRightUnsigned(2);return t.add(D2.fromNumber(2*e+1-4).multiply(n))}function GIe(t){return t.and(t.not().add(1))}var HIe=3,WIe=30,jIe=2*WIe+1,foe=180/Math.PI;function poe(t){if(t.length===0)throw new Error(`Invalid Hilbert quad key ${t}`);let e=t.split(\"/\"),n=parseInt(e[0],10),r=e[1],i=r.length,o=0,s=[0,0];for(let c=i-1;c>=0;c--){o=i-c;let d=r[c],m=0,b=0;d===\"1\"?b=1:d===\"2\"?(m=1,b=1):d===\"3\"&&(m=1);let C=Math.pow(2,o-1);XIe(C,s,m,b),s[0]+=C*m,s[1]+=C*b}if(n%2===1){let c=s[0];s[0]=s[1],s[1]=c}return{face:n,ij:s,level:o}}function Aoe(t){if(t.isZero())return\"\";let e=t.toString(2);for(;e.length<HIe+jIe;)e=\"0\"+e;let n=e.lastIndexOf(\"1\"),r=e.substring(0,3),i=e.substring(3,n),o=i.length/2,s=D2.fromString(r,!0,2).toString(10),c=\"\";if(o!==0)for(c=D2.fromString(i,!0,2).toString(4);c.length<o;)c=\"0\"+c;return`${s}/${c}`}function lz(t,e,n){let r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function doe(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function cz(t){return[doe(t[0]),doe(t[1])]}function uz(t,[e,n]){switch(t){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error(\"Invalid face\")}}function hz([t,e,n]){let r=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*foe,r*foe]}function XIe(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);let i=e[0];e[0]=e[1],e[1]=i}}function goe(t){let e=lz(t.ij,t.level,[.5,.5]),n=cz(e),r=uz(t.face,n);return hz(r)}var YIe=100;function fz(t){let{face:e,ij:n,level:r}=t,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],o=Math.max(1,Math.ceil(YIe*Math.pow(2,-r))),s=new Float64Array(4*o*2+2),c=0,d=0;for(let m=0;m<4;m++){let b=i[m].slice(0),C=i[m+1],B=(C[0]-b[0])/o,k=(C[1]-b[1])/o;for(let V=0;V<o;V++){b[0]+=B,b[1]+=k;let q=lz(n,r,b),K=cz(q),Y=uz(e,K),ee=hz(Y);Math.abs(ee[1])>89.999&&(ee[0]=d);let J=ee[0]-d;ee[0]+=J>180?-360:J<-180?360:0,s[c++]=ee[0],s[c++]=ee[1],d=ee[0]}}return s[c++]=s[0],s[c++]=s[1],s}function L2(t){let e=ZIe(t);return poe(e)}function ZIe(t){if(t.indexOf(\"/\")>0)return t;let e=nT(t);return Aoe(e)}function dz(t){let e=L2(t);return goe(e)}function _oe(t){let e;if(t.face===2||t.face===5){let n=null,r=0;for(let i=0;i<4;i++){let o=`${t.face}/${i}`,s=L2(o),c=fz(s);(typeof n>\"u\"||n===null)&&(n=new Float64Array(4*c.length)),n.set(c,r),r+=c.length}e=moe(n)}else{let n=fz(t);e=moe(n)}return e}function moe(t){if(t.length%2!==0)throw new Error(\"Invalid corners\");let e=[],n=[];for(let r=0;r<t.length;r+=2)e.push(t[r]),n.push(t[r+1]);return e.sort((r,i)=>r-i),n.sort((r,i)=>r-i),{west:e[0],east:e[e.length-1],north:n[n.length-1],south:n[0]}}function pz(t,e){let n=e?.minimumHeight||0,r=e?.maximumHeight||0,i=L2(t),o=_oe(i),s=o.west,c=o.south,d=o.east,m=o.north,b=[];return b.push(new $e(s,m,n)),b.push(new $e(d,m,n)),b.push(new $e(d,c,n)),b.push(new $e(s,c,n)),b.push(new $e(s,m,r)),b.push(new $e(d,m,r)),b.push(new $e(d,c,r)),b.push(new $e(s,c,r)),b}function LP(t){let e=t.token,n={minimumHeight:t.minimumHeight,maximumHeight:t.maximumHeight},r=pz(e,n),i=dz(e),o=i[0],s=i[1],c=Or.WGS84.cartographicToCartesian([o,s,n.maximumHeight]),d=new $e(c[0],c[1],c[2]);r.push(d);let m=N3(r);return[...m.center,...m.halfAxes]}var qIe=4,QIe=8,KIe={QUADTREE:qIe,OCTREE:QIe};function JIe(t,e,n){if(t?.box){let r=nT(t.s2VolumeInfo.token),i=az(r,e),o=sz(i),s={...t.s2VolumeInfo};switch(s.token=o,n){case\"OCTREE\":let m=t.s2VolumeInfo,b=m.maximumHeight-m.minimumHeight,C=b/2,B=m.minimumHeight+b/2;m.minimumHeight=B-C,m.maximumHeight=B+C;break;default:break}return{box:LP(s),s2VolumeInfo:s}}}async function gz(t){let{subtree:e,subtreeData:n={level:0,x:0,y:0,z:0},parentData:r={mortonIndex:0,localLevel:-1,localX:0,localY:0,localZ:0},childIndex:i=0,implicitOptions:o,loaderOptions:s,s2VolumeBox:c}=t,{subdivisionScheme:d,subtreeLevels:m,maximumLevel:b,contentUrlTemplate:C,subtreesUriTemplate:B,basePath:k}=o,V={children:[],lodMetricValue:0,contentUrl:\"\"};if(!b)return DL.once(`Missing 'maximumLevel' or 'availableLevels' property. The subtree ${C} won't be loaded...`),V;let q=r.localLevel+1,K=n.level+q;if(K>b)return V;let Y=KIe[d],ee=Math.log2(Y),J=i&1,se=i>>1&1,xe=i>>2&1,Ee=g_(r.localX,J,1),Xe=g_(r.localY,se,1),Ne=g_(r.localZ,xe,1),be=g_(n.x,Ee,q),ge=g_(n.y,Xe,q),Qe=g_(n.z,Ne,q),Ct=g_(r.mortonIndex,i,ee),Mt=q===m&&Az(e.childSubtreeAvailability,Ct),mt,jt,Mn,rn;if(Mt){let Pn=`${k}/${B}`,_n=OP(Pn,K,be,ge,Qe);mt=await va(_n,BP,s),rn=0,jt={level:K,x:be,y:ge,z:Qe},Mn={mortonIndex:0,localLevel:0,localX:0,localY:0,localZ:0}}else mt=e,rn=(Y**q-1)/(Y-1)+Ct,jt=n,Mn={mortonIndex:Ct,localLevel:q,localX:Ee,localY:Xe,localZ:Ne};if(!Az(mt.tileAvailability,rn))return V;Az(mt.contentAvailability,rn)&&(V.contentUrl=OP(C,K,be,ge,Qe));for(let Pn=0;Pn<Y;Pn++){let _n=JIe(c,Pn,d),tr=await gz({subtree:mt,subtreeData:jt,parentData:Mn,childIndex:Pn,implicitOptions:o,loaderOptions:s,s2VolumeBox:_n});(tr.contentUrl||tr.children.length)&&V.children.push(tr)}return V.contentUrl||V.children.length?$Ie(V,{level:K,x:be,y:ge,z:Qe},o,c):V}function Az(t,e){let n;return Array.isArray(t)?(n=t[0],t.length>1&&DL.once('Not supported extension \"3DTILES_multiple_contents\" has been detected')):n=t,\"constant\"in n?!!n.constant:n.explicitBitstream?nPe(e,n.explicitBitstream):!1}function $Ie(t,e,n,r){let{basePath:i,refine:o,getRefine:s,lodMetricType:c,getTileType:d,rootLodMetricValue:m,rootBoundingVolume:b}=n,C=t.contentUrl&&t.contentUrl.replace(`${i}/`,\"\"),B=m/2**e.level,k=r?.box?{box:r.box}:b,V=ePe(k,e,n.subdivisionScheme);return{children:t.children,contentUrl:t.contentUrl,content:{uri:C},id:t.contentUrl,refine:s(o),type:d(t),lodMetricType:c,lodMetricValue:B,geometricError:B,transform:t.transform,boundingVolume:V}}function ePe(t,e,n){if(t.region){let{level:r,x:i,y:o,z:s}=e,[c,d,m,b,C,B]=t.region,k=2**r,V=(m-c)/k,[q,K]=[c+V*i,c+V*(i+1)],Y=(b-d)/k,[ee,J]=[d+Y*o,d+Y*(o+1)],se,xe;if(n===\"OCTREE\"){let Ee=(B-C)/k;[se,xe]=[C+Ee*s,C+Ee*(s+1)]}else[se,xe]=[C,B];return{region:[q,ee,K,J,se,xe]}}if(t.box)return t;throw new Error(`Unsupported bounding volume type ${JSON.stringify(t)}`)}function g_(t,e,n){return(t<<n)+e}function OP(t,e,n,r,i){let o=tPe({level:e,x:n,y:r,z:i});return t.replace(/{level}|{x}|{y}|{z}/gi,s=>o[s])}function tPe(t){let e={};for(let n in t)e[`{${n}}`]=t[n];return e}function nPe(t,e){let n=Math.floor(t/8),r=t%8;return(e[n]>>r&1)===1}function _z(t,e=\"\"){if(!e)return rh.EMPTY;let r=e.split(\"?\")[0].split(\".\").pop();switch(r){case\"pnts\":return rh.POINTCLOUD;case\"i3dm\":case\"b3dm\":case\"glb\":case\"gltf\":return rh.SCENEGRAPH;default:return r||rh.EMPTY}}function yz(t){switch(t){case\"REPLACE\":case\"replace\":return ml.REPLACE;case\"ADD\":case\"add\":return ml.ADD;default:return t}}function mz(t,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){let r=new URL(t,`${e}/`);return decodeURI(r.toString())}else if(t.startsWith(\"/\"))return t;return tu.resolve(e,t)}function yoe(t,e){if(!t)return null;let n;if(t.content){let i=t.content.uri||t.content?.url;typeof i<\"u\"&&(n=mz(i,e))}return{...t,id:n,contentUrl:n,lodMetricType:Zp.GEOMETRIC_ERROR,lodMetricValue:t.geometricError,transformMatrix:t.transform,type:_z(t,n),refine:yz(t.refine)}}async function boe(t,e,n){let r=null,i=voe(t.root);i&&t.root?r=await xoe(t.root,t,e,i,n):r=yoe(t.root,e);let o=[];for(o.push(r);o.length>0;){let s=o.pop()||{},c=s.children||[],d=[];for(let m of c){let b=voe(m),C;b?C=await xoe(m,t,e,b,n):C=yoe(m,e),C&&(d.push(C),o.push(C))}s.children=d}return r}async function xoe(t,e,n,r,i){let{subdivisionScheme:o,maximumLevel:s,availableLevels:c,subtreeLevels:d,subtrees:{uri:m}}=r,b=OP(m,0,0,0,0),C=mz(b,n),B=await va(C,BP,i),k=t.content?.uri,V=k?mz(k,n):\"\",q=e?.root?.refine,K=t.geometricError,Y=t.boundingVolume.extensions?.[\"3DTILES_bounding_volume_S2\"];if(Y){let xe={box:LP(Y),s2VolumeInfo:Y};t.boundingVolume=xe}let ee=t.boundingVolume,J={contentUrlTemplate:V,subtreesUriTemplate:m,subdivisionScheme:o,subtreeLevels:d,maximumLevel:Number.isFinite(c)?c-1:s,refine:q,basePath:n,lodMetricType:Zp.GEOMETRIC_ERROR,rootLodMetricValue:K,rootBoundingVolume:ee,getTileType:_z,getRefine:yz};return await rPe(t,n,B,J,i)}async function rPe(t,e,n,r,i){if(!t)return null;let{children:o,contentUrl:s}=await gz({subtree:n,implicitOptions:r,loaderOptions:i}),c,d=null;return s&&(c=s,d={uri:s.replace(`${e}/`,\"\")}),{...t,id:c,contentUrl:c,lodMetricType:Zp.GEOMETRIC_ERROR,lodMetricValue:t.geometricError,transformMatrix:t.transform,type:_z(t,c),refine:yz(t.refine),content:d||t.content,children:o}}function voe(t){return t?.extensions?.[\"3DTILES_implicit_tiling\"]||t?.implicitTiling}var FP={dataType:null,batchType:null,id:\"3d-tiles\",name:\"3D Tiles\",module:\"3d-tiles\",version:SP,extensions:[\"cmpt\",\"pnts\",\"b3dm\",\"i3dm\"],mimeTypes:[\"application/octet-stream\"],tests:[\"cmpt\",\"pnts\",\"b3dm\",\"i3dm\"],parse:iPe,options:{\"3d-tiles\":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:\"auto\",assetGltfUpAxis:null}}};async function iPe(t,e={},n){let r=e[\"3d-tiles\"]||{},i;return r.isTileset===\"auto\"?i=n?.url&&n.url.indexOf(\".json\")!==-1:i=r.isTileset,i?oPe(t,e,n):sPe(t,e,n)}async function oPe(t,e,n){let r=JSON.parse(new TextDecoder().decode(t)),i=n?.url||\"\",o=aPe(i),s=await boe(r,o,e||{});return{...r,shape:\"tileset3d\",loader:FP,url:i,queryString:n?.queryString||\"\",basePath:o,root:s||r.root,type:Ea.TILES3D,lodMetricType:Zp.GEOMETRIC_ERROR,lodMetricValue:r.root?.geometricError||0}}async function sPe(t,e,n){let r={content:{shape:\"tile3d\",featureIds:null}};return await nz(t,0,e,n,r.content),r.content}function aPe(t){return tu.dirname(t)}var woe=[0],lPe={getPointColor:{type:\"accessor\",value:[0,0,0,255]},pointSize:1,data:\"\",loader:FP,onTilesetLoad:{type:\"function\",value:t=>{}},onTileLoad:{type:\"function\",value:t=>{}},onTileUnload:{type:\"function\",value:t=>{}},onTileError:{type:\"function\",value:(t,e,n)=>{}},_getMeshColor:{type:\"function\",value:t=>[255,255,255]}},rT=class extends xs{initializeState(){\"onTileLoadFail\"in this.props&&hn.removed(\"onTileLoadFail\",\"onTileError\")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){return!!(this.state?.tileset3d?.isLoaded()&&super.isLoaded)}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({props:e,oldProps:n,changeFlags:r}){if(e.data&&e.data!==n.data&&this._loadTileset(e.data),r.viewportChanged){let{activeViewports:i}=this.state;Object.keys(i).length&&(this._updateTileset(i),this.state.lastUpdatedViewports=i,this.state.activeViewports={})}if(r.propsChanged){let{layerMap:i}=this.state;for(let o in i)i[o].needsUpdate=!0}}activateViewport(e){let{activeViewports:n,lastUpdatedViewports:r}=this.state;this.internalState.viewport=e,n[e.id]=e;let i=r?.[e.id];(!i||!e.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:e,sourceLayer:n}){let r=n&&n.props.tile;return e.picked&&(e.object=r),e.sourceTile=r,e}filterSubLayer({layer:e,viewport:n}){let{tile:r}=e.props,{id:i}=n;return r.selected&&r.viewportIds.includes(i)}_updateAutoHighlight(e){let n=e.sourceTile,r=this.state.layerMap[n?.id];r&&r.layer&&r.layer.updateAutoHighlight(e)}async _loadTileset(e){let{loadOptions:n={}}=this.props,r=this.props.loader||this.props.loaders,i=Array.isArray(r)?r[0]:r,o={loadOptions:{...n}},s=e;if(i.preload){let m=await i.preload(e,n);m.url&&(s=m.url),m.headers&&(o.loadOptions.fetch={...o.loadOptions.fetch,headers:m.headers}),Object.assign(o,m)}let c=await va(s,i,o.loadOptions),d=new tT(c,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...o});this.setState({tileset3d:d,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(d)}_onTileLoad(e){let{lastUpdatedViewports:n}=this.state;this.props.onTileLoad(e),this._updateTileset(n),this.setNeedsUpdate()}_onTileUnload(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}_updateTileset(e){if(!e)return;let{tileset3d:n}=this.state,{timeline:r}=this.context,i=Object.keys(e).length;!r||!i||!n||n.selectTiles(Object.values(e)).then(o=>{this.state.frameNumber!==o&&this.setState({frameNumber:o})})}_getSubLayer(e,n){if(!e.content)return null;switch(e.type){case rh.POINTCLOUD:return this._makePointCloudLayer(e,n);case rh.SCENEGRAPH:return this._make3DModelLayer(e);case rh.MESH:return this._makeSimpleMeshLayer(e,n);default:throw new Error(`Tile3DLayer: Failed to render layer of type ${e.content.type}`)}}_makePointCloudLayer(e,n){let{attributes:r,pointCount:i,constantRGBA:o,cartographicOrigin:s,modelMatrix:c}=e.content,{positions:d,normals:m,colors:b}=r;if(!d)return null;let C=n&&n.props.data||{header:{vertexCount:i},attributes:{POSITION:d,NORMAL:m,COLOR_0:b}},{pointSize:B,getPointColor:k}=this.props,V=this.getSubLayerClass(\"pointcloud\",t2);return new V({pointSize:B},this.getSubLayerProps({id:\"pointcloud\"}),{id:`${this.id}-pointcloud-${e.id}`,tile:e,data:C,coordinateSystem:Cn.METER_OFFSETS,coordinateOrigin:s,modelMatrix:c,getColor:o||k,_offset:0})}_make3DModelLayer(e){let{gltf:n,instances:r,cartographicOrigin:i,modelMatrix:o}=e.content,s=this.getSubLayerClass(\"scenegraph\",hP);return new s({_lighting:\"pbr\"},this.getSubLayerProps({id:\"scenegraph\"}),{id:`${this.id}-scenegraph-${e.id}`,tile:e,data:r||woe,scenegraph:n,coordinateSystem:Cn.METER_OFFSETS,coordinateOrigin:i,modelMatrix:o,getTransformMatrix:c=>c.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(e,n){let r=e.content,{attributes:i,indices:o,modelMatrix:s,cartographicOrigin:c,coordinateSystem:d=Cn.METER_OFFSETS,material:m,featureIds:b}=r,{_getMeshColor:C}=this.props,B=n&&n.props.mesh||new gi({topology:\"triangle-list\",attributes:cPe(i),indices:o}),k=this.getSubLayerClass(\"mesh\",tie);return new k(this.getSubLayerProps({id:\"mesh\"}),{id:`${this.id}-mesh-${e.id}`,tile:e,mesh:B,data:woe,getColor:C(e),pbrMaterial:m,modelMatrix:s,coordinateOrigin:c,coordinateSystem:d,featureIds:b,_offset:0})}renderLayers(){let{tileset3d:e,layerMap:n}=this.state;return e?e.tiles.map(r=>{let i=n[r.id]=n[r.id]||{tile:r},{layer:o}=i;return r.selected&&(o?i.needsUpdate&&(o=this._getSubLayer(r,o),i.needsUpdate=!1):o=this._getSubLayer(r)),i.layer=o,o}).filter(Boolean):null}};rT.defaultProps=lPe;rT.layerName=\"Tile3DLayer\";var kP=rT;function cPe(t){let e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}var uPe=new Map([[\"centerX\",Float64Array.BYTES_PER_ELEMENT],[\"centerY\",Float64Array.BYTES_PER_ELEMENT],[\"centerZ\",Float64Array.BYTES_PER_ELEMENT],[\"minHeight\",Float32Array.BYTES_PER_ELEMENT],[\"maxHeight\",Float32Array.BYTES_PER_ELEMENT],[\"boundingSphereCenterX\",Float64Array.BYTES_PER_ELEMENT],[\"boundingSphereCenterY\",Float64Array.BYTES_PER_ELEMENT],[\"boundingSphereCenterZ\",Float64Array.BYTES_PER_ELEMENT],[\"boundingSphereRadius\",Float64Array.BYTES_PER_ELEMENT],[\"horizonOcclusionPointX\",Float64Array.BYTES_PER_ELEMENT],[\"horizonOcclusionPointY\",Float64Array.BYTES_PER_ELEMENT],[\"horizonOcclusionPointZ\",Float64Array.BYTES_PER_ELEMENT]]);function xz(t){return t>>1^-(t&1)}function hPe(t){let e=0,n={};for(let[r,i]of uPe){let o=i===8?t.getFloat64:t.getFloat32;n[r]=o.call(t,e,!0),e+=i}return{header:n,headerEndPosition:e}}function fPe(t,e){let n=e,r=3,i=t.getUint32(n,!0),o=new Uint16Array(i*r);n+=Uint32Array.BYTES_PER_ELEMENT;let s=Uint16Array.BYTES_PER_ELEMENT,c=i*s,d=n,m=d+c,b=m+c,C=0,B=0,k=0;for(let V=0;V<i;V++)C+=xz(t.getUint16(d+s*V,!0)),B+=xz(t.getUint16(m+s*V,!0)),k+=xz(t.getUint16(b+s*V,!0)),o[V]=C,o[V+i]=B,o[V+i*2]=k;return n+=c*3,{vertexData:o,vertexDataEndPosition:n}}function iT(t,e,n,r,i=!0){let o;if(r===2?o=new Uint16Array(t,e,n):o=new Uint32Array(t,e,n),!i)return o;let s=0;for(let c=0;c<o.length;++c){let d=o[c];o[c]=s-d,d===0&&++s}return o}function dPe(t,e,n){let r=n,s=e.length/3>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT;r%s!==0&&(r+=s-r%s);let c=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;let d=c*3,m=iT(t.buffer,r,d,s);return r+=d*s,{triangleIndicesEndPosition:r,triangleIndices:m}}function pPe(t,e,n){let r=n,s=e.length/3>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT,c=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;let d=iT(t.buffer,r,c,s,!1);r+=c*s;let m=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;let b=iT(t.buffer,r,m,s,!1);r+=m*s;let C=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;let B=iT(t.buffer,r,C,s,!1);r+=C*s;let k=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;let V=iT(t.buffer,r,k,s,!1);return r+=k*s,{edgeIndicesEndPosition:r,westIndices:d,southIndices:b,eastIndices:B,northIndices:V}}function APe(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function gPe(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}function mPe(t,e){let n={};if(t.byteLength<=e)return{extensions:n,extensionsEndPosition:e};let r=e;for(;r<t.byteLength;){let i=t.getUint8(r,!0);r+=Uint8Array.BYTES_PER_ELEMENT;let o=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;let s=new DataView(t.buffer,r,o);switch(i){case 1:{n.vertexNormals=APe(s);break}case 2:{n.waterMask=gPe(s);break}default:}r+=o}return{extensions:n,extensionsEndPosition:r}}var m_={header:0,vertices:1,triangleIndices:2,edgeIndices:3,extensions:4},_Pe={maxDecodingStep:m_.extensions};function vz(t,e){let n=Object.assign({},_Pe,e),r=new DataView(t),{header:i,headerEndPosition:o}=hPe(r);if(n.maxDecodingStep<m_.vertices)return{header:i};let{vertexData:s,vertexDataEndPosition:c}=fPe(r,o);if(n.maxDecodingStep<m_.triangleIndices)return{header:i,vertexData:s};let{triangleIndices:d,triangleIndicesEndPosition:m}=dPe(r,s,c);if(n.maxDecodingStep<m_.edgeIndices)return{header:i,vertexData:s,triangleIndices:d};let{westIndices:b,southIndices:C,eastIndices:B,northIndices:k,edgeIndicesEndPosition:V}=pPe(r,s,m);if(n.maxDecodingStep<m_.extensions)return{header:i,vertexData:s,triangleIndices:d,westIndices:b,northIndices:k,eastIndices:B,southIndices:C};let{extensions:q}=mPe(r,V);return{header:i,vertexData:s,triangleIndices:d,westIndices:b,northIndices:k,eastIndices:B,southIndices:C,extensions:q}}function NP(t,e,n,r){let i=r?xPe(r,t.POSITION.value):yPe(e),o=new t.POSITION.value.constructor(i.length*6),s=new t.TEXCOORD_0.value.constructor(i.length*4),c=new e.constructor(i.length*6);for(let m=0;m<i.length;m++){let b=i[m];vPe({edge:b,edgeIndex:m,attributes:t,skirtHeight:n,newPosition:o,newTexcoord0:s,newTriangles:c})}t.POSITION.value=tb(t.POSITION.value,o),t.TEXCOORD_0.value=tb(t.TEXCOORD_0.value,s);let d=e instanceof Array?e.concat(c):tb(e,c);return{attributes:t,triangles:d}}function yPe(t){let e=[];for(let i=0;i<t.length;i+=3)e.push([t[i],t[i+1]]),e.push([t[i+1],t[i+2]]),e.push([t[i+2],t[i]]);e.sort((i,o)=>Math.min(...i)-Math.min(...o)||Math.max(...i)-Math.max(...o));let n=[],r=0;for(;r<e.length;)e[r][0]===e[r+1]?.[1]&&e[r][1]===e[r+1]?.[0]?r+=2:(n.push(e[r]),r++);return n}function xPe(t,e){t.westIndices.sort((r,i)=>e[3*r+1]-e[3*i+1]),t.eastIndices.sort((r,i)=>e[3*i+1]-e[3*r+1]),t.southIndices.sort((r,i)=>e[3*i]-e[3*r]),t.northIndices.sort((r,i)=>e[3*r]-e[3*i]);let n=[];for(let r in t){let i=t[r];for(let o=0;o<i.length-1;o++)n.push([i[o],i[o+1]])}return n}function vPe({edge:t,edgeIndex:e,attributes:n,skirtHeight:r,newPosition:i,newTexcoord0:o,newTriangles:s}){let c=n.POSITION.value.length,d=e*2,m=e*2+1;i.set(n.POSITION.value.subarray(t[0]*3,t[0]*3+3),d*3),i[d*3+2]=i[d*3+2]-r,i.set(n.POSITION.value.subarray(t[1]*3,t[1]*3+3),m*3),i[m*3+2]=i[m*3+2]-r,o.set(n.TEXCOORD_0.value.subarray(t[0]*2,t[0]*2+2),d*2),o.set(n.TEXCOORD_0.value.subarray(t[1]*2,t[1]*2+2),m*2);let b=e*2*3;s[b]=t[0],s[b+1]=c/3+m,s[b+2]=t[1],s[b+3]=c/3+m,s[b+4]=t[0],s[b+5]=c/3+d}function bz(t,e={}){let{bounds:n}=e,{header:r,vertexData:i,triangleIndices:o,westIndices:s,northIndices:c,eastIndices:d,southIndices:m}=vz(t,m_.triangleIndices),b=o,C=bPe(i,r,n),B=wp(C);if(e?.skirtHeight){let{attributes:k,triangles:V}=NP(C,b,e.skirtHeight,{westIndices:s,northIndices:c,eastIndices:d,southIndices:m});C=k,b=V}return{loaderData:{header:{}},header:{vertexCount:b.length,boundingBox:B},schema:void 0,topology:\"triangle-list\",mode:4,indices:{value:b,size:1},attributes:C}}function bPe(t,e,n){let{minHeight:r,maxHeight:i}=e,[o,s,c,d]=n||[0,0,1,1],m=c-o,b=d-s,C=i-r,B=t.length/3,k=new Float32Array(B*3),V=new Float32Array(B*2);for(let q=0;q<B;q++){let K=t[q]/32767,Y=t[q+B]/32767,ee=t[q+B*2]/32767;k[3*q+0]=K*m+o,k[3*q+1]=Y*b+s,k[3*q+2]=ee*C+r,V[2*q+0]=K,V[2*q+1]=Y}return{POSITION:{value:k,size:3},TEXCOORD_0:{value:V,size:2}}}var oT=class{constructor(e=257){this.gridSize=e;let n=e-1;if(n&n-1)throw new Error(`Expected grid size to be 2^n+1, got ${e}.`);this.numTriangles=n*n*2-2,this.numParentTriangles=this.numTriangles-n*n,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(this.numTriangles*4);for(let r=0;r<this.numTriangles;r++){let i=r+2,o=0,s=0,c=0,d=0,m=0,b=0;for(i&1?c=d=m=n:o=s=b=n;(i>>=1)>1;){let B=o+c>>1,k=s+d>>1;i&1?(c=o,d=s,o=m,s=b):(o=c,s=d,c=m,d=b),m=B,b=k}let C=r*4;this.coords[C+0]=o,this.coords[C+1]=s,this.coords[C+2]=c,this.coords[C+3]=d}}createTile(e){return new wz(e,this)}},wz=class{constructor(e,n){let r=n.gridSize;if(e.length!==r*r)throw new Error(`Expected terrain data of length ${r*r} (${r} x ${r}), got ${e.length}.`);this.terrain=e,this.martini=n,this.errors=new Float32Array(e.length),this.update()}update(){let{numTriangles:e,numParentTriangles:n,coords:r,gridSize:i}=this.martini,{terrain:o,errors:s}=this;for(let c=e-1;c>=0;c--){let d=c*4,m=r[d+0],b=r[d+1],C=r[d+2],B=r[d+3],k=m+C>>1,V=b+B>>1,q=k+V-b,K=V+m-k,Y=(o[b*i+m]+o[B*i+C])/2,ee=V*i+k,J=Math.abs(Y-o[ee]);if(s[ee]=Math.max(s[ee],J),c<n){let se=(b+K>>1)*i+(m+q>>1),xe=(B+K>>1)*i+(C+q>>1);s[ee]=Math.max(s[ee],s[se],s[xe])}}}getMesh(e=0){let{gridSize:n,indices:r}=this.martini,{errors:i}=this,o=0,s=0,c=n-1;r.fill(0);function d(k,V,q,K,Y,ee){let J=k+q>>1,se=V+K>>1;Math.abs(k-Y)+Math.abs(V-ee)>1&&i[se*n+J]>e?(d(Y,ee,k,V,J,se),d(q,K,Y,ee,J,se)):(r[V*n+k]=r[V*n+k]||++o,r[K*n+q]=r[K*n+q]||++o,r[ee*n+Y]=r[ee*n+Y]||++o,s++)}d(0,0,c,c,c,0),d(c,c,0,0,0,c);let m=new Uint16Array(o*2),b=new Uint32Array(s*3),C=0;function B(k,V,q,K,Y,ee){let J=k+q>>1,se=V+K>>1;if(Math.abs(k-Y)+Math.abs(V-ee)>1&&i[se*n+J]>e)B(Y,ee,k,V,J,se),B(q,K,Y,ee,J,se);else{let xe=r[V*n+k]-1,Ee=r[K*n+q]-1,Xe=r[ee*n+Y]-1;m[2*xe]=k,m[2*xe+1]=V,m[2*Ee]=q,m[2*Ee+1]=K,m[2*Xe]=Y,m[2*Xe+1]=ee,b[C++]=xe,b[C++]=Ee,b[C++]=Xe}}return B(0,0,c,c,c,0),B(c,c,0,0,0,c),{vertices:m,triangles:b}}};var sT=class{constructor(e,n,r=n){this.data=e,this.width=n,this.height=r,this.coords=[],this.triangles=[],this._halfedges=[],this._candidates=[],this._queueIndices=[],this._queue=[],this._errors=[],this._rms=[],this._pending=[],this._pendingLen=0,this._rmsSum=0;let i=n-1,o=r-1,s=this._addPoint(0,0),c=this._addPoint(i,0),d=this._addPoint(0,o),m=this._addPoint(i,o),b=this._addTriangle(m,s,d,-1,-1,-1);this._addTriangle(s,m,c,b,-1,-1),this._flush()}run(e=1){for(;this.getMaxError()>e;)this.refine()}refine(){this._step(),this._flush()}getMaxError(){return this._errors[0]}getRMSD(){return this._rmsSum>0?Math.sqrt(this._rmsSum/(this.width*this.height)):0}heightAt(e,n){return this.data[this.width*n+e]}_flush(){let e=this.coords;for(let n=0;n<this._pendingLen;n++){let r=this._pending[n],i=2*this.triangles[r*3+0],o=2*this.triangles[r*3+1],s=2*this.triangles[r*3+2];this._findCandidate(e[i],e[i+1],e[o],e[o+1],e[s],e[s+1],r)}this._pendingLen=0}_findCandidate(e,n,r,i,o,s,c){let d=Math.min(e,r,o),m=Math.min(n,i,s),b=Math.max(e,r,o),C=Math.max(n,i,s),B=__(r,i,o,s,d,m),k=__(o,s,e,n,d,m),V=__(e,n,r,i,d,m),q=i-n,K=e-r,Y=s-i,ee=r-o,J=n-s,se=o-e,xe=__(e,n,r,i,o,s),Ee=this.heightAt(e,n)/xe,Xe=this.heightAt(r,i)/xe,Ne=this.heightAt(o,s)/xe,be=0,ge=0,Qe=0,Ct=0;for(let Mt=m;Mt<=C;Mt++){let mt=0;B<0&&Y!==0&&(mt=Math.max(mt,Math.floor(-B/Y))),k<0&&J!==0&&(mt=Math.max(mt,Math.floor(-k/J))),V<0&&q!==0&&(mt=Math.max(mt,Math.floor(-V/q)));let jt=B+Y*mt,Mn=k+J*mt,rn=V+q*mt,In=!1;for(let On=d+mt;On<=b;On++){if(jt>=0&&Mn>=0&&rn>=0){In=!0;let Pn=Ee*jt+Xe*Mn+Ne*rn,_n=Math.abs(Pn-this.heightAt(On,Mt));Ct+=_n*_n,_n>be&&(be=_n,ge=On,Qe=Mt)}else if(In)break;jt+=Y,Mn+=J,rn+=q}B+=ee,k+=se,V+=K}(ge===e&&Qe===n||ge===r&&Qe===i||ge===o&&Qe===s)&&(be=0),this._candidates[2*c]=ge,this._candidates[2*c+1]=Qe,this._rms[c]=Ct,this._queuePush(c,be,Ct)}_step(){let e=this._queuePop(),n=e*3+0,r=e*3+1,i=e*3+2,o=this.triangles[n],s=this.triangles[r],c=this.triangles[i],d=this.coords[2*o],m=this.coords[2*o+1],b=this.coords[2*s],C=this.coords[2*s+1],B=this.coords[2*c],k=this.coords[2*c+1],V=this._candidates[2*e],q=this._candidates[2*e+1],K=this._addPoint(V,q);if(__(d,m,b,C,V,q)===0)this._handleCollinear(K,n);else if(__(b,C,B,k,V,q)===0)this._handleCollinear(K,r);else if(__(B,k,d,m,V,q)===0)this._handleCollinear(K,i);else{let Y=this._halfedges[n],ee=this._halfedges[r],J=this._halfedges[i],se=this._addTriangle(o,s,K,Y,-1,-1,n),xe=this._addTriangle(s,c,K,ee,-1,se+1),Ee=this._addTriangle(c,o,K,J,se+2,xe+1);this._legalize(se),this._legalize(xe),this._legalize(Ee)}}_addPoint(e,n){let r=this.coords.length>>1;return this.coords.push(e,n),r}_addTriangle(e,n,r,i,o,s,c=this.triangles.length){let d=c/3;return this.triangles[c+0]=e,this.triangles[c+1]=n,this.triangles[c+2]=r,this._halfedges[c+0]=i,this._halfedges[c+1]=o,this._halfedges[c+2]=s,i>=0&&(this._halfedges[i]=c+0),o>=0&&(this._halfedges[o]=c+1),s>=0&&(this._halfedges[s]=c+2),this._candidates[2*d+0]=0,this._candidates[2*d+1]=0,this._queueIndices[d]=-1,this._rms[d]=0,this._pending[this._pendingLen++]=d,c}_legalize(e){let n=this._halfedges[e];if(n<0)return;let r=e-e%3,i=n-n%3,o=r+(e+1)%3,s=r+(e+2)%3,c=i+(n+2)%3,d=i+(n+1)%3,m=this.triangles[s],b=this.triangles[e],C=this.triangles[o],B=this.triangles[c],k=this.coords;if(!wPe(k[2*m],k[2*m+1],k[2*b],k[2*b+1],k[2*C],k[2*C+1],k[2*B],k[2*B+1]))return;let V=this._halfedges[o],q=this._halfedges[s],K=this._halfedges[c],Y=this._halfedges[d];this._queueRemove(r/3),this._queueRemove(i/3);let ee=this._addTriangle(m,B,C,-1,K,V,r),J=this._addTriangle(B,m,b,ee,q,Y,i);this._legalize(ee+1),this._legalize(J+2)}_handleCollinear(e,n){let r=n-n%3,i=r+(n+1)%3,o=r+(n+2)%3,s=this.triangles[o],c=this.triangles[n],d=this.triangles[i],m=this._halfedges[i],b=this._halfedges[o],C=this._halfedges[n];if(C<0){let Ee=this._addTriangle(e,s,c,-1,b,-1,r),Xe=this._addTriangle(s,e,d,Ee,-1,m);this._legalize(Ee+1),this._legalize(Xe+2);return}let B=C-C%3,k=B+(C+2)%3,V=B+(C+1)%3,q=this.triangles[k],K=this._halfedges[k],Y=this._halfedges[V];this._queueRemove(B/3);let ee=this._addTriangle(s,c,e,b,-1,-1,r),J=this._addTriangle(c,q,e,Y,-1,ee+1,B),se=this._addTriangle(q,d,e,K,-1,J+1),xe=this._addTriangle(d,s,e,m,ee+2,se+1);this._legalize(ee),this._legalize(J),this._legalize(se),this._legalize(xe)}_queuePush(e,n,r){let i=this._queue.length;this._queueIndices[e]=i,this._queue.push(e),this._errors.push(n),this._rmsSum+=r,this._queueUp(i)}_queuePop(){let e=this._queue.length-1;return this._queueSwap(0,e),this._queueDown(0,e),this._queuePopBack()}_queuePopBack(){let e=this._queue.pop();return this._errors.pop(),this._rmsSum-=this._rms[e],this._queueIndices[e]=-1,e}_queueRemove(e){let n=this._queueIndices[e];if(n<0){let i=this._pending.indexOf(e);if(i!==-1)this._pending[i]=this._pending[--this._pendingLen];else throw new Error(\"Broken triangulation (something went wrong).\");return}let r=this._queue.length-1;r!==n&&(this._queueSwap(n,r),this._queueDown(n,r)||this._queueUp(n)),this._queuePopBack()}_queueLess(e,n){return this._errors[e]>this._errors[n]}_queueSwap(e,n){let r=this._queue[e],i=this._queue[n];this._queue[e]=i,this._queue[n]=r,this._queueIndices[r]=n,this._queueIndices[i]=e;let o=this._errors[e];this._errors[e]=this._errors[n],this._errors[n]=o}_queueUp(e){let n=e;for(;;){let r=n-1>>1;if(r===n||!this._queueLess(n,r))break;this._queueSwap(r,n),n=r}}_queueDown(e,n){let r=e;for(;;){let i=2*r+1;if(i>=n||i<0)break;let o=i+1,s=i;if(o<n&&this._queueLess(o,i)&&(s=o),!this._queueLess(s,r))break;this._queueSwap(r,s),r=s}return r>e}};function __(t,e,n,r,i,o){return(n-i)*(e-o)-(r-o)*(t-i)}function wPe(t,e,n,r,i,o,s,c){let d=t-s,m=e-c,b=n-s,C=r-c,B=i-s,k=o-c,V=d*d+m*m,q=b*b+C*C,K=B*B+k*k;return d*(C*K-q*k)-m*(b*K-q*B)+V*(b*k-C*B)<0}function Soe(t,e){let{meshMaxError:n,bounds:r,elevationDecoder:i}=e,{data:o,width:s,height:c}=t,d,m;switch(e.tesselator){case\"martini\":d=zP(o,s,c,i,e.tesselator),m=Toe(n,s,d);break;case\"delatin\":d=zP(o,s,c,i,e.tesselator),m=Eoe(n,s,c,d);break;default:s===c&&!(c&s-1)?(d=zP(o,s,c,i,\"martini\"),m=Toe(n,s,d)):(d=zP(o,s,c,i,\"delatin\"),m=Eoe(n,s,c,d));break}let{vertices:b}=m,{triangles:C}=m,B=TPe(b,d,s,c,r),k=wp(B);if(e.skirtHeight){let{attributes:V,triangles:q}=NP(B,C,e.skirtHeight);B=V,C=q}return{loaderData:{header:{}},header:{vertexCount:C.length,boundingBox:k},mode:4,indices:{value:Uint32Array.from(C),size:1},attributes:B}}function Toe(t,e,n){let r=e+1,o=new oT(r).createTile(n),{vertices:s,triangles:c}=o.getMesh(t);return{vertices:s,triangles:c}}function Eoe(t,e,n,r){let i=new sT(r,e+1,n+1);i.run(t);let{coords:o,triangles:s}=i;return{vertices:o,triangles:s}}function zP(t,e,n,r,i){let{rScaler:o,bScaler:s,gScaler:c,offset:d}=r,m=new Float32Array((e+1)*(n+1));for(let b=0,C=0;C<n;C++)for(let B=0;B<e;B++,b++){let k=b*4,V=t[k+0],q=t[k+1],K=t[k+2];m[b+C]=V*o+q*c+K*s+d}if(i===\"martini\"){for(let b=(e+1)*e,C=0;C<e;C++,b++)m[b]=m[b-e-1];for(let b=n,C=0;C<n+1;C++,b+=n+1)m[b]=m[b-1]}return m}function TPe(t,e,n,r,i){let o=n+1,s=t.length/2,c=new Float32Array(s*3),d=new Float32Array(s*2),[m,b,C,B]=i||[0,0,n,r],k=(C-m)/n,V=(B-b)/r;for(let q=0;q<s;q++){let K=t[q*2],Y=t[q*2+1],ee=Y*o+K;c[3*q+0]=K*k+m,c[3*q+1]=-Y*V+B,c[3*q+2]=e[ee],d[2*q+0]=K/n,d[2*q+1]=Y/r}return{POSITION:{value:c,size:3},TEXCOORD_0:{value:d,size:2}}}var UP=\"4.3.3\";var VP={dataType:null,batchType:null,name:\"Terrain\",id:\"terrain\",module:\"terrain\",version:UP,worker:!0,extensions:[\"png\",\"pngraw\",\"jpg\",\"jpeg\",\"gif\",\"webp\",\"bmp\"],mimeTypes:[\"image/png\",\"image/jpeg\",\"image/gif\",\"image/webp\",\"image/bmp\"],options:{terrain:{tesselator:\"auto\",bounds:void 0,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:void 0}}};var Coe={dataType:null,batchType:null,name:\"Quantized Mesh\",id:\"quantized-mesh\",module:\"terrain\",version:UP,worker:!0,extensions:[\"terrain\"],mimeTypes:[\"application/vnd.quantized-mesh\"],options:{\"quantized-mesh\":{bounds:[0,0,1,1],skirtHeight:null}}};var EPe={...VP,parse:SPe};async function SPe(t,e,n){let r={...e,mimeType:\"application/x.image\",image:{...e?.image,type:\"data\"}},i=await eu(t,[],r,n),o={...EPe.options.terrain,...e?.terrain};return Soe(i,o)}var Fmt={...Coe,parseSync:(t,e)=>bz(t,e?.[\"quantized-mesh\"]),parse:async(t,e)=>bz(t,e?.[\"quantized-mesh\"])};var Moe=[1],CPe={...th.defaultProps,elevationData:qA,texture:{...qA,optional:!0},meshMaxError:{type:\"number\",value:4},bounds:{type:\"array\",value:null,optional:!0,compare:!0},color:{type:\"color\",value:[255,255,255]},elevationDecoder:{type:\"object\",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:\"\",wireframe:!1,material:!0,loaders:[VP]};function Ioe(t){return Array.isArray(t)?t.join(\";\"):t||\"\"}var aT=class extends xs{updateState({props:e,oldProps:n}){let r=e.elevationData!==n.elevationData;if(r){let{elevationData:o}=e,s=o&&(Array.isArray(o)||MPe(o));this.setState({isTiled:s})}let i=r||e.meshMaxError!==n.meshMaxError||e.elevationDecoder!==n.elevationDecoder||e.bounds!==n.bounds;if(!this.state.isTiled&&i){let o=this.loadTerrain(e);this.setState({terrain:o})}e.workerUrl&&hn.removed(\"workerUrl\",\"loadOptions.terrain.workerUrl\")()}loadTerrain({elevationData:e,bounds:n,elevationDecoder:r,meshMaxError:i,signal:o}){if(!e)return null;let s=this.getLoadOptions();s={...s,terrain:{skirtHeight:this.state.isTiled?i*2:0,...s?.terrain,bounds:n,meshMaxError:i,elevationDecoder:r}};let{fetch:c}=this.props;return c(e,{propName:\"elevationData\",layer:this,loadOptions:s,signal:o})}getTiledTerrainData(e){let{elevationData:n,fetch:r,texture:i,elevationDecoder:o,meshMaxError:s}=this.props,{viewport:c}=this.context,d=QA(n,e),m=i&&QA(i,e),{signal:b}=e,C=[0,0],B=[0,0];if(c.isGeospatial){let K=e.bbox;C=c.projectFlat([K.west,K.south]),B=c.projectFlat([K.east,K.north])}else{let K=e.bbox;C=[K.left,K.bottom],B=[K.right,K.top]}let k=[C[0],C[1],B[0],B[1]],V=this.loadTerrain({elevationData:d,bounds:k,elevationDecoder:o,meshMaxError:s,signal:b}),q=m?r(m,{propName:\"texture\",layer:this,loaders:[],signal:b}).catch(K=>null):Promise.resolve(null);return Promise.all([V,q])}renderSubLayers(e){let n=this.getSubLayerClass(\"mesh\",jp),{color:r,wireframe:i,material:o}=this.props,{data:s}=e;if(!s)return null;let[c,d]=s;return new n(e,{data:Moe,mesh:c,texture:d,_instanced:!1,coordinateSystem:Cn.CARTESIAN,getPosition:m=>[0,0,0],getColor:r,wireframe:i,material:o})}onViewportLoad(e){if(!e)return;let{zRange:n}=this.state,r=e.map(s=>s.content).filter(Boolean).map(s=>s[0].header.boundingBox.map(d=>d[2]));if(r.length===0)return;let i=Math.min(...r.map(s=>s[0])),o=Math.max(...r.map(s=>s[1]));(!n||i<n[0]||o>n[1])&&this.setState({zRange:[i,o]})}renderLayers(){let{color:e,material:n,elevationData:r,texture:i,wireframe:o,meshMaxError:s,elevationDecoder:c,tileSize:d,maxZoom:m,minZoom:b,extent:C,maxRequests:B,onTileLoad:k,onTileUnload:V,onTileError:q,maxCacheSize:K,maxCacheByteSize:Y,refinementStrategy:ee}=this.props;if(this.state.isTiled)return new th(this.getSubLayerProps({id:\"tiles\"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:Ioe(r),texture:Ioe(i),meshMaxError:s,elevationDecoder:c}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:d,maxZoom:m,minZoom:b,extent:C,maxRequests:B,onTileLoad:k,onTileUnload:V,onTileError:q,maxCacheSize:K,maxCacheByteSize:Y,refinementStrategy:ee});if(!r)return null;let J=this.getSubLayerClass(\"mesh\",jp);return new J(this.getSubLayerProps({id:\"mesh\"}),{data:Moe,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:se=>[0,0,0],getColor:e,material:n,wireframe:o})}};aT.defaultProps=CPe;aT.layerName=\"TerrainLayer\";var GP=aT,MPe=t=>t.includes(\"{x}\")&&(t.includes(\"{y}\")||t.includes(\"{-y}\"));var IPe={clipBounds:[0,0,1,1],clipByInstance:void 0},Poe=`\nuniform clipUniforms {\n  vec4 bounds;\n} clip;\n\nbool clip_isInBounds(vec2 position) {\n  return position.x >= clip.bounds[0] && position.y >= clip.bounds[1] && position.x < clip.bounds[2] && position.y < clip.bounds[3];\n}\n`,PPe={name:\"clip\",vs:Poe,uniformTypes:{bounds:\"vec4<f32>\"}},RPe={\"vs:#decl\":`\nout float clip_isVisible;\n`,\"vs:DECKGL_FILTER_GL_POSITION\":`\n  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));\n`,\"fs:#decl\":`\nin float clip_isVisible;\n`,\"fs:DECKGL_FILTER_COLOR\":`\n  if (clip_isVisible < 0.5) discard;\n`},BPe={name:\"clip\",fs:Poe,uniformTypes:{bounds:\"vec4<f32>\"}},DPe={\"vs:#decl\":`\nout vec2 clip_commonPosition;\n`,\"vs:DECKGL_FILTER_GL_POSITION\":`\n  clip_commonPosition = geometry.position.xy;\n`,\"fs:#decl\":`\nin vec2 clip_commonPosition;\n`,\"fs:DECKGL_FILTER_COLOR\":`\n  if (!clip_isInBounds(clip_commonPosition)) discard;\n`},lT=class extends Ek{getShaders(){let e=\"instancePositions\"in this.getAttributeManager().attributes;return this.props.clipByInstance!==void 0&&(e=!!this.props.clipByInstance),this.state.clipByInstance=e,e?{modules:[PPe],inject:RPe}:{modules:[BPe],inject:DPe}}draw(){let{clipBounds:e}=this.props,n={};if(this.state.clipByInstance)n.bounds=e;else{let r=this.projectPosition([e[0],e[1],0]),i=this.projectPosition([e[2],e[3],0]);n.bounds=[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[0],i[0]),Math.max(r[1],i[1])]}this.setShaderModuleProps({clip:n})}};lT.defaultProps=IPe;lT.extensionName=\"ClipExtension\";var Tz=lT;function Cz(t,e,n){let r=LPe(t),i=Object.keys(r).filter(o=>r[o]!==Array);return OPe(t,{propArrayTypes:r,...e},{numericPropKeys:n&&n.numericPropKeys||i,PositionDataType:n?n.PositionDataType:Float32Array,triangulate:n?n.triangulate:!0})}function LPe(t){let e={};for(let n of t)if(n.properties)for(let r in n.properties){let i=n.properties[r];e[r]=VPe(i,e[r])}return e}function OPe(t,e,n){let{pointPositionsCount:r,pointFeaturesCount:i,linePositionsCount:o,linePathsCount:s,lineFeaturesCount:c,polygonPositionsCount:d,polygonObjectsCount:m,polygonRingsCount:b,polygonFeaturesCount:C,propArrayTypes:B,coordLength:k}=e,{numericPropKeys:V=[],PositionDataType:q=Float32Array,triangulate:K=!0}=n,Y=t[0]&&\"id\"in t[0],ee=t.length>65535?Uint32Array:Uint16Array,J={type:\"Point\",positions:new q(r*k),globalFeatureIds:new ee(r),featureIds:i>65535?new Uint32Array(r):new Uint16Array(r),numericProps:{},properties:[],fields:[]},se={type:\"LineString\",pathIndices:o>65535?new Uint32Array(s+1):new Uint16Array(s+1),positions:new q(o*k),globalFeatureIds:new ee(o),featureIds:c>65535?new Uint32Array(o):new Uint16Array(o),numericProps:{},properties:[],fields:[]},xe={type:\"Polygon\",polygonIndices:d>65535?new Uint32Array(m+1):new Uint16Array(m+1),primitivePolygonIndices:d>65535?new Uint32Array(b+1):new Uint16Array(b+1),positions:new q(d*k),globalFeatureIds:new ee(d),featureIds:C>65535?new Uint32Array(d):new Uint16Array(d),numericProps:{},properties:[],fields:[]};K&&(xe.triangles=[]);for(let Xe of[J,se,xe])for(let Ne of V){let be=B[Ne];Xe.numericProps[Ne]=new be(Xe.positions.length/k)}se.pathIndices[s]=o,xe.polygonIndices[m]=d,xe.primitivePolygonIndices[b]=d;let Ee={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(let Xe of t){let Ne=Xe.geometry,be=Xe.properties||{};switch(Ne.type){case\"Point\":FPe(Ne,J,Ee,k,be),J.properties.push(Sz(be,V)),Y&&J.fields.push({id:Xe.id}),Ee.pointFeature++;break;case\"LineString\":kPe(Ne,se,Ee,k,be),se.properties.push(Sz(be,V)),Y&&se.fields.push({id:Xe.id}),Ee.lineFeature++;break;case\"Polygon\":NPe(Ne,xe,Ee,k,be),xe.properties.push(Sz(be,V)),Y&&xe.fields.push({id:Xe.id}),Ee.polygonFeature++;break;default:throw new Error(\"Invalid geometry type\")}Ee.feature++}return UPe(J,se,xe,k)}function FPe(t,e,n,r,i){e.positions.set(t.data,n.pointPosition*r);let o=t.data.length/r;Mz(e,i,n.pointPosition,o),e.globalFeatureIds.fill(n.feature,n.pointPosition,n.pointPosition+o),e.featureIds.fill(n.pointFeature,n.pointPosition,n.pointPosition+o),n.pointPosition+=o}function kPe(t,e,n,r,i){e.positions.set(t.data,n.linePosition*r);let o=t.data.length/r;Mz(e,i,n.linePosition,o),e.globalFeatureIds.fill(n.feature,n.linePosition,n.linePosition+o),e.featureIds.fill(n.lineFeature,n.linePosition,n.linePosition+o);for(let s=0,c=t.indices.length;s<c;++s){let d=t.indices[s],m=s===c-1?t.data.length:t.indices[s+1];e.pathIndices[n.linePath++]=n.linePosition,n.linePosition+=(m-d)/r}}function NPe(t,e,n,r,i){e.positions.set(t.data,n.polygonPosition*r);let o=t.data.length/r;Mz(e,i,n.polygonPosition,o),e.globalFeatureIds.fill(n.feature,n.polygonPosition,n.polygonPosition+o),e.featureIds.fill(n.polygonFeature,n.polygonPosition,n.polygonPosition+o);for(let s=0,c=t.indices.length;s<c;++s){let d=n.polygonPosition;e.polygonIndices[n.polygonObject++]=d;let m=t.areas[s],b=t.indices[s],C=t.indices[s+1];for(let k=0,V=b.length;k<V;++k){let q=b[k],K=k===V-1?C===void 0?t.data.length:C[0]:b[k+1];e.primitivePolygonIndices[n.polygonRing++]=n.polygonPosition,n.polygonPosition+=(K-q)/r}let B=n.polygonPosition;zPe(e,m,b,{startPosition:d,endPosition:B,coordLength:r})}}function zPe(t,e,n,{startPosition:r,endPosition:i,coordLength:o}){if(!t.triangles)return;let s=r*o,c=i*o,d=t.positions.subarray(s,c),m=n[0],b=n.slice(1).map(B=>(B-m)/o),C=Mk(d,b,o,e);for(let B=0,k=C.length;B<k;++B)t.triangles.push(r+C[B])}function Ez(t,e){let n={};for(let r in t)n[r]={value:t[r],size:e};return n}function UPe(t,e,n,r){let i={shape:\"binary-feature-collection\",points:{...t,positions:{value:t.positions,size:r},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:Ez(t.numericProps,1)},lines:{...e,positions:{value:e.positions,size:r},pathIndices:{value:e.pathIndices,size:1},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:Ez(e.numericProps,1)},polygons:{...n,positions:{value:n.positions,size:r},polygonIndices:{value:n.polygonIndices,size:1},primitivePolygonIndices:{value:n.primitivePolygonIndices,size:1},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1},numericProps:Ez(n.numericProps,1)}};return i.polygons&&n.triangles&&(i.polygons.triangles={value:new Uint32Array(n.triangles),size:1}),i}function Mz(t,e,n,r){for(let i in t.numericProps)if(i in e){let o=e[i];t.numericProps[i].fill(o,n,n+r)}}function Sz(t,e){let n={};for(let r in t)e.includes(r)||(n[r]=t[r]);return n}function VPe(t,e){return e===Array||!Number.isFinite(t)?Array:e===Float64Array||Math.fround(t)!==t?Float64Array:Float32Array}function jP(t,e){let n=e?.globalFeatureId;return n!==void 0?GPe(t,n):HPe(t,e?.type)}function GPe(t,e){let n=Boe(t);for(let r of n){let i=0,o=r.featureIds.value[0];for(let s=0;s<r.featureIds.value.length;s++){let c=r.featureIds.value[s];if(c!==o){if(e===r.globalFeatureIds.value[i])return HP(r,i,s);i=s,o=c}}if(e===r.globalFeatureIds.value[i])return HP(r,i,r.featureIds.value.length)}throw new Error(`featureId:${e} not found`)}function HPe(t,e){let n=Boe(t,e);return WPe(n)}function Roe(t,e,n){switch(t.type){case\"Point\":return ZPe(t,e,n);case\"LineString\":return YPe(t,e,n);case\"Polygon\":return Doe(t,e,n);default:let r=t;throw new Error(`Unsupported geometry type: ${r?.type}`)}}function Boe(t,e){let n=[];return t.points&&(t.points.type=\"Point\",n.push(t.points)),t.lines&&(t.lines.type=\"LineString\",n.push(t.lines)),t.polygons&&(t.polygons.type=\"Polygon\",n.push(t.polygons)),n}function WPe(t){let e=[];for(let n of t){if(n.featureIds.value.length===0)continue;let r=0,i=n.featureIds.value[0];for(let o=0;o<n.featureIds.value.length;o++){let s=n.featureIds.value[o];s!==i&&(e.push(HP(n,r,o)),r=o,i=s)}e.push(HP(n,r,n.featureIds.value.length))}return e}function HP(t,e,n){let r=Roe(t,e,n),i=XPe(t,e,n),o=jPe(t,e,n);return{type:\"Feature\",geometry:r,properties:i,...o}}function jPe(t,e=0,n){return t.fields&&t.fields[t.featureIds.value[e]]}function XPe(t,e=0,n){let r=Object.assign({},t.properties[t.featureIds.value[e]]);for(let i in t.numericProps)r[i]=t.numericProps[i].value[e];return r}function Doe(t,e=-1/0,n=1/0){let{positions:r}=t,i=t.polygonIndices.value.filter(d=>d>=e&&d<=n),o=t.primitivePolygonIndices.value.filter(d=>d>=e&&d<=n);if(!(i.length>2)){let d=[];for(let m=0;m<o.length-1;m++){let b=o[m],C=o[m+1],B=WP(r,b,C);d.push(B)}return{type:\"Polygon\",coordinates:d}}let c=[];for(let d=0;d<i.length-1;d++){let m=i[d],b=i[d+1],C=Doe(t,m,b).coordinates;c.push(C)}return{type:\"MultiPolygon\",coordinates:c}}function YPe(t,e=-1/0,n=1/0){let{positions:r}=t,i=t.pathIndices.value.filter(c=>c>=e&&c<=n);if(!(i.length>2))return{type:\"LineString\",coordinates:WP(r,i[0],i[1])};let s=[];for(let c=0;c<i.length-1;c++){let d=WP(r,i[c],i[c+1]);s.push(d)}return{type:\"MultiLineString\",coordinates:s}}function ZPe(t,e,n){let{positions:r}=t,i=WP(r,e,n);return i.length>1?{type:\"MultiPoint\",coordinates:i}:{type:\"Point\",coordinates:i[0]}}function WP(t,e,n){e=e||0,n=n||t.value.length/t.size;let r=[];for(let i=e;i<n;i++){let o=Array();for(let s=i*t.size;s<(i+1)*t.size;s++)o.push(Number(t.value[s]));r.push(o)}return r}var Lz=xr(Uoe(),1);function fRe(t){let e=0;for(let n=0,r=t.length-1,i,o;n<t.length;r=n++)i=t[n],o=t[r],e+=(o[0]-i[0])*(i[1]+o[1]);return e}function Rz(t,e){if(Array.isArray(t[0])){for(let r of t)Rz(r,e);return}let n=t;n[0]/=e,n[1]/=e}function Voe(t,e){for(let n=0;n<t.length;++n)t[n]/=e}function Bz(t,e,n){if(typeof t[0][0]!=\"number\"){for(let s of t)Bz(s,e,n);return}let r=n*Math.pow(2,e.z),i=n*e.x,o=n*e.y;for(let s=0;s<t.length;s++){let c=t[s];c[0]=(c[0]+i)*360/r-180;let d=180-(c[1]+o)*360/r;c[1]=360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90}}function Goe(t,e,n){let{x:r,y:i,z:o}=e,s=n*Math.pow(2,o),c=n*r,d=n*i;for(let m=0,b=t.length;m<b;m+=2){t[m]=(t[m]+c)*360/s-180;let C=180-(t[m+1]+d)*360/s;t[m+1]=360/Math.PI*Math.atan(Math.exp(C*Math.PI/180))-90}}function Hoe(t){let e=t.length;if(e<=1)return[t];let n=[],r,i;for(let o=0;o<e;o++){let s=fRe(t[o]);s!==0&&(i===void 0&&(i=s<0),i===s<0?(r&&n.push(r),r=[t[o]]):r&&r.push(t[o]))}return r&&n.push(r),n}function Woe(t){let e=t.indices.length,n=\"Polygon\";if(e<=1)return{type:n,data:t.data,areas:[[HA(t.data)]],indices:[t.indices]};let r=[],i=[],o=[],s=[],c,d=0;for(let m,b=0,C;b<e;b++){C=t.indices[b]-d,m=t.indices[b+1]-d||t.data.length;let B=t.data.slice(C,m),k=HA(B);if(k===0){let V=t.data.slice(0,C),q=t.data.slice(m);t.data=V.concat(q),d+=m-C;continue}c===void 0&&(c=k<0),c===k<0?(s.length&&(r.push(o),i.push(s)),s=[C],o=[k]):(o.push(k),s.push(C))}return o&&r.push(o),s.length&&i.push(s),{type:n,areas:r,indices:i,data:t.data}}var k2=class{properties;extent;type;id;_pbf;_geometry;_keys;_values;_geometryInfo;static types=[\"Unknown\",\"Point\",\"LineString\",\"Polygon\"];constructor(e,n,r,i,o,s){this.properties={},this.extent=r,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=i,this._values=o,this._geometryInfo=s,e.readFields(dRe,this,n)}toGeoJSONFeature(e,n){let r=this.loadGeometry();switch(e){case\"wgs84\":return joe(this,r,i=>Bz(i,n,this.extent));default:return joe(this,r,Rz)}}toBinaryFeature(e,n){let r=this.loadFlatGeometry();switch(e){case\"wgs84\":return this._toBinaryCoordinates(r,i=>Goe(i,n,this.extent));default:return this._toBinaryCoordinates(r,Voe)}}bbox(){let e=this._pbf;e.pos=this._geometry;let n=e.readVarint()+e.pos,r=1,i=0,o=0,s=0,c=1/0,d=-1/0,m=1/0,b=-1/0;for(;e.pos<n;){if(i<=0){let C=e.readVarint();r=C&7,i=C>>3}if(i--,r===1||r===2)o+=e.readSVarint(),s+=e.readSVarint(),o<c&&(c=o),o>d&&(d=o),s<m&&(m=s),s>b&&(b=s);else if(r!==7)throw new Error(`unknown command ${r}`)}return[c,m,d,b]}_toBinaryCoordinates(e,n){let r;n(e.data,this.extent);let i=2;switch(this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=e.indices.length,r={type:\"Point\",...e};break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=e.indices.length,this._geometryInfo.linePositionsCount+=e.data.length/i,r={type:\"LineString\",...e};break;case 3:r=Woe(e),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=r.indices.length;for(let s of r.indices)this._geometryInfo.polygonRingsCount+=s.length;this._geometryInfo.polygonPositionsCount+=r.data.length/i;break;default:throw new Error(`Invalid geometry type: ${this.type}`)}let o={type:\"Feature\",geometry:r,properties:this.properties};return this.id!==null&&(o.id=this.id),o}loadGeometry(){let e=this._pbf;e.pos=this._geometry;let n=e.readVarint()+e.pos,r=1,i=0,o=0,s=0,c=[],d;for(;e.pos<n;){if(i<=0){let m=e.readVarint();r=m&7,i=m>>3}switch(i--,r){case 1:case 2:o+=e.readSVarint(),s+=e.readSVarint(),r===1&&(d&&c.push(d),d=[]),d&&d.push([o,s]);break;case 7:d&&d.push(d[0].slice());break;default:throw new Error(`unknown command ${r}`)}}return d&&c.push(d),c}loadFlatGeometry(){let e=this._pbf;e.pos=this._geometry;let n=e.readVarint()+e.pos,r=1,i,o=0,s=0,c=0,d=0,m=[],b=[];for(;e.pos<n;)if(o<=0&&(i=e.readVarint(),r=i&7,o=i>>3),o--,r===1||r===2)s+=e.readSVarint(),c+=e.readSVarint(),r===1&&m.push(d),b.push(s,c),d+=2;else if(r===7){if(d>0){let C=m[m.length-1];b.push(b[C],b[C+1]),d+=2}}else throw new Error(`unknown command ${r}`);return{data:b,indices:m}}};function joe(t,e,n){let r=k2.types[t.type],i,o,s;switch(t.type){case 1:let d=[];for(i=0;i<e.length;i++)d[i]=e[i][0];s=d,n(s,t.extent);break;case 2:for(s=e,i=0;i<s.length;i++)n(s[i],t.extent);break;case 3:for(s=Hoe(e),i=0;i<s.length;i++)for(o=0;o<s[i].length;o++)n(s[i][o],t.extent);break;default:throw new Error(\"illegal vector tile type\")}s.length===1?s=s[0]:r=`Multi${r}`;let c={type:\"Feature\",geometry:{type:r,coordinates:s},properties:t.properties};return t.id!==null&&(c.properties||={},c.properties.id=t.id),c}function dRe(t,e,n){e&&n&&(t===1?e.id=n.readVarint():t===2?pRe(n,e):t===3?e.type=n.readVarint():t===4&&(e._geometry=n.pos))}function pRe(t,e){let n=t.readVarint()+t.pos;for(;t.pos<n;){let r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}var ZP=class{version;name;extent;length;_pbf;_keys;_values;_features;constructor(e,n){this.version=1,this.name=\"\",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(ARe,this,n),this.length=this._features.length}getGeoJSONFeature(e){if(e<0||e>=this._features.length)throw new Error(\"feature index out of bounds\");this._pbf.pos=this._features[e];let n=this._pbf.readVarint()+this._pbf.pos;return new k2(this._pbf,n,this.extent,this._keys,this._values)}getBinaryFeature(e,n){if(e<0||e>=this._features.length)throw new Error(\"feature index out of bounds\");this._pbf.pos=this._features[e];let r=this._pbf.readVarint()+this._pbf.pos;return new k2(this._pbf,r,this.extent,this._keys,this._values,n)}};function ARe(t,e,n){e&&n&&(t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(gRe(n)))}function gRe(t){let e=null,n=t.readVarint()+t.pos;for(;t.pos<n;){let r=t.readVarint()>>3;e=r===1?t.readString():r===2?t.readFloat():r===3?t.readDouble():r===4?t.readVarint64():r===5?t.readVarint():r===6?t.readSVarint():r===7?t.readBoolean():null}return e}var cT=class{layers;constructor(e,n){this.layers=e.readFields(mRe,{},n)}};function mRe(t,e,n){if(t===3&&n){let r=new ZP(n,n.readVarint()+n.pos);r.length&&e&&(e[r.name]=r)}}function Oz(t,e){let n=yRe(e),r=e?.gis?.format||e?.mvt?.shape||e?.shape;switch(r){case\"columnar-table\":return{shape:\"columnar-table\",data:Dz(t,n)};case\"geojson-table\":return{shape:\"geojson-table\",type:\"FeatureCollection\",features:Xoe(t,n)};case\"geojson\":return Xoe(t,n);case\"binary-geometry\":return Dz(t,n);case\"binary\":return Dz(t,n);default:throw new Error(r||\"undefined shape\")}}function Dz(t,e){let[n,r]=_Re(t,e),i=Cz(n,r);return i.byteLength=t.byteLength,i}function _Re(t,e){let n=[],r={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(t.byteLength<=0)return[n,r];let i=new cT(new Lz.default(t));return(e&&Array.isArray(e.layers)?e.layers:Object.keys(i.layers)).forEach(s=>{let c=i.layers[s];if(c)for(let d=0;d<c.length;d++){let m=c.getBinaryFeature(d,r),b=vRe(m,e,s);n.push(b)}}),[n,r]}function Xoe(t,e){if(t.byteLength<=0)return[];let n=[],r=new cT(new Lz.default(t));return(Array.isArray(e.layers)?e.layers:Object.keys(r.layers)).forEach(o=>{let s=r.layers[o];if(s)for(let c=0;c<s.length;c++){let d=s.getGeoJSONFeature(c),m=xRe(d,e,o);n.push(m)}}),n}function yRe(t){if(!t?.mvt)throw new Error(\"mvt options required\");if(t.mvt?.coordinates===\"wgs84\"&&!t.mvt.tileIndex)throw new Error(\"MVT Loader: WGS84 coordinates need tileIndex property\");return t.gis&&Qv.warn('MVTLoader: \"options.gis\" is deprecated, use \"options.mvt.shape\" instead')(),t.mvt}function xRe(t,e,n){let r=t.toGeoJSONFeature(e.coordinates||\"local\",e.tileIndex);return e.layerProperty&&(r.properties||={},r.properties[e.layerProperty]=n),r}function vRe(t,e,n){let r=t.toBinaryFeature(e.coordinates||\"local\",e.tileIndex);return e.layerProperty&&r.properties&&(r.properties[e.layerProperty]=n),r}var bRe=\"4.3.3\",qP={dataType:null,batchType:null,name:\"Mapbox Vector Tile\",id:\"mvt\",module:\"mvt\",version:bRe,extensions:[\"mvt\",\"pbf\"],mimeTypes:[\"application/vnd.mapbox-vector-tile\",\"application/x-protobuf\"],worker:!0,category:\"geometry\",options:{mvt:{shape:\"geojson\",coordinates:\"local\",layerProperty:\"layerName\",layers:void 0,tileIndex:void 0}}},wRe={...qP,parse:async(t,e)=>Oz(t,e),parseSync:Oz,binary:!0};var TRe={Point:Yoe,MultiPoint:ERe,LineString:Zoe,MultiLineString:SRe,Polygon:qoe,MultiPolygon:CRe};function Yoe([t,e],[n,r],i){let o=Xa(n[0],r[0],t),s=Xa(n[1],r[1],e);return i.unprojectFlat([o,s])}function Fz(t,e,n){return t.map(r=>Yoe(r,e,n))}function ERe(t,e,n){return Fz(t,e,n)}function Zoe(t,e,n){return Fz(t,e,n)}function SRe(t,e,n){return t.map(r=>Zoe(r,e,n))}function qoe(t,e,n){return t.map(r=>Fz(r,e,n))}function CRe(t,e,n){return t.map(r=>qoe(r,e,n))}function Qoe(t,e,n){let r=n.projectFlat([e.west,e.north]),i=n.projectFlat([e.east,e.south]),o=[r,i];return{...t,coordinates:TRe[t.type](t.coordinates,o,n)}}var MRe=[\"points\",\"lines\",\"polygons\"];function kz(t,e,n,r){for(let i of MRe){let o=t[i]&&IRe(t[i],e,n,r);if(o>=0)return o}return-1}function IRe(t,e,n,r){let i=t.featureIds.value;if(!i.length)return-1;let o=0,s=i[i.length-1]+1;if(r){let d=PRe(t,r);if(d)o=d[0],s=d[1]+1;else return-1}let c=-1;if(e in t.numericProps){let d=t.numericProps[e].value.findIndex((m,b)=>m===n&&i[b]>=o&&i[b]<s);return d>=0?t.globalFeatureIds.value[d]:-1}else e?c=Koe(t.properties,d=>d[e]===n,o,s):t.fields&&(c=Koe(t.fields,d=>d.id===n,o,s));return c>=0?RRe(t,c):-1}function PRe(t,e){if(!t.__layers){let n={},{properties:r}=t;for(let i=0;i<r.length;i++){let{layerName:o}=r[i];o&&(n[o]?n[o][1]=i:n[o]=[i,i])}t.__layers=n}return t.__layers[e]}function RRe(t,e){if(!t.__ids){let n=[],r=t.featureIds.value,i=t.globalFeatureIds.value;for(let o=0;o<r.length;o++)n[r[o]]=i[o];t.__ids=n}return t.__ids[e]}function Koe(t,e,n,r){for(let i=n;i<r;i++)if(e(t[i],i))return i;return-1}var Nz=512,BRe={...Vp.defaultProps,data:qA,onDataLoad:{type:\"function\",value:null,optional:!0,compare:!1},uniqueIdProperty:\"\",highlightedFeatureId:null,loaders:[qP],binary:!0},uT=class extends th{initializeState(){super.initializeState();let e=this.context.viewport.resolution!==void 0?!1:this.props.binary;this.setState({binary:e,data:null,tileJSON:null,hoveredFeatureId:null,hoveredFeatureLayerName:null})}get isLoaded(){return!!(this.state?.data&&super.isLoaded)}updateState({props:e,oldProps:n,context:r,changeFlags:i}){i.dataChanged&&this._updateTileData(),this.state?.data&&(super.updateState({props:e,oldProps:n,context:r,changeFlags:i}),this._setWGS84PropertyForTiles());let{highlightColor:o}=e;o!==n.highlightColor&&Array.isArray(o)&&this.setState({highlightColor:o})}async _updateTileData(){let e=this.props.data,n=null;if(typeof e==\"string\"&&!$k(e)){let{onDataLoad:r,fetch:i}=this.props;this.setState({data:null,tileJSON:null});try{n=await i(e,{propName:\"data\",layer:this,loaders:[]})}catch(o){this.raiseError(o,\"loading TileJSON\"),e=null}r&&r(n,{propName:\"data\",layer:this})}else e&&typeof e==\"object\"&&\"tilejson\"in e&&(n=e);n&&(e=n.tiles),this.setState({data:e,tileJSON:n})}_getTilesetOptions(){let e=super._getTilesetOptions(),n=this.state.tileJSON,{minZoom:r,maxZoom:i}=this.props;return n&&(Number.isFinite(n.minzoom)&&n.minzoom>r&&(e.minZoom=n.minzoom),Number.isFinite(n.maxzoom)&&(!Number.isFinite(i)||n.maxzoom<i)&&(e.maxZoom=n.maxzoom)),e}renderLayers(){return this.state?.data?super.renderLayers():null}getTileData(e){let{data:n,binary:r}=this.state,{index:i,signal:o}=e,s=QA(n,e);if(!s)return Promise.reject(\"Invalid URL\");let c=this.getLoadOptions(),{fetch:d}=this.props;return c={...c,mimeType:\"application/x-protobuf\",mvt:{...c?.mvt,coordinates:this.context.viewport.resolution?\"wgs84\":\"local\",tileIndex:i},gis:r?{format:\"binary\"}:{}},d(s,{propName:\"data\",layer:this,loadOptions:c,signal:o})}renderSubLayers(e){let{x:n,y:r,z:i}=e.tile.index,o=Math.pow(2,i),s=Nz/o,c=-s,d=Nz*n/o,m=Nz*(1-r/o),b=new wn().scale([s,c,1]);e.autoHighlight=!1,this.context.viewport.resolution||(e.modelMatrix=b,e.coordinateOrigin=[d,m,0],e.coordinateSystem=Cn.CARTESIAN,e.extensions=[...e.extensions||[],new Tz]);let C=super.renderSubLayers(e);return this.state.binary&&!(C instanceof Vp)&&hn.warn(\"renderSubLayers() must return GeoJsonLayer when using binary:true\")(),C}_updateAutoHighlight(e){let{uniqueIdProperty:n}=this.props,{hoveredFeatureId:r,hoveredFeatureLayerName:i}=this.state,o=e.object,s=null,c=null;o&&(s=zz(o,n),c=Joe(o));let{highlightColor:d}=this.props;typeof d==\"function\"&&(d=d(e)),(r!==s||i!==c)&&this.setState({highlightColor:d,hoveredFeatureId:s,hoveredFeatureLayerName:c})}_isWGS84(){return!!this.context.viewport.resolution}getPickingInfo(e){let n=super.getPickingInfo(e);if(this.state.binary&&n.index!==-1){let{data:r}=e.sourceLayer.props;n.object=jP(r,{globalFeatureId:n.index})}return n.object&&!this._isWGS84()&&(n.object=ese(n.object,n.tile.bbox,this.context.viewport)),n}getSubLayerPropsByTile(e){return{highlightedObjectIndex:this.getHighlightedObjectIndex(e),highlightColor:this.state.highlightColor}}getHighlightedObjectIndex(e){let{hoveredFeatureId:n,hoveredFeatureLayerName:r,binary:i}=this.state,{uniqueIdProperty:o,highlightedFeatureId:s}=this.props,c=e.content,d=$oe(s);if(!($oe(n)||d))return-1;let b=d?s:n;return Array.isArray(c)?c.findIndex(C=>{let B=zz(C,o)===b,k=d||Joe(C)===r;return B&&k}):c&&i?kz(c,o,b,d?\"\":r):-1}_pickObjects(e){let{deck:n,viewport:r}=this.context,i=r.width,o=r.height,s=r.x,c=r.y,d=[this.id];return n.pickObjects({x:s,y:c,width:i,height:o,layerIds:d,maxObjects:e})}getRenderedFeatures(e=null){let n=this._pickObjects(e),r=new Set,i=[];for(let o of n){let s=zz(o.object,this.props.uniqueIdProperty);s===void 0?i.push(o.object):r.has(s)||(r.add(s),i.push(o.object))}return i}_setWGS84PropertyForTiles(){let e=\"dataInWGS84\";this.state.tileset.selectedTiles.forEach(r=>{r.hasOwnProperty(e)||Object.defineProperty(r,e,{get:()=>{if(!r.content)return null;if(this.state.binary&&Array.isArray(r.content)&&!r.content.length)return[];let{bbox:i}=r;if(r._contentWGS84===void 0&&eN(i)){let o=this.state.binary?jP(r.content):r.content;r._contentWGS84=o.map(s=>ese(s,i,this.context.viewport))}return r._contentWGS84}})})}};uT.layerName=\"MVTLayer\";uT.defaultProps=BRe;var QP=uT;function zz(t,e){if(t.properties&&e)return t.properties[e];if(\"id\"in t)return t.id}function Joe(t){return t.properties?.layerName||null}function $oe(t){return t!=null&&t!==\"\"}function ese(t,e,n){let r={...t,geometry:{type:t.geometry.type}};return Object.defineProperty(r.geometry,\"coordinates\",{get:()=>Qoe(t.geometry,e,n).coordinates}),r}var tse=\"0123456789bcdefghjkmnpqrstuvwxyz\",nse={};for(let t=0;t<tse.length;t++)nse[tse.charAt(t)]=t;var DRe=-90,LRe=90,ORe=-180,FRe=180;function kRe(t){let e=!0,n=LRe,r=DRe,i=FRe,o=ORe,s,c=0;for(let d=0,m=t.length;d<m;d++){let b=t[d].toLowerCase();c=nse[b];for(let C=4;C>=0;C--){let B=c>>C&1;e?(s=(i+o)/2,B===1?o=s:i=s):(s=(n+r)/2,B===1?r=s:n=s),e=!e}}return[r,o,n,i]}function rse(t){let[e,n,r,i]=kRe(t);return[i,r,i,e,n,e,n,r,i,r]}var NRe={getGeohash:{type:\"accessor\",value:t=>t.geohash}},hT=class extends XA{indexToBounds(){let{data:e,getGeohash:n}=this.props;return{data:e,_normalize:!1,positionFormat:\"XY\",getPolygon:(r,i)=>rse(n(r,i))}}};hT.layerName=\"GeohashLayer\";hT.defaultProps=NRe;var KP=hT;var zRe=\"https://basemaps.cartocdn.com/gl/{basemap}-gl-style/style.json\";function y_(t){return zRe.replace(\"{basemap}\",t)}var Uz={VOYAGER:y_(\"voyager\"),POSITRON:y_(\"positron\"),DARK_MATTER:y_(\"dark-matter\"),VOYAGER_NOLABELS:y_(\"voyager-nolabels\"),POSITRON_NOLABELS:y_(\"positron-nolabels\"),DARK_MATTER_NOLABELS:y_(\"dark-matter-nolabels\")};function ose(t,e){let n=VRe(e),r=t;for(let i of n)r=URe(r)?r[i]:void 0;return r}function URe(t){return t!==null&&typeof t==\"object\"}var ise={};function VRe(t){if(typeof t==\"string\"){let e=ise[t];return e||(e=t.split(\".\"),ise[t]=e),e}return Array.isArray(t)?t:[t]}var Vz=xr(sse(),1);var ase={\"||\":(t,e)=>t||e,\"&&\":(t,e)=>t&&e,\"|\":(t,e)=>t|e,\"^\":(t,e)=>t^e,\"&\":(t,e)=>t&e,\"==\":(t,e)=>t==e,\"!=\":(t,e)=>t!=e,\"===\":(t,e)=>t===e,\"!==\":(t,e)=>t!==e,\"<\":(t,e)=>t<e,\">\":(t,e)=>t>e,\"<=\":(t,e)=>t<=e,\">=\":(t,e)=>t>=e,\"<<\":(t,e)=>t<<e,\">>\":(t,e)=>t>>e,\">>>\":(t,e)=>t>>>e,\"+\":(t,e)=>t+e,\"-\":(t,e)=>t-e,\"*\":(t,e)=>t*e,\"/\":(t,e)=>t/e,\"%\":(t,e)=>t%e},GRe={\"-\":t=>-t,\"+\":t=>+t,\"~\":t=>~t,\"!\":t=>!t};function lse(t,e){return t.map(function(n){return Sa(n,e)})}function cse(t,e){let n=Sa(t.object,e),r;if(t.computed?r=Sa(t.property,e):r=t.property.name,/^__proto__|prototype|constructor$/.test(r))throw Error(`Access to member \"${r}\" disallowed.`);return[n,n[r]]}function Sa(t,e){let n=t;switch(n.type){case\"ArrayExpression\":return lse(n.elements,e);case\"BinaryExpression\":return ase[n.operator](Sa(n.left,e),Sa(n.right,e));case\"CallExpression\":let r,i,o;return n.callee.type===\"MemberExpression\"?(o=cse(n.callee,e),r=o[0],i=o[1]):i=Sa(n.callee,e),typeof i!=\"function\"?void 0:i.apply(r,lse(n.arguments,e));case\"ConditionalExpression\":return Sa(n.test,e)?Sa(n.consequent,e):Sa(n.alternate,e);case\"Identifier\":return e[n.name];case\"Literal\":return n.value;case\"LogicalExpression\":return n.operator===\"||\"?Sa(n.left,e)||Sa(n.right,e):n.operator===\"&&\"?Sa(n.left,e)&&Sa(n.right,e):ase[n.operator](Sa(n.left,e),Sa(n.right,e));case\"MemberExpression\":return cse(n,e)[1];case\"ThisExpression\":return e;case\"UnaryExpression\":return GRe[n.operator](Sa(n.argument,e));default:return}}var Gz={\"-\":t=>t};function Wz(t,e){if(t in Gz)return Gz[t];let n,r=(0,Vz.default)(t);return r.type===\"Identifier\"?n=i=>ose(i,t):(Hz(r,i=>{if(i.type===\"CallExpression\")throw new Error(\"Function calls not allowed in JSON expressions\")}),n=i=>Sa(r,i)),Gz[t]=n,n}function Hz(t,e){if(Array.isArray(t))t.forEach(n=>Hz(n,e));else if(t&&typeof t==\"object\"){t.type&&e(t);for(let n in t)Hz(t[n],e)}}function WRe(t){return typeof t==\"string\"&&t.startsWith(\"@@=\")}function jRe(t){return t.replace(\"@@=\",\"\")}function $P(t,e){let n={};for(let r in t){let i=t[r];WRe(i)&&(i=jRe(i),i=Wz(i,e)),n[r]=i}return n}var pse=xr(Jr(),1),Za=xr(Jr(),1);var eR=xr(Jr(),1),XRe=typeof window<\"u\"?eR.useLayoutEffect:eR.useEffect,use=XRe;var nR=xr(Jr(),1),hse=xr(Jr(),1);function N2(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}var jz=xr(Jr(),1),YRe={position:\"absolute\",zIndex:-1};function tR(t,e){if(typeof t==\"function\")return t(e);if(Array.isArray(t))return t.map(n=>tR(n,e));if(z2(t)){if(ZRe(t))return e.style=YRe,(0,jz.cloneElement)(t,e);if(qRe(t))return(0,jz.cloneElement)(t,e)}return t}function z2(t){return t&&typeof t==\"object\"&&\"type\"in t||!1}function ZRe(t){return t.props?.mapStyle}function qRe(t){let e=t.type;return e&&e.deckGLViewProps}function Xz(t){if(typeof t==\"function\")return(0,hse.createElement)(au,{},t);if(Array.isArray(t))return t.map(Xz);if(z2(t)){if(t.type===nR.Fragment)return Xz(t.props.children);if(N2(t.type,au))return t}return t}function Yz({children:t,layers:e=[],views:n=null}){let r=[],i=[],o={};return nR.Children.forEach(Xz(t),s=>{if(z2(s)){let c=s.type;if(N2(c,hi)){let d=QRe(c,s.props);i.push(d)}else r.push(s);if(N2(c,au)&&c!==au&&s.props.id){let d=new c(s.props);o[d.id]=d}}else s&&r.push(s)}),Object.keys(o).length>0&&(Array.isArray(n)?n.forEach(s=>{o[s.id]=s}):n&&(o[n.id]=n),n=Object.values(o)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function QRe(t,e){let n={},r=t.defaultProps||{};for(let i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}var Zz=xr(Jr(),1);var fse=xr(Jr(),1),dse=(0,fse.createContext)();function qz({children:t,deck:e,ContextProvider:n=dse.Provider}){let{viewManager:r}=e||{};if(!r||!r.views.length)return[];let i={},o=r.views[0].id;for(let s of t){let c=o,d=s;z2(s)&&N2(s.type,au)&&(c=s.props.id||o,d=s.props.children);let m=r.getViewport(c),b=r.getViewState(c);if(m){b.padding=m.padding;let{x:C,y:B,width:k,height:V}=m;d=tR(d,{x:C,y:B,width:k,height:V,viewport:m,viewState:b}),i[c]||(i[c]={viewport:m,children:[]}),i[c].children.push(d)}}return Object.keys(i).map(s=>{let{viewport:c,children:d}=i[s],{x:m,y:b,width:C,height:B}=c,k={position:\"absolute\",left:m,top:b,width:C,height:B},V=`view-${s}`,q=(0,Zz.createElement)(\"div\",{key:V,id:V,style:k},...d),K={deck:e,viewport:c,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:ee=>{ee.viewId=s,e._onViewStateChange(ee)},widgets:[]},Y=`view-${s}-context`;return(0,Zz.createElement)(n,{key:Y,value:K},q)})}var KRe={mixBlendMode:null};function Qz({width:t,height:e,style:n}){let r={position:\"absolute\",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(let o in n)o in KRe?i[o]=n[o]:r[o]=n[o];return{containerStyle:r,canvasStyle:i}}function JRe(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function Ase(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function $Re(t,e,n){let r=new e({...n,_customRender:n.deviceProps?.adapters?.[0]?.type===\"webgpu\"?void 0:i=>{t.redrawReason=i;let o=r.getViewports();t.lastRenderedViewports!==o?t.forceUpdate():Ase(t)}});return r}function e5e(t,e){let[n,r]=(0,Za.useState)(0),o=(0,Za.useRef)({control:null,version:n,forceUpdate:()=>r(xe=>xe+1)}).current,s=(0,Za.useRef)(null),c=(0,Za.useRef)(null),d=(0,Za.useMemo)(()=>Yz(t),[t.layers,t.views,t.children]),m=!0,b=xe=>m&&t.viewState?(o.viewStateUpdateRequested=xe,null):(o.viewStateUpdateRequested=null,t.onViewStateChange?.(xe)),C=xe=>{m?o.interactionStateUpdateRequested=xe:(o.interactionStateUpdateRequested=null,t.onInteractionStateChange?.(xe))},B=(0,Za.useMemo)(()=>{let xe={widgets:[],...t,style:null,width:\"100%\",height:\"100%\",parent:s.current,canvas:c.current,layers:d.layers,views:d.views,onViewStateChange:b,onInteractionStateChange:C};return delete xe._customRender,o.deck&&o.deck.setProps(xe),xe},[t]);(0,Za.useEffect)(()=>{let xe=t.Deck||gk;return o.deck=$Re(o,xe,{...B,parent:s.current,canvas:c.current}),()=>o.deck?.finalize()},[]),use(()=>{Ase(o);let{viewStateUpdateRequested:xe,interactionStateUpdateRequested:Ee}=o;xe&&b(xe),Ee&&C(Ee),o.deck?.isInitialized&&o.deck.redraw(\"Initial render\")}),(0,Za.useImperativeHandle)(e,()=>JRe(o),[]);let k=o.deck&&o.deck.isInitialized?o.deck.getViewports():void 0,{ContextProvider:V,width:q=\"100%\",height:K=\"100%\",id:Y,style:ee}=t,{containerStyle:J,canvasStyle:se}=(0,Za.useMemo)(()=>Qz({width:q,height:K,style:ee}),[q,K,ee]);if(!o.viewStateUpdateRequested&&o.lastRenderedViewports===k||o.version!==n){o.lastRenderedViewports=k,o.version=n;let xe=qz({children:d.children,deck:o.deck,ContextProvider:V}),Ee=(0,Za.createElement)(\"canvas\",{key:\"canvas\",id:Y||\"deckgl-overlay\",ref:c,style:se});o.control=(0,Za.createElement)(\"div\",{id:`${Y||\"deckgl\"}-wrapper`,ref:s,style:J},[Ee,xe])}return m=!1,o.control}var t5e=pse.forwardRef(e5e),Kz=t5e;function gse({pointCount:t,getBinId:e}){let n=new Map;for(let r=0;r<t;r++){let i=e(r);if(i===null)continue;let o=n.get(String(i));o?o.points.push(r):(o={id:i,index:n.size,points:[r]},n.set(String(i),o))}return Array.from(n.values())}function mse({bins:t,dimensions:e,target:n}){let r=t.length*e;(!n||n.length<r)&&(n=new Float32Array(r));for(let i=0;i<t.length;i++){let{id:o}=t[i];Array.isArray(o)?n.set(o,i*e):n[i]=o}return n}var n5e=t=>t.length,_se=(t,e)=>{let n=0;for(let r of t)n+=e(r);return n},r5e=(t,e)=>t.length===0?NaN:_se(t,e)/t.length,i5e=(t,e)=>{let n=1/0;for(let r of t){let i=e(r);i<n&&(n=i)}return n},o5e=(t,e)=>{let n=-1/0;for(let r of t){let i=e(r);i>n&&(n=i)}return n},yse={COUNT:n5e,SUM:_se,MEAN:r5e,MIN:i5e,MAX:o5e};function xse({bins:t,getValue:e,operation:n,target:r}){(!r||r.length<t.length)&&(r=new Float32Array(t.length));let i=1/0,o=-1/0;for(let s=0;s<t.length;s++){let{points:c}=t[s];r[s]=n(c,e),r[s]<i&&(i=r[s]),r[s]>o&&(o=r[s])}return{value:r,domain:[i,o]}}function Jz(t,e,n){let r={};for(let o of t.sources||[]){let s=e[o];if(s)r[o]=s5e(s);else throw new Error(`Cannot find attribute ${o}`)}let i={};return o=>{for(let s in r)i[s]=r[s](o);return t.getValue(i,o,n)}}function s5e(t){let e=t.value,{offset:n=0,stride:r,size:i}=t.getAccessor(),o=e.BYTES_PER_ELEMENT,s=n/o,c=r?r/o:i;if(i===1)return t.isConstant?()=>e[0]:m=>{let b=s+c*m;return e[b]};let d;return t.isConstant?(d=Array.from(e),()=>d):(d=new Array(i),m=>{let b=s+c*m;for(let C=0;C<i;C++)d[C]=e[b+C];return d})}var Cc=class{constructor(e){this.bins=[],this.binIds=null,this.results=[],this.dimensions=e.dimensions,this.channelCount=e.getValue.length,this.props={...e,binOptions:{},pointCount:0,operations:[],customOperations:[],attributes:{}},this.needsUpdate=!0,this.setProps(e)}destroy(){}get binCount(){return this.bins.length}setProps(e){let n=this.props;if(e.binOptions&&(Li(e.binOptions,n.binOptions,2)||this.setNeedsUpdate()),e.operations)for(let r=0;r<this.channelCount;r++)e.operations[r]!==n.operations[r]&&this.setNeedsUpdate(r);if(e.customOperations)for(let r=0;r<this.channelCount;r++)!!e.customOperations[r]!=!!n.customOperations[r]&&this.setNeedsUpdate(r);e.pointCount!==void 0&&e.pointCount!==n.pointCount&&this.setNeedsUpdate(),e.attributes&&(e.attributes={...n.attributes,...e.attributes}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate=!0:this.needsUpdate!==!0&&(this.needsUpdate=this.needsUpdate||[],this.needsUpdate[e]=!0)}update(){if(this.needsUpdate===!0){this.bins=gse({pointCount:this.props.pointCount,getBinId:Jz(this.props.getBin,this.props.attributes,this.props.binOptions)});let e=mse({bins:this.bins,dimensions:this.dimensions,target:this.binIds?.value});this.binIds={value:e,type:\"float32\",size:this.dimensions}}for(let e=0;e<this.channelCount;e++)if(this.needsUpdate===!0||this.needsUpdate[e]){let n=this.props.customOperations[e]||yse[this.props.operations[e]],{value:r,domain:i}=xse({bins:this.bins,getValue:Jz(this.props.getValue[e],this.props.attributes,void 0),operation:n,target:this.results[e]?.value});this.results[e]={value:r,domain:i,type:\"float32\",size:1},this.props.onUpdate?.({channel:e})}this.needsUpdate=!1}preDraw(){}getBins(){return this.binIds}getResult(e){return this.results[e]}getResultDomain(e){return this.results[e]?.domain??[1/0,-1/0]}getBin(e){let n=this.bins[e];if(!n)return null;let r=new Array(this.channelCount);for(let i=0;i<r.length;i++){let o=this.results[i];r[i]=o?.value[e]}return{id:n.id,value:r,count:n.points.length,pointIndices:n.points}}};function rR(t,e,n){return t.createFramebuffer({width:e,height:n,colorAttachments:[t.createTexture({width:e,height:n,format:\"rgba32float\",sampler:{minFilter:\"nearest\",magFilter:\"nearest\"}})]})}var a5e=`uniform binSorterUniforms {\n  ivec4 binIdRange;\n  ivec2 targetSize;\n} binSorter;\n`,vse={name:\"binSorter\",vs:a5e,uniformTypes:{binIdRange:\"vec4<i32>\",targetSize:\"vec2<i32>\"}};var wse=[1,2,4,8],bse=3e38,l5e={SUM:0,MEAN:0,MIN:0,MAX:0,COUNT:0},dT=1024,iR=class{constructor(e,n){this.binsFBO=null,this.device=e,this.model=u5e(e,n)}get texture(){return this.binsFBO?this.binsFBO.colorAttachments[0].texture:null}destroy(){this.model.destroy(),this.binsFBO?.colorAttachments[0].texture.destroy(),this.binsFBO?.destroy()}getBinValues(e){if(!this.binsFBO)return null;let n=e%dT,r=Math.floor(e/dT),i=this.device.readPixelsToArrayWebGL(this.binsFBO,{sourceX:n,sourceY:r,sourceWidth:1,sourceHeight:1}).buffer;return new Float32Array(i)}setDimensions(e,n){let r=dT,i=Math.ceil(e/r);this.binsFBO?this.binsFBO.height<i&&this.binsFBO.resize({width:r,height:i}):this.binsFBO=rR(this.device,r,i);let o={binIdRange:[n[0][0],n[0][1],n[1]?.[0]||0,n[1]?.[1]||0],targetSize:[this.binsFBO.width,this.binsFBO.height]};this.model.shaderInputs.setProps({binSorter:o})}setModelProps(e){let n=this.model;e.attributes&&n.setAttributes(e.attributes),e.constantAttributes&&n.setConstantAttributes(e.constantAttributes),e.vertexCount!==void 0&&n.setVertexCount(e.vertexCount),e.shaderModuleProps&&n.shaderInputs.setProps(e.shaderModuleProps)}update(e){if(!this.binsFBO)return;let n=c5e(e);this._updateBins(\"SUM\",n.SUM+n.MEAN),this._updateBins(\"MIN\",n.MIN),this._updateBins(\"MAX\",n.MAX)}_updateBins(e,n){if(n===0)return;n|=wse[3];let r=this.model,i=this.binsFBO,o=e===\"MAX\"?-bse:e===\"MIN\"?bse:0,s=this.device.beginRenderPass({id:`gpu-aggregation-${e}`,framebuffer:i,parameters:{viewport:[0,0,i.width,i.height],colorMask:n},clearColor:[o,o,o,0],clearDepth:!1,clearStencil:!1});r.setParameters({blend:!0,blendColorSrcFactor:\"one\",blendColorDstFactor:\"one\",blendAlphaSrcFactor:\"one\",blendAlphaDstFactor:\"one\",blendColorOperation:e===\"MAX\"?\"max\":e===\"MIN\"?\"min\":\"add\",blendAlphaOperation:\"add\"}),r.draw(s),s.end()}};function c5e(t){let e={...l5e};for(let n=0;n<t.length;n++){let r=t[n];r&&(e[r]+=wse[n])}return e}function u5e(t,e){let n=e.vs;e.dimensions===2&&(n+=`\nvoid getBin(out int binId) {\n  ivec2 binId2;\n  getBin(binId2);\n  if (binId2.x < binSorter.binIdRange.x || binId2.x >= binSorter.binIdRange.y) {\n    binId = -1;\n  } else {\n    binId = (binId2.y - binSorter.binIdRange.z) * (binSorter.binIdRange.y - binSorter.binIdRange.x) + binId2.x;\n  }\n}\n`);let r=`#version 300 es\n#define SHADER_NAME gpu-aggregation-sort-bins-vertex\n\n${n}\n\nout vec3 v_Value;\n\nvoid main() {\n  int binIndex;\n  getBin(binIndex);\n  binIndex = binIndex - binSorter.binIdRange.x;\n  if (binIndex < 0) {\n    gl_Position = vec4(0.);\n    return;\n  }\n  int row = binIndex / binSorter.targetSize.x;\n  int col = binIndex - row * binSorter.targetSize.x;\n  vec2 position = (vec2(col, row) + 0.5) / vec2(binSorter.targetSize) * 2.0 - 1.0;\n  gl_Position = vec4(position, 0.0, 1.0);\n  gl_PointSize = 1.0;\n\n#if NUM_CHANNELS == 3\n  getValue(v_Value);\n#elif NUM_CHANNELS == 2\n  getValue(v_Value.xy);\n#else\n  getValue(v_Value.x);\n#endif\n}\n`,i=`#version 300 es\n#define SHADER_NAME gpu-aggregation-sort-bins-fragment\n\nprecision highp float;\n\nin vec3 v_Value;\nout vec4 fragColor;\n\nvoid main() {\n  fragColor.xyz = v_Value;\n\n  #ifdef MODULE_GEOMETRY\n  geometry.uv = vec2(0.);\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n  #endif\n\n  fragColor.w = 1.0;\n}\n`;return new gr(t,{bufferLayout:e.bufferLayout,modules:[...e.modules||[],vse],defines:{...e.defines,NON_INSTANCED_MODEL:1,NUM_CHANNELS:e.channelCount},isInstanced:!1,vs:r,fs:i,topology:\"point-list\",disableWarnings:!0})}var h5e=`uniform aggregatorTransformUniforms {\n  ivec4 binIdRange;\n  bvec3 isCount;\n  bvec3 isMean;\n  float naN;\n} aggregatorTransform;\n`,Tse={name:\"aggregatorTransform\",vs:h5e,uniformTypes:{binIdRange:\"vec4<i32>\",isCount:\"vec3<f32>\",isMean:\"vec3<f32>\"}};var $z=3e38,oR=class{constructor(e,n){this.binBuffer=null,this.valueBuffer=null,this._domains=null,this.device=e,this.channelCount=n.channelCount,this.transform=f5e(e,n),this.domainFBO=rR(e,2,1)}destroy(){this.transform.destroy(),this.binBuffer?.destroy(),this.valueBuffer?.destroy(),this.domainFBO.colorAttachments[0].texture.destroy(),this.domainFBO.destroy()}get domains(){if(!this._domains){let e=this.device.readPixelsToArrayWebGL(this.domainFBO).buffer,n=new Float32Array(e);this._domains=[[-n[4],n[0]],[-n[5],n[1]],[-n[6],n[2]]].slice(0,this.channelCount)}return this._domains}setDimensions(e,n){let{model:r,transformFeedback:i}=this.transform;r.setVertexCount(e);let o={binIdRange:[n[0][0],n[0][1],n[1]?.[0]||0,n[1]?.[1]||0]};r.shaderInputs.setProps({aggregatorTransform:o});let s=e*n.length*4;(!this.binBuffer||this.binBuffer.byteLength<s)&&(this.binBuffer?.destroy(),this.binBuffer=this.device.createBuffer({byteLength:s}),i.setBuffer(\"binIds\",this.binBuffer));let c=e*this.channelCount*4;(!this.valueBuffer||this.valueBuffer.byteLength<c)&&(this.valueBuffer?.destroy(),this.valueBuffer=this.device.createBuffer({byteLength:c}),i.setBuffer(\"values\",this.valueBuffer))}update(e,n){if(!e)return;let r=this.transform,i=this.domainFBO,o=[0,1,2].map(d=>n[d]===\"COUNT\"?1:0),s=[0,1,2].map(d=>n[d]===\"MEAN\"?1:0),c={isCount:o,isMean:s,bins:e};r.model.shaderInputs.setProps({aggregatorTransform:c}),r.run({id:\"gpu-aggregation-domain\",framebuffer:i,parameters:{viewport:[0,0,2,1]},clearColor:[-$z,-$z,-$z,0],clearDepth:!1,clearStencil:!1}),this._domains=null}};function f5e(t,e){let n=`#version 300 es\n#define SHADER_NAME gpu-aggregation-domain-vertex\n\nuniform sampler2D bins;\n\n#if NUM_DIMS == 1\nout float binIds;\n#else\nout vec2 binIds;\n#endif\n\n#if NUM_CHANNELS == 1\nflat out float values;\n#elif NUM_CHANNELS == 2\nflat out vec2 values;\n#else\nflat out vec3 values;\n#endif\n\nconst float NAN = intBitsToFloat(-1);\n\nvoid main() {\n  int row = gl_VertexID / SAMPLER_WIDTH;\n  int col = gl_VertexID - row * SAMPLER_WIDTH;\n  vec4 weights = texelFetch(bins, ivec2(col, row), 0);\n  vec3 value3 = mix(\n    mix(weights.rgb, vec3(weights.a), aggregatorTransform.isCount),\n    weights.rgb / max(weights.a, 1.0),\n    aggregatorTransform.isMean\n  );\n  if (weights.a == 0.0) {\n    value3 = vec3(NAN);\n  }\n\n#if NUM_DIMS == 1\n  binIds = float(gl_VertexID + aggregatorTransform.binIdRange.x);\n#else\n  int y = gl_VertexID / (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);\n  int x = gl_VertexID - y * (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);\n  binIds.y = float(y + aggregatorTransform.binIdRange.z);\n  binIds.x = float(x + aggregatorTransform.binIdRange.x);\n#endif\n\n#if NUM_CHANNELS == 3\n  values = value3;\n#elif NUM_CHANNELS == 2\n  values = value3.xy;\n#else\n  values = value3.x;\n#endif\n\n  gl_Position = vec4(0., 0., 0., 1.);\n  // This model renders into a 2x1 texture to obtain min and max simultaneously.\n  // See comments in fragment shader\n  gl_PointSize = 2.0;\n}\n`,r=`#version 300 es\n#define SHADER_NAME gpu-aggregation-domain-fragment\n\nprecision highp float;\n\n#if NUM_CHANNELS == 1\nflat in float values;\n#elif NUM_CHANNELS == 2\nflat in vec2 values;\n#else\nflat in vec3 values;\n#endif\n\nout vec4 fragColor;\n\nvoid main() {\n  vec3 value3;\n#if NUM_CHANNELS == 3\n  value3 = values;\n#elif NUM_CHANNELS == 2\n  value3.xy = values;\n#else\n  value3.x = values;\n#endif\n  if (isnan(value3.x)) discard;\n  // This shader renders into a 2x1 texture with blending=max\n  // The left pixel yields the max value of each channel\n  // The right pixel yields the min value of each channel\n  if (gl_FragCoord.x < 1.0) {\n    fragColor = vec4(value3, 1.0);\n  } else {\n    fragColor = vec4(-value3, 1.0);\n  }\n}\n`;return new td(t,{vs:n,fs:r,topology:\"point-list\",modules:[Tse],parameters:{blend:!0,blendColorSrcFactor:\"one\",blendColorDstFactor:\"one\",blendColorOperation:\"max\",blendAlphaSrcFactor:\"one\",blendAlphaDstFactor:\"one\",blendAlphaOperation:\"max\"},defines:{NUM_DIMS:e.dimensions,NUM_CHANNELS:e.channelCount,SAMPLER_WIDTH:dT},varyings:[\"binIds\",\"values\"],disableWarnings:!0})}var js=class{static isSupported(e){return e.features.has(\"float32-renderable-webgl\")&&e.features.has(\"texture-blend-float-webgl\")}constructor(e,n){this.binCount=0,this.binIds=null,this.results=[],this.device=e,this.dimensions=n.dimensions,this.channelCount=n.channelCount,this.props={...n,pointCount:0,binIdRange:[[0,0]],operations:[],attributes:{},binOptions:{}},this.needsUpdate=new Array(this.channelCount).fill(!0),this.binSorter=new iR(e,n),this.aggregationTransform=new oR(e,n),this.setProps(n)}getBins(){let e=this.aggregationTransform.binBuffer;return e?(this.binIds?.buffer!==e&&(this.binIds={buffer:e,type:\"float32\",size:this.dimensions}),this.binIds):null}getResult(e){let n=this.aggregationTransform.valueBuffer;return!n||e>=this.channelCount?null:(this.results[e]?.buffer!==n&&(this.results[e]={buffer:n,type:\"float32\",size:1,stride:this.channelCount*4,offset:e*4}),this.results[e])}getResultDomain(e){return this.aggregationTransform.domains[e]}getBin(e){if(e<0||e>=this.binCount)return null;let{binIdRange:n}=this.props,r;if(this.dimensions===1)r=[e+n[0][0]];else{let[[c,d],[m]]=n,b=d-c;r=[e%b+c,Math.floor(e/b)+m]}let i=this.binSorter.getBinValues(e);if(!i)return null;let o=i[3],s=[];for(let c=0;c<this.channelCount;c++){let d=this.props.operations[c];d===\"COUNT\"?s[c]=o:o===0?s[c]=NaN:s[c]=d===\"MEAN\"?i[c]/o:i[c]}return{id:r,value:s,count:o}}destroy(){this.binSorter.destroy(),this.aggregationTransform.destroy()}setProps(e){let n=this.props;if(\"binIdRange\"in e&&!Li(e.binIdRange,n.binIdRange,2)){let r=e.binIdRange;if(hn.assert(r.length===this.dimensions),this.dimensions===1){let[[i,o]]=r;this.binCount=o-i}else{let[[i,o],[s,c]]=r;this.binCount=(o-i)*(c-s)}this.binSorter.setDimensions(this.binCount,r),this.aggregationTransform.setDimensions(this.binCount,r),this.setNeedsUpdate()}if(e.operations)for(let r=0;r<this.channelCount;r++)e.operations[r]!==n.operations[r]&&this.setNeedsUpdate(r);if(e.pointCount!==void 0&&e.pointCount!==n.pointCount&&(this.binSorter.setModelProps({vertexCount:e.pointCount}),this.setNeedsUpdate()),e.binOptions&&(Li(e.binOptions,n.binOptions,2)||this.setNeedsUpdate(),this.binSorter.model.shaderInputs.setProps({binOptions:e.binOptions})),e.attributes){let r={},i={};for(let o of Object.values(e.attributes))for(let[s,c]of Object.entries(o.getValue()))ArrayBuffer.isView(c)?i[s]=c:c&&(r[s]=c);this.binSorter.setModelProps({attributes:r,constantAttributes:i})}e.shaderModuleProps&&this.binSorter.setModelProps({shaderModuleProps:e.shaderModuleProps}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate.fill(!0):this.needsUpdate[e]=!0}update(){}preDraw(){if(!this.needsUpdate.some(Boolean))return;let{operations:e}=this.props,n=this.needsUpdate.map((r,i)=>r?e[i]:null);this.binSorter.update(n),this.aggregationTransform.update(this.binSorter.texture,e);for(let r=0;r<this.channelCount;r++)this.needsUpdate[r]&&(this.needsUpdate[r]=!1,this.props.onUpdate?.({channel:r}))}};var sR=class extends xs{get isDrawable(){return!0}initializeState(){this.getAttributeManager().remove([\"instancePickingColors\"])}updateState(e){super.updateState(e);let n=this.getAggregatorType();if(e.changeFlags.extensionsChanged||this.state.aggregatorType!==n){this.state.aggregator?.destroy();let r=this.createAggregator(n);return r.setProps({attributes:this.getAttributeManager()?.attributes}),this.setState({aggregator:r,aggregatorType:n}),!0}return!1}finalizeState(e){super.finalizeState(e),this.state.aggregator.destroy()}updateAttributes(e){let{aggregator:n}=this.state;n.setProps({attributes:e});for(let r in e)this.onAttributeChange(r);n.update()}draw({shaderModuleProps:e}){let{aggregator:n}=this.state;n.setProps({shaderModuleProps:e}),n.preDraw()}_getAttributeManager(){return new Ju(this.context.device,{id:this.props.id,stats:this.context.stats})}};sR.layerName=\"AggregationLayer\";var tg=sR;var ng=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function e9(t,e=!1,n=Float32Array){let r;if(Number.isFinite(t[0]))r=new n(t);else{r=new n(t.length*4);let i=0;for(let o=0;o<t.length;o++){let s=t[o];r[i++]=s[0],r[i++]=s[1],r[i++]=s[2],r[i++]=Number.isFinite(s[3])?s[3]:255}}if(e)for(let i=0;i<r.length;i++)r[i]/=255;return r}var aR={linear:\"linear\",quantile:\"nearest\",quantize:\"nearest\",ordinal:\"nearest\"};function U2(t,e){t.setSampler({minFilter:aR[e],magFilter:aR[e]})}function V2(t,e,n=\"linear\"){let r=e9(e,!1,Uint8Array);return t.createTexture({format:\"rgba8unorm\",sampler:{minFilter:aR[n],magFilter:aR[n],addressModeU:\"clamp-to-edge\",addressModeV:\"clamp-to-edge\"},data:r,width:r.length/4,height:1})}var Ese=`#version 300 es\n#define SHADER_NAME screen-grid-layer-vertex-shader\n#define RANGE_COUNT 6\nin vec2 positions;\nin vec2 instancePositions;\nin float instanceWeights;\nin vec3 instancePickingColors;\nuniform sampler2D colorRange;\nout vec4 vColor;\nvec4 interp(float value, vec2 domain, sampler2D range) {\nfloat r = (value - domain.x) / (domain.y - domain.x);\nreturn texture(range, vec2(r, 0.5));\n}\nvoid main(void) {\nif (isnan(instanceWeights)) {\ngl_Position = vec4(0.);\nreturn;\n}\nvec2 pos = instancePositions * screenGrid.gridSizeClipspace + positions * screenGrid.cellSizeClipspace;\npos.x = pos.x - 1.0;\npos.y = 1.0 - pos.y;\ngl_Position = vec4(pos, 0., 1.);\nvColor = interp(instanceWeights, screenGrid.colorDomain, colorRange);\nvColor.a *= layer.opacity;\npicking_setPickingColor(instancePickingColors);\n}\n`;var Sse=`#version 300 es\n#define SHADER_NAME screen-grid-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nout vec4 fragColor;\nvoid main(void) {\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var d5e=`uniform screenGridUniforms {\n  vec2 cellSizeClipspace;\n  vec2 gridSizeClipspace;\n  vec2 colorDomain;\n} screenGrid;\n`,Cse={name:\"screenGrid\",vs:d5e,uniformTypes:{cellSizeClipspace:\"vec2<f32>\",gridSizeClipspace:\"vec2<f32>\",colorDomain:\"vec2<f32>\"}};var lR=class extends hi{getShaders(){return super.getShaders({vs:Ese,fs:Sse,modules:[$i,Cse]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:2,type:\"float32\",accessor:\"getBin\"},instanceWeights:{size:1,type:\"float32\",accessor:\"getWeight\"}}),this.state.model=this._getModel()}updateState(e){super.updateState(e);let{props:n,oldProps:r,changeFlags:i}=e,o=this.state.model;if(r.colorRange!==n.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=V2(this.context.device,n.colorRange,n.colorScaleType);let s={colorRange:this.state.colorTexture};o.shaderInputs.setProps({screenGrid:s})}else r.colorScaleType!==n.colorScaleType&&U2(this.state.colorTexture,n.colorScaleType);if(r.cellMarginPixels!==n.cellMarginPixels||r.cellSizePixels!==n.cellSizePixels||i.viewportChanged){let{width:s,height:c}=this.context.viewport,{cellSizePixels:d,cellMarginPixels:m}=this.props,b=Math.max(d-m,0),C={gridSizeClipspace:[d/s*2,d/c*2],cellSizeClipspace:[b/s*2,b/c*2]};o.shaderInputs.setProps({screenGrid:C})}}finalizeState(e){super.finalizeState(e),this.state.colorTexture?.destroy()}draw({uniforms:e}){let n=this.props.colorDomain(),r=this.state.model,i={colorDomain:n};r.shaderInputs.setProps({screenGrid:i}),r.draw(this.context.renderPass)}_getModel(){return new gr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new gi({topology:\"triangle-strip\",attributes:{positions:{value:new Float32Array([0,0,1,0,0,1,1,1]),size:2}}}),isInstanced:!0})}};lR.layerName=\"ScreenGridCellLayer\";var Mse=lR;var p5e=`uniform binOptionsUniforms {\n  float cellSizePixels;\n} binOptions;\n`,Ise={name:\"binOptions\",vs:p5e,uniformTypes:{cellSizePixels:\"f32\"}};var A5e={cellSizePixels:{type:\"number\",value:100,min:1},cellMarginPixels:{type:\"number\",value:2,min:0},colorRange:ng,colorScaleType:\"linear\",getPosition:{type:\"accessor\",value:t=>t.position},getWeight:{type:\"accessor\",value:1},gpuAggregation:!0,aggregation:\"SUM\"},pT=class extends tg{getAggregatorType(){return this.props.gpuAggregation&&js.isSupported(this.context.device)?\"gpu\":\"cpu\"}createAggregator(e){return e===\"cpu\"||!js.isSupported(this.context.device)?new Cc({dimensions:2,getBin:{sources:[\"positions\"],getValue:({positions:n},r,i)=>{let o=this.context.viewport,s=o.project(n),c=i.cellSizePixels;return s[0]<0||s[0]>=o.width||s[1]<0||s[1]>=o.height?null:[Math.floor(s[0]/c),Math.floor(s[1]/c)]}},getValue:[{sources:[\"counts\"],getValue:({counts:n})=>n}]}):new js(this.context.device,{dimensions:2,channelCount:1,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[Lr,Ise],vs:`\n  in vec3 positions;\n  in vec3 positions64Low;\n  in float counts;\n  \n  void getBin(out ivec2 binId) {\n    vec4 pos = project_position_to_clipspace(positions, positions64Low, vec3(0.0));\n    vec2 screenCoords = vec2(pos.x / pos.w + 1.0, 1.0 - pos.y / pos.w) / 2.0 * project.viewportSize / project.devicePixelRatio;\n    vec2 gridCoords = floor(screenCoords / binOptions.cellSizePixels);\n    binId = ivec2(gridCoords);\n  }\n  void getValue(out float weight) {\n    weight = counts;\n  }\n  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:\"getPosition\",type:\"float64\",fp64:this.use64bitPositions()},counts:{size:1,accessor:\"getWeight\"}})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){let n=super.updateState(e),{props:r,oldProps:i,changeFlags:o}=e,{cellSizePixels:s,aggregation:c}=r;if(n||o.dataChanged||o.updateTriggersChanged||o.viewportChanged||c!==i.aggregation||s!==i.cellSizePixels){let{width:d,height:m}=this.context.viewport,{aggregator:b}=this.state;b instanceof js&&b.setProps({binIdRange:[[0,Math.ceil(d/s)],[0,Math.ceil(m/s)]]}),b.setProps({pointCount:this.getNumInstances(),operations:[c],binOptions:{cellSizePixels:s}})}return o.viewportChanged&&this.state.aggregator.setNeedsUpdate(),n}onAttributeChange(e){let{aggregator:n}=this.state;switch(e){case\"positions\":n.setNeedsUpdate();break;case\"counts\":n.setNeedsUpdate(0);break;default:}}renderLayers(){let{aggregator:e}=this.state,n=this.getSubLayerClass(\"cells\",Mse),r=e.getBins(),i=e.getResult(0);return new n(this.props,this.getSubLayerProps({id:\"cell-layer\"}),{data:{length:e.binCount,attributes:{getBin:r,getWeight:i}},dataComparator:(o,s)=>o.length===s.length,updateTriggers:{getBin:[r],getWeight:[i]},parameters:{depthWriteEnabled:!1,...this.props.parameters},colorDomain:()=>this.props.colorDomain||e.getResultDomain(0),extensions:[]})}getPickingInfo(e){let n=e.info,{index:r}=n;if(r>=0){let i=this.state.aggregator.getBin(r),o;i&&(o={col:i.id[0],row:i.id[1],value:i.value[0],count:i.count},i.pointIndices&&(o.pointIndices=i.pointIndices,o.points=Array.isArray(this.props.data)?i.pointIndices.map(s=>this.props.data[s]):[])),n.object=o}return n}};pT.layerName=\"ScreenGridLayer\";pT.defaultProps=A5e;var cR=pT;var rg=class{constructor(e,n){this.props={scaleType:\"linear\",lowerPercentile:0,upperPercentile:100},this.domain=null,this.cutoff=null,this.input=e,this.inputLength=n,this.attribute=e}getScalePercentile(){if(!this._percentile){let e=Pse(this.input,this.inputLength);this._percentile=m5e(e)}return this._percentile}getScaleOrdinal(){if(!this._ordinal){let e=Pse(this.input,this.inputLength);this._ordinal=g5e(e)}return this._ordinal}getCutoff({scaleType:e,lowerPercentile:n,upperPercentile:r}){if(e===\"quantile\")return[n,r-1];if(n>0||r<100){let{domain:i}=this.getScalePercentile(),o=i[Math.floor(n)-1]??-1/0,s=i[Math.floor(r)-1]??1/0;if(e===\"ordinal\"){let{domain:c}=this.getScaleOrdinal();o=c.findIndex(d=>d>=o),s=c.findIndex(d=>d>s)-1,s===-2&&(s=c.length-1)}return[o,s]}return null}update(e){let n=this.props;if(e.scaleType!==n.scaleType)switch(e.scaleType){case\"quantile\":{let{attribute:r}=this.getScalePercentile();this.attribute=r,this.domain=[0,99];break}case\"ordinal\":{let{attribute:r,domain:i}=this.getScaleOrdinal();this.attribute=r,this.domain=[0,i.length-1];break}default:this.attribute=this.input,this.domain=null}return(e.scaleType!==n.scaleType||e.lowerPercentile!==n.lowerPercentile||e.upperPercentile!==n.upperPercentile)&&(this.cutoff=this.getCutoff(e)),this.props=e,this}};function g5e(t){let e=new Set;for(let i of t)Number.isFinite(i)&&e.add(i);let n=Array.from(e).sort(),r=new Map;for(let i=0;i<n.length;i++)r.set(n[i],i);return{attribute:{value:t.map(i=>Number.isFinite(i)?r.get(i):NaN),type:\"float32\",size:1},domain:n}}function m5e(t,e=100){let n=Array.from(t).filter(Number.isFinite).sort(_5e),r=0,i=Math.max(1,e),o=new Array(i-1);for(;++r<i;)o[r-1]=y5e(n,r/i);return{attribute:{value:t.map(s=>Number.isFinite(s)?x5e(o,s):NaN),type:\"float32\",size:1},domain:o}}function Pse(t,e){let n=(t.stride??4)/4,r=(t.offset??0)/4,i=t.value;if(!i){let s=t.buffer?.readSyncWebGL(0,n*4*e);s&&(i=new Float32Array(s.buffer),t.value=i)}if(n===1)return i.subarray(0,e);let o=new Float32Array(e);for(let s=0;s<e;s++)o[s]=i[s*n+r];return o}function _5e(t,e){return t-e}function y5e(t,e){let n=t.length;if(e<=0||n<2)return t[0];if(e>=1)return t[n-1];let r=(n-1)*e,i=Math.floor(r),o=t[i],s=t[i+1];return o+(s-o)*(r-i)}function x5e(t,e){let n=0,r=t.length;for(;n<r;){let i=n+r>>>1;t[i]>e?r=i:n=i+1}return n}function G2({dataBounds:t,getBinId:e,padding:n=0}){let r=[t[0],t[1],[t[0][0],t[1][1]],[t[1][0],t[0][1]]].map(d=>e(d)),i=Math.min(...r.map(d=>d[0]))-n,o=Math.min(...r.map(d=>d[1]))-n,s=Math.max(...r.map(d=>d[0]))+n+1,c=Math.max(...r.map(d=>d[1]))+n+1;return[[i,s],[o,c]]}var Rse=Math.PI/3,uR=2*Math.sin(Rse),hR=1.5,Bse=Array.from({length:6},(t,e)=>{let n=e*Rse;return[Math.sin(n),-Math.cos(n)]});function fR([t,e],n){let r=Math.round(e=e/n/hR),i=Math.round(t=t/n/uR-(r&1)/2),o=e-r;if(Math.abs(o)*3>1){let s=t-i,c=i+(t<i?-1:1)/2,d=r+(e<r?-1:1),m=t-c,b=e-d;s*s+o*o>m*m+b*b&&(i=c+(r&1?1:-1)/2,r=d)}return[i,r]}var Dse=`\nconst vec2 DIST = vec2(${uR}, ${hR});\n\nivec2 pointToHexbin(vec2 p, float radius) {\n  p /= radius * DIST;\n  float pj = round(p.y);\n  float pjm2 = mod(pj, 2.0);\n  p.x -= pjm2 * 0.5;\n  float pi = round(p.x);\n  vec2 d1 = p - vec2(pi, pj);\n\n  if (abs(d1.y) * 3. > 1.) {\n    vec2 v2 = step(0.0, d1) - 0.5;\n    v2.y *= 2.0;\n    vec2 d2 = d1 - v2;\n    if (dot(d1, d1) > dot(d2, d2)) {\n      pi += v2.x + pjm2 - 0.5;\n      pj += v2.y;\n    }\n  }\n  return ivec2(pi, pj);\n}\n`;function t9([t,e],n){return[(t+(e&1)/2)*n*uR,e*n*hR]}var Lse=`\nconst vec2 DIST = vec2(${uR}, ${hR});\n\nvec2 hexbinCentroid(vec2 binId, float radius) {\n  binId.x += fract(binId.y * 0.5);\n  return binId * DIST * radius;\n}\n`;var Ose=`#version 300 es\n#define SHADER_NAME hexagon-cell-layer-vertex-shader\nin vec3 positions;\nin vec3 normals;\nin vec2 instancePositions;\nin float instanceElevationValues;\nin float instanceColorValues;\nin vec3 instancePickingColors;\nuniform sampler2D colorRange;\nout vec4 vColor;\n${Lse}\nfloat interp(float value, vec2 domain, vec2 range) {\nfloat r = min(max((value - domain.x) / (domain.y - domain.x), 0.), 1.);\nreturn mix(range.x, range.y, r);\n}\nvec4 interp(float value, vec2 domain, sampler2D range) {\nfloat r = (value - domain.x) / (domain.y - domain.x);\nreturn texture(range, vec2(r, 0.5));\n}\nvoid main(void) {\ngeometry.pickingColor = instancePickingColors;\nif (isnan(instanceColorValues) ||\ninstanceColorValues < hexagon.colorDomain.z ||\ninstanceColorValues > hexagon.colorDomain.w ||\ninstanceElevationValues < hexagon.elevationDomain.z ||\ninstanceElevationValues > hexagon.elevationDomain.w\n) {\ngl_Position = vec4(0.);\nreturn;\n}\nvec2 commonPosition = hexbinCentroid(instancePositions, column.radius) + (hexagon.originCommon - project.commonOrigin.xy);\ncommonPosition += positions.xy * column.radius * column.coverage;\ngeometry.position = vec4(commonPosition, 0.0, 1.0);\ngeometry.normal = project_normal(normals);\nfloat elevation = 0.0;\nif (column.extruded) {\nelevation = interp(instanceElevationValues, hexagon.elevationDomain.xy, hexagon.elevationRange);\nelevation = project_size(elevation);\ngeometry.position.z = (positions.z + 1.0) / 2.0 * elevation;\n}\ngl_Position = project_common_position_to_clipspace(geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvColor = interp(instanceColorValues, hexagon.colorDomain.xy, colorRange);\nvColor.a *= layer.opacity;\nif (column.extruded) {\nvColor.rgb = lighting_getLightColor(vColor.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var v5e=`uniform hexagonUniforms {\n  vec4 colorDomain;\n  vec4 elevationDomain;\n  vec2 elevationRange;\n  vec2 originCommon;\n} hexagon;\n`,Fse={name:\"hexagon\",vs:v5e,uniformTypes:{colorDomain:\"vec4<f32>\",elevationDomain:\"vec4<f32>\",elevationRange:\"vec2<f32>\",originCommon:\"vec2<f32>\"}};var dR=class extends $u{getShaders(){let e=super.getShaders();return e.modules.push(Fse),{...e,vs:Ose}}initializeState(){super.initializeState();let e=this.getAttributeManager();e.remove([\"instanceElevations\",\"instanceFillColors\",\"instanceLineColors\",\"instanceStrokeWidths\"]),e.addInstanced({instancePositions:{size:2,type:\"float32\",accessor:\"getBin\"},instanceColorValues:{size:1,type:\"float32\",accessor:\"getColorValue\"},instanceElevationValues:{size:1,type:\"float32\",accessor:\"getElevationValue\"}})}updateState(e){super.updateState(e);let{props:n,oldProps:r}=e,i=this.state.fillModel;if(r.colorRange!==n.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=V2(this.context.device,n.colorRange,n.colorScaleType);let o={colorRange:this.state.colorTexture};i.shaderInputs.setProps({hexagon:o})}else r.colorScaleType!==n.colorScaleType&&U2(this.state.colorTexture,n.colorScaleType)}finalizeState(e){super.finalizeState(e),this.state.colorTexture?.destroy()}draw({uniforms:e}){let{radius:n,hexOriginCommon:r,elevationRange:i,elevationScale:o,extruded:s,coverage:c,colorDomain:d,elevationDomain:m}=this.props,b=this.props.colorCutoff||[-1/0,1/0],C=this.props.elevationCutoff||[-1/0,1/0],B=this.state.fillModel;B.vertexArray.indexBuffer&&B.setIndexBuffer(null),B.setVertexCount(this.state.fillVertexCount);let k={colorDomain:[Math.max(d[0],b[0]),Math.min(d[1],b[1]),Math.max(d[0]-1,b[0]),Math.min(d[1]+1,b[1])],elevationDomain:[Math.max(m[0],C[0]),Math.min(m[1],C[1]),Math.max(m[0]-1,C[0]),Math.min(m[1]+1,C[1])],elevationRange:[i[0]*o,i[1]*o],originCommon:r};B.shaderInputs.setProps({column:{extruded:s,coverage:c,radius:n},hexagon:k}),B.draw(this.context.renderPass)}};dR.layerName=\"HexagonCellLayer\";var kse=dR;var b5e=`uniform binOptionsUniforms {\n  vec2 hexOriginCommon;\n  float radiusCommon;\n} binOptions;\n`,Nse={name:\"binOptions\",vs:b5e,uniformTypes:{hexOriginCommon:\"vec2<f32>\",radiusCommon:\"f32\"}};function zse(){}var w5e={gpuAggregation:!0,colorDomain:null,colorRange:ng,getColorValue:{type:\"accessor\",value:null},getColorWeight:{type:\"accessor\",value:1},colorAggregation:\"SUM\",lowerPercentile:{type:\"number\",min:0,max:100,value:0},upperPercentile:{type:\"number\",min:0,max:100,value:100},colorScaleType:\"quantize\",onSetColorDomain:zse,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:\"accessor\",value:null},getElevationWeight:{type:\"accessor\",value:1},elevationAggregation:\"SUM\",elevationScale:{type:\"number\",min:0,value:1},elevationLowerPercentile:{type:\"number\",min:0,max:100,value:0},elevationUpperPercentile:{type:\"number\",min:0,max:100,value:100},elevationScaleType:\"linear\",onSetElevationDomain:zse,radius:{type:\"number\",min:1,value:1e3},coverage:{type:\"number\",min:0,max:1,value:1},getPosition:{type:\"accessor\",value:t=>t.position},hexagonAggregator:{type:\"function\",optional:!0,value:null},extruded:!1,material:!0},AT=class extends tg{getAggregatorType(){let{gpuAggregation:e,hexagonAggregator:n,getColorValue:r,getElevationValue:i}=this.props;return e&&(n||r||i)?(hn.warn(\"Features not supported by GPU aggregation, falling back to CPU\")(),\"cpu\"):e&&js.isSupported(this.context.device)?\"gpu\":\"cpu\"}createAggregator(e){if(e===\"cpu\"){let{hexagonAggregator:n,radius:r}=this.props;return new Cc({dimensions:2,getBin:{sources:[\"positions\"],getValue:({positions:i},o,s)=>{if(n)return n(i,r);let d=this.state.aggregatorViewport.projectPosition(i),{radiusCommon:m,hexOriginCommon:b}=s;return fR([d[0]-b[0],d[1]-b[1]],m)}},getValue:[{sources:[\"colorWeights\"],getValue:({colorWeights:i})=>i},{sources:[\"elevationWeights\"],getValue:({elevationWeights:i})=>i}]})}return new js(this.context.device,{dimensions:2,channelCount:2,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[Lr,Nse],vs:`\n  in vec3 positions;\n  in vec3 positions64Low;\n  in float colorWeights;\n  in float elevationWeights;\n  \n  ${Dse}\n\n  void getBin(out ivec2 binId) {\n    vec3 positionCommon = project_position(positions, positions64Low);\n    binId = pointToHexbin(positionCommon.xy, binOptions.radiusCommon);\n  }\n  void getValue(out vec2 value) {\n    value = vec2(colorWeights, elevationWeights);\n  }\n  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:\"getPosition\",type:\"float64\",fp64:this.use64bitPositions()},colorWeights:{size:1,accessor:\"getColorWeight\"},elevationWeights:{size:1,accessor:\"getElevationWeight\"}})}updateState(e){let n=super.updateState(e),{props:r,oldProps:i,changeFlags:o}=e,{aggregator:s}=this.state;if((o.dataChanged||!this.state.dataAsArray)&&(r.getColorValue||r.getElevationValue)&&(this.state.dataAsArray=Array.from(ys(r.data).iterable)),n||o.dataChanged||r.radius!==i.radius||r.getColorValue!==i.getColorValue||r.getElevationValue!==i.getElevationValue||r.colorAggregation!==i.colorAggregation||r.elevationAggregation!==i.elevationAggregation){this._updateBinOptions();let{radiusCommon:c,hexOriginCommon:d,binIdRange:m,dataAsArray:b}=this.state;if(s.setProps({binIdRange:m,pointCount:this.getNumInstances(),operations:[r.colorAggregation,r.elevationAggregation],binOptions:{radiusCommon:c,hexOriginCommon:d},onUpdate:this._onAggregationUpdate.bind(this)}),b){let{getColorValue:C,getElevationValue:B}=this.props;s.setProps({customOperations:[C&&(k=>C(k.map(V=>b[V]),{indices:k,data:r.data})),B&&(k=>B(k.map(V=>b[V]),{indices:k,data:r.data}))]})}}return o.updateTriggersChanged&&o.updateTriggersChanged.getColorValue&&s.setNeedsUpdate(0),o.updateTriggersChanged&&o.updateTriggersChanged.getElevationValue&&s.setNeedsUpdate(1),n}_updateBinOptions(){let e=this.getBounds(),n=1,r=[0,0],i=[[0,1],[0,1]],o=this.context.viewport;if(e&&Number.isFinite(e[0][0])){let s=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2],{radius:c}=this.props,{unitsPerMeter:d}=o.getDistanceScales(s);n=d[0]*c;let m=fR(o.projectFlat(s),n);s=o.unprojectFlat(t9(m,n));let b=o.constructor;o=o.isGeospatial?new b({longitude:s[0],latitude:s[1],zoom:12}):new su({position:[s[0],s[1],0],zoom:12}),r=[Math.fround(o.center[0]),Math.fround(o.center[1])],i=G2({dataBounds:e,getBinId:C=>{let B=o.projectFlat(C);return B[0]-=r[0],B[1]-=r[1],fR(B,n)},padding:1})}this.setState({radiusCommon:n,hexOriginCommon:r,binIdRange:i,aggregatorViewport:o})}draw(e){e.shaderModuleProps.project&&(e.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(e)}_onAggregationUpdate({channel:e}){let n=this.getCurrentLayer().props,{aggregator:r}=this.state;if(e===0){let i=r.getResult(0);this.setState({colors:new rg(i,r.binCount)}),n.onSetColorDomain(r.getResultDomain(0))}else if(e===1){let i=r.getResult(1);this.setState({elevations:new rg(i,r.binCount)}),n.onSetElevationDomain(r.getResultDomain(1))}}onAttributeChange(e){let{aggregator:n}=this.state;switch(e){case\"positions\":n.setNeedsUpdate(),this._updateBinOptions();let{radiusCommon:r,hexOriginCommon:i,binIdRange:o}=this.state;n.setProps({binIdRange:o,binOptions:{radiusCommon:r,hexOriginCommon:i}});break;case\"colorWeights\":n.setNeedsUpdate(0);break;case\"elevationWeights\":n.setNeedsUpdate(1);break;default:}}renderLayers(){let{aggregator:e,radiusCommon:n,hexOriginCommon:r}=this.state,{elevationScale:i,colorRange:o,elevationRange:s,extruded:c,coverage:d,material:m,transitions:b,colorScaleType:C,lowerPercentile:B,upperPercentile:k,colorDomain:V,elevationScaleType:q,elevationLowerPercentile:K,elevationUpperPercentile:Y,elevationDomain:ee}=this.props,J=this.getSubLayerClass(\"cells\",kse),se=e.getBins(),xe=this.state.colors?.update({scaleType:C,lowerPercentile:B,upperPercentile:k}),Ee=this.state.elevations?.update({scaleType:q,lowerPercentile:K,upperPercentile:Y});return!xe||!Ee?null:new J(this.getSubLayerProps({id:\"cells\"}),{data:{length:e.binCount,attributes:{getBin:se,getColorValue:xe.attribute,getElevationValue:Ee.attribute}},dataComparator:(Xe,Ne)=>Xe.length===Ne.length,updateTriggers:{getBin:[se],getColorValue:[xe.attribute],getElevationValue:[Ee.attribute]},diskResolution:6,vertices:Bse,radius:n,hexOriginCommon:r,elevationScale:i,colorRange:o,colorScaleType:C,elevationRange:s,extruded:c,coverage:d,material:m,colorDomain:xe.domain||V||e.getResultDomain(0),elevationDomain:Ee.domain||ee||e.getResultDomain(1),colorCutoff:xe.cutoff,elevationCutoff:Ee.cutoff,transitions:b&&{getFillColor:b.getColorValue||b.getColorWeight,getElevation:b.getElevationValue||b.getElevationWeight},extensions:[]})}getPickingInfo(e){let n=e.info,{index:r}=n;if(r>=0){let i=this.state.aggregator.getBin(r),o;if(i){let s=t9(i.id,this.state.radiusCommon),c=this.context.viewport.unprojectFlat(s);o={col:i.id[0],row:i.id[1],position:c,colorValue:i.value[0],elevationValue:i.value[1],count:i.count},i.pointIndices&&(o.pointIndices=i.pointIndices,o.points=Array.isArray(this.props.data)?i.pointIndices.map(d=>this.props.data[d]):[])}n.object=o}return n}};AT.layerName=\"HexagonLayer\";AT.defaultProps=w5e;var pR=AT;var vn=.16666666666666666,xt={N:[0,.5],E:[.5,0],S:[0,-.5],W:[-.5,0],NE:[.5,.5],NW:[-.5,.5],SE:[.5,-.5],SW:[-.5,-.5]},H2=[xt.W,xt.SW,xt.S],W2=[xt.S,xt.SE,xt.E],j2=[xt.E,xt.NE,xt.N],X2=[xt.NW,xt.W,xt.N],Y2=[[-.5,vn],[-.5,-vn],[-vn,-.5],[vn,-.5]],Z2=[[-vn,-.5],[vn,-.5],[.5,-vn],[.5,vn]],q2=[[.5,-vn],[.5,vn],[vn,.5],[-vn,.5]],Q2=[[-.5,vn],[-.5,-vn],[vn,.5],[-vn,.5]],Use=[xt.W,xt.SW,xt.SE,xt.E],Vse=[xt.S,xt.SE,xt.NE,xt.N],Gse=[xt.NW,xt.W,xt.E,xt.NE],Hse=[xt.NW,xt.SW,xt.S,xt.N],Wse=[[-.5,vn],[-.5,-vn],[.5,-vn],[.5,vn]],jse=[[-vn,-.5],[vn,-.5],[vn,.5],[-vn,.5]],T5e=[xt.NW,xt.SW,xt.SE,xt.NE],Xse=[xt.NW,xt.SW,xt.SE,xt.E,xt.N],Yse=[xt.W,xt.SW,xt.SE,xt.NE,xt.N],Zse=[xt.NW,xt.W,xt.S,xt.SE,xt.NE],qse=[xt.NW,xt.SW,xt.S,xt.E,xt.NE],Qse=[xt.NW,xt.W,[.5,-vn],[.5,vn],xt.N],Kse=[[-vn,-.5],[vn,-.5],xt.E,xt.NE,xt.N],Jse=[[-.5,vn],[-.5,-vn],xt.S,xt.SE,xt.E],$se=[xt.W,xt.SW,xt.S,[vn,.5],[-vn,.5]],eae=[xt.NW,xt.W,[-vn,-.5],[vn,-.5],xt.N],tae=[[-.5,vn],[-.5,-vn],xt.E,xt.NE,xt.N],nae=[xt.S,xt.SE,xt.E,[vn,.5],[-vn,.5]],rae=[xt.W,xt.SW,xt.S,[.5,-vn],[.5,vn]],iae=[xt.W,xt.SW,xt.SE,xt.E,[vn,.5],[-vn,.5]],oae=[[-.5,vn],[-.5,-vn],xt.S,xt.SE,xt.NE,xt.N],sae=[xt.NW,xt.W,[-vn,-.5],[vn,-.5],xt.E,xt.NE],aae=[xt.NW,xt.SW,xt.S,[.5,-vn],[.5,vn],xt.N],K2=[xt.W,xt.SW,xt.S,xt.E,xt.NE,xt.N],J2=[xt.NW,xt.W,xt.S,xt.SE,xt.E,xt.N],AR=[[-.5,vn],[-.5,-vn],[-vn,-.5],[vn,-.5],xt.E,xt.NE,xt.N],gR=[xt.W,xt.SW,xt.S,[.5,-vn],[.5,vn],[vn,.5],[-vn,.5]],mR=[xt.NW,xt.W,[-vn,-.5],[vn,-.5],[.5,-vn],[.5,vn],xt.N],_R=[[-.5,vn],[-.5,-vn],xt.S,xt.SE,xt.E,[vn,.5],[-vn,.5]],lae=[[-.5,vn],[-.5,-vn],[-vn,-.5],[vn,-.5],[.5,-vn],[.5,vn],[vn,.5],[-vn,.5]],cae={0:[],1:[[xt.W,xt.S]],2:[[xt.S,xt.E]],3:[[xt.W,xt.E]],4:[[xt.N,xt.E]],5:{0:[[xt.W,xt.S],[xt.N,xt.E]],1:[[xt.W,xt.N],[xt.S,xt.E]]},6:[[xt.N,xt.S]],7:[[xt.W,xt.N]],8:[[xt.W,xt.N]],9:[[xt.N,xt.S]],10:{0:[[xt.W,xt.N],[xt.S,xt.E]],1:[[xt.W,xt.S],[xt.N,xt.E]]},11:[[xt.N,xt.E]],12:[[xt.W,xt.E]],13:[[xt.S,xt.E]],14:[[xt.W,xt.S]],15:[]};function pn(t){return parseInt(t,4)}var uae={[pn(\"0000\")]:[],[pn(\"2222\")]:[],[pn(\"2221\")]:[H2],[pn(\"2212\")]:[W2],[pn(\"2122\")]:[j2],[pn(\"1222\")]:[X2],[pn(\"0001\")]:[H2],[pn(\"0010\")]:[W2],[pn(\"0100\")]:[j2],[pn(\"1000\")]:[X2],[pn(\"2220\")]:[Y2],[pn(\"2202\")]:[Z2],[pn(\"2022\")]:[q2],[pn(\"0222\")]:[Q2],[pn(\"0002\")]:[Y2],[pn(\"0020\")]:[Z2],[pn(\"0200\")]:[q2],[pn(\"2000\")]:[Q2],[pn(\"0011\")]:[Use],[pn(\"0110\")]:[Vse],[pn(\"1100\")]:[Gse],[pn(\"1001\")]:[Hse],[pn(\"2211\")]:[Use],[pn(\"2112\")]:[Vse],[pn(\"1122\")]:[Gse],[pn(\"1221\")]:[Hse],[pn(\"2200\")]:[Wse],[pn(\"2002\")]:[jse],[pn(\"0022\")]:[Wse],[pn(\"0220\")]:[jse],[pn(\"1111\")]:[T5e],[pn(\"1211\")]:[Xse],[pn(\"2111\")]:[Yse],[pn(\"1112\")]:[Zse],[pn(\"1121\")]:[qse],[pn(\"1011\")]:[Xse],[pn(\"0111\")]:[Yse],[pn(\"1110\")]:[Zse],[pn(\"1101\")]:[qse],[pn(\"1200\")]:[Qse],[pn(\"0120\")]:[Kse],[pn(\"0012\")]:[Jse],[pn(\"2001\")]:[$se],[pn(\"1022\")]:[Qse],[pn(\"2102\")]:[Kse],[pn(\"2210\")]:[Jse],[pn(\"0221\")]:[$se],[pn(\"1002\")]:[eae],[pn(\"2100\")]:[tae],[pn(\"0210\")]:[nae],[pn(\"0021\")]:[rae],[pn(\"1220\")]:[eae],[pn(\"0122\")]:[tae],[pn(\"2012\")]:[nae],[pn(\"2201\")]:[rae],[pn(\"0211\")]:[iae],[pn(\"2110\")]:[oae],[pn(\"1102\")]:[sae],[pn(\"1021\")]:[aae],[pn(\"2011\")]:[iae],[pn(\"0112\")]:[oae],[pn(\"1120\")]:[sae],[pn(\"1201\")]:[aae],[pn(\"2101\")]:[K2],[pn(\"0121\")]:[K2],[pn(\"1012\")]:[J2],[pn(\"1210\")]:[J2],[pn(\"0101\")]:{0:[H2,j2],1:[K2],2:[K2]},[pn(\"1010\")]:{0:[X2,W2],1:[J2],2:[J2]},[pn(\"2121\")]:{0:[K2],1:[K2],2:[H2,j2]},[pn(\"1212\")]:{0:[J2],1:[J2],2:[X2,W2]},[pn(\"2120\")]:{0:[AR],1:[AR],2:[Y2,j2]},[pn(\"2021\")]:{0:[gR],1:[gR],2:[H2,q2]},[pn(\"1202\")]:{0:[mR],1:[mR],2:[X2,Z2]},[pn(\"0212\")]:{0:[_R],1:[_R],2:[W2,Q2]},[pn(\"0102\")]:{0:[Y2,j2],1:[AR],2:[AR]},[pn(\"0201\")]:{0:[H2,q2],1:[gR],2:[gR]},[pn(\"1020\")]:{0:[X2,Z2],1:[mR],2:[mR]},[pn(\"2010\")]:{0:[W2,Q2],1:[_R],2:[_R]},[pn(\"2020\")]:{0:[Q2,Z2],1:[lae],2:[Y2,q2]},[pn(\"0202\")]:{0:[q2,Y2],1:[lae],2:[Q2,Z2]}};function gT(t,e){return Number.isNaN(t)?0:Array.isArray(e)?t<e[0]?0:t<e[1]?1:2:t>=e?1:0}function hae(t){let{x:e,y:n,xRange:r,yRange:i,getValue:o,threshold:s}=t,c=e<r[0],d=e>=r[1]-1,m=n<i[0],b=n>=i[1]-1,C=c||d||m||b,B=0,k,V,q,K;if(c||b)q=0;else{let J=o(e,n+1);q=gT(J,s),B+=J}if(d||b)K=0;else{let J=o(e+1,n+1);K=gT(J,s),B+=J}if(d||m)V=0;else{let J=o(e+1,n);V=gT(J,s),B+=J}if(c||m)k=0;else{let J=o(e,n);k=gT(J,s),B+=J}let Y=-1;Number.isFinite(s)&&(Y=q<<3|K<<2|V<<1|k),Array.isArray(s)&&(Y=q<<6|K<<4|V<<2|k);let ee=0;return C||(ee=gT(B/4,s)),{code:Y,meanCode:ee}}function fae(t){let{x:e,y:n,z:r,code:i,meanCode:o}=t,s=uae[i];Array.isArray(s)||(s=s[o]);let c=e+1,d=n+1,m=[];return s.forEach(b=>{let C=[];b.forEach(B=>{let k=c+B[0],V=d+B[1];C.push([k,V,r])}),m.push(C)}),m}function dae(t){let{x:e,y:n,z:r,code:i,meanCode:o}=t,s=cae[i];Array.isArray(s)||(s=s[o]);let c=e+1,d=n+1,m=[];return s.forEach(b=>{b.forEach(C=>{let B=c+C[0],k=d+C[1];m.push([B,k,r])})}),m}function pae({contours:t,getValue:e,xRange:n,yRange:r}){let i=[],o=[],s=0,c=0;for(let d=0;d<t.length;d++){let m=t[d],b=m.zIndex??d,{threshold:C}=m;for(let B=n[0]-1;B<n[1];B++)for(let k=r[0]-1;k<r[1];k++){let{code:V,meanCode:q}=hae({getValue:e,threshold:C,x:B,y:k,xRange:n,yRange:r}),K={x:B,y:k,z:b,code:V,meanCode:q};if(Array.isArray(C)){let Y=fae(K);for(let ee of Y)o[c++]={vertices:ee,contour:m}}else{let Y=dae(K);Y.length>0&&(i[s++]={vertices:Y,contour:m})}}}return{lines:i,polygons:o}}function Aae(t){let{aggregator:e,binIdRange:n,channel:r}=t;if(e instanceof js){let i=e.getResult(r)?.buffer;if(i){let o=new Float32Array(i.readSyncWebGL().buffer);return E5e(o,n)}}if(e instanceof Cc){let i=e.getResult(r)?.value,o=e.getBins()?.value;if(o&&i)return S5e(i,o,e.binCount)}return null}function E5e(t,e){let[[n,r],[i,o]]=e,s=r-n,c=o-i;return(d,m)=>(d-=n,m-=i,d<0||d>=s||m<0||m>=c?NaN:t[m*s+d])}function S5e(t,e,n){let r={};for(let i=0;i<n;i++){let o=e[i*2],s=e[i*2+1];r[o]=r[o]||{},r[o][s]=t[i]}return(i,o)=>r[i]?.[o]??NaN}var C5e=`uniform binOptionsUniforms {\n  vec2 cellOriginCommon;\n  vec2 cellSizeCommon;\n} binOptions;\n`,gae={name:\"binOptions\",vs:C5e,uniformTypes:{cellOriginCommon:\"vec2<f32>\",cellSizeCommon:\"vec2<f32>\"}};var mae=[255,255,255,255],M5e=1,I5e={cellSize:{type:\"number\",min:1,value:1e3},gridOrigin:{type:\"array\",compare:!0,value:[0,0]},getPosition:{type:\"accessor\",value:t=>t.position},getWeight:{type:\"accessor\",value:1},gpuAggregation:!0,aggregation:\"SUM\",contours:{type:\"object\",value:[{threshold:1}],optional:!0,compare:3},zOffset:.005},mT=class extends tg{getAggregatorType(){return this.props.gpuAggregation&&js.isSupported(this.context.device)?\"gpu\":\"cpu\"}createAggregator(e){return e===\"cpu\"?new Cc({dimensions:2,getBin:{sources:[\"positions\"],getValue:({positions:n},r,i)=>{let s=this.state.aggregatorViewport.projectPosition(n),{cellSizeCommon:c,cellOriginCommon:d}=i;return[Math.floor((s[0]-d[0])/c[0]),Math.floor((s[1]-d[1])/c[1])]}},getValue:[{sources:[\"counts\"],getValue:({counts:n})=>n}],onUpdate:this._onAggregationUpdate.bind(this)}):new js(this.context.device,{dimensions:2,channelCount:1,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[Lr,gae],vs:`\n  in vec3 positions;\n  in vec3 positions64Low;\n  in float counts;\n\n  void getBin(out ivec2 binId) {\n    vec3 positionCommon = project_position(positions, positions64Low);\n    vec2 gridCoords = floor(positionCommon.xy / binOptions.cellSizeCommon);\n    binId = ivec2(gridCoords);\n  }\n  void getValue(out float value) {\n    value = counts;\n  }\n  `}),onUpdate:this._onAggregationUpdate.bind(this)})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:\"getPosition\",type:\"float64\",fp64:this.use64bitPositions()},counts:{size:1,accessor:\"getWeight\"}})}updateState(e){let n=super.updateState(e),{props:r,oldProps:i,changeFlags:o}=e,{aggregator:s}=this.state;if(n||o.dataChanged||r.cellSize!==i.cellSize||!Li(r.gridOrigin,i.gridOrigin,1)||r.aggregation!==i.aggregation){this._updateBinOptions();let{cellSizeCommon:c,cellOriginCommon:d,binIdRange:m}=this.state;s.setProps({binIdRange:m,pointCount:this.getNumInstances(),operations:[r.aggregation],binOptions:{cellSizeCommon:c,cellOriginCommon:d}})}return Li(i.contours,r.contours,2)||this.setState({contourData:null}),n}_updateBinOptions(){let e=this.getBounds(),n=[1,1],r=[0,0],i=[[0,1],[0,1]],o=this.context.viewport;if(e&&Number.isFinite(e[0][0])){let s=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2],{cellSize:c,gridOrigin:d}=this.props,{unitsPerMeter:m}=o.getDistanceScales(s);n[0]=m[0]*c,n[1]=m[1]*c;let b=o.projectFlat(s);r=[Math.floor((b[0]-d[0])/n[0])*n[0]+d[0],Math.floor((b[1]-d[1])/n[1])*n[1]+d[1]],s=o.unprojectFlat(r);let C=o.constructor;o=o.isGeospatial?new C({longitude:s[0],latitude:s[1],zoom:12}):new su({position:[s[0],s[1],0],zoom:12}),r=[Math.fround(o.center[0]),Math.fround(o.center[1])],i=G2({dataBounds:e,getBinId:B=>{let k=o.projectFlat(B);return[Math.floor((k[0]-r[0])/n[0]),Math.floor((k[1]-r[1])/n[1])]}})}this.setState({cellSizeCommon:n,cellOriginCommon:r,binIdRange:i,aggregatorViewport:o})}draw(e){e.shaderModuleProps.project&&(e.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(e)}_onAggregationUpdate(){let{aggregator:e,binIdRange:n}=this.state;this.setState({aggregatedValueReader:Aae({aggregator:e,binIdRange:n,channel:0}),contourData:null})}_getContours(){let{aggregatedValueReader:e}=this.state;if(!e)return null;if(!this.state.contourData){let{binIdRange:n}=this.state,{contours:r}=this.props,i=pae({contours:r,getValue:e,xRange:n[0],yRange:n[1]});this.state.contourData=i}return this.state.contourData}onAttributeChange(e){let{aggregator:n}=this.state;switch(e){case\"positions\":n.setNeedsUpdate(),this._updateBinOptions();let{cellSizeCommon:r,cellOriginCommon:i,binIdRange:o}=this.state;n.setProps({binIdRange:o,binOptions:{cellSizeCommon:r,cellOriginCommon:i}});break;case\"counts\":n.setNeedsUpdate(0);break;default:}}renderLayers(){let e=this._getContours();if(!e)return null;let{lines:n,polygons:r}=e,{zOffset:i}=this.props,{cellOriginCommon:o,cellSizeCommon:s}=this.state,c=this.getSubLayerClass(\"lines\",eh),d=this.getSubLayerClass(\"bands\",cd),m=new wn().translate([o[0],o[1],0]).scale([s[0],s[1],i]),b=n&&n.length>0&&new c(this.getSubLayerProps({id:\"lines\"}),{data:n,coordinateSystem:Cn.CARTESIAN,modelMatrix:m,getPath:B=>B.vertices,getColor:B=>B.contour.color??mae,getWidth:B=>B.contour.strokeWidth??M5e,widthUnits:\"pixels\"}),C=r&&r.length>0&&new d(this.getSubLayerProps({id:\"bands\"}),{data:r,coordinateSystem:Cn.CARTESIAN,modelMatrix:m,getPolygon:B=>B.vertices,getFillColor:B=>B.contour.color??mae});return[b,C]}getPickingInfo(e){let n=e.info,{object:r}=n;return r&&(n.object={contour:r.contour}),n}};mT.layerName=\"ContourLayer\";mT.defaultProps=I5e;var yR=mT;var _ae=`#version 300 es\n#define SHADER_NAME grid-cell-layer-vertex-shader\nin vec3 positions;\nin vec3 normals;\nin vec2 instancePositions;\nin float instanceElevationValues;\nin float instanceColorValues;\nin vec3 instancePickingColors;\nuniform sampler2D colorRange;\nout vec4 vColor;\nfloat interp(float value, vec2 domain, vec2 range) {\nfloat r = min(max((value - domain.x) / (domain.y - domain.x), 0.), 1.);\nreturn mix(range.x, range.y, r);\n}\nvec4 interp(float value, vec2 domain, sampler2D range) {\nfloat r = (value - domain.x) / (domain.y - domain.x);\nreturn texture(range, vec2(r, 0.5));\n}\nvoid main(void) {\ngeometry.pickingColor = instancePickingColors;\nif (isnan(instanceColorValues) ||\ninstanceColorValues < grid.colorDomain.z ||\ninstanceColorValues > grid.colorDomain.w ||\ninstanceElevationValues < grid.elevationDomain.z ||\ninstanceElevationValues > grid.elevationDomain.w\n) {\ngl_Position = vec4(0.);\nreturn;\n}\nvec2 commonPosition = (instancePositions + (positions.xy + 1.0) / 2.0 * column.coverage) * grid.sizeCommon + grid.originCommon - project.commonOrigin.xy;\ngeometry.position = vec4(commonPosition, 0.0, 1.0);\ngeometry.normal = project_normal(normals);\nfloat elevation = 0.0;\nif (column.extruded) {\nelevation = interp(instanceElevationValues, grid.elevationDomain.xy, grid.elevationRange);\nelevation = project_size(elevation);\ngeometry.position.z = (positions.z + 1.0) / 2.0 * elevation;\n}\ngl_Position = project_common_position_to_clipspace(geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvColor = interp(instanceColorValues, grid.colorDomain.xy, colorRange);\nvColor.a *= layer.opacity;\nif (column.extruded) {\nvColor.rgb = lighting_getLightColor(vColor.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n`;var P5e=`uniform gridUniforms {\n  vec4 colorDomain;\n  vec4 elevationDomain;\n  vec2 elevationRange;\n  vec2 originCommon;\n  vec2 sizeCommon;\n} grid;\n`,yae={name:\"grid\",vs:P5e,uniformTypes:{colorDomain:\"vec4<f32>\",elevationDomain:\"vec4<f32>\",elevationRange:\"vec2<f32>\",originCommon:\"vec2<f32>\",sizeCommon:\"vec2<f32>\"}};var _T=class extends $u{getShaders(){let e=super.getShaders();return e.modules.push(yae),{...e,vs:_ae}}initializeState(){super.initializeState();let e=this.getAttributeManager();e.remove([\"instanceElevations\",\"instanceFillColors\",\"instanceLineColors\",\"instanceStrokeWidths\"]),e.addInstanced({instancePositions:{size:2,type:\"float32\",accessor:\"getBin\"},instanceColorValues:{size:1,type:\"float32\",accessor:\"getColorValue\"},instanceElevationValues:{size:1,type:\"float32\",accessor:\"getElevationValue\"}})}updateState(e){super.updateState(e);let{props:n,oldProps:r}=e,i=this.state.fillModel;if(r.colorRange!==n.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=V2(this.context.device,n.colorRange,n.colorScaleType);let o={colorRange:this.state.colorTexture};i.shaderInputs.setProps({grid:o})}else r.colorScaleType!==n.colorScaleType&&U2(this.state.colorTexture,n.colorScaleType)}finalizeState(e){super.finalizeState(e),this.state.colorTexture?.destroy()}_updateGeometry(){let e=new Zm;this.state.fillModel.setGeometry(e)}draw({uniforms:e}){let{cellOriginCommon:n,cellSizeCommon:r,elevationRange:i,elevationScale:o,extruded:s,coverage:c,colorDomain:d,elevationDomain:m}=this.props,b=this.props.colorCutoff||[-1/0,1/0],C=this.props.elevationCutoff||[-1/0,1/0],B=this.state.fillModel,k={colorDomain:[Math.max(d[0],b[0]),Math.min(d[1],b[1]),Math.max(d[0]-1,b[0]),Math.min(d[1]+1,b[1])],elevationDomain:[Math.max(m[0],C[0]),Math.min(m[1],C[1]),Math.max(m[0]-1,C[0]),Math.min(m[1]+1,C[1])],elevationRange:[i[0]*o,i[1]*o],originCommon:n,sizeCommon:r};B.shaderInputs.setProps({column:{extruded:s,coverage:c},grid:k}),B.draw(this.context.renderPass)}};_T.layerName=\"GridCellLayer\";var R5e=`uniform binOptionsUniforms {\n  vec2 cellOriginCommon;\n  vec2 cellSizeCommon;\n} binOptions;\n`,xae={name:\"binOptions\",vs:R5e,uniformTypes:{cellOriginCommon:\"vec2<f32>\",cellSizeCommon:\"vec2<f32>\"}};function vae(){}var B5e={gpuAggregation:!0,colorDomain:null,colorRange:ng,getColorValue:{type:\"accessor\",value:null},getColorWeight:{type:\"accessor\",value:1},colorAggregation:\"SUM\",lowerPercentile:{type:\"number\",min:0,max:100,value:0},upperPercentile:{type:\"number\",min:0,max:100,value:100},colorScaleType:\"quantize\",onSetColorDomain:vae,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:\"accessor\",value:null},getElevationWeight:{type:\"accessor\",value:1},elevationAggregation:\"SUM\",elevationScale:{type:\"number\",min:0,value:1},elevationLowerPercentile:{type:\"number\",min:0,max:100,value:0},elevationUpperPercentile:{type:\"number\",min:0,max:100,value:100},elevationScaleType:\"linear\",onSetElevationDomain:vae,cellSize:{type:\"number\",min:0,value:1e3},coverage:{type:\"number\",min:0,max:1,value:1},getPosition:{type:\"accessor\",value:t=>t.position},gridAggregator:{type:\"function\",optional:!0,value:null},extruded:!1,material:!0},yT=class extends tg{getAggregatorType(){let{gpuAggregation:e,gridAggregator:n,getColorValue:r,getElevationValue:i}=this.props;return e&&(n||r||i)?(hn.warn(\"Features not supported by GPU aggregation, falling back to CPU\")(),\"cpu\"):e&&js.isSupported(this.context.device)?\"gpu\":\"cpu\"}createAggregator(e){if(e===\"cpu\"){let{gridAggregator:n,cellSize:r}=this.props;return new Cc({dimensions:2,getBin:{sources:[\"positions\"],getValue:({positions:i},o,s)=>{if(n)return n(i,r);let d=this.state.aggregatorViewport.projectPosition(i),{cellSizeCommon:m,cellOriginCommon:b}=s;return[Math.floor((d[0]-b[0])/m[0]),Math.floor((d[1]-b[1])/m[1])]}},getValue:[{sources:[\"colorWeights\"],getValue:({colorWeights:i})=>i},{sources:[\"elevationWeights\"],getValue:({elevationWeights:i})=>i}]})}return new js(this.context.device,{dimensions:2,channelCount:2,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[Lr,xae],vs:`\n  in vec3 positions;\n  in vec3 positions64Low;\n  in float colorWeights;\n  in float elevationWeights;\n\n  void getBin(out ivec2 binId) {\n    vec3 positionCommon = project_position(positions, positions64Low);\n    vec2 gridCoords = floor(positionCommon.xy / binOptions.cellSizeCommon);\n    binId = ivec2(gridCoords);\n  }\n  void getValue(out vec2 value) {\n    value = vec2(colorWeights, elevationWeights);\n  }\n  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:\"getPosition\",type:\"float64\",fp64:this.use64bitPositions()},colorWeights:{size:1,accessor:\"getColorWeight\"},elevationWeights:{size:1,accessor:\"getElevationWeight\"}})}updateState(e){let n=super.updateState(e),{props:r,oldProps:i,changeFlags:o}=e,{aggregator:s}=this.state;if((o.dataChanged||!this.state.dataAsArray)&&(r.getColorValue||r.getElevationValue)&&(this.state.dataAsArray=Array.from(ys(r.data).iterable)),n||o.dataChanged||r.cellSize!==i.cellSize||r.getColorValue!==i.getColorValue||r.getElevationValue!==i.getElevationValue||r.colorAggregation!==i.colorAggregation||r.elevationAggregation!==i.elevationAggregation){this._updateBinOptions();let{cellSizeCommon:c,cellOriginCommon:d,binIdRange:m,dataAsArray:b}=this.state;if(s.setProps({binIdRange:m,pointCount:this.getNumInstances(),operations:[r.colorAggregation,r.elevationAggregation],binOptions:{cellSizeCommon:c,cellOriginCommon:d},onUpdate:this._onAggregationUpdate.bind(this)}),b){let{getColorValue:C,getElevationValue:B}=this.props;s.setProps({customOperations:[C&&(k=>C(k.map(V=>b[V]),{indices:k,data:r.data})),B&&(k=>B(k.map(V=>b[V]),{indices:k,data:r.data}))]})}}return o.updateTriggersChanged&&o.updateTriggersChanged.getColorValue&&s.setNeedsUpdate(0),o.updateTriggersChanged&&o.updateTriggersChanged.getElevationValue&&s.setNeedsUpdate(1),n}_updateBinOptions(){let e=this.getBounds(),n=[1,1],r=[0,0],i=[[0,1],[0,1]],o=this.context.viewport;if(e&&Number.isFinite(e[0][0])){let s=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2],{cellSize:c}=this.props,{unitsPerMeter:d}=o.getDistanceScales(s);n[0]=d[0]*c,n[1]=d[1]*c;let m=o.projectFlat(s);r=[Math.floor(m[0]/n[0])*n[0],Math.floor(m[1]/n[1])*n[1]],s=o.unprojectFlat(r);let b=o.constructor;o=o.isGeospatial?new b({longitude:s[0],latitude:s[1],zoom:12}):new su({position:[s[0],s[1],0],zoom:12}),r=[Math.fround(o.center[0]),Math.fround(o.center[1])],i=G2({dataBounds:e,getBinId:C=>{let B=o.projectFlat(C);return[Math.floor((B[0]-r[0])/n[0]),Math.floor((B[1]-r[1])/n[1])]}})}this.setState({cellSizeCommon:n,cellOriginCommon:r,binIdRange:i,aggregatorViewport:o})}draw(e){e.shaderModuleProps.project&&(e.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(e)}_onAggregationUpdate({channel:e}){let n=this.getCurrentLayer().props,{aggregator:r}=this.state;if(e===0){let i=r.getResult(0);this.setState({colors:new rg(i,r.binCount)}),n.onSetColorDomain(r.getResultDomain(0))}else if(e===1){let i=r.getResult(1);this.setState({elevations:new rg(i,r.binCount)}),n.onSetElevationDomain(r.getResultDomain(1))}}onAttributeChange(e){let{aggregator:n}=this.state;switch(e){case\"positions\":n.setNeedsUpdate(),this._updateBinOptions();let{cellSizeCommon:r,cellOriginCommon:i,binIdRange:o}=this.state;n.setProps({binIdRange:o,binOptions:{cellSizeCommon:r,cellOriginCommon:i}});break;case\"colorWeights\":n.setNeedsUpdate(0);break;case\"elevationWeights\":n.setNeedsUpdate(1);break;default:}}renderLayers(){let{aggregator:e,cellOriginCommon:n,cellSizeCommon:r}=this.state,{elevationScale:i,colorRange:o,elevationRange:s,extruded:c,coverage:d,material:m,transitions:b,colorScaleType:C,lowerPercentile:B,upperPercentile:k,colorDomain:V,elevationScaleType:q,elevationLowerPercentile:K,elevationUpperPercentile:Y,elevationDomain:ee}=this.props,J=this.getSubLayerClass(\"cells\",_T),se=e.getBins(),xe=this.state.colors?.update({scaleType:C,lowerPercentile:B,upperPercentile:k}),Ee=this.state.elevations?.update({scaleType:q,lowerPercentile:K,upperPercentile:Y});return!xe||!Ee?null:new J(this.getSubLayerProps({id:\"cells\"}),{data:{length:e.binCount,attributes:{getBin:se,getColorValue:xe.attribute,getElevationValue:Ee.attribute}},dataComparator:(Xe,Ne)=>Xe.length===Ne.length,updateTriggers:{getBin:[se],getColorValue:[xe.attribute],getElevationValue:[Ee.attribute]},cellOriginCommon:n,cellSizeCommon:r,elevationScale:i,colorRange:o,colorScaleType:C,elevationRange:s,extruded:c,coverage:d,material:m,colorDomain:xe.domain||V||e.getResultDomain(0),elevationDomain:Ee.domain||ee||e.getResultDomain(1),colorCutoff:xe.cutoff,elevationCutoff:Ee.cutoff,transitions:b&&{getFillColor:b.getColorValue||b.getColorWeight,getElevation:b.getElevationValue||b.getElevationWeight},extensions:[]})}getPickingInfo(e){let n=e.info,{index:r}=n;if(r>=0){let i=this.state.aggregator.getBin(r),o;i&&(o={col:i.id[0],row:i.id[1],colorValue:i.value[0],elevationValue:i.value[1],count:i.count},i.pointIndices&&(o.pointIndices=i.pointIndices,o.points=Array.isArray(this.props.data)?i.pointIndices.map(s=>this.props.data[s]):[])),n.object=o}return n}};yT.layerName=\"GridLayer\";yT.defaultProps=B5e;var xR=yT;function wae(t){let e=t.map(c=>c[0]),n=t.map(c=>c[1]),r=Math.min.apply(null,e),i=Math.max.apply(null,e),o=Math.min.apply(null,n),s=Math.max.apply(null,n);return[r,o,i,s]}function Tae(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}var bae=new Float32Array(12);function n9(t,e=2){let n=0;for(let r of t)for(let i=0;i<e;i++)bae[n++]=r[i]||0;return bae}function Eae(t,e,n){let[r,i,o,s]=t,c=o-r,d=s-i,m=c,b=d;c/d<e/n?m=e/n*d:b=n/e*c,m<e&&(m=e,b=n);let C=(o+r)/2,B=(s+i)/2;return[C-m/2,B-b/2,C+m/2,B+b/2]}function Sae(t,e){let[n,r,i,o]=e;return[(t[0]-n)/(i-n),(t[1]-r)/(o-r)]}var Cae=`#version 300 es\n#define SHADER_NAME heatp-map-layer-vertex-shader\nuniform sampler2D maxTexture;\nin vec3 positions;\nin vec2 texCoords;\nout vec2 vTexCoords;\nout float vIntensityMin;\nout float vIntensityMax;\nvoid main(void) {\ngl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));\nvTexCoords = texCoords;\nvec4 maxTexture = texture(maxTexture, vec2(0.5));\nfloat maxValue = triangle.aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;\nfloat minValue = maxValue * triangle.threshold;\nif (triangle.colorDomain[1] > 0.) {\nmaxValue = triangle.colorDomain[1];\nminValue = triangle.colorDomain[0];\n}\nvIntensityMax = triangle.intensity / maxValue;\nvIntensityMin = triangle.intensity / minValue;\n}\n`;var Mae=`#version 300 es\n#define SHADER_NAME triangle-layer-fragment-shader\nprecision highp float;\nuniform sampler2D weightsTexture;\nuniform sampler2D colorTexture;\nin vec2 vTexCoords;\nin float vIntensityMin;\nin float vIntensityMax;\nout vec4 fragColor;\nvec4 getLinearColor(float value) {\nfloat factor = clamp(value * vIntensityMax, 0., 1.);\nvec4 color = texture(colorTexture, vec2(factor, 0.5));\ncolor.a *= min(value * vIntensityMin, 1.0);\nreturn color;\n}\nvoid main(void) {\nvec4 weights = texture(weightsTexture, vTexCoords);\nfloat weight = weights.r;\nif (triangle.aggregationMode > 0.5) {\nweight /= max(1.0, weights.a);\n}\nif (weight <= 0.) {\ndiscard;\n}\nvec4 linearColor = getLinearColor(weight);\nlinearColor.a *= layer.opacity;\nfragColor = linearColor;\n}\n`;var Iae=`uniform triangleUniforms {\n  float aggregationMode;\n  vec2 colorDomain;\n  float intensity;\n  float threshold;\n} triangle;\n`,Pae={name:\"triangle\",vs:Iae,fs:Iae,uniformTypes:{aggregationMode:\"f32\",colorDomain:\"vec2<f32>\",intensity:\"f32\",threshold:\"f32\"}};var vR=class extends hi{getShaders(){return super.getShaders({vs:Cae,fs:Mae,modules:[Lr,Pae]})}initializeState({device:e}){this.setState({model:this._getModel(e)})}_getModel(e){let{vertexCount:n,data:r}=this.props;return new gr(e,{...this.getShaders(),id:this.props.id,attributes:r.attributes,bufferLayout:[{name:\"positions\",format:\"float32x3\"},{name:\"texCoords\",format:\"float32x2\"}],topology:\"triangle-strip\",vertexCount:n})}draw(){let{model:e}=this.state,{aggregationMode:n,colorDomain:r,intensity:i,threshold:o,colorTexture:s,maxTexture:c,weightsTexture:d}=this.props,m={aggregationMode:n,colorDomain:r,intensity:i,threshold:o,colorTexture:s,maxTexture:c,weightsTexture:d};e.shaderInputs.setProps({triangle:m}),e.draw(this.context.renderPass)}};vR.layerName=\"TriangleLayer\";var Rae=vR;function Bae(t,e){let n={};for(let r in t)e.includes(r)||(n[r]=t[r]);return n}var bR=class extends xs{initializeAggregationLayer(e){super.initializeState(this.context),this.setState({ignoreProps:Bae(this.constructor._propTypes,e.data.props),dimensions:e})}updateState(e){super.updateState(e);let{changeFlags:n}=e;if(n.extensionsChanged){let r=this.getShaders({});r&&r.defines&&(r.defines.NON_INSTANCED_MODEL=1),this.updateShaders(r)}this._updateAttributes()}updateAttributes(e){this.setState({changedAttributes:e})}getAttributes(){return this.getAttributeManager().getAttributes()}getModuleSettings(){let{viewport:e,mousePosition:n,device:r}=this.context;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:n,picking:{isActive:0},devicePixelRatio:r.canvasContext.cssToDeviceRatio()})}updateShaders(e){}isAggregationDirty(e,n={}){let{props:r,oldProps:i,changeFlags:o}=e,{compareAll:s=!1,dimension:c}=n,{ignoreProps:d}=this.state,{props:m,accessors:b=[]}=c,{updateTriggersChanged:C}=o;if(o.dataChanged)return!0;if(C){if(C.all)return!0;for(let B of b)if(C[B])return!0}if(s)return o.extensionsChanged?!0:Gw({oldProps:i,newProps:r,ignoreProps:d,propTypes:this.constructor._propTypes});for(let B of m)if(r[B]!==i[B])return!0;return!1}isAttributeChanged(e){let{changedAttributes:n}=this.state;return e?n&&n[e]!==void 0:!D5e(n)}_getAttributeManager(){return new Ju(this.context.device,{id:this.props.id,stats:this.context.stats})}};bR.layerName=\"AggregationLayer\";var Dae=bR;function D5e(t){let e=!0;for(let n in t){e=!1;break}return e}var wR=`#version 300 es\nin vec3 positions;\nin vec3 positions64Low;\nin float weights;\nout vec4 weightsTexture;\nvoid main()\n{\nweightsTexture = vec4(weights * weight.weightsScale, 0., 0., 1.);\nfloat radiusTexels = project_pixel_size(weight.radiusPixels) * weight.textureWidth / (weight.commonBounds.z - weight.commonBounds.x);\ngl_PointSize = radiusTexels * 2.;\nvec3 commonPosition = project_position(positions, positions64Low);\ngl_Position.xy = (commonPosition.xy - weight.commonBounds.xy) / (weight.commonBounds.zw - weight.commonBounds.xy) ;\ngl_Position.xy = (gl_Position.xy * 2.) - (1.);\ngl_Position.w = 1.0;\n}\n`;var TR=`#version 300 es\nin vec4 weightsTexture;\nout vec4 fragColor;\nfloat gaussianKDE(float u){\nreturn pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);\n}\nvoid main()\n{\nfloat dist = length(gl_PointCoord - vec2(0.5, 0.5));\nif (dist > 0.5) {\ndiscard;\n}\nfragColor = weightsTexture * gaussianKDE(2. * dist);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n`;var Lae=`#version 300 es\nuniform sampler2D inTexture;\nout vec4 outTexture;\nvoid main()\n{\nint yIndex = gl_VertexID / int(maxWeight.textureSize);\nint xIndex = gl_VertexID - (yIndex * int(maxWeight.textureSize));\nvec2 uv = (0.5 + vec2(float(xIndex), float(yIndex))) / maxWeight.textureSize;\noutTexture = texture(inTexture, uv);\ngl_Position = vec4(0.0, 0.0, 0.0, 1.0);\ngl_PointSize = 1.0;\n}\n`;var Oae=`#version 300 es\nin vec4 outTexture;\nout vec4 fragColor;\nvoid main() {\nfragColor = outTexture;\nfragColor.g = outTexture.r / max(1.0, outTexture.a);\n}\n`;var L5e=`uniform weightUniforms {\n  vec4 commonBounds;\n  float radiusPixels;\n  float textureWidth;\n  float weightsScale;\n} weight;\n`,Fae={name:\"weight\",vs:L5e,uniformTypes:{commonBounds:\"vec4<f32>\",radiusPixels:\"f32\",textureWidth:\"f32\",weightsScale:\"f32\"}},kae={name:\"maxWeight\",vs:`uniform maxWeightUniforms {\n  float textureSize;\n} maxWeight;\n`,uniformTypes:{textureSize:\"f32\"}};var O5e=2,r9={format:\"rgba8unorm\",dimension:\"2d\",width:1,height:1,sampler:{minFilter:\"linear\",magFilter:\"linear\",addressModeU:\"clamp-to-edge\",addressModeV:\"clamp-to-edge\"}},Nae=[0,0],F5e={SUM:0,MEAN:1},k5e={getPosition:{type:\"accessor\",value:t=>t.position},getWeight:{type:\"accessor\",value:1},intensity:{type:\"number\",min:0,value:1},radiusPixels:{type:\"number\",min:1,max:100,value:50},colorRange:ng,threshold:{type:\"number\",min:0,max:1,value:.05},colorDomain:{type:\"array\",value:null,optional:!0},aggregation:\"SUM\",weightsTextureSize:{type:\"number\",min:128,max:2048,value:2048},debounceTimeout:{type:\"number\",min:0,max:1e3,value:500}},N5e=[\"float32-renderable-webgl\",\"texture-blend-float-webgl\"],z5e={data:{props:[\"radiusPixels\"]}},xT=class extends Dae{getShaders(e){let n=[Lr];return e.modules&&(n=[...n,...e.modules]),super.getShaders({...e,modules:n})}initializeState(){super.initializeAggregationLayer(z5e),this.setState({colorDomain:Nae}),this._setupTextureParams(),this._setupAttributes(),this._setupResources()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){super.updateState(e),this._updateHeatmapState(e)}_updateHeatmapState(e){let{props:n,oldProps:r}=e,i=this._getChangeFlags(e);if((i.dataChanged||i.viewportChanged)&&(i.boundsChanged=this._updateBounds(i.dataChanged),this._updateTextureRenderingBounds()),i.dataChanged||i.boundsChanged){if(clearTimeout(this.state.updateTimer),this.setState({isWeightMapDirty:!0}),i.dataChanged){let o=this.getShaders({vs:wR,fs:TR});this._createWeightsTransform(o)}}else i.viewportZoomChanged&&this._debouncedUpdateWeightmap();n.colorRange!==r.colorRange&&this._updateColorTexture(e),this.state.isWeightMapDirty&&this._updateWeightmap(),this.setState({zoom:e.context.viewport.zoom})}renderLayers(){let{weightsTexture:e,triPositionBuffer:n,triTexCoordBuffer:r,maxWeightsTexture:i,colorTexture:o,colorDomain:s}=this.state,{updateTriggers:c,intensity:d,threshold:m,aggregation:b}=this.props,C=this.getSubLayerClass(\"triangle\",Rae);return new C(this.getSubLayerProps({id:\"triangle-layer\",updateTriggers:c}),{coordinateSystem:Cn.DEFAULT,data:{attributes:{positions:n,texCoords:r}},vertexCount:4,maxTexture:i,colorTexture:o,aggregationMode:F5e[b]||0,weightsTexture:e,intensity:d,threshold:m,colorDomain:s})}finalizeState(e){super.finalizeState(e);let{weightsTransform:n,weightsTexture:r,maxWeightTransform:i,maxWeightsTexture:o,triPositionBuffer:s,triTexCoordBuffer:c,colorTexture:d,updateTimer:m}=this.state;n?.destroy(),r?.destroy(),i?.destroy(),o?.destroy(),s?.destroy(),c?.destroy(),d?.destroy(),m&&clearTimeout(m)}_getAttributeManager(){return new Ju(this.context.device,{id:this.props.id,stats:this.context.stats})}_getChangeFlags(e){let n={},{dimensions:r}=this.state;n.dataChanged=this.isAttributeChanged()&&\"attribute changed\"||this.isAggregationDirty(e,{compareAll:!0,dimension:r.data})&&\"aggregation is dirty\",n.viewportChanged=e.changeFlags.viewportChanged;let{zoom:i}=this.state;return(!e.context.viewport||e.context.viewport.zoom!==i)&&(n.viewportZoomChanged=!0),n}_createTextures(){let{textureSize:e,format:n}=this.state;this.setState({weightsTexture:this.context.device.createTexture({...r9,width:e,height:e,format:n}),maxWeightsTexture:this.context.device.createTexture({...r9,width:1,height:1,format:n})})}_setupAttributes(){this.getAttributeManager().add({positions:{size:3,type:\"float64\",accessor:\"getPosition\"},weights:{size:1,accessor:\"getWeight\"}}),this.setState({positionAttributeName:\"positions\"})}_setupTextureParams(){let{device:e}=this.context,{weightsTextureSize:n}=this.props,r=Math.min(n,e.limits.maxTextureDimension2D),i=N5e.every(c=>e.features.has(c)),o=i?\"rgba32float\":\"rgba8unorm\",s=i?1:1/255;this.setState({textureSize:r,format:o,weightsScale:s}),i||hn.warn(`HeatmapLayer: ${this.id} rendering to float texture not supported, falling back to low precision format`)()}_createWeightsTransform(e){let{weightsTransform:n}=this.state,{weightsTexture:r}=this.state,i=this.getAttributeManager();n?.destroy(),n=new Wy(this.context.device,{id:`${this.id}-weights-transform`,bufferLayout:i.getBufferLayouts(),vertexCount:1,targetTexture:r,parameters:{depthWriteEnabled:!1,blendColorOperation:\"add\",blendColorSrcFactor:\"one\",blendColorDstFactor:\"one\",blendAlphaSrcFactor:\"one\",blendAlphaDstFactor:\"one\"},topology:\"point-list\",...e,modules:[...e.modules,Fae]}),this.setState({weightsTransform:n})}_setupResources(){this._createTextures();let{device:e}=this.context,{textureSize:n,weightsTexture:r,maxWeightsTexture:i}=this.state,o=this.getShaders({vs:wR,fs:TR});this._createWeightsTransform(o);let s=this.getShaders({vs:Lae,fs:Oae,modules:[kae]}),c=new Wy(e,{id:`${this.id}-max-weights-transform`,targetTexture:i,...s,vertexCount:n*n,topology:\"point-list\",parameters:{depthWriteEnabled:!1,blendColorOperation:\"max\",blendAlphaOperation:\"max\",blendColorSrcFactor:\"one\",blendColorDstFactor:\"one\",blendAlphaSrcFactor:\"one\",blendAlphaDstFactor:\"one\"}}),d={inTexture:r,textureSize:n};c.model.shaderInputs.setProps({maxWeight:d}),this.setState({weightsTexture:r,maxWeightsTexture:i,maxWeightTransform:c,zoom:null,triPositionBuffer:e.createBuffer({byteLength:48}),triTexCoordBuffer:e.createBuffer({byteLength:48})})}updateShaders(e){this._createWeightsTransform({vs:wR,fs:TR,...e})}_updateMaxWeightValue(){let{maxWeightTransform:e}=this.state;e.run({parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]})}_updateBounds(e=!1){let{viewport:n}=this.context,r=[n.unproject([0,0]),n.unproject([n.width,0]),n.unproject([0,n.height]),n.unproject([n.width,n.height])].map(c=>c.map(Math.fround)),i=wae(r),o={visibleWorldBounds:i,viewportCorners:r},s=!1;if(e||!this.state.worldBounds||!Tae(this.state.worldBounds,i)){let c=this._worldToCommonBounds(i),d=this._commonToWorldBounds(c);this.props.coordinateSystem===Cn.LNGLAT&&(d[1]=Math.max(d[1],-85.051129),d[3]=Math.min(d[3],85.051129),d[0]=Math.max(d[0],-360),d[2]=Math.min(d[2],360));let m=this._worldToCommonBounds(d);o.worldBounds=d,o.normalizedCommonBounds=m,s=!0}return this.setState(o),s}_updateTextureRenderingBounds(){let{triPositionBuffer:e,triTexCoordBuffer:n,normalizedCommonBounds:r,viewportCorners:i}=this.state,{viewport:o}=this.context;e.write(n9(i,3));let s=i.map(c=>Sae(o.projectPosition(c),r));n.write(n9(s,2))}_updateColorTexture(e){let{colorRange:n}=e.props,{colorTexture:r}=this.state,i=e9(n,!1,Uint8Array);r?.destroy(),r=this.context.device.createTexture({...r9,data:i,width:n.length,height:1}),this.setState({colorTexture:r})}_updateWeightmap(){let{radiusPixels:e,colorDomain:n,aggregation:r}=this.props,{worldBounds:i,textureSize:o,weightsScale:s,weightsTexture:c}=this.state,d=this.state.weightsTransform;this.state.isWeightMapDirty=!1;let m=this._worldToCommonBounds(i,{useLayerCoordinateSystem:!0});if(n&&r===\"SUM\"){let{viewport:J}=this.context,se=J.distanceScales.metersPerUnit[2]*(m[2]-m[0])/o;this.state.colorDomain=n.map(xe=>xe*se*s)}else this.state.colorDomain=n||Nae;let C=this.getAttributeManager().getAttributes(),B=this.getModuleSettings();this._setModelAttributes(d.model,C),d.model.setVertexCount(this.getNumInstances());let k={radiusPixels:e,commonBounds:m,textureWidth:o,weightsScale:s,weightsTexture:c},{viewport:V,devicePixelRatio:q,coordinateSystem:K,coordinateOrigin:Y}=B,{modelMatrix:ee}=this.props;d.model.shaderInputs.setProps({project:{viewport:V,devicePixelRatio:q,modelMatrix:ee,coordinateSystem:K,coordinateOrigin:Y},weight:k}),d.run({parameters:{viewport:[0,0,o,o]},clearColor:[0,0,0,0]}),this._updateMaxWeightValue()}_debouncedUpdateWeightmap(e=!1){let{updateTimer:n}=this.state,{debounceTimeout:r}=this.props;e?(n=null,this._updateBounds(!0),this._updateTextureRenderingBounds(),this.setState({isWeightMapDirty:!0})):(this.setState({isWeightMapDirty:!1}),clearTimeout(n),n=setTimeout(this._debouncedUpdateWeightmap.bind(this,!0),r)),this.setState({updateTimer:n})}_worldToCommonBounds(e,n={}){let{useLayerCoordinateSystem:r=!1}=n,[i,o,s,c]=e,{viewport:d}=this.context,{textureSize:m}=this.state,{coordinateSystem:b}=this.props,C=r&&(b===Cn.LNGLAT_OFFSETS||b===Cn.METER_OFFSETS),B=C?d.projectPosition(this.props.coordinateOrigin):[0,0],k=m*O5e/d.scale,V,q;return r&&!C?(V=this.projectPosition([i,o,0]),q=this.projectPosition([s,c,0])):(V=d.projectPosition([i,o,0]),q=d.projectPosition([s,c,0])),Eae([V[0]-B[0],V[1]-B[1],q[0]-B[0],q[1]-B[1]],k,k)}_commonToWorldBounds(e){let[n,r,i,o]=e,{viewport:s}=this.context,c=s.unprojectPosition([n,r]),d=s.unprojectPosition([i,o]);return c.slice(0,2).concat(d.slice(0,2))}};xT.layerName=\"HeatmapLayer\";xT.defaultProps=k5e;var ER=xT;var Ts=xr(Jr()),Lue=xr(Jg()),Oue=xr(Tue()),dh=xr(Bue()),vLe=typeof globalThis<\"u\"?globalThis:typeof window<\"u\"?window:typeof global<\"u\"?global:typeof self<\"u\"?self:{};function Fue(t,e){return t(e={exports:{}},e.exports),e.exports}var bLe=Fue((function(t){(function(e){var n=function(K,Y,ee){if(!d(Y)||b(Y)||C(Y)||B(Y)||c(Y))return Y;var J,se=0,xe=0;if(m(Y))for(J=[],xe=Y.length;se<xe;se++)J.push(n(K,Y[se],ee));else for(var Ee in J={},Y)Object.prototype.hasOwnProperty.call(Y,Ee)&&(J[K(Ee,ee)]=n(K,Y[Ee],ee));return J},r=function(K){return k(K)?K:(K=K.replace(/[\\-_\\s]+(.)?/g,(function(Y,ee){return ee?ee.toUpperCase():\"\"}))).substr(0,1).toLowerCase()+K.substr(1)},i=function(K){var Y=r(K);return Y.substr(0,1).toUpperCase()+Y.substr(1)},o=function(K,Y){return(function(ee,J){var se=(J=J||{}).separator||\"_\",xe=J.split||/(?=[A-Z])/;return ee.split(xe).join(se)})(K,Y).toLowerCase()},s=Object.prototype.toString,c=function(K){return typeof K==\"function\"},d=function(K){return K===Object(K)},m=function(K){return s.call(K)==\"[object Array]\"},b=function(K){return s.call(K)==\"[object Date]\"},C=function(K){return s.call(K)==\"[object RegExp]\"},B=function(K){return s.call(K)==\"[object Boolean]\"},k=function(K){return(K-=0)==K},V=function(K,Y){var ee=Y&&\"process\"in Y?Y.process:Y;return typeof ee!=\"function\"?K:function(J,se){return ee(J,K,se)}},q={camelize:r,decamelize:o,pascalize:i,depascalize:o,camelizeKeys:function(K,Y){return n(V(r,Y),K)},decamelizeKeys:function(K,Y){return n(V(o,Y),K,Y)},pascalizeKeys:function(K,Y){return n(V(i,Y),K)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};t.exports?t.exports=q:e.humps=q})(vLe)})).decamelize,wLe=function(t){if(Array.isArray(t))return t},TLe=function(t,e){if(typeof Symbol<\"u\"&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,c=t[Symbol.iterator]();!(r=(s=c.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(d){i=!0,o=d}finally{try{r||c.return==null||c.return()}finally{if(i)throw o}}return n}},Due=function(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},ELe=function(t,e){if(t){if(typeof t==\"string\")return Due(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n===\"Object\"&&t.constructor&&(n=t.constructor.name),n===\"Map\"||n===\"Set\"?Array.from(t):n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Due(t,e):void 0}},SLe=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},CLe=function(t,e){return wLe(t)||TLe(t,e)||ELe(t,e)||SLe()},kue=Fue((function(t){function e(){return t.exports=e=Object.assign||function(n){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},e.apply(this,arguments)}t.exports=e})),MLe=function(t,e){if(t==null)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i},Nue=function(t,e){if(t==null)return{};var n,r,i=MLe(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i},ILe=(0,Ts.createContext)(null);function zue(t){var e=t.children,n=e===void 0?\"\":e,r=Nue(t,[\"children\"]);return typeof n!=\"string\"&&(n=(0,Oue.renderToString)(n)),Ts.default.createElement(\"template\",kue({},r,{dangerouslySetInnerHTML:{__html:n}}))}function Uue(t){var e=t.root,n=t.children;return(0,Lue.createPortal)(n===void 0?null:n,e)}function PLe(t){var e=(0,Ts.forwardRef)((function(n,r){var i,o,s=n.mode,c=s===void 0?\"open\":s,d=n.delegatesFocus,m=d!==void 0&&d,b=n.styleSheets,C=b===void 0?[]:b,B=n.ssr,k=B!==void 0&&B,V=n.children,q=Nue(n,[\"mode\",\"delegatesFocus\",\"styleSheets\",\"ssr\",\"children\"]),K=(o=(0,Ts.useRef)((i=r)&&i.current),(0,Ts.useEffect)((function(){i&&(i.current=o.current)}),[i]),o),Y=(0,Ts.useState)(null),ee=CLe(Y,2),J=ee[0],se=ee[1],xe=\"node_\".concat(c).concat(m);return(0,Ts.useLayoutEffect)((function(){if(K.current)try{if(typeof r==\"function\"&&r(K.current),k){var Ee=K.current.shadowRoot;return void se(Ee)}var Xe=K.current.attachShadow({mode:c,delegatesFocus:m});C.length>0&&(Xe.adoptedStyleSheets=C),se(Xe)}catch(Ne){(function(be){var ge=be.error,Qe=be.styleSheets,Ct=be.root;switch(ge.name){case\"NotSupportedError\":Qe.length>0&&(Ct.adoptedStyleSheets=Qe);break;default:throw ge}})({error:Ne,styleSheets:C,root:J})}}),[r,K,C]),Ts.default.createElement(Ts.default.Fragment,null,Ts.default.createElement(t.tag,kue({key:xe,ref:K},q),(J||k)&&Ts.default.createElement(ILe.Provider,{value:J},k?Ts.default.createElement(zue,{shadowroot:c,shadowrootmode:c},t.render({root:J,ssr:k,children:V})):Ts.default.createElement(Uue,{root:J},t.render({root:J,ssr:k,children:V})))))}));return e.propTypes={mode:dh.default.oneOf([\"open\",\"closed\"]),delegatesFocus:dh.default.bool,styleSheets:dh.default.arrayOf(dh.default.instanceOf(globalThis.CSSStyleSheet)),ssr:dh.default.bool,children:dh.default.node},e}zue.propTypes={children:dh.default.oneOfType([dh.default.string,dh.default.node])},Uue.propTypes={root:dh.default.object.isRequired,children:dh.default.node};var I7=new Map;function RLe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:\"core\",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(r){return r.children};return new Proxy(t,{get:function(r,i){var o=bLe(i,{separator:\"-\"}),s=\"\".concat(e,\"-\").concat(o);return I7.has(s)||I7.set(s,PLe({tag:o,render:n})),I7.get(s)}})}var BLe=RLe(),Vue=BLe;var rE=class t extends th{static{this.defaultProps={...th.defaultProps,tileSize:256,renderSubLayers:{type:\"function\",value:t._renderSubLayers}}}static _renderSubLayers(e){console.log(\"renderSubLayers = BitmapLayer\");let{bbox:{west:n,south:r,east:i,north:o}}=e.tile;return new e2(e,{data:void 0,image:e.data,bounds:[n,r,i,o]})}};function Gue(t,e){let n=Object.keys(e),r=Object.values(e);n.map((o,s)=>{n[s]=o.replace(/^[^a-zA-Z_$\\p{L}]/u,\"_\").replace(/[^\\w$\\p{L}\\p{N}]/gu,\"_\")});let i=new Function(...n,`return \\`${t}\\`;`)(...r);return typeof i!=\"string\"?null:(i=i.replace(/\\{([^}]+)\\}/g,(o,s)=>e?.[s]??\"\"),i)}var Hue=`.maplibregl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0,0,0,0)}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (forced-colors:active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (forced-colors:active){.maplibregl-ctrl-icon{background-color:transparent}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}@media (hover:hover){.maplibregl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}}.maplibregl-ctrl button:not(:disabled):active{background-color:rgba(0,0,0,.05)}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E\")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E\")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E\")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-globe .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='none' stroke='%23333' viewBox='0 0 22 22'%3E%3Ccircle cx='11' cy='11' r='8.5'/%3E%3Cpath d='M17.5 11c0 4.819-3.02 8.5-6.5 8.5S4.5 15.819 4.5 11 7.52 2.5 11 2.5s6.5 3.681 6.5 8.5Z'/%3E%3Cpath d='M13.5 11c0 2.447-.331 4.64-.853 6.206-.262.785-.562 1.384-.872 1.777-.314.399-.58.517-.775.517s-.461-.118-.775-.517c-.31-.393-.61-.992-.872-1.777C8.831 15.64 8.5 13.446 8.5 11s.331-4.64.853-6.206c.262-.785.562-1.384.872-1.777.314-.399.58-.517.775-.517s.461.118.775.517c.31.393.61.992.872 1.777.522 1.565.853 3.76.853 6.206Z'/%3E%3Cpath d='M11 7.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138q.07-.058.224-.138c.299-.151.763-.302 1.379-.434C7.378 5.666 9.091 5.5 11 5.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138q-.07.058-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428ZM4.486 6.436ZM11 16.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138 1.3 1.3 0 0 1 .224-.138c.299-.151.763-.302 1.379-.434C7.378 14.666 9.091 14.5 11 14.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138a1.3 1.3 0 0 1-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428Zm-6.514-1.064ZM11 12.5c-2.46 0-4.672-.222-6.255-.574-.796-.177-1.406-.38-1.805-.59a1.5 1.5 0 0 1-.39-.272.3.3 0 0 1-.047-.064.3.3 0 0 1 .048-.064c.066-.073.189-.167.389-.272.399-.21 1.009-.413 1.805-.59C6.328 9.722 8.54 9.5 11 9.5s4.672.222 6.256.574c.795.177 1.405.38 1.804.59.2.105.323.2.39.272a.3.3 0 0 1 .047.064.3.3 0 0 1-.048.064 1.4 1.4 0 0 1-.389.272c-.399.21-1.009.413-1.804.59-1.584.352-3.796.574-6.256.574Zm-8.501-1.51v.002zm0 .018v.002zm17.002.002v-.002zm0-.018v-.002z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-globe-enabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='none' stroke='%2333b5e5' viewBox='0 0 22 22'%3E%3Ccircle cx='11' cy='11' r='8.5'/%3E%3Cpath d='M17.5 11c0 4.819-3.02 8.5-6.5 8.5S4.5 15.819 4.5 11 7.52 2.5 11 2.5s6.5 3.681 6.5 8.5Z'/%3E%3Cpath d='M13.5 11c0 2.447-.331 4.64-.853 6.206-.262.785-.562 1.384-.872 1.777-.314.399-.58.517-.775.517s-.461-.118-.775-.517c-.31-.393-.61-.992-.872-1.777C8.831 15.64 8.5 13.446 8.5 11s.331-4.64.853-6.206c.262-.785.562-1.384.872-1.777.314-.399.58-.517.775-.517s.461.118.775.517c.31.393.61.992.872 1.777.522 1.565.853 3.76.853 6.206Z'/%3E%3Cpath d='M11 7.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138q.07-.058.224-.138c.299-.151.763-.302 1.379-.434C7.378 5.666 9.091 5.5 11 5.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138q-.07.058-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428ZM4.486 6.436ZM11 16.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138 1.3 1.3 0 0 1 .224-.138c.299-.151.763-.302 1.379-.434C7.378 14.666 9.091 14.5 11 14.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138a1.3 1.3 0 0 1-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428Zm-6.514-1.064ZM11 12.5c-2.46 0-4.672-.222-6.255-.574-.796-.177-1.406-.38-1.805-.59a1.5 1.5 0 0 1-.39-.272.3.3 0 0 1-.047-.064.3.3 0 0 1 .048-.064c.066-.073.189-.167.389-.272.399-.21 1.009-.413 1.805-.59C6.328 9.722 8.54 9.5 11 9.5s4.672.222 6.256.574c.795.177 1.405.38 1.804.59.2.105.323.2.39.272a.3.3 0 0 1 .047.064.3.3 0 0 1-.048.064 1.4 1.4 0 0 1-.389.272c-.399.21-1.009.413-1.804.59-1.584.352-3.796.574-6.256.574Zm-8.501-1.51v.002zm0 .018v.002zm17.002.002v-.002zm0-.018v-.002z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%23333' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%2333b5e5' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23aaa' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{animation:maplibregl-spin 2s linear infinite}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23999' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23666' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E\")}}@keyframes maplibregl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E\");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media (forced-colors:active){a.maplibregl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E\")}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:hsla(0,0%,100%,.5);margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;color:#000;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:hsla(0,0%,100%,.5);background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (forced-colors:active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23fff' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}@media screen and (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}.maplibregl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:hsla(0,0%,100%,.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px;white-space:nowrap}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;transition:opacity .2s;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{animation:maplibregl-user-location-dot-pulse 2s infinite;content:\"\";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.35);box-sizing:border-box;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:rgba(0,0,0,.4);color:#fff;display:flex;font-size:1.4em;inset:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media (hover:none),(pointer:coarse){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100%!important;left:0!important;position:fixed!important;top:0!important;width:100%!important;z-index:99999}`;var LLe={longitude:0,latitude:0,zoom:1},Wue={ArcLayer:iI,BitmapLayer:e2,BitmapTileLayer:rE,ColumnLayer:$u,ContourLayer:yR,GeoJsonLayer:Vp,GridCellLayer:fI,GridLayer:xR,H3ClusterLayer:HI,H3HexagonLayer:g2,HeatmapLayer:ER,HexagonLayer:pR,IconLayer:GA,LineLayer:oI,MVTLayer:QP,PathLayer:eh,PointCloudLayer:t2,PolygonLayer:ud,GeohashLayer:KP,QuadkeyLayer:DI,S2Layer:BI,ScatterplotLayer:n2,ScreenGridLayer:cR,SimpleMeshLayer:jp,SolidPolygonLayer:cd,TerrainLayer:GP,TextLayer:l2,TileLayer:th,Tile3DLayer:kP,TripsLayer:GI};function OLe(t){let{type:e,...n}=t,r=Object.entries(n).reduce((i,[o,s])=>(console.log(o,s),s===null?i:{...i,[o]:s}),{});if(r=$P(r,{}),console.log(\"type\",e,\"args\",r),e in Wue)return new Wue[e](r)}function FLe(){let[t]=mA(\"_initial_view_state\"),[e]=mA(\"_layers\"),[n]=mA(\"width\"),[r]=mA(\"height\"),[i]=mA(\"map_style\"),[o]=mA(\"_tooltip\"),[s,c]=(0,Ad.useState)([]),[d,m]=mA(\"click\");return(0,Ad.useEffect)(()=>{let b=e.map(C=>OLe(C));b.map(C=>{C.props.onClick&&(C.onClick=B=>{m(B.object)})}),c(b)},[e]),Ad.default.createElement(Vue.div,{style:{width:Number.isFinite(n)?`${n}px`:n,height:Number.isFinite(r)?`${r}px`:r,position:\"relative\"}},Ad.default.createElement(Kz,{initialViewState:[\"longitude\",\"latitude\",\"zoom\"].every(b=>Object.keys(t).includes(b))?t:LLe,getCursor:()=>\"default\",controller:!0,layers:s,style:{width:\"100%\",height:\"100%\"},getTooltip:({object:b})=>{if(!o||!b)return null;let C=o.html||o.text;return C?{html:Gue(C,{...b.properties||{},...b}),style:o.style}:null}},Ad.default.createElement(cC,{reuseMaps:!0,mapStyle:i||Uz.POSITRON,attributionControl:!1},Ad.default.createElement(SL,{compact:!0}))),Ad.default.createElement(\"style\",null,Hue))}var Hxt={render:RX(FLe)};export{Hxt as default};\n/*! Bundled license information:\n\nreact/cjs/react.production.js:\n  (**\n   * @license React\n   * react.production.js\n   *\n   * Copyright (c) Meta Platforms, Inc. and affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n\nscheduler/cjs/scheduler.production.js:\n  (**\n   * @license React\n   * scheduler.production.js\n   *\n   * Copyright (c) Meta Platforms, Inc. and affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n\nreact-dom/cjs/react-dom.production.js:\n  (**\n   * @license React\n   * react-dom.production.js\n   *\n   * Copyright (c) Meta Platforms, Inc. and affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n\nreact-dom/cjs/react-dom-client.production.js:\n  (**\n   * @license React\n   * react-dom-client.production.js\n   *\n   * Copyright (c) Meta Platforms, Inc. and affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n\nmaplibre-gl/dist/maplibre-gl.js:\n  (**\n   * MapLibre GL JS\n   * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.17.0/LICENSE.txt\n   *)\n\nlong/dist/long.js:\n  (**\n   * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>\n   * Released under the Apache License, Version 2.0\n   * see: https://github.com/dcodeIO/long.js for details\n   *)\n\nieee754/index.js:\n  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)\n\nreact-dom/cjs/react-dom-server-legacy.browser.production.js:\n  (**\n   * @license React\n   * react-dom-server-legacy.browser.production.js\n   *\n   * Copyright (c) Meta Platforms, Inc. and affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n\nreact-dom/cjs/react-dom-server.browser.production.js:\n  (**\n   * @license React\n   * react-dom-server.browser.production.js\n   *\n   * Copyright (c) Meta Platforms, Inc. and affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n\nlong/index.js:\n  (**\n   * @license\n   * Copyright 2009 The Closure Library Authors\n   * Copyright 2020 Daniel Wirtz / The long.js Authors.\n   *\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   *     http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   *\n   * SPDX-License-Identifier: Apache-2.0\n   *)\n*/\n", "_initial_view_state": {"longitude": -122.446, "latitude": 37.75, "zoom": 13, "min_zoom": null, "max_zoom": null, "pitch": 45, "bearing": null}, "_layers": [{"type": "SolidPolygonLayer", "data": [{"name": "Twin Peaks", "polygon": [[-122.4477, 37.7543], [-122.4401, 37.7514], [-122.4436, 37.7447], [-122.4522, 37.748]], "elevation": 150}], "id": null, "visible": null, "pickable": true, "opacity": null, "onClick": null, "getPolygon": "@@=polygon", "getElevation": "@@=elevation", "getFillColor": [102, 205, 170], "extruded": true}], "_model_module": "anywidget", "_model_module_version": "~0.9.*", "_model_name": "AnyModel", "_tooltip": {"text": "{name}"}, "_view_count": null, "_view_module": "anywidget", "_view_module_version": "~0.9.*", "_view_name": "AnyView", "click": {}, "height": 500, "layout": "IPY_MODEL_f974a8db08a249e59a3924f5ca07899c", "map_style": "https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json", "tabbable": null, "tooltip": null, "width": "100%"}}}, "version_major": 2, "version_minor": 0}
</script>



                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="scatterplot.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">ScatterplotLayer</p>
      </div>
    </a>
    <a class="right-next"
       href="text.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">TextLayer</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ozekik
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2025, ipydeck contributors.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>